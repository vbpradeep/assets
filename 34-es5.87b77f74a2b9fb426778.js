!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{ZzeQ:function(t,n,r){"use strict";r.r(n),r.d(n,"AutomationModule",(function(){return Et}));var a=r("ofXK"),o=r("ltyr"),l=r("hXFv"),s=r("tyNb"),u=r("mrjb"),c=r("fXoL"),d=r("1kef"),p=r("4SUy"),m=r("OyPL"),b=r("H552"),h=r("58Y9"),g=r("M9dC"),v=r("A4Lh"),f=r("1UK9"),y=r("dSv1"),A=r("ScLb"),T=r("ngVE"),O=r("W3rC"),S=r("gnsf"),x=r("jcQU"),j=r("5Lwd"),C=r("Vtjc"),q=r("IaKf"),E=r("X8pc"),R=r("3LJS"),B=r("JCZ/"),I=r("QYJQ"),N=r("N/Vq"),D=r("SRvG"),w=r("Pk9d"),k=r("JNPz"),F=r("AjNn"),G=r("EiDu"),P=["querybuilderProp"],L=["querybuilderAdditionalProp"],U=["querybuilderaction"],M=["ruleName"],V=["ruleDescription"],H=["queryBuilderContainer"],_=["ruleContainer"],J=["ruleContainerAction"],Q=["actionNotesTemplate"],W=["actionEmailTemplate"],K=["actionAssigneeTemplate"],X=["assigneeDropEmail"],z=["assigneeGroupDropEmail"],$=["assigneeGroupDrop"],Y=["assigneeDrop"],Z=["bussinessHours"],ee=["enableDisableSwitch"],te=["activityTab"],ie=["saveRuleDialog"],ne=["assignmentTypeDrpDwn"],re=["actionUserEmailTemplate"],ae=["actionGroupEmailTemplate"],oe=["subjectGroupField"],le=["actionNotesRTE"],se=["autoAssignmentGroupDrop"],ue=["actionEmailUserRTE"],ce=["actionEmailGroupRTE"];function de(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",54),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Ob(4,"span",55),c.Sb()),2&e&&(c.xb(2),c.Mc(c.ic(3,1,"SETACTION")))}function pe(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",54),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Ob(4,"span",55),c.Sb()),2&e&&(c.xb(2),c.Mc(c.ic(3,1,"ASSOCIATEAGENT")))}function me(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",56),c.Tb(1,"div",57),c.Tb(2,"button",58),c.ec("click",(function(){return c.Bc(i),c.gc().summaryClick()})),c.Lc(3),c.hc(4,"translate"),c.Sb(),c.Sb(),c.Sb()}2&e&&(c.xb(3),c.Mc(c.ic(4,1,"SUMMARY")))}function be(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",59),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.Mc(c.ic(3,1,"FIELDREQUIRED")))}function he(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",59),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.Mc(c.ic(3,1,"FIELDREQUIRED")))}function ge(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div"),c.Tb(1,"ejs-dropdownlist",60,61),c.ec("dataBound",(function(){return c.Bc(i),c.gc().businessHrsDataBind()}))("created",(function(){return c.Bc(i),c.gc().dropDownCreated()}))("blur",(function(){return c.Bc(i),c.gc().OperationalHoursFocusOut()})),c.hc(3,"translate"),c.Sb(),c.Jc(4,he,4,3,"div",6),c.Sb()}if(2&e){var n=c.gc();c.xb(1),c.oc("placeholder",c.ic(3,10,"OPERATIONALHOURS")),c.nc("dataSource",n.businessHourList)("value",n.businessId)("query",n.operationalHoursQuery)("fields",n.businessHourListFields)("showClearButton",!0)("allowFiltering",!0)("filterBarPlaceholder",n.placeholderString)("htmlAttributes",n.autoCompleteAttribute),c.xb(3),c.nc("ngIf",n.operationalHoursRequired)}}function ve(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",59),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.Nc(" ",c.ic(3,1,"PLEASECHOOSEONECONDITION")," "))}function fe(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",59),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.Nc(" ",c.ic(3,1,"PLEASECHOOSEONECONDITION")," "))}function ye(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",62),c.Tb(1,"button",28),c.ec("click",(function(){return c.Bc(i),c.gc().newAction()})),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()}if(2&e){var n=c.gc();c.nc("ngClass",n.showAction?"":"hide-action"),c.xb(2),c.Mc(c.ic(3,2,"ADDNEWACTION"))}}function Ae(e,t){1&e&&(c.Tb(0,"div"),c.Tb(1,"span",59),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.Nc(" ",c.ic(3,1,"PLEASECHOOSEONEACTION"),""))}function Te(e,t){1&e&&(c.Tb(0,"div",72),c.Lc(1),c.hc(2,"translate"),c.Sb()),2&e&&(c.xb(1),c.Nc(" ",c.ic(2,1,"FIELDREQUIRED")," "))}function Oe(e,t){if(1&e){var i=c.Ub();c.Tb(0,"span"),c.Tb(1,"div",63),c.Tb(2,"ul",64),c.Tb(3,"li"),c.Lc(4),c.hc(5,"translate"),c.Sb(),c.Tb(6,"li"),c.Lc(7),c.hc(8,"translate"),c.Sb(),c.Tb(9,"li"),c.Lc(10),c.hc(11,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Tb(12,"div",65),c.Tb(13,"span",66),c.Lc(14),c.hc(15,"translate"),c.Sb(),c.Tb(16,"div",67),c.Tb(17,"div",68),c.Tb(18,"ejs-dropdownlist",69,70),c.ec("blur",(function(){return c.Bc(i),c.gc().autoAssignmentGroupDropBlur()}))("focus",(function(){return c.Bc(i),c.gc().autoAssignmentGroupDropFocus()})),c.hc(20,"translate"),c.hc(21,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Jc(22,Te,3,3,"div",71),c.Sb(),c.Sb()}if(2&e){var n=c.gc();c.xb(4),c.Mc(c.ic(5,13,"AUTOASSIGNMENTONE")),c.xb(3),c.Mc(c.ic(8,15,"AUTOASSIGNMENTTWO")),c.xb(3),c.Mc(c.ic(11,17,"AUTOASSIGNMENTSIX")),c.xb(4),c.Nc(" ",c.ic(15,19,"AUTOASSIGNMENTGROUPSELECT")," "),c.xb(4),c.oc("placeholder",c.ic(20,21,"GROUP")),c.oc("filterBarPlaceholder",c.ic(21,23,"SEARCH")),c.nc("query",n.groupActionAutoAssignmentQuery)("dataSource",n.assigneeGroupDataConfig)("fields",n.assigneeGroupFieldConfig)("allowFiltering",!0)("showClearButton",!0)("value",n.groupValueForAutoAssignment),c.xb(4),c.nc("ngIf",n.invalidGroup)}}function Se(e,t){if(1&e){var i=c.Ub();c.Tb(0,"span"),c.Tb(1,"button",73),c.ec("click",(function(e){return c.Bc(i),c.gc().btnClick(e)})),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()}2&e&&(c.xb(1),c.nc("isPrimary",!0),c.xb(1),c.Mc(c.ic(3,2,"SAVE")))}function xe(e,t){if(1&e){var i=c.Ub();c.Tb(0,"span"),c.Tb(1,"button",74),c.ec("click",(function(e){return c.Bc(i),c.gc().btnClick(e)})),c.Lc(2),c.hc(3,"translate"),c.Sb(),c.Sb()}2&e&&(c.xb(1),c.nc("isPrimary",!0),c.xb(1),c.Mc(c.ic(3,2,"UPDATE")))}function je(e,t){if(1&e){var i=c.Ub();c.Tb(0,"app-rte",75,76),c.ec("focusOut",(function(){c.Bc(i);var e=c.yc(1);return c.gc().rteBlur(e)}))("focusIn",(function(){c.Bc(i);var e=c.yc(1);return c.gc().rteFocus(e)})),c.hc(2,"translate"),c.Sb()}if(2&e){var n=t.$implicit,r=c.gc();c.pc("label","",c.ic(2,5,"DESCRIPTION")," :"),c.nc("id","automationAction_"+n.name)("isNeedImageUpload",!1)("value",r.notesContentValueForDetails)("enablePlaceholder",!0)}}function Ce(e,t){if(1&e&&(c.Tb(0,"span",87),c.Tb(1,"div",88),c.Tb(2,"div",89),c.Tb(3,"div",90),c.Tb(4,"span",91),c.Lc(5),c.Sb(),c.Tb(6,"span",91),c.Tb(7,"span",92),c.Lc(8),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb()),2&e){var i=t.$implicit;c.xb(5),c.Nc(" ",i.displayName," "),c.xb(3),c.Mc(i.emailId)}}function qe(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",78),c.Tb(1,"div",68),c.Tb(2,"ejs-multiselect",79,80),c.ec("dataBound",(function(e){return c.Bc(i),c.gc(2).assigneeUserEmailDataBind(e)}))("blur",(function(){c.Bc(i);var e=c.yc(3);return c.gc(2).assigneeGroupBlur(e)})),c.hc(4,"translate"),c.hc(5,"translate"),c.Jc(6,Ce,9,2,"ng-template",null,81,c.Kc),c.Sb(),c.Sb(),c.Sb(),c.Tb(8,"div",82),c.Tb(9,"ejs-textbox",83,84),c.ec("blur",(function(){c.Bc(i);var e=c.yc(10);return c.gc(2).assigneeGroupBlur(e)})),c.hc(11,"translate"),c.Sb(),c.Sb(),c.Tb(12,"div",82),c.Tb(13,"app-rte",85,86),c.ec("focusOut",(function(){c.Bc(i);var e=c.yc(14);return c.gc(2).rteBlur(e)}))("focusIn",(function(){c.Bc(i);var e=c.yc(14);return c.gc(2).rteFocus(e)})),c.hc(15,"translate"),c.Sb(),c.Sb()}if(2&e){var n=t.$implicit,r=c.gc(2);c.xb(2),c.oc("placeholder",c.ic(4,15,"USER")),c.oc("filterBarPlaceholder",c.ic(5,17,"SEARCH")),c.nc("value",r.userValueForUserDetails)("dataSource",r.assigneeEmailDataConfig)("fields",r.assigneeFieldConfig)("allowFiltering",!0)("query",r.userActionNotifyQuery),c.xb(7),c.oc("placeholder",c.ic(11,19,"SUBJECT")),c.nc("htmlAttributes",r.inputAttribute)("value",r.subValueForUserDetails),c.xb(4),c.pc("label","",c.ic(15,21,"DESCRIPTION")," :"),c.nc("id","automationAction_"+n.name)("isNeedImageUpload",!1)("value",r.rteValueForUserDetails)("enablePlaceholder",!0)}}function Ee(e,t){1&e&&c.Jc(0,qe,16,23,"ng-template",null,77,c.Kc)}function Re(e,t){1&e&&c.Lc(0),2&e&&c.Nc(" ",t.$implicit.groupName," ")}function Be(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",78),c.Tb(1,"div",68),c.Tb(2,"ejs-multiselect",94,95),c.ec("dataBound",(function(e){return c.Bc(i),c.gc(2).emailGroupDatabind(e)}))("blur",(function(){c.Bc(i);var e=c.yc(3);return c.gc(2).assigneeGroupBlur(e)})),c.hc(4,"translate"),c.hc(5,"translate"),c.Jc(6,Re,1,1,"ng-template",null,81,c.Kc),c.Sb(),c.Sb(),c.Sb(),c.Tb(8,"div",82),c.Tb(9,"ejs-textbox",96,97),c.ec("blur",(function(){c.Bc(i);var e=c.yc(10);return c.gc(2).assigneeGroupBlur(e)})),c.hc(11,"translate"),c.Sb(),c.Sb(),c.Tb(12,"div",82),c.Tb(13,"app-rte",85,98),c.ec("focusOut",(function(){c.Bc(i);var e=c.yc(14);return c.gc(2).rteBlur(e)}))("focusIn",(function(){c.Bc(i);var e=c.yc(14);return c.gc(2).rteFocus(e)})),c.hc(15,"translate"),c.Sb(),c.Sb()}if(2&e){var n=t.$implicit,r=c.gc(2);c.xb(2),c.oc("placeholder",c.ic(4,16,"GROUP")),c.oc("filterBarPlaceholder",c.ic(5,18,"SEARCH")),c.nc("dataSource",r.assigneeGroupDataConfig)("fields",r.assigneeGroupFieldConfig)("allowFiltering",!0)("query",r.groupActionNotifyQuery)("value",r.userValueForGroupDetails)("text",r.userValueForGroupDetailsText),c.xb(7),c.oc("placeholder",c.ic(11,20,"SUBJECT")),c.nc("htmlAttributes",r.inputAttribute)("value",r.subValueForGroupDetails),c.xb(4),c.pc("label","",c.ic(15,22,"DESCRIPTION")," :"),c.nc("id","automationAction_"+n.name)("isNeedImageUpload",!1)("value",r.rteValueForGroupDetails)("enablePlaceholder",!0)}}function Ie(e,t){1&e&&c.Jc(0,Be,16,24,"ng-template",null,93,c.Kc)}function Ne(e,t){1&e&&c.Lc(0),2&e&&c.Nc(" ",t.$implicit.groupName," ")}function De(e,t){if(1&e&&(c.Tb(0,"div",104),c.Tb(1,"div",89),c.Tb(2,"div",90),c.Tb(3,"span",91),c.Lc(4),c.Sb(),c.Tb(5,"span",91),c.Tb(6,"span",92),c.Lc(7),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb()),2&e){var i=t.$implicit;c.nc("ngClass",i.isAgent?"agent":""),c.yb("data-user-id",i.userId),c.xb(4),c.Nc(" ",i.displayName," "),c.xb(3),c.Mc(i.emailId)}}function we(e,t){1&e&&(c.Tb(0,"div",105),c.Lc(1),c.hc(2,"translate"),c.Sb()),2&e&&(c.xb(1),c.Mc(c.ic(2,1,"VALIDATIONMESSAGEFORSETASSIGNEE")))}function ke(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",78),c.Tb(1,"div",68),c.Tb(2,"ejs-dropdownlist",99,100),c.ec("change",(function(e){return c.Bc(i),c.gc().assigneeGroupChange(e)}))("dataBound",(function(){return c.Bc(i),c.gc().assigneeGroupDataBind()}))("blur",(function(){return c.Bc(i),c.gc().setAssigneeBlur()}))("focus",(function(){return c.Bc(i),c.gc().setAssigneeFocus()})),c.hc(4,"translate"),c.hc(5,"translate"),c.Jc(6,Ne,1,1,"ng-template",null,81,c.Kc),c.Sb(),c.Sb(),c.Tb(8,"div",68),c.Tb(9,"ejs-dropdownlist",101,102),c.ec("dataBound",(function(e){return c.Bc(i),c.gc().assigneeDataBind(e)}))("change",(function(){return c.Bc(i),c.gc().setAssigneeBlur()}))("focus",(function(){return c.Bc(i),c.gc().setAssigneeFocus()})),c.hc(11,"translate"),c.hc(12,"translate"),c.Jc(13,De,8,4,"ng-template",null,81,c.Kc),c.Sb(),c.Sb(),c.Sb(),c.Jc(15,we,3,3,"div",103)}if(2&e){var n=c.gc();c.xb(2),c.oc("placeholder",c.ic(4,19,"GROUP")),c.oc("filterBarPlaceholder",c.ic(5,21,"SEARCH")),c.nc("query",n.groupActionQuery)("dataSource",n.assigneeGroupDataConfig)("value",n.groupValueForDetails)("fields",n.assigneeGroupFieldConfig)("allowFiltering",!0)("showClearButton",!0)("text",n.groupTextForDetails),c.xb(7),c.oc("placeholder",c.ic(11,23,"AGENT")),c.oc("filterBarPlaceholder",c.ic(12,25,"SEARCH")),c.nc("query",n.assigneeActionQuery)("dataSource",n.assigneeDataConfig)("value",n.assigneeValueForDetails)("fields",n.assigneeFieldConfig)("allowFiltering",!0)("showClearButton",!0)("text",n.assigneeTextForDetails),c.xb(6),c.nc("ngIf",n.setAssigneeVaidationFail)}}function Fe(e,t){1&e&&(c.Tb(0,"span"),c.Lc(1),c.hc(2,"translate"),c.Sb()),2&e&&(c.xb(1),c.Nc(" ",c.ic(2,1,"SUMMARY")," "))}function Ge(e,t){if(1&e&&(c.Tb(0,"div"),c.Ob(1,"p",106),c.hc(2,"safe"),c.Sb()),2&e){var i=c.gc();c.xb(1),c.nc("innerHTML",c.jc(2,1,i.summaryString,"html"),c.Cc)}}var Pe,Le,Ue=((Pe=function(){function t(i,n,r,a,o,l,s,u){e(this,t),this.viewContainerRef=i,this.router=n,this.toastService=r,this.spinService=a,this.automationListService=o,this.appRootService=l,this.cd=s,this.seoService=u,this.showButtons={groupInsert:!1,groupDelete:!0,ruleDelete:!0},this.autoCompleteAttribute={autocomplete:"anyrandomstring"},this.operationalHoursRequired=!1,this.actionRuleDel=!0,this.queryOperators=[{key:j.o.Equal,value:j.p.Equal},{key:j.o.NotEqual,value:j.p.NotEqual},{key:j.o.Greater,value:j.p.Greater},{key:j.o.Less,value:j.p.Less},{key:j.o.GreaterOrEqual,value:j.p.GreaterOrEqual},{key:j.o.LessOrEqual,value:j.p.LessOrEqual},{key:j.o.IsNull,value:j.p.IsNull},{key:j.o.IsNotNull,value:j.p.IsNotNull},{key:j.o.IsEmpty,value:j.p.IsEmpty},{key:j.o.IsNotEmpty,value:j.p.IsNotEmpty},{key:j.o.In,value:j.p.In},{key:j.o.NotIn,value:j.p.NotIn},{key:j.o.Contains,value:j.p.Contains},{key:j.o.NotContains,value:j.p.NotContains},{key:j.o.BeginsWith,value:j.p.BeginsWith},{key:j.o.EndsWith,value:j.p.EndsWith},{key:j.o.NotBeginsWith,value:j.p.NotBeginsWith},{key:j.o.NotEndsWith,value:j.p.NotEndsWith},{key:j.o.Between,value:j.p.Between},{key:j.o.NotBetween,value:j.p.NotBetween},{key:j.o.IsChanged,value:j.p.IsChanged},{key:j.o.IsPublic,value:j.p.IsPublic},{key:j.o.IsPrivate,value:j.p.IsPrivate},{key:j.o.Businesshours,value:j.p.Businesshours},{key:j.o.NonBusinessHours,value:j.p.NonBusinessHours},{key:j.o.Holidays,value:j.p.Holidays},{key:j.o.After,value:j.p.After},{key:j.o.Before,value:j.p.Before}],this.inputAttribute={maxlength:v.s,autocomplete:"anyrandomstring"},this.assigneeGroupFieldConfig={value:"groupID",text:"groupName"},this.assigneeFieldConfig={value:"userId",text:"displayName"},this.validCondition=!0,this.validConditionForGroup=!0,this.validAction=!0,this.itemAddedAssignee=!1,this.itemAddedAssigneeEmail=!1,this.itemAddedGroupEmail=!1,this.itemAddedGroup=!1,this.toShowAddFilter=!1,this.additionalConditionRuleDel=!0,this.enable=!0,this.tabAnimationSettings={next:{effect:"None"},previous:{effect:"None"}},this.assignmentTypeSource=[{value:1,text:"Direct"},{value:2,text:"Round Robin"}],this.assignmentTypeFields={text:"text",value:"value"},this.businessHourListFields={text:"name",value:"id"},this.placeholderString=Object(y.a)("SEARCH"),this.addItemFrBusinessHrs=!0,this.conditionErrorAndRule=!1,this.conditionErrorOrRule=!1,this.actionError=!1,this.setAssigneeVaidationFail=!1,this.invalidGroup=!1,this.hideAddActionButton=!1,this.enablePrivateNoteAction=!1,this.enableUserNotificationAction=!1,this.enableGroupNotificationAction=!1,this.isRequestCompleted=!1,this.rootColumDropDown=[{text:"Tickets",value:"1"}],this.assigneeGroupDataConfig=new b.a({url:A.a.Group,adaptor:new g.b}),this.assigneeDataConfig=new b.a({url:A.a.Assignee,adaptor:new g.b}),this.assigneeEmailDataConfig=new b.a({url:A.a.Requester,adaptor:new g.b})}return i(t,[{key:"ngOnInit",value:function(){var e=this,t=this.automationId>0?Object(y.a)("EDIT")+" ":Object(y.a)("ADD")+" ";j.l.CreateTicketAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("CREATETICKETTRIGGERS"),t,"/admin/automation/create-ticket-triggers"):j.l.UpdateTicketAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("UPDATETICKETTRIGGERS"),t,"/admin/automation/update-ticket-triggers"):j.l.TimeTriggerAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("TIMETRIGGERS"),t,"/admin/automation/time-triggers"):j.l.AutoAssignmentAutomation===this.eventType&&this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("AUTOASSIGNMENTTRIGGERS"),t,"/admin/automation/auto-assignments"),this.customReqHandle=v.R.subscribe((function(){e.isRequestCompleted=!0,Object(v.S)(!1),e.spinService.hideSpinner(),e.customReqHandle.unsubscribe()})),this.convertFields().then((function(){e.eventType!==j.l.AutoAssignmentAutomation&&e.convertActionFields()})),this.showAction=this.eventType!==j.l.AutoAssignmentAutomation,this.groupValueForAutoAssignment&&(this.groupActionAutoAssignmentQuery=(new b.g).addParams("includeAdditionalIds",""+this.groupValueForAutoAssignment)),this.href=this.router.url,this.businessHourList=new b.a({url:C.a.BusinessHourList,adaptor:new g.b}),this.operationalHoursQuery=(new b.g).addParams(this.fieldQuery(j.r.BusinessHourQuery),""+this.businessId)}},{key:"ngOnDestroy",value:function(){Object(v.S)(!1)}},{key:"setTitleAndSeo",value:function(e,t,i,n){var r=i+" | "+t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t+" / "+i+","+n),this.seoService.setHeaderElements({title:r})}},{key:"compileTemplate",value:function(e,t){var i=this.viewContainerRef.createEmbeddedView(e,{$implicit:t});i.markForCheck();var n=Object(p.F)("div"),r=i.rootNodes;return r.length>0&&r.forEach((function(e){n.appendChild(e)})),n}},{key:"ngAfterViewInit",value:function(){Object(v.V)(!0)}},{key:"queryBuildervalueUpdate",value:function(e,t,i){e.notifyChange(i,t)}},{key:"queryActionCreated",value:function(){var e=this;setTimeout((function(){e.actionRules&&(e.actionRuleDel=!1),Object(p.X)(e.qryBldrObjAction.valueText)&&(e.qryBldrObjAction.valueText={});var t=e.qryBldrObjAction.element.querySelector(".e-addrulegroup");if(t){var i=Object(p.M)(t,"dropdown-btn");i&&(i.cssClass="e-round e-caret-hide hd-query-action-group e-addrulegroup")}})),this.styleChange(this.qryBldrObjAction)}},{key:"querybuilderCreated",value:function(){var e=this;this.qryBldrObjRule.operators=this.queryOperators,setTimeout((function(){var t=e.qryBldrObjRule.element.querySelector(".e-addrulegroup");if(t){var i=Object(p.M)(t,"dropdown-btn");i&&(i.cssClass="e-round e-caret-hide hd-query-action-rule e-addrulegroup")}e.styleChange(e.qryBldrObjRule)}))}},{key:"querybuilderAdditionalCreated",value:function(){var e=this;this.querybuilderAdditionalProp.operators=this.queryOperators,setTimeout((function(){var t=e.querybuilderAdditionalProp.element.querySelector(".e-addrulegroup");if(t){var i=Object(p.M)(t,"dropdown-btn");i&&(i.cssClass="e-round e-caret-hide hd-query-action-rule e-addrulegroup")}e.styleChange(e.querybuilderAdditionalProp)}))}},{key:"querybuilderRuleChange",value:function(){(this.qryBldrObjRule.rule.rules.length>1||""!==this.qryBldrObjRule.rule.rules[0].field)&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&(this.validCondition=this.qryBldrObjRule.validateFields())}},{key:"querybuilderAddRuleChange",value:function(){1!==this.querybuilderAdditionalProp.rule.rules.length&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields())}},{key:"querybuilderChange",value:function(e){e&&("deleteRule"!==e.type&&"insertRule"!==e.type||(this.conditionRuleDel=1===this.qryBldrObjRule.rule.rules.length&&""===this.qryBldrObjRule.rule.rules[0].field),"field"===e.type&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.conditionRuleDel=!1),"deleteRule"===e.type&&0===this.qryBldrObjRule.rule.rules.length&&this.qryBldrObjRule.addRuleElement(this.qryBldrObjRule.element.querySelector(".e-group-container"),{})),this.qryBldrObjRule.rule.rules.length>0&&(this.qryBldrObjRule.rule.rules.length>1||""!==this.qryBldrObjRule.rule.rules[0].field)&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&(this.validCondition=this.qryBldrObjRule.validateFields()),this.ruleConditionRequired=!1,this.isSummaryView=!1,this.styleChange(this.qryBldrObjRule)}},{key:"summaryFraming",value:function(){var e="",t={condition:this.qryBldrObjRule.rule.condition,rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))},i=this.processRule(this.qryBldrObjRule.element.id,t);this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(e=this.queryBuilderSummaryFrame(i,"and"));var n="",r="";if(this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field){var a={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},o=this.processRule(this.querybuilderAdditionalProp.element.id,a);e?n='<div class="secondary">and</div> '+this.queryBuilderSummaryFrame(o,"or"):e||(n=""+this.queryBuilderSummaryFrame(o,"or"))}var l,s="";this.eventType!==j.l.CreateTicketAutomation&&this.eventType!==j.l.UpdateTicketAutomation&&this.eventType!==j.l.AutoAssignmentAutomation||(s="<div class='primary summary-field'>When <span class=\"summary-field summary-field\">Ticket is </span> <span class='summary-field'> ".concat((l=this.eventType)===j.l.CreateTicketAutomation?j.s.Created:l===j.l.UpdateTicketAutomation?j.s.Updated:l===j.l.AutoAssignmentAutomation?j.s.Created+" or "+j.s.Updated:void 0," </span> </div>")),this.eventType===j.l.TimeTriggerAutomation&&(s="<div class='primary summary-field'><span class='summary-field'> ".concat(j.s.TimeTriggerContent," </span> </div>")),this.qryBldrObjAction&&this.qryBldrObjAction.rule&&this.qryBldrObjAction.rule.rules.length>0&&""!==this.qryBldrObjAction.rule.rules[0].field&&(r+=this.queryBuilderActionSummaryFrame(this.qryBldrObjAction)),this.eventType===j.l.AutoAssignmentAutomation&&this.autoAssignmentGroupDrop.text&&(r+='<div class="Primary"> <span class="summary-field">Set assignee</span><span class="summary-operator lowercase"> to</span><span class=\'summary-value\'> '.concat(this.autoAssignmentGroupDrop.text,"</span></div>")),this.summaryString=r?"<span>".concat(s,'<div class="summary-condition">').concat(e," ").concat(n,'</div><div style="margin-bottom:15px" class="summary-field">Perform these actions</div><div class="summary-action">').concat(r,"</div></span>"):"<span> ".concat(s,' <div class="summary-condition"> ').concat(e," ").concat(n," </div> </span>")}},{key:"queryBuilderActionSummaryFrame",value:function(e){var t='<div class="secondary">'.concat(e.rule.condition,"</div>"),i="";return e.rule.rules.forEach((function(n,r){var a,o;i+='<div class="Primary"> <span class="summary-field">'.concat(n.label,"</span> ").concat((a=n.field,o=n.type,"string"==typeof e.valueText[a]&&a!==j.f.Duedate&&o!==j.g.Date&&o!==j.g.DateTime?e.valueText[a]?"<span class=\"summary-operator lowercase\">as</span> <span class='summary-value'>".concat(e.valueText[a],"</span>"):"":"object"==typeof e.valueText[a]&&a!==j.f.Duedate&&null!==e.valueText[a]?"<span class=\"summary-operator lowercase\">to</span>\n                <span class='summary-value'>".concat(e.valueText[a].groupText?e.valueText[a].groupText:"",'</span>\n                <span class="secondary">').concat(e.valueText[a].groupText&&e.valueText[a].assigneeText?"and":"","</span>\n                <span class='summary-value'>").concat(e.valueText[a].assigneeText?e.valueText[a].assigneeText:"","</span>"):a===j.f.Duedate||o===j.g.Date?"<span class='summary-value'>".concat(e.valueText[a]?Object(h.G)(e.valueText[a],v.e.dateFormat):"","<span>"):o===j.g.DateTime?"<span class='summary-value'>".concat(e.valueText[a]?Object(h.G)(e.valueText[a],v.e.dateFormat,v.e.timeFormat):"","<span>"):"")," </div> ").concat(e.rule.rules.length-1!==r?t:"")})),i}},{key:"queryBuilderSummaryFrame",value:function(e,t){var i,n,r=this,a="",o='<div class="secondary">'.concat(t,"</div>"),l=function(e){var t=Object.assign([],r.queryOperators).filter((function(t){return t.value===e}))[0];return t?t.key:e};return e&&e.rules.length>0&&e.rules.forEach((function(t,s){i=r.isValidArray(t.value,t)?'<span class="summary-value">'+t.value+"</span>":Object.prototype.hasOwnProperty.call(t,"from")?' from <span class="summary-value">'+t.from+'</span> to <span class="summary-value">'+t.to+"</span>":t.type===j.g.Date?'<span class="summary-value">'+Object(h.G)(t.value,v.e.dateFormat)+"</span>":t.type===j.g.DateTime||t.operator===j.p.Before||t.operator===j.p.After?'<span class="summary-value">'+Object(h.G)(t.value,v.e.dateFormat,v.e.timeFormat)+"</span>":"",n=""+l(t.operator)===(j.o.IsPublic||j.o.IsPrivate)?'<span class="summary-operator summary-value lowercase">'.concat(l(t.operator),"</span>"):'<span class="summary-operator lowercase">'.concat(l(t.operator),"</span>"),a+="<div class='primary'>If <span class=\"summary-field\">".concat(t.label,"</span> <span>").concat(n,"</span> <span>").concat(i,"</span> </div> ").concat(e.rules.length-1!==s?o:"")})),a}},{key:"isValidArray",value:function(e,t){return!Object(p.X)(e)&&e.length&&e.length>0&&!Object.prototype.hasOwnProperty.call(t,"from")&&!(t.type===j.g.DateTime)&&!(t.type===j.g.Date)||""===t.from||(t.type===j.g.Integer||t.type===j.g.Long||t.type===j.g.Decimal)&&!e.length}},{key:"querybuilderAdditionalChange",value:function(e){e&&("deleteRule"!==e.type&&"insertRule"!==e.type||(this.extraConditionRuleDel=1===this.querybuilderAdditionalProp.rule.rules.length&&""===this.querybuilderAdditionalProp.rule.rules[0].field),"field"===e.type&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&(this.extraConditionRuleDel=!1),"deleteRule"===e.type&&0===this.querybuilderAdditionalProp.rule.rules.length&&this.querybuilderAdditionalProp.addRuleElement(this.querybuilderAdditionalProp.element.querySelector(".e-group-container"),{})),this.querybuilderAdditionalProp.rule.rules.length>0&&(this.querybuilderAdditionalProp.rule.rules.length>1||""!==this.querybuilderAdditionalProp.rule.rules[0].field)&&""===this.qryBldrObjRule.rule.rules[0].field&&(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields()),this.ruleConditionRequired=!1,this.isSummaryView=!1,this.styleChange(this.querybuilderAdditionalProp)}},{key:"getEj2Componenet",value:function(e){return e.ej2_instances[0]}},{key:"newAction",value:function(){this.qryBldrObjAction.validateFields()&&this.qryBldrObjAction.addRuleElement(this.qryBldrObjAction.element.querySelector(".e-group-container"),{})}},{key:"newCondition",value:function(e,t){t.validateFields()&&t.addRuleElement(t.element.querySelector(".e-group-container"),{})}},{key:"processActionRule",value:function(e,t){var i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.condition){for(var a=t.rules.length,o=0;o<a;o++)t.rules[o]=this.processRule(e,t.rules[o],o);var l=Object.assign([],t.rules);t.rules=this.getUniqueRule(l)}else n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," #").concat(e,"_group0_rule").concat(r)).getElementsByClassName("e-"+t.field)[0],Object(h.D)(t.value)?Object.prototype.hasOwnProperty.call(t,"from")||Object.prototype.hasOwnProperty.call(t,"to")?(n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," #").concat(e,"_group0_rule").concat(r)).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-from .e-control"),(i=this.getEj2Componenet(n))&&(t.from=i.text),n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," #").concat(e,"_group0_rule").concat(r)).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-to .e-control"),(i=this.getEj2Componenet(n))&&(t.to=i.text)):t.value="":(i=this.getEj2Componenet(n),t.value=i?i.text?i.text:i.value:n.value),t.field=t.label;return t}},{key:"processRule",value:function(e,t){var i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.condition){for(var a=t.rules.length,o=0;o<a;o++)t.rules[o]=this.processRule(e,t.rules[o],o);var l=Object.assign([],t.rules);t.rules=this.getUniqueRule(l)}else n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," .e-rule-list")).children[r].getElementsByClassName("e-"+t.field)[0],!Object(h.D)(t.value)&&t.value.length&&t.value.length>0&&t.operator!==j.p.IsChanged&&t.operator!==j.p.IsPublic&&t.operator!==j.p.IsPrivate?(i=this.getEj2Componenet(n),t.value=i?i.text?i.text:i.value:n.value):(Object.prototype.hasOwnProperty.call(t,"from")||Object.prototype.hasOwnProperty.call(t,"to"))&&t.field!==j.h.ResolutionDue?(n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," .e-rule-list")).children[r].getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-from .e-control"),(i=this.getEj2Componenet(n))&&(t.from=i.text),n=this.ruleContainerEle.nativeElement.querySelector("#".concat(e," #").concat(e,"_group0_rule").concat(r)).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-to .e-control"),(i=this.getEj2Componenet(n))&&(t.to=i.text)):t.value="",t.field=t.label;return t}},{key:"getUniqueRule",value:function(e){for(var t=[],i=0;i<e.length;i++)if(t.length<1)t.push(e[i]);else for(var n=0;n<t.length;n++)if(JSON.stringify(t[n])!==JSON.stringify(e[i])){t.push(e[i]);break}return t}},{key:"querybuilderActionRuleChange",value:function(){this.ruleActionRequired=!1}},{key:"querybuilderActionChange",value:function(e){if(this.qryBldrObjAction.rule.rules.length>0&&"1"===this.activityTab.selectingID&&(this.qryBldrObjAction.rule.rules.length>1||""!==this.qryBldrObjAction.rule.rules[0].field)&&(this.validAction=this.qryBldrObjAction.validateFields()),"deleteRule"!==e.type&&"insertRule"!==e.type||(this.actionRuleDel=1===this.qryBldrObjAction.rule.rules.length&&""===this.qryBldrObjAction.rule.rules[0].field),"field"===e.type&&""!==this.qryBldrObjAction.rule.rules[0].field&&(this.actionRuleDel=!1),"deleteRule"===e.type&&0===this.qryBldrObjAction.rule.rules.length&&this.qryBldrObjAction.addRuleElement(this.qryBldrObjAction.element.querySelector(".e-group-container"),{}),"deleteRule"!==e.type&&"insertRule"!==e.type&&"field"!==e.type||this.framUniqFieldsInActionQB(),e&&"field"===e.type){var t=this.qryBldrObjAction.element.querySelector("#"+this.qryBldrObjAction.element.id+"_"+e.ruleID+" .e-rule-operator .e-control.e-dropdownlist");if(t){var i=t.ej2_instances[0];i.value="equal",this.qryBldrObjAction.changeField({element:i.element,itemData:{key:"equal",value:"equal"},isInteracted:!1})}}this.styleChange(this.qryBldrObjAction)}},{key:"textBoxcreated",value:function(){var e=this;setTimeout((function(){e.ruleNameObj&&e.ruleNameObj.element&&Object(h.h)(e.ruleNameObj.element.parentElement)}))}},{key:"dropDownCreated",value:function(){var e=this;setTimeout((function(){e.bussinessHours&&e.bussinessHours.element&&Object(h.h)(e.bussinessHours.element.parentElement)}))}},{key:"textBoxRuleFocusOut",value:function(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.nameRule=this.ruleNameObj.value}},{key:"textBoxRulefocus",value:function(){this.ruleNameRequired=!1}},{key:"OperationalHoursFocusOut",value:function(){this.operationalHoursRequired=Object(h.D)(this.bussinessHours.value)}},{key:"isValid",value:function(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields(),this.validAction=this.qryBldrObjAction.validateFields()}},{key:"isConditionTabValid",value:function(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field?this.validCondition=this.qryBldrObjRule.validateFields():this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field?(this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields()):this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field?(this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=!(this.querybuilderAdditionalProp.rule.rules.length>1)||this.querybuilderAdditionalProp.validateFields()):(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields(),this.validCondition=!(this.qryBldrObjRule.rule.rules.length>1)||this.qryBldrObjRule.validateFields())}},{key:"isActionTabValid",value:function(){this.validAction=this.qryBldrObjAction.validateFields()}},{key:"checkValidation",value:function(){if(this.textBoxRuleFocusOut(),0===this.qryBldrObjRule.getValidRules(this.qryBldrObjRule.rule).rules.length&&(this.ruleConditionRequired=!0),0===this.qryBldrObjAction.getValidRules(this.qryBldrObjAction.rule).rules.length&&(this.ruleActionRequired=!0),this.ruleNameRequired&&this.ruleNameObj.focusIn(),!this.ruleNameRequired&&!this.ruleActionRequired&&!this.ruleConditionRequired){var e=this.qryBldrObjRule.getValidRules(this.qryBldrObjRule.rule);console.dir(JSON.stringify(e,null,4)),console.dir(JSON.stringify(this.qryBldrObjAction.rule.rules,null,4))}}},{key:"ruleSaveEvent",value:function(){var e,t,i=this;this.spinService.showSpinner(),this.summaryFraming(),this.eventType===j.l.AutoAssignmentAutomation&&(t=[{name:"AssignTicket",label:"Set assignee",field:j.f.UpdateAssignee,AssignmentType:j.e.RoundRobin,GroupId:this.autoAssignmentGroupDrop.value.toString()}]),this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.addRuleCondition={condition:"and",rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))}),this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.addRuleCondition&&(this.addRuleCondition={condition:"or",rules:this.querybuilderAdditionalProp.rule.rules},this.qryBldrObjRule.rule.rules.push(this.addRuleCondition)),this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field?(this.ruleSecondQryBldrCondition={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},e=JSON.stringify({condition:"or",rules:this.ruleSecondQryBldrCondition.rules})):e=JSON.stringify({condition:"and",rules:this.qryBldrObjRule.rule.rules});var n={name:this.ruleNameObj.value.trim(),description:this.ruleDescription.value,condition:e,summary:this.summaryString,action:this.eventType===j.l.AutoAssignmentAutomation?JSON.stringify(t):JSON.stringify(this.qryBldrObjAction.rule.rules),automationTypeId:this.eventType,isEnabled:!0,businessHourId:this.bussinessHours?0===this.bussinessHours.value?null:this.bussinessHours.value:null};this.automationListService.addAutomation(n).then((function(e){e&&(i.saveRuleDialog.hide(),Object(v.V)(!1),i.toastService.successToast(e.message),i.router.navigateByUrl(i.href.replace("/new","")))})).finally((function(){i.spinService.hideSpinner()}))}},{key:"ruleUpdateEvent",value:function(){var e,t,i=this;this.spinService.showSpinner(),this.summaryFraming(),this.eventType===j.l.AutoAssignmentAutomation&&(t=[{name:"AssignTicket",label:"Set assignee",field:j.f.UpdateAssignee,AssignmentType:j.e.RoundRobin,GroupId:this.autoAssignmentGroupDrop.value.toString()}]),this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.addRuleCondition={condition:"and",rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))}),this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.addRuleCondition&&(this.addRuleCondition={condition:"or",rules:this.querybuilderAdditionalProp.rule.rules},this.qryBldrObjRule.rule.rules.push(this.addRuleCondition)),this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field?(this.ruleSecondQryBldrCondition={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},e=JSON.stringify({condition:"or",rules:this.ruleSecondQryBldrCondition.rules})):e=JSON.stringify({condition:"and",rules:this.qryBldrObjRule.rule.rules});var n={name:this.ruleNameObj.value.trim(),description:this.ruleDescription.value,condition:e,summary:this.summaryString,action:this.eventType===j.l.AutoAssignmentAutomation?JSON.stringify(t):JSON.stringify(this.qryBldrObjAction.rule.rules),businessHourId:this.bussinessHours?0===this.bussinessHours.value?null:this.bussinessHours.value:null};this.automationListService.updateAutomation(this.automationId,n).then((function(e){e&&(i.saveRuleDialog.hide(),Object(v.V)(!1),i.toastService.successToast(e.message),i.router.navigateByUrl(i.href.replace("/"+i.automationId,"")))})).finally((function(){i.spinService.hideSpinner()}))}},{key:"beforeChange",value:function(){}},{key:"framUniqFieldsInActionQB",value:function(){var e=this,t=this.getColumnData();this.qryBldrObjAction.element.querySelectorAll(".e-rule-list .e-rule-field .e-rule-filter .e-control.e-dropdownlist").forEach((function(i){e.skipIndexDataSource(i.ej2_instances[0],e.qryBldrObjAction.columns,JSON.parse(JSON.stringify(t)))}))}},{key:"skipIndexDataSource",value:function(e,t,i){-1!==i.indexOf(e.value)&&i.splice(i.indexOf(e.value),1);var n=[];t.forEach((function(e){-1===i.indexOf(e.field)&&n.push(e)})),e.dataSource=n,this.hideAddActionButton=1===n.length,e.dataBind()}},{key:"getColumnData",value:function(){var e=[];return this.qryBldrObjAction.getRules().rules.forEach((function(t){t.field&&e.push(t.field)})),e}},{key:"assigneeGroupChange",value:function(e){if(!e||!e.skipUpdate){var t=this.assigneeGroupDrop.itemData,i=t?t.groupID:null,n=!isNaN(i);i&&n&&i!==j.w.None?(this.assigneeDrop.value=null,this.assigneeDrop.dataSource=new b.a({url:A.a.AssigneeByGroupId+i+"/members",adaptor:new g.b})):this.assigneeDrop.dataSource=new b.a({url:A.a.Assignee,adaptor:new g.b}),this.assigneeDrop.dataBind()}}},{key:"emailGroupDatabind",value:function(e){this.assigneeGroupDropEmail.requestCount?++this.assigneeGroupDropEmail.requestCount:this.assigneeGroupDropEmail.requestCount=1;for(var t=e.items.length,i=0;i<t&&!this.itemAddedGroupEmail&&e.items[i].groupID!==j.w.AssignedGroup;i++);this.itemAddedGroupEmail||(this.assigneeGroupDropEmail.addItem({groupID:j.w.AssignedGroup,groupName:j.x.AssignedGroup},0),this.itemAddedGroupEmail=!0),1===this.assigneeGroupDropEmail.requestCount&&1===this.assigneeGroupDropEmail.requestCount&&this.userValuePersistForGroup&&this.userValuePersistForGroup.length>0&&(this.assigneeGroupDropEmail.value=this.userValuePersistForGroup,this.assigneeGroupDropEmail.dataBind()),this.assigneeGroupDropEmail.value&&this.assigneeGroupDropEmail.change.emit()}},{key:"assigneeGroupDataBind",value:function(){this.assigneeGroupDrop.value&&(Object(p.X)(this.qryBldrObjAction.valueText[j.f.UpdateAssignee])&&(this.qryBldrObjAction.valueText[j.f.UpdateAssignee]={}),this.qryBldrObjAction.valueText[j.f.UpdateAssignee].groupText=this.assigneeGroupDrop.text)}},{key:"businessHrsDataBind",value:function(){this.addItemFrBusinessHrs&&(this.bussinessHours&&this.bussinessHours.element&&(this.bussinessHours.addItem({id:j.w.CalendarHours,name:Object(y.a)("ALLDAYS24*7")},0),this.automationId?null===this.businessId&&(this.bussinessHours.value=0):this.bussinessHours.index=0),this.addItemFrBusinessHrs=!1)}},{key:"assigneeUserEmailDataBind",value:function(e){this.assigneeDropEmail.requestCount?++this.assigneeDropEmail.requestCount:this.assigneeDropEmail.requestCount=1;for(var t=e.items.length,i=0;i<t&&!this.itemAddedAssigneeEmail&&e.items[i].userId!==j.w.Requester;i++);this.itemAddedAssigneeEmail||(this.assigneeDropEmail.addItem({displayName:j.x.Requester,userId:j.w.Requester,shortCode:"RE",colorCode:"#0450cc"},0),this.assigneeDropEmail.addItem({displayName:j.x.AssignedAgent,userId:j.w.AssignedAgent,shortCode:"AA",colorCode:"#0450cc"},0),this.itemAddedAssigneeEmail=!0),1===this.assigneeDropEmail.requestCount&&this.userValuePersistForUser&&this.userValuePersistForUser.length>0&&(this.assigneeDropEmail.value=this.userValuePersistForUser,this.assigneeDropEmail.dataBind()),this.assigneeDropEmail.value&&this.assigneeDropEmail.change.emit()}},{key:"assigneeDataBind",value:function(e){for(var t=e.items.length,i=0;i<t;i++){if(e.items[i].userId===j.w.EventPerformer){this.itemAddedAssignee=!0;break}this.itemAddedAssignee=!1}this.itemAddedAssignee||this.eventType===j.l.TimeTriggerAutomation||(this.assigneeDrop.addItem({displayName:j.x.EventPerformer,userId:j.w.EventPerformer,shortCode:"EP",colorCode:"#0450cc"},0),this.itemAddedAssignee=!0),this.assigneeDrop.value&&this.assigneeDrop.change.emit()}},{key:"styleChange",value:function(e){var t=e.element.querySelectorAll(".e-rule-field .e-rule-filter .e-control.e-dropdownlist, .e-rule-field .e-rule-operator .e-control"),i=e.element.querySelectorAll(".e-filter-input");if(e===this.qryBldrObjRule||e===this.querybuilderAdditionalProp)for(var n=0;n<i.length;n++){var r=Object(p.M)(i[n],"dropdownlist");r.fields.groupBy="fieldGroupName",r.filterType="Contains",r.refresh()}for(var a=0;a<t.length;a++){var o=Object(p.M)(t[a],"dropdownlist");o.cssClass=o.cssClass?o.cssClass:null,o.floatLabelType="Never",o.allowFiltering=!0,o.filterBarPlaceholder=Object(y.a)("SEARCH"),o.popupHeight=v.g,o.filterType="Contains",o.dataBind()}}},{key:"convertFields",value:function(){var e=this,t=O.a.AutomationNewRuleFields+this.eventType+"/fields";return this.spinService.hideSpinner(),this.automationListService.fields(t).then((function(t){Object(v.S)(!0),e.items=t.result,e.itemClone=e.items.map((function(e){return Object.assign({},e)})),e.selectQryBldr(e.qryBldrObjRule),e.columnTemplate=[e.itemsList],e.filter=e.columnTemplate[0],e.selectQryBldr(e.querybuilderAdditionalProp),e.columnAdditionalTemplate=[e.itemsList],e.additionalFilter=e.columnAdditionalTemplate[0],setTimeout((function(){e.qryBldrObjRule.refresh(),e.styleChange(e.qryBldrObjRule),e.querybuilderAdditionalProp.refresh(),e.styleChange(e.querybuilderAdditionalProp)}))})).finally((function(){e.automationId||e.spinService.hideSpinner()}))}},{key:"convertActionFields",value:function(){var e=this;this.automationListService.actionFields(O.a.AutomationNewRuleFieldsAction+this.eventType+"/actions").then((function(t){e.actionListArray=t.result,e.addTypesToAction(),setTimeout((function(){e.qryBldrObjAction.refresh(),e.styleChange(e.qryBldrObjAction),setTimeout((function(){Object(v.W)()}),300)}))})).finally((function(){e.automationId||e.spinService.hideSpinner()}))}},{key:"addTypesToAction",value:function(){for(var e=0;e<this.actionListArray.length;e++){if(this.actionListArray[e].assignmentType)for(var t=0;t<this.actionListArray[e].assignmentType.length;t++)this.actionListArray[e].assignmentType[t]=1===this.actionListArray[e].assignmentType[t]?"Direct":"RoundRobin";if(this.actionListArray[e].assigneeType)for(var i=0;i<this.actionListArray[e].assigneeType.length;i++)this.actionListArray[e].assigneeType[i]=this.assigneeType(this.actionListArray[e].assigneeType[i]);if(this.actionListArray[e].receiverType)for(var n=0;n<this.actionListArray[e].receiverType.length;n++)this.actionListArray[e].receiverType[n]=this.receiverType(this.actionListArray[e].receiverType[n]);this.actionListArray[e].operators=[Object(f.n)(1)],this.actionListArray[e].template=this.automationActionTemplate(this.qryBldrObjAction,this.ruleContainerActionEle,this.queryBuildervalueUpdate,this.actionListArray[e])}this.filterAction=this.actionListArray}},{key:"selectQryBldr",value:function(e){if(e===this.qryBldrObjRule){this.itemsList=this.items;for(var t=0;t<this.itemsList.length;t++){for(var i=0;i<this.itemsList[t].operators.length;i++){var n=this.itemsList[t].operators[i];Object(f.n)(n)&&(this.itemsList[t].operators[i]=Object(f.n)(n))}this.itemsList[t].template=Object(f.b)(e,this.ruleContainerEle,this.queryBuildervalueUpdate,this.itemsList[t],this.eventType,this.automationId)}}else{this.itemsList=this.itemClone;for(var r=0;r<this.itemsList.length;r++)this.itemsList[r].template=Object(f.b)(e,this.ruleContainerEle,this.queryBuildervalueUpdate,this.itemsList[r],this.eventType,this.automationId)}return this.itemsList}},{key:"automationActionTemplate",value:function(e,t,i,n){var r=this;return{create:function(e){return event&&event,e.field===j.f.UpdateAssignee?r.compileTemplate(r.actionAssigneeTemplate,{name:"assignee"}):e.field===j.f.AddNote?(r.enablePrivateNoteAction=!0,r.compileTemplate(r.actionNotesTemplate,{name:"private_notes"})):e.field===j.f.SendUserNotification?(r.enableUserNotificationAction=!0,r.cd.detectChanges(),r.compileTemplate(r.actionUserEmailTemplate,{name:"user_email"})):e.field===j.f.SendGroupNotification?(r.enableGroupNotificationAction=!0,r.cd.detectChanges(),r.compileTemplate(r.actionGroupEmailTemplate,{name:"group_email"})):Object(p.F)("input",{attrs:{type:"text"}})},destroy:function(i){if(!Object(p.X)(i.elements)){r.setAssigneeVaidationFail=!1;var n,a=Object(p.C)(i.elements[0],".e-rule-container"),o=[].slice.call(a.parentElement.children).indexOf(a);if(n=e.rule.rules[o],Object(p.X)(e.valueText)&&(e.valueText={}),delete e.valueText[n.field],n.field===j.f.UpdateAssignee){r.groupValueForDetails=null,r.assigneeValueForDetails=null,i.elements[0].parentElement.classList.remove("action-assignee-style");var l=t.nativeElement.querySelector("#"+i.elementId+" #assigneeGroupDrop").ej2_instances[0],s=t.nativeElement.querySelector("#"+i.elementId+" #assigneeDrop").ej2_instances[0];l.destroy(),s.destroy()}else if(n.field===j.f.AddNote)r.notesContentValueForDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),r.enablePrivateNoteAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_private_notes_RTE").ej2_instances[0].destroy();else if(n.field===j.f.SendUserNotification){r.userValueForUserDetails=null,r.userValuePersistForUser=null,r.subValueForUserDetails=null,r.rteValueForUserDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),r.actionEmailUserRTE.closeCannedResponseDialog(),r.enableUserNotificationAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_user_email_RTE").ej2_instances[0].destroy(),t.nativeElement.querySelector("#"+i.elementId+" #subjectUserField").ej2_instances[0].destroy();var u=t.nativeElement.querySelector("#"+i.elementId+" #assigneeDropEmail").ej2_instances[0];u.requestCount=null,u.destroy(),r.cd.detectChanges()}else if(n.field===j.f.SendGroupNotification){r.userValueForGroupDetails=null,r.userValueForGroupDetailsText=null,r.userValuePersistForGroup=null,r.subValueForGroupDetails=null,r.rteValueForGroupDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),r.actionEmailGroupRTE.closeCannedResponseDialog(),r.enableGroupNotificationAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_group_email_RTE").ej2_instances[0].destroy(),t.nativeElement.querySelector("#"+i.elementId+" #subjectGroupField").ej2_instances[0].destroy();var c=t.nativeElement.querySelector("#"+i.elementId+" #assigneeGroupDropEmail").ej2_instances[0];c.requestCount=null,c.destroy(),r.cd.detectChanges()}else{var d=t.nativeElement.querySelector("#"+i.elementId);d.classList.contains("e-control")?d.ej2_instances[0].destroy():d.querySelectorAll(".e-control").forEach((function(e){e.ej2_instances[0].destroy()}))}delete e.rule.rules[o].custom,delete e.rule.rules[o][j.c.SendNotificationBodyContent],delete e.rule.rules[o][j.c.SendNotificationSubjectContent],delete e.rule.rules[o][j.c.AssigneeTypeInUpdateAssignee],delete e.rule.rules[o][j.c.AgentInUpdateAssignee],delete e.rule.rules[o][j.c.GroupInSetAssignee];var m=i.elements[0].parentElement.parentElement.querySelector(".mandatory-false");m&&m.parentElement.remove()}},write:function(a){var o=Object(p.C)(a.elements,".e-rule-container"),l=Object(p.M)(o.querySelector(".e-rule-filter .e-filter-input"),"dropdownlist").itemData,s=[].slice.call(o.parentElement.children).indexOf(o);Object(p.X)(e.valueText)&&(e.valueText={});var u=r.automationId?e.rule.rules[s].custom:[];Object(p.X)(u)&&(u=[]),delete e.valueText[l.field];var c=a.elements.parentElement.parentElement.querySelector(".mandatory-false");c&&c.parentElement.remove();var d=i;if(l.field===j.f.Subject||n.isCustomField&&n.controlName===j.m.Textarea||n.isCustomField&&n.controlName===j.m.Textbox||n.isCustomField&&n.controlName===j.m.MultiselectUrlPrefix||n.isCustomField&&n.controlName===j.m.UrlPrefix||n.isCustomField&&n.controlName===j.m.Regex||n.isCustomField&&n.controlName===j.m.Url){var O;e.rule.rules[s][j.c.Name]=n.name,n.isMandatory||e.rule.rules[s].value||(e.rule.rules[s].value=null);var x=new T.g({autocomplete:"off",placeholder:Object(y.a)("TEXTBOXPLACEHOLDER"),value:a.values,multiline:n.controlName===j.m.Textarea,floatLabelType:"Never",showClearButton:n.controlName!==j.m.Textarea&&!n.isMandatory,change:function(){e.valueText[l.field]=x.value,d(e,x.element,x.value.trim())},blur:function(){var e=a.elements.parentElement.parentElement.querySelector(".hd-toast-success"),t=a.elements.parentElement.parentElement.querySelector(".hd-warning-icon");if(n.controlName===j.m.Regex&&x.value)if((O=Object(f.o)(x.value,n.validationRegex))&&!e){x.element.parentElement.classList.remove("e-error");var i=document.createElement("span");i.innerHTML='<span class="hd-icon hd-toast-success hd-success success-icon action-icons" data-non-elliptical="true" data-title="Valid"></span>',a.elements.parentElement.parentElement.append(i)}else if(!O&&!t){x.element.parentElement.classList.add("e-error");var r=document.createElement("span");r.innerHTML='<span class="hd-icon hd-warning-icon required success-icon action-icons" data-non-elliptical="true" data-title="Invalid"></span>',a.elements.parentElement.parentElement.append(r)}n.isMandatory&&Object(f.c)(x)},focus:function(){if(n.controlName===j.m.Regex){var e=a.elements.parentElement.parentElement.querySelector(".hd-toast-success"),t=a.elements.parentElement.parentElement.querySelector(".hd-warning-icon");e&&e.parentElement.remove(),t&&t.parentElement.remove()}Object(f.l)(x)}});x.value&&(e.valueText[l.field]=x.value),n.isMandatory||r.appendInfoTextForValueField(a),x.appendTo("#"+a.elements.id)}else if(l.field===j.f.Duedate||n.controlName===j.m.DateTime&&n.isCustomField){var C=r.getRuleIndex(a);e.rule.rules[C][j.c.Name]=n.name,n.isMandatory||e.rule.rules[C].value||(e.rule.rules[C].value=null);var q=new S.d({placeholder:Object(y.a)("DATETIMEPICKERPLACEHOLDER"),value:a.values?Array.isArray(a.values)?Object(h.u)(a.values[0]):Object(h.u)(a.values):null,floatLabelType:"Never",showClearButton:!n.isMandatory,allowEdit:!0,change:function(){e.valueText[l.field]=q.value?Object(h.n)(q.value.toString()):null,d(e,q.element,q.value?Object(h.n)(q.value.toString()):null)},blur:function(){n.isMandatory&&Object(f.c)(q)},focus:function(){Object(f.l)(q)}});if(q.value&&"Invalid Date"!==q.value.toString()&&(e.valueText[l.field]=Object(h.n)(q.value.toString())),q.appendTo("#"+a.elements.id),!n.isMandatory){var E=document.createElement("span");E.innerHTML="<span class='secondary mandatory-false' style='float:right'>".concat(Object(y.a)("EMPTYVALUESINAUTOMATION"),"</span>"),a.elements.parentElement.parentElement.append(E)}}else if(n.controlName===j.m.Date&&n.isCustomField){e.rule.rules[s][j.c.Name]=n.name,n.isMandatory||e.rule.rules[s].value||(e.rule.rules[s].value=null);var R=new S.b({placeholder:Object(y.a)("DATETIMEPICKERPLACEHOLDER"),value:a.values?Array.isArray(a.values)?Object(h.u)(a.values[0]):Object(h.u)(a.values):null,floatLabelType:"Never",showClearButton:!n.isMandatory,allowEdit:!0,change:function(){e.valueText[l.field]=R.value?Object(h.F)(R.value.toString()):null,d(e,R.element,R.value?Object(h.F)(R.value.toString()):null)},blur:function(){n.isMandatory&&Object(f.c)(R)},focus:function(){Object(f.l)(R)}});if(R.value&&"Invalid Date"!==R.value.toString()&&(e.valueText[l.field]=Object(h.n)(R.value.toString())),R.appendTo("#"+a.elements.id),!n.isMandatory){var B=document.createElement("span");B.innerHTML="<span class='secondary mandatory-false' style='float:right'>".concat(Object(y.a)("EMPTYVALUESINAUTOMATION"),"</span>"),a.elements.parentElement.parentElement.append(B)}}else if(l.field===j.f.UpdateAssignee){var I,N,D;r.itemAddedGroup=!1,r.itemAddedAssignee=!1;var w=e.rule.rules[s].custom;if(w&&(w.filter((function(e){return e.key===j.n.Group}))[0]&&(D=w.filter((function(e){return e.key===j.n.Group}))[0].value)&&(r.groupActionQuery=D>0?(new b.g).addParams("includeAdditionalIds",D):"",setTimeout((function(){r.assigneeDataConfig=new b.a({url:A.a.AssigneeByGroupId+D+"/members",adaptor:new g.b}),r.cd.detectChanges(),r.groupValueForDetails=D||""}))),w.filter((function(e){return e.key===j.n.Assignee}))[0])){var k=w.filter((function(e){return e.key===j.n.Assignee}))[0].value;k&&(r.assigneeActionQuery=k>0?(new b.g).addParams(j.r.User,k):"",setTimeout((function(){k===j.w.EventPerformer?(r.assigneeTextForDetails=j.x.EventPerformer,r.assigneeValueForDetails=k):r.assigneeValueForDetails=k||""}),1e3))}a.elements.parentElement.classList.add("action-assignee-style"),setTimeout((function(){var i=t.nativeElement.querySelector("#"+a.elements.id+" #assigneeGroupDrop");if(I=i.ej2_instances[0],e.rule.rules[s][j.c.Name]=n.name,I.value&&w){var o=w.filter((function(e){return e.key===j.n.Group}))[0].value;r.qryBldrObjAction.rule.rules[s][j.c.GroupInSetAssignee]=Object(f.g)(o,j.f.UpdateAssignee).toString(),w.filter((function(e){return e.key===j.n.AssigneeType}))[0]&&(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=w.filter((function(e){return e.key===j.n.AssigneeType}))[0].value)}I.change.subscribe((function(){var t=I.itemData,i=t?t.groupID:null;Object(f.d)(e,s,u,i,j.n.Group),Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].groupText=I.text,r.qryBldrObjAction.rule.rules[s][j.c.GroupInSetAssignee]=i?Object(f.g)(i,j.f.UpdateAssignee).toString():"",r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]="",null===N.value&&null==I.value&&(Object(f.d)(e,s,u,"",j.n.Assignee),r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]=""),null===N.value&&null!==I.value?(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.Group.toString(),Object(f.d)(e,s,u,j.d.Group.toString(),j.n.AssigneeType)):null===I.value&&null!==N.value?(r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]=N.value?Object(f.g)(N.value,j.f.UpdateAssignee).toString():"",r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.Agent.toString(),Object(f.d)(e,s,u,j.d.Agent.toString(),j.n.AssigneeType)):null!==N.value&&null!==I.value&&(r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]=N.value?Object(f.g)(N.value,j.f.UpdateAssignee).toString():"",r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.AgentAndGroup.toString(),Object(f.d)(e,s,u,j.d.AgentAndGroup.toString(),j.n.AssigneeType))})),I.blur.subscribe((function(){n.isMandatory&&(r.setAssigneeVaidationFail=!r.assigneeGroupDrop.value&&!r.assigneeDrop.value)}));var c=t.nativeElement.querySelector("#"+a.elements.id+" #assigneeDrop");if(N=c.ej2_instances[0],w){var d=w.filter((function(e){return e.key===j.n.Assignee})).length>0?w.filter((function(e){return e.key===j.n.Assignee}))[0].value:"";r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]=d?Object(f.g)(d,j.f.UpdateAssignee).toString():"",w.filter((function(e){return e.key===j.n.AssigneeType}))[0]&&(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=w.filter((function(e){return e.key===j.n.AssigneeType}))[0].value)}N.change.subscribe((function(){var t=N.itemData,i=t?t.userId:null,n=r.getRuleIndex(a);e.rule.rules[n].custom?Object(f.e)(e,s,i,j.n.Assignee):Object(f.d)(e,s,u,i,j.n.Assignee),r.qryBldrObjAction.rule.rules[s][j.c.AgentInUpdateAssignee]=i?Object(f.g)(i,j.f.UpdateAssignee).toString():"",Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].assigneeText=N.text,null===I.value&&null!==N.value?(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.Agent.toString(),Object(f.d)(e,s,u,j.d.Agent.toString(),j.n.AssigneeType)):null===N.value&&null!==I.value&&(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.Group.toString(),Object(f.d)(e,s,u,j.d.Group.toString(),j.n.AssigneeType)),null!==N.value&&null!==I.value&&(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]=j.d.AgentAndGroup.toString(),Object(f.d)(e,s,u,j.d.AgentAndGroup.toString(),j.n.AssigneeType)),null===N.value&&null===I.value&&(r.qryBldrObjAction.rule.rules[s][j.c.AssigneeTypeInUpdateAssignee]="",Object(f.d)(e,s,u,"",j.n.AssigneeType))})),N.blur.subscribe((function(){n.isMandatory&&(r.setAssigneeVaidationFail=!r.assigneeGroupDrop.value&&!r.assigneeDrop.value)}))})),n.isMandatory||r.appendInfoTextForValueField(a)}else if(l.field===j.f.AddNote){var F=e.rule.rules[s].custom;F&&(r.notesContentValueForDetails=F.filter((function(e){return e.key===j.n.RTENotes}))[0]?F.filter((function(e){return e.key===j.n.RTENotes}))[0].value:null),a.elements.parentElement.classList.add("e-add-private-note"),setTimeout((function(){var i=t.nativeElement.querySelector("#"+a.elements.id+" #automationAction_private_notes_RTE").ej2_instances[0];e.rule.rules[s][j.c.Name]=n.name,i.change.subscribe((function(){i.element.classList.add("e-template"),Object(f.d)(e,s,u,i.value,j.n.RTENotes),r.queryBuildervalueUpdate(r.qryBldrObjAction,i.element,i.value)}))}))}else if(l.field===j.f.SendUserNotification){r.itemAddedAssigneeEmail=!1;var G=e.rule.rules[s].custom;G&&(r.rteValueForUserDetails=Object(f.h)(G,j.n.RTEUserNotificationContent),r.subValueForUserDetails=Object(f.h)(G,j.n.SubjUserNotificationContent),r.userValueForUserDetails=Object(f.h)(G,j.n.AssigneeUserNotificationValue),r.userValuePersistForUser=JSON.parse(JSON.stringify(r.userValueForUserDetails)),r.userValueForUserDetails&&(r.userActionNotifyQuery=(new b.g).addParams(j.r.User,r.userValueForUserDetails)),r.cd.detectChanges()),a.elements.parentElement.classList.add("e-add-private-note"),setTimeout((function(){e.rule.rules[s][j.c.Name]=n.name;var i=t.nativeElement.querySelector("#"+a.elements.id+" #automationAction_user_email_RTE").ej2_instances[0];i.element.classList.add("e-template"),i.focusIn(),i.value&&(r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationBodyContent]=i.value,Object(f.d)(e,s,u,i.value,j.n.RTEUserNotificationContent)),i.change.subscribe((function(){Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].body=i.value,r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationBodyContent]=i.value,Object(f.d)(e,s,u,i.value,j.n.RTEUserNotificationContent)}));var o=t.nativeElement.querySelector("#"+a.elements.id+" #subjectUserField").ej2_instances[0];o.value&&(r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationSubjectContent]=o.value,Object(f.d)(e,s,u,o.value,j.n.SubjUserNotificationContent)),o.change.subscribe((function(){Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].subject=o.value,r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationSubjectContent]=o.value,Object(f.d)(e,s,u,o.value,j.n.SubjUserNotificationContent)}));var c=t.nativeElement.querySelector("#"+a.elements.id+" #assigneeDropEmail").ej2_instances[0];if(c.value){var d=r.getRuleIndex(a);e.rule.rules[d].value=c.value?Object(f.g)(c.value).toString():null,Object(f.d)(e,s,u,c.value,j.n.AssigneeUserNotificationValue)}c.change.subscribe((function(){for(var t=c.value.map(String),i=0;i<t.length;i++){t[i]===j.w.AssignedAgent.toString()?t[i]=j.v.AssignedAgent:t[i]===j.w.Requester.toString()&&(t[i]=j.v.Requester);var n=r.getRuleIndex(a);e.rule.rules[n].value=t?t.toString():""}Object(f.d)(e,s,u,c.value,j.n.AssigneeUserNotificationValue),e.valueText[l.field]||(e.valueText[l.field]={}),e.valueText[l.field].assigneeText=c.text}))}))}else if(l.field===j.f.SendGroupNotification){r.itemAddedGroupEmail=!1;var P=e.rule.rules[s].custom;P&&(r.rteValueForGroupDetails=Object(f.h)(P,j.n.RteGroupContent),r.subValueForGroupDetails=Object(f.h)(P,j.n.SubjectGroupContent),r.userValueForGroupDetails=Object(f.h)(P,j.n.AssigneeGroupNotificationValue),r.userValuePersistForGroup=JSON.parse(JSON.stringify(r.userValueForGroupDetails)),r.userValueForGroupDetails===j.w.AssignedGroup&&(r.userValueForGroupDetailsText=j.x.AssignedGroup),r.userValueForGroupDetails&&(r.groupActionNotifyQuery=(new b.g).addParams("includeAdditionalIds",r.userValueForGroupDetails))),a.elements.parentElement.classList.add("e-add-private-note"),setTimeout((function(){var i=t.nativeElement.querySelector("#"+a.elements.id+" #automationAction_group_email_RTE").ej2_instances[0];i.element.classList.add("e-template"),i.focusIn(),e.rule.rules[s][j.c.Name]=n.name,i.value&&(r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationBodyContent]=i.value,Object(f.d)(e,s,u,i.value,j.n.RteGroupContent)),i.change.subscribe((function(){Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].body=i.value,r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationBodyContent]=i.value,Object(f.d)(e,s,u,i.value,j.n.RteGroupContent)}));var o=t.nativeElement.querySelector("#"+a.elements.id+" #subjectGroupField").ej2_instances[0];o.value&&(r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationSubjectContent]=o.value,Object(f.d)(e,s,u,o.value,j.n.SubjectGroupContent)),o.change.subscribe((function(){Object(p.X)(e.valueText[l.field])&&(e.valueText[l.field]={}),e.valueText[l.field].subject=o.value,r.qryBldrObjAction.rule.rules[s][j.c.SendNotificationSubjectContent]=o.value,Object(f.d)(e,s,u,o.value,j.n.SubjectGroupContent)}));var c=t.nativeElement.querySelector("#"+a.elements.id+" #assigneeGroupDropEmail").ej2_instances[0];if(c.value){var d=r.getRuleIndex(a);e.rule.rules[d].value=c.value?c.value.toString()===j.w.AssignedGroup.toString()?j.v.AssignedGroup:c.value.toString():null,Object(f.d)(e,s,u,c.value,j.n.AssigneeGroupNotificationValue)}c.change.subscribe((function(){for(var t=c.value.map(String),i=0;i<t.length;i++)t[i]===j.w.AssignedGroup.toString()&&(t[i]=j.v.AssignedGroup);var n=r.getRuleIndex(a);e.rule.rules[n].value=t?t.toString():"",Object(f.d)(e,s,u,c.value,j.n.AssigneeGroupNotificationValue),e.valueText[l.field]||(e.valueText[l.field]={}),e.valueText[l.field].groupText=c.text}))}))}else if(l.field===j.f.AddTags||l.field===j.f.RemoveTags||l.field===j.f.AddCcs||l.field===j.f.RemoveCcs||l.field===j.f.AddWatchers){setTimeout((function(){e.rule.rules[s][j.c.Name]=n.name})),n.isMandatory||e.rule.rules[s].value||(e.rule.rules[s].value=null);var L=e.rule.rules[s].custom,U=new m.g({showClearButton:!n.isMandatory,dataSource:Object(f.j)(n.field,n.isCustomField),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),allowFiltering:!0,allowCustomValue:!0,locale:n.field===j.f.AddTags||n.field===j.f.RemoveTags?"customRecordsTemplate":"en-US",popupHeight:v.g,popupWidth:l.field===j.f.AddCcs||l.field===j.f.RemoveCcs||l.field===j.f.AddWatchers?"250px":"200px",filterBarPlaceholder:Object(y.a)("SEARCH"),fields:Object(f.k)(l.field),itemTemplate:Object(f.m)(l.field,a.operator),mode:n.field===j.f.AddTags||n.field===j.f.RemoveTags?"Box":"CheckBox",floatLabelType:"Never",showDropDownIcon:!0,value:n.field===j.f.AddTags?L?Object(f.h)(L,j.n.AddTags):"":n.field===j.f.RemoveTags?L?Object(f.h)(L,j.n.RemoveTags):"":Object(f.f)(a.values,n.field,a.operator),change:function(){l.field===j.f.AddTags||l.field===j.f.RemoveTags?(e.valueText[l.field]=U.text,d(e,U.element,U.text),l.field===j.f.AddTags?Object(f.d)(e,s,u,U.value,j.n.AddTags):l.field===j.f.RemoveTags&&Object(f.d)(e,s,u,U.value,j.n.RemoveTags)):(e.valueText[l.field]=U.text,d(e,U.element,U.value?U.value.toString():null))},blur:function(){n.isMandatory&&Object(f.c)(U)},focus:function(){Object(f.l)(U)},dataBound:function(){U.value&&U.change()}});U.value&&(U.query=(new b.g).addParams(r.fieldQuery(n.field),U.value.join())),U.text&&(e.valueText[l.field]=U.text),n.isMandatory||r.appendInfoTextForValueField(a),U.appendTo("#"+a.elements.id)}else if(n.isCustomField&&n.controlName===j.m.Multiselect){e.rule.rules[s][j.c.Name]=n.name,n.isMandatory||e.rule.rules[s].value||(e.rule.rules[s].value=null);var M=!1,V=new m.g({dataSource:Object(f.j)(n.field,n.isCustomField),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),allowFiltering:!0,showClearButton:!n.isMandatory,floatLabelType:"Never",popupHeight:v.g,filterBarPlaceholder:Object(y.a)("SEARCH"),fields:Object(f.k)(n.field),itemTemplate:Object(f.m)(n.field,a.operator),mode:"CheckBox",showDropDownIcon:!0,value:Object(f.f)(a.values,n.field,a.operator,n.controlName,n.isCustomField),change:function(){var t=V.value.map(String),i=r.getRuleIndex(a);e.rule.rules[i][j.c.Name]=n.name,d(e,V.element,t?t.toString():null),e.valueText[l.field]=V.text},blur:function(){!V.value&&n.isMandatory&&Object(f.c)(V)},focus:function(){Object(f.l)(V)},dataBound:function(){M=Object(f.i)(n.field,M,V,r.eventType,n.isCustomField,n.isMandatory,n.controlName,r.automationId),V.value&&V.change()}});V.value&&(e.valueText[l.field]=V.text),r.isFieldNeedFullReqData(n.field)?V.query=n.isCustomField?(new b.g).addParams("page","1").addParams("perPage",""+v.E).addParams(j.r.IncludeReadOnlyAlso,"false"):(new b.g).addParams("page","1").addParams("perPage",""+v.E):V.value&&(V.query=(new b.g).addParams(r.fieldQuery(n.field),V.value.join())),n.isMandatory||r.appendInfoTextForValueField(a),V.appendTo("#"+a.elements.id)}else if(n.isCustomField&&n.controlName===j.m.Numeric||n.isCustomField&&n.controlName===j.m.Decimal){e.rule.rules[s][j.c.Name]=n.name;var H=new T.e({placeholder:Object(y.a)("NUMERICBOXPLACEHOLDER"),value:null===a.values?null:+a.values,floatLabelType:"Never",showClearButton:!n.isMandatory,width:"188px",min:0,format:n.controlName===j.m.Decimal?"###.##":"###",decimals:n.controlName===j.m.Decimal?2:0,validateDecimalOnType:!0,change:function(){var t=r.getRuleIndex(a);e.rule.rules[t][j.c.Name]=n.name;var i=H.value?H.value.toString():null;d(e,H.element,i),e.valueText[l.field]=H.value?H.value.toString():null},blur:function(){!H.value&&n.isMandatory&&Object(f.c)(H)},focus:function(){Object(f.l)(H)}});n.isMandatory||r.appendInfoTextForValueField(a),H.appendTo("#"+a.elements.id),H.value&&H.change()}else if(!n.controlName||""===n.controlName||n.isCustomField&&n.controlName===j.m.Dropdown||n.isCustomField&&n.controlName===j.m.CheckBox||n.isCustomField&&n.controlName===j.m.RadioButton){var _=!1;e.rule.rules[s][j.c.Name]=n.name;var J=new m.d({dataSource:Object(f.j)(n.field,n.isCustomField,n.controlName),showClearButton:!n.isMandatory,allowFiltering:!0,filterBarPlaceholder:Object(y.a)("SEARCH"),popupHeight:v.g,fields:Object(f.k)(l.field),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),itemTemplate:Object(f.m)(l.field,a.operator),value:Object(h.D)(a.values)?null:+a.values,text:a.values===j.v.None?"None":"",floatLabelType:"Never",created:function(){},dataBound:function(){_=Object(f.i)(n.field,_,J,r.eventType,n.isCustomField,n.isMandatory,n.controlName,r.automationId),(J.value||0===J.value)&&setTimeout((function(){J.change()}))},change:function(){if(J.itemData||!n.isMandatory){var t=r.getRuleIndex(a);e.rule.rules[t][j.c.Name]=n.name,e.valueText[l.field]=J.text,d(e,J.element,n.isCustomField&&n.controlName===j.m.CheckBox||n.isCustomField&&n.controlName===j.m.RadioButton?1===J.value:J.value?J.value.toString():null)}},blur:function(){(n.isMandatory&&n.controlName!==j.m.CheckBox||n.isMandatory&&n.controlName===j.m.CheckBox&&Object(h.D)(J.value))&&Object(f.c)(J)},focus:function(){Object(f.l)(J)}});if(r.isFieldNeedFullReqData(n.field)?J.query=n.isCustomField?(new b.g).addParams("page","1").addParams("perPage",""+v.E).addParams(j.r.IncludeReadOnlyAlso,"false"):(new b.g).addParams("page","1").addParams("perPage",""+v.E):J.value&&(J.query=(new b.g).addParams(r.fieldQuery(n.field,n.isCustomField),""+J.value)),(J.value||0===J.value)&&(e.valueText[l.field]=J.text),!J.value){var Q=Object(f.a)(n.field,r.eventType,n.isCustomField,n.isMandatory,n.controlName);Q&&(Q.filter((function(e){return"None"===e.name})).length||Q.filter((function(e){return"None"===e.groupName})).length||Q.filter((function(e){return"None"===e.displayName})))}n.isMandatory||r.appendInfoTextForValueField(a),J.appendTo("#"+a.elements.id),n.field===j.f.Priority&&J.value&&setTimeout((function(){J.change()}))}}}}},{key:"assigneeType",value:function(e){switch(e){case 1:return"Agent";case 2:return"Group";case 3:return"AgentAndGroup"}}},{key:"receiverType",value:function(e){switch(e){case 1:return"Group";case 2:return"User";case 3:return"ExternalUser"}}},{key:"summaryClick",value:function(){this.saveDialog=!1,this.saveRuleDialog.show()}},{key:"renderRuleSummary",value:function(e){this.textBoxRuleFocusOut(),this.validateConditionValueField(),this.isConditionTabValid(),Object(f.p)(this.qryBldrObjRule,this.querybuilderAdditionalProp),this.validateConditionValueField(),!this.validCondition||!this.validConditionForGroup||this.ruleNameRequired||this.conditionErrorAndRule||this.conditionErrorOrRule||this.operationalHoursRequired?(e.cancel=!0,this.validationFailCheckForSummaryAndNextBtn()):this.summaryFraming()}},{key:"overlayDialogClick",value:function(){this.saveRuleDialog.hide()}},{key:"isFieldNeedFullReqData",value:function(e){return-1!==["statusId","status","TypeId","type","BrandId","SourceId","RequesterRole"].indexOf(e)}},{key:"fieldQuery",value:function(e,t){return e===j.f.AddCcs||e===j.f.RemoveCcs||e===j.h.RequestedBy||e===j.f.AddWatchers?j.r.User:e===j.h.GroupId?j.r.Group:e===j.f.Category?j.r.Category:e===j.h.RequesterCountry?j.r.RequesterCountry:e===j.h.RequesterTimeZone?j.r.RequesterTimeZone:e===j.h.RequesterLanguage?j.r.RequesterLanguage:e===j.h.SupportTierId?j.r.SupportTier:e===j.f.AddTags||e===j.f.RemoveTags?j.r.Tags:t?j.r.InclusionIds:j.r.IncludeAdditionalIds}},{key:"validationFailCheckForSummaryAndNextBtn",value:function(){if(this.ruleNameObj.value){if(this.operationalHoursRequired)this.bussinessHours.focusIn();else if(this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field){var e=this.qryBldrObjRule.element.querySelectorAll(".e-error");if(0===e.length)return;var t=e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");t&&t.ej2_instances[0].focusIn()}else if(this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field){var i=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error"),n=i[0]?i[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker"):"";n&&n.ej2_instances[0].focusIn()}else if(this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field){var r=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error"),a=this.qryBldrObjRule.element.querySelectorAll(".e-error");if(a.length>0){var o=a[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");o&&o.ej2_instances[0].focusIn()}else if(r.length>0){var l=r[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");l&&l.ej2_instances[0].focusIn()}}}else this.queryBuilderContainerEle.nativeElement.scrollIntoView(!0),this.ruleNameObj.focusOut(),this.ruleNameObj.focusIn()}},{key:"btnClick",value:function(e){var t=this;switch(e.target.id){case"nextCondition":this.nameRule=this.ruleNameObj.value,this.isConditionTabValid(),Object(f.p)(this.qryBldrObjRule,this.querybuilderAdditionalProp),this.validateConditionValueField(),setTimeout((function(){!t.validCondition||!t.validConditionForGroup||t.ruleNameRequired||t.conditionErrorAndRule||t.conditionErrorOrRule||t.operationalHoursRequired?t.validationFailCheckForSummaryAndNextBtn():(t.activityTab.enableTab(1,!0),t.activityTab.enableTab(0,!1),t.actionNotesRTE&&t.actionNotesRTE.rteObj.refreshUI(),t.actionEmailUserRTE&&t.actionEmailUserRTE.rteObj.refreshUI(),t.actionEmailGroupRTE&&t.actionEmailGroupRTE.rteObj.refreshUI(),(t.automationId&&t.qryBldrObjAction.rule.rules.length>1||""!==t.qryBldrObjAction.rule.rules[0].field)&&(t.validAction=t.qryBldrObjAction.validateFields()))}),500);break;case"previousPage":this.closeErrorTooltipForQueryBuilder(),this.activityTab.enableTab(0,!0),this.activityTab.enableTab(1,!1),this.activityTab.select(0);break;case"saveCondition":this.isActionTabValid(),this.validateAction(),setTimeout((function(){if(t.validateActionValueField(),t.eventType===j.l.AutoAssignmentAutomation&&(t.autoAssignmentGroupDrop.value||(t.invalidGroup=!0)),!t.qryBldrObjAction.validateFields()||t.actionError||t.setAssigneeVaidationFail||t.invalidGroup){var e=t.qryBldrObjAction.element.querySelectorAll(".e-error:not(.added-class)"),i=t.qryBldrObjAction.element.querySelectorAll(".e-error.added-class");if(e.length>0){var n=e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");n&&n.ej2_instances[0].focusIn()}else i.length>0&&(i[0].classList.contains("e-richtexteditor")?(i[0].ej2_instances[0].element.classList.remove("e-error","added-class"),i[0].ej2_instances[0].element.ej2_instances[0].focusIn()):i[0].parentElement.ej2_instances[0].focusIn())}else t.ruleSaveEvent()}));break;case"updateCondition":this.isActionTabValid(),this.validateAction(),setTimeout((function(){if(t.validateActionValueField(),t.eventType===j.l.AutoAssignmentAutomation&&(t.autoAssignmentGroupDrop.value||(t.invalidGroup=!0)),!t.qryBldrObjAction.validateFields()||t.actionError||t.setAssigneeVaidationFail||t.invalidGroup){var e=t.qryBldrObjAction.element.querySelectorAll(".e-error:not(.added-class)"),i=t.qryBldrObjAction.element.querySelectorAll(".e-error.added-class");if(e.length>0){var n=e[0].querySelector(".e-dropdownlist, .e-textbox, .e-multiselect .e-control, .e-datepicker");n&&n.ej2_instances[0].focusIn()}else i.length>0&&(i[0].classList.contains("e-richtexteditor")?(i[0].ej2_instances[0].element.classList.remove("e-error","added-class"),i[0].ej2_instances[0].element.ej2_instances[0].focusIn()):i[0].parentElement.ej2_instances[0].focusIn())}else t.ruleUpdateEvent()}));break;case"saveAndEnableCondition":this.enable=!0,this.ruleSaveEvent()}}},{key:"tabCreate",value:function(){this.activityTab.enableTab(1,!1)}},{key:"toggleChange",value:function(e){this.enable=!!e.checked}},{key:"tabSelecting",value:function(e){e.isSwiped&&(e.cancel=!0)}},{key:"assignmentTypeChange",value:function(e){e.value===j.e.RoundRobin?(this.assigneeDrop.enabled=!1,this.assigneeDrop.value=null):this.assigneeDrop.enabled=!0}},{key:"assigneeGroupBlur",value:function(e){e.value||(e.cssClass="e-error added-class")}},{key:"assigneeGroupFocus",value:function(){}},{key:"validateAction",value:function(){for(var e=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-multiselect .e-control:not(.action-added-template), .e-rule-value .e-dropdownlist:not(.action-added-template):not(.action-added-template-assignee), .e-rule-value .e-textbox:not(.action-added-template), .e-rule-value .e-datepicker:not(.action-added-template)"),t=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-dropdownlist.action-added-template:not(.action-assignee)"),i=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-dropdownlist.action-added-template.action-assignee"),n=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-textbox.action-added-template"),r=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-richtexteditor"),a=0;a<e.length;a++)e[a].ej2_instances[0].blur();for(var o=0;o<t.length;o++)this.assigneeGroupBlur(t[o].ej2_instances[0]);for(var l=0;l<n.length;l++)this.assigneeGroupBlur(n[l].ej2_instances[0]);for(var s=0;s<r.length;s++){var u=r[s].ej2_instances[0];u.value||u.element.classList.add("e-error","added-class")}for(var c=0;c<i.length;c++)this.setAssigneeBlur()}},{key:"validateConditionValueField",value:function(){var e=this.qryBldrObjRule.element.querySelectorAll(".e-error"),t=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error");this.conditionErrorAndRule=e.length>0,this.conditionErrorOrRule=t.length>0}},{key:"validateActionValueField",value:function(){var e=this.qryBldrObjAction.element.querySelectorAll(".e-error");this.actionError=e.length>0}},{key:"rteBlur",value:function(e){e.rteObj.value||e.rteObj.element.classList.add("e-error","added-class")}},{key:"rteFocus",value:function(e){this.focusedEleValue="Description",e.rteObj.element&&e.rteObj.element.classList.remove("e-error","added-class")}},{key:"setAssigneeBlur",value:function(){this.assigneeGroupDrop.change.emit({skipUpdate:!0})}},{key:"setAssigneeFocus",value:function(){this.setAssigneeVaidationFail=!1}},{key:"autoAssignmentGroupDropBlur",value:function(){this.invalidGroup=!this.autoAssignmentGroupDrop.value}},{key:"autoAssignmentGroupDropFocus",value:function(){this.invalidGroup=!1}},{key:"closeErrorTooltipForQueryBuilder",value:function(){for(var e=this.queryBuilderContainerEle.nativeElement.querySelectorAll(".e-rule-filter"),t=0;t<e.length;t++)e[t].firstElementChild.ej2_instances[1]&&"tooltip"===e[t].firstElementChild.ej2_instances[1].getModuleName()&&(e[t].firstElementChild.ej2_instances[1].isHidden||e[t].firstElementChild.ej2_instances[1].close());for(var i=this.queryBuilderContainerEle.nativeElement.querySelectorAll(".e-control .e-dropdownlist"),n=0;n<i.length;n++){var r=Object(p.M)(i[n],"dropdownlist");r.isPopupOpen&&r.hidePopup()}}},{key:"appendInfoTextForValueField",value:function(e){var t=document.createElement("span");t.innerHTML="<span class='secondary mandatory-false' style='float:right'>".concat(Object(y.a)("EMPTYVALUESINAUTOMATION"),"</span>"),e.elements.parentElement.append(t)}},{key:"getRuleIndex",value:function(e){var t=Object(p.C)(e.elements,".e-rule-container");return[].slice.call(t.parentElement.children).indexOf(t)}}]),t}()).\u0275fac=function(e){return new(e||Pe)(c.Nb(c.O),c.Nb(s.g),c.Nb(q.a),c.Nb(E.a),c.Nb(R.a),c.Nb(d.a),c.Nb(c.h),c.Nb(B.a))},Pe.\u0275cmp=c.Hb({type:Pe,selectors:[["app-automation-ticket"]],viewQuery:function(e,t){var i;1&e&&(c.Gc(P,!0),c.Gc(L,!0),c.Gc(U,!0),c.Gc(M,!0),c.Gc(V,!0),c.Gc(H,!0),c.Gc(_,!0),c.Gc(J,!0),c.Qc(Q,!0),c.Qc(W,!0),c.Qc(K,!0),c.Qc(X,!0),c.Qc(z,!0),c.Qc($,!0),c.Qc(Y,!0),c.Qc(Z,!0),c.Qc(ee,!0),c.Gc(te,!0),c.Qc(ie,!0),c.Qc(ne,!0),c.Qc(re,!0),c.Qc(ae,!0),c.Gc(oe,!0),c.Qc(le,!0),c.Qc(se,!0),c.Qc(ue,!0),c.Qc(ce,!0)),2&e&&(c.xc(i=c.fc())&&(t.qryBldrObjRule=i.first),c.xc(i=c.fc())&&(t.querybuilderAdditionalProp=i.first),c.xc(i=c.fc())&&(t.qryBldrObjAction=i.first),c.xc(i=c.fc())&&(t.ruleNameObj=i.first),c.xc(i=c.fc())&&(t.ruleDescription=i.first),c.xc(i=c.fc())&&(t.queryBuilderContainerEle=i.first),c.xc(i=c.fc())&&(t.ruleContainerEle=i.first),c.xc(i=c.fc())&&(t.ruleContainerActionEle=i.first),c.xc(i=c.fc())&&(t.actionNotesTemplate=i.first),c.xc(i=c.fc())&&(t.actionEmailTemplate=i.first),c.xc(i=c.fc())&&(t.actionAssigneeTemplate=i.first),c.xc(i=c.fc())&&(t.assigneeDropEmail=i.first),c.xc(i=c.fc())&&(t.assigneeGroupDropEmail=i.first),c.xc(i=c.fc())&&(t.assigneeGroupDrop=i.first),c.xc(i=c.fc())&&(t.assigneeDrop=i.first),c.xc(i=c.fc())&&(t.bussinessHours=i.first),c.xc(i=c.fc())&&(t.enableDisableSwitch=i.first),c.xc(i=c.fc())&&(t.activityTab=i.first),c.xc(i=c.fc())&&(t.saveRuleDialog=i.first),c.xc(i=c.fc())&&(t.assignmentTypeDrpDwn=i.first),c.xc(i=c.fc())&&(t.actionUserEmailTemplate=i.first),c.xc(i=c.fc())&&(t.actionGroupEmailTemplate=i.first),c.xc(i=c.fc())&&(t.subjectGroupField=i.first),c.xc(i=c.fc())&&(t.actionNotesRTE=i.first),c.xc(i=c.fc())&&(t.autoAssignmentGroupDrop=i.first),c.xc(i=c.fc())&&(t.actionEmailUserRTE=i.first),c.xc(i=c.fc())&&(t.actionEmailGroupRTE=i.first))},inputs:{orConditionRules:"orConditionRules",andConditionRules:"andConditionRules",actionRules:"actionRules",name:"name",description:"description",onOff:"onOff",eventType:"eventType",typeId:"typeId",automationId:"automationId",businessId:"businessId",groupValueForAutoAssignment:"groupValueForAutoAssignment",summary:"summary"},features:[c.wb([x.a])],decls:119,vars:83,consts:[[1,"custom-rule-tab"],["id","element",3,"animation","created","selecting"],["activityTab",""],[1,"e-tab-header"],[1,"flex","align-center"],["id","update_count_id",1,"hide","ticket-indication-count"],[4,"ngIf"],["class","custom-summary flex",4,"ngIf"],[1,"e-content"],["queryBuilderContainer",""],[1,"control-section","pt-3"],[1,"control-section","p-0"],["id","ruleContainer",1,"rule-condition-container"],["ruleContainer",""],[1,"mt-15"],[1,"cutom-field-label"],[1,"error"],["id","ruleName","autocomplete","off",3,"placeholder","value","htmlAttributes","created","blur","focus"],["ruleName",""],["id","ruleDescription","autocomplete","off",3,"placeholder","htmlAttributes","value"],["ruleDescription",""],[1,"mb-0"],[1,"query-rule-prop-container",3,"ngClass"],[1,"radio-style"],[1,"fw-600"],["id","querybuilder","width","100%","maxGroupCount","1","allowValidation","true","cssClass","hd-query-condition",3,"columns","showButtons","ngClass","rule","created","change","ruleChange"],["querybuilderProp",""],[1,"p-1","pl-2","query-action-button","add-condition-border"],["ejs-button","","iconCss","hd-icon hd-plus",1,"e-btn","e-flat","no-border",3,"click"],[1,"rule-sepeartion"],[1,"and-seperation"],[1,"text-style","uppercase"],[1,"and-seperation-position"],[1,"mt-25"],["id","querybuilderAdditional","width","100%","maxGroupCount","1","allowValidation","true","cssClass","hd-query-condition",3,"columns","showButtons","ngClass","rule","created","change","ruleChange"],["querybuilderAdditionalProp",""],[1,"p-1","pl-2","query-action-button"],[1,"mb-15","fl-r"],["ejs-button","","id","nextCondition","cssClass","e-btn",1,"mr-15","e-control","e-lib","e-btn","e-primary",3,"mousedown"],["id","ruleContainerAction",1,"rule-condition-container"],["ruleContainerAction",""],[3,"ngClass"],[1,"query-rule-action-container",3,"ngClass"],["id","querybuilder-action","width","100%","cssClass","hd-query-action","allowValidation","true",3,"columns","rule","ngClass","change","ruleChange","created","beforeChange"],["querybuilderaction",""],["class","p-1 pl-2 query-action-button",3,"ngClass",4,"ngIf"],["ejs-button","","cssClass","e-outline","id","previousPage",1,"e-btn","mr-15",3,"click"],["actionNotesTemplate",""],["actionAssigneeTemplate",""],[1,"save-dialog"],["id","saveRuleDialog","width","500px","isModal","true","showCloseIcon","true","height","Auto","closeOnEscape","true","cssClass","bd-automation-summary",3,"visible","overlayClick","beforeOpen"],["saveRuleDialog",""],["header",""],["content",""],["disabled","true",1,"flex","align-center"],["id","notes_count_id",1,"hide","ticket-indication-count"],[1,"custom-summary","flex"],[1,"align-right"],["ejs-button","","cssClass","e-flat e-btn",3,"click"],[1,"required"],["id","bussinessHours","popupHeight","200px","index","0",3,"placeholder","dataSource","value","query","fields","showClearButton","allowFiltering","filterBarPlaceholder","htmlAttributes","dataBound","created","blur"],["bussinessHours",""],[1,"p-1","pl-2","query-action-button",3,"ngClass"],[1,"mb-20","font-13"],[1,"auto-assignment-details"],[1,"mt-20"],[1,"font-13","font-500"],[1,"form-group","row","dropdown-margin"],[1,"col-6"],["id","autoAssignmentGroupDrop","popupWidth","200px","popupHeight","200px",1,"action-auto-assignee",3,"placeholder","query","dataSource","fields","allowFiltering","showClearButton","value","filterBarPlaceholder","blur","focus"],["autoAssignmentGroupDrop",""],["class","e-error  ml-30 mb-6",4,"ngIf"],[1,"e-error","ml-30","mb-6"],["ejs-button","","id","saveCondition",1,"e-btn",3,"isPrimary","click"],["ejs-button","","id","updateCondition",1,"e-btn",3,"isPrimary","click"],["cssClass","action-added-template",3,"id","isNeedImageUpload","value","label","enablePlaceholder","focusOut","focusIn"],["actionNotesRTE",""],["actionUserEmailTemplate",""],[1,"form-group","row"],["id","assigneeDropEmail","popupWidth","250px","popupHeight","250px","mode","CheckBox",1,"action-added-template",3,"placeholder","value","dataSource","fields","allowFiltering","query","filterBarPlaceholder","dataBound","blur"],["assigneeDropEmail",""],["itemTemplate",""],[1,"form-group"],["id","subjectUserField","data-id","subjectUserField","autocomplete","off",1,"action-added-template","placeholder-subject",3,"placeholder","htmlAttributes","value","blur"],["subjectUserField",""],["cssClass","action-added-template",3,"id","isNeedImageUpload","value","enablePlaceholder","label","focusOut","focusIn"],["actionEmailUserRTE",""],[2,"display","inline-flex","width","calc(100% - 36px)"],[1,"flex-horizontal","ellipsis","no-wrap",2,"padding","5px"],[1,"wrapper","flex-horizontal","full-width"],[1,"flex-vertical","no-wrap","ellipsis",2,"text-indent","initial"],[1,"e-text"],[1,"font-12"],["actionGroupEmailTemplate",""],["id","assigneeGroupDropEmail","popupHeight","200px","popupWidth","200px","mode","CheckBox",1,"action-added-template",3,"placeholder","dataSource","fields","allowFiltering","query","value","filterBarPlaceholder","text","dataBound","blur"],["assigneeGroupDropEmail",""],["id","subjectGroupField","data-id","subjectGroupField","autocomplete","off",1,"action-added-template","placeholder-subject",3,"placeholder","htmlAttributes","value","blur"],["subjectGroupField",""],["actionEmailGroupRTE",""],["id","assigneeGroupDrop","popupWidth","200px","popupHeight","200px",1,"action-added-template","action-assignee",3,"placeholder","query","dataSource","value","fields","allowFiltering","showClearButton","filterBarPlaceholder","text","change","dataBound","blur","focus"],["assigneeGroupDrop",""],["id","assigneeDrop","popupHeight","200px","popupWidth","250px",1,"action-added-template-assignee",3,"placeholder","query","dataSource","value","fields","allowFiltering","showClearButton","filterBarPlaceholder","text","dataBound","change","focus"],["assigneeDrop",""],["class","e-error",4,"ngIf"],[1,"flex-horizontal","p-2",3,"ngClass"],[1,"e-error"],[1,"summary-content",3,"innerHTML"]],template:function(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",0),c.Tb(1,"ejs-tab",1,2),c.ec("created",(function(){return t.tabCreate()}))("selecting",(function(e){return t.tabSelecting(e)})),c.Tb(3,"div",3),c.Tb(4,"div"),c.Tb(5,"span",4),c.Lc(6),c.hc(7,"translate"),c.Sb(),c.Ob(8,"span",5),c.Sb(),c.Jc(9,de,5,3,"div",6),c.Jc(10,pe,5,3,"div",6),c.Sb(),c.Jc(11,me,5,3,"div",7),c.Tb(12,"div",8,9),c.Tb(14,"div"),c.Tb(15,"div",10),c.Tb(16,"div",11),c.Tb(17,"div",12,13),c.Tb(19,"div",14),c.Tb(20,"label",15),c.Lc(21),c.hc(22,"translate"),c.Tb(23,"span",16),c.Lc(24,"*"),c.Sb(),c.Sb(),c.Tb(25,"ejs-textbox",17,18),c.ec("created",(function(){return t.textBoxcreated()}))("blur",(function(){return t.textBoxRuleFocusOut()}))("focus",(function(){return t.textBoxRulefocus()})),c.hc(27,"translate"),c.Sb(),c.Jc(28,be,4,3,"div",6),c.Sb(),c.Tb(29,"div"),c.Tb(30,"label",15),c.Lc(31),c.hc(32,"translate"),c.Sb(),c.Ob(33,"ejs-textbox",19,20),c.hc(35,"translate"),c.Sb(),c.Jc(36,ge,5,12,"div",6),c.Tb(37,"div",21),c.Tb(38,"div"),c.Tb(39,"div",22),c.Tb(40,"div",23),c.Tb(41,"span"),c.Lc(42),c.hc(43,"translate"),c.Sb(),c.Tb(44,"span",24),c.Lc(45),c.hc(46,"translate"),c.Sb(),c.Tb(47,"span"),c.Lc(48),c.hc(49,"translate"),c.Sb(),c.Sb(),c.Tb(50,"ejs-querybuilder",25,26),c.ec("created",(function(){return t.querybuilderCreated()}))("change",(function(e){return t.querybuilderChange(e)}))("ruleChange",(function(){return t.querybuilderRuleChange()})),c.Sb(),c.Sb(),c.Tb(52,"div",27),c.Tb(53,"button",28),c.ec("click",(function(e){return t.newCondition(e,t.qryBldrObjRule)})),c.Lc(54),c.hc(55,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Jc(56,ve,4,3,"div",6),c.Sb(),c.Tb(57,"div",29),c.Tb(58,"div",30),c.Tb(59,"div",31),c.Lc(60),c.hc(61,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Tb(62,"div",32),c.Ob(63,"div",30),c.Sb(),c.Tb(64,"div",33),c.Tb(65,"div"),c.Tb(66,"div",22),c.Tb(67,"div",23),c.Tb(68,"span"),c.Lc(69),c.hc(70,"translate"),c.Sb(),c.Tb(71,"span",24),c.Lc(72),c.hc(73,"translate"),c.Sb(),c.Tb(74,"span"),c.Lc(75),c.hc(76,"translate"),c.Sb(),c.Sb(),c.Tb(77,"ejs-querybuilder",34,35),c.ec("created",(function(){return t.querybuilderAdditionalCreated()}))("change",(function(e){return t.querybuilderAdditionalChange(e)}))("ruleChange",(function(){return t.querybuilderAddRuleChange()})),c.Sb(),c.Sb(),c.Tb(79,"div",36),c.Tb(80,"button",28),c.ec("click",(function(e){c.Bc(i);var n=c.yc(78);return t.newCondition(e,n)})),c.Lc(81),c.hc(82,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Jc(83,fe,4,3,"div",6),c.Sb(),c.Sb(),c.Tb(84,"div",37),c.Tb(85,"button",38),c.ec("mousedown",(function(e){return t.btnClick(e)})),c.Lc(86),c.hc(87,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(88,"div"),c.Tb(89,"div",10),c.Tb(90,"div",11),c.Tb(91,"div",39,40),c.Tb(93,"div",41),c.Tb(94,"div",42),c.Tb(95,"ejs-querybuilder",43,44),c.ec("change",(function(e){return t.querybuilderActionChange(e)}))("ruleChange",(function(){return t.querybuilderActionRuleChange()}))("created",(function(){return t.queryActionCreated()}))("beforeChange",(function(){return t.beforeChange()})),c.Sb(),c.Sb(),c.Jc(97,ye,4,4,"div",45),c.Sb(),c.Jc(98,Ae,4,3,"div",6),c.Jc(99,Oe,23,25,"span",6),c.Sb(),c.Tb(100,"div",37),c.Tb(101,"button",46),c.ec("click",(function(e){return t.btnClick(e)})),c.Lc(102),c.hc(103,"translate"),c.Sb(),c.Jc(104,Se,4,4,"span",6),c.Jc(105,xe,4,4,"span",6),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Jc(106,je,3,7,"ng-template",null,47,c.Kc),c.Jc(108,Ee,2,0,void 0,6),c.Jc(109,Ie,2,0,void 0,6),c.Jc(110,ke,16,27,"ng-template",null,48,c.Kc),c.Tb(112,"div",49),c.Tb(113,"ejs-dialog",50,51),c.ec("overlayClick",(function(){return t.overlayDialogClick()}))("beforeOpen",(function(e){return t.renderRuleSummary(e)})),c.Jc(115,Fe,3,3,"ng-template",null,52,c.Kc),c.Jc(117,Ge,3,4,"ng-template",null,53,c.Kc),c.Sb(),c.Sb()}2&e&&(c.xb(1),c.nc("animation",t.tabAnimationSettings),c.xb(5),c.Nc(" ",c.ic(7,51,"CHOOSECONDITION")," "),c.xb(3),c.nc("ngIf",t.showAction),c.xb(1),c.nc("ngIf",!t.showAction),c.xb(1),c.nc("ngIf",t.automationId),c.xb(10),c.Nc(" ",c.ic(22,53,"RULENAME")," "),c.xb(4),c.oc("placeholder",c.ic(27,55,"TEXTBOXPLACEHOLDER")),c.nc("value",t.name)("htmlAttributes",t.inputAttribute),c.xb(3),c.nc("ngIf",t.ruleNameRequired),c.xb(3),c.Nc(" ",c.ic(32,57,"DESCRIPTION")," "),c.xb(2),c.oc("placeholder",c.ic(35,59,"TEXTBOXPLACEHOLDER")),c.nc("htmlAttributes",t.inputAttribute)("value",t.description),c.xb(3),c.nc("ngIf",4===t.eventType),c.xb(3),c.nc("ngClass",t.validCondition?"":"border-color-condition"),c.xb(3),c.Mc(c.ic(43,61,"MATCHAUTOMATIONCONDITION")),c.xb(3),c.Nc(" ",c.ic(46,63,"ALL"),""),c.xb(3),c.Nc(" ",c.ic(49,65,"OFTHECONDITION"),""),c.xb(2),c.nc("columns",t.filter)("showButtons",t.showButtons)("ngClass",t.conditionRuleDel?"hd-del-icon":"")("rule",t.orConditionRules),c.xb(4),c.Mc(c.ic(55,67,"ADDNEWCONDITION")),c.xb(2),c.nc("ngIf",t.ruleConditionRequired),c.xb(4),c.Mc(c.ic(61,69,"AND")),c.xb(6),c.nc("ngClass",t.validConditionForGroup?"":"border-color-condition"),c.xb(3),c.Mc(c.ic(70,71,"MATCHAUTOMATIONCONDITION")),c.xb(3),c.Nc(" ",c.ic(73,73,"ANY"),""),c.xb(3),c.Nc(" ",c.ic(76,75,"OFTHECONDITION"),""),c.xb(2),c.nc("columns",t.additionalFilter)("showButtons",t.showButtons)("ngClass",t.extraConditionRuleDel?"hd-del-icon":"")("rule",t.andConditionRules),c.xb(4),c.Mc(c.ic(82,77,"ADDNEWCONDITION")),c.xb(2),c.nc("ngIf",t.ruleConditionRequired),c.xb(3),c.Mc(c.ic(87,79,"NEXT")),c.xb(7),c.nc("ngClass",t.showAction?"":"hide-action"),c.xb(1),c.nc("ngClass",t.validAction?"":"border-color-action"),c.xb(1),c.nc("columns",t.filterAction)("rule",t.actionRules)("ngClass",t.actionRuleDel?"hd-del-icon":""),c.xb(2),c.nc("ngIf",!t.hideAddActionButton),c.xb(1),c.nc("ngIf",t.ruleActionRequired),c.xb(1),c.nc("ngIf",!t.showAction),c.xb(3),c.Mc(c.ic(103,81,"BACK")),c.xb(2),c.nc("ngIf",!t.automationId),c.xb(1),c.nc("ngIf",t.automationId),c.xb(3),c.nc("ngIf",t.enableUserNotificationAction),c.xb(1),c.nc("ngIf",t.enableGroupNotificationAction),c.xb(4),c.nc("visible",!1))},directives:[l.m,a.n,I.i,a.l,N.d,D.c,w.b,x.e,k.a,x.h],pipes:[F.a,G.a],styles:["body{--theme-color:#ff4800;--header-background-color:#ff4800;--header-font-color:#183247;--header-font-style:Roboto,segoe ui;--body-background-color:#f3f5f7;--primary-color:rgba(0,0,0,0.87);--secondary-color:#718096;--font-style:Roboto,segoe ui;--footer-background-color:#f1f1f1}.border-bottom{border-bottom:1px solid #e2e8f0!important}.border-top{border-top:1px solid #e2e8f0!important}.border-right{border-right:1px solid #e2e8f0!important}.border-left{border-left:1px solid #e2e8f0!important}.border{border:1px solid #e2e8f0!important}.border-radius{border-radius:5px}.rule-condition-container>*{margin-bottom:20px}.rule-condition-container .query-rule-action-container,.rule-condition-container .query-rule-prop-container{border:1px solid #e2e8f0;border-bottom-left-radius:0!important;border-bottom-right-radius:0!important;border-radius:4px;box-shadow:0 2px 4px 0 rgba(18,52,77,.06)}.rule-condition-container .query-rule-action-container .e-query-builder,.rule-condition-container .query-rule-prop-container .e-query-builder{border:0!important}.rule-condition-container .border-color-action,.rule-condition-container .border-color-condition{border:1px solid red!important}.rule-condition-container .hd-query-action .e-group-header,.rule-condition-container .hd-query-action .e-group-header .e-btn-group,.rule-condition-container .hd-query-action.hd-del-icon .e-rule-value-delete{display:none}.rule-condition-container .hd-query-action .e-group-body{padding-left:0!important}.rule-condition-container .hd-query-action .e-group-body .e-rule-container:after,.rule-condition-container .hd-query-action .e-group-body .e-rule-container:before{display:none}.rule-condition-container .hd-query-action .e-group-body .e-rule-container.e-error{border-color:red}.rule-condition-container .hd-query-action .e-group-body .e-rule-container .e-add-private-note.e-template-value{width:100%!important}.rule-condition-container .hd-query-action .e-group-body .e-rule-container .e-add-private-note.e-template-value .e-dropdown-btn{box-shadow:none}.rule-condition-container .hd-query-action .e-rule-operator{display:none!important}.rule-condition-container .hd-query-condition .e-group-header,.rule-condition-container .hd-query-condition .e-group-header .e-btn-group,.rule-condition-container .hd-query-condition.hd-del-icon .e-rule-value-delete{display:none}.rule-condition-container .hd-query-condition .e-group-body{padding-left:0!important}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container:after,.rule-condition-container .hd-query-condition .e-group-body .e-rule-container:before{display:none}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container.e-error{border-color:red}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container .e-add-private-note.e-template-value{width:100%!important}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container .e-add-private-note.e-template-value .e-dropdown-btn{box-shadow:none}.rule-condition-container .e-rule-field .e-rule-value-delete .e-rule-delete{float:right!important;position:absolute!important;right:10px!important;top:10px!important}.rule-condition-container .query-action-button{background-color:#fff;border:1px solid #e2e8f0;border-bottom-left-radius:4px;border-bottom-right-radius:5px;border-top:0!important}.hd-query-action-group ul li:first-child{display:none!important}.action-assignee-style.e-rule-value{width:auto!important}.action-assignee-style .e-template .e-input-group:first-child{margin-right:60px!important}.action-assignee-style .e-template .e-input-group:nth-child(2){margin-top:0!important}.condition-update-style .e-rule-value{width:auto!important}.condition-update-style .e-template .e-input-group{display:inline-flex;width:auto!important}.condition-update-style .e-template .e-input-group:nth-child(2){height:36px!important;margin-left:12px!important;margin-right:12px!important;margin-top:0!important}.condition-update-style .e-template .e-input-group:nth-child(3){margin-top:0!important;width:auto}.hd-query-condition.hd-del-icon .e-rule-value-delete{display:none!important}.hd-query-condition .e-group-container{padding-top:0!important}#querybuilder .e-rule-value{width:auto!important}#querybuilder .e-rule-value.e-domain{width:250px!important}#querybuilder .e-rule-value .e-contact-group-domain{max-width:250px!important}#querybuilderAdditional .e-rule-value{width:auto!important}#querybuilderAdditional .e-rule-value.e-domain{width:250px!important}#querybuilderAdditional .e-rule-value .e-contact-group-domain{max-width:250px!important}.button-style{float:right;position:relative}.add-rule{height:57px;margin-bottom:0;position:relative}.new-condition{display:none}.add-rule-filter{position:relative}.radio-style{padding:12px 12px 0}.ml-20{margin-left:20px}.fl-r{float:right}.mb-15{margin-bottom:15px}.mr-15{margin-right:15px}.pl-20{padding-left:20px}.mb-0{margin-bottom:0}.fw-600{font-weight:600}.mt-25{margin-top:25px}.mt-15{margin-top:15px}.custom-rule-tab .e-tab-header{width:calc(100% - 70px)!important}.custom-rule-tab .custom-summary{position:absolute;right:0;top:3px}.custom-rule-tab .hd-success{color:#28a745}.custom-rule-tab .action-icons{margin-top:7px;position:absolute}.bd-automation-summary .summary-value{color:#0450cc}.bd-automation-summary .summary-field{font-weight:500}.bd-automation-summary .summary-content{font-size:14px}.bd-automation-summary .summary-content>span>*{margin-bottom:15px}.bd-automation-summary .summary-content .summary-condition{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}.bd-automation-summary .summary-content .summary-condition>*{padding-bottom:15px}.bd-automation-summary .summary-content .summary-action{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}.bd-automation-summary .summary-content .summary-action>*{padding-bottom:15px}.e-error.e-richtexteditor.e-rte-tb-expand{border:1px solid red!important}.e-error.e-richtexteditor.e-rte-tb-expand .e-rte-content{border-bottom:1px solid red!important}.hide-action{display:none}.mt-20{margin-top:20px}.dropdown-margin{margin-bottom:10px!important;margin-top:20px!important}.mb-6{margin-bottom:6px}.info-icon-style{margin-top:5px}.font-color{color:#fff}.auto-assignment-details{line-height:25px;padding-left:20px;padding-right:10px}.and-seperation{border-left:1px solid #e2e8f0;display:block;height:25px;left:50%;position:absolute;top:0;z-index:1}.rule-sepeartion{height:55px;margin-bottom:0;position:relative}.text-style{border:1px solid #e2e8f0!important;font-weight:500;left:50%;padding:5px 15px;position:absolute;top:25px;transform:translateX(-50%)}.and-seperation-position{position:relative}"],encapsulation:2}),Pe),Me=["newRule"],Ve=["errorMessageRemoval"],He=((Le=function(){function t(i,n,r){e(this,t),this.router=i,this.activatedRoute=n,this.appRootService=r,this.appRootService.getNavigateUrl(this.router.url.replace("/new",""))}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.activatedRoute.data.subscribe((function(t){e.typeId=t.automationTriggerType,e.eventType=t.eventType})),this.href=this.router.url}},{key:"ngAfterViewInit",value:function(){var e=this;this.errorMessageRemoval.nativeElement.addEventListener("scroll",(function(){e.rule.closeErrorTooltipForQueryBuilder()}))}}]),t}()).\u0275fac=function(e){return new(e||Le)(c.Nb(s.g),c.Nb(s.a),c.Nb(d.a))},Le.\u0275cmp=c.Hb({type:Le,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(c.Gc(Me,!0),c.Qc(Ve,!0)),2&e&&(c.xc(i=c.fc())&&(t.rule=i.first),c.xc(i=c.fc())&&(t.errorMessageRemoval=i.first))},decls:7,vars:2,consts:[[1,"control-section","p-3",2,"overflow","auto"],["errorMessageRemoval",""],[1,"col-lg-8","control-section"],[1,"rule-condition-container"],["ruleContainer",""],[3,"eventType","typeId"],["newRule",""]],template:function(e,t){1&e&&(c.Tb(0,"div",0,1),c.Tb(2,"div",2),c.Tb(3,"div",3,4),c.Ob(5,"app-automation-ticket",5,6),c.Sb(),c.Sb(),c.Sb()),2&e&&(c.xb(5),c.nc("eventType",t.eventType)("typeId",t.typeId))},directives:[Ue],encapsulation:2}),Le),_e=r("KDci"),Je=r("GJ+o"),Qe=r("64zv"),We=["grid"],Ke=["automationListViewTab"],Xe=["automationListEle"],ze=["saveRuleDialog"],$e=["contextmenu"],Ye=["automationListPage"],Ze=["searchRule"];function et(e,t){if(1&e){var i=c.Ub();c.Tb(0,"div",36),c.Tb(1,"span",37),c.ec("click",(function(e){c.Bc(i);var n=t.$implicit;return c.gc().nameClick(e,n.automationJobId)})),c.Lc(2),c.Sb(),c.Sb()}if(2&e){var n=t.$implicit;c.xb(2),c.Nc(" ",n.name,"")}}function tt(e,t){if(1&e&&c.Ob(0,"app-date-time",38),2&e){var i=t.$implicit,n=c.gc();c.nc("date",i.lastModifiedOn)("format",n.formatWithTime)("timezone",n.timeZone)}}function it(e,t){if(1&e&&(c.Tb(0,"span",40),c.Lc(1),c.Sb()),2&e){var i=t.$implicit;c.xb(1),c.Mc(i.impactedTicketCount?i.impactedTicketCount:"--")}}function nt(e,t){1&e&&(c.Tb(0,"e-column",39),c.hc(1,"translate"),c.Jc(2,it,2,1,"ng-template",null,24,c.Kc),c.Sb()),2&e&&c.oc("headerText",c.ic(1,1,"IMPACT"))}function rt(e,t){if(1&e){var i=c.Ub();c.Tb(0,"span",41),c.ec("click",(function(){c.Bc(i);var e=t.$implicit,n=c.gc();return n.moreOptionsSelect(n.editItem,e)})),c.hc(1,"translate"),c.Ob(2,"i",42),c.Sb(),c.Tb(3,"span",43),c.ec("click",(function(e){c.Bc(i);var n=t.$implicit;return c.gc().bindBtnTemplate(e,n)})),c.Sb()}2&e&&c.yb("data-title",c.ic(1,1,"EDIT"))}function at(e,t){1&e&&(c.Tb(0,"span"),c.Lc(1),c.hc(2,"translate"),c.Sb()),2&e&&(c.xb(1),c.Nc(" ",c.ic(2,1,"SUMMARY")," "))}function ot(e,t){if(1&e&&(c.Tb(0,"div"),c.Ob(1,"p",44),c.hc(2,"safe"),c.Sb()),2&e){var i=c.gc();c.xb(1),c.nc("innerHTML",c.jc(2,1,i.summaryString,"html"),c.Cc)}}var lt,st,ut,ct,dt,pt,mt=((st=function(){function t(i,n,r,a,o){e(this,t),this.router=i,this.spinService=n,this.automationListService=r,this.toastService=a,this.cd=o,this.moreActionsWithSpam=[{id:"0",text:"View Summary"},{id:"2",text:"Activate"},{id:"3",text:"Deactivate"},{id:"4",text:"Delete"}],this.moreActionWithActivate=["Activate","Delete"],this.moreActionWithDeactivate=["Deactivate","Delete"],this.stillFetching=!0,this.pagerSize=v.E,this.switchOnOff=!0,this.dragAndDrop=!0,this.animation={effect:"none"},this.tabContent=[{text:j.t.Active},{text:j.t.Inactive}],this.tabAnimationSettings={next:{effect:"None"},previous:{effect:"None"}},this.editItem={item:{id:j.y.Edit}},this.appSettings=v.e,this.format=v.e.dateFormat,this.formatWithTime=v.e.dateFormat+" "+v.e.timeFormat,this.timeZone=v.P.timeZoneOffset}return i(t,[{key:"ngOnInit",value:function(){j.l.CreateTicketAutomation===this.automationType?this.titleInfo=Object(y.a)("CREATETICKETAUTOMATIONINFO"):j.l.UpdateTicketAutomation===this.automationType?this.titleInfo=Object(y.a)("UPDATETICKETAUTOMATIONINFO"):j.l.TimeTriggerAutomation===this.automationType?this.titleInfo=Object(y.a)("TIMETRIGGERMODULEINFO"):j.l.AutoAssignmentAutomation===this.automationType&&(this.titleInfo=Object(y.a)("AUTOASSIGNMENTAUTOMATIONINFO")),this.href=this.router.url,this.tabSelected=j.t.Active.toLowerCase()}},{key:"ngAfterViewInit",value:function(){var e=this;this.gridObj.query=(new b.g).addParams("isenabled","true"),this.automationListEle.nativeElement.addEventListener("keydown",(function(t){Object(h.l)(t,e.automationListEle.nativeElement)})),this.automationListPageEle.nativeElement.addEventListener("scroll",(function(){e.contextmenu.close()}))}},{key:"tabSelecting",value:function(){this.stillFetching=!0,"1"===this.automationListViewTab.selectingID?(this.tabSelected=j.t.Inactive.toLowerCase(),this.gridObj.setProperties({query:(new b.g).addParams("isenabled","false")},!0),this.dragAndDrop=!1,this.stillFetching=!0):(this.tabSelected=j.t.Active.toLowerCase(),this.gridObj.setProperties({query:(new b.g).addParams("isenabled","true")},!0),this.dragAndDrop=!0,this.stillFetching=!0)}},{key:"automationDragDrop",value:function(e){var t=this,i=e.data[0].automationJobId;if(e.cancel=!0,e.fromIndex!==e.dropIndex){var n={toPosition:++e.dropIndex,positionChangeMode:j.q.ToPosition};this.spinService.showSpinner(),this.automationListService.changePosition(i,n).then((function(e){e&&(t.gridObj.refresh(),t.toastService.successToast(e.message))})).catch((function(e){var i=Object(h.q)(e.error);400===e.status&&t.toastService.failureToast(i)})).finally((function(){t.spinService.hideSpinner()}))}}},{key:"automationListDataBound",value:function(){var e=this.gridObj.element.querySelector(".e-gridcontent .e-content .e-emptyrow td");e&&e.setAttribute("colspan","2"),this.stillFetching=!1,this.cd.detectChanges(),this.gridObj.widthService.setWidthToColumns()}},{key:"automationListActionBegin",value:function(){}},{key:"nameClick",value:function(e,t){e.stopPropagation(),this.router.navigateByUrl(this.href+"/"+t)}},{key:"activateAndDeactivateAction",value:function(e){var t=this;this.spinService.showSpinner(),this.automationListService.toggleChange(this.selectedItemData.automationJobId,{isToggleOn:e}).then((function(e){e&&(t.spinService.hideSpinner(),t.gridObj.refresh(),t.toastService.successToast(e.message))})).catch((function(e){var i=Object(h.q)(e.error);400===e.status&&t.toastService.failureToast(i)})).finally((function(){t.spinService.hideSpinner()}))}},{key:"updateDeleteType",value:function(){var e=this;this.spinService.showSpinner(),this.automationListService.deleteItem(this.id).then((function(t){t&&(e.spinService.hideSpinner(),e.deleteDialog.hide(),e.gridObj.refresh(),e.toastService.successToast(t.message))})).finally((function(){e.spinService.hideSpinner()}))}},{key:"cancelDialog",value:function(){this.deleteDialog.hide()}},{key:"addRuleClick",value:function(){this.router.navigateByUrl(this.href+"/new")}},{key:"getSwitchObj",value:function(e,t){return this.enableDisableSwitch._results.filter((function(i){return i.element.getAttribute("name")===e&&i.element.dataset.id===t+""}))[0]}},{key:"overlayDialogClick",value:function(){this.saveRuleDialog.hide()}},{key:"summaryViewClick",value:function(e){this.summaryString=e,this.saveRuleDialog.show()}},{key:"moreOptionsSelect",value:function(e,t){e.item.id===j.y.Edit?(this.id=+t.automationJobId,this.router.navigateByUrl(this.href+"/"+this.id)):e.item.id===j.y.Delete?(this.id=+this.selectedItemData.automationJobId,Object(h.b)(this.updateDeleteType,this.cancelDialog,this,Object(y.a)("DELETE")+" "+Object(y.a)("RULE"),Object(y.a)("DELETERULEALERT"))):e.item.id===j.y.Activate?this.activateAndDeactivateAction(!0):e.item.id===j.y.Deactivate?this.activateAndDeactivateAction(!1):e.item.id===j.y.ViewSummary&&this.summaryViewClick(this.selectedItemData.summary)}},{key:"bindBtnTemplate",value:function(e,t){this.selectedItemData=t;var i=Object(w.f)(e.target);this.contextmenu.open(i.top+16,i.left-5,e.target)}},{key:"itemBeforeEvent",value:function(){this.selectedItemData.isEnabled?(this.contextmenu.hideItems(this.moreActionWithActivate),this.contextmenu.showItems(this.moreActionWithDeactivate)):(this.contextmenu.hideItems(this.moreActionWithDeactivate),this.contextmenu.showItems(this.moreActionWithActivate))}},{key:"searchNodes",value:function(){var e=this.searchRule.value.trim();this.gridObj.search(e)}}]),t}()).\u0275fac=function(e){return new(e||st)(c.Nb(s.g),c.Nb(E.a),c.Nb(R.a),c.Nb(q.a),c.Nb(c.h))},st.\u0275cmp=c.Hb({type:st,selectors:[["ticket-automation-list"]],viewQuery:function(e,t){var i;1&e&&(c.Qc(We,!0),c.Qc(Ke,!0),c.Qc(Xe,!0),c.Qc(ze,!0),c.Qc($e,!0),c.Qc(Ye,!0),c.Qc(Ze,!0),c.Qc(D.k,!0)),2&e&&(c.xc(i=c.fc())&&(t.gridObj=i.first),c.xc(i=c.fc())&&(t.automationListViewTab=i.first),c.xc(i=c.fc())&&(t.automationListEle=i.first),c.xc(i=c.fc())&&(t.saveRuleDialog=i.first),c.xc(i=c.fc())&&(t.contextmenu=i.first),c.xc(i=c.fc())&&(t.automationListPageEle=i.first),c.xc(i=c.fc())&&(t.searchRule=i.first),c.xc(i=c.fc())&&(t.enableDisableSwitch=i))},inputs:{dataSource:"dataSource",allowDragDrop:"allowDragDrop",automationType:"automationType"},decls:54,vars:28,consts:[[1,"hd-grid-full-height","automation-grid"],["automationListPage",""],[1,"secondary","padding-10","information-content"],[1,"bd-icon","bd-icon-info","information-icon","information-icon-position"],[1,"list-container"],[1,"row","no-margin","float-right",2,"border-bottom","1px solid #e2e8f0","padding-bottom","7px"],[1,"grid-menu"],[1,"search-box",2,"padding","0 12px"],["id","search","showClearButton","true","autocomplete","off","maxlength","150",3,"placeholder","change"],["searchRule",""],[1,"float-right"],["type","button","ejs-button","",1,"e-btn","add-button","e-outline","e-primary",3,"click"],["width","70%",3,"animation","selecting"],["automationListViewTab",""],[3,"header"],[1,"height-100","list-container"],[1,"align-center",2,"height","100%",3,"hidden"],[1,"ticket-fetch-loader"],[3,"stepCount"],[1,"automation-list","pt-3"],["automationListEle",""],["id","rule-grid","allowResizing","true","height","100%","allowSorting","true",3,"dataSource","hidden","allowRowDragAndDrop","dataBound","actionBegin","rowDrop"],["grid",""],["field","name","minWidth","180","width","180","clipMode","EllipsisWithTooltip",3,"headerText"],["template",""],["field","lastModifiedBy","minWidth","150","width","180","clipMode","EllipsisWithTooltip",3,"headerText"],["field","lastModifiedOn","minWidth","150","width","150",3,"headerText"],["field","impactedTicketCount","minWidth","100","width","120","clipMode","EllipsisWithTooltip","textAlign","Center",3,"headerText",4,"ngIf"],["minWidth","100","width","100","textAlign","Center"],[3,"items","animationSettings","beforeOpen","select"],["contextmenu",""],[1,"save-dialog"],["id","saveRuleDialog","width","500px","isModal","true","showCloseIcon","true","height","Auto","closeOnEscape","true","cssClass","bd-automation-summary",3,"visible","overlayClick"],["saveRuleDialog",""],["header",""],["content",""],[1,"no-wrap","ellipsis"],[1,"primary-link-color","cursor-pointer",3,"click"],[3,"date","format","timezone"],["field","impactedTicketCount","minWidth","100","width","120","clipMode","EllipsisWithTooltip","textAlign","Center",3,"headerText"],[1,"grid-text-font-color"],[1,"bd-icon","bd-icon-edit","more-option-button",3,"click"],[1,""],[1,"hd-icon","hd-vertical-menu","more-option-button",3,"click"],[1,"summary-content",3,"innerHTML"]],template:function(e,t){1&e&&(c.Tb(0,"div",0,1),c.Tb(2,"div"),c.Tb(3,"div",2),c.Ob(4,"div",3),c.Lc(5),c.Sb(),c.Tb(6,"div",4),c.Tb(7,"div",5),c.Tb(8,"div",6),c.Tb(9,"div",7),c.Tb(10,"ejs-textbox",8,9),c.ec("change",(function(){return t.searchNodes()})),c.hc(12,"translate"),c.Sb(),c.Sb(),c.Tb(13,"div",10),c.Tb(14,"button",11),c.ec("click",(function(){return t.addRuleClick()})),c.Lc(15),c.hc(16,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(17,"ejs-tab",12,13),c.ec("selecting",(function(){return t.tabSelecting()})),c.Tb(19,"e-tabitems"),c.Ob(20,"e-tabitem",14),c.Ob(21,"e-tabitem",14),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(22,"div",15),c.Tb(23,"div",16),c.Tb(24,"div",17),c.Ob(25,"lib-shimmer",18),c.Sb(),c.Sb(),c.Tb(26,"div",19,20),c.Tb(28,"ejs-grid",21,22),c.ec("dataBound",(function(){return t.automationListDataBound()}))("actionBegin",(function(){return t.automationListActionBegin()}))("rowDrop",(function(e){return t.automationDragDrop(e)})),c.Tb(30,"e-columns"),c.Tb(31,"e-column",23),c.hc(32,"translate"),c.Jc(33,et,3,1,"ng-template",null,24,c.Kc),c.Sb(),c.Ob(35,"e-column",25),c.hc(36,"translate"),c.Tb(37,"e-column",26),c.hc(38,"translate"),c.Jc(39,tt,1,3,"ng-template",null,24,c.Kc),c.Sb(),c.Jc(41,nt,4,3,"e-column",27),c.Tb(42,"e-column",28),c.Jc(43,rt,4,3,"ng-template",null,24,c.Kc),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(45,"ejs-contextmenu",29,30),c.ec("beforeOpen",(function(){return t.itemBeforeEvent()}))("select",(function(e){return t.moreOptionsSelect(e)})),c.Sb(),c.Tb(47,"div",31),c.Tb(48,"ejs-dialog",32,33),c.ec("overlayClick",(function(){return t.overlayDialogClick()})),c.Jc(50,at,3,3,"ng-template",null,34,c.Kc),c.Jc(52,ot,3,4,"ng-template",null,35,c.Kc),c.Sb(),c.Sb()),2&e&&(c.xb(5),c.Nc(" ",t.titleInfo," "),c.xb(5),c.oc("placeholder",c.ic(12,18,"SEARCH")),c.xb(5),c.Nc(" ",c.ic(16,20,"ADDRULE")," "),c.xb(2),c.nc("animation",t.tabAnimationSettings),c.xb(3),c.nc("header",t.tabContent[0]),c.xb(1),c.nc("header",t.tabContent[1]),c.xb(2),c.nc("hidden",!t.stillFetching),c.xb(2),c.nc("stepCount",5),c.xb(3),c.nc("dataSource",t.dataSource)("hidden",t.stillFetching)("allowRowDragAndDrop",t.dragAndDrop),c.xb(3),c.oc("headerText",c.ic(32,22,"RULENAME")),c.xb(4),c.oc("headerText",c.ic(36,24,"LASTMODIFIEDBY")),c.xb(2),c.oc("headerText",c.ic(38,26,"LASTMODIFIED")),c.xb(4),c.nc("ngIf",5!==t.automationType),c.xb(4),c.nc("items",t.moreActionsWithSpam)("animationSettings",t.animation),c.xb(3),c.nc("visible",!1))},directives:[I.i,D.c,l.m,l.o,l.n,_e.a,Je.k,N.b,Je.e,Je.b,N.a,Je.d,Je.a,a.n,l.f,w.b,Qe.a],pipes:[F.a,G.a],styles:["body[_ngcontent-%COMP%]{--theme-color:#ff4800;--header-background-color:#ff4800;--header-font-color:#183247;--header-font-style:Roboto,segoe ui;--body-background-color:#f3f5f7;--primary-color:rgba(0,0,0,0.87);--secondary-color:#718096;--font-style:Roboto,segoe ui;--footer-background-color:#f1f1f1}.border-bottom[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0!important}.border-top[_ngcontent-%COMP%]{border-top:1px solid #e2e8f0!important}.border-right[_ngcontent-%COMP%]{border-right:1px solid #e2e8f0!important}.border-left[_ngcontent-%COMP%]{border-left:1px solid #e2e8f0!important}.border[_ngcontent-%COMP%]{border:1px solid #e2e8f0!important}.border-radius[_ngcontent-%COMP%]{border-radius:5px}.seperator-style[_ngcontent-%COMP%]{padding:0 5px}.switch-class[_ngcontent-%COMP%]{margin-top:10px}.title-style[_ngcontent-%COMP%]{font-weight:500}.cursor-style[_ngcontent-%COMP%]:hover{cursor:pointer}.e-dropdown-btn[_ngcontent-%COMP%]:active{box-shadow:none!important}.automation-grid[_ngcontent-%COMP%]{overflow:hidden}.automation-grid[_ngcontent-%COMP%]   .automation-list[_ngcontent-%COMP%]{height:calc(100% - 140px)}.automation-grid[_ngcontent-%COMP%]   .list-container[_ngcontent-%COMP%]{padding:0 16px}.automation-grid[_ngcontent-%COMP%]   .e-gridcontent[_ngcontent-%COMP%]{height:calc(100% - 13px)!important}.automation-grid[_ngcontent-%COMP%]   .e-gridcontent[_ngcontent-%COMP%]   .e-content[_ngcontent-%COMP%]{height:inherit!important;overflow-y:auto!important}  .bd-automation-summary .summary-value{color:#0450cc!important}  .bd-automation-summary .summary-field{font-weight:500!important}  .bd-automation-summary .summary-content{font-size:14px}  .bd-automation-summary .summary-content>span>*{margin-bottom:15px}  .bd-automation-summary .summary-content .summary-condition{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}  .bd-automation-summary .summary-content .summary-condition>*{padding-bottom:15px}  .bd-automation-summary .summary-content .summary-action{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}  .bd-automation-summary .summary-content .summary-action>*{padding-bottom:15px}.padding-10[_ngcontent-%COMP%]{padding:10px}"]}),st),bt=((lt=function(){function t(i,n,r,a){e(this,t),this.appRootService=i,this.router=n,this.activatedRoute=r,this.seoService=a,this.automationType=j.i.AutomationType}return i(t,[{key:"ngOnInit",value:function(){var e=this,t=v.E.toString();this.activatedRoute.data.subscribe((function(t){e.typeId=t})),j.l.CreateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("CREATETICKETTRIGGERS")):j.l.UpdateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("UPDATETICKETTRIGGERS")):j.l.TimeTriggerAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("TIMETRIGGERS")):j.l.AutoAssignmentAutomation===this.typeId.eventType&&this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("AUTOASSIGNMENTTRIGGERS"));var i=O.a.AutomationList;i=Object(h.i)(i,"Page","1"),i=Object(h.i)(i,"PerPage",t),i=Object(h.i)(i,this.automationType,this.typeId.eventType),this.data=new b.a({url:i,adaptor:new g.a})}},{key:"setTitleAndSeo",value:function(e,t){var i=t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t),this.seoService.setHeaderElements({title:i})}},{key:"navigateAutomationListPage",value:function(){this.router.navigateByUrl("admin/automation/create-ticket-triggers")}}]),t}()).\u0275fac=function(e){return new(e||lt)(c.Nb(d.a),c.Nb(s.g),c.Nb(s.a),c.Nb(B.a))},lt.\u0275cmp=c.Hb({type:lt,selectors:[["ng-component"]],decls:3,vars:2,consts:[[2,"height","100%"],[3,"dataSource","automationType"]],template:function(e,t){1&e&&(c.Tb(0,"div",0),c.Tb(1,"div",0),c.Ob(2,"ticket-automation-list",1),c.Sb(),c.Sb()),2&e&&(c.xb(2),c.nc("dataSource",t.data)("automationType",t.typeId.eventType))},directives:[mt],styles:[".seperator-style[_ngcontent-%COMP%]{padding:0 5px}.switch-class[_ngcontent-%COMP%]{margin-top:10px}"]}),lt),ht=["newRule"],gt=["errorMessageRemoval"],vt=((ut=function(){function t(i,n,r,a,o){var l=this;if(e(this,t),this.router=i,this.appRootService=n,this.spinService=r,this.activatedRoute=a,this.seoService=o,this.resolveData=this.activatedRoute.data.subscribe((function(e){l.data=e.data,l.spinService.showSpinner()})),this.activatedRoute.data.subscribe((function(e){l.typeId=e,l.eventType=e.eventType})),j.l.CreateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("CREATETICKETTRIGGER")):j.l.UpdateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("UPDATETICKETTRIGGER")):j.l.TimeTriggerAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("TIMETRIGGER")):j.l.AutoAssignmentAutomation===this.typeId.eventType&&this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("AUTOASSIGNMENTTRIGGER")),this.data){this.actionDataManipulation(JSON.parse(this.data.action)),this.ruleName=this.data.name,this.description=this.data.description,this.businessId=this.data.businessHourId,this.onOff=this.data.isEnabled,this.summary=this.data.summary,this.conditionRulesWithoutSplit=JSON.parse(this.data.condition),"or"===this.conditionRulesWithoutSplit.condition?this.conditionRulesSecondQryBldr=this.conditionRulesWithoutSplit:this.conditionRules=this.conditionRulesWithoutSplit;for(var s=0;s<this.conditionRulesWithoutSplit.rules.length;s++)if("or"===this.conditionRulesWithoutSplit.rules[s].condition){this.conditionRulesSecondQryBldr=this.conditionRulesWithoutSplit.rules[s],this.conditionRulesWithoutSplit.rules.splice([s]);break}}this.id=parseInt(this.activatedRoute.snapshot.paramMap.get("id"),10),this.appRootService.getNavigateUrl(this.router.url.replace("/"+this.id,""))}return i(t,[{key:"setTitleAndSeo",value:function(e,t){var i=t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t),this.seoService.setHeaderElements({title:i})}},{key:"actionDataManipulation",value:function(e){e.forEach((function(e){e.operator="equal"})),Object.prototype.hasOwnProperty.call(e[0],"AssignmentType")?this.groupValueForAutoAssignment=+e[0].GroupId:this.actionRules={condition:"and",rules:e}}},{key:"ngAfterViewInit",value:function(){var e=this;this.errorMessageRemoval.nativeElement.addEventListener("scroll",(function(){e.rule.closeErrorTooltipForQueryBuilder()}))}}]),t}()).\u0275fac=function(e){return new(e||ut)(c.Nb(s.g),c.Nb(d.a),c.Nb(E.a),c.Nb(s.a),c.Nb(B.a))},ut.\u0275cmp=c.Hb({type:ut,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(c.Gc(ht,!0),c.Qc(gt,!0)),2&e&&(c.xc(i=c.fc())&&(t.rule=i.first),c.xc(i=c.fc())&&(t.errorMessageRemoval=i.first))},decls:7,vars:11,consts:[[1,"control-section","p-3"],["errorMessageRemoval",""],[1,"col-lg-8","control-section"],[1,"rule-condition-container"],["ruleContainer",""],[3,"orConditionRules","andConditionRules","actionRules","name","description","onOff","eventType","businessId","automationId","groupValueForAutoAssignment","summary"],["newRule",""]],template:function(e,t){1&e&&(c.Tb(0,"div",0,1),c.Tb(2,"div",2),c.Tb(3,"div",3,4),c.Ob(5,"app-automation-ticket",5,6),c.Sb(),c.Sb(),c.Sb()),2&e&&(c.xb(5),c.nc("orConditionRules",t.conditionRules)("andConditionRules",t.conditionRulesSecondQryBldr)("actionRules",t.actionRules)("name",t.ruleName)("description",t.description)("onOff",t.onOff)("eventType",t.eventType)("businessId",t.businessId)("automationId",t.id)("groupValueForAutoAssignment",t.groupValueForAutoAssignment)("summary",t.summary))},directives:[Ue],styles:[""]}),ut),ft=r("tk/3"),yt=((ct=function(){function t(i,n,r){e(this,t),this.http=i,this.spinService=n,this.router=r}return i(t,[{key:"resolve",value:function(e){var t=this;return this.spinService.showSpinner(),this.http.get(O.a.AutomationList+"/"+e.data.eventType+"/"+e.params.id).toPromise().catch((function(e){return t.router.navigateByUrl("error",{state:e.error.errors[0].errorMessage,skipLocationChange:!0})}))}}]),t}()).\u0275fac=function(e){return new(e||ct)(c.bc(ft.b),c.bc(E.a),c.bc(s.g))},ct.\u0275prov=c.Jb({token:ct,factory:ct.\u0275fac}),ct),At=r("TSZ8"),Tt=r("hR61"),Ot=r("mdOG"),St=r("G2Tp"),xt=r("znO6"),jt=[{path:"create-ticket-triggers",canActivate:[Ot.a],data:{permission:{enum:[xt.a.ManageCreateAndUpdateTriggers]},guards:[St.a,Tt.a]},children:[{path:"",component:bt,data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.CreateTicketAutomation}},{path:"new",component:He,data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.CreateTicketAutomation},canDeactivate:[At.a]},{path:":id",component:vt,resolve:{data:yt},data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.CreateTicketAutomation},canDeactivate:[At.a]}]},{path:"update-ticket-triggers",canActivate:[Ot.a],data:{permission:{enum:[xt.a.ManageCreateAndUpdateTriggers]},guards:[St.a,Tt.a]},children:[{path:"",component:bt,data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.UpdateTicketAutomation}},{path:"new",component:He,data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.UpdateTicketAutomation},canDeactivate:[At.a]},{path:":id",component:vt,resolve:{data:yt},data:{automationTriggerType:j.u.EventTrigger,eventType:j.l.UpdateTicketAutomation},canDeactivate:[At.a]}]},{path:"time-triggers",canActivate:[Ot.a],data:{permission:{enum:[xt.a.ManageTimeTriggers]},guards:[St.a,Tt.a]},children:[{path:"",component:bt,data:{automationTriggerType:j.u.TimeTrigger,eventType:j.l.TimeTriggerAutomation}},{path:"new",component:He,data:{automationTriggerType:j.u.TimeTrigger,eventType:j.l.TimeTriggerAutomation},canDeactivate:[At.a]},{path:":id",component:vt,resolve:{data:yt},data:{automationTriggerType:j.u.TimeTrigger,eventType:j.l.TimeTriggerAutomation},canDeactivate:[At.a]}]},{path:"auto-assignments",canActivate:[Ot.a],data:{permission:{enum:[xt.a.ManageAutoAssignments]},guards:[St.a,Tt.a]},children:[{path:"",component:bt,data:{automationTriggerType:j.u.AutoAssignment,eventType:j.l.AutoAssignmentAutomation}},{path:"new",component:He,data:{automationTriggerType:j.u.AutoAssignment,eventType:j.l.AutoAssignmentAutomation},canDeactivate:[At.a]},{path:":id",component:vt,resolve:{data:yt},data:{automationTriggerType:j.u.AutoAssignment,eventType:j.l.AutoAssignmentAutomation},canDeactivate:[At.a]}]},{path:"**",component:u.a}],Ct=((dt=function t(){e(this,t)}).\u0275mod=c.Lb({type:dt}),dt.\u0275inj=c.Kb({factory:function(e){return new(e||dt)},imports:[[s.k.forChild(jt)],s.k]}),dt),qt=r("5OZa"),Et=((pt=function t(){e(this,t)}).\u0275mod=c.Lb({type:pt}),pt.\u0275inj=c.Kb({factory:function(e){return new(e||pt)},providers:[yt],imports:[[a.b,o.a,Ct,l.j,I.h,D.b,N.c,Je.m,Je.j,D.l,qt.a,qt.d,x.d,x.g,D.h,l.l,w.a,l.e]]}),pt)}}])}();