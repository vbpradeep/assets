(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"GJ+o":function(e,t,i){"use strict";i.d(t,"d",(function(){return mr})),i.d(t,"e",(function(){return br})),i.d(t,"a",(function(){return wr})),i.d(t,"b",(function(){return Sr})),i.d(t,"k",(function(){return Fr})),i.d(t,"j",(function(){return nn})),i.d(t,"h",(function(){return kr})),i.d(t,"l",(function(){return zr})),i.d(t,"r",(function(){return Ar})),i.d(t,"s",(function(){return Lr})),i.d(t,"p",(function(){return qr})),i.d(t,"t",(function(){return Hr})),i.d(t,"q",(function(){return Wr})),i.d(t,"f",(function(){return Gr})),i.d(t,"o",(function(){return Kr})),i.d(t,"g",(function(){return Ur})),i.d(t,"i",(function(){return Jr})),i.d(t,"c",(function(){return Zr})),i.d(t,"n",(function(){return dn})),i.d(t,"m",(function(){return pn}));var s=i("fXoL"),r=i("k5hD"),n=i("4SUy"),l=i("H552"),a=i("Naoh"),o=i("TF3C"),h=i("ngVE"),d=i("OyPL"),c=i("gnsf"),p=i("5YkT"),u=i("4jY0"),g=i("eNK/");class m{constructor(e){this.intl=new n.n,Object(n.X)(e)||(this.intl.culture=e)}getFormatFunction(e){return e.type?(Object(n.W)()&&(e.isServerRendered=!0),this.intl.getDateFormat(e)):this.intl.getNumberFormat(e)}getParserFunction(e){return e.type?(Object(n.W)()&&(e.isServerRendered=!0),this.intl.getDateParser(e)):this.intl.getNumberParser(e)}fromView(e,t,i){return"date"!==i&&"datetime"!==i&&"number"!==i||Object(n.X)(t)?e:t(e)}toView(e,t){let i=e;return Object(n.X)(t)||Object(n.X)(e)||(i=t(e)),i}setCulture(e){Object(n.X)(e)||Object(n.nb)(e)}}class b{constructor(e,t){this.disableHtmlEncode=!0,this.allowSorting=!0,this.allowResizing=!0,this.allowFiltering=!0,this.allowGrouping=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.enableGroupByFormat=!1,this.allowEditing=!0,this.filter={},this.showInColumnChooser=!0,this.edit={},this.allowSearching=!0,this.autoFit=!1,this.sortDirection="Descending",this.getEditTemplate=()=>this.editTemplateFn,this.getFilterTemplate=()=>this.filterTemplateFn,Object(n.db)(this,e),this.parent=t,"none"===this.type?this.type=Object(n.W)()&&!Object(n.X)(this.template)&&Object(n.X)(this.field)?"none":null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0),this.editType&&(this.editType=this.editType.toLowerCase()),Object(n.X)(this.uid)&&(this.uid=St("grid-column"));let i=new m;if(e.format&&(e.format.skeleton||e.format.format)&&(this.setFormatter(i.getFormatFunction(Object(n.K)({},e.format))),this.setParser(i.getParserFunction(e.format))),this.toJSON=()=>{let e={},t=["filter","dataSource",Object(n.W)()?" ":"headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],i=Object.keys(this);for(let s=0;s<i.length;s++)if("columns"===i[s]){e[i[s]]=[];for(let t=0;t<this[i[s]].length;t++)e[i[s]].push(this[i[s]][t].toJSON())}else t.indexOf(i[s])<0&&(e[i[s]]=this[i[s]]);return e},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some(e=>e.allowResizing))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=ot(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=ot(this.headerTemplate)),!Object(n.X)(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=ot(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=ot(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=ot(this.filterTemplate)),this.isForeignColumn()&&(Object(n.X)(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params=Object(n.K)({dataSource:this.dataSource,query:new l.g,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer){let e=this.sortComparer;this.sortComparer=function(t,i,s,r){if("string"==typeof e&&(e=_t(e,window)),"Descending"===this.sortDirection){let e=t;t=i,i=e;let n=s;s=r,r=n}return e(t,i,s,r)}}!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=(e,t)=>(e=_t(this.foreignKeyValue,Xt(this,{},e)[0]),t=_t(this.foreignKeyValue,Xt(this,{},t)[0]),"Descending"===this.sortDirection?l.b.fnDescending(e,t):l.b.fnAscending(e,t)))}getSortDirection(){return this.sortDirection}setSortDirection(e){this.sortDirection=e}getFreezeTableName(){return this.freezeTable}setProperties(e){let t=Object.keys(e);for(let i=0;i<t.length;i++)this[t[i]]=e[t[i]],this.parent&&this.parent.isReact&&"template"===t[i]&&this.parent.refreshReactColumnTemplateByUid(this.uid)}isForeignColumn(){return!(!this.dataSource||!this.foreignKeyValue)}getFormatter(){return this.formatFn}setFormatter(e){this.formatFn=e}getParser(){return this.parserFn}setParser(e){this.parserFn=e}getColumnTemplate(){return this.templateFn}getHeaderTemplate(){return this.headerTemplateFn}getFilterItemTemplate(){return this.fltrTemplateFn}getDomSetter(){return this.disableHtmlEncode?"textContent":"innerHTML"}}const f="actionBegin",y="actionComplete",C="dataBound",v="initial-load",w="initial-end",S="data-ready",O="content-ready",x="ui-update",j="on-empty",R="inbound-model-changed",D="model-changed",E="header-refreshed",I="key-pressed",M="click",F="destroy",T="toolbar-refresh",k="auto-col",z="prevent-batch";var A=function(e){return e[e.Data=0]="Data",e[e.Header=1]="Header",e[e.Summary=2]="Summary",e[e.GroupSummary=3]="GroupSummary",e[e.CaptionSummary=4]="CaptionSummary",e[e.Filter=5]="Filter",e[e.Indent=6]="Indent",e[e.GroupCaption=7]="GroupCaption",e[e.GroupCaptionEmpty=8]="GroupCaptionEmpty",e[e.Expand=9]="Expand",e[e.HeaderIndent=10]="HeaderIndent",e[e.StackedHeader=11]="StackedHeader",e[e.DetailHeader=12]="DetailHeader",e[e.DetailExpand=13]="DetailExpand",e[e.CommandColumn=14]="CommandColumn",e[e.DetailFooterIntent=15]="DetailFooterIntent",e[e.RowDragIcon=16]="RowDragIcon",e[e.RowDragHIcon=17]="RowDragHIcon",e}({}),L=function(e){return e[e.Header=0]="Header",e[e.Content=1]="Content",e[e.Summary=2]="Summary",e}({});class B{constructor(e,t){this.dataState={isPending:!1,resolver:null,group:[]},this.foreignKeyDataState={isPending:!1,resolver:null},this.parent=e,this.serviceLocator=t,this.initDataManager(),this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on("rows-added",this.addRows,this),this.parent.on("row-position-changed",this.reorderRows,this),this.parent.on("rows-removed",this.removeRows,this),this.parent.on("datasource-modified",this.initDataManager,this),this.parent.on(F,this.destroy,this),this.parent.on("update-data",this.crudActions,this),this.parent.on("add-delete-Action",this.getData,this),this.parent.on(k,this.refreshFilteredCols,this),this.parent.on("columns-prepared",this.refreshFilteredCols,this))}reorderRows(e){this.dataManager.dataSource.json.splice(e.toIndex,0,this.dataManager.dataSource.json.splice(e.fromIndex,1)[0])}getModuleName(){return"data"}initDataManager(){let e=this.parent;this.dataManager=e.dataSource instanceof l.a?e.dataSource:Object(n.X)(e.dataSource)?new l.a:new l.a(e.dataSource),!e.isAngular||e.query instanceof l.g?(this.isQueryInvokedFromData=!0,e.query=e.query instanceof l.g?e.query:new l.g):e.setProperties({query:new l.g},!0)}generateQuery(e){let t=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)t.select(this.parent.getColumns().filter(e=>!(!0!==e.isPrimaryKey&&!1===e.visible||void 0===e.field)).map(e=>e.field));else if("Schema"===this.parent.columnQueryMode){let e=[],i=this.parent.columns;for(let t=0;t<i.length;t++)e.push(i[t].field);t.select(e)}return this.filterQuery(t),this.searchQuery(t),this.aggregateQuery(t),this.sortQuery(t),Yt(this.parent)?this.virtualGroupPageQuery(t):this.pageQuery(t,e),this.groupQuery(t),t}aggregateQuery(e,t){let i=this.parent.aggregates;for(let s=0;s<i.length;s++){let t=i[s];for(let i=0;i<t.columns.length;i++){let s=t.columns[i],r=s.type instanceof Array?s.type:[s.type];for(let t=0;t<r.length;t++)e.aggregate(r[t].toLowerCase(),s.field)}}return e}virtualGroupPageQuery(e){if(e.queries.length)for(let t=0;t<e.queries.length;t++)"onPage"===e.queries[t].fn&&e.queries.splice(t,1);return e}pageQuery(e,t){let i=this.parent;if((i.allowPaging||i.enableVirtualization||i.enableInfiniteScrolling)&&!0!==t){if(i.pageSettings.currentPage=Math.max(1,i.pageSettings.currentPage),i.pageSettings.pageCount<=0&&(i.pageSettings.pageCount=8),i.pageSettings.pageSize<=0&&(i.pageSettings.pageSize=12),e.queries.length)for(let t=0;t<e.queries.length;t++)"onPage"===e.queries[t].fn&&e.queries.splice(t,1);!Object(n.X)(i.infiniteScrollModule)&&i.enableInfiniteScrolling?this.parent.notify("infinite-page-query",e):e.page(i.pageSettings.currentPage,i.pageSettings.pageSize)}return e}groupQuery(e){let t=this.parent;if(t.allowGrouping&&t.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&e.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});let i=t.groupSettings.columns;for(let t=0,s=i.length;t<s;t++){let s=this.getColumnByField(i[t]);s||this.parent.log("initial_action",{moduleName:"group",columnName:i[t]});let r=s.format;s.enableGroupByFormat?e.group(i[t],this.formatGroupColumn.bind(this),r):e.group(i[t],null)}}return e}sortQuery(e){let t=this.parent;if((t.allowSorting||t.allowGrouping)&&t.sortSettings.columns.length){let i=t.sortSettings.columns,s=[];for(let r=i.length-1;r>-1;r--){let n=this.getColumnByField(i[r].field);if(!n)return this.parent.log("initial_action",{moduleName:"sort",columnName:i[r].field}),e;n.setSortDirection(i[r].direction);let l=i[r].direction;n.sortComparer&&(this.parent.log("grid_sort_comparer"),l=this.isRemote()?i[r].direction:n.sortComparer.bind(n)),-1===t.groupSettings.columns.indexOf(i[r].field)?n.isForeignColumn()||n.sortComparer?e.sortByForeignKey(n.field,l,void 0,i[r].direction.toLowerCase()):e.sortBy(n.field,l):s.push({direction:l,field:n.field})}for(let t=0,r=s.length;t<r;t++)if("string"==typeof s[t].direction)e.sortBy(s[t].field,s[t].direction);else{let i=this.getColumnByField(s[t].field);e.sortByForeignKey(s[t].field,s[t].direction,void 0,i.getSortDirection().toLowerCase())}}return e}searchQuery(e,t,i){let s=this.parent.searchSettings,r=s.fields.length?s.fields:this.getSearchColumnFieldNames(),n=[],a=!1;if(this.parent.searchSettings.key.length){a=this.parent.getForeignKeyColumns().some(e=>r.indexOf(e.field)>-1);let o=i?t.dataSource.adaptor:this.dataManager.adaptor;if(a||o.getModuleName&&"ODataV4Adaptor"===o.getModuleName()){r=i?[t.foreignKeyValue]:r;for(let e=0;e<r.length;e++){let a=i?t:this.getColumnByField(r[e]);a.isForeignColumn()&&!i?n=this.fGeneratePredicate(a,n):n.push(new l.f(r[e],s.operator,s.key,s.ignoreCase,s.ignoreAccent))}let a=l.f.or(n);a.key=s.key,e.where(a)}else e.search(s.key,r,s.operator,s.ignoreCase,s.ignoreAccent)}return e}filterQuery(e,t,i){let s,r=this.parent,a=[],o=[],h=this.parent.getForeignKeyColumns();if(r.allowFiltering&&r.filterSettings.columns.length){let d=t||r.filterSettings.columns,c={};for(let e of r.getColumns())c[e.field]=e.filter.type?e.filter.type:r.filterSettings.type;let p=[],u=[];for(let e of d){let t=r.getColumnByField(e.field);Object(n.X)(e.type)&&t&&("date"===t.type||"datetime"===t.type)&&(e.type=r.getColumnByField(e.field).type),e.isForeignKey?p.push(e):u.push(e)}if(u.length){if("FilterBar"===r.filterSettings.type||"Menu"===r.filterSettings.type)for(let t=0,i=u.length;t<i;t++)u[t].uid=u[t].uid||this.parent.grabColumnByFieldFromAllCols(u[t].field).uid;let e=Ei.getPredicate(u);for(let t of Object.keys(e))a.push(e[t])}if(p.length)for(let e of p){e.uid=e.uid||this.parent.grabColumnByFieldFromAllCols(e.field).uid;let t=this.parent.grabColumnByUidFromAllCols(e.uid);if(t||this.parent.log("initial_action",{moduleName:"filter",columnName:e.field}),t.isForeignColumn()&&Gt(e.field,h)&&!i)o.push(e),t.columnData.length||(s=!0),a=this.fGeneratePredicate(t,a);else{let e=Ei.getPredicate(d);for(let t of Object.keys(e))a.push(e[t])}}a.length&&!s?e.where(l.f.and(a)):this.parent.notify("showEmptyGrid",{})}return e}fGeneratePredicate(e,t){let i={};return e&&(this.parent.notify("generateQuery",{predicate:i,column:e}),i.predicate.predicates.length&&t.push(i.predicate)),t}getData(e={requestType:""},t){let i=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());if(this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(e,t,i).promise;{let s;switch(e.requestType){case"delete":if(t=t||this.generateQuery(),1===Object.keys(e.data).length)s=this.dataManager.remove(i,e.data[0],t.fromTable,t);else{let r={addedRecords:[],deletedRecords:[],changedRecords:[]};r.deletedRecords=e.data,s=this.dataManager.saveChanges(r,i,t.fromTable,t.requiresCount())}break;case"save":Object(n.W)()&&this.parent.isServerRendered&&this.parent.notify("offset",e),t=t||this.generateQuery(),e.index=Object(n.X)(e.index)?0:e.index,s=this.dataManager.insert(e.data,t.fromTable,t,e.index)}return e.promise=s,!s||Array.isArray(s)||s.hasOwnProperty("deletedRecords")?this.insert(t,e):Object(n.W)()?s.then(i=>this.insert(t,e)).catch(e=>null):s.then(i=>this.insert(t,e))}}insert(e,t){return"save"===t.requestType&&this.parent.notify("recordAdded",t),this.executeQuery(e)}executeQuery(e){if(this.dataManager.ready){let t=new l.c;return this.dataManager.ready.then(i=>{this.dataManager.executeQuery(e).then(e=>{t.resolve(e)})}).catch(e=>{t.reject(e)}),t.promise}return this.dataManager.executeQuery(e)}formatGroupColumn(e,t){let i=this.serviceLocator,s=this.getColumnByField(t),r=e;return s.type||(s.type=r.getDay?r.getHours()>0||r.getMinutes()>0||r.getSeconds()>0||r.getMilliseconds()>0?"datetime":"date":typeof e),Object(n.X)(s.getFormatter())&&At(i,s),m.prototype.toView(e,s.getFormatter())}crudActions(e){let t=this.generateQuery(),i=null,s="promise",r=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(e,t,r),e.requestType){case"save":Object(n.W)()&&this.parent.isServerRendered&&this.parent.notify("offset",e),i=this.dataManager.update(r,e.data,t.fromTable,t,e.previousData)}e[s]=i||e[s],this.parent.notify("crud-Action",e)}saveChanges(e,t,i,s=this.generateQuery()){if(s.requiresCount(),"result"in this.parent.dataSource){let i;i=this.getStateEventArgument(s);let r=new l.c,n={requestType:"batchsave",changes:e,key:t,query:s,endEdit:r.resolve};return this.setState({isPending:!0,resolver:r.resolve}),this.parent.trigger("dataSourceChanged",n),r.promise}{let r="changedRecords",l="addedRecords",a="data";if(Object(n.W)()&&this.parent.isServerRendered){for(let t=0;t<e[r].length;t++){let i={data:e[r][t]};this.parent.notify("offset",i),e[r][t]=i[a]}for(let t=0;t<e[l].length;t++){let i={data:e[l][t]};this.parent.notify("offset",i),e[l][t]=i[a]}}return this.dataManager.saveChanges(e,t,s.fromTable,s,i)}}getKey(e){if(e&&e.length)return e[0]}isRemote(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url}addRows(e){for(let t=e.records.length;t>0;t--)this.dataManager.dataSource.json.splice(e.toIndex,0,e.records[t-1])}removeRows(e){this.dataManager.dataSource.json=this.dataManager.dataSource.json.filter((t,i)=>-1===e.records.indexOf(t))}getColumnByField(e){let t;return this.parent.columnModel.some(i=>(t=i,i.field===e))&&t}destroy(){this.parent.isDestroyed||(this.parent.off("rows-added",this.addRows),this.parent.off("rows-removed",this.removeRows),this.parent.off("datasource-modified",this.initDataManager),this.parent.off(F,this.destroy),this.parent.off("update-data",this.crudActions),this.parent.off("add-delete-Action",this.getData),this.parent.off(k,this.refreshFilteredCols),this.parent.off("columns-prepared",this.refreshFilteredCols))}getState(){return this.dataState}setState(e){return this.dataState=e}getForeignKeyDataState(){return this.foreignKeyDataState}setForeignKeyDataState(e){this.foreignKeyDataState=e}getStateEventArgument(e){let t=new l.h,i=new l.a({url:"",adaptor:new l.h}),s=t.processQuery(i,e),r=JSON.parse(s.data);return Object(n.K)(r,s.pvtData)}eventPromise(e,t,i){let s,r=e;s=this.getStateEventArgument(t);let n=new l.c,a=new l.c;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(s.action=e,"save"===e.requestType||"delete"===e.requestType){let t=e;t.key=i,t.promise=a.promise,t.state=s,this.setState({isPending:!0,resolver:a.resolve}),r.endEdit=a.resolve,r.cancelEdit=a.reject,this.parent.trigger("dataSourceChanged",t),a.promise.then(e=>{this.setState({isPending:!0,resolver:n.resolve,group:s.group,aggregates:s.aggregates}),"save"===t.requestType&&this.parent.notify("recordAdded",t),this.parent.trigger("dataStateChange",s)}).catch(()=>{})}else this.setState({isPending:!0,resolver:n.resolve,group:s.group,aggregates:s.aggregates}),this.parent.trigger("dataStateChange",s);else this.setState({}),n.resolve(this.parent.dataSource);return n}getSearchColumnFieldNames(){let e=[],t=this.parent.getColumns();for(let i of t)i.allowSearching&&!Object(n.X)(i.field)&&e.push(i.field);return e}refreshFilteredCols(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&function(e,t){for(let i=0;i<t.length;i++)t[i].uid=t[i].isForeignKey?Gt(t[i].field,e.getForeignKeyColumns()).uid:e.getColumnByField(t[i].field).uid}(this.parent,this.parent.filterSettings.columns)}}class P{constructor(e,t){Object(n.db)(this,e),this.parent=t}clone(){let e=new P({});return Object(n.db)(e,this),e.cells=this.cells.map(e=>e.clone()),e}setRowValue(e){if(!this.parent)return;let t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,e)}setCellValue(e,t){if(this.parent&&this.data[e].toString()!==t.toString()){let i=this.parent.getPrimaryKeyFieldNames()[0];this.parent.setCellValue(this.data[i],e,t),this.makechanges(i,this.data)}}makechanges(e,t){this.parent&&this.parent.getDataModule().dataManager.update(e,t)}}class q{constructor(e){this.isSpanned=!1,this.isRowSpanned=!1,Object(n.db)(this,e)}clone(){let e=new q({});return Object(n.db)(e,this),e}}class V{constructor(e,t){this.serviceLocator=e,this.parent=t}render(e,t,i,s){let r,l=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(t.cells[i].cellType||A.Data),a=t.cells[i].cellSpan?t.cells[i].cellSpan:e.colSpan+i<=t.cells.length?e.colSpan:t.cells.length-i,o=e.rowSpan,h=0;if(t.index>0){let e=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[t.index-1].isDataRow?this.parent.getRowsObject()[t.index].cells:this.parent.getRowsObject()[t.index-1].cells,s=t.cells[i],n="uid";r=e.filter(e=>e.column.uid===s.column[n])[0]}let d=r&&r.colSpanRange>1&&r.rowSpanRange>1?r.colSpanRange:a;for(let n=i+1;n<i+d&&n<t.cells.length;n++)!1===t.cells[n].visible?h++:t.cells[n].isSpanned=!0;if(h>0){for(let e=i+a;e<i+a+h&&e<t.cells.length;e++)t.cells[e].isSpanned=!0;i+a+h>=t.cells.length&&(a-=i+a+h-t.cells.length)}return t.cells[i].cellSpan&&(t.data[e.column.field]=t.cells[i].spanText,s=l.render(t.cells[i],t.data,{index:Object(n.X)(t.index)?"":t.index.toString()})),a>1&&Object(n.x)(s,{colSpan:a.toString(),"aria-colSpan":a.toString()}),o>1&&(Object(n.x)(s,{rowspan:o.toString(),"aria-rowspan":o.toString()}),t.cells[i].isRowSpanned=!0,t.cells[i].rowSpanRange=Number(o),a>1&&(t.cells[i].colSpanRange=Number(a))),t.index>0&&r.rowSpanRange>1&&(t.cells[i].isSpanned=!0,t.cells[i].rowSpanRange=Number(r.rowSpanRange-1),t.cells[i].colSpanRange=r.rowSpanRange>0?r.colSpanRange:1),!this.parent.enableColumnVirtualization||t.cells[i].cellSpan||this.containsKey(e.column.field,e.data[e.column.field])||this.backupMergeCells(e.column.field,e.data[e.column.field],e.colSpan),s}backupMergeCells(e,t,i){this.setMergeCells(this.generteKey(e,t),i)}generteKey(e,t){return e+"__"+t.toString()}splitKey(e){return e.split("__")}containsKey(e,t){return this.getMergeCells().hasOwnProperty(this.generteKey(e,t))}getMergeCells(){return this.parent.mergeCells}setMergeCells(e,t){this.parent.mergeCells[e]=t}updateVirtualCells(e){let t=this.getMergeCells();for(let i of Object.keys(t)){let s=t[i],r=this.splitKey(i),n=this.getIndexFromAllColumns(r[0]),l=this.parent.getColumnIndexesInView(),a=s-(l[0]-n);if(n<l[0]&&a>1)for(let t of e)if(t.data[r[0]].toString()===r[1].toString()){t.cells[0].cellSpan=a,t.cells[0].spanText=r[1];break}}return e}getIndexFromAllColumns(e){return lt(this.parent.getVisibleColumns(),(t,i)=>{if(t.field===e)return i})[0]}}class H{constructor(e,t,i){this.isSpan=!1,this.cellType=t,this.serviceLocator=e,this.parent=i,this.element=this.parent.createElement("tr",{attrs:{role:"row"}})}render(e,t,i,s,r){return this.refreshRow(e,t,i,s,r)}refresh(e,t,i,s,r){i&&(e.data=$t({},e.changes),this.refreshMergeCells(e));let n=this.parent.element.querySelector("[data-uid="+e.uid+"]"),l=this.refreshRow(e,t,s,r,null,i),a=[].slice.call(l.cells);n.innerHTML="";for(let o of a)n.appendChild(o)}refreshRow(e,t,i,s,r,l){let a=Object(n.X)(r)?this.element.cloneNode():r,o={data:e.data},h={data:e.data},d=Object(n.K)({},i,{}),c=this.parent.getColumns().filter(e=>"checkbox"===e.type&&e.field)[0],p=!1;c&&(p=_t(c.field,o.data)),e.isDataRow&&(e.isSelected=this.parent.getSelectedRowIndexes().indexOf(e.index)>-1||p),e.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0,-1===this.parent.getSelectedRowIndexes().indexOf(e.index)&&this.parent.getSelectedRowIndexes().push(e.index)),this.buildAttributeFromRow(a,e),Object(n.x)(a,d),ht(a,e.attributes);let u=this.serviceLocator.getService("cellRendererFactory");for(let m=0,b=e.cells.length;m<b;m++){let t=e.cells[m];t.isSelected=e.isSelected,t.isColumnSelected=t.column.isSelected;let i=u.getCellRenderer(e.cells[m].cellType||A.Data),s={index:Object(n.X)(e.index)?"":e.index.toString()};e.isExpand&&e.cells[m].cellType===A.DetailExpand&&(s.class=this.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");let r=i.render(e.cells[m],e.data,s,e.isExpand,l);if(e.cells[m].cellType!==A.Filter){if(e.cells[m].cellType===A.Data||e.cells[m].cellType===A.CommandColumn){this.parent.trigger("queryCellInfo",Object(n.K)(h,{cell:r,column:t.column,colSpan:1,rowSpan:1,foreignKeyData:e.cells[m].foreignKeyData,requestType:this.parent.requestTypeAction}));let i=!1;if(e.index>0&&this.isSpan){let t=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[e.index-1].isDataRow?this.parent.getRowsObject()[e.index].cells:this.parent.getRowsObject()[e.index-1].cells,s="uid",r=t.filter(t=>t.column.uid===e.cells[m].column[s])[0];i=r.isRowSpanned?r.isRowSpanned:r.rowSpanRange>1}(h.colSpan>1||e.cells[m].cellSpan>1||h.rowSpan>1||i)&&(this.isSpan=!0,r=new V(this.serviceLocator,this.parent).render(h,e,m,r))}e.cells[m].isSpanned||a.appendChild(r)}}let g={row:a,rowHeight:this.parent.rowHeight};if(e.isDataRow&&(this.parent.trigger("rowDataBound",Object(n.K)(o,g)),this.parent.childGrid||this.parent.isRowDragable()||this.parent.detailTemplate)){let e=a.querySelectorAll(".e-rowcell:not(.e-hide)")[0];e&&e.classList.add("e-detailrowvisible")}if(this.parent.enableVirtualization&&(o.rowHeight=this.parent.rowHeight),o.rowHeight?a.style.height=o.rowHeight+"px":this.parent.rowHeight&&(a.querySelector(".e-headercell")||a.querySelector(".e-groupcaption"))&&(a.style.height=this.parent.rowHeight+"px"),e.cssClass&&a.classList.add(e.cssClass),e.lazyLoadCssClass&&a.classList.add(e.lazyLoadCssClass),(!this.parent.enableColumnVirtualization||0===this.parent.frozenColumns)&&this.parent.element.scrollHeight>this.parent.height&&this.parent.aggregates.length)for(let m=0;m<this.parent.aggregates.length;m++)if(this.parent.aggregates[m].properties.columns[0].footerTemplate){let e=a.querySelectorAll(".e-summarycell");if(e.length){let t=e[e.length-1];Object(n.v)([t],["e-lastsummarycell"]);let i=e[0];Object(n.v)([i],["e-firstsummarycell"])}}return a}refreshMergeCells(e){for(let t of e.cells)t.isSpanned=!1;return e}buildAttributeFromRow(e,t){let i={},s=[];t.isDataRow&&s.push("e-row"),t.isAltRow&&s.push("e-altrow"),Object(n.X)(t.index)||(i["aria-rowindex"]=t.index),t.rowSpan&&(i.rowSpan=t.rowSpan),t.uid&&(i["data-uid"]=t.uid),t.isSelected&&(i["aria-selected"]=!0),!1===t.visible&&s.push("e-hide"),i.class=s,ht(e,i)}}class N{constructor(e){this.parent=e}generateRows(e,t){let i=[],s=this.parent.enableVirtualization&&t?t.startIndex:0;s=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):s;for(let r=0,n=Object.keys(e).length;r<n;r++,s++)i[r]=this.generateRow(e[r],s);return i}ensureColumns(){let e=[];if(this.parent.detailTemplate||this.parent.childGrid){let t={};this.parent.notify("detail-indentcell-info",t),e.push(this.generateCell(t,null,A.DetailExpand))}return this.parent.isRowDragable()&&e.push(this.generateCell({},null,A.RowDragIcon)),e}generateRow(e,t,i,s,r,l,a){let o={foreignKeyData:{}};o.uid=Object(n.W)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):St("grid-row"),o.data=e,o.index=t,o.indent=s,o.tIndex=l,o.isDataRow=!0,o.parentGid=r,o.parentUid=a,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?o.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[t]&&(o.isExpand=this.parent.expandedRows[t].isExpand)),o.cssClass=i,o.isAltRow=!!this.parent.enableAltRow&&t%2!=0,o.isAltRow=!!this.parent.enableAltRow&&t%2!=0,Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.selectionModule.checkBoxState?(o.isSelected=this.parent.selectionModule.checkBoxState,o.isSelected&&-1===this.parent.selectionModule.selectedRowIndexes.indexOf(t)&&this.parent.selectionModule.selectedRowIndexes.push(t)):o.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(o);let h=this.ensureColumns(),d=Object(n.W)()?new P(o):new P(o,this.parent);return d.cells="Right"===this.parent.getFrozenMode()?this.generateCells(o).concat(h):h.concat(this.generateCells(o)),d}refreshForeignKeyRow(e){let t=this.parent.getForeignKeyColumns();for(let i=0;i<t.length;i++)Object(n.qb)(t[i].field,Xt(t[i],e.data),e.foreignKeyData)}generateCells(e){let t=this.parent.getColumns(),i=[];for(let s=0;s<t.length;s++)i.push(this.generateCell(t[s],e.uid,Object(n.X)(t[s].commands)?void 0:A.CommandColumn,null,s,e.foreignKeyData));return i}generateCell(e,t,i,s,r,l){let a={visible:e.visible,isDataCell:!Object(n.X)(e.field||e.template),isTemplate:!Object(n.X)(e.template),rowID:t,column:e,cellType:Object(n.X)(i)?A.Data:i,colSpan:s,commands:e.commands,isForeignKey:e.isForeignColumn&&e.isForeignColumn(),foreignKeyData:e.isForeignColumn&&e.isForeignColumn()&&Object(n.V)(e.field,l)};return(a.isDataCell||"checkbox"===a.column.type||a.commands)&&(a.index=r),new q(a)}refreshRows(e){for(let t=0;t<e.length;t++)this.refreshForeignKeyRow(e[t]),e[t].cells=this.generateCells(e[t]);return e}getInfiniteIndex(e){return"infiniteScroll"===e.requestType||"delete"===e.requestType||"add"===e.action?e.startIndex:0}}class W{constructor(e){this.parent=e}getData(){let e=[],t=this.parent.aggregates.slice();for(let i=0;i<t.length;i++){let s=t[i].columns.filter(e=>!(e.footerTemplate||e.groupFooterTemplate||e.groupCaptionTemplate)||this.columnSelector(e));s.length&&e.push({columns:s})}return e}columnSelector(e){return void 0!==e.footerTemplate}getColumns(e,t){let i=[];if(this.parent.allowGrouping)for(let s=0;s<this.parent.groupSettings.columns.length;s++)i.push(new b({}));return(this.parent.detailTemplate||!Object(n.X)(this.parent.childGrid)||this.parent.isRowDragable()&&!e)&&i.push(new b({})),i.push(...this.parent.getColumns()),t=t?t+this.parent.getIndentCount():t,Object(n.X)(e)?i:i.slice(e,t)}generateRows(e,t,i,s,r){if(0===e.length&&(void 0===t||!t.count))return[];let n=this.buildSummaryData(e,t),l=[],a=this.getData();for(let o=0;o<a.length;o++)l.push(this.getGeneratedRow(a[o],n[o],t?t.level:void 0,i,s,t?t.parentUid:void 0,r));return l}getGeneratedRow(e,t,i,s,r,l,a){let o=[],h=this.getIndentByLevel(i),d=!Object(n.X)(this.parent.childGrid),c=this.parent.getIndentCount();this.parent.isRowDragable()&&(h=["e-indentcelltop"]);let p=a||this.getColumns(s,r);for(let n=0;n<p.length;n++)o.push(this.getGeneratedCell(p[n],e,n>=c?this.getCellType():n<this.parent.groupSettings.columns.length?A.Indent:A.DetailFooterIntent,h[n],d));let u=new P({data:t,attributes:{class:"e-summaryrow"}});return u.cells=o,u.uid=Object(n.W)()&&this.parent.isServerRendered&&!Object(n.X)(l)?this.parent.getRowUid("grid-row"):St("grid-row"),u.parentUid=l,u.visible=o.some(e=>e.isDataCell&&e.visible),u}getGeneratedCell(e,t,i,s,r){let l=t.columns.filter(t=>t.columnName===e.field)[0],a={style:{textAlign:e.textAlign},"e-mappinguid":e.uid,index:e.index};s&&(a.class=s),Object(n.X)(s)&&r&&(a.class="e-detailindentcelltop");let o={visible:e.visible,isDataCell:!Object(n.X)(l),isTemplate:l&&!Object(n.X)(l.footerTemplate||l.groupFooterTemplate||l.groupCaptionTemplate),column:l||{},attributes:a,cellType:i};return o.column.headerText=e.headerText,new q(o)}buildSummaryData(e,t){let i=[],s=this.getData(),r={};for(let n=0;n<s.length;n++){r={};let l=s[n].columns;for(let i=0;i<l.length;i++)r=this.setTemplate(l[i],t&&t.aggregates?t:e,r);i.push(r)}return i}getIndentByLevel(e){return this.parent.groupSettings.columns.map(()=>"e-indentcelltop")}setTemplate(e,t,i){let s=e.type,r={},l=e.getFormatter()||(e=>e),a=t;s instanceof Array||(s=[e.type]);for(let o=0;o<s.length;o++){let r=e.field+" - "+s[o].toLowerCase(),h=e.columnName,d="Custom"!==s[o]&&a.aggregates&&r in a.aggregates?a.aggregates[r]:jt(s[o],a.aggregates?a:t,e,this.parent);i[h]=i[h]||{},i[h][r]=d,i[h][s[o]]=Object(n.X)(d)?" ":l(d),a.field&&(i[h].field=a.field,i[h].key=a.key)}return r.format=e.getFormatter(),e.setTemplate(r),i}getCellType(){return A.Summary}}class X extends W{columnSelector(e){return void 0!==e.groupFooterTemplate}getIndentByLevel(e=this.parent.groupSettings.columns.length){return this.parent.groupSettings.columns.map((t,i)=>i<=e-1?"":"e-indentcelltop")}getCellType(){return A.GroupSummary}}class G extends W{columnSelector(e){return void 0!==e.groupCaptionTemplate}getData(){return[super.getData().reduce((e,t)=>(e.columns=[...e.columns,...t.columns],e),{columns:[]})]}isEmpty(){return 0===(this.getData()[0].columns||[]).length}getCellType(){return A.CaptionSummary}}class K extends N{constructor(e){super(e),this.rows=[],this.index=0,this.parent=e,this.summaryModelGen=new X(e),this.captionModelGen=new G(e)}generateRows(e,t){if(0===this.parent.groupSettings.columns.length)return super.generateRows(e,t);this.isInfiniteScroll="infiniteScroll"===t.requestType,this.rows=[],this.index=this.parent.enableVirtualization||this.isInfiniteScroll?t.startIndex:0;for(let i=0,s=e.length;i<s;i++)this.getGroupedRecords(0,e[i],e.level,i,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows}getGroupedRecords(e,t,i,s,r,l,a){let o=this.isInfiniteScroll&&this.prevKey===t.key,h=i;if(Object(n.X)(t.items))if(Object(n.X)(t.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(t,e,s,this.rows.length,a));else for(let n=0,d=t.length;n<d;n++)this.getGroupedRecords(e,t[n],t.level,s,e,this.rows.length,a);else{let i=this.generateCaptionRow(t,e,s,r,l,a);if(o||(this.rows=this.rows.concat(i)),t.items&&t.items.length&&this.getGroupedRecords(e+1,t.items,t.items.level,s,e+1,this.rows.length,i.uid),this.parent.aggregates.length){let e=this.rows.length;this.rows.push(...this.summaryModelGen.generateRows(t,{level:h,parentUid:i.uid}));for(let t=e-1;t>=0;t--)if(this.rows[t].isCaptionRow)this.rows[t].aggregatesCount=this.rows.length-e;else if(!this.rows[t].isCaptionRow&&!this.rows[t].isDataRow)break}}this.prevKey=t.key}getCaptionRowCells(e,t,i){let s=[],r=[],l=this.parent.getColumnByField(e),a=this.parent.getColumnIndexesInView();this.parent.enableColumnVirtualization&&(l=this.parent.columns.filter(t=>t.field===e)[0]);let o=this.parent.groupSettings.columns.length,h=this.parent;if(!this.parent.enableColumnVirtualization||-1!==a.indexOf(t)){for(let e=0;e<t;e++)s.push(this.generateIndentCell());s.push(this.generateCell({},null,A.Expand))}if(t=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+o+(h.detailTemplate||h.childGrid?1:0)-t+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty()){let e=this.captionModelGen.generateRows(i)[0];Object(n.K)(i,e.data);let s=0;e.cells.some((e,t)=>(s=t,e.visible&&e.isDataCell)),r=e.cells.slice(s).filter(e=>e.visible),e.visible&&r[0].column.field===this.parent.getVisibleColumns()[0].field&&(r=r.slice(1)),1===this.parent.getVisibleColumns().length&&(r=[]),t-=r.length}let d=this.parent.enableColumnVirtualization?this.parent.getColumns():[l],c=!0;for(let n=0;n<d.length;n++){let e=c&&-1!==a.indexOf(t);e&&(c=!1);let i=!this.parent.enableColumnVirtualization||e?A.GroupCaption:A.GroupCaptionEmpty;t=this.parent.enableColumnVirtualization&&i===A.GroupCaption?t+o:t,h.isRowDragable()&&t++,s.push(this.generateCell(l,null,i,t))}return s.push(...r),s}generateCaptionRow(e,t,i,s,r,l){let a={},o=this.parent.getColumnByField(e.field);a.data=Object(n.K)({},e),o&&(a.data.field=e.field),a.isDataRow=!1,a.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),a.parentGid=i,a.childGid=s,a.tIndex=r,a.isCaptionRow=!0,a.parentUid=l,a.gSummary=Object(n.X)(e.items.records)?e.items.length:e.items.records.length,a.uid=Object(n.W)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):St("grid-row");let h=new P(a);return h.indent=t,this.getForeignKeyData(h),h.cells=this.getCaptionRowCells(e.field,t,h.data),h}getForeignKeyData(e){let t=e.data,i=this.parent.getColumnByField(t.field);if(i&&i.isForeignColumn&&i.isForeignColumn()){let s=Object(n.X)(t.key)?"":i.valueAccessor(i.foreignKeyValue,Xt(i,{},t.key)[0],i);Object(n.qb)("foreignKey",s,e.data)}}generateDataRows(e,t,i,s,r){let n=[],l=this.parent.getColumnIndexesInView();for(let a=0,o=e.length;a<o;a++,s++){n[a]=this.generateRow(e[a],this.index,a?void 0:"e-firstchildrow",t,i,s,r);for(let e=0;e<t;e++)this.parent.enableColumnVirtualization&&-1===l.indexOf(t)||n[a].cells.unshift(this.generateIndentCell());this.index++}return n}generateIndentCell(){return this.generateCell({},null,A.Indent)}refreshRows(e){let t=this.parent.getColumnIndexesInView();for(let i=0;i<e.length;i++)if(e[i].isDataRow){e[i].cells=this.generateCells(e[i]);for(let s=0;s<e[i].indent;s++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e[i].indent)||e[i].cells.unshift(this.generateIndentCell())}else{let t=this.generateCaptionRow(e[i].data,e[i].indent);e[i].cells=t.cells}return e}ensureRowVisibility(){for(let e=0;e<this.rows.length;e++){let t=this.rows[e];if(t.isCaptionRow)for(let i=e+1;i<this.rows.length;i++)t.uid===this.rows[i].parentUid&&(this.rows[i].visible=t.isExpand)}}}class U{constructor(e,t){this.rows=[],this.freezeRows=[],this.movableRows=[],this.freezeRowElements=[],this.currentInfo={},this.prevCurrentView=[],this.isLoaded=!0,this.viewColIndexes=[],this.drop=e=>{(mt(e.target,"e-row")||mt(e.target,"e-emptyrow"))&&(this.parent.notify("columnDrop",{target:e.target,droppedElement:e.droppedElement}),Object(n.hb)(e.droppedElement))},this.infiniteCache={},this.isRemove=!1,this.visibleRows=[],this.visibleFrozenRows=[],this.rightFreezeRows=[],this.isAddRows=!1,this.isInfiniteFreeze=!1,this.useGroupCache=!1,this.mutableData=!1,this.rafCallback=e=>{let t=e;return()=>{if(this.parent.isFrozenGrid()&&this.parent.enableVirtualization){let t=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")),i=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll(".e-row"));if(this.isLoaded=!!t&&t.length===i.length,this.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&this.isLoaded){let e=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll(".e-row")),t=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll(".e-row"));this.isLoaded=e.length===t.length}}if(this.ariaService.setBusy(this.getPanel().querySelector(".e-content"),!1),this.parent.isDestroyed)return;let i=this.rows.slice(0);if(this.parent.isFrozenGrid()&&(i=e.isFrozen?this.freezeRows:e.renderFrozenRightContent?this.parent.getFrozenRightRowsObject():this.movableRows),this.parent.notify(O,{rows:i,args:t}),this.isLoaded&&this.parent.trigger(C,{},()=>{this.parent.allowTextWrap&&this.parent.notify("freezerender",{case:"textwrap"})}),t){let i=(t.requestType||"").toLowerCase()+"-complete";this.parent.notify(i,t),"batchsave"===e.requestType&&(e.cancel=!1,this.parent.trigger(y,e))}this.isLoaded&&this.parent.hideSpinner()}},this.parent=e,this.serviceLocator=t,this.ariaService=this.serviceLocator.getService("ariaService"),this.mutableData=this.parent.getDataModule().isRemote(),this.generator=this.getModelGenerator(),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("colgroup-refresh",this.colGroupRefresh,this),this.parent.on(x,this.enableAfterRender,this),this.parent.on("refresh-infinite-mode-blocks",this.refreshContentRows,this),this.parent.on("beforecellfocused",this.beforeCellFocused,this),this.parent.on(F,this.droppableDestroy,this))}beforeCellFocused(e){this.pressedKey=!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action?void 0:e.keyArgs.action}renderPanel(){let e=this.parent,t=this.parent.element.querySelector(".e-gridcontent");if(t)return this.ariaService.setOptions(this.parent.element.querySelector(".e-content"),{busy:!1}),void this.setPanel(t);t=this.parent.createElement("div",{className:"e-gridcontent"});let i=this.parent.createElement("div",{className:"e-content"});this.ariaService.setOptions(i,{busy:!1}),t.appendChild(i),this.setPanel(t),e.element.appendChild(t)}renderTable(){let e=this.getPanel(),t=e.querySelector(".e-virtualtable"),i=e.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||Object(n.X)(t)||Object(n.X)(i)||Object(n.W)()&&(!Object(n.W)()||this.parent.isServerRendered)||(Object(n.hb)(t),Object(n.hb)(i)),e.appendChild(this.createContentTable("_content_table")),this.setTable(e.querySelector(".e-table")),this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type}),this.initializeContentDrop(),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")}createContentTable(e){let t=this.getPanel().firstElementChild;Object(n.W)()||this.getTable()&&Object(n.hb)(this.getTable());let i=t.querySelector(".e-table")?t.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+e}});return this.setColGroup(this.parent.getHeaderTable().querySelector("colgroup").cloneNode(!0)),i.appendChild(this.getColGroup()),i.appendChild(this.parent.createElement("tbody")),t.appendChild(i),t}refreshContentRows(e={}){let t=this.parent;if(0===t.currentViewData.length)return;let i=this.currentMovableRows||t.currentViewData,s=this.parent.contentModule,r=t.isReact&&!Object(n.X)(t.rowTemplate),l=r?t.createElement("tbody"):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=Object(n.K)([],i));let a,o,h,d=r?t.createElement("tbody"):document.createDocumentFragment(),c=t.getColumns(),p=t.getFrozenColumns(),u=this.parent.isFrozenGrid(),g=new H(this.serviceLocator,null,this.parent),m=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;this.rowElements=[],this.rows=[];let b,f,y,C=this.getPanel().querySelector(".e-frozencontent"),v=this.getPanel().querySelector(".e-movablecontent"),w=this.getPanel().querySelector(".e-content");if(Yt(t)&&["sorting","filtering","searching","grouping","ungrouping","reorder"].some(t=>e.requestType===t)&&this.emptyVcRows(),Object(n.W)()&&this.parent.isServerRendered){y=this.generator.generateRows(i,e),this.parent.enableVirtualization&&(this.prevInfo=this.prevInfo?this.prevInfo:e.virtualInfo,this.prevInfo=e.virtualInfo.sentinelInfo&&"Y"===e.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==e.virtualInfo.page?this.currentInfo:e.virtualInfo),this.rows=y,this.freezeRows=y,this.rowElements=[].slice.call(this.getTable().querySelectorAll("tr.e-row[data-uid]")),p&&(this.movableRows=y.map(e=>{let t=new P(e);return t.cells=e.cells.slice(p,e.cells.length),e.cells=e.cells.slice(0,p),t}),this.freezeRowElements=this.rowElements),this.isLoaded=!0,this.parent.hideSpinner(),e.isFrozen=0!==this.parent.getFrozenColumns()&&!e.isFrozen;let t=Object(n.K)({rows:this.rows},e);if(this.getTable().querySelector(".e-emptyrow")&&(Object(n.hb)(this.getTable().querySelector(".e-emptyrow")),Object(n.X)(this.getTable().querySelectorAll(".e-table > tbody")[1])||Object(n.hb)(this.getTable().querySelectorAll(".e-table > tbody")[1])),this.parent.notify("contentcolgroup",{}),this.rafCallback(t)(),p&&(w.style.overflowY="hidden",C.style.height=v.offsetHeight-Et()+"px",v.style.overflowY="auto"!==this.parent.height?"scroll":"auto",C.style.borderRightWidth="1px",this.parent.notify(O,{rows:this.movableRows,args:Object(n.K)({},t,{isFrozen:!1})})),!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.enableVirtualization){let t="editRowIndex";"Normal"!==this.parent.editSettings.mode||Object(n.X)(e[t])||this.parent.selectRow(e[t])}if(this.parent.enableVirtualization&&!this.parent.getHeaderContent().querySelectorAll(".e-check").length){let e=this.parent.getRows().filter(e=>e.getAttribute("aria-selected")).map(e=>e.getAttribute("data-uid")),t=this.parent.getRows().filter(e=>null===e.getAttribute("aria-selected")).map(e=>e.getAttribute("data-uid"));for(let i=0;i<e.length;i++)if(!Object(n.X)(this.parent.getRowObjectFromUID(e[i]))&&!this.parent.getRowObjectFromUID(e[i]).isSelected){this.parent.getRowElementByUID(e[i]).removeAttribute("aria-selected"),Object(n.X)(this.parent.getRowElementByUID(e[i]).querySelector(".e-check"))||Object(n.ib)([this.parent.getRowElementByUID(e[i]).querySelector(".e-check")],["e-check"]);for(let t=0;t<this.parent.getRowElementByUID(e[i]).children.length;t++)this.parent.getRowElementByUID(e[i]).children[t].classList.remove("e-selectionbackground","e-active")}for(let i=0;i<t.length;i++)if(!Object(n.X)(this.parent.getRowObjectFromUID(t[i]))&&this.parent.getRowObjectFromUID(t[i]).isSelected){this.parent.getRowElementByUID(t[i]).setAttribute("aria-selected","true"),Object(n.X)(this.parent.getRowElementByUID(t[i]).querySelector(".e-frame"))||Object(n.v)([this.parent.getRowElementByUID(t[i]).querySelector(".e-frame")],["e-check"]);for(let e=0;e<this.parent.getRowElementByUID(t[i]).children.length;e++)this.parent.getRowElementByUID(t[i]).children[e].classList.add("e-selectionbackground","e-active")}}return}this.parent.enableVirtualization&&this.parent.isFrozenGrid()?(this.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis&&(y=this.parent.contentModule.generateRows(i,e),e.renderMovableContent=!0),y=this.parent.contentModule.generateRows(i,e)):(y=this.checkCache(y,e),this.isAddRows||this.useGroupCache||(y=this.generator.generateRows(i,e))),this.setGroupCache(y,e),this.parent.notify("set-infinite-cache",{isInfiniteScroll:m,modelData:y,args:e});let S=y[0].cells[0].index;if(u&&(f=s.setTbody(y,e),b=s.getTbody(f)),"infiniteScroll"!==e.requestType&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!e.isFrozen){let e=[];for(let t=0;t<this.parent.registeredTemplate.template.length;t++)for(let i=0;i<this.parent.registeredTemplate.template[t].rootNodes.length;i++)Object(n.X)(this.parent.registeredTemplate.template[t].rootNodes[i].parentNode)&&e.push(this.parent.registeredTemplate.template[t]);this.parent.destroyTemplate(["template"],e)}this.parent.isReact&&"infiniteScroll"!==e.requestType&&!e.isFrozen&&(this.parent.destroyTemplate(["columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate"]),this.parent.renderTemplates()),this.parent.enableColumnVirtualization&&new V(this.serviceLocator,this.parent).updateVirtualCells(y),u||(this.tbody=this.getTable().querySelector("tbody"));let x=0,j=!0;if(Yt(t)&&t.vcRows.length){let i="top",s=Object(n.X)(e.virtualInfo.offsets)?Object(n.X)(e.scrollTop)?0:e.scrollTop[i]:e.virtualInfo.offsets.top;if(0!==s){let i=t.vGroupOffsets,r=t.pageSettings.pageSize/2,l=Object.keys(i).map(e=>i[e]);for(let t=0;t<l.length;t++)if(s<l[t]){if(Object(n.X)(e.virtualInfo)||"up"!==e.virtualInfo.direction){e.virtualInfo.blockIndexes=0===t||1===t?[1,2]:[t,t+1],x=0===t||1===t?0:t*r;break}e.virtualInfo.blockIndexes=0===t||1===t?[1,2]:[t,t+1],x=0===t||1===t?0:t*r;break}s+this.contentPanel.firstElementChild.offsetHeight!==this.contentPanel.firstElementChild.scrollHeight||e.rowObject||(j=!1)}}let R=t.frozenRows&&!t.isFrozenGrid()&&this.parent.enableVirtualization&&"reorder"===e.requestType;if(t.frozenRows&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis||R){let t=e.virtualInfo.blockIndexes,s=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],R&&(e.virtualInfo.page=1);let r=this.vgenerator.generateRows(R?this.initialPageRecords:i,e);r.splice(this.parent.frozenRows);for(let e=0;e<this.parent.frozenRows;e++)r[e].cells.splice(0,this.parent.getFrozenColumns()),a=g.render(r[e],c),d.appendChild(a);e.virtualInfo.blockIndexes=t,e.virtualInfo.page=s,R&&1===e.virtualInfo.page&&y.splice(0,this.parent.frozenRows)}this.virtualFrozenHdrRefresh(d,y,g,e,i,c);for(let O=x,D=y.length;O<D;O++)if(this.rows.push(y[O]),!this.parent.groupSettings.enableLazyLoading||this.useGroupCache||!this.parent.groupSettings.columns.length||(this.setRowsInLazyGroup(y[O],O),!Object(n.X)(y[O].indent))){if(this.setInfiniteVisibleRows(e,y[O],f),Yt(t)&&this.rows.length>=t.pageSettings.pageSize&&j)break;if(t.rowTemplate){let e,s=t.element.id+"rowTemplate";if(t.isReact){let e=t.frozenRows&&O<t.frozenRows,r=Object(n.K)({index:O},i[O]);t.getRowTemplate()(r,t,"rowTemplate",s,null,null,e?d:l),t.renderTemplates()}else e=t.getRowTemplate()(Object(n.K)({index:O},i[O]),t,"rowTemplate",s);if(t.isReact||"TBODY"!==e[0].tagName)t.frozenRows&&O<t.frozenRows?a=t.isReact?d.lastElementChild:Ot(d,e):(t.isReact||(a=Ot(l,e)),h=t.isReact?l.lastElementChild:a.lastElementChild);else{for(let t=0;t<e.length;t++){let i="tr"===e[t].nodeName.toLowerCase();(i||e[t].querySelectorAll&&e[t].querySelectorAll("tr").length)&&(a=i?e[t]:e[t].querySelector("tr"))}t.frozenRows&&O<t.frozenRows?d.appendChild(a):l.appendChild(a)}this.parent.trigger("rowDataBound",{data:y[O].data,row:h||a})}else{a=g.render(y[O],c);let i=this.ensureFrozenHeaderRender(e);t.frozenRows&&O<t.frozenRows&&!m&&"virtualscroll"!==e.requestType&&i&&this.ensureVirtualFrozenHeaderRender(e)?d.appendChild(a):l.appendChild(a),y[O].isExpand&&t.notify("expandchildgrid",a.cells[t.groupSettings.columns.length])}y[O].isDataRow&&this.rowElements.push(a),this.ariaService.setOptions(this.getTable(),{colcount:t.getColumns().length.toString()})}if(u&&s.splitRows(f),t.frozenRows&&"virtualscroll"!==e.requestType&&!m&&this.ensureVirtualFrozenHeaderRender(e)||"virtualscroll"===e.requestType&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis)if(o=u?s.getFrozenHeader(f):t.getHeaderTable().querySelector("tbody"),r){let e=o.parentElement;Object(n.hb)(o),e.appendChild(d)}else o.innerHTML="",o.appendChild(d);!t.enableVirtualization&&t.frozenRows&&0===S&&w.offsetHeight===Number(t.height)&&(w.style.height=w.offsetHeight-o.offsetHeight+"px"),Object(n.W)()&&!this.parent.isJsComponent||(e.rows=this.rows.slice(0)),u&&s.setIsFrozen(e,f),this.index=S,et(()=>{this.parent.notify("beforeFragAppend",e);let i=this.parent.enableVirtualization&&this.parent.isFrozenGrid();if(this.parent.enableVirtualization||m||(this.parent.isFrozenGrid()?(Object(n.hb)(b),b=this.parent.createElement("tbody")):(Object(n.hb)(this.tbody),this.tbody=this.parent.createElement("tbody"))),!u||i||this.parent.enableInfiniteScrolling)if(t.rowTemplate&&Object(n.sb)(t.element.id+"rowTemplate","RowTemplate",t),i){if(e.renderFrozenRightContent){let i=t.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");this.appendContent(i,l,e)}else e.renderMovableContent?(this.appendContent(v.querySelector("tbody"),l,e),e.renderMovableContent=!1):this.appendContent(C.querySelector("tbody"),l,e);this.parent.getFrozenColumns()||s.renderNextFrozentPart(e,f)}else if(!Object(n.X)(this.parent.infiniteScrollModule)&&this.parent.enableInfiniteScrolling){if(this.isAddRows=!1,this.parent.notify("remove-infinite-rows",{args:e}),this.parent.notify("append-infinite-content",{tbody:b||this.tbody,frag:l,args:e,rows:this.rows,rowElements:this.rowElements,visibleRows:this.visibleRows,tableName:f}),!p&&u){let t=this.parent.getTablesCount();(2!==t||"frozen-left"!==f&&"frozen-right"!==f)&&(3!==t||"frozen-left"!==f&&"movable"!==f)||this.refreshContentRows(Object(n.K)({},e))}}else this.useGroupCache=!1,this.appendContent(this.tbody,l,e);else this.appendContent(b,l,e,f);p&&s.renderNextFrozentPart(e,f),l=null},this.rafCallback(Object(n.K)({},e)))}emptyVcRows(){this.parent.vcRows=[],this.parent.vRows=[]}appendContent(e,t,i,s){this.parent.isReact&&!Object(n.X)(this.parent.rowTemplate)?this.getTable().appendChild(t):(e.appendChild(t),this.getTable().appendChild(e))}setRowsInLazyGroup(e,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.contentModule.maintainRows(e,t)}setGroupCache(e,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify("group-cache",{args:t,data:e})}ensureFrozenHeaderRender(e){return!(this.parent.enableVirtualization&&("reorder"===e.requestType||"refresh"===e.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)}ensureVirtualFrozenHeaderRender(e){return!(this.parent.enableVirtualization&&"delete"===e.requestType)}checkCache(e,t){if(this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===t.requestType){let i=t.isFrozen?1:0,s=this.parent.isFrozenGrid();if(this.isAddRows=!Object(n.X)(this.infiniteCache[this.parent.pageSettings.currentPage]),s&&!Object(n.X)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][i].length),this.isAddRows){let t=s?this.infiniteCache[this.parent.pageSettings.currentPage][i]:this.infiniteCache[this.parent.pageSettings.currentPage];e=1===this.parent.pageSettings.currentPage?t.slice(this.parent.frozenRows):t}return e}return this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===t.requestType||"columnstate"===t.requestType||"reorder"===t.requestType)&&this.parent.contentModule.getGroupCache()[this.parent.pageSettings.currentPage]?(this.useGroupCache=!0,this.parent.contentModule.initialGroupRows("reorder"===t.requestType)):null}setInfiniteVisibleRows(e,t,i){let s=this.parent.isFrozenGrid();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(s?"frozen-left"===i||"Right"===this.parent.getFrozenMode()&&"frozen-right"===i?this.visibleFrozenRows.push(t):"movable"===i?this.visibleRows.push(t):this.rightFreezeRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))}getCurrentBlockInfiniteRecords(e){let t=[];if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];let i=this.parent.isFrozenGrid(),s=this.parent.getRows(),r=parseInt(s[this.parent.frozenRows].getAttribute("aria-rowindex"),10),n=Math.ceil((r+1)/this.parent.pageSettings.pageSize);r=parseInt(s[s.length-1].getAttribute("aria-rowindex"),10);let l=Math.ceil(r/this.parent.pageSettings.pageSize);if(i){let i=e?0:1;for(let e=n;e<=l;e++)t=t.length?t.concat(this.infiniteCache[e][i]):this.infiniteCache[e][i];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][i].slice(0,this.parent.frozenRows).concat(t))}else{for(let e=n;e<=l;e++)t=t.length?t.concat(this.infiniteCache[e]):this.infiniteCache[e];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t}getReorderedVFRows(e){return this.parent.contentModule.getReorderedFrozenRows(e)}virtualFrozenHdrRefresh(e,t,i,s,r,n){if(this.parent.frozenRows&&this.parent.isFrozenGrid()&&this.parent.enableVirtualization&&("reorder"===s.requestType||"refresh"===s.requestType)){let l;this.currentMovableRows=r;let a=this.getReorderedVFRows(s);for(let t=0;t<a.length;t++)l=i.render(a[t],n),e.appendChild(l);1===s.virtualInfo.page&&t.splice(0,this.parent.frozenRows),s.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}}getInfiniteRows(){let e=[],t=this.parent.isFrozenGrid();if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache){let i=Object.keys(this.infiniteCache);for(let s=0;s<i.length;s++)e=t?[...e,...this.infiniteCache[i[s]][0]]:[...e,...this.infiniteCache[i[s]]]}else e=t?this.visibleFrozenRows:this.visibleRows;return e}getInfiniteMovableRows(){let e=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?e.length?e:this.visibleRows:[]}getPanel(){return this.contentPanel}setPanel(e){this.contentPanel=e}getTable(){return this.contentTable}setTable(e){this.contentTable=e}getRows(){let e=this.getInfiniteRows();return e.length?e:this.parent.getFrozenColumns()?this.freezeRows:this.rows}getMovableRows(){let e=this.getInfiniteMovableRows();return e.length?e:this.movableRows}getRowElements(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements}getMovableRowElements(){return this.rowElements}setRowElements(e){this.rowElements=e}getColGroup(){return this.colgroup}setColGroup(e){return Object(n.X)(e)||(e.id="content-"+e.id),this.colgroup=e}setVisible(e){let t=this.parent;Object(n.W)()&&t.isServerRendered&&this.parent.notify("setvisibility",e);let i,s=this.parent.isFrozenGrid(),r=t.getFrozenColumns(),l=[];if(s){let e,i=this.freezeRows,s=this.movableRows,r=i.length,n=[];3===t.getTablesCount()&&(n=t.getFrozenRightRowsObject());for(let t,a=0;a<r;a++){e=s[a].cells.length;let r=n.length?n[a].cells.length:0;t=i[a].clone();for(let i=0;i<e;i++)t.cells.push(s[a].cells[i]);for(let e=0;e<r;e++)t.cells.push(n[a].cells[e]);l.push(t)}}else l=this.getRows();l.some(e=>(e.isDataRow&&(i=e),e.isDataRow));let a=!0;!t.groupSettings.columns.length&&i&&(a=!1);let o=t.getDataRows(),h=this.infiniteRowVisibility()||this.rows.filter(e=>!e.isDetailRow);for(let d=0,c=e.length;d<c;d++){let l=e[d],c=this.parent.getNormalizedColumnIndex(l.uid),p=this.parent.getColumnIndexByUid(l.uid),u=!0===l.visible?"":"none";if(-1!==c&&i&&c<i.cells.length)if(s)if("movable"!==l.getFreezeTableName())if("frozen-right"===l.getFreezeTableName()){p=c-=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount();let e=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("colgroup");Object(n.ob)(e.childNodes[c],{display:u}),h=t.getFrozenRightRowsObject(),o=t.getFrozenRightDataRows()}else Object(n.ob)(this.getColGroup().childNodes[c],{display:u}),h=this.infiniteRowVisibility(!0)||this.freezeRows,o=t.getDataRows();else{let e=t.getContent().querySelector(".e-movablecontent").querySelector("colgroup");p=c=c-r-this.parent.getFrozenLeftColumnsCount(),Object(n.ob)(e.childNodes[c],{display:u}),o=t.getMovableDataRows(),h=this.infiniteRowVisibility()||this.movableRows}else Object(n.ob)(this.getColGroup().childNodes[c],{display:u});a||this.setDisplayNone(o,p,u,h),!this.parent.invokedFromMedia&&l.hideAtMedia&&this.parent.updateMediaColumns(l),this.parent.invokedFromMedia=!1}a?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify("partial-refresh",{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify("partial-refresh",{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify("partial-refresh",{rows:h,args:{}})}setDisplayNone(e,t,i,s){let r=Object.keys(e);for(let l=0;l<r.length;l++){let a=e[r[l]].querySelectorAll("td.e-rowcell")[t];if(e[r[l]].querySelectorAll("td.e-rowcell").length&&a)if(Object(n.ob)(e[r[l]].querySelectorAll("td.e-rowcell")[t],{display:i}),e[r[l]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(n.ib)([e[r[l]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),this.parent.isRowDragable()){let e=this.parent.getFrozenColumns()?t:t+1;s[r[l]].cells[e].visible=""===i}else s[r[l]].cells[t].visible=""===i}this.parent.notify("infinite-show-hide",{visible:i,index:t,isFreeze:this.isInfiniteFreeze})}infiniteRowVisibility(e){let t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=e,t=this.parent.infiniteScrollSettings.enableCache?e?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():e?this.visibleFrozenRows:this.visibleRows),t}colGroupRefresh(){if(this.getColGroup()){let e;e=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):this.getHeaderColGroup(),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)}}getHeaderColGroup(){return Object(n.W)()?this.parent.getHeaderTable().querySelector("colgroup").cloneNode(!0):this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)}initializeContentDrop(){this.droppable=new n.j(this.parent.element,{accept:".e-dragclone",drop:this.drop})}droppableDestroy(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()}canSkip(e,t,i){return Object(n.X)(t)||Object(n.X)(e.visible)||t.cells[i].visible===e.visible}getModelGenerator(){return this.generator=this.parent.allowGrouping?new K(this.parent):new N(this.parent)}renderEmpty(e){Object(n.W)()&&!this.parent.isJsComponent&&this.parent.frozenRows||(this.getTable().appendChild(e),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("tbody").innerHTML=""))}setSelection(e,t,i){this.parent.notify("set-freeze-selection",{uid:e,set:t,clearAll:i});let s=this.parent.isFrozenGrid();if(s&&this.parent.enableVirtualization)return;if(s){let s=this.getMovableRows().filter(t=>i||e===t.uid);for(let e=0;e<s.length;e++)s[e].isSelected=t}let r=this.getRows().filter(t=>i||e===t.uid);for(let n=0;n<r.length;n++){r[n].isSelected=t;let e=r[n].cells;for(let i=0;i<e.length;i++)e[i].isSelected=t}}getRowByIndex(e){return e=this.getInfiniteRowIndex(e),this.parent.getDataRows()[e]}getInfiniteRowIndex(e){if(this.parent.infiniteScrollSettings.enableCache){let t=this.parent.frozenRows,i=t>e?0:t,s=parseInt(this.parent.getRows()[i].getAttribute("aria-rowindex"),10);e=t>e?e:e-s+t}return e}getVirtualRowIndex(e){return e}getMovableRowByIndex(e){return e=this.getInfiniteRowIndex(e),this.parent.getMovableDataRows()[e]}enableAfterRender(e){"group"===e.module&&e.enable&&(this.generator=this.getModelGenerator())}setRowObjects(e){this.rows=e}immutableModeRendering(e={}){let t=this.parent;t.hideSpinner();let i=t.getPrimaryKeyFieldNames()[0],s={},r={},l=[],a={},o=t.getRowsObject().slice(),h=this.getBatchEditedRecords(i,o),d={},c=0!==Object.keys(h).length;if(t.getContent().querySelector(".e-emptyrow")||"reorder"===e.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(e);else{if(0===t.currentViewData.length)return;let p={},u=t.createElement("tbody"),g=t.currentViewData,m=[].slice.call(this.getTable().querySelector("tbody").children);if(this.prevCurrentView.length){let e=this.prevCurrentView.length,t=g.length;if(e===t)for(let n=0;n<t;n++)"Batch"===this.parent.editSettings.mode&&m[n].classList.contains("e-insertedrow")?(m.splice(n,1),--n):(r[g[n][i]]=s[this.prevCurrentView[n][i]]=n,d[n]=g[n][i],p[o[n].uid]=m[n],a[n]=this.prevCurrentView[n][i]);else{for(let e=0;e<t;e++)r[g[e][i]]=e,d[e]=g[e][i];for(let t=0;t<e;t++)"Batch"===this.parent.editSettings.mode&&m[t].classList.contains("e-insertedrow")?(m.splice(t,1),--t):(p[o[t].uid]=m[t],s[this.prevCurrentView[t][i]]=t,a[t]=this.prevCurrentView[t][i])}}for(let e=0;e<g.length;e++){let r=s[g[e][i]];if(Object(n.X)(r)){let i=new H(this.serviceLocator,null,t),s=this.generator.generateRows([g[e]]);l.push(s[0]);let r=i.render(s[0],t.getColumns());u.appendChild(r),this.refreshImmutableContent(e,r,l[e])}else{let t=!1;this.mutableData&&(t=this.objectEqualityChecker(this.prevCurrentView[e],g[e]));let i=p[o[r].uid];if(l.push(o[r]),this.rowElements[e]&&this.rowElements[e].getAttribute("data-uid")===l[e].uid&&(c&&Object(n.X)(h[d[e]])||!c&&(t||this.prevCurrentView[e]===g[e]))){r!==e&&this.refreshImmutableContent(e,i,l[e]),u.appendChild(i);continue}(c&&!Object(n.X)(h[d[e]])||!this.mutableData&&g[e]!==this.prevCurrentView[r]||this.mutableData&&!t)&&o[r].setRowValue(g[e]),u.appendChild(i),this.refreshImmutableContent(e,i,l[e])}}if(this.rows=l,this.rowElements=[].slice.call(u.children),Object(n.hb)(this.getTable().querySelector("tbody")),this.getTable().appendChild(u),this.parent.trigger(C,{},()=>{this.parent.allowTextWrap&&this.parent.notify("freezerender",{case:"textwrap"})}),e){let t=(e.requestType||"").toLowerCase()+"-complete";this.parent.notify(t,e)}}}objectEqualityChecker(e,t){let i=Object.keys(e),s=!0;for(let r=0;r<i.length;r++)if(e[i[r]]!==t[i[r]]){s=!1;break}return s}getBatchEditedRecords(e,t){let i={},s=this.parent.getBatchChanges(),r=[],n=[];Object.keys(s).length&&(r=s.changedRecords,n=s.addedRecords);let l={cancel:!1};this.parent.notify("immutable-batch-cancel",{rows:t,args:l}),n.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,n.length):l.cancel||t.splice(0,n.length));for(let a=0;a<r.length;a++)i[r[a][e]]=a;return i}refreshImmutableContent(e,t,i){i.isAltRow=!!this.parent.enableAltRow&&e%2!=0,i.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow"),i.index=e,i.edit=void 0,i.isDirty=!1,t.setAttribute("aria-rowindex",e.toString()),this.updateCellIndex(t,e)}updateCellIndex(e,t){for(let i=0;i<e.cells.length;i++)e.cells[i].setAttribute("index",t.toString())}}class Y{constructor(e,t){this.frzIdx=0,this.notfrzIdx=0,this.isFirstCol=!1,this.isReplaceDragEle=!0,this.helper=e=>{let t=this.parent,i=this.draggable.currentStateTarget,s=mt(i,"e-headercell");if(!t.allowReordering&&!t.allowGrouping||!Object(n.X)(s)&&s.querySelectorAll(".e-checkselectall").length>0)return!1;let r=this.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),l=i.classList.contains("e-headercell")?i:s;if(!l||!t.allowReordering&&l.classList.contains("e-stackedheadercell"))return!1;let a,o=l.offsetHeight,h=l.querySelector(".e-headercelldiv")||l.querySelector(".e-stackedheadercelldiv");if(h){if(a=l.querySelector(".e-stackedheadercelldiv")?t.getStackedHeaderColumnByHeaderText(h.innerText.trim(),t.columns):t.getColumnByUid(h.getAttribute("e-mappinguid")),this.column=a,this.column.lockColumn)return!1;r.setAttribute("e-mappinguid",this.column.uid)}if(a&&!Object(n.X)(a.headerTemplate))if(Object(n.X)(a.headerTemplate))r.innerHTML=a.headerTemplate;else{let e,i=t.getColumnIndexByField(a.field);e=a.getHeaderTemplate()(Object(n.K)({index:i},a),t,"headerTemplate"),Ot(r,e)}else r.innerHTML=h?a.headerText:l.firstElementChild.innerHTML;return r.style.width=l.offsetWidth+"px",r.style.height=l.offsetHeight+"px",r.style.lineHeight=(o-6).toString()+"px",t.element.appendChild(r),r},this.dragStart=e=>{let t=this.parent;t.element.querySelector(".e-gridpopup").style.display="none",t.notify("columnDragStart",{target:this.draggable.currentStateTarget,column:this.column,event:e.event}),Object(n.W)()&&e.bindEvents(e.dragElement)},this.drag=e=>{let t=this.parent,i=e.target;if(i){let s=Object(n.C)(i,".e-grid"),r=this.parent.element.querySelector(".e-cloneproperties");if(!(s&&s.getAttribute("id")===t.element.getAttribute("id")||(Object(n.A)(r,["e-notallowedcur"],["e-defaultcur"]),t.allowReordering&&(t.element.querySelector(".e-reorderuparrow").style.display="none",t.element.querySelector(".e-reorderdownarrow").style.display="none"),t.groupSettings.allowReordering)))return;t.notify("columnDrag",{target:e.target,column:this.column,event:e.event})}},this.dragStop=e=>{let t,i=this.parent;i.element.querySelector(".e-gridpopup").style.display="none",(!mt(e.target,"e-headercell")&&!mt(e.target,"e-groupdroparea")||!i.allowReordering&&mt(e.target,"e-headercell")||!e.helper.getAttribute("e-mappinguid")&&mt(e.target,"e-groupdroparea"))&&(Object(n.hb)(e.helper),t=!0),i.notify("column-drag-stop",{target:e.target,event:e.event,column:this.column,cancel:t})},this.drop=e=>{let t=this.parent,i=e.droppedElement.getAttribute("e-mappinguid"),s=Object(n.C)(e.target,".e-grid");Object(n.hb)(e.droppedElement),s&&s.getAttribute("id")!==t.element.getAttribute("id")||!t.allowReordering&&!t.allowGrouping||t.notify("header-drop",{target:e.target,uid:i,droppedElement:e.droppedElement})},this.parent=e,this.serviceLocator=t,this.ariaService=this.serviceLocator.getService("ariaService"),this.widthService=this.serviceLocator.getService("widthService"),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount()||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("column-position-changed",this.colPosRefresh,this))}renderPanel(){let e=this.parent.element.querySelector(".e-gridheader"),t=null!=e;e=t?e:this.parent.createElement("div",{className:"e-gridheader"});let i=t?e.querySelector(".e-headercontent"):this.parent.createElement("div",{className:"e-headercontent"});this.toggleStackClass(e),e.appendChild(i),this.setPanel(e),t||this.parent.element.appendChild(e)}renderTable(){let e=this.getPanel();e.appendChild(this.createHeaderTable()),this.setTable(e.querySelector(".e-table")),this.parent.getFrozenColumns()||this.parent.getFrozenRightColumnsCount()||this.parent.getFrozenLeftColumnsCount()||(this.initializeHeaderDrag(),this.initializeHeaderDrop()),this.parent.notify(E,{rows:this.rows,args:{isFrozen:this.parent.isFrozenGrid()}})}getPanel(){return this.headerPanel}setPanel(e){this.headerPanel=e}getTable(){return this.headerTable}setTable(e){this.headerTable=e}getColGroup(){return this.colgroup}setColGroup(e){return this.colgroup=e}getRows(){return this.getTable().tHead.rows}createHeaderTable(){let e=Object(n.W)()&&0!==this.parent.frozenRows,t=this.createTable(),i=this.getPanel().querySelector(".e-headercontent");return e||i.appendChild(t),i}createTable(e=null){let t=Object(n.W)()&&0!==this.parent.frozenRows,i=this.parent,s=i.isFrozenGrid();Object(n.W)()&&!i.isJsComponent||!this.getTable()||s||Object(n.hb)(this.getTable()),i.getColumns();let r=this.getPanel().querySelector(".e-headercontent"),l=t?e||r.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid"}}),a=this.createHeaderContent(),o=a.thead,h=this.parent.createElement("tbody",{className:this.parent.frozenRows?"":"e-hide"});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});let d,c=this.parent.createElement("colgroup"),p=this.parent.createElement("tr"),u=this.rows=a.rows;new H(this.serviceLocator,A.Header,this.parent);for(let n=0,g=u.length;n<g;n++)for(let e=0,t=u[n].cells.length;e<t;e++)d=this.parent.createElement("td"),p.appendChild(d);return(i.allowFiltering||i.allowSorting||i.allowGrouping)&&l.classList.add("e-sortfilter"),this.updateColGroup(c),t||h.appendChild(p),l.appendChild(this.setColGroup(c)),l.appendChild(o),t||l.appendChild(h),l.appendChild(this.caption),this.ariaService.setOptions(l,{colcount:i.getColumns().length.toString()}),l}createHeaderContent(){let e=this.parent,t=1,i=e.getFrozenMode(),s=e.getColumns(),r=this.parent.createElement("thead"),n=this.parent.createElement("tr",{className:"e-columnheader"}),l=new H(this.serviceLocator,A.Header,e);l.element=n;let a,o=[];this.colDepth=ei(e.columns);for(let d=0,c=this.colDepth;d<c;d++)o[d]=this.generateRow(d),o[d].cells=[];"Right"!==i&&(o=this.ensureColumns(o)),o=this.getHeaderCells(o),"Right"===i&&(t=0,o=this.ensureColumns(o));let h=this.parent.getFrozenColumns();if(this.parent.isRowDragable()&&this.parent.isFrozenGrid()&&o[0].cells[t]){let e=o[0].cells[t].column.getFreezeTableName();"movable"===e||"Left-Right"===i&&"frozen-right"===e?"Right"===i?o[0].cells.pop():o[0].cells.shift():h||"frozen-left"!==e?"Right"===i&&"frozen-right"===e&&(o[0].cells[o[0].cells.length-1].column.freeze="Right"):o[0].cells[0].column.freeze="frozen-left"===e?"Left":"Right"}for(let d=0,c=this.colDepth;d<c;d++)a=l.render(o[d],s),this.parent.rowHeight&&a.querySelector(".e-headercell")&&(a.style.height=this.parent.rowHeight+"px"),r.appendChild(a);return{thead:r,rows:o}}updateColGroup(e){let t,i=this.parent.getColumns(),s=this.parent.getColumnIndexesInView();if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(i=Object(n.K)([],this.parent.getColumns()),i.splice(0,this.parent.getFrozenColumns())),e.id=this.parent.element.id+"colGroup",this.parent.allowGrouping)for(let r=0,n=this.parent.groupSettings.columns.length;r<n;r++)this.parent.enableColumnVirtualization&&-1===s.indexOf(r)||(t=this.parent.createElement("col",{className:"e-group-intent"}),e.appendChild(t));(this.parent.detailTemplate||this.parent.childGrid)&&(t=this.parent.createElement("col",{className:"e-detail-intent"}),e.appendChild(t)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t));for(let r=0,l=i.length;r<l;r++)t=this.parent.createElement("col"),!1===i[r].visible&&Object(n.ob)(t,{display:"none"}),e.appendChild(t);return this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t)),e}ensureColumns(e){let t=this.parent,i=this.parent.getColumnIndexesInView();for(let s=0,r=e.length;s<r;s++){if(t.allowGrouping)for(let r=0,n=t.groupSettings.columns.length;r<n;r++)this.parent.enableColumnVirtualization&&-1===i.indexOf(r)||e[s].cells.push(this.generateCell({},A.HeaderIndent));if(t.detailTemplate||t.childGrid){let t={};this.parent.notify("detail-indentcell-info",t),e[s].cells.push(this.generateCell(t,A.DetailHeader))}t.isRowDragable()&&e[s].cells.push(this.generateCell({},A.RowDragHIcon))}return e}getHeaderCells(e){let t,i=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),s=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns;if(t=this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&this.parent.contentModule.isXaxis()?"movable":mi(this.parent),this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(let r=0;r<s.length;r++)this.lockColsRendered=!1,e=this.appendCells(s[r],e,0,0===r,!1,r===s.length-1,i,t);for(let r=0,n=s.length;r<n;r++)this.notfrzIdx=0,this.lockColsRendered=!0,e=this.appendCells(s[r],e,0,0===r,!1,r===n-1,i,t);return e}appendCells(e,t,i,s,r,n,l,a){let o,h=n?"e-lastcell":"",d=this.parent.isFrozenGrid(),c=!this.parent.lockcolPositionCount||e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered,p=!this.parent.lockcolPositionCount||e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered,u=this.parent.getContent().querySelector(".e-movablescrollbar");if(d&&u&&this.parent.enableColumnVirtualization&&(o=u.scrollLeft),e.columns){this.isFirstCol=!1;let r=this.getCellCnt(e,0);if(r){let s=this.getStackedLockColsCount(e,0),n=0===this.parent.lockcolPositionCount||!this.lockColsRendered&&0!==s||this.lockColsRendered&&r-s!=0,l=d&&this.ensureStackedFrozen(e.columns,a,!1);(!d&&n||l)&&t[i].cells.push(new q({cellType:A.StackedHeader,column:e,colSpan:this.getColSpan(r,s,e.columns,a,d)}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(let o=0;o<e.columns.length;o++)t=this.appendCells(e.columns[o],t,i+1,s,0===o,o===e.columns.length-1&&n,l,a);if(this.lockColsRendered)for(let o=0,h=e.columns.length;o<h;o++){let r=this.isFirstCol=e.columns[o].visible&&!this.isFirstCol&&1!==h;t=this.appendCells(e.columns[o],t,i+1,s,r,o===h-1&&n,l,a)}}else(o&&o>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&"movable"===e.getFreezeTableName()||!d&&c||d&&e.getFreezeTableName()===a&&p)&&t[i].cells.push(this.generateCell(e,A.Header,this.colDepth-i,(s?"":r?"e-firstcell":"")+h,i,this.parent.getColumnIndexByUid(e.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return t}ensureStackedFrozen(e,t,i){let s=e.length;for(let r=0;r<s;r++)if(e[r].columns)i=this.ensureStackedFrozen(e[r].columns,t,i);else if(e[r].getFreezeTableName()===t){i=!0;break}return i}getStackedLockColsCount(e,t){if(e.columns)for(let i=0;i<e.columns.length;i++)t=this.getStackedLockColsCount(e.columns[i],t);else e.lockColumn&&t++;return t}getColSpan(e,t,i,s,r){return r?e=this.getFrozenColSpan(i,s,0):this.parent.lockcolPositionCount&&(e=this.lockColsRendered?e-t:t),e}getFrozenColSpan(e,t,i){let s=e.length;for(let r=0;r<s;r++)e[r].columns?i=this.getFrozenColSpan(e[r].columns,t,i):e[r].getFreezeTableName()===t&&i++;return i}generateRow(e){return new P({})}generateCell(e,t,i,s,r,l){let a={visible:e.visible,isDataCell:!1,isTemplate:!Object(n.X)(e.headerTemplate),rowID:"",column:e,cellType:t,rowSpan:i,className:s,index:r,colIndex:l};return(!a.rowSpan||a.rowSpan<2)&&delete a.rowSpan,new q(a)}setVisible(e){let t,i,s=this.parent,r=([].slice.call(this.getRows()),s.getFrozenColumns());for(let l=0,a=e.length;l<a;l++){let a=e[l];if(i=s.getNormalizedColumnIndex(a.uid),t=a.visible?"":"none",r){let e=this.parent.isRowDragable()?r+1:r;if(i<e)Object(n.W)()&&s.isServerRendered?(Object(n.ob)(this.getTable().querySelector("colgroup").children[i],{display:t}),Object(n.ob)(this.getTable().querySelectorAll("th")[i],{display:t})):Object(n.ob)(this.getColGroup().children[i],{display:t});else{let l=s.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup"),a=s.getHeaderContent().querySelector(".e-movableheader").querySelector("table");Object(n.ob)(l.children[i-e],{display:t}),Object(n.W)()&&s.isServerRendered&&Object(n.ob)(a.querySelectorAll("th")[i-r],{display:t})}}else Object(n.ob)(this.getColGroup().children[i],{display:t})}this.refreshUI()}colPosRefresh(){Object(n.W)()&&this.parent.isServerRendered&&this.parent.frozenRows&&this.parent.getFrozenColumns()&&(this.freezeReorder=!0),this.refreshUI()}refreshUI(){let e=this.parent.isFrozenGrid(),t=this.parent.enableColumnVirtualization&&e,i=Object(n.W)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows&&e,s=this.getPanel();this.toggleStackClass(s);let r=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.getTable();if(t&&(r=this.parent.contentModule.getVirtualFreezeHeader()),i&&!t&&(r=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.headerPanel.querySelector(".e-frozenheader").querySelector(".e-table")),r){Object(n.W)()&&this.parent.isServerRendered?(r.removeChild(r.querySelector("colgroup")),r.removeChild(r.querySelector("thead"))):(Object(n.hb)(r),r.removeChild(r.firstChild),r.removeChild(r.childNodes[0]));let l=this.parent.createElement("colgroup"),a=this.createHeaderContent();this.rows=a.rows,r.insertBefore(a.thead,r.firstChild),this.updateColGroup(l),r.insertBefore(this.setColGroup(l),r.firstChild),t||i||this.setTable(r),Object(n.W)()&&this.parent.isServerRendered||this.appendContent(r),this.parent.notify("colgroup-refresh",{}),this.widthService.setWidthToColumns(),this.parent.updateDefaultCursor(),(!e||this.parent.enableColumnVirtualization&&e)&&this.initializeHeaderDrag();let o=[].slice.call(s.querySelectorAll("tr.e-columnheader"));for(let e of o){let t=[].slice.call(e.querySelectorAll(".e-grouptopleftcell"));t.length&&t[t.length-1].classList.add("e-lastgrouptopleftcell")}e||this.parent.notify(E,{rows:this.rows,args:{isFrozen:e}}),this.parent.enableColumnVirtualization&&mt(r,"e-movableheader")&&this.parent.notify(E,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&zt(o,!0)}}toggleStackClass(e){this.parent.columns.some(e=>!Object(n.X)(e.columns))?e.classList.add("e-stackedheader"):e.classList.remove("e-stackedheader")}appendContent(e){this.getPanel().querySelector(".e-headercontent").appendChild(e)}getCellCnt(e,t){if(e.columns)for(let i=0,s=e.columns.length;i<s;i++)t=this.getCellCnt(e.columns[i],t);else e.visible&&t++;return t}initializeHeaderDrag(){(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new n.i(this.parent.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}))}initializeHeaderDrop(){new n.j(this.parent.getHeaderContent(),{accept:".e-dragclone",drop:this.drop})}}class _{constructor(e,t){this.localizer=t.getService("localization"),this.formatter=t.getService("valueFormatter"),this.parent=e,this.element=this.parent.createElement("TD",{className:"e-rowcell",attrs:{role:"gridcell",tabindex:"-1"}}),this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox"}})}getGui(){return""}format(e,t,i){return Object(n.X)(e.format)||("number"===e.type&&isNaN(parseInt(t,10))&&(t=null),t=this.formatter.toView(t,e.getFormatter())),Object(n.X)(t)?"":t.toString()}evaluate(e,t,i,s,r,l){let a;if(t.column.template){let o=this.parent.isReact&&"string"!=typeof t.column.template,h=["index"],d=$t({},i,{foreignKeyData:r,column:t.column}),c=this.parent.element.id+t.column.uid,p="isStringTemplate",u="index";if(Object(n.W)()&&l){let e="Batch"!==this.parent.editSettings.mode?parseInt(s[u],10):null;a=t.column.getColumnTemplate()(Object(n.K)({index:s[h[0]]},d),this.parent,"template",c,this.parent[p],e),window[c]=null,"Batch"!==this.parent.editSettings.mode&&Object(n.sb)(c,"Template",t.column,!1)}else if(o){let i={index:s[h[0]]};t.column.getColumnTemplate()(Object(n.K)(i,d),this.parent,"columnTemplate",c,this.parent[p],null,e),this.parent.renderTemplates()}else a=t.column.getColumnTemplate()(Object(n.K)({index:s[h[0]]},d),this.parent,"template",c,this.parent[p]);return o||Ot(e,a),this.parent.notify("template-result",{template:a}),a=null,e.setAttribute("aria-label",e.innerText+" is template cell column header "+t.column.headerText),!1}return!0}invokeFormatter(e,t,i){var s;return Object(n.X)(e.formatter)||(t=(s=e.formatter).prototype&&"getValue"in s.prototype?(new(0,e.formatter)).getValue(e,i):"function"==typeof e.formatter?e.formatter(e,i):e.formatter.getValue(e,i)),t}render(e,t,i,s,r){return this.refreshCell(e,t,i,r)}refreshTD(e,t,i,s){let r="Batch"===this.parent.editSettings.mode&&e.classList.contains("e-editedbatchcell");if(this.parent.isReact){e.innerHTML="";let l=e.cellIndex,a=e.parentElement;Object(n.hb)(e);let o=this.refreshCell(t,i,s,r);this.cloneAttributes(o,e),a.cells.length!==l-1?a.insertBefore(o,a.cells[l]):a.appendChild(o)}else{let n=this.refreshCell(t,i,s,r);e.innerHTML="",e.setAttribute("aria-label",n.getAttribute("aria-label"));let l=[].slice.call(n.childNodes);for(let t of l)e.appendChild(t)}}cloneAttributes(e,t){let i,s=t.attributes,r=s.length;for(;r--;)i=s[r],e.setAttribute(i.name,i.value)}refreshCell(e,t,i,s){let r,l=this.element.cloneNode(),a=e.column;e.isForeignKey&&(r=e.foreignKeyData[0]||{[a.foreignKeyValue]:a.format?null:""});let h=this.getGui(),d=e.isForeignKey?this.getValue(a.foreignKeyValue,r,a):this.getValue(a.field,t,a);if("date"!==a.type&&"datetime"!==a.type||Object(n.X)(d)||(d=new Date(d)),d=this.format(a,d,t),h=d.toString(),"boolean"===a.type&&!a.displayAsCheckBox){let e="true"!==d&&"false"!==d?null:"true"===d?"True":"False";h=e?this.localizer.getConstant(e):h}let c=this.invokeFormatter(a,d,t);if(h=Object(n.X)(a.formatter)?h:Object(n.X)(c)?"":c.toString(),l.setAttribute("aria-label",h+" column header "+e.column.headerText),this.evaluate(l,e,t,i,r,s)&&"checkbox"!==a.type)this.appendHtml(l,h,a.getDomSetter?a.getDomSetter():"innerHTML");else if("checkbox"===a.type){l.classList.add("e-gridchkbox"),l.setAttribute("aria-label","checkbox"),d=!!this.parent.selectionSettings.persistSelection&&"true"===d;let e=Object(o.f)(this.parent.createElement,!1,{checked:d,label:" "});e.insertBefore(this.rowChkBox.cloneNode(),e.firstChild),l.appendChild(e)}if("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0),this.setAttributes(l,e,i),"boolean"===a.type&&a.displayAsCheckBox){let t=isNaN(parseInt(d.toString(),10))?"true"===d:parseInt(d.toString(),10)>0,i=Object(o.f)(this.parent.createElement,!1,{checked:t,label:" "});l.innerHTML="",i.classList.add("e-checkbox-disabled"),l.appendChild(i),l.setAttribute("aria-label",t+" column header "+e.column.headerText)}return l}appendHtml(e,t,i="innerHTML"){return e[i]=t,e}setAttributes(e,t,i){let s=t.column;this.buildAttributeFromCell(e,t,"checkbox"===s.type),ht(e,i),ht(e,t.attributes),s.customAttributes&&ht(e,s.customAttributes),s.textAlign&&(e.style.textAlign=s.textAlign),"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?e.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==s.type&&e.classList.add("e-ellipsistooltip")}buildAttributeFromCell(e,t,i){let s={},r=[];t.colSpan&&(s.colSpan=t.colSpan),t.rowSpan&&(s.rowSpan=t.rowSpan),t.isTemplate&&r.push("e-templatecell"),t.isSelected&&(r.push("e-selectionbackground","e-active"),i&&e.querySelector(".e-frame").classList.add("e-check")),t.isColumnSelected&&r.push("e-columnselection"),Object(n.X)(t.index)||(s["aria-colindex"]=t.index),t.visible||r.push("e-hide"),s.class=r,ht(e,s)}getValue(e,t,i){return i.valueAccessor(e,t,i)}}class Q{setOptions(e,t){let i=Object.keys(t);for(let s=0;s<i.length;s++)J(e,$[i[s]],t[i[s]])}setExpand(e,t){J(e,$.expand,t)}setSort(e,t){J(e,$.sort,t,"boolean"==typeof t)}setBusy(e,t){J(e,$.busy,t),J(e,$.invalid,null,!0)}setGrabbed(e,t,i){J(e,$.grabbed,t,i)}setDropTarget(e,t){J(e,$.dropeffect,"copy",!t)}}function J(e,t,i,s){s&&e?e.removeAttribute(t):e&&e.setAttribute(t,i)}const $={expand:"aria-expanded",role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"};class Z extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-headercell",attrs:{role:"columnheader",tabindex:"-1"}}),this.ariaService=new Q,this.hTxtEle=this.parent.createElement("span",{className:"e-headertext"}),this.sortEle=this.parent.createElement("div",{className:"e-sortfilterdiv e-icons"}),this.gui=this.parent.createElement("div"),this.chkAllBox=this.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox"}})}getGui(){return this.gui.cloneNode()}render(e,t,i){let s=this.element.cloneNode(),r=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,s,r)}refresh(e,t){this.clean(t);let i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,t,i)}clean(e){e.innerHTML=""}prepareHeader(e,t,i){let s,r,l=e.column,a={},h=this.getGui();if(Object(n.x)(h,{"e-mappinguid":l.uid,class:"e-headercelldiv"}),Object(n.X)(l.headerValueAccessor)||(s=this.getValue(l.headerText,l)),"checkbox"!==l.type){let e=l.headerText;Object(n.X)(s)||(e=s);let t=this.hTxtEle.cloneNode();t[l.getDomSetter()]=e,h.appendChild(t)}else{l.editType="booleanedit";let e=Object(o.f)(this.parent.createElement,!1,{checked:!1,label:" "});e.insertBefore(this.chkAllBox.cloneNode(),e.firstChild),h.appendChild(e),h.classList.add("e-headerchkcelldiv")}if(this.buildAttributeFromCell(t,e),this.appendHtml(t,h),t.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&l.allowFiltering&&!Object(n.X)(l.field)&&(!this.parent.showColumnMenu||!l.showColumnMenu)){Object(n.x)(i,{"e-mappinguid":"e-flmenu-"+l.uid}),t.classList.add("e-fltr-icon");let e=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==e.length)for(let t=0;t<this.parent.columns.length;t++)for(let s=0;s<this.parent.filterSettings.columns.length;s++)if(this.parent.filterSettings.columns[s].field===l.field){i.classList.add("e-filtered"),e.push(l.field);break}t.appendChild(i.cloneNode())}e.className&&t.classList.add(e.className),l.customAttributes&&ht(t,l.customAttributes),l.allowSorting&&(a.sort="none"),l.allowGrouping&&(a.grabbed=!1),t=this.extendPrepareHeader(l,t);let d=this.parent,c=d.getColumnIndexByField(l.field);if(!Object(n.X)(l.headerTemplate)){let e=d.element.id+l.uid+"headerTemplate",i="isStringTemplate",s=Object(n.W)()?l.toJSON():l;if(this.parent.isReact&&"string"!=typeof l.headerTemplate){let r={index:c};t.firstElementChild.innerHTML="",l.getHeaderTemplate()(Object(n.K)(r,s),d,"headerTemplate",e,this.parent[i],null,t.firstElementChild),this.parent.renderTemplates()}else r=l.getHeaderTemplate()(Object(n.K)({index:c},s),d,"headerTemplate",e,this.parent[i]),t.firstElementChild.innerHTML="",Ot(t.firstElementChild,r)}if(this.ariaService.setOptions(t,a),!Object(n.X)(l.headerTextAlign)||!Object(n.X)(l.textAlign)){let e=l.headerTextAlign||l.textAlign;h.style.textAlign=e,"Right"===e||"Left"===e?t.classList.add("Right"===e?"e-rightalign":"e-leftalign"):"Center"===e&&t.classList.add("e-centeralign")}return"Clip"===l.clipMode||!l.clipMode&&"Clip"===this.parent.clipMode?t.classList.add("e-gridclip"):("EllipsisWithTooltip"===l.clipMode||!l.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==l.type&&t.classList.add("e-ellipsistooltip"),t.setAttribute("aria-rowspan",(Object(n.X)(e.rowSpan)?1:e.rowSpan).toString()),t.setAttribute("aria-colspan","1"),this.parent.trigger("headerCellInfo",{cell:e,node:t}),t}getValue(e,t){return t.headerValueAccessor(e,t)}extendPrepareHeader(e,t){if(this.parent.showColumnMenu&&e.showColumnMenu&&!Object(n.X)(e.field)){let i=this.parent.createElement("div",{className:"e-icons e-columnmenu"}),s=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==s.length)for(let t=0;t<this.parent.columns.length;t++)for(let r=0;r<this.parent.filterSettings.columns.length;r++)if(this.parent.filterSettings.columns[r].field===e.field){i.classList.add("e-filtered"),s.push(e.field);break}t.classList.add("e-fltr-icon"),t.appendChild(i)}if(this.parent.allowResizing){let i=this.parent.createElement("div");i.className=e.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",t.appendChild(i)}return t}appendHtml(e,t){return e.appendChild(t),e}}class ee extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{role:"columnheader",tabindex:"-1"}})}render(e,t,i){let s=this.element.cloneNode(),r=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":e.column.uid}}),l=e.column;if(s.appendChild(r),Object(n.X)(l.headerTemplate)?this.appendHtml(r,l.headerText,l.getDomSetter()):Ot(r,l.getHeaderTemplate()(l,this.parent,"headerTemplate")),e.column.toolTip&&s.setAttribute("title",e.column.toolTip),"Clip"===l.clipMode||!l.clipMode&&"Clip"===this.parent.clipMode?s.classList.add("e-gridclip"):("EllipsisWithTooltip"===l.clipMode||!l.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&s.classList.add("e-ellipsistooltip"),Object(n.X)(e.column.textAlign)||(r.style.textAlign=e.column.textAlign),e.column.customAttributes&&ht(s,e.column.customAttributes),s.setAttribute("colspan",e.colSpan.toString()),s.setAttribute("aria-colspan",e.colSpan.toString()),s.setAttribute("aria-rowspan","1"),this.parent.allowResizing){let t=this.parent.createElement("div");t.className=e.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",s.appendChild(t)}return this.parent.trigger("headerCellInfo",{cell:e,node:s}),s}}class te extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-indentcell"})}render(e,t){let i=this.element.cloneNode();return ht(i,e.attributes),i}}class ie extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:this.parent.element.id+"captioncell",role:"gridcell",tabindex:"-1"}})}render(e,t){let i,s,r=this.element.cloneNode(),l=this.parent;t.headerText=e.column.headerText,e.isForeignKey&&(s=this.format(e.column,e.column.valueAccessor("foreignKey",t,e.column)));let a=e.isForeignKey?s:e.column.enableGroupByFormat?t.key:this.format(e.column,e.column.valueAccessor("key",t,e.column));if(Object(n.X)(l.groupSettings.captionTemplate))r.innerHTML=l.groupSettings.enableLazyLoading?e.column.headerText+": "+a:e.column.headerText+": "+a+" - "+t.count+" "+this.localizer.getConstant(t.count<2?"Item":"Items");else{let e=this.parent.isReact&&"string"!=typeof l.groupSettings.captionTemplate;if(Object(n.W)()){let e=l.element.id+"captionTemplate";i=ot(l.groupSettings.captionTemplate)(t,null,null,e)}else if(e){let e=l.element.id+"captionTemplate";ot(l.groupSettings.captionTemplate)(t,this.parent,"captionTemplate",e,null,null,r),this.parent.renderTemplates()}else i=this.parent.isVue?ot(l.groupSettings.captionTemplate)(t,this.parent):ot(l.groupSettings.captionTemplate)(t);e||Ot(r,i)}return r.setAttribute("colspan",e.colSpan.toString()),r.setAttribute("aria-label",r.innerHTML+" is groupcaption cell"),r.setAttribute("title",r.innerHTML),r}}class se extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-groupcaption"})}render(e,t){let i=this.element.cloneNode();return i.innerHTML="&nbsp;",i.setAttribute("colspan",e.colSpan.toString()),i}}class re extends te{render(e,t,i,s){let r=this.element.cloneNode();return r.className=s?"e-recordplusexpand":"e-recordpluscollapse",r.setAttribute("ej-mappingname",t.field),r.setAttribute("ej-mappingvalue",t.key),r.setAttribute("aria-expanded",s?"true":"false"),r.setAttribute("tabindex","-1"),r.appendChild(this.parent.createElement("div",{className:s?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"})),r}}class ne extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-grouptopleftcell"})}render(e,t){let i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),i}}class le extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-detailheadercell"})}render(e,t){let i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),i}}class ae extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",role:"gridcell",tabindex:"-1"}})}render(e,t,i){let s=this.element.cloneNode();return i&&!Object(n.X)(i.class)?(s.className="",s.className=i.class,s.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow"}))):s.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonalright e-icon-grightarrow"})),s}}class oe extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-rowdragdrop",attrs:{role:"gridcell",tabindex:"-1"}})}render(e,t){let i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon"})),e.isSelected&&(i.classList.add("e-selectionbackground"),i.classList.add("e-active")),i}}class he extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-rowdragheader"})}render(e,t){let i=this.element.cloneNode();return i.appendChild(Object(n.F)("div",{className:"e-emptycell"})),i}}class de{constructor(e,t){this.emptyGrid=!1,this.counter=0,this.parent=e,this.locator=t,this.data=new B(e,t),this.l10n=t.getService("localization"),this.ariaService=this.locator.getService("ariaService"),this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}render(){let e=this.parent;this.headerRenderer=this.renderer.getRenderer(L.Header),this.contentRenderer=this.renderer.getRenderer(L.Content),this.headerRenderer.renderPanel(),this.contentRenderer.renderPanel(),e.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1)),this.parent.scrollModule.setWidth(),this.parent.scrollModule.setHeight(),"auto"!==this.parent.height&&this.parent.scrollModule.setPadding(),Object(n.W)()&&this.parent.isServerRendered||this.refreshDataManager()}refresh(e={requestType:"refresh"}){let t=this.parent;if(t.notify(e.requestType+"-begin",e),Object(n.W)()&&this.resetTemplates(),Object(n.W)()&&t.isServerRendered){let i="bulkChanges";t[i].dataSource&&delete t[i].dataSource,t.notify("blazor-action-begin",e),"filtering"===e.requestType&&(e.columns=null),"sorting"===e.requestType&&(e.target=null),"Batch"!==t.editSettings.mode||t.isEdit||t.notify("closebatch",{})}let i=this.parent.preventUpdate;t.trigger(f,e,(s={requestType:"refresh"})=>{if("delete"===s.requestType&&Object(n.W)()&&!t.isJsComponent){let e="data";if(Object(n.X)(t.commandDelIndex))s[e]=t.getSelectedRecords();else{let t=s[e];s[e]={},s[e][0]=t}}if(s.cancel)t.notify("cancel-Begin",s);else{if(Object(n.W)()&&"Normal"===t.editSettings.mode&&t.isEdit&&"infiniteScroll"!==e.requestType&&t.notify("closeinline",{}),"delete"===s.requestType&&t.allowPaging){let e=s.data.length,i=t.pageSettings.totalRecordsCount-e,r=t.getCurrentViewRecords().length;r-e||!i||r===e||(t.prevPageMoving=!0,t.setProperties({pageSettings:{totalRecordsCount:i,currentPage:Math.ceil(i/t.pageSettings.pageSize)}},!0),t.pagerModule.pagerObj.totalRecordsCount=i)}if(Object(n.W)()&&this.parent.isServerRendered){if(i)return void(t.bulkChanges={});"refresh"===e.requestType&&this.parent.notify("updateaction",s),"virtualscroll"!==s.requestType&&this.parent.showSpinner(),"delete"===s.requestType||"save"===s.requestType?(this.parent.notify("add-delete-Action",s),this.parent.notify("add-delete-success",s)):(this.parent.allowServerDataBinding=!0,this.parent.serverDataBind(),this.parent.allowServerDataBinding=!1)}else"reorder"===s.requestType&&this.parent.dataSource&&"result"in this.parent.dataSource||("paging"===s.requestType||"columnstate"===s.requestType||"reorder"===s.requestType)&&this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&this.parent.contentModule.getGroupCache()[this.parent.pageSettings.currentPage]?this.contentRenderer.refreshContentRows(s):this.refreshDataManager(s)}})}resetTemplates(){let e=this.parent,t=e.getColumns();if(e.detailTemplate){let t=e.element.id+"detailTemplate";n.z[t]=[],Object(n.jb)(t,"DetailTemplate")}e.groupSettings.captionTemplate&&Object(n.jb)(e.element.id+"captionTemplate","CaptionTemplate"),e.rowTemplate&&Object(n.jb)(e.element.id+"rowTemplate","RowTemplate"),e.toolbarTemplate&&Object(n.jb)(e.element.id+"toolbarTemplate","ToolbarTemplate"),e.pageSettings.template&&Object(n.jb)(e.element.id+"_template","pageSettings");for(let i=0;i<t.length;i++)t[i].template&&(n.z[e.element.id+t[i].uid]=[],Object(n.jb)(e.element.id+t[i].uid,"Template")),t[i].headerTemplate&&Object(n.jb)(e.element.id+t[i].uid+"headerTemplate","HeaderTemplate"),t[i].filterTemplate&&Object(n.jb)(e.element.id+t[i].uid+"filterTemplate","FilterTemplate");for(let i=0;i<e.aggregates.length;i++)for(let t=0;t<e.aggregates[i].columns.length;t++){if(e.aggregates[i].columns[t].footerTemplate){let s=e.element.id+e.aggregates[i].columns[t].guid+"footerTemplate";Object(n.jb)(s,"FooterTemplate")}if(e.aggregates[i].columns[t].groupFooterTemplate){let s=e.element.id+e.aggregates[i].columns[t].guid+"groupFooterTemplate";Object(n.jb)(s,"GroupFooterTemplate")}if(e.aggregates[i].columns[t].groupCaptionTemplate){let s=e.element.id+e.aggregates[i].columns[t].guid+"groupCaptionTemplate";Object(n.jb)(s,"GroupCaptionTemplate")}}}refreshComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(y,e)}refreshDataManager(e={}){let t;"virtualscroll"!==e.requestType&&this.parent.showSpinner(),this.parent.notify("reset-infinite-blocks",e),this.emptyGrid=!1;let i=this.isNeedForeignAction();if(this.ariaService.setBusy(this.parent.getContent().querySelector(".e-content"),!0),i){let i=new l.c;t=this.getFData(i,e)}if(t=t?t.then(t=>{let i=this.data.generateQuery().requiresCount();if(this.emptyGrid){let e=new l.c;return e.resolve({result:[],count:0}),e.promise}return this.data.getData(e,i)}):this.data.getData(e,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!i||this.parent.searchSettings.key.length)){let i=new l.c;t=t.then(s=>(this.parent.notify("getForeignKeyData",{dataManager:t,result:s,promise:i,action:e}),i.promise))}this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(t=t.then(e=>this.validateGroupRecords(e))),t.then(t=>this.dataManagerSuccess(t,e)).catch(t=>this.dataManagerFailure(t,e))}getFData(e,t){return this.parent.notify("getForeignKeyData",{isComplex:!0,promise:e,action:t}),e.promise}isNeedForeignAction(){let e=this.parent;return!!(e.allowFiltering&&e.filterSettings.columns.length||e.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())}foreignKey(e){return e.some(e=>{let t=!1;return t=this.parent.filterSettings.columns.some(t=>e.uid===t.uid),!(!t&&!this.parent.searchSettings.key.length)})}sendBulkRequest(e){e.requestType="batchsave";let t=this.data.saveChanges(e.changes,this.parent.getPrimaryKeyFieldNames()[0],e.original);if(Object(n.W)()&&!this.parent.isJsComponent)t.then(t=>{this.parent.notify("editsuccess",e)}).catch(e=>{Object(n.X)(e.error)||Object(n.X)(e.error.message)||(e.error=e.error.message),this.parent.trigger("actionFailure",e)});else{let i=this.data.generateQuery().requiresCount();if(this.data.dataManager.dataSource.offline)return void this.refreshDataManager({requestType:"batchsave"});t.then(t=>{this.data.getData(e,i).then(t=>this.dmSuccess(t,e)).catch(t=>this.dmFailure(t,e))}).catch(t=>this.dmFailure(t,e))}}dmSuccess(e,t){this.dataManagerSuccess(e,t)}dmFailure(e,t){this.dataManagerFailure(e,t)}renderEmptyRow(){this.emptyRow(!0)}emptyRow(e){let t,i=this.parent,s=this.contentRenderer.getTable().querySelector("tbody");Object(n.X)(s)||Object(n.hb)(s),s=this.parent.createElement("tbody");let r=0;(i.detailTemplate||i.childGrid)&&++r,t=this.parent.createElement("tr",{className:"e-emptyrow"}),t.appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(i.getColumns().length+r).toString()}})),s.appendChild(t),this.contentRenderer.renderEmpty(s),e&&(this.parent.trigger(C,{}),this.parent.notify(j,{rows:[new P({isDataRow:!0,cells:[new q({isDataCell:!0,visible:!0})]})]}))}dynamicColumnChange(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])}updateColumnType(e){let t,i=this.parent.getColumns(),s=e&&e.items?e.items[0]:e,r=this.locator.getService("valueFormatter");for(let l=0,a=i.length;l<a;l++){t=_t(i[l].field||"",s),Object(n.X)(i[l].customFormat)||(i[l].format=i[l].customFormat),Object(n.X)(i[l].validationRules)||Object(n.X)(i[l].validationRules.equalTo)||(i[l].validationRules.equalTo[0]=this.parent.element.id+i[l].validationRules.equalTo[0]),i[l].isForeignColumn()&&i[l].columnData&&(t=_t(i[l].foreignKeyValue||"",i[l].columnData[0])),Object(n.X)(t)?i[l].type=i[l].type||(Object(n.W)()&&this.parent.isServerRendered?"none":null):(this.isColTypeDef=!0,(!i[l].type||Object(n.W)()&&this.parent.isServerRendered&&"none"===i[l].type)&&(i[l].type=t.getDay?t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0?"datetime":"date":typeof t));let e=new m;if(i[l].format&&(i[l].format.skeleton||i[l].format.format)&&(i[l].setFormatter(e.getFormatFunction(Object(n.K)({},i[l].format))),i[l].setParser(e.getParserFunction(i[l].format))),"string"==typeof i[l].format){let e=this.parent.isServerRendered||this.parent.printModule.isPrintGrid();At(this.locator,i[l],e)}else i[l].format||"number"!==i[l].type||i[l].setParser(r.getParserFunction({format:"n2"}))}}dataManagerSuccess(e,t){let i=this.parent;this.contentRenderer=this.renderer.getRenderer(L.Content),this.headerRenderer=this.renderer.getRenderer(L.Header),e.actionArgs=t;let s=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&("delete"===t.requestType||"save"===t.requestType&&"add"===this.parent.infiniteScrollModule.requestType);i.trigger("beforeDataBound",e,r=>{if(r.cancel)return;r.result=Object(n.X)(r.result)?[]:r.result;let l=Object.keys(r.result).length;if(!this.parent.isDestroyed)if(i.getColumns().length||l||i.columns.length&&i.columns[0]instanceof b)if(!this.isInfiniteEnd(t)||l){if(this.parent.isEdit=!1,this.parent.notify("edit-reset",{}),this.parent.notify("tooltip-destroy",{}),this.contentRenderer.prevCurrentView=this.parent.currentViewData.slice(),i.currentViewData=r.result,i.notify("refresh-infinite-current-view-data",{args:t,data:r.result}),Object(n.W)()&&"FilterBar"===i.filterSettings.type&&(Object(n.X)(i.currentViewData)||!Object(n.X)(i.currentViewData)&&!i.currentViewData.length)){let e=i.getColumns();for(let t=0;t<e.length;t++)if(e[t].filterTemplate){let s=i.element.id+e[t].uid+"filterTemplate";Object(n.jb)(s,"FilterTemplate");let r=e[t].field,l=i.filterSettings.columns;for(let e=0;e<l.length;e++)r===l[e].field&&(n.z[s][0][r]=l[e].value);Object(n.sb)(s,"FilterTemplate",e[t],!1)}}if(!l&&r.count&&i.allowPaging&&t&&"delete"!==t.requestType)return!this.parent.groupSettings.enableLazyLoading||"grouping"!==t.requestType&&"ungrouping"!==t.requestType||this.parent.notify("grouping-complete",t),i.prevPageMoving=!0,i.pageSettings.totalRecordsCount=r.count,"paging"!==t.requestType&&(i.pageSettings.currentPage=Math.ceil(r.count/i.pageSettings.pageSize)),void i.dataBind();if((i.getColumns().length||!l)&&this.isLayoutRendered||Yt(i)||this.updatesOnInitialRender(r),!this.isColTypeDef&&i.getCurrentViewRecords()&&this.updateColumnType(this.data.dataManager.dataSource.offline&&i.dataSource.length?i.dataSource[0]:i.getCurrentViewRecords()[0]),this.parent.isInitialLoad||!this.parent.groupSettings.disablePageWiseAggregates||this.parent.groupSettings.columns.length||(r.result=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData),this.parent.notify(S,Object(n.K)({count:r.count,result:r.result,aggregates:r.aggregates},t)),(i.groupSettings.columns.length||t&&"ungrouping"===t.requestType)&&t&&"filtering"!==t.requestType&&this.headerRenderer.refreshUI(),l)Yt(i)&&(t.scrollTop={top:this.contentRenderer.content.scrollTop}),s?this.parent.notify("infinite-edit-handler",{e:t,result:e.result,count:e.count,agg:e.aggregates}):this.parent.enableImmutableMode?this.contentRenderer.immutableModeRendering(t):this.contentRenderer.refreshContentRows(t);else{if(!i.getColumns().length)return i.element.innerHTML="",void alert(this.l10n.getConstant("EmptyDataSourceError"));if(this.contentRenderer.setRowElements([]),this.contentRenderer.setRowObjects([]),this.ariaService.setBusy(this.parent.getContent().querySelector(".e-content"),!1),this.renderEmptyRow(),t){let e=(t.requestType||"").toLowerCase()+"-complete";this.parent.notify(e,t),"batchsave"===t.requestType&&(t.cancel=!1,t.rows=[],t.isFrozen=0!==this.parent.getFrozenColumns()&&!t.isFrozen,this.parent.trigger(y,t))}this.parent.hideSpinner()}this.parent.notify(T,{}),this.setRowCount(this.parent.getCurrentViewRecords().length),this.parent.getDataModule().isQueryInvokedFromData=!1}else this.parent.notify("infinite-edit-handler",{e:t,result:e.result,count:e.count,agg:e.aggregates});else i.hideSpinner()})}dataManagerFailure(e,t){this.ariaService.setOptions(this.parent.getContent().querySelector(".e-content"),{busy:!1,invalid:!0}),this.setRowCount(1),this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.log("actionfailure",{error:e}))}setRowCount(e){this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:e?e.toString():"1"})}isInfiniteEnd(e){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===e.requestType}updatesOnInitialRender(e){this.isLayoutRendered=!0,this.parent.columns.length<1&&this.buildColumns(e.result[0]),pt(this.parent.columns,null,this.parent),this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.parent.isAutoGen=!0,this.parent.notify(k,{})}iterateComplexColumns(e,t,i){let s=Object.keys(e);for(let r=0;r<s.length;r++)("object"!=typeof e[s[r]]||!e[s[r]]||e[s[r]]instanceof Date?[]:Object.keys(e[s[r]])).length?this.iterateComplexColumns(e[s[r]],t+(s[r]+"."),i):(i[this.counter]=t+s[r],this.counter++)}buildColumns(e){let t=[],i={};this.iterateComplexColumns(e,"",i);let s=Object.keys(i).filter(e=>"BlazId"!==i[e]).map(e=>i[e]);for(let r=0,l=s.length;r<l;r++)t[r]={field:s[r]},this.parent.enableColumnVirtualization&&(t[r].width=Object(n.X)(t[r].width)?200:t[r].width);this.parent.setProperties({columns:t},!0)}instantiateRenderer(){this.renderer.addRenderer(L.Header,new Y(this.parent,this.locator)),this.renderer.addRenderer(L.Content,new U(this.parent,this.locator));let e=this.locator.getService("cellRendererFactory");e.addCellRenderer(A.Header,new Z(this.parent,this.locator)),e.addCellRenderer(A.Data,new _(this.parent,this.locator)),e.addCellRenderer(A.StackedHeader,new ee(this.parent,this.locator)),e.addCellRenderer(A.Indent,new te(this.parent,this.locator)),e.addCellRenderer(A.GroupCaption,new ie(this.parent,this.locator)),e.addCellRenderer(A.GroupCaptionEmpty,new se(this.parent,this.locator)),e.addCellRenderer(A.Expand,new re(this.parent,this.locator)),e.addCellRenderer(A.HeaderIndent,new ne(this.parent,this.locator)),e.addCellRenderer(A.StackedHeader,new ee(this.parent,this.locator)),e.addCellRenderer(A.DetailHeader,new le(this.parent,this.locator)),e.addCellRenderer(A.RowDragHIcon,new he(this.parent,this.locator)),e.addCellRenderer(A.DetailExpand,new ae(this.parent,this.locator)),e.addCellRenderer(A.DetailFooterIntent,new te(this.parent,this.locator)),e.addCellRenderer(A.RowDragIcon,new oe(this.parent,this.locator))}addEventListener(){this.parent.isDestroyed||(this.parent.on(v,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(D,this.refresh,this),this.parent.on("refresh-complete",this.refreshComplete,this),this.parent.on("bulk-save",this.sendBulkRequest,this),this.parent.on("showEmptyGrid",()=>{this.emptyGrid=!0},this),this.parent.on(k,this.dynamicColumnChange,this))}validateGroupRecords(e){let t=e.result.length-1;if(t<0)return Promise.resolve(e);let i=e.result[0],s=e.result[t],r=[],a=e=>{let t=[i,s];for(let i=0;i<t.length;i++)r.push(new l.f("field","==",t[i].field).and(this.getPredicate("key","equal",t[i].key)));e.where(l.f.or(r))},o=new l.g;a(o);let h=new l.a(e.result).executeLocal(o),d=this.data.generateQuery(!0),c=[];if(this.data.isRemote()||Object(n.W)()){let e=[i,s];for(let t=0;t<e.length;t++)c.push(this.getPredicate(e[t].field,"equal",e[t].key));d.where(l.f.or(c))}else a(d);let p=new l.c;return this.data.getData({},d).then(t=>{this.updateGroupInfo(h,t.result),p.resolve(e)}).catch(e=>p.reject(e)),p.promise}getPredicate(e,t,i){return i instanceof Date?Kt({field:e,operator:t,value:i}):new l.f(e,t,i)}updateGroupInfo(e,t){let i=new l.a(t),s=e;for(let r=0;r<s.length;r++){let e=i.executeLocal((new l.g).where(new l.f("field","==",s[r].field).and(this.getPredicate("key","equal",s[r].key))))[0];s[r].count=e.count;let t=s[r].items,n=e.items;t.GroupGuid&&(s[r].items=this.updateGroupInfo(s[r].items,e.items));let a=this.parent.aggregates;for(let i=0;i<a.length;i++){let o=a[i];for(let i=0;i<o.columns.length;i++){let a=o.columns[i].type instanceof Array?o.columns[i].type:[o.columns[i].type];for(let h=0;h<a.length;h++){let d=o.columns[i].field+" - "+a[h].toLowerCase(),c=t.level?n.records:e.items,p=this.parent;if("Custom"===a[h]){let l=t.level?n:e;s[r].aggregates[d]=o.columns[i].customAggregate?o.columns[i].customAggregate.call(p,l,o.columns[i]):""}else s[r].aggregates[d]=l.b.aggregates[a[h].toLowerCase()](c,o.columns[i].field)}}}}return e}}class ce{constructor(){this.cellRenderMap={}}addCellRenderer(e,t){e="string"==typeof e?e:Object(n.P)(A,e),Object(n.X)(this.cellRenderMap[e])&&(this.cellRenderMap[e]=t)}getCellRenderer(e){if(e="string"==typeof e?e:Object(n.P)(A,e),Object(n.X)(this.cellRenderMap[e]))throw`The cellRenderer ${e} is not found`;return this.cellRenderMap[e]}}class pe{constructor(){this.services={}}register(e,t){Object(n.X)(this.services[e])&&(this.services[e]=t)}getService(e){if(Object(n.X)(this.services[e]))throw`The service ${e} is not registered`;return this.services[e]}}class ue{constructor(){this.rendererMap={}}addRenderer(e,t){let i=Object(n.P)(L,e);Object(n.X)(this.rendererMap[i])&&(this.rendererMap[i]=t)}getRenderer(e){let t=Object(n.P)(L,e);if(Object(n.X)(this.rendererMap[t]))throw`The renderer ${t} is not found`;return this.rendererMap[t]}}class ge{constructor(e){this.parent=e}setWidthToColumns(){let e=0,t=this.parent.getColumnIndexesInView(),i=!0,s=0;if(this.parent.allowGrouping)for(let n=this.parent.groupSettings.columns.length;e<n;e++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e)?i=!1:this.setColumnWidth(new b({width:"30px"}),e);(this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new b({width:"30px"}),e),e++),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(this.setColumnWidth(new b({width:"30px"}),e),e++);let r=this.parent.getColumns();for(let n=0;n<r.length;n++)this.setColumnWidth(r[n],i&&this.parent.enableColumnVirtualization?void 0:n+e);this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&this.setColumnWidth(new b({width:"30px"}),r.length),s=this.getTableWidth(this.parent.getColumns()),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(s)}setMinwidthBycalculation(e){let t=0,i=this.parent.getColumns().filter(e=>Object(n.X)(e.width)||"auto"===e.width);if(i.length){t=Object(n.X)(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-e:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-e;let s=0;for(let e of i)s+=Object(n.X)(e.minWidth)?0:"string"==typeof e.minWidth?parseInt(e.minWidth,10):e.minWidth;for(let r=0;r<i.length;r++)0===e&&this.parent.allowResizing&&this.isWidthUndefined()&&r!==i.length-1&&this.setUndefinedColumnWidth(i),0!==e&&t<s?this.setWidth(i[r].minWidth,this.parent.getColumnIndexByField(i[r].field)):0!==e&&t>s&&this.setWidth("",this.parent.getColumnIndexByField(i[r].field)+this.parent.getIndentCount(),!0)}}setUndefinedColumnWidth(e){for(let t=0;t<e.length;t++)t!==e.length-1&&(e[t].width=200,this.setWidth(200,this.parent.getColumnIndexByField(e[t].field)))}setColumnWidth(e,t,i){if(this.parent.getColumns().length<1)return;let s=Object(n.X)(t)?this.parent.getNormalizedColumnIndex(e.uid):t,r=this.getWidth(e),l=this.getTableWidth(this.parent.getColumns());null!==r&&(this.setWidth(r,s),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(l),(this.parent.allowResizing&&"resize"===i||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify("column-width-changed",{index:s,width:r,column:e,module:i}))}setWidth(e,t,i){this.parent.groupSettings.columns.length>t&&di(this.parent)&&(e=(30/this.parent.element.offsetWidth*100).toFixed(1)+"%");let s,r=this.parent.getHeaderTable(),l=this.parent.getContentTable(),a=Object(n.L)(e),o=this.parent.getFrozenColumns(),h=this.parent.isRowDragable();o=o&&h?o+1:o;let d,c=this.parent.getHeaderContent().querySelector(".e-movableheader"),p=this.parent.getContent().querySelector(".e-movablecontent"),u=this.parent.getFrozenLeftColumnsCount(),g=this.parent.getFrozenRightColumnsCount(),m=this.parent.getMovableColumnsCount(),b=0!==u||0!==g;if(o&&t>=o&&c&&c.querySelector("colgroup"))s=c.querySelector("colgroup").children[t-o];else if(this.parent.enableColumnVirtualization&&o&&this.parent.contentModule.isXaxis()&&c.scrollLeft>0){let e=c.querySelector("colgroup");s=e.children[e.children.length-1-t]}else if(b){let e;if(u&&!g)e=(t=h?t-1:t)<u?r:c;else if(!u&&g)e=t>=m?r:c;else if(u&&g){t=h?t-1:t;let i=this.parent.getFrozenRightHeader();e=t<u?r:t<u+m?c:i}if(s=this.getColumnLevelFrozenColgroup(t,u,m,e),!s)return}else s=r.querySelector("colgroup").children[t];if(s&&!i?s.style.width=a:s&&i&&(s.style.width=""),o&&t>=o)d=this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup").children[t-o];else if(this.parent.enableColumnVirtualization&&o&&this.parent.contentModule.isXaxis()&&p.scrollLeft>0){let e=this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup");d=e.children[e.children.length-1-t]}else if(b){let e;if(u&&!g&&(e=t<u?l:p),!u&&g&&(e=t>=m?l:p),u&&g){let i=this.parent.getContent().querySelector(".e-frozen-right-content");e=t<u?l:t<u+m?p:i}d=this.getColumnLevelFrozenColgroup(t,u,m,e)}else d=l.querySelector("colgroup").children[t];d&&!i?d.style.width=a:d&&i&&(d.style.width="");let f=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),y=[];for(let n=0;n<f.length;n++)if(mt(f[n],"e-grid").id===this.parent.element.id)for(let e=0;e<f[n].querySelector("colgroup").children.length;e++)y.push(f[n].querySelector("colgroup").children[e]);f.length&&y.length&&(y[t].style.width=a),this.parent.isFrozenGrid()&&this.refreshFrozenScrollbar()}getColumnLevelFrozenColgroup(e,t,i,s){if(!s||!s.querySelector("colgroup"))return null;let r,n=this.parent.getColumns(),l=this.parent.isRowDragable(),a=this.parent.getFrozenMode(),o=[].slice.call(s.querySelector("colgroup").children);return r="Right"===a&&l&&e===i+this.parent.getFrozenRightColumnsCount()?o[o.length-1]:l&&-1===e?o[0]:"Left"===n[e].freeze?o[l?e+1:e]:"Right"===n[e].freeze?o[e-(t+i)]:o[e-t],r}refreshFrozenScrollbar(){let e={cancel:!1};if(this.parent.notify("prevent-frozen-scroll-refresh",e),e.cancel)return;let t=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("table"),i=this.parent.getContent().querySelector(".e-movablecontent").querySelector("table"),s=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");if(i&&t){let e=this.parent.getContent().querySelector(".e-frozenscrollbar"),r=this.parent.getContent().querySelector(".e-movablescrollbar"),n=this.parent.getContent().querySelector(".e-frozen-right-scrollbar"),l=this.parent.getContent().querySelector(".e-movablechild"),a=this.parent.getContent(),o=Et(),h=t.offsetWidth,d=i.offsetWidth;if(this.parent.enableColumnVirtualization){let e=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack");e&&(d=e.scrollWidth)}e.style.width=h.toString()+"px";let c=this.parent.getContent().querySelector(".e-movablecontent").offsetWidth;if(s){let e=s.offsetWidth;a.firstChild.scrollHeight>a.firstChild.clientHeight&&(e=s.offsetWidth+o),n.style.width=e.toString()+"px",c-=e}"auto"!==this.parent.height&&("Left"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())&&a.firstChild.scrollHeight>=a.firstChild.clientHeight&&(d+=o),r.style.width=c.toString()+"px",l.style.width=d.toString()+"px"}}getSiblingsHeight(e){return this.getHeightFromDirection(e,"previous")+this.getHeightFromDirection(e,"next")}getHeightFromDirection(e,t){let i=e[t+"ElementSibling"],s=0,r=["e-gridheader","e-gridfooter","e-groupdroparea","e-gridpager","e-toolbar"];for(;i;)r.some(e=>i.classList.contains(e))&&(s+=i.offsetHeight),i=i[t+"ElementSibling"];return s}isWidthUndefined(){let e=this.parent.getColumns().filter(e=>Object(n.X)(e.width)&&Object(n.X)(e.minWidth)).length;return this.parent.getColumns().length===e}getWidth(e){if(Object(n.X)(e.width)&&this.parent.allowResizing&&Object(n.X)(e.minWidth)&&!this.isWidthUndefined()&&(e.width=200),this.parent.isFrozenGrid()&&Object(n.X)(e.width)&&("frozen-left"===e.getFreezeTableName()||"frozen-right"===e.getFreezeTableName())&&(e.width=200),!e.width)return null;let t=parseInt(e.width.toString(),10);return e.minWidth&&t<parseInt(e.minWidth.toString(),10)?e.minWidth:e.maxWidth&&t>parseInt(e.maxWidth.toString(),10)?e.maxWidth:e.width}getTableWidth(e){let t=0;for(let i of e){let e=this.getWidth(i);"auto"===i.width&&(e=0),!1!==i.visible&&null!==e&&(t+=parseInt(e.toString(),10))}return t}calcMovableOrFreezeColWidth(e){let t=this.parent.getColumns().slice(),i=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),s=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenRightColumnsCount();return"movable"===e?(r&&t.splice(i+s,t.length),i&&t.splice(0,i)):"freeze-left"===e?t.splice(i,t.length):"freeze-right"===e&&t.splice(0,i+s),Object(n.L)(this.getTableWidth(t))}setWidthToFrozenRightTable(){let e=this.calcMovableOrFreezeColWidth("freeze-right");e=this.isAutoResize()?"100%":e;let t=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(".e-table"),i=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table");t.style.width=e,i.style.width=e}setWidthToFrozenLeftTable(){let e=this.calcMovableOrFreezeColWidth("freeze-left");e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e}setWidthToMovableTable(){let e="",t=this.parent.getColumns().filter(e=>Object(n.X)(e.width)).length>=1,i=this.parent.getColumns().filter(e=>"auto"===e.width).length>=1;"number"!=typeof this.parent.width||t||i?t||i||(e=this.calcMovableOrFreezeColWidth("movable")):e=Object(n.L)(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5),e=this.isAutoResize()?"100%":e,this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild&&(this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild.style.width=e),this.parent.getContent().querySelector(".e-movablecontent").firstElementChild.style.width=e}setWidthToFrozenEditTable(){let e=this.calcMovableOrFreezeColWidth("freeze");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=e}setWidthToMovableEditTable(){let e=this.calcMovableOrFreezeColWidth("movable");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=e}setWidthToTable(){let e=Object(n.L)(this.getTableWidth(this.parent.getColumns()));this.parent.isFrozenGrid()?((this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&this.setWidthToFrozenLeftTable(),this.setWidthToMovableTable(),this.parent.getFrozenRightColumnsCount()&&this.setWidthToFrozenRightTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new b({width:"30px"})),e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e);let t=this.parent.element.querySelector(".e-table.e-inline-edit");t&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):t&&(t.style.width=e)}isAutoResize(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode}}class me{constructor(e){this.currentInfo={},this.oneTime=!0,this.swap={},this.forget=!1,this.skipFocus=!0,this.focusByClick=!1,this.prevIndexes={},this.refMatrix=this.refreshMatrix(!0),this.actions=["downArrow","upArrow"],this.parent=e,this.rowModelGen=new N(this.parent),this.addEventListener()}focusCheck(e){let t=e.target;this.focusByClick=!0,this.skipFocus=t.classList.contains("e-grid")}onFocus(){if(this.parent.isDestroyed||n.d.isDevice||this.parent.enableVirtualization)return;this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,this.parent.isFrozenGrid()),this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||this.parent.editModule.getBatchChanges().addedRecords.length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new P({isDataRow:!0})]}),this.getContent().selector,!1);let e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.skipFocus&&(this.focus(),this.skipFocus=!1)}passiveFocus(e){this.parent.isDestroyed||e.target&&e.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,Object(n.v)([this.currentInfo.element],["e-focused","e-focus"]))}onBlur(e){this.parent.isEdit||e&&(!e.relatedTarget||Object(n.C)(e.relatedTarget,".e-grid"))||(this.removeFocus(),this.skipFocus=!1,this.currentInfo.skipAction=!1,this.getContent().getFocusInfo().elementToFocus&&(this.getContent().getFocusInfo().elementToFocus.tabIndex=0))}onClick(e,t){if(mt(e.target,"e-filterbarcell")&&e.target.classList.contains("e-input-group-icon"))return;let i=!Object(n.X)(Object(n.C)(e.target,".e-gridcontent")),s=!Object(n.X)(Object(n.C)(e.target,".e-gridheader"));i=i&&s?!i:i;let r=!Object(n.X)(Object(n.C)(e.target,".e-frozencontent"))||!Object(n.X)(Object(n.C)(e.target,".e-frozenheader")),l=!1;if("Left-Right"===this.parent.getFrozenMode()&&(l=!Object(n.X)(Object(n.C)(e.target,".e-frozen-right-content"))||!Object(n.X)(Object(n.C)(e.target,".e-frozen-right-header")),r=r&&!l),!i&&Object(n.X)(Object(n.C)(e.target,".e-gridheader"))||e.target.classList.contains("e-content")||!Object(n.X)(Object(n.C)(e.target,".e-unboundcell")))return;if(this.setActive(i,r,l),!i&&Object(n.X)(Object(n.C)(e.target,".e-gridheader")))return void this.clearOutline();let a={cancel:!1,byKey:!1,byClick:!Object(n.X)(e.target),clickArgs:e};if(this.parent.notify("beforecellfocused",a),!a.cancel&&!Object(n.C)(e.target,".e-inline-edit")&&(this.setActive(i,r,l),this.getContent())){if(!1===this.getContent().onClick(e,t))return;this.focus()}}onKeyPress(e){if(this.skipOn(e))return;this.activeKey=e.action;let t={cancel:!1,byKey:!0,byClick:!1,keyArgs:e};if(this.parent.notify("beforecellfocused",t),t.cancel)return;let i=this.getContent().matrix.current;this.currentInfo.outline=!0;let s=this.getContent().jump(e.action,i);this.swap=s,s.swap&&(this.setActive(!s.toHeader,s.toFrozen,s.toFrozenRight),this.getContent().matrix.current=this.getContent().getNextCurrent(i,s,this.active,e.action),this.prevIndexes={}),this.setActiveByKey(e.action,this.getContent()),!1!==this.getContent().onKeyPress(e)?(e.preventDefault(),this.focus(e)):this.clearIndicator()}skipOn(e){let t=e.target;if(!t)return!1;if(this.currentInfo.skipAction)return this.clearIndicator(),!0;if(["pageUp","pageDown","altDownArrow"].indexOf(e.action)>-1)return this.clearIndicator(),!0;let i=Object(n.C)(t,"th")&&!Object(n.C)(t,"th").tabIndex;!e.target.classList.contains("e-filterbaroperator")||13!==e.keyCode&&27!==e.keyCode||Object(n.C)(e.target,".e-filterbarcell").querySelector("input").focus(),i&&null!==Object(n.C)(document.activeElement,".e-filterbarcell")&&this.removeFocus();let s=null!==Object(n.C)(document.activeElement,".e-filterbarcell");if(this.parent.enableHeaderFocus&&s){let e=this.active.matrix,t=e.current;s=e.matrix[t[0]].lastIndexOf(1)!==t[1]}return"delete"===e.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(e.action)>-1)||s||null!==Object(n.C)(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(e.action)>-1||null===Object(n.C)(t,".e-gridcontent")&&null===Object(n.C)(t,".e-gridheader")||"space"===e.action&&!t.classList.contains("e-gridchkbox")&&null===Object(n.C)(t,".e-gridchkbox")&&null===Object(n.C)(t,".e-headerchkcelldiv")||null!==Object(n.C)(t,".e-filter-popup")}focusVirtualElement(e){if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){let t={virtualData:{},isAdd:!1,isCancel:!1};this.parent.notify("get-virtual-data",t);let i=this.actions.some(e=>e===this.activeKey),s=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1;t.isAdd||Object.keys(t.virtualData).length||i||t.isCancel||s?(t.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,i&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",e)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.currentInfo.elementToFocus.focus()}}getFocusedElement(){return this.currentInfo.elementToFocus}getContent(){return this.active||this.content}setActive(e,t,i){this.active=e?t?this.fContent:i?this.frContent:this.content:t?this.fHeader:i?this.frHeader:this.header}setFocusedElement(e,t){this.currentInfo.elementToFocus=e,setTimeout(()=>{Object(n.X)(this.currentInfo.elementToFocus)||(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling?this.focusVirtualElement(t):this.currentInfo.elementToFocus.focus())},0)}focus(e){this.parent.notify("virtaul-cell-focus",e),this.removeFocus(),this.addFocus(this.getContent().getFocusInfo(),e)}removeFocus(e){this.currentInfo.element&&(Object(n.ib)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)}addOutline(){let e=this.getContent().getFocusInfo();e.element&&(Object(n.v)([e.element],["e-focused"]),Object(n.v)([e.elementToFocus],["e-focus"]))}focusHeader(){this.setActive(!1,this.parent.isFrozenGrid()),this.resetFocus()}focusContent(){this.setActive(!0,this.parent.isFrozenGrid()),this.resetFocus()}resetFocus(){let e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.focus()}addFocus(e,t){if(this.currentInfo=e,this.currentInfo.outline=e.outline&&!Object(n.X)(t),!e.element)return;let i=e.elementToFocus.classList.contains("e-focus");if(i)return;this.currentInfo.outline&&Object(n.v)([e.element],["e-focused"]),Object(n.v)([e.elementToFocus],["e-focus"]),e.element.tabIndex=0,i||this.setFocusedElement(e.elementToFocus,t),this.parent.notify("cellfocused",{element:e.elementToFocus,parent:e.element,indexes:this.getContent().matrix.current,byKey:!Object(n.X)(t),byClick:Object(n.X)(t),keyArgs:t,isJump:this.swap.swap,container:this.getContent().getInfo(t),outline:!Object(n.X)(t),swapInfo:this.swap});let[s,r]=this.getContent().matrix.current;this.prevIndexes={rowIndex:s,cellIndex:r},this.focusedColumnUid=this.parent.getColumnByIndex(r).uid,this.focusByClick=!1}refreshMatrix(e){return t=>{e&&t.args&&t.args.isFrozen&&!this.fContent?this.fContent=new Ce(this.parent):e&&!this.frContent&&t.args&&t.args.renderFrozenRightContent?this.frContent=new Se(this.parent):e&&!this.content&&(this.content=new fe(this.parent)),!e&&t.args&&t.args.isFrozen&&!this.fHeader?this.fHeader=new ve(this.parent):!e&&t.args&&t.args.renderFrozenRightContent&&!this.frHeader?this.frHeader=new Oe(this.parent):e||this.header||(this.header=new ye(this.parent));let i=e?t.args&&t.args.isFrozen?this.fContent:t.args&&t.args.renderFrozenRightContent?this.frContent:this.content:t.args&&t.args.isFrozen?this.fHeader:t.args&&t.args.renderFrozenRightContent?this.frHeader:this.header,s=e?t.rows.slice(this.parent.frozenRows):t.rows,r=e?t.rows.slice(0,this.parent.frozenRows):t.rows;this.parent.isCollapseStateEnabled()&&e&&(s=s.filter(e=>!1!==e.visible));let l=!Object(n.X)(this.parent.rowTemplate),a=i.matrix.generate(r,i.selector,l);if("batchAdd"===t.name&&this.parent.isFrozenGrid()){let e=this.parent.getMovableRowsObject().map(e=>e.clone()),t=s.map(e=>e.clone());if(this.fContent.matrix.generate(t,this.fContent.selector,l),this.content.matrix.generate(e,this.content.selector,l),"Left-Right"===this.parent.getFrozenMode()){let e=this.parent.getFrozenRightRowsObject().map(e=>e.clone());this.frContent.matrix.generate(e,this.frContent.selector,l)}}else i.matrix.generate(s,i.selector,l);if(i.generateRows(r,{matrix:a,handlerInstance:t.args&&t.args.isFrozen?this.fHeader:t.args&&t.args.renderFrozenRightContent?this.frHeader:this.header}),!n.d.isDevice&&t&&t.args&&(this.focusByClick||"paging"!==t.args.requestType||(this.skipFocus=!1,this.parent.element.focus()),"grouping"===t.args.requestType&&(this.skipFocus=!0)),t&&t.args&&"virtualscroll"===t.args.requestType)if(this.currentInfo.uid){let e;if(t.rows.some((t,i)=>(e=i,t.uid===this.currentInfo.uid))){this.content.matrix.current[0]=e,this.content.matrix.current[1]=this.parent.getColumnIndexByUid(this.focusedColumnUid)||0;let t=this.getContent().getFocusInfo().elementToFocus;if(t){let e=t.getBoundingClientRect(),i=this.parent.element.getBoundingClientRect();e.top>=0&&e.left>=0&&e.right<=Math.min(i.right,window.innerWidth||document.documentElement.clientWidth)&&e.bottom<=Math.min(i.bottom,window.innerHeight||document.documentElement.clientHeight)&&this.focus()}}}else if(t.args.focusElement&&t.args.focusElement.classList.contains("e-filtertext")){let e=this.parent.element.querySelector("#"+t.args.focusElement.id);e&&e.focus()}}}addEventListener(){if(this.parent.isDestroyed)return;n.l.add(this.parent.element,"mousedown",this.focusCheck,this),n.l.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=e=>this.passiveFocus(e),!0),n.l.add(this.parent.element,"focusout",this.onBlur,this),this.parent.on(I,this.onKeyPress,this),this.parent.on(M,this.onClick,this),this.parent.on(O,this.refMatrix,this),this.parent.on("partial-refresh",this.refMatrix,this),this.parent.on(E,this.refreshMatrix(),this),this.parent.on("close-edit",this.restoreFocus,this),this.parent.on("restore-Focus",this.restoreFocus,this);let e=["start-edit","start-add"];for(let i=0;i<e.length;i++)this.parent.on(e[i],this.clearIndicator,this);this.parent.on("sorting-complete",this.restoreFocus,this),this.parent.on("filtering-complete",this.filterfocus,this);let t=["grouping","ungrouping"];for(let i=0;i<t.length;i++)this.parent.on(t[i]+"-complete",this.restoreFocusWithAction,this);this.parent.on("batchAdd",this.refMatrix,this),this.parent.on("batchCancel",this.refMatrix,this),this.parent.on("batchDelete",this.refMatrix,this),this.parent.on("detailDataBound",this.refMatrix,this),this.parent.on(j,this.refMatrix,this),this.parent.on("cellfocused",this.internalCellFocus,this)}filterfocus(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()}removeEventListener(){if(this.parent.isDestroyed)return;n.l.remove(this.parent.element,"mousedown",this.focusCheck),n.l.remove(this.parent.element,"focus",this.onFocus),n.l.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),this.parent.off(I,this.onKeyPress),this.parent.off(M,this.onClick),this.parent.off(O,this.refMatrix),this.parent.off("partial-refresh",this.refMatrix),this.parent.off(E,this.refreshMatrix()),this.parent.off("close-edit",this.restoreFocus),this.parent.off("restore-focus",this.restoreFocus);let e=["start-edit","start-add"];for(let i=0;i<e.length;i++)this.parent.off(e[i],this.clearOutline);this.parent.off("sorting-complete",this.restoreFocus),this.parent.off("filtering-complete",this.filterfocus);let t=["grouping","ungrouping"];for(let i=0;i<t.length;i++)this.parent.on(t[i]+"-complete",this.restoreFocusWithAction);this.parent.off("batchAdd",this.refMatrix),this.parent.off("batchDelete",this.refMatrix),this.parent.off("batchCancel",this.refMatrix),this.parent.off("detailDataBound",this.refMatrix),this.parent.off(j,this.refMatrix),this.parent.off("cellfocused",this.internalCellFocus)}destroy(){this.removeEventListener()}restoreFocus(){this.addFocus(this.getContent().getFocusInfo())}restoreFocusWithAction(e){if(!this.parent.enableInfiniteScrolling){let t=this.getContent().matrix,i=t.current;switch(e.requestType){case"grouping":case"ungrouping":i[1]=!i.length||this.parent.groupSettings.showGroupedColumn||Object(n.X)(t.matrix[i[0]])?"grouping"===e.requestType?i[1]+1:i[1]-1:t.matrix[i[0]].indexOf(1)}this.getContent().matrix.current=i,this.addFocus(this.getContent().getFocusInfo())}}clearOutline(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator()),this.clearIndicator()}clearIndicator(){this.currentInfo.element&&this.currentInfo.elementToFocus&&Object(n.ib)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])}getPrevIndexes(){let e=this.forget;return this.forget=!1,e||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes}forgetPrevious(){this.forget=!0}setActiveByKey(e,t){if(!this.parent.isFrozenGrid()&&0===this.parent.frozenRows)return;let i,s={home:()=>({toHeader:!i.isContent,toFrozen:!0}),end:()=>({toHeader:!i.isContent,toFrozen:!1}),ctrlHome:()=>({toHeader:!0,toFrozen:this.parent.isFrozenGrid()}),ctrlEnd:()=>({toHeader:!1,toFrozen:!1})};if(!(e in s))return;i=t.getInfo();let r=s[e]();this.setActive(!r.toHeader,r.toFrozen),this.getContent().matrix.current=t.matrix.current}internalCellFocus(e){if(!(e.byKey&&e.container.isContent&&"enter"===e.keyArgs.action&&(e.parent.classList.contains("e-detailcell")||e.parent.classList.contains("e-unboundcell")||e.parent.classList.contains("e-templatecell"))))return;this.clearIndicator();let t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t),this.currentInfo.skipAction=!0}}class be{constructor(){this.matrix=[],this.current=[]}set(e,t,i){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.columns)),this.matrix[e]=this.matrix[e]||[],this.matrix[e][t]=i?1:0}get(e,t,i,s,r){let l=t;if(e+i[0]<0)return[e,t];e=Math.max(0,Math.min(e+i[0],this.rows));let a=!0;if(Object(n.X)(this.matrix[e]))return null;if(t=Math.max(0,Math.min(t+i[1],this.matrix[e].length-1)),l+i[1]>this.matrix[e].length-1&&r(e,t,s))return[e,l];let o=this.first(this.matrix[e],t,i,!0,s);t=null===o?l:o;let h=Object(n.V)(`${e}.${t}`,this.matrix);if(e!==this.rows||"downArrow"!==s&&"enter"!==s||(i[0]=-1),null===o){e=this.current[0];for(let e=0;e<this.rows;e++)if(this.matrix[e].some(e=>1===e)){a=!1;break}if(a)return[e,t]}return this.inValid(h)||!r(e,t,s)?this.get(e,l,i,s,r):[e,t]}first(e,t,i,s,r){return(t<0||t===e.length)&&this.inValid(e[t])&&"upArrow"!==r&&"downArrow"!==r||!e.some(e=>1===e)?null:this.inValid(e[t])?this.first(e,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(r)?s?0:++t:t+i[1],i,!1,r):t}select(e,t){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.matrix[e].length-1)),this.current=[e,t]}generate(e,t,i){this.rows=e.length-1,this.matrix=[];for(let s=0;s<e.length;s++){let r=e[s].cells.filter(e=>!0!==e.isSpanned);this.columns=Math.max(r.length-1,0|this.columns);for(let n=0;n<r.length;n++)this.set(s,n,t(e[s],r[n],i))}return this.matrix}inValid(e){return 0===e||void 0===e}}class fe{constructor(e){this.matrix=new be,this.parent=e,this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]},this.indexesByKey=e=>({home:[this.matrix.current[0],-1,0,1],end:[this.matrix.current[0],this.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[this.matrix.rows,this.matrix.columns+1,0,-1]}[e]||null)}getTable(){return this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()}onKeyPress(e){let t=this.getCurrentFromAction(e.action,this.keyActions[e.action],e.action in this.keyActions,e);if(t){if((["tab","shiftTab"].indexOf(e.action)>-1&&this.matrix.current||[]).toString()===t.toString()){if(t.toString()===[this.matrix.rows,this.matrix.columns].toString()||t.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===t.toString())return!1;t=this.editNextRow(t[0],t[1],e.action)}this.matrix.select(t[0],t[1])}}editNextRow(e,t,i){let s=this.parent,r=s.editSettings.allowNextRowEdit&&(s.isEdit||s.isLastCellPrimaryKey),n=s.getColumnIndexByField(s.getVisibleColumns()[0].field),l=this.getTable().rows[e].cells[t];return"tab"===i&&r&&(e++,t=n+(this.getTable().rows[e].querySelectorAll(".e-indentcell").length+this.getTable().rows[e].querySelectorAll(".e-detailrowcollapse").length)),"shiftTab"===i&&r&&(e--,t=s.getColumnIndexByField(s.getVisibleColumns()[s.getVisibleColumns().length-1].field)),l.classList.contains("e-rowcell")||l.classList.contains("e-headercell")||l.classList.contains("e-groupcaption")?[e,t]:this.editNextRow(e,t,i)}getCurrentFromAction(e,t=[0,0],i,s){if(!i&&!this.indexesByKey(e)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(s))return this.matrix.current;let[r,n,l,a]=this.indexesByKey(e)||[...this.matrix.current,...t];return this.matrix.get(r,n,[l,a],e,this.validator())}onClick(e,t){let i=e.target;if(i=i.classList.contains("e-rowcell")?i:Object(n.C)(i,"td"),i=i||Object(n.C)(e.target,"td.e-detailrowcollapse")||Object(n.C)(e.target,"td.e-detailrowexpand"),i=Object(n.C)(e.target,"td.e-detailcell")&&Object(n.X)(Object(n.C)(Object(n.C)(e.target,".e-grid"),"td.e-detailcell"))?null:i,i=i&&Object(n.C)(i,"table").classList.contains("e-table")?i:null,!i)return!1;let[s,r]=[i.parentElement.rowIndex,i.cellIndex],[l,a]=this.matrix.current,o=Object(n.V)(`${s}.${r}`,this.matrix.matrix);if(this.matrix.inValid(o)||!t&&l===s&&a===r||!mt(e.target,"e-rowcell")&&!mt(e.target,"e-groupcaption"))return!1;this.matrix.select(s,r)}getFocusInfo(){let e={},[t=0,i=0]=this.matrix.current;return this.matrix.current=[t,i],e.element=Object(n.X)(this.getTable().rows[t])?null:this.getTable().rows[t].cells[i],e.element?(e.elementToFocus=e.element.classList.contains("e-unboundcell")||e.element.classList.contains("e-detailcell")?e.element:this.getFocusable(e.element),e.outline=!0,e.uid=e.element.parentElement.getAttribute("data-uid"),e):e}getFocusable(e){let t='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])';this.parent.isEdit&&(t='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea');let i=[].slice.call(e.querySelectorAll(t));return i.length?i[0]:e}selector(e,t,i){let s=[A.Expand,A.GroupCaption,A.CaptionSummary,A.GroupSummary];return(e.isDataRow&&t.visible&&(t.isDataCell||t.isTemplate)||e.isDataRow&&t.cellType===A.DetailExpand&&Object(n.X)(t.visible)||!e.isDataRow&&s.indexOf(t.cellType)>-1||t.column&&"checkbox"===t.column.type||t.cellType===A.CommandColumn||e.isDataRow&&i)&&!("delete"===e.edit&&e.isDirty)}jump(e,t){let i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftTab"===e)&&0===t[1],s=("rightArrow"===e||"tab"===e)&&t[1]===this.matrix.columns,r="Left-Right"===this.parent.getFrozenMode()&&s;"Right"===this.parent.getFrozenMode()&&(i=s);let n=0!==this.parent.frozenRows&&"shiftEnter"===e;"tab"!==e||this.parent.isEdit||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.matrix.current[0]+1,this.matrix.current[1]=-1,i=this.parent.isFrozenGrid()),"shiftTab"!==e||this.parent.isEdit||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.matrix.current[0]-1,this.matrix.current[1]=this.matrix.matrix[t[0]].length);let l=!1,a=document.activeElement.parentElement;return(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&a.classList.contains("e-row")&&(l=parseInt(a.getAttribute("aria-rowindex"),10)>0),{swap:!l&&(("upArrow"===e||n)&&0===t[0]||i||r),toHeader:("upArrow"===e||n)&&0===t[0],toFrozen:i,toFrozenRight:r}}getNextCurrent(e=[],t,i,s){let r=[];return"Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?("leftArrow"!==s&&"shiftTab"!==s||(r[0]=e[0],r[1]=i.matrix.columns+1),"Left-Right"!==this.parent.getFrozenMode()||"rightArrow"!==s&&"tab"!==s||(r[0]=e[0],r[1]=-1)):"rightArrow"!==s&&"tab"!==s||(r[0]=e[0],r[1]=-1),"downArrow"!==s&&"enter"!==s||(r[0]=-1,r[1]=e[1]),r}generateRows(e,t){let{matrix:i,handlerInstance:s}=t,r=s.matrix.matrix.length,n=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?r+1:r;s.matrix.matrix=s.matrix.matrix.slice(0,n),s.matrix.rows=n,s.matrix.matrix.push(...i),s.matrix.rows+=i.length}getInfo(e){let t=this.getFocusInfo(),[i,s]=this.matrix.current,r=t.element.classList.contains("e-rowcell"),n=r||e&&"enter"!==e.action&&(t.element.classList.contains("e-detailrowcollapse")||t.element.classList.contains("e-detailrowexpand")),[l,a]=[Math.min(parseInt(t.element.parentElement.getAttribute("aria-rowindex"),10),i),Math.min(parseInt(t.element.getAttribute("aria-colindex"),10),s)];return{isContent:!0,isDataCell:r,indexes:[l,a],isSelectable:n}}validator(){let e=this.getTable();return(t,i,s)=>{if(!Object(n.X)(e.rows[t])){let r;i=e.querySelector(".e-emptyrow")?0:i,r=e.rows[t].cells[0].classList.contains("e-editcell")?e.rows[t].cells[0].querySelectorAll("td")[i]:e.rows[t].cells[i];let n=0!==r.getBoundingClientRect().width;if("enter"===s||"shiftEnter"===s)return n&&r.classList.contains("e-rowcell");if(("shiftUp"===s||"shiftDown"===s)&&r.classList.contains("e-rowcell"))return n;if("shiftUp"!==s&&"shiftDown"!==s)return n}return!1}}shouldFocusChange(e){let[t=-1,i=-1]=this.matrix.current;if(t<0||i<0)return!0;let s=Object(n.V)(`${t}.cells.${i}`,this.getTable().rows);return!s||"enter"!==e.action&&"shiftEnter"!==e.action||s.classList.contains("e-rowcell")&&!s.classList.contains("e-unboundcell")&&(!s.classList.contains("e-templatecell")||s.classList.contains("e-editedbatchcell"))&&!s.classList.contains("e-detailcell")}getGridSeletion(){return!Object(n.W)()&&this.parent.allowSelection&&this.parent.selectionSettings.allowColumnSelection}}class ye extends fe{constructor(e){super(e)}getTable(){return this.parent.isFrozenGrid()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()}onClick(e){let t=e.target;if(t=t.classList.contains("e-headercell")?t:Object(n.C)(t,"th"),t||0===this.parent.frozenRows||(t=e.target.classList.contains("e-rowcell")?e.target:Object(n.C)(e.target,"td")),e.target.classList.contains("e-columnheader")||e.target.querySelector(".e-stackedheadercell"))return!1;if(!t)return;let[i,s]=[t.parentElement.rowIndex,t.cellIndex],r=Object(n.V)(`${i}.${s}`,this.matrix.matrix);if(this.matrix.inValid(r))return!1;this.matrix.select(t.parentElement.rowIndex,t.cellIndex)}getFocusInfo(){let e={},[t=0,i=0]=this.matrix.current;return e.element=this.getTable().rows[t].cells[i],Object(n.X)(e.element)||(e.elementToFocus=this.getFocusable(e.element),e.outline=!e.element.classList.contains("e-filterbarcell")),e}selector(e,t){return t.visible&&(void 0!==t.column.field||t.isTemplate||!Object(n.X)(t.column.template))||"checkbox"===t.column.type||t.cellType===A.StackedHeader}jump(e,t){let i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1],s=("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,r="Left-Right"===this.parent.getFrozenMode()&&s;"Right"===this.parent.getFrozenMode()&&(i=s);let l,a,o=0!==this.parent.frozenRows&&"enter"===e,h=i||r,d=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,c=d&&!Object(n.X)(d[t[0]]);return this.parent.enableHeaderFocus&&"tab"===e&&(a=this.matrix.matrix.length-1===t[0],l=t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),l&&(this.matrix.current[0]=a?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.isFrozenGrid()&&a&&l&&(i=!0,h=!1)),{swap:("downArrow"===e||o)&&t[0]===this.matrix.matrix.length-1||c&&(i||r)||"tab"===e&&a&&l,toHeader:h,toFrozen:i,toFrozenRight:r}}getNextCurrent(e=[],t,i,s){let r=[];return"Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?(("leftArrow"===s||"shiftLeft"===s&&this.getGridSeletion()||"shiftTab"===s)&&(r[0]=e[0],r[1]=i.matrix.columns+1),"Left-Right"===this.parent.getFrozenMode()&&("rightArrow"===s||"shiftRight"===s&&this.getGridSeletion()||"tab"===s)&&(r[0]=e[0],r[1]=-1)):("rightArrow"===s||"shiftRight"===s&&this.getGridSeletion()||"tab"===s)&&(r[0]=e[0],r[1]=-1),"upArrow"!==s&&"shiftEnter"!==s||(r[0]=this.matrix.matrix.length,r[1]=e[1]),r}generateRows(e){let t=this.matrix.matrix.length;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type){this.matrix.rows=++this.matrix.rows;let i=e[0].cells;for(let e=0;e<i.length;e++)this.matrix.set(t,e,i[e].visible&&!1!==i[e].column.allowFiltering)}}getInfo(e){return Object(n.K)(super.getInfo(e),{isContent:!1,isHeader:!0})}validator(){return()=>!0}shouldFocusChange(e){let[t,i]=this.matrix.current;if(t<0||i<0)return!0;let s=Object(n.V)(`${t}.cells.${i}`,this.getTable().rows);return!s||"enter"!==e.action&&"altDownArrow"!==e.action||!s.classList.contains("e-headercell")}}class Ce extends fe{getTable(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")}jump(e,t){let i=("upArrow"===e||0!==this.parent.frozenRows&&"shiftEnter"===e)&&0===t[0];return"Right"===this.parent.getFrozenMode()?{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:i,toFrozen:i}:{swap:i||("tab"===e||"rightArrow"===e)&&t[1]===this.matrix.columns,toHeader:i,toFrozen:i}}getNextCurrent(e=[],t,i,s){let r=[];return"Right"===this.parent.getFrozenMode()?"rightArrow"!==s&&"tab"!==s||(r[0]=e[0],r[1]=-1):("tab"===s&&this.parent.enableHeaderFocus&&(r[0]=e[0],r[1]=-1),"leftArrow"!==s&&"shiftTab"!==s||(r[0]=e[0],r[1]=i.matrix.columns+1)),"downArrow"!==s&&"enter"!==s||(r[0]=-1,r[1]=e[1]),r}}class ve extends ye{jump(e,t){let i=0!==this.parent.frozenRows&&"enter"===e,s=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,r=s&&!Object(n.X)(s[t[0]]);if("Right"===this.parent.getFrozenMode()){let s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||r&&s,toHeader:s,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}}return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns&&r,toHeader:("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}}getTable(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")}getNextCurrent(e=[],t,i,s){let r=[];return"Right"===this.parent.getFrozenMode()?("rightArrow"===s||"shiftRight"===s&&this.getGridSeletion()||"tab"===s)&&(r[0]=e[0],r[1]=-1):("leftArrow"===s||"shiftLeft"===s&&this.getGridSeletion()||"shiftTab"===s)&&(r[0]=e[0],r[1]=i.matrix.columns+1),"upArrow"!==s&&"shiftEnter"!==s||(r[0]=this.matrix.matrix.length,r[1]=e[1]),r}}class we{constructor(e){this.searchBox=e}searchFocus(e){e.target.parentElement.classList.add("e-input-focus")}searchBlur(e){e.target.parentElement.classList.remove("e-input-focus")}wireEvent(){this.searchBox&&(n.l.add(this.searchBox,"focus",this.searchFocus,this),n.l.add(this.searchBox,"blur",this.searchBlur,this))}unWireEvent(){this.searchBox&&(n.l.remove(this.searchBox,"focus",this.searchFocus),n.l.remove(this.searchBox,"blur",this.searchBlur))}}class Se extends fe{getTable(){return this.parent.getContent().querySelector(".e-frozen-right-content .e-table")}jump(e,t){let i=("upArrow"===e||0!==this.parent.frozenRows&&"shiftEnter"===e)&&0===t[0];return{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:i,toFrozenRight:i}}getNextCurrent(e=[],t,i,s){let r=[];return"rightArrow"!==s&&"tab"!==s||(r[0]=e[0],r[1]=-1),"downArrow"!==s&&"enter"!==s||(r[0]=-1,r[1]=e[1]),r}}class Oe extends ye{jump(e,t){let i=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,s=i&&!Object(n.X)(i[t[0]]),r=0!==this.parent.frozenRows&&"enter"===e,l=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||r)&&t[0]===this.matrix.matrix.length-1||s&&l,toHeader:l,toFrozenRight:("downArrow"===e||r)&&t[0]===this.matrix.matrix.length-1}}getTable(){return this.parent.getHeaderContent().querySelector(".e-frozen-right-header .e-table")}getNextCurrent(e=[],t,i,s){let r=[];return("rightArrow"===s||"shiftRight"===s&&this.getGridSeletion()||"tab"===s)&&(r[0]=e[0],r[1]=0),"upArrow"!==s&&"shiftEnter"!==s||(r[0]=this.matrix.matrix.length,r[1]=e[1]),r}}var xe=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};let je=(()=>{class e extends n.e{}return xe([Object(n.s)(12)],e.prototype,"pageSize",void 0),xe([Object(n.s)(8)],e.prototype,"pageCount",void 0),xe([Object(n.s)(1)],e.prototype,"currentPage",void 0),xe([Object(n.s)()],e.prototype,"totalRecordsCount",void 0),xe([Object(n.s)(!1)],e.prototype,"enableQueryString",void 0),xe([Object(n.s)(!1)],e.prototype,"pageSizes",void 0),xe([Object(n.s)(null)],e.prototype,"template",void 0),e})(),Re=(()=>{class e extends n.e{}return function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);n>3&&l&&Object.defineProperty(t,i,l)}([Object(n.s)("startsWith")],e.prototype,"operator",void 0),e})();class De{constructor(e,t,i){this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.selectedColumnsIndexes=[],this.checkBoxState=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.enableSelectMultiTouch=!1,this.clearRowCheck=!1,this.selectRowCheck=!1,this.selectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.needColumnSelection=!1,this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.cellselected=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.initialRowSelection=!1,this.autoFillRLselection=!0,this.parent=e,this.selectionSettings=t,this.factory=i.getService("rendererFactory"),this.focus=i.getService("focus"),this.addEventListener(),this.wireEvents()}initializeSelection(){this.parent.log("selection_key_missing"),this.render()}onActionBegin(e,t){this.parent.trigger(t,this.fDataUpdate(e))}fDataUpdate(e){if(!(this.isMultiSelection||Object(n.X)(e.cellIndex)&&Object(n.X)(e.rowIndex))){let t=this.getRowObj(Object(n.X)(e.rowIndex)?Object(n.X)(e.cellIndex)?this.currentIndex:e.cellIndex.rowIndex:e.rowIndex);e.foreignKeyData=t.foreignKeyData}return e}onActionComplete(e,t){this.parent.trigger(t,this.fDataUpdate(e)),this.isMultiSelection=!1}getModuleName(){return"selection"}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),n.l.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),n.l.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))}isEditing(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection}getSelectedMovableRow(e){let t=this.parent;return t.isFrozenGrid()&&this.parent.getContent().querySelector(".e-movablecontent")?t.getMovableRowByIndex(e):null}getSelectedFrozenRightRow(e){let t=this.parent;return t.isFrozenGrid()&&"Left-Right"===t.getFrozenMode()&&t.getFrozenRightContent()?t.getFrozenRightRowByIndex(e):null}getCurrentBatchRecordChanges(){let e=this.parent;if("Batch"===e.editSettings.mode&&e.editModule){let t=at(this.parent.getCurrentViewRecords());t="Bottom"===e.editSettings.newRowPosition?t.concat(this.parent.editModule.getBatchChanges().addedRecords):this.parent.editModule.getBatchChanges().addedRecords.concat(t);let i=this.parent.editModule.getBatchChanges().deletedRecords,s=this.parent.getPrimaryKeyFieldNames()[0];for(let e=0;e<i.length;e++)for(let r=0;r<t.length;r++)if(i[e][s]===t[r][s]){t.splice(r,1);break}return t}return e.getCurrentViewRecords()}selectRow(e,t){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)return void this.addRowsToSelection([e]);let i,s=this.parent,r=s.getRowByIndex(e),l=this.getSelectedMovableRow(e),a=this.getSelectedFrozenRightRow(e);if(s.enableVirtualization&&e>-1){this.parent.notify("select-virtual-Row",{selectedIndex:e});let t=s.isFrozenGrid()?s.contentModule.getRowObjectByIndex(e):null;if(!r||!s.getRowObjectFromUID(r.getAttribute("data-uid"))&&!t)return void(this.parent.getSelectedRecords().length>0&&this.clearRowSelection());i=t||s.getRowObjectFromUID(r.getAttribute("data-uid")).data}else i=this.getCurrentBatchRecordChanges()[e];if(!this.isRowType()||!r||this.isEditing())return;let o,h=r.hasAttribute("aria-selected");if(this.activeTarget(),t=t?!!this.selectedRowIndexes.length&&1===this.selectedRowIndexes.length&&e===this.selectedRowIndexes[0]:t)this.rowSelectingCallBack(o,t,e,i,!1,h,"cancel")(o);else{let d="isHybrid";!Object(n.W)()||this.parent.isJsComponent||this.parent[d]?(o={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:r,previousRow:s.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},o=this.addMovableArgs(o,l,a)):o={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowIndex:this.prevRowIndex,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},this.parent.trigger("rowSelecting",this.fDataUpdate(o),this.rowSelectingCallBack(o,t,e,i,!1,h,"cancel"))}}rowSelectingCallBack(e,t,i,s,r,l,a){return e=>{Object(n.X)(e)||!0!==e[a]?(this.index=i,this.toggle=t,this.data=s,this.removed=r,l&&this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?(this.clearSelectedRow(i),this.selectRowCallBack()):!l&&this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&this.selectRowCallBack(),"ResetOnRowClick"===this.selectionSettings.checkboxMode&&this.clearSelection(),(!this.selectionSettings.persistSelection||"ResetOnRowClick"===this.selectionSettings.checkboxMode||!this.parent.isCheckBoxSelection&&this.selectionSettings.persistSelection)&&(this.selectRowCheck=!0,this.clearRow())):this.disableInteracted()}}selectRowCallBack(){let e,t=this.parent,i=this.index,s=this.toggle,r=this.data,l=this.removed,a=t.getRowByIndex(i),o=this.getSelectedMovableRow(i),h=this.getSelectedFrozenRightRow(i);if(s||l||(this.selectedRowIndexes.indexOf(i)<=-1&&(this.updateRowSelection(a,i),this.selectMovableRow(o,h,i)),this.selectRowIndex(i)),!s){let s="isHybrid";!Object(n.W)()||this.parent.isJsComponent||this.parent[s]?(e={data:r,rowIndex:i,row:a,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},e=this.addMovableArgs(e,o,h)):e={data:r,rowIndex:i,row:a,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},this.onActionComplete(e,"rowSelected")}Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",[i]),this.isInteracted=!1,this.updateRowProps(i)}selectMovableRow(e,t,i){this.parent.isFrozenGrid()&&(this.updateRowSelection(e,i),"Left-Right"===this.parent.getFrozenMode()&&t&&this.updateRowSelection(t,i))}addMovableArgs(e,t,i){if(this.parent.isFrozenGrid()){let s={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]},r="frozenRightRow",n="previousFrozenRightRow";"Left-Right"===this.parent.getFrozenMode()&&i&&(s[r]=i,s[n]=this.parent.getFrozenRightDataRows()[this.prevRowIndex]),e=Object.assign({},e,s)}return e}selectRowsByRange(e,t){this.selectRows(this.getCollectionFromIndexes(e,t)),this.selectRowIndex(t)}selectRows(e){let t=this.parent,i=this.isSingleSel()?e[e.length-1]:e[0];this.isMultiSelection=!0;let s,r=[],l=[],a=this.getSelectedMovableRow(i),o=this.getSelectedFrozenRightRow(i),h=[];if(this.isRowType()&&!this.isEditing()){for(let t=0,i=e.length;t<i;t++){let i=this.parent.getDataRows()[e[t]],s=this.getRowObj(i);s&&(h.push(s.data),r.push(i),l.push(s.foreignKeyData))}this.activeTarget(),!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(s={cancel:!1,rowIndexes:e,row:r,rowIndex:i,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:h,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:l},s=this.addMovableArgs(s,a,o)):s={cancel:!1,rowIndexes:e,rowIndex:i,previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:h,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:l},this.parent.trigger("rowSelecting",this.fDataUpdate(s),s=>{if(!Object(n.X)(s)&&!0===s.cancel)return void this.disableInteracted();this.clearRow(),this.selectRowIndex(e.slice(-1)[0]);let d=e=>{if(this.updateRowSelection(t.getRowByIndex(e),e),t.isFrozenGrid()){let i="Left-Right"===this.parent.getFrozenMode()?t.getFrozenRightRowByIndex(e):void 0;this.selectMovableRow(t.getMovableRowByIndex(e),i,e)}this.updateRowProps(i)};if(this.isSingleSel())d(i);else for(let t of e)d(t);!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(s={rowIndexes:e,row:r,rowIndex:i,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,data:Object(n.W)()?h:this.getSelectedRecords(),isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:l},s=this.addMovableArgs(s,a,o)):s={rowIndexes:e,rowIndex:i,previousRowIndex:this.prevRowIndex,row:r,prevRow:t.getRows()[this.prevRowIndex],data:Object(n.W)()?h:this.getSelectedRecords(),isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:l},this.isRowSelected&&this.onActionComplete(s,"rowSelected"),this.isInteracted=!1})}}addRowsToSelection(e){let t=this.parent,i=this.target;this.isMultiSelection=!0;let s,r=t.getSelectedRowIndexes().concat(e),l=this.isSingleSel()?t.getRowByIndex(e[e.length-1]):t.getRowByIndex(e[0]),a=this.isSingleSel()?this.getSelectedMovableRow(e[e.length-1]):this.getSelectedMovableRow(e[0]),o=this.isSingleSel()?this.getSelectedFrozenRightRow(e[e.length-1]):this.getSelectedFrozenRightRow(e[0]);if((!this.isRowType()||this.isEditing())&&!this.selectionSettings.checkboxOnly)return;let h=this.parent.getColumns().filter(e=>"checkbox"===e.type);for(let d of e){let e=this.getRowObj(d),c=this.selectedRowIndexes.indexOf(d)>-1;if(this.selectRowIndex(d),c&&(h.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.isAddRowsToSelection=!0,this.rowDeselect("rowDeselecting",[d],[e.data],[l],[e.foreignKeyData],i),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(d),1),this.selectedRecords.splice(this.selectedRecords.indexOf(l),1),l.removeAttribute("aria-selected"),this.addRemoveClassesForRow(l,!1,null,"e-selectionbackground","e-active"),a&&(this.selectedRecords.splice(this.selectedRecords.indexOf(a),1),a.removeAttribute("aria-selected"),this.addRemoveClassesForRow(a,!1,null,"e-selectionbackground","e-active")),o&&(this.selectedRecords.splice(this.selectedRecords.indexOf(o),1),o.removeAttribute("aria-selected"),this.addRemoveClassesForRow(o,!1,null,"e-selectionbackground","e-active")),this.rowDeselect("rowDeselected",[d],[e.data],[l],[e.foreignKeyData],i,[a],void 0,[o]),this.isInteracted=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1}else{let i="isHybrid";this.activeTarget(),!Object(n.W)()||this.parent.isJsComponent||this.parent[i]?(s={cancel:!1,data:e.data,rowIndex:d,row:l,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:e.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},s=this.addMovableArgs(s,a,o)):s={cancel:!1,data:e.data,rowIndex:d,previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:e.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},this.parent.trigger("rowSelecting",this.fDataUpdate(s),e=>{Object(n.X)(e)||!0!==e.cancel?(this.isSingleSel()&&this.clearRow(),this.updateRowSelection(l,d),this.selectMovableRow(a,o,d)):this.disableInteracted()})}if(!c){let i="isHybrid";!Object(n.W)()||this.parent.isJsComponent||this.parent[i]?(s={data:e.data,rowIndex:d,row:l,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:e.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},s=this.addMovableArgs(s,a,o)):s={data:e.data,rowIndex:d,previousRowIndex:this.prevRowIndex,row:l,prevRow:t.getRows()[this.prevRowIndex],foreignKeyData:e.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},this.onActionComplete(s,"rowSelected")}if(this.isInteracted=!1,this.updateRowProps(d),this.isSingleSel())break}}getCollectionFromIndexes(e,t){let i=[],{i:s,max:r}=e<=t?{i:e,max:t}:{i:t,max:e};for(;s<=r;s++)i.push(s);return e>t&&i.reverse(),i}clearRow(){this.clearRowCheck=!0,this.clearRowSelection()}clearRowCallBack(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))}clearSelectedRow(e){if(this.toggle){let t=this.parent.getRowByIndex(e);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active")),this.removed=!0,this.updatePersistCollection(t,!1),this.updateCheckBoxes(t),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(e),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(e)),1)}}updateRowProps(e){this.prevRowIndex=e,this.isRowSelected=this.selectedRowIndexes.length&&!0}updatePersistCollection(e,t){if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!Object(n.X)(e)){this.parent.isPersistSelection||this.ensureCheckboxFieldSelection();let i=this.getRowObj(e),s=i.data?i.data[this.primaryKey]:null;if(null===s)return;i.isSelected=t,t?(this.selectedRowState[s]=t,this.persistSelectedData.some(e=>e[this.primaryKey]===s)||this.persistSelectedData.push(i.data)):this.updatePersistDelete(s)}}updatePersistDelete(e){let t;delete this.selectedRowState[e],this.persistSelectedData.some((i,s)=>(t=s,i[this.primaryKey]===e))&&this.persistSelectedData.splice(t,1)}updateCheckBoxes(e,t,i){if(!Object(n.X)(e)){let s=e.querySelector(".e-checkselect");Object(n.X)(s)||(Nt(s.nextElementSibling,t),Vt(s,t),(Object(n.X)(this.checkedTarget)||!Object(n.X)(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(i))}}updateRowSelection(e,t){if(!e)return;this.selectedRowIndexes.push(t);let i=this.selectedRowIndexes.length;if(this.parent.isFrozenGrid()&&i>1&&this.selectedRowIndexes[i-2]===this.selectedRowIndexes[i-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(e),e.setAttribute("aria-selected","true"),this.updatePersistCollection(e,!0),this.updateCheckBoxes(e,!0),this.addRemoveClassesForRow(e,!0,null,"e-selectionbackground","e-active"),!this.preventFocus){let t=this.focus.getPrevIndexes().cellIndex?e.cells[this.focus.getPrevIndexes().cellIndex]:e.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(this.parent.contextMenuModule&&2===this.mouseButton&&(t=this.parent.contextMenuModule.cell),!t)return;this.focus.onClick({target:t},!0)}}clearSelection(){if(!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!Object(n.X)(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){let e=this.parent.element.querySelector(".e-gridpopup").querySelector("span");e.classList.contains("e-rowselect")&&e.classList.remove("e-spanclicked"),this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.clearColumnSelection(),this.prevRowIndex=void 0,this.enableSelectMultiTouch=!1,this.isInteracted=!1}}clearRowSelection(){if(this.isRowSelected){let e=this.parent,t=this.parent.getDataRows(),i=[],s=[],r=[],l=[],a=[],o=[],h=this.target;this.parent.getCurrentViewRecords();for(let n=0,d=this.selectedRowIndexes.length;n<d;n++){let t="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[n]]:this.parent.getDataRows()[this.selectedRowIndexes[n]],h=this.getRowObj(t);h&&(i.push(h.data),s.push(t),a.push(this.selectedRowIndexes[n]),o.push(h.foreignKeyData)),e.isFrozenGrid()&&(r.push(e.getMovableRows()[this.selectedRowIndexes[n]]),"Left-Right"===e.getFrozenMode()&&l.push(e.getFrozenRightRows()[this.selectedRowIndexes[n]]))}this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked),this.rowDeselect("rowDeselecting",a,i,s,o,h,r,()=>{if(this.isCancelDeSelect&&(this.isRowClicked||this.checkSelectAllClicked)){if(this.parent.isPersistSelection)if("Intermediate"===this.getCheckAllStatus(this.parent.element.querySelector(".e-checkselectall")))for(let e=0;e<this.selectedRecords.length;e++)this.updatePersistCollection(this.selectedRecords[e],!0);else this.parent.checkAllRows="Check",this.updatePersistSelectedData(!0);return void(this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1)))}let e=[].slice.call(t.filter(e=>e.hasAttribute("aria-selected")));for(let t=0;t<e.length;t++)this.disableUI&&!Object(n.W)()||(e[t].removeAttribute("aria-selected"),this.addRemoveClassesForRow(e[t],!1,!0,"e-selectionbackground","e-active")),this.updatePersistCollection(e[t],!1),this.updateCheckBoxes(e[t]);Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.getRenderer().setSelection(null,!1,!0);for(let t=0,i=this.selectedRowIndexes.length;t<i;t++){let e=this.getSelectedMovableRow(this.selectedRowIndexes[t]);e&&(this.disableUI&&!Object(n.W)()||(e.removeAttribute("aria-selected"),this.addRemoveClassesForRow(e,!1,!0,"e-selectionbackground","e-active")),this.updateCheckBoxes(e),this.updatePersistCollection(e,!1));let i=this.getSelectedFrozenRightRow(this.selectedRowIndexes[t]);i&&(this.disableUI||(i.removeAttribute("aria-selected"),this.addRemoveClassesForRow(i,!1,!0,"e-selectionbackground","e-active")),this.updateCheckBoxes(i),this.updatePersistCollection(i,!1))}this.selectedRowIndexes=[],this.selectedRecords=[],this.isRowSelected=!1,this.selectRowIndex(-1),this.rowDeselect("rowDeselected",a,i,s,o,h,r,void 0,l),this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},l)}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))}rowDeselect(e,t,i,s,r,l,a,o,h){if(this.selectionSettings.persistSelection&&(this.isRowClicked||this.checkSelectAllClicked)||!this.selectionSettings.persistSelection){let l="cancel",d={rowIndex:t[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.persistSelectedData:i,foreignKeyData:r,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===e&&delete d.cancel;let c="isHybrid";if(!Object(n.W)()||this.parent.isJsComponent||this.parent[c]){let e="row",i="target",r="rowIndex",l="rowIndexes",a="data",o="foreignKeyData";d[e]=s,d[i]=this.actualTarget,this.actualTarget&&!Object(n.X)(Object(n.C)(this.actualTarget,"thead"))||t.length>1?(d[r]=t[0],d[l]=t):1===t.length&&(d[a]=d[a][0],d[e]=d[e][0],d[o]=d[o][0],this.isAddRowsToSelection&&(d[l]=t))}else{let e="rowIndex",t="data";d[e]=d[e][d[e].length-1],d[t]=d[t][d[t].length-1]}this.parent.trigger(e,Object(n.W)()&&!this.parent.isJsComponent||!this.parent.isFrozenGrid()?d:Object.assign({},d,{mRow:a,frozenRightRow:h}),e=>{this.isCancelDeSelect=e[l],this.isCancelDeSelect&&(this.isRowClicked||this.checkSelectAllClicked)||(this.updatePersistCollection(s[0],!1),this.updateCheckBoxes(s[0],void 0,t[0]),a&&this.updateCheckBoxes(a[0],void 0,t[0]),h&&this.updateCheckBoxes(h[0],void 0,t[0])),void 0!==o&&o()})}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==o&&o()}getRowObj(e=this.currentIndex){return Object(n.X)(e)?{}:("number"==typeof e&&(e=this.parent.getRowByIndex(e)),e&&this.parent.getRowObjectFromUID(e.getAttribute("data-uid"))||{})}getSelectedMovableCell(e){let t=this.parent,i=t.getColumnByIndex(e.cellIndex);return t.isFrozenGrid()&&"movable"===i.getFreezeTableName()?t.getMovableCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex)):null}selectCell(e,t){if(!this.isCellType())return;let i,s=this.parent,r=this.getSelectedMovableCell(e);r||(r=s.getCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex))),this.currentIndex=e.rowIndex;let l=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isCellType()||!r||this.isEditing())return;let a=r.classList.contains("e-cellselectionbackground");(t=t?!Object(n.ab)(this.prevCIdxs)&&e.rowIndex===this.prevCIdxs.rowIndex&&e.cellIndex===this.prevCIdxs.cellIndex&&a:t)?this.successCallBack(i,t,e,r,l)(i):(i={data:l,cellIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1},(!Object(n.W)()||this.parent.isJsComponent)&&(i.currentCell=r,i.previousRowCellIndex=this.prevECIdxs),this.parent.trigger("cellSelecting",this.fDataUpdate(i),this.successCallBack(i,t,e,r,l)),this.cellselected=!0)}successCallBack(e,t,i,s,r){return e=>{if((Object(n.X)(e)||!0!==e.cancel)&&(t||(e.currentCell=e.currentCell?e.currentCell:s),this.clearCell(),t||this.updateCellSelection(s,i.rowIndex,i.cellIndex),!t)){let e,t="isHybrid";!Object(n.W)()||this.parent.isJsComponent||this.parent[t]?(e={data:r,cellIndex:i,currentCell:s,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},e.previousRowCellIndex=this.prevECIdxs):e={data:r,cellIndex:i,selectedRowCellIndex:this.selectedRowCellIndexes},this.updateCellProps(i,i),this.onActionComplete(e,"cellSelected")}}}getCellIndex(e,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(e,t):this.parent.getCellFromIndex(e,t)}selectCellsByRange(e,t){if(!this.isCellType())return;let i,s,r=this.parent,l=this.getSelectedMovableCell(e),a=r.getFrozenColumns();l||(l=r.getCellFromIndex(e.rowIndex,e.cellIndex));let o,h=e,d=t=t||e;this.currentIndex=e.rowIndex;let c=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isSingleSel()||!this.isCellType()||this.isEditing())return;let p={data:c,cellIndex:e,currentCell:l,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};Object(n.W)()||(p.previousRowCellIndex=this.prevECIdxs),this.parent.trigger("cellSelecting",this.fDataUpdate(p),p=>{if(!Object(n.X)(p)&&!0===p.cancel)return;if(this.clearCell(),e.rowIndex>t.rowIndex){let i=e;e=t,t=i}for(let n=e.rowIndex;n<=t.rowIndex;n++){this.selectionSettings.cellSelectionMode.indexOf("Box")<0?(i=n===e.rowIndex?e.cellIndex:0,s=n===t.rowIndex?t.cellIndex:this.getLastColIndex(n)):(i=e.cellIndex,s=t.cellIndex),o=[];for(let e=i<s?i:s,t=i>s?i:s;e<=t;e++)l=a?e<a?r.getCellFromIndex(n,e):r.getMovableCellFromIndex(n,e):r.getCellFromIndex(n,e),l&&(o.push(e),this.updateCellSelection(l),this.addAttribute(l));this.selectedRowCellIndexes.push({rowIndex:n,cellIndexes:o})}let u;!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(u={data:c,cellIndex:d,currentCell:r.getCellFromIndex(d.rowIndex,d.cellIndex),selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},u.previousRowCellIndex=this.prevECIdxs):u={data:c,cellIndex:d,selectedRowCellIndex:this.selectedRowCellIndexes},this.isDragged||(this.onActionComplete(u,"cellSelected"),this.cellselected=!0),this.updateCellProps(h,d)})}selectCells(e){if(!this.isCellType())return;let t=this.parent,i=this.getSelectedMovableCell(e[0]),s=t.getFrozenColumns();i||(i=t.getCellFromIndex(e[0].rowIndex,e[0].cellIndexes[0])),this.currentIndex=e[0].rowIndex;let r,l,a=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(r={data:a,cellIndex:e[0].cellIndexes[0],currentCell:i,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},r.previousRowCellIndex=this.prevECIdxs):r={data:a,cellIndex:e[0].cellIndexes[0],isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(r,"cellSelecting");for(let r=0,n=e.length;r<n;r++)for(let l=0,a=e[r].cellIndexes.length;l<a;l++)i=s?e[r].cellIndexes[l]<s?t.getCellFromIndex(e[r].rowIndex,e[r].cellIndexes[l]):t.getMovableCellFromIndex(e[r].rowIndex,e[r].cellIndexes[l]):t.getCellFromIndex(e[r].rowIndex,e[r].cellIndexes[l]),i&&(this.updateCellSelection(i),this.addAttribute(i),this.addRowCellIndex({rowIndex:e[r].rowIndex,cellIndex:e[r].cellIndexes[l]}));this.updateCellProps({rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]},{rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]}),!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(l={data:a,cellIndex:e[0].cellIndexes[0],currentCell:i,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},l.previousRowCellIndex=this.prevECIdxs):l={data:a,cellIndex:e[0].cellIndexes[0],selectedRowCellIndex:this.selectedRowCellIndexes},this.onActionComplete(l,"cellSelected")}}addCellsToSelection(e){if(!this.isCellType())return;let t,i,s=this.parent;this.currentIndex=e[0].rowIndex;let r=this.getCurrentBatchRecordChanges()[this.currentIndex],l=s.getFrozenLeftCount(),a=s.getMovableColumnsCount();if(this.isSingleSel()||!this.isCellType()||this.isEditing())return;this.hideAutoFill();let o,h=s.getColumnByIndex(e[0].cellIndex);fi(this.parent,(t,i)=>{o=i[e[0].rowIndex]},[h.getFreezeTableName()&&"frozen-left"!==h.getFreezeTableName()?[]:s.getRowsObject(),"movable"===h.getFreezeTableName()?s.getMovableRowsObject():[],"frozen-right"===h.getFreezeTableName()?s.getFrozenRightRowsObject():[]]);let d=[];for(let c of e){for(let e=0,t=this.selectedRowCellIndexes.length;e<t;e++)if(this.selectedRowCellIndexes[e].rowIndex===c.rowIndex){i=e;break}t=this.getSelectedMovableCell(c),t||(t=s.getCellFromIndex(c.rowIndex,this.getColIndex(c.rowIndex,c.cellIndex)));let p,u="movable"===h.getFreezeTableName()?c.cellIndex-l:"frozen-right"===h.getFreezeTableName()?c.cellIndex-(l+a):c.cellIndex;d.push(o.cells[u].foreignKeyData),!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(p={cancel:!1,data:r,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,currentCell:t,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?s.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},p.previousRowCellIndex=this.prevECIdxs):p={cancel:!1,data:r,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,isCtrlPressed:this.isMultiCtrlRequest};let g=i>-1;if(g){let e=this.selectedRowCellIndexes[i].cellIndexes;e.indexOf(c.cellIndex)>-1?(this.cellDeselect("cellDeselecting",[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],r,[t],d),e.splice(e.indexOf(c.cellIndex),1),0===e.length&&this.selectedRowCellIndexes.splice(i,1),t.classList.remove("e-cellselectionbackground"),t.removeAttribute("aria-selected"),this.cellDeselect("cellDeselected",[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],r,[t],d)):(g=!1,this.onActionBegin(p,"cellSelecting"),this.addRowCellIndex({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),this.updateCellSelection(t),this.addAttribute(t))}else{if(this.onActionBegin(p,"cellSelecting"),!Object(n.X)(p)&&!0===p.cancel)return;this.updateCellSelection(t,c.rowIndex,c.cellIndex)}if(!g){let i;!Object(n.W)()||this.parent.isJsComponent||this.parent.isHybrid?(i={data:r,cellIndex:e[0],currentCell:t,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes},i.previousRowCellIndex=this.prevECIdxs):i={data:r,cellIndex:e[0],selectedRowCellIndex:this.selectedRowCellIndexes},this.onActionComplete(i,"cellSelected"),this.cellselected=!0}this.updateCellProps(c,c)}}getColIndex(e,t){let i=this.parent.isFrozenGrid(),s=this.parent.getColumnByIndex(t),r=wi(this.parent,s,e);if(r)for(let n=0;n<r.length;n++)if(parseInt(r[n].getAttribute("aria-colindex"),10)===t)return i&&("movable"===s.getFreezeTableName()?n+=this.parent.getFrozenLeftCount():"frozen-right"===s.getFreezeTableName()&&(n+=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount())),n;return-1}getLastColIndex(e){let t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[e].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[e].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute("aria-colindex"),10)}clearCell(){this.clearCellSelection()}cellDeselect(e,t,i,s,r){s[0]&&s[0].classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(n.C)(s[0],"tr"));let l={cells:s,data:i,cellIndexes:t,foreignKeyData:r,cancel:!1};this.parent.trigger(e,l),this.isPreventCellSelect=l.cancel}updateCellSelection(e,t,i){Object(n.X)(t)||this.addRowCellIndex({rowIndex:t,cellIndex:i}),e.classList.add("e-cellselectionbackground"),e.classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(n.C)(e,"tr"),!0),this.addAttribute(e)}addAttribute(e){this.target=e,Object(n.X)(e)||(e.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:e},!0))}updateCellProps(e,t){this.prevCIdxs=e,this.prevECIdxs=t,this.isCellSelected=this.selectedRowCellIndexes.length&&!0}addRowCellIndex(e){let t,i;for(let s=0,r=this.selectedRowCellIndexes.length;s<r;s++)if(this.selectedRowCellIndexes[s].rowIndex===e.rowIndex){t=!0,i=s;break}t?this.selectedRowCellIndexes[i].cellIndexes.indexOf(e.cellIndex)<0&&this.selectedRowCellIndexes[i].cellIndexes.push(e.cellIndex):this.selectedRowCellIndexes.push({rowIndex:e.rowIndex,cellIndexes:[e.cellIndex]})}clearCellSelection(){if(this.isCellSelected){let e=this.parent,t=this.getSelectedCellsElement(),i=this.selectedRowCellIndexes,s=[],r=[],n=[],l=this.getCurrentBatchRecordChanges(),a=e.isFrozenGrid();this.hideAutoFill();for(let o=0,h=i.length;o<h;o++){s.push(l[i[o].rowIndex]);let t=this.getRowObj(i[o].rowIndex);for(let s=0,l=i[o].cellIndexes.length;s<l;s++)if(a){let t=e.getColumnByIndex(i[o].cellIndexes[s]);r.push(Si(this.parent,t,i[o].rowIndex,i[o].cellIndexes[s]))}else t.cells&&n.push(t.cells[i[o].cellIndexes[s]].foreignKeyData),r.push(e.getCellFromIndex(i[o].rowIndex,i[o].cellIndexes[s]))}if(this.cellDeselect("cellDeselecting",i,s,r,n),!0===this.isPreventCellSelect)return;for(let o=0,h=t.length;o<h;o++)t[o].classList.remove("e-cellselectionbackground"),t[o].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none"),this.selectedRowCellIndexes=[],this.isCellSelected=!1,!this.isDragged&&this.cellselected&&this.cellDeselect("cellDeselected",i,s,r,n)}}getSelectedCellsElement(){let e,t=this.parent,i=t.getDataRows();t.isFrozenGrid()&&(e=t.getMovableDataRows(),i=t.addMovableRows(i,e),"Left-Right"===t.getFrozenMode()&&(i=t.addMovableRows(i,t.getFrozenRightDataRows())));let s=[];for(let r=0,n=i.length;r<n;r++)s=s.concat([].slice.call(i[r].querySelectorAll(".e-cellselectionbackground")));return s}mouseMoveHandler(e){e.preventDefault();let t,i=this.parent.element.getBoundingClientRect(),s=this.x,r=this.y,l=vt(e),a=l.x-i.left,o=l.y-i.top,h=Object(n.C)(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(h||(h=Object(n.C)(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),s>a&&(t=a,a=s,s=t),r>o&&(t=o,o=r,r=t),this.element.style.left=s+"px",this.element.style.top=r+"px",this.element.style.width=a-s+"px",this.element.style.height=o-r+"px"),h&&!e.ctrlKey&&!e.shiftKey){let t=parseInt(h.getAttribute("aria-rowindex"),10);if(this.isCellDrag){let i=mt(e.target,"e-rowcell");i&&(this.startAFCell=this.startCell,this.endAFCell=mt(e.target,"e-rowcell"),this.selectLikeExcel(e,t,parseInt(i.getAttribute("aria-colindex"),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,t)}}selectLikeExcel(e,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())}drawBorders(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")}isLastCell(e){let t=[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===e}isLastRow(e){let t=[].slice.call(Object(n.C)(e,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[t.length-1]}isFirstRow(e){let t=[].slice.call(Object(n.C)(e,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[0]}isFirstCell(e){return[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===e}setBorders(e,t,i){let s=[].slice.call(e.querySelectorAll(".e-cellselectionbackground")).filter(e=>""===e.style.display);if(s.length){let e=this.parent.isFrozenGrid(),r=s[0],n=s[s.length-1],l=r.getBoundingClientRect(),a=n.getBoundingClientRect(),o=r.offsetParent.getBoundingClientRect(),h=!this.isLastRow(n)||"1"!==i&&"2"!==i&&"5"!==i?0:2,d=this.parent.frozenRows&&("1"===i||"2"===i)&&this.isFirstRow(r)?1.5:0,c=e&&("2"===i||"4"===i)&&this.isFirstCell(r)?1:0,p=("Right"!==this.parent.getFrozenMode()||"1"!==i&&"3"!==i)&&("Left-Right"!==this.parent.getFrozenMode()||"5"!==i&&"6"!==i)||!this.isFirstCell(r)?0:1;this.parent.enableRtl?(t.style.right=o.right-l.right-c+"px",t.style.width=l.right-a.left+c+1+"px"):(t.style.left=l.left-o.left-c-p+"px",t.style.width=a.right-l.left+c-p+1+"px"),t.style.top=l.top-o.top-d+"px",t.style.height=a.top-l.top>0?a.top-o.top+a.height+1-(l.top-o.top)-h+d+"px":a.height+d-h+1+"px",this.selectDirection+=i}else t.style.display="none"}positionBorders(){this.updateStartEndCells(),this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),"Left-Right"===this.parent.getFrozenMode()&&this.setBorders(this.parent.contentModule.getFrozenRightContent(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4"),"Left-Right"===this.parent.getFrozenMode()&&this.setBorders(this.parent.headerModule.getFrozenRightHeader(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))}applyBothFrozenBorders(e){let t=this.parent.enableRtl;switch(e.length){case 6:this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth="0 0 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth="2px 0 0 0",this.frcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.frhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0";break;case 4:e.includes("1")&&e.includes("2")&&e.includes("3")&&e.includes("4")&&(this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0"),e.includes("2")&&e.includes("4")&&e.includes("5")&&e.includes("6")&&(this.mcBdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.frcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.frhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0");break;case 3:this.bdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.mcBdrElement.style.borderWidth="2p 0 2px 0",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.mhBdrElement.style.borderWidth="2px 0 2px 0",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0");break;case 2:e.includes("1")&&(this.mcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("2")&&(this.bdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("3")&&(this.mhBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.bdrElement.style.borderWidth="0 2px 2px 2px"),e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frhBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.mcBdrElement.style.borderWidth="0 2px 2px 2px"),e.includes("5")&&(this.mcBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("6")&&(this.mhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frcBdrElement.style.borderWidth="0 2px 2px 2px");break;default:this.bdrElement.style.borderWidth="2px",this.mcBdrElement.style.borderWidth="2px",this.frcBdrElement.style.borderWidth="2px",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px",this.mhBdrElement.style.borderWidth="2px",this.frhBdrElement.style.borderWidth="2px")}}applyBorders(e){let t=this.parent.enableRtl;if("Left-Right"===this.parent.getFrozenMode())this.applyBothFrozenBorders(e);else switch(e.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.mcBdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.fhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0",this.mhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px"):(this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0");break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=e.includes("2")?t?"2px 0 2px 2px":"2px 2px 2px 0":"0 2px 2px 2px",this.mcBdrElement.style.borderWidth=e.includes("1")?t?"2px 2px 2px 0":"2px 0 2px 2px":"0 2px 2px 2px",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?"2px 2px 0 2px":t?"2px 0 2px 2px":"2px 2px 2px 0",this.mhBdrElement.style.borderWidth=e.includes("2")?"2px 2px 0 2px":t?"2px 2px 2px 0":"2px 0 2px 2px")):(this.bdrElement.style.borderWidth=e.includes("2")?t?"2px 2px 2px 0":"2px 0 2px 2px":"0 2px 2px 2px",this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=e.includes("1")?t?"2px 0 2px 2px":"2px 2px 2px 0":"0 2px 2px 2px"),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?"2px 2px 0 2px":t?"2px 2px 2px 0":"2px 0 2px 2px",this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=e.includes("2")?"2px 2px 0 2px":t?"2px 0 2px 2px":"2px 2px 2px 0")));break;default:this.bdrElement.style.borderWidth="2px",this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth="2px"),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px",this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth="2px"))}}createBorders(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),"Left-Right"===this.parent.getFrozenMode()&&(this.frcBdrElement=this.parent.contentModule.getFrozenRightContent().appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),"Left-Right"===this.parent.getFrozenMode()&&(this.frhBdrElement=this.parent.headerModule.getFrozenRightHeader().appendChild(Object(n.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))}showHideBorders(e){this.bdrElement&&(this.bdrElement.style.display=e,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.display=e,"Left-Right"===this.parent.getFrozenMode()&&(this.frcBdrElement.style.display=e)),this.parent.frozenRows&&(this.fhBdrElement.style.display=e),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement.style.display=e,"Left-Right"===this.parent.getFrozenMode()&&(this.frhBdrElement.style.display=e)))}drawAFBorders(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()}positionAFBorders(){if(!this.startCell||!this.bdrAFLeft)return;let e=this.startAFCell.getBoundingClientRect(),t=this.endAFCell.getBoundingClientRect(),i=t.top-e.top>0?1:0,s=t.top-e.top>=0&&(mt(this.startAFCell,"e-movablecontent")||mt(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,r=(mt(this.startAFCell,"e-movablecontent")||mt(this.startAFCell,"e-movableheader"))&&this.isFirstCell(this.startAFCell)?1:0,n=this.isLastRow(this.endAFCell)&&(mt(this.endAFCell,"e-movablecontent")||mt(this.endAFCell,"e-frozencontent"))?2:0,l=this.startAFCell.offsetParent.getBoundingClientRect(),a=this.parent.element.getBoundingClientRect(),o=this.startAFCell.offsetParent.parentElement.scrollTop-this.startAFCell.offsetTop,h=this.startAFCell.offsetParent.parentElement.scrollLeft-this.startAFCell.offsetLeft,d=this.parent.element.clientHeight,c=this.parent.element.clientWidth;o=o>0?Math.floor(o)-1:0,h=h>0?h:0;let p=e.left-a.left;if(this.parent.enableRtl){let i=mt(this.startAFCell,"e-movablecontent")||mt(this.startAFCell,"e-movableheader")?e.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-a.left:0;this.bdrAFLeft.style.right=a.right-t.right-2+t.width+"px",this.bdrAFLeft.style.width=c<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=a.right-e.right-r+i-1+"px",this.bdrAFTop.style.left=t.left-a.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-r+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")}else if(this.bdrAFLeft.style.left=p-r+h-1+"px",this.bdrAFRight.style.left=t.left-a.left-2+t.width+"px",this.bdrAFRight.style.width=c<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=p+h-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-r+1+"px",c<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)){let e=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-c;this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-e+"px"}if(this.bdrAFLeft.style.top=e.top-a.top-s+o+"px",this.bdrAFLeft.style.height=t.top-e.top>0?t.top-l.top+t.height+1-(e.top-l.top)+s-n-o+"px":t.height+s-n-o+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-i-1+"px",this.bdrAFBottom.style.width=d<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,d<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)){let e=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-d;this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-e+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px"}}createAFBorders(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(Object(n.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(Object(n.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(Object(n.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(Object(n.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))}showAFBorders(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")}hideAFBorders(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")}updateValue(e,t,i){let s=this.createBeforeAutoFill(e,t,i);if(!s.cancel){let r=this.parent.getColumnByIndex(t);this.parent.editModule&&i&&this.parent.editModule.updateCell(e,r.field,"number"===r.type?parseInt(s.value,10):s.value)}}createBeforeAutoFill(e,t,i){let s={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger("beforeAutoFill",s),s}getAutoFillCells(e,t){let i=".e-cellselectionbackground",s=[].slice.call(this.parent.getDataRows()[e].querySelectorAll(i));return this.parent.isFrozenGrid()&&(s=s.concat([].slice.call(this.parent.getMovableDataRows()[e].querySelectorAll(i))),"Left-Right"===this.parent.getFrozenMode()&&(s=s.concat([].slice.call(this.parent.getFrozenRightDataRows()[e].querySelectorAll(i))))),s}selectLikeAutoFill(e,t){let i=parseInt(mt(this.startAFCell,"e-row").getAttribute("aria-rowindex"),10),s=parseInt(this.startAFCell.getAttribute("aria-colindex"),10),r=parseInt(mt(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),n=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),l=this.selectedRowCellIndexes.length-1,a=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!mt(e.target,"e-rowcell"):this.startAFCell=this.parent.getCellFromIndex(i,s),this.endAFCell=this.parent.getCellFromIndex(i+l,s+a),this.drawAFBorders();break;case this.autoFillRLselection&&s+a<n&&n-s-a+1>r-i-l&&n-s-a+1>i-r:if(this.endAFCell=this.parent.getCellFromIndex(i+l,n),r=parseInt(mt(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),n=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),t){let e=parseInt(this.endCell.getAttribute("aria-colindex"),10);for(let t=i;t<=r;t++){let i=this.getAutoFillCells(t,s),r=0;for(let s=e+1;s<=n;s++)r>a&&(r=0),this.updateValue(t,s,i[r]),r++}this.selectCellsByRange({rowIndex:i,cellIndex:this.startCellIndex},{rowIndex:r,cellIndex:n})}else this.drawAFBorders();break;case this.autoFillRLselection&&s>n&&s-n+1>r-i-l&&s-n+1>i-r:if(this.startAFCell=this.parent.getCellFromIndex(i,n),this.endAFCell=this.endCell,t){for(let e=i;e<=i+l;e++){let t=this.getAutoFillCells(e,s);t.reverse();let i=0;for(let s=this.startCellIndex-1;s>=n;s--)i>a&&(i=0),this.updateValue(e,s,t[i]),i++}this.selectCellsByRange({rowIndex:i,cellIndex:n},{rowIndex:i+l,cellIndex:this.startCellIndex+a})}else this.drawAFBorders();break;case i>r:if(this.startAFCell=this.parent.getCellFromIndex(r,s),this.endAFCell=this.endCell,t){let e=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),t=e;for(let n=i-1;n>=r;n--){t===this.startIndex-1&&(t=e);let i=this.getAutoFillCells(t,s),r=0;t--;for(let e=this.startCellIndex;e<=this.startCellIndex+a;e++)this.updateValue(n,e,i[r]),r++}this.selectCellsByRange({rowIndex:r,cellIndex:s+a},{rowIndex:i+l,cellIndex:s})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(r,s+a),t){let e=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),t=this.startIndex;for(let i=e+1;i<=r;i++){t===e+1&&(t=this.startIndex);let r=this.getAutoFillCells(t,s);t++;let n=0;for(let e=this.startCellIndex;e<=this.startCellIndex+a;e++)this.updateValue(i,e,r[n]),n++}this.selectCellsByRange({rowIndex:e-l,cellIndex:s},{rowIndex:r,cellIndex:s+a})}else this.drawAFBorders()}}mouseUpHandler(e){if(document.body.classList.remove("e-disableuserselect"),this.element&&Object(n.hb)(this.element),this.mUPTarget=this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?mt(e.target,"e-rowcell"):null,this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode){let t=e.target,i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),s=parseInt(t.getAttribute("aria-colindex"),10);this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:i,cellIndex:s})}if(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel){let t=mt(e.target,"e-rowcell");this.endAFCell=t||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1}n.l.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),this.parent.frozenRows&&n.l.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler),n.l.remove(document.body,"mouseup",this.mouseUpHandler)}hideAutoFill(){this.autofill&&(this.autofill.style.display="none")}updateAutoFillPosition(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){let e=parseInt(this.target.getAttribute("aria-colindex"),10),t=parseInt(this.target.getAttribute("index"),10),i=this.getAutoFillCells(this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,e).filter(e=>""===e.style.display),s=this.parent.getColumnByIndex(e),r="movable"===s.getFreezeTableName(),l=t<this.parent.frozenRows,a="Left-Right"===this.parent.getFrozenMode()&&"frozen-right"===s.getFreezeTableName();Object(n.lb)("#"+this.parent.element.id+"_autofill",mt(this.target,"e-table"))||(Object(n.lb)("#"+this.parent.element.id+"_autofill",this.parent.element)&&Object(n.lb)("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=Object(n.F)("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",l?r?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):r?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),a&&(l?this.parent.getFrozenRightHeader().appendChild(this.autofill):this.parent.getFrozenRightContent().appendChild(this.autofill)));let o=i[i.length-1];if(o&&o.offsetParent){let e=o.getBoundingClientRect(),t=o.offsetParent.getBoundingClientRect(),i=this.isLastCell(o)?4:0,s=this.isLastRow(o)?3:0;this.parent.enableRtl?this.autofill.style.right=t.right-e.right+e.width-4-i+"px":this.autofill.style.left=e.left-t.left+e.width-4-i+"px",this.autofill.style.top=e.top-t.top+e.height-5-s+"px"}this.autofill.style.display=""}else this.hideAutoFill()}mouseDownHandler(e){this.mouseButton=e.button;let t,i=e.target,s=this.parent,r=mt(i,"e-grid");if(!(r&&r.id!==s.element.id||mt(i,"e-headercontent")&&!this.parent.frozenRows||mt(i,"e-editedbatchcell")||mt(i,"e-editedrow"))){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),mt(i,"e-rowcell")&&!e.shiftKey&&!e.ctrlKey){if(s.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,t=!0;else if(s.allowRowDragAndDrop&&!s.isEdit){if(!this.isRowType()||this.isSingleSel()||Object(n.C)(i,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);t=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),s.getContent().appendChild(this.element)}t&&this.enableDrag(e,!0)}this.updateStartEndCells(),(i.classList.contains("e-autofill")||i.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}}updateStartEndCells(){let e=[].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground"));this.startCell=e[0],this.endCell=e[e.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(mt(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}updateStartCellsIndex(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(mt(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}enableDrag(e,t){let i=this.parent;if(t){let t=Object(n.C)(e.target,"tr");this.startDIndex=parseInt(t.getAttribute("aria-rowindex"),10),this.startDCellIndex=parseInt(mt(e.target,"e-rowcell").getAttribute("aria-colindex"),10)}document.body.classList.add("e-disableuserselect");let s=i.element.getBoundingClientRect(),r=vt(e);this.x=r.x-s.left,this.y=r.y-s.top,n.l.add(i.getContent(),"mousemove",this.mouseMoveHandler,this),this.parent.frozenRows&&n.l.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this),n.l.add(document.body,"mouseup",this.mouseUpHandler,this)}clearSelAfterRefresh(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType||this.clearSelection()}addEventListener(){this.parent.isDestroyed||(this.parent.on(x,this.enableAfterRender,this),this.parent.on(w,this.initializeSelection,this),this.parent.on("rowselected",this.onActionComplete,this),this.parent.on("cellselected",this.onActionComplete,this),this.parent.on(R,this.onPropertyChanged,this),this.parent.on("cellfocused",this.onCellFocused,this),this.parent.on("beforeFragAppend",this.clearSelAfterRefresh,this),this.parent.on("column-position-changed",this.columnPositionChanged,this),this.parent.on(O,this.initialEnd,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(f,this.actionBeginFunction),this.parent.addEventListener(y,this.actionCompleteFunction),this.parent.on("rows-removed",this.rowsRemoved,this),this.parent.on(E,this.refreshHeader,this),this.addEventListener_checkbox())}removeEventListener(){this.parent.isDestroyed||(this.parent.off(x,this.enableAfterRender),this.parent.off(w,this.initializeSelection),this.parent.off("rowselected",this.onActionComplete),this.parent.off("cellselected",this.onActionComplete),this.parent.off(R,this.onPropertyChanged),this.parent.off("cellfocused",this.onCellFocused),this.parent.off("beforeFragAppend",this.clearSelAfterRefresh),this.parent.off("column-position-changed",this.columnPositionChanged),this.parent.removeEventListener(f,this.actionBeginFunction),this.parent.removeEventListener(y,this.actionCompleteFunction),this.parent.off("rows-removed",this.rowsRemoved),this.parent.off(E,this.refreshHeader),this.removeEventListener_checkbox())}wireEvents(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS&&(n.l.add(this.parent.element,"keydown",this.keyDownHandler,this),n.l.add(this.parent.element,"keyup",this.keyUpHandler,this))}unWireEvents(){this.isMacOS&&(n.l.remove(this.parent.element,"keydown",this.keyDownHandler),n.l.remove(this.parent.element,"keyup",this.keyUpHandler))}columnPositionChanged(){this.parent.isPersistSelection||this.clearSelection()}refreshHeader(){this.setCheckAllState()}rowsRemoved(e){for(let t=0;t<e.records.length;t++)delete this.selectedRowState[e.records[t][this.primaryKey]],--this.totalRecordsCount;this.setCheckAllState()}beforeFragAppend(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()}getCheckAllBox(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.initPerisistSelection())}render(e){n.l.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this),n.l.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let t=this.parent;Object(n.X)(e.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()),Object(n.X)(e.properties.mode)&&Object(n.X)(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.initPerisistSelection(),this.parent.getColumns().filter(e=>"checkbox"===e.type).length&&(t.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode)),this.drawBorders()}hidePopUp(){this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")}initialEnd(e){let t=this.parent.isFrozenGrid(),i="Left-Right"===this.parent.getFrozenMode();(!t||t&&!i&&!e.args.isFrozen||i&&e.args.renderFrozenRightContent)&&(this.parent.off(O,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))}checkBoxSelectionChanged(){this.parent.off(O,this.checkBoxSelectionChanged);let e=this.parent,t=e.getColumns().filter(e=>"checkbox"===e.type);t.length>0&&(e.isCheckBoxSelection=!0,this.chkField=t[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,Object(n.X)(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(e.selectionSettings.type="Multiple",e.dataBind()):this.initPerisistSelection()),e.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())}initPerisistSelection(){let e=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(e.isPersistSelection=!1,this.selectedRowState={})}ensureCheckboxFieldSelection(){let e=this.parent;if(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!e.enableVirtualization&&this.chkField&&(e.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!e.isPersistSelection)){let e=this.parent.getDataModule(),t=(new l.g).where(this.chkField,"equal",!0);t.params||(t.params=this.parent.query.params);let i=e.getData({},t),s=this;this.parent.showSpinner(),i.then(e=>{s.dataSuccess(e.result),s.refreshPersistSelection(),s.parent.hideSpinner()})}}dataSuccess(e){for(let t=0;t<e.length;t++)Object(n.X)(this.selectedRowState[e[t][this.primaryKey]])&&e[t][this.chkField]&&(this.selectedRowState[e[t][this.primaryKey]]=e[t][this.chkField]);this.persistSelectedData=e}setRowSelection(e){if(!this.parent.getDataModule().isRemote()&&!Object(n.W)())if(e)if(this.parent.groupSettings.columns.length)for(let t of this.getData().records)this.selectedRowState[t[this.primaryKey]]=!0;else for(let t of this.getData())this.selectedRowState[t[this.primaryKey]]=!0;else this.selectedRowState={}}getData(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))}refreshPersistSelection(){let e=this.parent.getRows();if(this.parent.isCheckBoxSelection&&this.parent.isFrozenGrid()&&(this.parent.getMovableContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getMovableRows()),"Left-Right"===this.parent.getFrozenMode()&&this.parent.getFrozenRightContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getFrozenRightRows())),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,null!==e&&e.length>0&&(this.parent.isPersistSelection||this.chkField)){let t=[];for(let i=0;i<e.length;i++){let s,r=this.getRowObj(e[i]),l=r&&r.data?r.data[this.primaryKey]:null;if(null===l)return;let a=e[i].querySelector(".e-checkselect");this.selectedRowState[l]||"Check"===this.parent.checkAllRows&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(l)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(l)>0||"Intermediate"===this.parent.checkAllRows&&!Object(n.X)(this.chkField)&&r.data[this.chkField]?(t.push(parseInt(e[i].getAttribute("aria-rowindex"),10)),s=!0):(s=!1,this.checkedTarget!==a&&this.parent.isCheckBoxSelection&&Nt(a.nextElementSibling,s)),this.updatePersistCollection(e[i],s)}this.isSingleSel()&&t.length>0?this.selectRow(t[0],!0):this.selectRows(t)}this.parent.isCheckBoxSelection&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()}actionBegin(e){if("save"===e.requestType&&this.parent.isPersistSelection){let e=this.parent.element.querySelector(".e-edit-checkselect");if(!Object(n.X)(e)){let t=Object(n.C)(e,".e-editedrow");if(t){"Dialog"===this.parent.editSettings.mode&&(t=this.parent.element.querySelector(".e-dlgeditrow"));let i=this.getRowObj(t);if(!i)return;this.selectedRowState[i.data[this.primaryKey]]=i.isSelected=e.checked}else this.isCheckedOnAdd=e.checked}}}actionComplete(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action&&this.isCheckedOnAdd){let t=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[t.data[this.primaryKey]]=t.isSelected=this.isCheckedOnAdd}this.refreshPersistSelection()}if("delete"===e.requestType&&this.parent.isPersistSelection){let t=[];t=Object(n.W)()?this.getSelectedRecords():e.data;let i=t.slice();for(let e=0;e<i.length;e++)Object(n.X)(i[e][this.primaryKey])||this.updatePersistDelete(i[e][this.primaryKey]);this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}"paging"===e.requestType&&(this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0)}onDataBound(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.refreshPersistSelection(),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isCheckBoxSelection&&!this.initialRowSelection){let e=this.parent.getRowsObject(),t=[];for(let i=0;i<e.length;i++)e[i].isSelected&&t.push(i);t.length&&this.selectRows(t),this.initialRowSelection=!0}}updatePersistSelectedData(e){if(this.parent.isPersistSelection){let t=this.parent.getRows();for(let i=0;i<t.length;i++)this.updatePersistCollection(t[i],e);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||Object(n.W)()?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}}checkSelectAllAction(e){let t=this.getRenderer(),i=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),e&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(e),Object(n.W)()&&this.parent.enableVirtualization&&!Object(n.X)(this.parent.contentModule.currentInfo.endIndex)?this.selectRowsByRange(this.parent.contentModule.currentInfo.startIndex,this.parent.contentModule.currentInfo.endIndex):this.selectRowsByRange(t.getVirtualRowIndex(0),t.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(e),this.clearSelection()),this.chkAllCollec=[],!Object(n.X)(i)){let t=i.querySelector(".e-edit-checkselect");Object(n.X)(t)||Nt(t.nextElementSibling,e)}}checkSelectAll(e){let t=this.getCheckAllStatus(e),i="Check"===t;if(this.isHeaderCheckboxClicked=!0,"Intermediate"===t&&(i=this.getCurrentBatchRecordChanges().some(e=>e[this.primaryKey]in this.selectedRowState)),this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!i),Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&(this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!i,"checkbox",null),this.checkBoxState=!i,!i)){let e=this.parent.contentModule.vgenerator.rowCache;Object.values(e).forEach(e=>e.isSelected=!0);for(let t=0;t<Object.keys(e).length;t++)-1===this.parent.selectionModule.selectedRowIndexes.indexOf(Number(Object.keys(e)[t]))&&this.parent.selectionModule.selectedRowIndexes.push(Number(Object.keys(e)[t]))}this.target=null,this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState(),this.triggerChkChangeEvent(e,!i)}getCheckAllStatus(e){let t,i=e?e.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t=i.contains("e-check")?"Check":i.contains("e-uncheck")?"Uncheck":i.contains("e-stop")?"Intermediate":"None",t}checkSelect(e){let t=Object(n.C)(this.checkedTarget,".e-rowcell"),i=this.parent;this.isMultiCtrlRequest=!0;let s=0;if(this.isHeaderCheckboxClicked=!1,Yt(i)){let e=t.parentElement.getAttribute("data-uid");s=i.getRows().map(e=>e.getAttribute("data-uid")).indexOf(e)}else s=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&"Top"===this.parent.editSettings.newRowPosition&&++s,this.rowCellSelectionHandler(s,parseInt(t.getAttribute("aria-colindex"),10)),this.moveIntoUncheckCollection(Object(n.C)(t,".e-row")),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(e,e.nextElementSibling.classList.contains("e-check"))}moveIntoUncheckCollection(e){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){let t=this.getRowObj(e),i=t&&t.data?t.data[this.primaryKey]:null;if(!i)return;this.chkAllCollec.indexOf(i)<0?this.chkAllCollec.push(i):this.chkAllCollec.splice(this.chkAllCollec.indexOf(i),1)}}triggerChkChangeEvent(e,t){this.parent.trigger("checkBoxChange",{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:e}),this.parent.isEdit||(this.checkedTarget=null)}updateSelectedRowIndex(e){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.getDataModule().isRemote()&&(!Object(n.W)()||!this.parent.isServerRendered))if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];let e=this.getData().length;for(let t=0;t<e;t++)this.selectedRowIndexes.push(t)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else if(e&&"false"===this.parent.getRowByIndex(e).getAttribute("aria-selected")){let t=this.selectedRowIndexes.indexOf(e);this.selectedRowIndexes.splice(t,1)}}setCheckAllState(e,t){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){let i,s=Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization;if(s){let e="values",t="vgenerator";i=!Object[e](this.parent.contentModule[t].rowCache).filter(e=>void 0===e.isSelected||!1===e.isSelected).length&&Object[e](this.parent.contentModule[t].rowCache).filter(e=>e.isSelected).length===this.selectedRowIndexes.length}let r=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||s||(r=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length);let l=this.getCheckAllBox();if(l){let a=l.nextElementSibling;Object(n.ib)([a],["e-check","e-stop","e-uncheck"]),Vt(l,!1),l.indeterminate=!1,i||r===this.totalRecordsCount&&this.totalRecordsCount||!(!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||Object(n.W)()&&this.parent.isServerRendered||r!==this.getData().length)?(Object(n.v)([a],["e-check"]),Vt(l,!0),t&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):s&&!this.selectedRowIndexes.length||0===r&&!s||0===this.getCurrentBatchRecordChanges().length?(Object(n.v)([a],["e-uncheck"]),t&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck",0===r&&0===this.getCurrentBatchRecordChanges().length?Object(n.v)([a.parentElement],["e-checkbox-disabled"]):Object(n.ib)([a.parentElement],["e-checkbox-disabled"])):(Object(n.v)([a],["e-stop"]),this.parent.checkAllRows="Intermediate",l.indeterminate=!0),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||this.updateSelectedRowIndex(e)}}}keyDownHandler(e){(("chrome"===n.d.info.name||"safari"===n.d.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===n.d.info.name&&17===e.keyCode||"mozilla"===n.d.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0)}keyUpHandler(e){(("chrome"===n.d.info.name||"safari"===n.d.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===n.d.info.name&&17===e.keyCode||"mozilla"===n.d.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!1)}clickHandler(e){let t=e.target;this.actualTarget=t,(mt(t,"e-row")||mt(t,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&t.classList.contains("e-headercell"))&&(this.isInteracted=!0),this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.isMultiShiftRequest=e.shiftKey,this.popUpClickHandler(e);let i,s=!1;this.preventFocus=!0;let r=mt(t,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!!(r&&r.querySelectorAll(".e-checkselectall")||this.selectionSettings.persistSelection&&mt(t,"e-row")),r&&r.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(i=r.querySelector('input[type="checkbox"]'),s=!0),this.drawBorders(),this.updateAutoFillPosition(),t=mt(t,"e-rowcell"),t&&t.parentElement.classList.contains("e-row")&&!this.parent.selectionSettings.checkboxOnly||s){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=t,Object(n.X)(i)){let i=this.parent,s=0;if(Yt(i)){let e=t.parentElement.getAttribute("data-uid");s=i.getRows().map(e=>e.getAttribute("data-uid")).indexOf(e)}else s=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&++s,this.mUPTarget&&this.mUPTarget.isEqualNode(t)||this.rowCellSelectionHandler(s,parseInt(t.getAttribute("aria-colindex"),10)),this.parent.hoverFrozenRows(e),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(Object(n.C)(t,".e-row")),this.setCheckAllState())}else this.checkedTarget=i,i.classList.contains("e-checkselectall")?this.checkSelectAll(i):this.checkSelect(i);this.parent.isCheckBoxSelection||!n.d.isDevice||this.isSingleSel()||this.showPopup(e)}else if(e.target.classList.contains("e-headercell")&&!e.target.classList.contains("e-stackedheadercell")){let t=e.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");this.headerSelectionHandler(this.parent.getColumnIndexByUid(t))}this.isMultiCtrlRequest=!1,this.isMultiShiftRequest=!1,Object(n.X)(Object(n.C)(e.target,".e-unboundcell"))&&(this.preventFocus=!1)}popUpClickHandler(e){let t=e.target;Object(n.C)(t,".e-headercell")||e.target.classList.contains("e-rowcell")||Object(n.C)(t,".e-gridpopup")?t.classList.contains("e-rowselect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}showPopup(e){this.selectionSettings.enableSimpleMultiRowSelection||ut(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))}rowCellSelectionHandler(e,t){if(!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel())this.isDragged||this.selectRow(e,this.selectionSettings.enableToggle),this.selectCell({rowIndex:e,cellIndex:t},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders();else if(this.isMultiShiftRequest)this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!Object(n.C)(this.target,".e-rowcell").classList.contains("e-gridchkbox")?this.selectRowsByRange(Object(n.ab)(this.prevRowIndex)?e:this.prevRowIndex,e):this.addRowsToSelection([e]),this.selectCellsByRange(Object(n.ab)(this.prevCIdxs)?{rowIndex:e,cellIndex:t}:this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.updateAutoFillPosition(),this.drawBorders();else{if(this.addRowsToSelection([e]),Object(n.W)()&&this.parent.enableVirtualization&&this.parent.isServerRendered){let e=this.parent.getSelectedRowIndexes();this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",e)}this.addCellsToSelection([{rowIndex:e,cellIndex:t}]),this.showHideBorders("none")}this.isDragged=!1}onCellFocused(e){if(this.parent.frozenRows&&e.container.isHeader&&e.byKey)if("upArrow"===e.keyArgs.action)e.isJump=this.parent.allowFiltering?"INPUT"===e.element.tagName:"TH"===e.element.tagName;else if("downArrow"===e.keyArgs.action){let t=Number(e.element.parentElement.getAttribute("aria-rowindex"));e.isJump=0===t}else"ctrlHome"===e.keyArgs.action&&(e.isJump=!0);let t=this.parent.isFrozenGrid()?(e.container.isHeader&&"TD"!==e.element.tagName&&e.isJump&&!this.selectionSettings.allowColumnSelection||(e.container.isContent||"TD"===e.element.tagName)&&!(e.container.isSelectable||"TD"===e.element.tagName))&&!(e.byKey&&"space"===e.keyArgs.action):(e.container.isHeader&&e.isJump||e.container.isContent&&!e.container.isSelectable)&&!(e.byKey&&"space"===e.keyArgs.action)&&!(e.element.classList.contains("e-detailrowexpand")||e.element.classList.contains("e-detailrowcollapse")),i=e.container.isHeader&&"TD"!==e.element.tagName&&!Object(n.C)(e.element,".e-rowcell")&&!(e.byKey&&"space"===e.keyArgs.action);if(!e.byKey||t)return void(t&&!this.parent.isCheckBoxSelection&&this.clearSelection());let[s,r]=e.container.isContent?e.container.indexes:e.indexes,l=this.focus.getPrevIndexes();if(this.parent.frozenRows)if(e.container.isHeader&&("TD"===e.element.tagName||Object(n.C)(e.element,".e-rowcell"))){let e=this.parent.getHeaderTable().querySelector("thead").childElementCount;s-=e,l.rowIndex=Object(n.X)(l.rowIndex)?null:l.rowIndex-e}else s+=this.parent.frozenRows,l.rowIndex=0!==l.rowIndex&&Object(n.X)(l.rowIndex)?null:l.rowIndex+this.parent.frozenRows;if(this.parent.isFrozenGrid()){let t=Number(e.element.getAttribute("aria-colindex")),i=this.parent.getSelectedRowCellIndexes();i.length&&0===l.cellIndex&&(l.cellIndex=i[i.length-1].cellIndexes[0]),l.cellIndex=Object(n.X)(l.cellIndex)?null:l.cellIndex===r?t:t-1,r=t}if((i||-1===["ctrlPlusA","escape"].indexOf(e.keyArgs.action)&&"space"!==e.keyArgs.action&&s===l.rowIndex&&r===l.cellIndex)&&!this.selectionSettings.allowColumnSelection)return;this.preventFocus=!0;let a=this.getKeyColIndex(e);switch(this.needColumnSelection&&(r=a),e.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=e.element,this.applyDownUpKey(s,r);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(s,r);break;case"shiftDown":case"shiftUp":this.shiftDownKey(s,r);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(s,r);break;case"home":case"end":r="end"===e.keyArgs.action?this.getLastColIndex(s):0,this.applyHomeEndKey(s,r);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(s,r);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(e.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(s)}this.needColumnSelection=!1,this.preventFocus=!1,this.positionBorders(),this.updateAutoFillPosition()}getKeyColIndex(e){let t,i=null,s=e.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&mt(e.element,"e-columnheader"))if(this.needColumnSelection=!!e.container.isHeader,s){if("rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)return i;t=s.getAttribute("e-mappinguid");let r=this.getstackedColumns(this.parent.getColumnByUid(t).columns),n=this.parent.getColumnIndexByUid(r[r.length-1].uid),l=this.parent.getColumnIndexByUid(r[0].uid);i=this.prevColIndex>=n?l:n}else i=this.parent.getColumnIndexByUid(e.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return i}ctrlPlusA(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})}applySpaceSelection(e){e.classList.contains("e-checkselectall")?(this.checkedTarget=e,this.checkSelectAll(this.checkedTarget)):e.classList.contains("e-checkselect")&&(this.checkedTarget=e,this.checkSelect(this.checkedTarget))}applyDownUpKey(e,t){let i=this.parent;this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&!this.selectionSettings.persistSelection&&(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&(this.selectRow(e,!0),this.applyUpDown(i.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0),this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)}applyUpDown(e){if(e<0)return;this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);let t=parseInt(this.target.getAttribute("aria-colindex"),10),i=this.parent.getFrozenColumns();this.target=i&&t>=i?this.contentRenderer.getMovableRowByIndex(e).querySelectorAll(".e-rowcell")[t-i]:this.contentRenderer.getRowByIndex(e).querySelectorAll(".e-rowcell")[t],this.addAttribute(this.target)}applyRightLeftKey(e,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:e,cellIndex:t},!0),this.addAttribute(this.target))}applyHomeEndKey(e,t){this.isCellType()?this.selectCell({rowIndex:e,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(e,t))}shiftDownKey(e,t){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&(Object(n.ab)(this.prevRowIndex)?this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,e),this.applyUpDown(e))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1}applyShiftLeftRightKey(e,t){this.isMultiShiftRequest=!0,this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1}getstackedColumns(e){let t=[];for(let i=0,s=e.length;i<s;i++)e[i].columns?this.getstackedColumns(e[i].columns):t.push(e[i]);return t}applyCtrlHomeEndKey(e,t){this.isRowType()&&(this.selectRow(e,!0),this.addAttribute(this.parent.getCellFromIndex(e,t))),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0)}addRemoveClassesForRow(e,t,i,...s){if(e){let i=[].slice.call(e.querySelectorAll(".e-rowcell")),r=e.querySelector(".e-detailrowcollapse")||e.querySelector(".e-detailrowexpand"),n=e.querySelector(".e-rowdragdrop");r&&i.push(r),n&&i.push(n),Lt(i,t,...s)}this.getRenderer().setSelection(e?e.getAttribute("data-uid"):null,t,i)}isRowType(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}isCellType(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}isSingleSel(){return"Single"===this.selectionSettings.type}getRenderer(){return Object(n.X)(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(L.Content)),this.contentRenderer}getSelectedRecords(){let e=[];return e=this.selectionSettings.persistSelection?this.persistSelectedData:this.parent.getRowsObject().filter(e=>e.isSelected).map(e=>e.data),e}selectColumn(e){let t=this.parent;if(Object(n.X)(t.getColumns()[e]))return;let i=t.getColumnByIndex(e),s=t.getColumnHeaderByUid(i.uid),r=s.classList.contains("e-columnselection");if(!t.selectionSettings.allowColumnSelection)return;let l=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(e)>-1;if(this.clearColDependency(),!r||!this.selectionSettings.enableToggle||l){let n={columnIndex:e,headerCell:s,column:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(n,"columnSelecting"),n.cancel)return void this.disableInteracted();t.selectionSettings.enableToggle&&e===this.prevColIndex&&r&&!l||this.updateColSelection(s,e),this.onActionComplete({columnIndex:e,headerCell:s,column:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex},"columnSelected")}this.updateColProps(e)}selectColumnsByRange(e,t){let i=this.parent;if(Object(n.X)(i.getColumns()[e]))return;let s=[];if("Single"===i.selectionSettings.type||Object(n.X)(t))s[0]=e;else{let i=e<t;for(let r=e;i?r<=t:r>=t;i?r++:r--)s.push(r)}this.selectColumns(s)}selectColumns(e){let t=this.parent,i=this.getselectedCols();if("Single"===t.selectionSettings.type&&(e=[e[0]]),!t.selectionSettings.allowColumnSelection)return;this.clearColDependency();let s={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(s,"columnSelecting"),s.cancel)return void this.disableInteracted();for(let n=0,l=e.length;n<l;n++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(e[n]).uid),e[n]);i=this.getselectedCols();let r={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(r,"columnSelected"),this.updateColProps(e[0])}selectColumnWithExisting(e){let t=this.parent;if(Object(n.X)(t.getColumns()[e]))return;let i=t.getFrozenColumns(),s=i&&e>=i,r=t.getColumnHeaderByUid(t.getColumnByIndex(e).uid),l=this.getselectedCols();if("Single"===t.selectionSettings.type&&this.clearColDependency(),t.selectionSettings.allowColumnSelection){if(s?t.getMovableRows():t.getDataRows(),this.selectedColumnsIndexes.indexOf(e)>-1)this.clearColumnSelection(e);else{let i={columnIndex:e,headerCell:l,columnIndexes:this.selectedColumnsIndexes,column:t.getColumnByIndex(e),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(i,"columnSelecting"),i.cancel)return void this.disableInteracted();this.updateColSelection(r,e),l=this.getselectedCols();let s={columnIndex:e,headerCell:l,column:t.getColumnByIndex(e),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(s,"columnSelected")}this.updateColProps(e)}}clearColumnSelection(e){if(this.isColumnSelected){let t=this.parent;if(!Object(n.X)(e)&&-1===this.selectedColumnsIndexes.indexOf(e))return;let i,s=Object(n.X)(e)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:e,r=t.getColumnByIndex(s),l=t.getColumnByIndex(s);i="frozen-right"===r.getFreezeTableName()?t.getFrozenRightColumnHeaderByIndex(s):"movable"===r.getFreezeTableName()?t.getMovableColumnHeaderByIndex(s):t.getColumnHeaderByUid(l.uid);let a={columnIndex:s,headerCell:i,columnIndexes:this.selectedColumnsIndexes,column:l,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(a,"columnDeselecting"))return void this.disableInteracted();let o=Object(n.X)(e)?[].slice.call(t.getHeaderContent().querySelectorAll(".e-columnselection")):[i],h=this.getSelectedColumnCells(e);for(let e=0,n=o.length;e<n;e++)Lt([o[e]],!1,"e-columnselection");for(let e=0,n=h.length;e<n;e++)Lt([h[e]],!1,"e-columnselection");Object(n.X)(e)?(this.columnDeselect(a,"columnDeselected"),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter(e=>e.isSelected=!1)):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(e),1),this.parent.getColumns()[e].isSelected=!1)}}getselectedCols(){let e,t=this.parent;if(this.selectedColumnsIndexes.length>1){e=[];for(let i=0;i<this.selectedColumnsIndexes.length;i++)e.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[i]).uid))}else e=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return e}getSelectedColumnCells(e){let t,i,s=this.parent,r=!Object(n.X)(this.parent.rowTemplate),l=r?s.getRows():s.getDataRows();s.isFrozenGrid()&&s.getContent().querySelector(".e-movablecontent")&&(t=r?s.getMovableRows():s.getMovableDataRows(),l=s.addMovableRows(l,t),"Left-Right"===s.getFrozenMode()&&(i=r?s.getFrozenRightRows():s.getFrozenRightDataRows(),l=s.addMovableRows(l,i)));let a=[],o=Object(n.X)(e)?".e-columnselection":'[aria-colindex="'+e+'"]';for(let n=0,h=l.length;n<h;n++)a=a.concat([].slice.call(l[n].querySelectorAll(o)));return a}columnDeselect(e,t){return"columnDeselected"===t&&delete e.cancel,this.onActionComplete(e,t),e.cancel}updateColProps(e){this.prevColIndex=e,this.isColumnSelected=this.selectedColumnsIndexes.length&&!0}clearColDependency(){this.clearColumnSelection(),this.selectedColumnsIndexes=[]}updateColSelection(e,t){if(Object(n.X)(this.parent.getColumns()[t]))return;let i,s=this.parent.getFrozenLeftCount(),r=this.parent.getMovableColumnsCount(),l=this.parent.getColumnByIndex(t),a=!Object(n.X)(this.parent.rowTemplate);this.selectedColumnsIndexes.push(t),this.parent.getColumns()[t].isSelected=!0,"frozen-right"===l.getFreezeTableName()?(t-=s+r,i=a?this.parent.getFrozenRightRows():this.parent.getFrozenRightDataRows()):"movable"===l.getFreezeTableName()?(t-=s,i=a?this.parent.getMovableRows():this.parent.getMovableDataRows()):(t+=this.parent.getIndentCount(),i=a?this.parent.getRows():this.parent.getDataRows()),Lt([e],!0,"e-columnselection");for(let o=0,h=i.length;o<h;o++)i[o].classList.contains("e-row")&&(!i[o].classList.contains("e-editedrow")&&!i[o].classList.contains("e-addedrow")||"Normal"!==this.parent.editSettings.mode||Object(n.X)(i[o].querySelector("tr").childNodes[t])?Object(n.X)(i[o].childNodes[t])||Lt([i[o].childNodes[t]],!0,"e-columnselection"):Lt([i[o].querySelector("tr").childNodes[t]],!0,"e-columnselection"))}headerSelectionHandler(e){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(e):this.isMultiShiftRequest?this.selectColumnsByRange(Object(n.ab)(this.prevColIndex)?e:this.prevColIndex,e):this.selectColumnWithExisting(e)}addEventListener_checkbox(){this.parent.on(S,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(C,this.onDataBoundFunction),this.parent.on(O,this.checkBoxSelectionChanged,this),this.parent.on("before-refresh-on-data-change",this.initPerisistSelection,this),this.parent.on(j,this.setCheckAllForEmptyGrid,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(y,this.actionCompleteFunc),this.parent.on(M,this.clickHandler,this),this.resizeEndFn=()=>{this.updateAutoFillPosition(),this.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener("resizeStop",this.resizeEndFn)}removeEventListener_checkbox(){this.parent.off(S,this.dataReady),this.parent.removeEventListener(C,this.onDataBoundFunction),this.parent.removeEventListener(y,this.actionCompleteFunc),this.parent.off(j,this.setCheckAllForEmptyGrid),this.parent.off(M,this.clickHandler),this.parent.off("before-refresh-on-data-change",this.initPerisistSelection)}setCheckAllForEmptyGrid(){let e=this.getCheckAllBox();if(e){this.parent.isCheckBoxSelection=!0;let t=e.nextElementSibling;Object(n.ib)([t],["e-check","e-stop","e-uncheck"])}}dataReady(e){this.isHeaderCheckboxClicked=!1,"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)}actionCompleteHandler(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()}selectRowIndex(e){this.parent.isSelectedRowIndexUpdating=!0,this.parent.selectedRowIndex=e}disableInteracted(){this.isInteracted=!1}activeTarget(){this.actualTarget=this.isInteracted?this.actualTarget:null}}class Ee{constructor(e){this.parent=e,this.addEventListener()}search(e){let t=this.parent;e=Object(n.X)(e)?"":e,kt(t)?t.notify(z,{instance:this,handler:this.search,arg1:e}):e!==t.searchSettings.key?(t.searchSettings.key=e.toString(),t.dataBind()):this.refreshSearch&&t.refresh()}addEventListener(){this.parent.isDestroyed||(this.parent.on(R,this.onPropertyChanged,this),this.parent.on("searching-complete",this.onSearchComplete,this),this.parent.on(F,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(y,this.actionCompleteFunc),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(R,this.onPropertyChanged),this.parent.off("searching-complete",this.onSearchComplete),this.parent.off(F,this.destroy),this.parent.removeEventListener(y,this.actionCompleteFunc),this.parent.off("cancel-Begin",this.cancelBeginEvent))}destroy(){this.removeEventListener()}onPropertyChanged(e){e.module===this.getModuleName()&&(Object(n.X)(e.properties.key)?this.parent.notify(D,{requestType:"searching",type:f}):this.parent.notify(D,{requestType:"searching",type:f,searchString:this.parent.searchSettings.key}))}onSearchComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(y,Object(n.K)(e,{searchString:this.parent.searchSettings.key,requestType:"searching",type:y}))}onActionComplete(e){this.refreshSearch="searching"!==e.requestType}cancelBeginEvent(e){"searching"===e.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)}getModuleName(){return"search"}}class Ie{constructor(e){this.parent=e}show(e,t){let i=this.getToggleFields(e),s=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(let r=0;r<s.length;r++)s[r].visible=!0;this.setVisible(s)}hide(e,t){let i=this.getToggleFields(e),s=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(let r=0;r<s.length;r++)s[r].visible=!1;this.setVisible(s)}getToggleFields(e){let t=[];return t="string"==typeof e?[e]:e,t}getColumns(e,t){return lt(e,(e,i)=>lt(this.parent.columnModel,(i,s)=>{if(i[t]===e)return i})[0])}setVisible(e,t=[]){t=t.length>0?t:Object(n.W)()?JSON.parse(JSON.stringify(e)):e,this.parent.trigger(f,{requestType:"columnstate",cancel:!1,columns:t},i=>{let s=this.parent.getColumns();if(e=Object(n.X)(e)?s:e,i.cancel)return this.parent.notify("reset-columns",{showHideArgs:i}),void(e.length>0&&(e[0].visible=!0));Yt(this.parent)&&this.parent.contentModule.emptyVcRows(),this.parent.allowSelection&&this.parent.getSelectedRecords().length&&this.parent.clearSelection(),this.parent.enableColumnVirtualization?e.filter(e=>s.some(t=>e.field===t.field)).length&&this.parent.notify("column-visible-changed",e):this.parent.notify("column-visible-changed",e),this.parent.trigger(y,{requestType:"columnstate",columns:t}),"All"!==this.parent.columnQueryMode&&this.parent.refresh()})}}class Me{constructor(e){this.lastScrollTop=0,this.previousValues={top:0,left:0},this.oneTimeReady=!0,this.parent=e,this.widthService=new ge(e),this.addEventListener()}getModuleName(){return"scroll"}setWidth(e){this.parent.element.style.width=Object(n.L)(this.parent.width),e&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element&&this.parent.toolbarModule.toolbar.refreshOverflow()}setHeight(){let e=0,t=this.parent.getContent().querySelector(".e-content"),i=this.parent.height;if(this.parent.isFrozenGrid()&&"auto"!==this.parent.height&&this.parent.height.toString().indexOf("%")<0&&(i=parseInt(i,10)-Me.getScrollBarWidth()),!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height){let s=this.parent.getHeaderContent().querySelector("tbody");e=s?s.offsetHeight:0,s&&e&&(e-=s.querySelectorAll(".e-addedrow").length*this.parent.getRowHeight()),t.style.height=Object(n.L)(i-e)}else t.style.height=Object(n.L)(i);this.ensureOverflow(t)}setPadding(){let e=this.parent.getHeaderContent(),t=Me.getScrollBarWidth()-this.getThreshold(),i=this.getCssProperties(),s="Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?"0.5px":"1px";e.querySelector(".e-headercontent").style[i.border]=t>0?s:"0px",e.style[i.padding]=t>0?t+"px":"0px"}removePadding(e){let t=this.getCssProperties(e),i=this.parent.getHeaderContent().querySelector(".e-headercontent");i.style[t.border]="",i.parentElement.style[t.padding]="";let s=this.parent.getFooterContent();s&&s.classList.contains("e-footerpadding")&&s.classList.remove("e-footerpadding")}refresh(){if("100%"!==this.parent.height)return;let e=this.parent.getContent();this.parent.element.style.height="100%";let t=this.widthService.getSiblingsHeight(e);e.style.height="calc(100% - "+t+"px)",this.parent.isFrozenGrid()&&(e.firstElementChild.style.height="calc(100% - "+Et()+"px)")}getThreshold(){return"mozilla"===n.d.info.name?.5:1}addEventListener(){this.parent.isDestroyed||(this.parent.on(j,this.wireEvents,this),this.parent.on(O,this.wireEvents,this),this.parent.on(x,this.onPropertyChanged,this),this.parent.on("textWrapRefresh",this.wireEvents,this),this.parent.on(E,this.setScrollLeft,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(j,this.wireEvents),this.parent.off(O,this.wireEvents),this.parent.off(x,this.onPropertyChanged),this.parent.off("textWrapRefresh",this.wireEvents),this.parent.off(E,this.setScrollLeft))}setScrollLeft(){this.parent.isFrozenGrid()?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector(".e-headercontent").scrollLeft=this.previousValues.left}onFrozenContentScroll(){return e=>{null===this.content.querySelector("tbody")||this.parent.isPreventScrollEvent||(!Object(n.X)(this.parent.infiniteScrollModule)&&this.parent.enableInfiniteScrolling&&this.parent.notify("infinite-scroll-handler",e),this.previousValues.top=e.target.scrollTop)}}onContentScroll(e){let t=e,i=t.classList.contains("e-headercontent");return e=>{if(null===this.content.querySelector("tbody")||this.parent.isPreventScrollEvent)return;if(!Object(n.X)(this.parent.infiniteScrollModule)&&this.parent.enableInfiniteScrolling&&this.parent.notify("infinite-scroll-handler",e),this.parent.groupSettings.columns.length&&this.parent.groupSettings.enableLazyLoading){let e=this.previousValues.top<this.parent.getContent().firstElementChild.scrollTop;this.parent.notify("lazy-load-scroll-handler",{scrollDown:e})}this.parent.notify("virtual-scroll-edit",{});let s=e.target,r=s.scrollLeft,l=s.classList.contains("e-summarycontent");this.previousValues.left!==r?(this.parent.notify("close-filter-dialog",e),t.scrollLeft=r,l&&(this.header.scrollLeft=r),this.previousValues.left=r,this.parent.notify("scroll",{left:r})):this.previousValues.top=i?s.scrollTop:this.previousValues.top}}onCustomScrollbarScroll(e,t){let i=e,s=t;return e=>{if(null===this.content.querySelector("tbody"))return;let t=e.target.scrollLeft;this.previousValues.left!==t&&(i.scrollLeft=t,s.scrollLeft=t,this.previousValues.left=t,this.parent.notify("scroll",{left:t}))}}onTouchScroll(e){let t=e;return e=>{if("mouse"===e.pointerType)return;let i=this.parent.isFrozenGrid(),s=this.getPointXY(e),r=t.scrollLeft+(this.pageXY.x-s.x),n=i?this.parent.getHeaderContent().querySelector(".e-movableheader"):this.parent.getHeaderContent().querySelector(".e-headercontent"),l=i?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().querySelector(".e-content");this.previousValues.left===r||r<0||n.scrollWidth-n.clientWidth<r||(e.preventDefault(),n.scrollLeft=r,l.scrollLeft=r,i&&(this.parent.getContent().querySelector(".e-movablescrollbar").scrollLeft=r),this.pageXY.x=s.x,this.previousValues.left=r)}}setPageXY(){return e=>{"mouse"!==e.pointerType&&(this.pageXY=this.getPointXY(e))}}getPointXY(e){let t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t}wireEvents(){if(this.oneTimeReady){let e=this.parent.isFrozenGrid();this.content=this.parent.getContent().querySelector(".e-content"),this.header=this.parent.getHeaderContent().querySelector(".e-headercontent");let t=this.content.querySelector(".e-movablecontent"),i=(this.content.querySelector(".e-frozencontent"),this.header.querySelector(".e-movableheader")),s=this.parent.getContent().querySelector(".e-movablescrollbar");this.parent.frozenRows&&(n.l.add(e?i:this.header,"touchstart pointerdown",this.setPageXY(),this),n.l.add(e?i:this.header,"touchmove pointermove",this.onTouchScroll(e?t:this.content),this)),this.parent.isFrozenGrid()?(n.l.add(s,"scroll",this.onCustomScrollbarScroll(t,i),this),n.l.add(t,"scroll",this.onCustomScrollbarScroll(s,i),this),n.l.add(i,"scroll",this.onCustomScrollbarScroll(s,t),this),n.l.add(this.content,"scroll",this.onFrozenContentScroll(),this),n.l.add(i,"touchstart pointerdown",this.setPageXY(),this),n.l.add(i,"touchmove pointermove",this.onTouchScroll(t),this),n.l.add(t,"touchstart pointerdown",this.setPageXY(),this),n.l.add(t,"touchmove pointermove",this.onTouchScroll(i),this)):(n.l.add(this.content,"scroll",this.onContentScroll(this.header),this),n.l.add(this.header,"scroll",this.onContentScroll(this.content),this)),this.parent.aggregates.length&&n.l.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this),this.refresh(),this.oneTimeReady=!1}let e,t,i,s=this.parent.getContentTable();et(()=>{e=this.header.scrollLeft,t=s.scrollHeight,i=this.parent.getContent().clientHeight},()=>{let r={cancel:!1};this.parent.notify("check-scroll-reset",r),this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(t<i&&(Object(n.v)(s.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.isFrozenGrid()&&Object(n.v)(this.parent.getContent().querySelector(".e-movablecontent").querySelectorAll("tr:last-child td"),"e-lastrowcell")),r.cancel||((this.parent.frozenRows>0||this.parent.isFrozenGrid())&&this.header.querySelector(".e-movableheader")?this.header.querySelector(".e-movableheader").scrollLeft=this.previousValues.left:this.header.scrollLeft=this.previousValues.left,this.content.scrollLeft=this.previousValues.left,this.content.scrollTop=this.previousValues.top)),this.parent.enableColumnVirtualization||(this.content.scrollLeft=e),this.parent.isFrozenGrid()&&this.header.querySelector(".e-movableheader")&&(this.header.querySelector(".e-movableheader").scrollLeft=this.content.querySelector(".e-movablecontent").scrollLeft)}),this.parent.isPreventScrollEvent=!1}getCssProperties(e){let t={},i=Object(n.X)(e)?this.parent.enableRtl:e;return t.border=i?"borderLeftWidth":"borderRightWidth",t.padding=i?"paddingLeft":"paddingRight",t}ensureOverflow(e){e.style.overflowY="auto"===this.parent.height?"auto":"scroll"}onPropertyChanged(e){e.module===this.getModuleName()&&(this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight(),this.setWidth(!Object(n.X)(e.properties.width)))}destroy(){let e=this.parent.element;if(!e||!e.querySelector(".e-gridheader")&&!e.querySelector(".e-gridcontent"))return;this.removeEventListener(),this.removePadding();let t=this.parent.getContent().querySelector(".e-content");Object(n.ib)([this.parent.getHeaderContent().querySelector(".e-headercontent")],"e-headercontent"),Object(n.ib)([t],"e-content"),t.style.height="",this.parent.element.style.width="",n.l.remove(t,"scroll",this.onContentScroll)}static getScrollBarWidth(){return Et()}}var Fe=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};let Te=(()=>{class e extends n.e{constructor(){super(...arguments),this.templateFn={}}setFormatter(e){this.formatFn=e}getFormatter(){return this.formatFn}setTemplate(e={}){void 0!==this.footerTemplate&&(this.templateFn[Object(n.P)(A,A.Summary)]={fn:Object(n.E)(this.footerTemplate,e),property:"footerTemplate"}),void 0!==this.groupFooterTemplate&&(this.templateFn[Object(n.P)(A,A.GroupSummary)]={fn:Object(n.E)(this.groupFooterTemplate,e),property:"groupFooterTemplate"}),void 0!==this.groupCaptionTemplate&&(this.templateFn[Object(n.P)(A,A.CaptionSummary)]={fn:Object(n.E)(this.groupCaptionTemplate,e),property:"groupCaptionTemplate"})}getTemplate(e){return this.templateFn[Object(n.P)(A,e)]}setPropertiesSilent(e){this.setProperties(e,!0)}}return Fe([Object(n.s)()],e.prototype,"type",void 0),Fe([Object(n.s)()],e.prototype,"field",void 0),Fe([Object(n.s)()],e.prototype,"columnName",void 0),Fe([Object(n.s)()],e.prototype,"format",void 0),Fe([Object(n.s)()],e.prototype,"footerTemplate",void 0),Fe([Object(n.s)()],e.prototype,"groupFooterTemplate",void 0),Fe([Object(n.s)()],e.prototype,"groupCaptionTemplate",void 0),Fe([Object(n.s)()],e.prototype,"customAggregate",void 0),e})(),ke=(()=>{class e extends n.e{}return Fe([Object(n.f)([],Te)],e.prototype,"columns",void 0),e})();class ze{constructor(e){this.copyContent="",this.isSelect=!1,this.parent=e,this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(O,this.initialEnd,this),this.parent.on(I,this.keyDownHandler,this),this.parent.on(M,this.clickHandler,this),n.l.add(this.parent.element,"keydown",this.pasteHandler,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(I,this.keyDownHandler),this.parent.off(O,this.initialEnd),this.parent.off(M,this.clickHandler),n.l.remove(this.parent.element,"keydown",this.pasteHandler))}clickHandler(e){let t=e.target;t=mt(t,"e-rowcell")}pasteHandler(e){let t=this.parent,i=/(Mac)/i.test(navigator.platform);if(86===e.keyCode&&(e.ctrlKey||i&&e.metaKey)&&!t.isEdit){if(!Object(n.C)(document.activeElement,".e-rowcell")||!t.editSettings.allowEditing||"Batch"!==t.editSettings.mode||"Cell"!==t.selectionSettings.mode||"Flow"===t.selectionSettings.cellSelectionMode)return;this.activeElement=document.activeElement,this.clipBoardTextArea.value="";let e=window.scrollX,i=window.scrollY;this.clipBoardTextArea.focus(),setTimeout(()=>{this.activeElement.focus(),window.scrollTo(e,i),this.paste(this.clipBoardTextArea.value,this.parent.getSelectedRowCellIndexes()[0].rowIndex,this.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])},10)}}paste(e,t,i){let s,r,l,a=this.parent,o=i,h=t;if(!a.editSettings.allowEditing||"Batch"!==a.editSettings.mode||"Cell"!==a.selectionSettings.mode||"Flow"===a.selectionSettings.cellSelectionMode)return;let d,c,p,u=e.split("\n"),g=a.getDataRows(),m=this.parent.isFrozenGrid();m&&(c=a.getMovableDataRows(),a.getFrozenRightColumnsCount()&&(p=a.getFrozenRightDataRows()));for(let f=0;f<u.length;f++){if(d=u[f].split("\t"),o=i,f===u.length-1&&""===u[f]||Object(n.ab)(a.getRowByIndex(h))){o++;break}for(let e=0;e<d.length;e++){if(l=a.getCellFromIndex(h,o),m){let e=c[h];l=!!g[h].querySelector('[aria-colindex="'+o+'"]')||e.querySelector('[aria-colindex="'+o+'"]'),p&&!l&&(l=p[h].querySelector('[aria-colindex="'+o+'"]'))}if(!l){o++;break}if(s=a.getColumnByIndex(o),r=s.getParser()?s.getParser()(d[e]):d[e],s.allowEditing&&!s.isPrimaryKey&&!s.template){let e={column:s,data:r,rowIndex:h};this.parent.trigger("beforePaste",e),h=e.rowIndex,e.cancel||a.editModule&&("number"===s.type?this.parent.editModule.updateCell(h,s.field,parseFloat(e.data)):a.editModule.updateCell(h,s.field,e.data))}o++}h++}a.selectionModule.selectCellsByRange({rowIndex:t,cellIndex:i},{rowIndex:h-1,cellIndex:o-1});let b=this.parent.getCellFromIndex(h-1,o-1);b&&Object(n.A)(b,["e-focus","e-focused"],[])}initialEnd(){this.parent.off(O,this.initialEnd),this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":"clipboard"}}),this.parent.element.appendChild(this.clipBoardTextArea)}keyDownHandler(e){"ctrlPlusC"===e.action?this.copy():"ctrlShiftPlusH"===e.action&&this.copy(!0)}setCopyData(e){if(""===window.getSelection().toString()){let t,i,s=this.parent.isFrozenGrid();this.clipBoardTextArea.value=this.copyContent="";let r=this.parent.getRows();if(s&&(t=this.parent.getMovableDataRows(),"Left-Right"===this.parent.getFrozenMode()&&(i=this.parent.getFrozenRightRows())),"Cell"!==this.parent.selectionSettings.mode){let n=this.parent.getSelectedRowIndexes().sort((e,t)=>e-t);if(e){let t=[];for(let e=0;e<this.parent.getVisibleColumns().length;e++)t[e]=this.parent.getVisibleColumns()[e].headerText;this.getCopyData(t,!1,"\t",e),this.copyContent+="\n"}for(let l=0;l<n.length;l++){l>0&&(this.copyContent+="\n");let a=[].slice.call(r[n[l]].querySelectorAll(".e-rowcell"));s&&(a.push(...[].slice.call(t[n[l]].querySelectorAll(".e-rowcell"))),i&&a.push(...[].slice.call(i[n[l]].querySelectorAll(".e-rowcell")))),this.getCopyData(a,!1,"\t",e)}}else{let n=this.checkBoxSelection();if(n.status){if(e){let t=[];for(let e=0;e<n.colIndexes.length;e++)t.push(this.parent.getColumnHeaderByIndex(n.colIndexes[e]));this.getCopyData(t,!1,"\t",e),this.copyContent+="\n"}for(let l=0;l<n.rowIndexes.length;l++){l>0&&(this.copyContent+="\n");let a=[].slice.call(r[n.rowIndexes[l]].querySelectorAll(".e-cellselectionbackground"));s&&(a.push(...[].slice.call(t[n.rowIndexes[l]].querySelectorAll(".e-cellselectionbackground"))),i&&a.push(...[].slice.call(i[n.rowIndexes[l]].querySelectorAll(".e-cellselectionbackground")))),this.getCopyData(a,!1,"\t",e)}}else this.getCopyData([].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground")),!0,"\n",e)}let l={data:this.copyContent,cancel:!1};if(this.parent.trigger("beforeCopy",l),l.cancel)return;this.clipBoardTextArea.value=this.copyContent=l.data,n.d.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0}}getCopyData(e,t,i,s){let r="string"!=typeof e[0];for(let l=0;l<e.length;l++)s&&t&&(this.copyContent+=this.parent.getColumns()[parseInt(e[l].getAttribute("aria-colindex"),10)].headerText+"\n"),r?e[l].classList.contains("e-hide")||(Object(n.W)()?!e[l].classList.contains("e-gridchkbox")&&Object.keys(e[l].querySelectorAll(".e-check")).length?this.copyContent+=!0:!e[l].classList.contains("e-gridchkbox")&&Object.keys(e[l].querySelectorAll(".e-uncheck")).length?this.copyContent+=!1:this.copyContent+=e[l].innerText:this.copyContent+=e[l].innerText):this.copyContent+=e[l],l<e.length-1&&(this.copyContent+=i)}copy(e){document.queryCommandSupported("copy")&&(this.setCopyData(e),document.execCommand("copy"),this.clipBoardTextArea.blur()),this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)}getModuleName(){return"clipboard"}destroy(){this.removeEventListener(),this.clipBoardTextArea&&Object(n.hb)(this.clipBoardTextArea)}checkBoxSelection(){let e=this.parent,t={status:!1};if("Cell"===e.selectionSettings.mode){let i,s,r=e.getSelectedRowCellIndexes(),n=[];for(s=0;s<r.length&&(r[s].cellIndexes.length&&n.push(r[s].rowIndex),!r[s].cellIndexes.length||(i||(i=JSON.stringify(r[s].cellIndexes.sort())),i===JSON.stringify(r[s].cellIndexes.sort())));s++);n.sort((e,t)=>e-t),s===r.length&&n[n.length-1]-n[0]==n.length-1&&(t={status:!0,rowIndexes:n,colIndexes:r[0].cellIndexes})}return t}}const Ae=new n.r;var Le,Be=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};let Pe=(()=>{class e extends n.e{}return Be([Object(n.s)()],e.prototype,"field",void 0),Be([Object(n.s)()],e.prototype,"direction",void 0),Be([Object(n.s)(!1)],e.prototype,"isFromGroup",void 0),e})(),qe=(()=>{class e extends n.e{}return Be([Object(n.f)([],Pe)],e.prototype,"columns",void 0),Be([Object(n.s)(!0)],e.prototype,"allowUnsort",void 0),e})(),Ve=(()=>{class e extends n.e{}return Be([Object(n.s)()],e.prototype,"field",void 0),Be([Object(n.s)()],e.prototype,"operator",void 0),Be([Object(n.s)()],e.prototype,"value",void 0),Be([Object(n.s)()],e.prototype,"matchCase",void 0),Be([Object(n.s)(!1)],e.prototype,"ignoreAccent",void 0),Be([Object(n.s)()],e.prototype,"predicate",void 0),Be([Object(n.s)({})],e.prototype,"actualFilterValue",void 0),Be([Object(n.s)({})],e.prototype,"actualOperator",void 0),Be([Object(n.s)()],e.prototype,"type",void 0),Be([Object(n.s)()],e.prototype,"ejpredicate",void 0),Be([Object(n.s)()],e.prototype,"uid",void 0),Be([Object(n.s)()],e.prototype,"isForeignKey",void 0),e})(),He=(()=>{class e extends n.e{}return Be([Object(n.s)(!1)],e.prototype,"enableCache",void 0),Be([Object(n.s)(3)],e.prototype,"maxBlocks",void 0),Be([Object(n.s)(3)],e.prototype,"initialBlocks",void 0),e})(),Ne=(()=>{class e extends n.e{}return Be([Object(n.f)([],Ve)],e.prototype,"columns",void 0),Be([Object(n.s)("FilterBar")],e.prototype,"type",void 0),Be([Object(n.s)()],e.prototype,"mode",void 0),Be([Object(n.s)(!0)],e.prototype,"showFilterBarStatus",void 0),Be([Object(n.s)(1500)],e.prototype,"immediateModeDelay",void 0),Be([Object(n.s)()],e.prototype,"operators",void 0),Be([Object(n.s)(!1)],e.prototype,"ignoreAccent",void 0),Be([Object(n.s)(!1)],e.prototype,"enableCaseSensitivity",void 0),Be([Object(n.s)(!1)],e.prototype,"showFilterBarOperator",void 0),e})(),We=(()=>{class e extends n.e{}return Be([Object(n.s)("Row")],e.prototype,"mode",void 0),Be([Object(n.s)("Flow")],e.prototype,"cellSelectionMode",void 0),Be([Object(n.s)("Single")],e.prototype,"type",void 0),Be([Object(n.s)(!1)],e.prototype,"checkboxOnly",void 0),Be([Object(n.s)(!1)],e.prototype,"persistSelection",void 0),Be([Object(n.s)("Default")],e.prototype,"checkboxMode",void 0),Be([Object(n.s)(!1)],e.prototype,"enableSimpleMultiRowSelection",void 0),Be([Object(n.s)(!0)],e.prototype,"enableToggle",void 0),Be([Object(n.s)(!1)],e.prototype,"allowColumnSelection",void 0),e})(),Xe=(()=>{class e extends n.e{}return Be([Object(n.s)([])],e.prototype,"fields",void 0),Be([Object(n.s)("")],e.prototype,"key",void 0),Be([Object(n.s)("contains")],e.prototype,"operator",void 0),Be([Object(n.s)(!0)],e.prototype,"ignoreCase",void 0),Be([Object(n.s)(!1)],e.prototype,"ignoreAccent",void 0),e})(),Ge=(()=>{class e extends n.e{}return Be([Object(n.s)()],e.prototype,"targetID",void 0),e})(),Ke=(()=>{class e extends n.e{}return Be([Object(n.s)("Both")],e.prototype,"wrapMode",void 0),e})(),Ue=(()=>{class e extends n.e{}return Be([Object(n.s)("Normal")],e.prototype,"mode",void 0),e})(),Ye=(()=>{class e extends n.e{}return Be([Object(n.s)(!0)],e.prototype,"showDropArea",void 0),Be([Object(n.s)(!1)],e.prototype,"allowReordering",void 0),Be([Object(n.s)(!1)],e.prototype,"showToggleButton",void 0),Be([Object(n.s)(!1)],e.prototype,"showGroupedColumn",void 0),Be([Object(n.s)(!0)],e.prototype,"showUngroupButton",void 0),Be([Object(n.s)(!1)],e.prototype,"disablePageWiseAggregates",void 0),Be([Object(n.s)([])],e.prototype,"columns",void 0),Be([Object(n.s)()],e.prototype,"captionTemplate",void 0),Be([Object(n.s)(!1)],e.prototype,"enableLazyLoading",void 0),e})(),_e=(()=>{class e extends n.e{}return Be([Object(n.s)(!1)],e.prototype,"allowAdding",void 0),Be([Object(n.s)(!1)],e.prototype,"allowEditing",void 0),Be([Object(n.s)(!1)],e.prototype,"allowDeleting",void 0),Be([Object(n.s)("Normal")],e.prototype,"mode",void 0),Be([Object(n.s)(!0)],e.prototype,"allowEditOnDblClick",void 0),Be([Object(n.s)(!0)],e.prototype,"showConfirmDialog",void 0),Be([Object(n.s)(!1)],e.prototype,"showDeleteConfirmDialog",void 0),Be([Object(n.s)("")],e.prototype,"template",void 0),Be([Object(n.s)("")],e.prototype,"headerTemplate",void 0),Be([Object(n.s)("")],e.prototype,"footerTemplate",void 0),Be([Object(n.s)("Top")],e.prototype,"newRowPosition",void 0),Be([Object(n.s)({})],e.prototype,"dialog",void 0),Be([Object(n.s)(!1)],e.prototype,"allowNextRowEdit",void 0),e})(),Qe=(()=>{let e=Le=class extends n.h{constructor(e,t){super(e,t),this.isPreventScrollEvent=!1,this.inViewIndexes=[],this.keyA=!1,this.frozenRightCount=0,this.frozenLeftCount=0,this.tablesCount=1,this.movableCount=0,this.visibleFrozenLeft=0,this.visibleFrozenRight=0,this.visibleMovable=0,this.frozenLeftColumns=[],this.frozenRightColumns=[],this.movableColumns=[],this.media={},this.isFreezeRefresh=!1,this.tableIndex=0,this.componentRefresh=n.h.prototype.refresh,this.isVirtualAdaptive=!1,this.vRows=[],this.vcRows=[],this.vGroupOffsets={},this.rowUid=0,this.currentViewData=[],this.lockcolPositionCount=0,this.prevPageMoving=!1,this.pageTemplateChange=!1,this.isAutoGen=!1,this.mediaBindInstance={},this.commandDelIndex=void 0,this.asyncTimeOut=50,this.enableLogger=!0,this.needsID=!0,Le.Inject(De),Object(n.qb)("mergePersistData",this.mergePersistGridData,this)}getPersistData(){let e=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],t={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]};for(let i=0;i<e.length;i++){let s=this[e[i]];for(let r of t[e[i]])delete s[r]}return this.pageSettings.template=void 0,this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!Object(n.X)(this.pagerTemplate),this.addOnPersist(e)}requiredModules(){this.setFrozenCount();let e=[];return this.isDestroyed||(this.allowFiltering&&e.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&e.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),e.push({member:"resize",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&e.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&e.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&e.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&e.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&e.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&e.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows||this.frozenRightCount||this.frozenLeftCount)&&e.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(e)),e}extendRequiredModules(e){this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this,this.serviceLocator]}),this.groupSettings.enableLazyLoading&&e.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this,this.serviceLocator]}),this.showColumnChooser&&e.push({member:"columnChooser",args:[this,this.serviceLocator]}),this.isForeignKeyEnabled(this.columns)&&e.push({member:"foreignKey",args:[this,this.serviceLocator]}),this.enableLogger&&e.push({member:"logger",args:[this]}),Object(n.W)()&&e.push({member:"blazor",args:[this]})}preRender(){this.serviceLocator=new pe,this.initProperties(),this.initializeServices()}initProperties(){this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.allowServerDataBinding=!1,this.ignoreCollectionWatch=!0,Object(n.W)()&&this.enableVirtualization&&this.allowGrouping&&(this.isExpanded=!1),this.mergeCells={},this.isEdit=!1,this.checkAllRows="None",this.isCheckBoxSelection=!1,this.isPersistSelection=!1,this.componentRefresh=n.h.prototype.refresh,this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No Matches Found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",EndsWith:"Ends With",Contains:"Contains",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No Matches Found",ClearFilter:"Clear Filter",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser dialog",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest"},this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert",delete:"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}}render(){this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{role:"grid"}),Object(n.W)()&&this.renderComplete(),Object(a.g)({target:this.element},this.createElement),this.renderModule=new de(this,this.serviceLocator),this.searchModule=new Ee(this),this.scrollModule=new Me(this),this.notify(v,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.trigger("load"),pt(this.columns,this.enableColumnVirtualization,this),this.enablePersistence&&this.notify("columns-prepared",{}),Object(n.W)()&&this.isServerRendered||(this.getMediaColumns(),ct(this.columns)),this.checkLockColumns(this.columns),this.getColumns(),this.processModel(),this.gridRender(),this.wireEvents(),this.addListener(),this.updateDefaultCursor(),this.updateStackedFilter(),this.showSpinner(),this.notify(w,{}),Object(n.W)()&&this.isServerRendered&&Ae.notify("component-rendered",{id:this.element.id,grid:this})}showSpinner(){Object(a.n)(this.element)}hideSpinner(){Object(a.k)(this.element)}updateStackedFilter(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().querySelectorAll(".e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")}getMediaColumns(){if(!this.enableColumnVirtualization){let e=this.getColumns();if(this.getShowHideService=this.serviceLocator.getService("showHideService"),!Object(n.X)(e))for(let t=0;t<e.length;t++)Object(n.X)(e[t].hideAtMedia)||!Object(n.X)(e[t].visible)&&!e[t].visible||this.pushMediaColumn(e[t],t)}}pushMediaColumn(e,t){this.mediaCol.push(e),this.media[e.uid]=window.matchMedia(e.hideAtMedia),this.mediaQueryUpdate(t,this.media[e.uid]),this.mediaBindInstance[t]=this.mediaQueryUpdate.bind(this,t),this.media[e.uid].addListener(this.mediaBindInstance[t])}updateMediaColumns(e){if(!this.enableColumnVirtualization){let t=this.getColumnIndexByUid(e.uid);for(let i=0;i<this.mediaCol.length;i++)if(e.uid===this.mediaCol[i].uid)return void this.mediaCol.splice(i,1);this.pushMediaColumn(e,t)}}mediaQueryUpdate(e,t){let i=this.getColumns()[e];this.mediaCol.some(e=>e.uid===i.uid)&&(i.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,i.visible?this.showHider.show(i.headerText,"headerText"):this.showHider.hide(i.headerText,"headerText")))}refreshMediaCol(){this.isInitialLoad=!0;let e=this.element.querySelector(".e-gridfooter");this.aggregates.length&&this.element.scrollHeight>this.height&&e&&Object(n.v)([e],["e-footerpadding"]),this.getColumns().filter(e=>"checkbox"===e.type).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1)}removeMediaListener(){for(let e=0;e<this.mediaCol.length;e++)this.media[this.mediaCol[e].uid].removeListener(this.mediaBindInstance[this.mediaCol[e].index])}eventInitializer(){}destroy(){let e=this.element;if(!e)return;let t=!(!e.querySelector(".e-gridheader")||!e.querySelector(".e-gridcontent"));t&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(F,{}),this.destroyDependentModules(),t&&super.destroy(),this.toolTipObj.destroy();let i=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"];for(let s=0;s<i.length;s++)this[i[s]]&&(this[i[s]]=null);Object(n.W)()&&this.isServerRendered?this.element.style.display="none":this.element.innerHTML="",Object(n.A)(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]),this.isAngular&&!this.isFreezeRefresh&&(this.element=null),this.isFreezeRefresh=!1}destroyDependentModules(){let e=this.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy())}getModuleName(){return"grid"}enableBoxSelection(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")}onPropertyChanged(e,t){let i,s=!1,r=!1,l=!1;if(this.isDestroyed)return;this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close();let a=Object.keys(e);a.indexOf("columns")>-1&&(this.updateColumnObject(),r=!0);for(let o of a)switch(o){case"allowPaging":this.notify(x,{module:"pager",enable:this.allowPaging}),s=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1,this.notify(R,{module:"pager",properties:e.pageSettings});break}this.notify(R,{module:"pager",properties:e.pageSettings}),(Object(n.X)(e.pageSettings.currentPage)&&Object(n.X)(e.pageSettings.pageSize)&&Object(n.X)(e.pageSettings.totalRecordsCount)||!Object(n.X)(t.pageSettings)&&e.pageSettings.currentPage!==t.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(s=!0);break;case"allowSorting":this.notify(x,{module:"sort",enable:this.allowSorting}),s=!0,i=!0;break;case"allowFiltering":this.updateStackedFilter(),this.notify(x,{module:"filter",enable:this.allowFiltering}),s=!0,"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(x,{module:"scroll",properties:{width:e.width,height:e.height}});break;case"allowReordering":this.headerModule.refreshUI(),i=!0;break;case"allowRowDragAndDrop":this.notify(x,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop}),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"allowSelection":this.notify(x,{module:"selection",enable:this.allowSelection});break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=ot(this.rowTemplate),s=!0;break;case"detailTemplate":this.detailTemplateFn=ot(this.detailTemplate),s=!0;break;case"allowGrouping":this.notify(x,{module:"group",enable:this.allowGrouping}),this.headerModule.refreshUI(),s=!0,i=!0;break;case"enableInfiniteScrolling":case"childGrid":s=!0;break;case"toolbar":this.notify(x,{module:"toolbar"});break;case"groupSettings":this.notify(R,{module:"group",properties:e.groupSettings,oldProperties:t.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(s=!0),this.notify(x,{module:"aggregate",properties:e});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns"),l=!0,r=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(s=!0),this.getDataModule().isQueryInvokedFromData=!1;break;default:this.extendedPropertyChange(o,e,r)}i&&this.updateDefaultCursor(),r?l||this.getFrozenColumns()||this.frozenRows?Object(n.W)()&&this.isServerRendered||this.freezeRefresh():this.refresh():s&&(this.notify(D,{requestType:"refresh"}),s=!1,this.maintainSelection(e.selectedRowIndex))}extendedPropertyChange(e,t,i){switch(e){case"enableRtl":this.updateRTL(),this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=t.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind()),"auto"!==this.height&&(this.scrollModule.removePadding(!t.enableRtl),this.scrollModule.setPadding()),this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=t.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind()),this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=t.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind()),this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=t.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind()),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader(),this.notify("rtl-updated",{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI(),this.updateResizeLines();break;case"rowHeight":this.rowHeight?Object(n.v)([this.element],"e-grid-min-height"):Object(n.ib)([this.element],"e-grid-min-height"),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI(),this.notify(x,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(x,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(x,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(x,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter(),this.notify(R,{module:"filter",properties:t.filterSettings});break;case"searchSettings":this.notify(R,{module:"search",properties:t.searchSettings});break;case"sortSettings":this.notify(R,{module:"sort"});break;case"selectionSettings":this.notify(R,{module:"selection",properties:t.selectionSettings});break;case"editSettings":this.notify(R,{module:"edit",properties:t.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap(),this.notify("freezerender",{case:"textwrap",isModeChg:"textWrapSettings"===e});break;case"dataSource":let s=this.getDataModule().getState();if(Object.getPrototypeOf(t).deepWatch){let e=this.getPrimaryKeyFieldNames()[0];for(let i=0,s=Object.keys(t.dataSource);i<s.length;i++)this.setRowData(Object(n.V)(e,this.dataSource[s[i]]),this.dataSource[s[i]])}else if(s.isPending){let e=Object(n.X)(this.dataSource)?[]:this.dataSource.result,t=s.group||[];for(let i=0;i<t.length;i++)e=l.b.group(e,t[i],s.aggregates||[]);this.dataSource={result:e,count:this.dataSource.count,aggregates:this.dataSource.aggregates},this.getDataModule().setState({}),s.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify("datasource-modified",{}),i||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify("before-refresh-on-data-change",{}));this.scrollRefresh();break;case"enableHover":(t.enableHover?n.v:n.ib)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(t.selectedRowIndex),this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable()}}maintainSelection(e){if(-1!==e){let t=()=>{this.selectRow(e),this.off(O,t)};this.on(O,t,this)}}setProperties(e,t){super.setProperties(e,t),e.filterSettings&&this.filterModule&&t&&this.filterModule.refreshFilter()}setTablesCount(){let e=this.getFrozenColumns(),t=this.getFrozenLeftColumnsCount(),i=this.getFrozenRightColumnsCount();!e||t||i?e||!t&&!i||(t&&!i||i&&!t?this.tablesCount=2:t&&i&&(this.tablesCount=3)):this.tablesCount=2}getTablesCount(){return this.tablesCount}updateDefaultCursor(){let e=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),t=[].slice.call(this.getHeaderContent().querySelectorAll(".e-stackedheadercell")),i=this.getColumns();if(this.enableColumnVirtualization&&this.getFrozenColumns()){let t=this.contentModule.getHeaderCells();e=t.length?t:e}for(let s=0;s<e.length;s++){let t=e[s];(this.allowGrouping||this.allowReordering||this.allowSorting)&&t.classList.add(i[s].allowReordering&&i[s].allowSorting&&i[s].allowGrouping?"e-mousepointer":"e-defaultcursor")}for(let s=0;s<t.length;s++)this.allowReordering&&t[s].classList.add("e-mousepointer")}updateColumnModel(e){for(let t=0,i=e.length;t<i;t++)e[t].columns?this.updateColumnModel(e[t].columns):this.columnModel.push(e[t]);this.updateColumnLevelFrozen(),this.updateFrozenColumns(),this.updateLockableColumns()}updateColumnLevelFrozen(){let e=this.columnModel,t=[],i=[],s=[];if(this.frozenLeftCount||this.frozenRightCount){for(let r=0,n=e.length;r<n;r++){let n=e[r];"Left"===n.freeze?(n.freezeTable="frozen-left",t.push(n)):"Right"===n.freeze?(n.freezeTable="frozen-right",i.push(n)):(n.freezeTable="movable",s.push(n))}this.columnModel=t.concat(s).concat(i)}}updateFrozenColumns(){if(this.frozenLeftCount||this.frozenRightCount)return;let e=this.columnModel,t=this.frozenColumns,i=this.getFrozenColumns(),s=0;for(let r=0,n=e.length;r<n;r++){let n=e[r];t&&(n.freezeTable=r<t?"frozen-left":"movable"),n.isFrozen&&r>=t?(n.freezeTable="frozen-left",e.splice(this.frozenColumns+s,0,e.splice(r,1)[0]),s++):i&&!t&&(n.freezeTable="movable")}}getFrozenLeftCount(){return this.getFrozenColumns()||this.getFrozenLeftColumnsCount()}isFrozenGrid(){return 0!==this.getFrozenColumns()||0!==this.getFrozenLeftColumnsCount()||0!==this.getFrozenRightColumnsCount()}getFrozenMode(){return this.frozenName}updateLockableColumns(){let e=this.columnModel,t=0,i=0,s=this.getFrozenColumns();for(let r=0;r<e.length;r++)e[r].lockColumn&&(r<s?(e.splice(t,0,e.splice(r,1)[0]),t++):(e.splice(s+i,0,e.splice(r,1)[0]),i++))}checkLockColumns(e){for(let t=0;t<e.length;t++)e[t].columns?this.checkLockColumns(e[t].columns):e[t].lockColumn&&this.lockcolPositionCount++}getColumns(e){let t=this.inViewIndexes.map(e=>e-this.groupSettings.columns.length).filter(e=>e>-1),i=t.length;(!this.enableColumnVirtualization||Object(n.X)(this.columnModel)||0===this.columnModel.length||e)&&(this.columnModel=[],this.updateColumnModel(this.columns));let s=0===i?this.columnModel:this.columnModel.slice(t[0],t[i-1]+1);return this.contentModule&&this.enableColumnVirtualization&&this.isFrozenGrid()&&t.length&&t[0]>0&&(s=this.contentModule.ensureFrozenCols(s)),s}getStackedHeaderColumnByHeaderText(e,t){for(let i=0;i<t.length;i++){let s=t[i];if(s.field===e||s.headerText===e){this.stackedColumn=s;break}s.columns&&this.getStackedHeaderColumnByHeaderText(e,s.columns)}return this.stackedColumn}getColumnIndexesInView(){return this.inViewIndexes}getQuery(){return this.query}getLocaleConstants(){return this.defaultLocale}setColumnIndexesInView(e){this.inViewIndexes=e}getVisibleColumns(){let e=[];for(let t of this.columnModel)t.visible&&e.push(t);return e}getHeaderContent(){return this.headerModule.getPanel()}setGridHeaderContent(e){this.headerModule.setPanel(e)}getContentTable(){return this.contentModule.getTable()}setGridContentTable(e){this.contentModule.setTable(e)}getContent(){return this.contentModule.getPanel()}setGridContent(e){this.contentModule.setPanel(e)}getHeaderTable(){return this.headerModule.getTable()}setGridHeaderTable(e){this.headerModule.setTable(e)}getFooterContent(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement}getFooterContentTable(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement.firstChild.firstChild}getPager(){return this.gridPager}setGridPager(e){this.gridPager=e}getRowByIndex(e){return this.contentModule.getRowByIndex(e)}getMovableRowByIndex(e){return this.contentModule.getMovableRowByIndex(e)}getFrozenRowByIndex(e){return this.getFrozenDataRows()[e]}getRows(){return this.contentModule.getRowElements()}getFrozenRightRowByIndex(e){return this.contentModule.getFrozenRightRowByIndex(e)}getRowInfo(e){let t=e,i={target:e};if(!Object(n.X)(e)&&Object(n.X)(mt(t,"e-detailrowcollapse")&&Object(n.X)(mt(t,"e-recordplusexpand")))){let s=Object(n.C)(t,".e-rowcell");if(!s){let e=Object(n.C)(t,".e-row");if(!Object(n.X)(e)){let t=this.getRowObjectFromUID(e.getAttribute("data-uid")),s=parseInt(e.getAttribute("aria-rowindex"),10);i={row:e,rowData:t.data,rowIndex:s}}return i}let r=parseInt(s.getAttribute("aria-colindex"),10);if(!Object(n.X)(s)&&!isNaN(r)){let t=Object(n.C)(s,".e-row"),l=parseInt(t.getAttribute("aria-rowindex"),10),a=this.getFrozenColumns(),o=this.columnModel[r].getFreezeTableName(),h=this.contentModule.getRows(),d=r+this.getIndentCount();this.isFrozenGrid()&&("frozen-left"===o?h=this.contentModule.getRows():"movable"===o?(d=r-a-this.frozenLeftCount,h=this.contentModule.getMovableRows()):"frozen-right"===o&&(d=r-(this.frozenLeftCount+this.movableCount),h=this.contentModule.getFrozenRightRows()));let c,p=h.filter(e=>e.uid===t.getAttribute("data-uid")),u={};Object.keys(p).length&&(u=p[0].data,c=p[0].cells[d].column),i={cell:s,cellIndex:r,row:t,rowIndex:l,rowData:u,column:c,target:e}}}return i}getMovableRows(){return this.contentModule.getMovableRowElements()}getFrozenRightRows(){return this.contentModule.getFrozenRightRowElements()}getDataRows(){return this.getAllDataRows()}getAllDataRows(e){if(Object(n.X)(this.getContentTable().querySelector("tbody")))return[];let t=this.isFrozenGrid()?this.getFrozenLeftContentTbody():this.getContentTable().querySelector("tbody"),i=[].slice.call(t.children);if(this.frozenRows){let e=this.isFrozenGrid()?this.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"):this.getHeaderTable().querySelector("tbody"),t=[].slice.call(e.children);i=this.addMovableRows(t,i)}return this.generateDataRows(i,e)}addMovableRows(e,t){for(let i=0,s=t.length;i<s;i++)e.push(t[i]);return e}generateDataRows(e,t){let i=[];for(let s=0,r=e.length;s<r;s++)!e[s].classList.contains("e-row")||e[s].classList.contains("e-hiddenrow")&&!t||(this.isCollapseStateEnabled()?i[parseInt(e[s].getAttribute("aria-rowindex"))]=e[s]:i.push(e[s]));return i}getMovableDataRows(){return this.getAllMovableDataRows()}getAllMovableDataRows(e){if(!this.isFrozenGrid())return[];let t=[].slice.call(this.getContent().querySelector(".e-movablecontent").querySelector("tbody").children);if(this.frozenRows){let e=[].slice.call(this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children);t=this.addMovableRows(e,t)}return this.generateDataRows(t,e)}getFrozenDataRows(){return this.getAllFrozenDataRows()}getAllFrozenDataRows(e){let t=[].slice.call(this.getContent().querySelector(".e-frozencontent").querySelector("tbody").children);if(this.frozenRows){let e=[].slice.call(this.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").children);t=this.addMovableRows(e,t)}return this.generateDataRows(t,e)}getFrozenRightDataRows(){return this.getAllFrozenRightDataRows()}getAllFrozenRightDataRows(e){if("Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode())return[];let t=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector("tbody").children);if(this.frozenRows){let e=[].slice.call(this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody").children);t=this.addMovableRows(e,t)}return this.generateDataRows(t,e)}setCellValue(e,t,i){let s,r,l,a,o=this.getPrimaryKeyFieldNames()[0],h=new _(this,this.serviceLocator),d={},c={},p=this.contentModule.getRows(),u=this.contentModule.getMovableRows();if(s=this.getColumnIndexByField(t),this.groupSettings.columns.length&&(s+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&s++,this.isRowDragable()&&s++,r=this.getColumnByField(t),d=p.filter(t=>Object(n.V)(o,t.data)===e)[0],c=u.filter(t=>Object(n.V)(o,t.data)===e)[0],l=Object(n.X)(d)?null:this.element.querySelector("[data-uid="+d.uid+"]"),a=Object(n.X)(c)?null:this.element.querySelector("[data-uid="+c.uid+"]"),!Object(n.X)(l)){Object(n.qb)(t,i,d.data);let e=Object(n.X)(l.cells[s])?a.cells[s-this.frozenColumns]:l.cells[s];if(!Object(n.X)(e)){let l,a=d.cells[s];this.frozenColumns&&(l=c.cells[s-this.frozenColumns]),h.refreshTD(e,Object(n.X)(a)?l:a,d.data,{index:d.index}),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})),Object(n.X)(c)||Object(n.X)(c.changes)||(c.changes[t]=i),this.trigger("queryCellInfo",{cell:e,column:r,data:d.data})}}}refreshReactColumnTemplateByUid(e){this.isReact&&this.clearTemplate(["columnTemplate"],void 0,()=>{let t=this.getRowsObject(),i=this.getIndentCount(),s=this.getNormalizedColumnIndex(e);for(let e=0;e<t.length;e++)if(t[e].isDataRow&&!Object(n.X)(t[e].index)){let r=t[e].cells[s],n=new _(this,this.serviceLocator),l=this.getCellFromIndex(t[e].index,s-i);n.refreshTD(l,r,t[e].data,{index:t[e].index})}})}setRowData(e,t){let i,s=this.contentModule.getRows(),r=this.getPrimaryKeyFieldNames()[0],l=new H(this.serviceLocator,null,this);this.groupSettings.columns.length>0&&this.aggregates.length>0&&(s=s.filter(e=>e.isDataRow)),i=s.filter(t=>Object(n.V)(r,t.data)===e)[0],!Object(n.X)(i)&&this.element.querySelectorAll("[data-uid="+i.uid+"]").length&&(i.changes=t,Wt(i,this.getForeignKeyColumns(),i.changes),l.refresh(i,this.getColumns(),!0),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})))}getCellFromIndex(e,t){return Si(this,this.getColumnByIndex(t),e,t)}getMovableCellFromIndex(e,t){if("Left-Right"===this.frozenName&&t>=this.movableCount)return;let i=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableDataRows()[e]&&this.getMovableDataRows()[e].querySelectorAll(".e-rowcell")[t-i]}getFrozenRightCellFromIndex(e,t){let i=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount(),s=this.getFrozenRightDataRows();return s[e]&&s[e].querySelectorAll(".e-rowcell")[t-i]}getColumnHeaderByIndex(e){return this.getHeaderTable().querySelectorAll(".e-headercell")[e]}getMovableColumnHeaderByIndex(e){let t=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableVirtualHeader().querySelectorAll(".e-headercell")[e-t]}getFrozenRightColumnHeaderByIndex(e){let t=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount();return this.getFrozenRightHeader().querySelectorAll(".e-headercell")[e-t]}getFrozenLeftColumnHeaderByIndex(e){return this.getFrozenVirtualHeader().querySelectorAll(".e-headercell")[e]}getRowObjectFromUID(e,t,i){let s=this.contentModule.getRows(),r=this.rowObject(s,e);return this.isFrozenGrid()&&(!r||t||i)?(r=this.rowObject(this.contentModule.getMovableRows(),e),(!r&&"Left-Right"===this.getFrozenMode()||i)&&(r=this.rowObject(this.contentModule.getFrozenRightRows(),e)),r):Object(n.X)(r)&&this.enableVirtualization&&this.groupSettings.columns.length>0?(r=this.rowObject(this.vRows,e),r):r}rowObject(e,t){for(let i of e)if(i.uid===t)return i;return null}getRowsObject(){return this.contentModule.getRows()}getMovableRowsObject(){let e=[];return this.isFrozenGrid()&&(e=this.contentModule.getMovableRows()),e}getFrozenRightRowsObject(){let e=[];return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()||(e=this.contentModule.getFrozenRightRows()),e}getColumnHeaderByField(e){let t=this.getColumnByField(e);return t?this.getColumnHeaderByUid(t.uid):void 0}getColumnHeaderByUid(e){let t=this.getHeaderContent().querySelector("[e-mappinguid="+e+"]");return t?t.parentElement:void 0}getColumnByIndex(e){let t;return this.getColumns().some((i,s)=>(t=i,s===e)),t}getColumnByField(e){return lt(this.getColumns(),(t,i)=>{if(t.field===e)return t})[0]}getColumnIndexByField(e){let t=this.getColumns();for(let i=0;i<t.length;i++)if(t[i].field===e)return i;return-1}getColumnByUid(e){return lt([...this.getColumns(),...this.getStackedColumns(this.columns)],(t,i)=>{if(t.uid===e)return t})[0]}getStackedColumns(e,t=[]){for(const i of e)i.columns&&(t.push(i),this.getStackedColumns(i.columns,t));return t}getColumnIndexByUid(e){let t=lt(this.getColumns(),(t,i)=>{if(t.uid===e)return i})[0];return Object(n.X)(t)?-1:t}getUidByColumnField(e){return lt(this.getColumns(),(t,i)=>{if(t.field===e)return t.uid})[0]}getNormalizedColumnIndex(e){return this.getColumnIndexByUid(e)+this.getIndentCount()}getIndentCount(){let e=0;return this.allowGrouping&&(e+=this.groupSettings.columns.length),this.isDetail()&&e++,this.isRowDragable()&&Object(n.X)(this.rowDropSettings.targetID)&&e++,e}getColumnFieldNames(){let e,t=[];for(let i=0,s=this.getColumns().length;i<s;i++)e=this.getColumns()[i],e.visible&&t.push(e.field);return t}getRowTemplate(){return this.rowTemplateFn}getDetailTemplate(){return this.detailTemplateFn}getEditTemplate(){return this.editTemplateFn}getEditHeaderTemplate(){return this.editHeaderTemplateFn}getEditFooterTemplate(){return this.editFooterTemplateFn}getPrimaryKeyFieldNames(){let e=[];for(let t=0;t<this.columnModel.length;t++)this.columnModel[t].isPrimaryKey&&e.push(this.columnModel[t].field);return e}refresh(){this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh()}refreshHeader(){this.headerModule.refreshUI()}getSelectedRows(){return this.selectionModule?this.selectionModule.selectedRecords:[]}getSelectedRowIndexes(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]}getSelectedRowCellIndexes(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]}getSelectedRecords(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]}getSelectedColumnsUid(){let e=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter(t=>e.push(this.getColumns()[t].uid)),e}getDataModule(){return this.renderModule.data}showColumns(e,t){this.showHider.show(e,t=t||"headerText")}hideColumns(e,t){this.showHider.hide(e,t=t||"headerText")}getFrozenColumns(){return this.frozenColumns+this.getFrozenCount(this.columns,0,0)}getFrozenRightColumnsCount(){return this.frozenRightCount}getFrozenLeftColumnsCount(){return this.frozenLeftCount}getMovableColumnsCount(){return this.movableCount}setFrozenCount(){this.frozenLeftCount=this.frozenRightCount=this.movableCount=0,this.visibleFrozenLeft=this.visibleFrozenRight=this.visibleMovable=0,this.frozenLeftColumns=[],this.frozenRightColumns=[],this.movableColumns=[],this.splitFrozenCount(this.columns),this.frozenColumns&&(this.frozenLeftCount||this.frozenRightCount)&&this.setProperties({frozenColumns:0},!0),this.setTablesCount(),this.frozenLeftCount&&!this.frozenRightCount?this.frozenName="Left":this.frozenRightCount&&!this.frozenLeftCount?this.frozenName="Right":this.frozenLeftCount&&this.frozenRightCount&&(this.frozenName="Left-Right")}getVisibleFrozenLeftCount(){return this.visibleFrozenLeft}getVisibleFrozenRightCount(){return this.visibleFrozenRight}getVisibleMovableCount(){return this.visibleMovable}getFrozenRightColumns(){return this.frozenRightColumns}getFrozenLeftColumns(){return this.frozenLeftColumns}getMovableColumns(){return this.movableColumns}splitFrozenCount(e){for(let t=0;t<e.length;t++)e[t].columns?this.splitFrozenCount(e[t].columns):"Right"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenRight++,this.frozenRightColumns.push(e[t]),this.frozenRightCount++):"Left"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenLeft++,this.frozenLeftColumns.push(e[t]),this.frozenLeftCount++):(!1!==e[t].visible&&this.visibleMovable++,this.movableColumns.push(e[t]),this.movableCount++)}getVisibleFrozenColumns(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)}getFilterUIInfo(){return this.filterModule?this.filterModule.getFilterUIInfo():{}}getVisibleFrozenColumnsCount(){let e=0,t=this.columnModel;for(let i=0;i<this.frozenColumns;i++)t[i].visible&&e++;if(this.frozenLeftCount||this.frozenRightCount)for(let i=0;i<t.length;i++)!t[i].visible||"Left"!==t[i].freeze&&"Right"!==t[i].freeze||e++;return e}getVisibleFrozenCount(e,t){if(!this.frozenLeftCount&&!this.frozenRightCount)for(let i=0,s=e.length;i<s;i++)e[i].columns?t=this.getVisibleFrozenCount(e[i].columns,t):e[i].isFrozen&&e[i].visible&&t++;return t}getFrozenCount(e,t,i){for(let s=0,r=e.length;s<r;s++)e[s].columns?t=this.getFrozenCount(e[s].columns,t,i):(e[s].isFrozen&&i>this.frozenColumns-1&&t++,i++);return t}goToPage(e){this.pagerModule&&this.pagerModule.goToPage(e)}updateExternalMessage(e){this.pagerModule&&this.pagerModule.updateExternalMessage(e)}sortColumn(e,t,i){this.sortModule&&this.sortModule.sortColumn(e,t,i)}clearSorting(){this.sortModule&&this.sortModule.clearSorting()}removeSortColumn(e){this.sortModule&&this.sortModule.removeSortColumn(e)}filterByColumn(e,t,i,s,r,n,l,a){this.filterModule&&this.filterModule.filterByColumn(e,t,i,s,r,n,l,a)}clearFiltering(e){this.filterModule&&this.filterModule.clearFiltering(e)}removeFilteredColsByField(e,t){this.filterModule&&this.filterModule.removeFilteredColsByField(e,t)}selectRow(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)}selectRows(e){this.selectionModule&&this.selectionModule.selectRows(e)}clearSelection(){this.selectionModule&&this.selectionModule.clearSelection()}selectCell(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)}selectCellsByRange(e,t){this.selectionModule.selectCellsByRange(e,t)}search(e){this.searchModule&&this.searchModule.search(e)}print(){this.printModule&&this.printModule.print()}deleteRecord(e,t){this.editModule&&this.editModule.deleteRecord(e,t)}startEdit(){this.editModule&&this.editModule.startEdit()}endEdit(){this.editModule&&this.editModule.endEdit()}closeEdit(){this.editModule&&this.editModule.closeEdit()}addRecord(e,t){this.editModule&&this.editModule.addRecord(e,t)}deleteRow(e){this.editModule&&this.editModule.deleteRow(e)}editCell(e,t){this.editModule&&this.editModule.editCell(e,t)}saveCell(){this.editModule&&this.editModule.saveCell()}updateCell(e,t,i){this.editModule&&this.editModule.updateCell(e,t,i)}updateRow(e,t){this.editModule&&this.editModule.updateRow(e,t)}getBatchChanges(){return this.editModule?this.editModule.getBatchChanges():{}}enableToolbarItems(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)}copy(e){this.clipboardModule&&this.clipboardModule.copy(e)}recalcIndentWidth(){if(!this.getHeaderTable().querySelector(".e-emptycell"))return;if(!this.groupSettings.columns.length&&!this.isDetail()&&!this.isRowDragable()||this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")||!this.getContentTable())return;let e=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,t=[].slice.call(this.getHeaderTable().querySelector("colgroup").childNodes),i=[].slice.call(this.getContentTable().querySelector("colgroup").childNodes),s=e/30,r="Right"===this.getFrozenMode()?this.frozenRightCount:0,n=this.element.offsetWidth,l=(e,s)=>{if(di(this)){let r=(s/n*100).toFixed(1)+"%";t[e].style.width=r,i[e].style.width=r}else t[e].style.width=s+"px",i[e].style.width=s+"px";this.notify("column-width-changed",{index:e,width:s})};for(s>=1&&(e=30/s),(this.enableColumnVirtualization||this.isAutoGen)&&(e=30);r<this.groupSettings.columns.length;)l(r,e),r++;this.isDetail()&&(l(r,e),r++),this.isRowDragable()&&l(r,e),this.isAutoGen=!1,this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}resetIndentWidth(){if(di(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter(e=>(!e.width||"auto"===e.width)&&e.minWidth).length>0){let e=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(e)}this.isFrozenGrid()&&this.widthService&&this.widthService.refreshFrozenScrollbar()}isRowDragable(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID&&!this.enableVirtualization}reorderColumns(e,t){this.reorderModule&&this.reorderModule.reorderColumns(e,t)}reorderColumnByIndex(e,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(e,t)}reorderColumnByTargetIndex(e,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(e,t)}reorderRows(e,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(e,t)}refreshDataSource(e,t){this.notify("refreshdataSource",e)}disableRowDD(e){let t=this.getHeaderTable(),i=this.getContentTable(),s=t.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),r=this.getRows(),l=e?"none":"";Object(n.ob)(t.querySelector("colgroup").childNodes[0],{display:l}),Object(n.ob)(i.querySelector("colgroup").childNodes[0],{display:l});for(let a=0;a<this.getRows().length;a++){let t=r[a].firstElementChild;e?Object(n.v)([t],"e-hide"):Object(n.ib)([t],["e-hide"])}for(let a=0;a<t.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;a++){let t=s[a];e?Object(n.v)([t],"e-hide"):Object(n.ib)([t],["e-hide"])}}autoFitColumns(e){this.resizeModule&&this.resizeModule.autoFitColumns(e)}createColumnchooser(e,t,i){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(e,t,i)}initializeServices(){this.serviceLocator.register("widthService",this.widthService=new ge(this)),this.serviceLocator.register("cellRendererFactory",new ce),this.serviceLocator.register("rendererFactory",new ue),this.serviceLocator.register("localization",this.localeObj=new n.p(this.getModuleName(),this.defaultLocale,this.locale)),this.serviceLocator.register("valueFormatter",this.valueFormatterService=new m(this.locale)),this.serviceLocator.register("showHideService",this.showHider=new Ie(this)),this.serviceLocator.register("ariaService",this.ariaService=new Q),this.serviceLocator.register("focus",this.focusModule=new me(this))}processModel(){let e,t,i=this.groupSettings.columns,s=this.sortSettings.columns;if(this.allowGrouping)for(let r=0,n=i.length;r<n;r++){t=0;for(let n=s.length;t<n;t++)if(s[t].field===i[r]){e=!0;break}if(e?this.allowSorting?this.sortedColumns.push(s[t].field):s[t].direction="Ascending":s.push({field:i[r],direction:"Ascending",isFromGroup:!0}),!this.groupSettings.showGroupedColumn){let e=this.enableColumnVirtualization?this.columns.filter(e=>e.field===i[r])[0]:this.getColumnByField(i[r]);e?e.visible=!1:this.log("initial_action",{moduleName:"group",columnName:i[r]})}}if(!i.length)for(let r=0;r<s.length;r++)this.sortedColumns.push(s[r].field);if(this.rowTemplateFn=ot(this.rowTemplate),this.detailTemplateFn=ot(this.detailTemplate),this.editTemplateFn=ot(this.editSettings.template),this.editHeaderTemplateFn=ot(this.editSettings.headerTemplate),this.editFooterTemplateFn=ot(this.editSettings.footerTemplate),!Object(n.X)(this.parentDetails)){let e=Object(n.X)(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue;this.query.where(this.queryString,"equal",e,!0)}this.initForeignColumn()}initForeignColumn(){this.isForeignKeyEnabled(this.getColumns())&&this.notify("initForeignKeyColumn",this.getForeignKeyColumns())}gridRender(){this.updateRTL(),this.enableHover&&this.element.classList.add("e-gridhover"),n.d.isDevice&&this.element.classList.add("e-device"),this.rowHeight&&this.element.classList.add("e-grid-min-height"),Object(n.A)(this.element,["e-responsive","e-default"],[]);let e=this.serviceLocator.getService("rendererFactory");this.headerModule=e.getRenderer(L.Header),this.contentModule=e.getRenderer(L.Content),this.printModule=new $e(this,this.scrollModule),this.clipboardModule=new ze(this),this.renderModule.render(),this.eventInitializer(),this.createGridPopUpElement(),this.widthService.setWidthToColumns(),this.updateGridLines(),this.applyTextWrap(),this.createTooltip(),this.enableBoxSelection()}dataReady(){this.scrollModule.setWidth(),this.scrollModule.setHeight(),"auto"!==this.height&&this.scrollModule.setPadding()}updateRTL(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}createGridPopUpElement(){let e=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),t=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});Object(n.w)([t,this.createElement("div",{className:"e-uptail e-tail"})],e),t.appendChild(this.createElement("span")),Object(n.w)([t,this.createElement("div",{className:"e-downtail e-tail"})],e),this.element.appendChild(e)}updateGridLines(){switch(Object(n.A)(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()}updateResizeLines(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")}applyTextWrap(){if(this.allowTextWrap){let e=[].slice.call(this.element.querySelectorAll(".e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":zt(this.element,!1),zt(this.getContent(),!1),zt(e,!0);break;case"Content":zt(this.getContent(),!0),zt(this.element,!1),zt(e,!1);break;default:zt(this.element,!0),zt(this.getContent(),!1),zt(e,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify("refreshResizeHandlers",{})}}removeTextWrap(){zt(this.element,!1),zt([].slice.call(this.element.querySelectorAll(".e-columnheader")),!1),zt(this.getContent(),!1),"Content"!==this.textWrapSettings.wrapMode&&this.notify("refreshResizeHandlers",{})}createTooltip(){this.toolTipObj=new a.d({opensOn:"custom",content:""},this.element)}freezeRefresh(){this.isFreezeRefresh=!0,this.enableVirtualization&&(this.pageSettings.currentPage=1),this.componentRefresh()}getTooltipStatus(e){let t,i=this.getHeaderTable(),s=(this.getContentTable(),this.createTable(i,"e-gridheader","header")),r=this.createTable(i,"e-gridheader","content"),n=e.classList.contains("e-headercell")?s:r,l=e.classList.contains("e-headercell")?"th":"tr";return n.querySelector(l).className=e.className,n.querySelector(l).innerHTML=e.innerHTML,t=n.querySelector(l).getBoundingClientRect().width,document.body.removeChild(s),document.body.removeChild(r),t>e.getBoundingClientRect().width}mouseMoveHandler(e){if(this.isEllipsisTooltip()){let t=mt(e.target,"e-ellipsistooltip");this.prevElement===t&&"mouseout"!==e.type||this.toolTipObj.close();let i=e.target.tagName,s=["A","BUTTON","INPUT"];if(t&&"mouseout"!==e.type&&(!n.d.isDevice||-1===s.indexOf(i))){if(t.getAttribute("aria-describedby"))return;this.getTooltipStatus(t)&&(this.toolTipObj.content=t.getElementsByClassName("e-headertext").length?t.getElementsByClassName("e-headertext")[0].innerText:t.innerText,this.prevElement=t,this.toolTipObj.open(t))}}this.hoverFrozenRows(e)}hoverFrozenRows(e){if(this.isFrozenGrid()){let t=mt(e.target,"e-row");if([].slice.call(this.element.querySelectorAll(".e-frozenhover")).length&&"mouseout"===e.type){let e=[].slice.call(this.element.querySelectorAll(".e-frozenhover"));for(let t=0;t<e.length;t++)e[t].classList.remove("e-frozenhover")}else if(t){let e=[].slice.call(this.element.querySelectorAll('tr[aria-rowindex="'+t.getAttribute("aria-rowindex")+'"]'));e.splice(e.indexOf(t),1);for(let i=0;i<e.length;i++)"true"!=t.getAttribute("aria-selected")&&e[i]?e[i].classList.add("e-frozenhover"):e[i]&&e[i].classList.remove("e-frozenhover")}}}isEllipsisTooltip(){let e=this.getColumns();if("EllipsisWithTooltip"===this.clipMode)return!0;for(let t=0;t<e.length;t++)if("EllipsisWithTooltip"===e[t].clipMode)return!0;return!1}scrollHandler(){this.isEllipsisTooltip()&&this.toolTipObj.close()}createTable(e,t,i){let s=this.createElement("div");s.className=this.element.className,s.style.cssText="display: inline-block;visibility:hidden;position:absolute";let r=this.createElement("div");r.className=t;let n=this.createElement("table");n.className=e.className,n.style.cssText="table-layout: auto;width: auto";let l="header"===i?"th":"td",a=this.createElement("tr"),o=this.createElement(l);return a.appendChild(o),n.appendChild(a),r.appendChild(n),s.appendChild(r),document.body.appendChild(s),s}onKeyPressed(e){"tab"!==e.action&&"shiftTab"!==e.action||this.toolTipObj.close()}wireEvents(){n.l.add(this.element,"click",this.mouseClickHandler,this),n.l.add(this.element,"touchend",this.mouseClickHandler,this),n.l.add(this.element,"focusout",this.focusOutHandler,this),n.l.add(this.element,"dblclick",this.dblClickHandler,this),n.l.add(this.element,"keydown",this.keyPressHandler,this),n.l.add(window,"resize",this.resetIndentWidth,this),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex),this.keyboardModule=new n.o(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),n.l.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this),n.l.add(this.element,"mousemove",this.mouseMoveHandler,this),n.l.add(this.element,"mouseout",this.mouseMoveHandler,this),n.l.add(this.getContent(),"touchstart",this.tapEvent,this),n.l.add(document.body,"keydown",this.keyDownHandler,this)}unwireEvents(){n.l.remove(this.element,"click",this.mouseClickHandler),n.l.remove(this.element,"touchend",this.mouseClickHandler),n.l.remove(this.element,"focusout",this.focusOutHandler),n.l.remove(this.element,"dblclick",this.dblClickHandler),n.l.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler),n.l.remove(this.element,"mousemove",this.mouseMoveHandler),n.l.remove(this.element,"mouseout",this.mouseMoveHandler),n.l.remove(this.element,"keydown",this.keyPressHandler),n.l.remove(this.getContent(),"touchstart",this.tapEvent),n.l.remove(document.body,"keydown",this.keyDownHandler),n.l.remove(window,"resize",this.resetIndentWidth)}addListener(){this.isDestroyed||(this.on(S,this.dataReady,this),this.on(O,this.recalcIndentWidth,this),this.on(E,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(C,this.dataBoundFunction),this.on(I,this.onKeyPressed,this),this.on(O,this.blazorTemplate,this))}removeListener(){this.isDestroyed||(this.off(S,this.dataReady),this.off(O,this.recalcIndentWidth),this.off(E,this.recalcIndentWidth),this.removeEventListener(C,this.dataBoundFunction),this.off(I,this.onKeyPressed))}blazorTemplate(){if(Object(n.W)()){this.pageSettings.template&&Object(n.sb)(this.element.id+"_template","Template",this.pageSettings);for(let t=0;t<this.columnModel.length;t++){if(this.columnModel[t].template&&Object(n.sb)(this.element.id+this.columnModel[t].uid,"Template",this.columnModel[t],!1),this.columnModel[t].headerTemplate&&Object(n.sb)(this.element.id+this.columnModel[t].uid+"headerTemplate","HeaderTemplate",this.columnModel[t],!1),"FilterBar"==this.filterSettings.type&&this.columnModel[t].filterTemplate){let e=this.columnModel[t].field,i=this.element.id+this.columnModel[t].uid+"filterTemplate",s=this.filterSettings.columns;for(let t=0;t<s.length;t++)e==s[t].field&&(n.z[i][0][e]=s[t].value);Object(n.sb)(this.element.id+this.columnModel[t].uid+"filterTemplate","FilterTemplate",this.columnModel[t],!1)}"FilterBar"!=this.filterSettings.type&&this.columnModel[t].filterTemplate&&Object(n.sb)(this.element.id+this.columnModel[t].uid+"filterTemplate","FilterTemplate",this.columnModel[t])}this.groupSettings.captionTemplate&&Object(n.sb)(this.element.id+"captionTemplate","CaptionTemplate",this.groupSettings);let e="guid";for(let t=0;t<this.aggregates.length;t++)for(let i=0;i<this.aggregates[t].columns.length;i++)this.aggregates[t].columns[i].footerTemplate&&Object(n.sb)(this.element.id+this.aggregates[t].columns[i][e]+"footerTemplate","FooterTemplate",this.aggregates[t].columns[i]),this.aggregates[t].columns[i].groupFooterTemplate&&Object(n.sb)(this.element.id+this.aggregates[t].columns[i][e]+"groupFooterTemplate","GroupFooterTemplate",this.aggregates[t].columns[i]),this.aggregates[t].columns[i].groupCaptionTemplate&&Object(n.sb)(this.element.id+this.aggregates[t].columns[i][e]+"groupCaptionTemplate","GroupCaptionTemplate",this.aggregates[t].columns[i])}}getCurrentViewRecords(){return Yt(this)?Object(n.X)(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData}mouseClickHandler(e){if(this.isChildGrid(e)||mt(e.target,"e-gridpopup")&&e.touches||this.element.querySelectorAll(".e-cloneproperties").length||this.checkEdit(e))return;if((!this.allowRowDragAndDrop&&(mt(e.target,"e-gridcontent")||"TD"===e.target.tagName)||!this.allowGrouping&&!this.allowReordering&&mt(e.target,"e-gridheader"))&&e.touches)return;mt(e.target,"e-gridheader")&&this.allowRowDragAndDrop&&!mt(e.target,"e-filterbarcell")&&e.preventDefault();let t=this.getRowInfo(e.target);t.cancel=!1;let i=!1,s=Object(n.C)(e.target,"tr");if(s&&s.getAttribute("data-uid")){let e=this.getRowObjectFromUID(s.getAttribute("data-uid"));i=!!e&&e.isDataRow}if(Object(n.W)()){let e=Object(n.K)({},t.column);t={rowData:t.rowData,rowIndex:t.rowIndex,cellIndex:t.cellIndex,column:e}}i&&this.trigger("recordClick",t),this.notify(M,e)}checkEdit(e){let t=mt(e.target,"e-row"),i="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains("e-editedrow")||t.classList.contains("e-addedrow"));return!mt(e.target,"e-unboundcelldiv")&&(i||mt(e.target,"e-rowcell")&&mt(e.target,"e-rowcell").classList.contains("e-editedbatchcell"))}dblClickHandler(e){let t=mt(e.target,"e-grid");if(Object(n.X)(t)||t.id!==this.element.id||Object(n.C)(e.target,".e-unboundcelldiv"))return;let i=!1,s=Object(n.C)(e.target,"tr");if(s&&s.getAttribute("data-uid")){let e=this.getRowObjectFromUID(s.getAttribute("data-uid"));i=!!e&&e.isDataRow}let r=this.getRowInfo(e.target);r.target=e.target,i&&this.trigger("recordDoubleClick",r),this.notify("dblclick",e)}focusOutHandler(e){if(this.isChildGrid(e))return;mt(e.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None");let t=this.element.querySelector(".e-cancel:not(.e-hide)");t&&t.classList.add("e-hide");let i=e.relatedTarget,s=i?i.getAttribute("aria-owns"):null;i&&(mt(i,"e-grid")||(!Object(n.X)(s)&&s)===e.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||n.d.isDevice||("Batch"===this.editSettings.mode&&(this.editModule.saveCell(),this.notify("editNextValCell",{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1}isChildGrid(e){let t=mt(e.target,"e-grid");return!(!t||t.id===this.element.id)}mergePersistGridData(e){let t=this.getLocalData();if(!Object(n.X)(t)&&""!==t||!Object(n.X)(e)){let i=Object(n.X)(e)?JSON.parse(t):e;this.enableVirtualization&&(i.pageSettings.currentPage=1);let s=Object.keys(i);this.isProtectedOnChange=!0;for(let e of s)"object"!=typeof this[e]||Object(n.X)(this[e])?this[e]=i[e]:Array.isArray(this[e])&&"columns"===e?(Object(n.W)()&&this.isServerRendered||ct(this[e]),this.mergeColumns(i[e],this[e]),this[e]=i[e]):Object(n.K)(this[e],i[e]);this.isProtectedOnChange=!1}}mergeColumns(e,t){let i=e;for(let s=0;s<i.length;s++){let e=t.filter(e=>e.index===i[s].index)[0];if(!Object(n.X)(e))if(e.columns&&e.columns.length)this.mergeColumns(i[s].columns,e.columns),i[s]=Object(n.K)(e,i[s],{},!0);else{if(Object(n.W)()){let t="guid";i[s][t]=e[t],i[s].uid=e.uid}i[s]=Object(n.K)(e,i[s],{},!0)}}}isDetail(){return!Object(n.X)(this.detailTemplate)||!Object(n.X)(this.childGrid)}isCommandColumn(e){return e.some(e=>e.columns?this.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate))}isForeignKeyEnabled(e){return e.some(e=>e.columns?this.isForeignKeyEnabled(e.columns):!(!e.dataSource||!e.foreignKeyValue))}keyPressHandler(e){let t=Object(n.K)(e,{cancel:!1});this.trigger("keyPressed",t),!0===t.cancel&&e.stopImmediatePropagation()}keyDownHandler(e){e.altKey&&(74===e.keyCode&&(this.keyA?(this.notify("group-collapse",{target:e.target,collapse:!1}),this.keyA=!1):(this.focusModule.focusHeader(),this.focusModule.addOutline())),87===e.keyCode&&(this.focusModule.focusContent(),this.focusModule.addOutline()),65===e.keyCode&&(this.keyA=!0),72===e.keyCode&&this.keyA&&(this.notify("group-collapse",{target:e.target,collapse:!0}),this.keyA=!1))}keyActionHandler(e){this.isChildGrid(e)||this.isEdit&&"escape"!==e.action&&"enter"!==e.action&&"shiftEnter"!==e.action&&"tab"!==e.action&&"shiftTab"!==e.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===e.action&&(e.preventDefault(),this.print()),this.notify(I,e)))}setInjectedModules(e){this.injectedModules=e}updateColumnObject(){pt(this.columns,this.enableColumnVirtualization,this),Object(n.W)()&&this.isServerRendered||ct(this.columns),this.initForeignColumn(),this.notify(k,{})}getForeignKeyColumns(){return this.getColumns().filter(e=>e.isForeignColumn())}getRowHeight(){return this.rowHeight?this.rowHeight:function(e){if(void 0!==Rt)return Rt;let t=Object(n.F)("table",{className:"e-table",styles:"visibility: hidden"});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(t);let i=t.querySelector("td").getBoundingClientRect();return e.removeChild(t),Rt=Math.ceil(i.height),Rt}(this.element)}refreshColumns(){this.setFrozenCount();let e=this.getContent().querySelector(".e-frozen-left-content"),t=this.getContent().querySelector(".e-frozen-right-content"),i=!this.frozenRightCount&&!this.frozenLeftCount;if(0===this.getFrozenColumns()&&(!e&&this.frozenLeftCount||!t&&this.frozenRightCount||e&&!this.frozenLeftCount||t&&!this.frozenRightCount))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(i&&(1===this.getFrozenColumns()&&!e||0===this.getFrozenColumns()&&e))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.isFrozenGrid()){let e=this.contentModule.getMovableContent().querySelector(".e-table");Object(n.hb)(e.querySelector("colgroup"));let t=this.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);if(e.insertBefore(t,e.querySelector("tbody")),"Left-Right"===this.getFrozenMode()){let e=this.contentModule.getFrozenRightContent().querySelector(".e-table");Object(n.hb)(e.querySelector("colgroup"));let t=this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"))}}if(this.isFrozenGrid()){let e=this.getContent().querySelector(".e-movablescrollbar").scrollLeft;this.headerModule.getMovableHeader().scrollLeft=e,this.contentModule.getMovableContent().scrollLeft=e}}excelExport(e,t,i,s){return Object(n.W)()?(this.excelExportModule.Map(this,e,t,i,!1,s),null):this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!1,s):null}csvExport(e,t,i,s){return Object(n.W)()?(this.excelExportModule.Map(this,e,t,i,!0,s),null):this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!0,s):null}pdfExport(e,t,i,s){return Object(n.W)()?(this.pdfExportModule.Map(this,e,t,i,s),null):this.pdfExportModule?this.pdfExportModule.Map(this,e,t,i,s):null}groupColumn(e){this.groupModule&&this.groupModule.groupColumn(e)}groupExpandAll(){this.groupModule&&this.groupModule.expandAll()}groupCollapseAll(){this.groupModule&&this.groupModule.collapseAll()}clearGrouping(){this.groupModule&&this.groupModule.clearGrouping()}ungroupColumn(e){this.groupModule&&this.groupModule.ungroupColumn(e)}openColumnChooser(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)}scrollRefresh(){let e=()=>{this.scrollModule.refresh(),this.off(O,e)};this.on(O,e,this)}detailCollapseAll(){this.detailRowModule&&this.detailRowModule.collapseAll()}detailExpandAll(){this.detailRowModule&&this.detailRowModule.expandAll()}clearCellSelection(){this.selectionModule&&this.selectionModule.clearCellSelection()}clearRowSelection(){this.selectionModule&&this.selectionModule.clearRowSelection()}selectCells(e){this.selectionModule&&this.selectionModule.selectCells(e)}selectRowsByRange(e,t){this.selectionModule&&this.selectionModule.selectRowsByRange(e,t)}isContextMenuOpen(){return this.contextMenuModule&&this.contextMenuModule.isOpen}ensureModuleInjected(e){return this.getInjectedModules().indexOf(e)>=0}destroyTemplate(e,t){this.clearTemplate(e,t)}log(e,t){this.loggerModule&&this.loggerModule.log(e,t)}applyBiggerTheme(e){this.element.classList.contains("e-bigger")&&e.classList.add("e-bigger")}getPreviousRowData(){return this.getRowsObject()[this.getRows().length-1].data}hideScroll(){let e=this.getContent().querySelector(".e-content"),t=this.getContent().querySelector(".e-scrollbar");if(e.scrollHeight<=e.clientHeight&&(this.scrollModule.removePadding(),e.style.overflowY="auto"),this.isFrozenGrid()&&t){let e=this.getContent().querySelector(".e-movablescrollbar"),i=this.getContent().querySelector(".e-movablechild");t.style.display="flex",e.offsetWidth>=i.offsetWidth&&(t.style.display="none",this.notify("frozenHeight",0))}}getRowIndexByPrimaryKey(e){let t=this.getPrimaryKeyFieldNames()[0];e="object"==typeof e?e[t]:e;for(let i=0;i<this.getRowsObject().length;i++)if(this.getRowsObject()[i].data[t]===e)return this.getRowsObject()[i].index;return-1}grabColumnByFieldFromAllCols(e){let t;this.columnModel=[],this.updateColumnModel(this.columns);let i=this.columnModel;for(let s=0;s<i.length;s++)e===i[s].field&&(t=i[s]);return t}grabColumnByUidFromAllCols(e){let t;this.columnModel=[],this.updateColumnModel(this.columns);let i=this.columnModel;for(let s=0;s<i.length;s++)e===i[s].uid&&(t=i[s]);return t}getFilteredRecords(){if(this.allowFiltering&&this.filterSettings.columns.length){let e=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof l.a?this.renderModule.data.getData(this.dataSource,e):this.dataSource instanceof l.a?this.dataSource.executeLocal(e):new l.a(this.dataSource,e).executeLocal(e)}return[]}getUserAgent(){let e=n.d.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)}tapEvent(e){this.getUserAgent()&&(ii.timer?(clearTimeout(ii.timer),ii.timer=null,this.dblClickHandler(e),this.notify("double-tap",e)):ii.timer=setTimeout(()=>{ii.timer=null},300))}getRowUid(e){return`${e}${this.rowUid++}`}getMovableVirtualContent(){return this.getContent().querySelector(".e-movablecontent")}getFrozenVirtualContent(){return this.getContent().querySelector(".e-frozencontent")}getMovableVirtualHeader(){return this.getHeaderContent().querySelector(".e-movableheader")}getFrozenVirtualHeader(){return this.getHeaderContent().querySelector(".e-frozenheader")}getRowElementByUID(e){let t,i=[];if(this.isFrozenGrid()){let e=[].slice.call(this.getFrozenVirtualContent().querySelector("tbody").children),t=[].slice.call(this.getMovableVirtualContent().querySelector("tbody").children),s=[];if(3===this.tablesCount&&(s=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector("tbody").children)),this.frozenRows){if(i=[].slice.call(this.getFrozenVirtualHeader().querySelector("tbody").children),i=i.concat([].slice.call(this.getMovableVirtualHeader().querySelector("tbody").children)),3===this.tablesCount){let e=this.getHeaderContent().querySelector(".e-frozen-right-header");i=i.concat([].slice.call(e.querySelector("tbody").children)).concat(s)}i=i.concat(e).concat(t)}else i=e.concat(t).concat(s)}else{let e=[].slice.call(this.getContent().querySelector("tbody").children);this.frozenRows?(i=[].slice.call(this.getHeaderContent().querySelector("tbody").children),i=i.concat(e)):i=e}for(let s of i)if(s.getAttribute("data-uid")===e){t=s;break}return t}getHiddenColumns(){let e=[];for(let t of this.columnModel)!1===t.visible&&e.push(t);return e}calculatePageSizeByParentHeight(e){if(this.allowPaging&&(this.allowTextWrap&&"Header"==this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if(-1!=e.indexOf("%")&&(e=parseInt(e)/100*this.element.clientHeight),e>this.getNoncontentHeight()+this.getRowHeight()&&(t=(e-this.getNoncontentHeight())/this.getRowHeight()),t>0)return Math.floor(t)}return 0}getNoncontentHeight(){var e=0;if(Object(n.X)(this.getHeaderContent().clientHeight)||(e+=this.getHeaderContent().clientHeight),this.toolbar&&!Object(n.X)(this.element.querySelector(".e-toolbar").clientHeight)&&(e+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!Object(n.X)(this.element.querySelector(".e-gridpager").clientHeight)&&(e+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!Object(n.X)(this.element.querySelector(".e-columnheader").clientHeight)&&(e+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!Object(n.X)(this.element.querySelector(".e-groupdroparea").clientHeight)&&(e+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!Object(n.X)(this.element.querySelector(".e-summaryrow").clientHeight))for(let t=0;t<this.element.querySelectorAll(".e-summaryrow").length;t++)e+=this.element.querySelectorAll(".e-summaryrow")[t].clientHeight;return e}getSummaryValues(e,t){return l.b.aggregates[e.type.toLowerCase()](t,e.field)}serverExcelExport(e){this.exportGrid(e)}serverPdfExport(e){this.exportGrid(e)}exportGrid(e){let t=this,i=t.getDataModule().generateQuery(!0),s=(new l.h).processQuery(new l.a({url:""}),i).data,r=JSON.parse(this.addOnPersist(["allowGrouping","allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","groupSettings","columns","locale","searchSettings"]));r.columns.forEach(e=>{t.getColumnByUid(e.uid)&&(e.headerText=t.getColumnByUid(e.uid).headerText,e.format)&&(e.format=Di("object"==typeof e.format?e.format.format:e.format,e.type)),e.columns&&this.setHeaderText(e.columns)});let n=this.createElement("form",{id:"ExportForm",styles:"display:none;"}),a=this.createElement("input",{id:"gridInput",attrs:{name:"gridModel"}}),o=this.createElement("input",{id:"queryInput",attrs:{name:"requestModel"}});a.value=JSON.stringify(r),o.value=s,n.method="POST",n.action=e,n.appendChild(a),n.appendChild(o),document.body.appendChild(n),n.submit(),n.remove()}setHeaderText(e){for(var t=0;t<e.length;t++){if(e[t].headerText=this.getColumnByUid(e[t].uid).headerText,e[t].format){let i=e[t];e[t].format=Di("object"==typeof i.format?i.format.format:i.format,e[t].type)}e[t].columns&&this.setHeaderText(e[t].columns)}}isCollapseStateEnabled(){return!1===this.isExpanded}updateRowValue(e,t){let i={requestType:"save",data:t};this.showSpinner(),this.notify("update-data",i),this.refresh()}setForeignKeyData(){this.dataBind();let e=this.getDataModule().getForeignKeyDataState();e.isPending?(this.getDataModule().setForeignKeyDataState({}),e.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())}resetFilterDlgPosition(e){let t=this.getColumnHeaderByField(e);if(t){let e=t.querySelector(".e-filtermenudiv"),i=this.element.querySelector(".e-filter-popup");if(e&&i){let t=this.element.getBoundingClientRect(),s=e.getBoundingClientRect();i&&(i.style.left=(s.right-t.left).toString()+"px")}}}renderTemplates(){this.notify("reactTemplateRender",this.portals),this.renderReactTemplates()}batchUpdate(e){this.processRowChanges(e)}batchAsyncUpdate(e){this.processBulkRowChanges(e)}processBulkRowChanges(e){if(this.dataToBeUpdated){let t=["addedRecords","changedRecords","deletedRecords"],i=this.getPrimaryKeyFieldNames()[0];for(let s=0;s<t.length;s++)e[t[s]]&&pi(this,e,t[s],i)}else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e),setTimeout(()=>{this.processRowChanges(this.dataToBeUpdated),this.dataToBeUpdated=null},this.asyncTimeOut)}processRowChanges(e){let t=this.getPrimaryKeyFieldNames()[0];e=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e);let i=this.getDataModule().saveChanges(e,t,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?i.then(e=>{this.setNewData()}):this.setNewData()}setNewData(){let e=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then(t=>{this.bulkRefresh(t.result,e,t.count)})}deleteRowElement(e){let t=this.getRowElementByUID(e.uid),i=parseInt(t.getAttribute("aria-rowindex"),10);if(Object(n.hb)(t),this.getFrozenColumns()){let e=this.getMovableRows()[i];Object(n.hb)(e)}}bulkRefresh(e,t,i){let s=this.getRowsObject(),r=this.getPrimaryKeyFieldNames()[0];for(let l=0;l<s.length;l++)e.filter(e=>e[r]===s[l].data[r]).length||(this.deleteRowElement(s[l]),s.splice(l,1),l--);for(let l=0;l<e.length;l++){let i;t.filter(t=>{t[r]===e[l][r]&&(t!==e[l]&&this.setRowData(e[l][r],e[l]),i=!0)}),i||this.renderRowElement(e[l],l)}this.currentViewData=e;let n=[].slice.call(this.getContentTable().querySelectorAll(".e-row"));ci(this,this.getRowsObject(),n),ui(this),this.allowPaging&&this.notify(R,{module:"pager",properties:{totalRecordsCount:i}})}renderRowElement(e,t){let i,s,r=new H(this.serviceLocator,null,this),n=new N(this).generateRows([e]),l=r.render(n[0],this.getColumns());this.addRowObject(n[0],t);let a=this.getContentTable().querySelector("tbody");if(a.querySelector(".e-emptyrow")){let e=a.querySelector(".e-emptyrow");if(e.parentNode.removeChild(e),this.getFrozenColumns()){let e=this.getContent().querySelector(".e-movablecontent").querySelector("tbody");e.firstElementChild.parentNode.removeChild(e.firstElementChild)}}this.getFrozenColumns()&&(i=Ut(l,this.getFrozenColumns(),this),s=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.getContent().querySelector(".e-movablecontent").querySelector("tbody"),s.appendChild(i),"auto"===this.height&&this.notify("frozenHeight",{})),a=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("tbody"):this.getContent().querySelector("tbody"),a=this.getContent().querySelector("tbody"),a.appendChild(l)}addRowObject(e,t){let i=this.getFrozenColumns();if(i){let s=this.getMovableRowsObject(),r=e.clone();r.cells=r.cells.slice(i),e.cells=e.cells.slice(0,i),s.splice(t,1,r)}this.getRowsObject().splice(t,1,e)}getHeight(e){return Number.isInteger(e)||-1==e.indexOf("%")?Number.isInteger(e)||"auto"===this.height?this.height:parseInt(e):parseInt(e)/100*this.element.clientHeight}getFrozenRightContent(){return this.getContent().querySelector(".e-frozen-right-content")}getFrozenRightHeader(){return this.getHeaderContent().querySelector(".e-frozen-right-header")}getMovableHeaderTbody(){return this.getMovableVirtualHeader().querySelector("tbody")}getMovableContentTbody(){return this.getMovableVirtualContent().querySelector("tbody")}getFrozenHeaderTbody(){return this.getFrozenVirtualHeader().querySelector("tbody")}getFrozenLeftContentTbody(){return this.getFrozenVirtualContent().querySelector("tbody")}getFrozenRightHeaderTbody(){return this.getFrozenRightHeader().querySelector("tbody")}getFrozenRightContentTbody(){let e;return this.getFrozenRightContent()&&(e=this.getFrozenRightContent().querySelector("tbody")),e}};return Be([Object(n.s)()],e.prototype,"parentDetails",void 0),Be([Object(n.s)([])],e.prototype,"columns",void 0),Be([Object(n.s)(!0)],e.prototype,"enableAltRow",void 0),Be([Object(n.s)(!0)],e.prototype,"enableHover",void 0),Be([Object(n.s)(!1)],e.prototype,"enableAutoFill",void 0),Be([Object(n.s)(!0)],e.prototype,"allowKeyboard",void 0),Be([Object(n.s)(!1)],e.prototype,"allowTextWrap",void 0),Be([Object(n.g)({},Ke)],e.prototype,"textWrapSettings",void 0),Be([Object(n.g)({},Ue)],e.prototype,"resizeSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"allowPaging",void 0),Be([Object(n.g)({},je)],e.prototype,"pageSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"enableVirtualization",void 0),Be([Object(n.s)(!1)],e.prototype,"enableColumnVirtualization",void 0),Be([Object(n.s)(!1)],e.prototype,"enableInfiniteScrolling",void 0),Be([Object(n.g)({},Xe)],e.prototype,"searchSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"allowSorting",void 0),Be([Object(n.s)("Ellipsis")],e.prototype,"clipMode",void 0),Be([Object(n.s)(!0)],e.prototype,"allowMultiSorting",void 0),Be([Object(n.s)(!1)],e.prototype,"allowExcelExport",void 0),Be([Object(n.s)(!1)],e.prototype,"allowPdfExport",void 0),Be([Object(n.g)({},qe)],e.prototype,"sortSettings",void 0),Be([Object(n.g)({},He)],e.prototype,"infiniteScrollSettings",void 0),Be([Object(n.s)(!0)],e.prototype,"allowSelection",void 0),Be([Object(n.s)(-1)],e.prototype,"selectedRowIndex",void 0),Be([Object(n.g)({},We)],e.prototype,"selectionSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"allowFiltering",void 0),Be([Object(n.s)(!1)],e.prototype,"allowReordering",void 0),Be([Object(n.s)(!1)],e.prototype,"allowResizing",void 0),Be([Object(n.s)(!1)],e.prototype,"allowRowDragAndDrop",void 0),Be([Object(n.g)({},Ge)],e.prototype,"rowDropSettings",void 0),Be([Object(n.g)({},Ne)],e.prototype,"filterSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"allowGrouping",void 0),Be([Object(n.s)(!1)],e.prototype,"enableImmutableMode",void 0),Be([Object(n.s)(!1)],e.prototype,"showColumnMenu",void 0),Be([Object(n.g)({},Ye)],e.prototype,"groupSettings",void 0),Be([Object(n.g)({},_e)],e.prototype,"editSettings",void 0),Be([Object(n.f)([],ke)],e.prototype,"aggregates",void 0),Be([Object(n.s)(!1)],e.prototype,"showColumnChooser",void 0),Be([Object(n.g)({},Re)],e.prototype,"columnChooserSettings",void 0),Be([Object(n.s)(!1)],e.prototype,"enableHeaderFocus",void 0),Be([Object(n.s)("auto")],e.prototype,"height",void 0),Be([Object(n.s)("auto")],e.prototype,"width",void 0),Be([Object(n.s)("Default")],e.prototype,"gridLines",void 0),Be([Object(n.s)()],e.prototype,"rowTemplate",void 0),Be([Object(n.s)()],e.prototype,"detailTemplate",void 0),Be([Object(n.s)()],e.prototype,"childGrid",void 0),Be([Object(n.s)()],e.prototype,"queryString",void 0),Be([Object(n.s)("AllPages")],e.prototype,"printMode",void 0),Be([Object(n.s)("Expanded")],e.prototype,"hierarchyPrintMode",void 0),Be([Object(n.s)([])],e.prototype,"dataSource",void 0),Be([Object(n.s)(null)],e.prototype,"rowHeight",void 0),Be([Object(n.s)()],e.prototype,"query",void 0),Be([Object(n.s)("USD")],e.prototype,"currencyCode",void 0),Be([Object(n.s)()],e.prototype,"toolbar",void 0),Be([Object(n.s)()],e.prototype,"contextMenuItems",void 0),Be([Object(n.s)()],e.prototype,"columnMenuItems",void 0),Be([Object(n.s)()],e.prototype,"toolbarTemplate",void 0),Be([Object(n.s)()],e.prototype,"pagerTemplate",void 0),Be([Object(n.s)(0)],e.prototype,"frozenRows",void 0),Be([Object(n.s)(0)],e.prototype,"frozenColumns",void 0),Be([Object(n.s)("All")],e.prototype,"columnQueryMode",void 0),Be([Object(n.s)({})],e.prototype,"currentAction",void 0),Be([Object(n.s)("18.4.39")],e.prototype,"ej2StatePersistenceVersion",void 0),Be([Object(n.k)()],e.prototype,"created",void 0),Be([Object(n.k)()],e.prototype,"destroyed",void 0),Be([Object(n.k)()],e.prototype,"load",void 0),Be([Object(n.k)()],e.prototype,"rowDataBound",void 0),Be([Object(n.k)()],e.prototype,"queryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"headerCellInfo",void 0),Be([Object(n.k)()],e.prototype,"actionBegin",void 0),Be([Object(n.k)()],e.prototype,"actionComplete",void 0),Be([Object(n.k)()],e.prototype,"actionFailure",void 0),Be([Object(n.k)()],e.prototype,"dataBound",void 0),Be([Object(n.k)()],e.prototype,"recordDoubleClick",void 0),Be([Object(n.k)()],e.prototype,"recordClick",void 0),Be([Object(n.k)()],e.prototype,"rowSelecting",void 0),Be([Object(n.k)()],e.prototype,"rowSelected",void 0),Be([Object(n.k)()],e.prototype,"rowDeselecting",void 0),Be([Object(n.k)()],e.prototype,"rowDeselected",void 0),Be([Object(n.k)()],e.prototype,"cellSelecting",void 0),Be([Object(n.k)()],e.prototype,"cellSelected",void 0),Be([Object(n.k)()],e.prototype,"cellDeselecting",void 0),Be([Object(n.k)()],e.prototype,"cellDeselected",void 0),Be([Object(n.k)()],e.prototype,"columnSelecting",void 0),Be([Object(n.k)()],e.prototype,"columnSelected",void 0),Be([Object(n.k)()],e.prototype,"columnDeselecting",void 0),Be([Object(n.k)()],e.prototype,"columnDeselected",void 0),Be([Object(n.k)()],e.prototype,"columnDragStart",void 0),Be([Object(n.k)()],e.prototype,"columnDrag",void 0),Be([Object(n.k)()],e.prototype,"columnDrop",void 0),Be([Object(n.k)()],e.prototype,"printComplete",void 0),Be([Object(n.k)()],e.prototype,"beforePrint",void 0),Be([Object(n.k)()],e.prototype,"pdfQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"pdfHeaderQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"pdfAggregateQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"excelAggregateQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"exportDetailDataBound",void 0),Be([Object(n.k)()],e.prototype,"excelQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"excelHeaderQueryCellInfo",void 0),Be([Object(n.k)()],e.prototype,"beforeExcelExport",void 0),Be([Object(n.k)()],e.prototype,"excelExportComplete",void 0),Be([Object(n.k)()],e.prototype,"beforePdfExport",void 0),Be([Object(n.k)()],e.prototype,"pdfExportComplete",void 0),Be([Object(n.k)()],e.prototype,"rowDragStartHelper",void 0),Be([Object(n.k)()],e.prototype,"detailDataBound",void 0),Be([Object(n.k)()],e.prototype,"rowDragStart",void 0),Be([Object(n.k)()],e.prototype,"rowDrag",void 0),Be([Object(n.k)()],e.prototype,"rowDrop",void 0),Be([Object(n.k)()],e.prototype,"toolbarClick",void 0),Be([Object(n.k)()],e.prototype,"beforeOpenColumnChooser",void 0),Be([Object(n.k)()],e.prototype,"batchAdd",void 0),Be([Object(n.k)()],e.prototype,"batchDelete",void 0),Be([Object(n.k)()],e.prototype,"batchCancel",void 0),Be([Object(n.k)()],e.prototype,"beforeBatchAdd",void 0),Be([Object(n.k)()],e.prototype,"beforeBatchDelete",void 0),Be([Object(n.k)()],e.prototype,"beforeBatchSave",void 0),Be([Object(n.k)()],e.prototype,"beginEdit",void 0),Be([Object(n.k)()],e.prototype,"commandClick",void 0),Be([Object(n.k)()],e.prototype,"cellEdit",void 0),Be([Object(n.k)()],e.prototype,"cellSave",void 0),Be([Object(n.k)()],e.prototype,"cellSaved",void 0),Be([Object(n.k)()],e.prototype,"resizeStart",void 0),Be([Object(n.k)()],e.prototype,"resizing",void 0),Be([Object(n.k)()],e.prototype,"resizeStop",void 0),Be([Object(n.k)()],e.prototype,"keyPressed",void 0),Be([Object(n.k)()],e.prototype,"beforeDataBound",void 0),Be([Object(n.k)()],e.prototype,"contextMenuOpen",void 0),Be([Object(n.k)()],e.prototype,"contextMenuClick",void 0),Be([Object(n.k)()],e.prototype,"columnMenuOpen",void 0),Be([Object(n.k)()],e.prototype,"columnMenuClick",void 0),Be([Object(n.k)()],e.prototype,"checkBoxChange",void 0),Be([Object(n.k)()],e.prototype,"beforeCopy",void 0),Be([Object(n.k)()],e.prototype,"beforePaste",void 0),Be([Object(n.k)()],e.prototype,"beforeAutoFill",void 0),Be([Object(n.k)()],e.prototype,"columnDataStateChange",void 0),Be([Object(n.k)()],e.prototype,"dataStateChange",void 0),Be([Object(n.k)()],e.prototype,"dataSourceChanged",void 0),Be([Object(n.k)()],e.prototype,"exportGroupCaption",void 0),Be([Object(n.k)()],e.prototype,"lazyLoadGroupExpand",void 0),Be([Object(n.k)()],e.prototype,"lazyLoadGroupCollapse",void 0),e=Le=Be([n.q],e),e})();function Je(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]}let $e=(()=>{class e{constructor(e,t){this.isAsyncPrint=!1,this.defered=new l.c,this.parent=e,this.parent.isDestroyed||(this.parent.on(O,this.isContentReady(),this),this.parent.addEventListener(f,this.actionBegin.bind(this)),this.parent.on(j,this.onEmpty.bind(this)),this.parent.on("hierarchyprint",this.hierarchyPrint,this),this.scrollModule=t)}isContentReady(){return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?()=>{this.defered.promise.then(()=>{this.contentReady()}),this.isPrintGrid()&&this.hierarchyPrint()}:this.contentReady}hierarchyPrint(){this.removeColGroup(this.parent);let e=window.printGridObj;e&&!e.element.querySelector("[aria-busy=true")&&e.printModule.defered.resolve()}print(){this.renderPrintGrid(),this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWind.moveTo(0,0),this.printWind.resizeTo(screen.availWidth,screen.availHeight)}onEmpty(){this.isPrintGrid()&&this.contentReady()}actionBegin(){this.isPrintGrid()&&(this.isAsyncPrint=!0)}renderPrintGrid(){let e=this.parent,t=Object(n.F)("div",{id:this.parent.element.id+"_print",className:e.element.className+" e-print-grid"});document.body.appendChild(t);let i=new Qe(Jt(e,e.hierarchyPrintMode));if(e.isFrozenGrid()&&!e.getFrozenColumns())for(let l=0;l<i.columns.length;l++)i.columns[l]=Object(n.K)({},i.columns[l]),i.columns[l].freeze=void 0;this.parent.isAngular&&(i.viewContainerRef=this.parent.viewContainerRef),i.load=()=>{},i.query=e.getQuery().clone(),window.printGridObj=i,i.isPrinting=!0;let s=i.getInjectedModules(),r=e.getInjectedModules();s&&s.length===r.length||i.setInjectedModules(r),e.notify("printGrid-Init",{element:t,printgrid:i}),this.parent.log("exporting_begin",this.getModuleName()),i.registeredTemplate=this.parent.registeredTemplate,i.appendTo(t),i.trigger=e.trigger}contentReady(){if(this.isPrintGrid()){let e=this.parent;if(this.isAsyncPrint)return void this.printGrid();let t={requestType:"print",element:e.element,selectedRows:e.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:e.hierarchyPrintMode};if(this.isAsyncPrint||e.trigger("beforePrint",t),t.cancel)return void Object(n.I)(e.element);this.isAsyncPrint||this.printGrid()}}printGrid(){let e=this.parent;if("auto"!==e.height){let t=this.scrollModule.getCssProperties(),i=e.element.querySelector(".e-content"),s=e.element.querySelector(".e-gridheader");i.style.height="auto",i.style.overflowY="auto",s.style[t.padding]="",s.firstElementChild.style[t.border]=""}e.allowGrouping&&(e.groupSettings.columns.length?this.removeColGroup(e):e.element.querySelector(".e-groupdroparea").style.display="none");for(let i of[].slice.call(e.element.querySelectorAll(".e-content")))i.style.overflowX="hidden";let t=e.element.querySelectorAll(".e-spin-show");for(let i of[].slice.call(t))Object(n.A)(i,["e-spin-hide"],["e-spin-show"]);this.printGridElement(e),e.isPrinting=!1,delete window.printGridObj,e.trigger("printComplete",{element:e.element}),this.parent.log("exporting_complete",this.getModuleName())}printGridElement(e){Object(n.A)(e.element,["e-print-grid-layout"],["e-print-grid"]),e.isPrinting&&Object(n.I)(e.element),this.printWind=Object(n.gb)(e.element,this.printWind)}removeColGroup(e){let t=e.groupSettings.columns.length,i=e.element,s="#"+e.element.id;if(!t)return;let r=Object(n.mb)(s+"captioncell.e-groupcaption",i),l=r[t-1].getAttribute("colspan");for(let n=0;n<r.length;n++)r[n].setAttribute("colspan",l);let a=Object(n.mb)(`colgroup${s}colGroup`,i),o=Object(n.mb)(".e-content colgroup",i);this.hideColGroup(a,t),this.hideColGroup(o,t)}hideColGroup(e,t){for(let i=0;i<e.length;i++)for(let s=0;s<t;s++)e[i].children[s].style.display="none"}isPrintGrid(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting}destroy(){this.parent.isDestroyed||(this.parent.off(O,this.contentReady.bind(this)),this.parent.removeEventListener(f,this.actionBegin.bind(this)),this.parent.off(j,this.onEmpty.bind(this)),this.parent.off("hierarchyprint",this.hierarchyPrint))}getModuleName(){return"print"}}return e.printGridProp=[...Je(),"beforePrint","printComplete","load"],e})();function Ze(e,t,i){return Object(n.X)(e)||""===e?"":l.b.getObject(e,t)}function et(e,t){requestAnimationFrame(()=>{try{t(null,e())}catch(i){t(i)}})}function tt(e){return!Object(n.X)(e)&&!Object(n.X)(e.columns)&&e.columns.length>0}function it(e,t){let i=e.columns,s=t.columns;for(let r=0;r<i.length;r++)if(s.length-1>=r)if(s[r].columns)for(let e=0;e<s[r].columns.length;e++)i[r].columns[e].type=s[r].columns[e].type;else i[r].type=s[r].type}let st=0;function rt(e,t){st=0;let i=t.groupSettings.columns.length,s=e.gSummary,r=0,l="aggregatesCount";if(s===e.data.count)return t.groupSettings.columns.length&&!Object(n.X)(e[l])&&e[l]?1!==t.groupSettings.columns.length?st+=0!==e.indent&&s<2?e.gSummary*(i-e.indent+(i-e.indent)*e[l]):e.gSummary*(i-e.indent+(i-e.indent-1)*e[l])+e[l]:1===t.groupSettings.columns.length&&(st+=e.gSummary*(i-e.indent)+e[l]):t.groupSettings.columns.length&&(st+=1!==t.groupSettings.columns.length?e.gSummary*(t.groupSettings.columns.length-e.indent):e.gSummary),st;for(let a=0,o=e.data.items.length;a<o;a++){let s=e.data.items[a];st+=s.items.length+(i===t.columns.length||Object(n.X)(s.items.records)?0:s.items.records.length),r+=Object(n.X)(s.items.records)||Object(n.X)(e[l])?s.items.length:s.items.records.length,s.items.GroupGuid&&0!==s.items.childLevels&&nt(s)}return st+=e.data.items.length,Object(n.X)(e[l])||e[l]&&st&&0!==r&&(st+=(st-r)*e[l]+e[l]),st}function nt(e){for(let t=0,i=e.items.length;t<i;t++){let i=e.items[t];st+=i.count,0!==i.items.childLevels&&nt(i)}}function lt(e,t){let i=[];for(let s=0,r=e.length;s<r;s++){let r=t(e[s],s);Object(n.X)(r)||i.push(r)}return i}function at(e){let t=[];for(let i=0;i<e.length;i++)t.push(Object(n.K)({},gt(e[i]),{},!0));return t}function ot(e){if(e)try{if(document.querySelectorAll(e).length)return Object(n.E)(document.querySelector(e).innerHTML.trim())}catch(t){return Object(n.E)(e)}}function ht(e,t){let i={},s=["style","class"];Object(n.K)(i,t,{}),"style"in i&&(Object(n.ob)(e,i[s[0]]),delete i[s[0]]),"class"in i&&(Object(n.v)([e],i[s[1]]),delete i[s[1]]),Object(n.x)(e,i)}function dt(e,t,i,s){let r=Object(n.K)(e,t,i),l=Object.keys(r);for(let n=0;n<l.length;n++)s&&-1!==s.indexOf(l[n])&&delete r[l[n]];return r}function ct(e,t=0){for(let i=0,s=e.length;i<s;i++)e[i].columns?(e[i].index=Object(n.X)(e[i].index)?t:e[i].index,t++,t=ct(e[i].columns,t)):(e[i].index=Object(n.X)(e[i].index)?t:e[i].index,t++);return t}function pt(e,t,i){for(let s=0,r=e.length;s<r;s++){let r;"string"==typeof e[s]?r=new b({field:e[s]},i):e[s]instanceof b?r=e[s]:e[s].columns?(e[s].columns=pt(e[s].columns,null,i),r=new b(e[s],i)):r=new b(e[s],i),r.type&&"checkbox"===r.type.toLowerCase()&&(r.allowReordering=!1),r.headerText=Object(n.X)(r.headerText)?r.foreignKeyValue||r.field||"":r.headerText,r.foreignKeyField=r.foreignKeyField||r.field,r.valueAccessor=("string"==typeof r.valueAccessor?Object(n.V)(r.valueAccessor,window):r.valueAccessor)||Ze,r.width=t&&Object(n.X)(r.width)?200:r.width,Object(n.X)(r.visible)&&(r.visible=!0),e[s]=r}return e}function ut(e,t,i){let s,r=e.querySelector("span"),l=e.parentElement.getBoundingClientRect(),a=t.target.getBoundingClientRect();r.className=i,e.style.display="",s=(Object(n.X)(t.clientY)?t.changedTouches[0].clientY:t.clientY)>e.offsetHeight+10,e.style.top=a.top-l.top+(s?-(e.offsetHeight+10):e.offsetHeight+10)+"px",e.style.left=function(e,t,i,s){let r=e.offsetWidth/2,n=vt(t).x;return n-i.left<r?i.left-s:i.right-n<r?i.right-s-2*r:n-s-r}(e,t,a,l.left)+"px",s?(e.querySelector(".e-downtail").style.display="",e.querySelector(".e-uptail").style.display="none"):(e.querySelector(".e-downtail").style.display="none",e.querySelector(".e-uptail").style.display="")}function gt(e){return e instanceof n.e?Object(n.V)("properties",e):e}function mt(e,t,i){let s=e;for(;s&&!(i?s.id===t:s.classList.contains(t));)s=s.parentElement;return s}function bt(e,t){let i=-1;for(let s=0,r=t.length;s<r;s++)if(t[s].isEqualNode(e)){i=s;break}return i}function ft(e,t){for(let i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1}function yt(e){let t=[];for(let i=0,s=e.length;i<s;i++)e[i].hasOwnProperty("properties")?t.push(e[i].properties):t.push(e[i]);return t}function Ct(e,t){let i=[].slice.call(e.querySelectorAll(t));for(let s=0;s<i.length;s++)Object(n.hb)(i[s])}function vt(e){let t={};return t.x=Object(n.X)(e.clientX)?e.changedTouches[0].clientX:e.clientX,t.y=Object(n.X)(e.clientY)?e.changedTouches[0].clientY:e.clientY,t}let wt=0;function St(e){return e+wt++}function Ot(e,t){for(let i=0,s=t.length;i<s;i++)e.appendChild(s===t.length?t[i]:t[0]);return e}function xt(e,t,i){let s=e,r=[];for(;s;)(i?s.id===t:s.classList.contains(t))&&r.push(s),s=s.parentElement;return r}function jt(e,t,i,s){if("Custom"===e){let e=i.customAggregate;return"string"==typeof e&&(e=Object(n.V)(e,window)),e?e.call(s,t,i):""}return i.field in t||t instanceof Array?l.b.aggregates[e.toLowerCase()](t,i.field):null}let Rt,Dt=null;function Et(){if(null!==Dt)return Dt;let e=document.createElement("div"),t=0;return e.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth|0,document.body.removeChild(e),Dt=t}function It(e){return e.split(".").length>1}function Mt(e=""){return e.replace(/\./g,"___")}function Ft(e=""){return e.replace(/___/g,".")}function Tt(e,t,i){let s=mt(i,"e-row"),r=!s||s&&!s.classList.contains("e-insertedrow");return"beginEdit"===t&&r?!(e.isIdentity||e.isPrimaryKey||!e.allowEditing):!("add"===t&&e.isIdentity||r&&!e.allowEditing&&!e.isIdentity&&!e.isPrimaryKey)}function kt(e){let t=Object(n.lb)("#"+e.element.id+"EditConfirm",e.element);return"Batch"===e.editSettings.mode&&Object(n.mb)(".e-updatedtd",e.element).length&&e.editSettings.showConfirmDialog&&(!t||t.classList.contains("e-popup-close"))}function zt(e,t){e=e instanceof Array?e:[e];for(let i=0;i<e.length;i++)t?e[i].classList.add("e-wrap"):e[i].classList.remove("e-wrap")}function At(e,t,i){let s,r=e.getService("valueFormatter");switch("date"!==t.type&&"datetime"!==t.type||(s={type:t.type,skeleton:t.format},Object(n.W)()&&i&&(s.isServerRendered=i),"string"==typeof t.format&&"yMd"!==t.format&&(s.format=t.format)),t.type){case"date":case"datetime":t.setFormatter(r.getFormatFunction(s)),t.setParser(r.getParserFunction(s));break;case"number":t.setFormatter(r.getFormatFunction({format:t.format})),t.setParser(r.getParserFunction({format:t.format}))}}function Lt(e,t,...i){for(let s=0,r=e.length;s<r;s++)t?(Object(n.A)(e[s],[...i],[]),e[s].setAttribute("aria-selected","true")):(Object(n.A)(e[s],[],[...i]),e[s].removeAttribute("aria-selected"))}function Bt(e,t,i){let s=t.element.style.display;t.element.style.display="block";let r,n=t.width;if(i.enableRtl){r=Object(a.e)(e,"left","bottom"),t.element.style.top=r.top+e.getBoundingClientRect().height-35+"px",t.element.style.display=s;let i=r.left-n+e.clientWidth;t.element.style.left=i<1?n+i+-16+"px":i-16+"px"}else{r=Object(a.f)(e,t.element),t.element.style.display=s,t.element.style.top=r.top+e.getBoundingClientRect().height-5+"px";let i=r.left-n+e.clientWidth;t.element.style.left=i<1?n+i-16+"px":i+-4+"px"}}function Pt(e,t){e.popup.element.style.zIndex=(t.zIndex+1).toString()}function qt(e){let t=e.querySelector(".e-frame"),i=t.previousSibling;t.classList.contains("e-check")?(i.checked=!1,Object(n.A)(t,["e-uncheck"],["e-check"])):(i.checked=!0,Object(n.A)(t,["e-check"],["e-uncheck"]))}function Vt(e,t){e.checked=t}function Ht(e,t,i){let s=Object(n.F)("div",{className:i});return s.appendChild(t),s.setAttribute("uid",e),s}function Nt(e,t){Object(n.ib)([e],["e-check","e-stop","e-uncheck"]),e.classList.add(t?"e-check":"e-uncheck")}function Wt(e,t,i){for(let r=0;r<t.length;r++)Object(n.qb)(t[r].field,Xt(t[r],i),e.foreignKeyData);let s=e.cells;for(let r=0;r<s.length;r++)s[r].isForeignKey&&Object(n.qb)("foreignKeyData",Object(n.V)(s[r].column.field,e.foreignKeyData),s[r])}function Xt(e,t,i,s){let r=e.foreignKeyField,a=Object(n.X)(i)?Ze(e.field,t):i;a=Object(n.X)(a)?"":a;let o=new l.g,h=s||(e.dataSource instanceof l.a&&e.dataSource.dataSource.json.length?e.dataSource.dataSource.json:e.columnData);return a.getDay?o.where(Kt({field:r,operator:"equal",value:a,matchCase:!1})):o.where(r,"==",a,!1),new l.a(h).executeLocal(o)}function Gt(e,t){let i;return t.some(t=>(i=t,t.foreignKeyValue===e))&&i}function Kt(e,t){let i,s,r,a=Object(n.K)({},gt(e)),o=Object(n.K)({},gt(e));if(Object(n.X)(e.value))return i=new l.f(a.field,a.operator,a.value,!1),i;let h=new Date(e.value);if("equal"===e.operator||"notequal"===e.operator){"datetime"===t?(s=new Date(h.setSeconds(h.getSeconds()-1)),r=new Date(h.setSeconds(h.getSeconds()+2)),e.value=new Date(h.setSeconds(r.getSeconds()-1))):(s=new Date(h.setHours(0)-1),r=new Date(h.setHours(24))),a.value=s,o.value=r,"equal"===e.operator?(a.operator="greaterthan",o.operator="lessthan"):"notequal"===e.operator&&(a.operator="lessthanorequal",o.operator="greaterthanorequal");let n=new l.f(a.field,a.operator,a.value,!1),d=new l.f(o.field,o.operator,o.value,!1);i="equal"===e.operator?n.and(d):n.or(d)}else"string"==typeof a.value&&(a.value=new Date(a.value)),i=new l.f(a.field,a.operator,a.value,!1);return e.setProperties?e.setProperties({ejpredicate:i},!0):e.ejpredicate=i,i}function Ut(e,t,i){t=t&&i&&i.isRowDragable()?t+1:t;let s=e.cloneNode(!0);for(let r=0;r<t;r++)s.removeChild(s.children[0]);for(let r=t,n=e.childElementCount;r<n;r++)e.removeChild(e.children[e.childElementCount-1]);return s}function Yt(e){return e.enableVirtualization&&e.groupSettings.columns.length>0&&e.isVirtualAdaptive}function _t(e="",t){if(e){let i=t,s=e.split(".");for(let e=0;e<s.length&&!Object(n.X)(i);e++)i=i[s[e]];return i}}function Qt(e,t){let i,s=new n.n;return i="date"===t?"object"==typeof e?s.getDatePattern({type:e.type?e.type:"date",format:e.format},!1):Object(n.W)()?s.getDatePattern({type:"dateTime",format:e},!1):s.getDatePattern({type:"dateTime",skeleton:e},!1):"object"==typeof e?s.getDatePattern({type:e.type?e.type:"dateTime",format:e.format},!1):Object(n.W)()?s.getDatePattern({type:"dateTime",format:e},!1):s.getDatePattern({type:"dateTime",skeleton:e},!1),i}function Jt(e,t="Expanded"){let i={};if(!e)return i;let s=e.isFrozenGrid()&&!e.getFrozenColumns();for(let r of $e.printGridProp)i[r]="columns"===r?yt(s?e.getColumns():e[r]):"allowPaging"===r?"CurrentPage"===e.printMode:gt(e[r]);return e.childGrid&&"None"!==t&&(i.expandedRows=function(e,t){let i=e.getRowsObject(),s={};for(const r of i)if(r.isExpand&&!r.isDetailRow){let i=e.allowPaging&&"AllPages"===e.printMode?r.index+e.pageSettings.currentPage*e.pageSettings.pageSize-e.pageSettings.pageSize:r.index;s[i]={},s[i].isExpand=!0,s[i].gridModel=Jt(r.childGrid,t),s[i].gridModel.query=e.childGrid.query}return s}(e,t)),i}function $t(e,t,i,s){let r=e||{},l=arguments.length;s&&(l-=1);for(let a=1;a<l;a++){if(!arguments[a])continue;let e=arguments[a],t=Object.keys(Object.getPrototypeOf(e)).length?Object.keys(e).concat(Zt(e)):Object.keys(e);for(let i=0;i<t.length;i++){let l,a=r[t[i]],o=e[t[i]];s&&(Object(n.Y)(o)||Array.isArray(o))?Object(n.Y)(o)?(l=a||{},r[t[i]]=Object(n.K)({},l,o,s)):(l=a||[],r[t[i]]=Object(n.K)([],l,o,s)):r[t[i]]=o}}return r}function Zt(e){let t=[];for(;Object.getPrototypeOf(e)&&Object.keys(Object.getPrototypeOf(e)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(e))),e=Object.getPrototypeOf(e);return t}function ei(e){let t=0;for(let i=0;i<e.length;i++){let s=ti(e[i],0);t<s&&(t=s)}return t+1}function ti(e,t){let i=t,s=[];if(e.columns){t++;for(let i=0;i<e.columns.length;i++)s[i]=ti(e.columns[i],t);for(let e=0;e<s.length;e++)i<s[e]&&(i=s[e]);t=i}return t}var ii;function si(e,t){e.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function ri(e,t){if(e&&t){let i=Object(n.C)(e,".e-row").getBoundingClientRect().height,s=Object(n.C)(t,".e-row").getBoundingClientRect().height;i>s?t.style.height=i+"px":e.style.height=s+"px"}}function ni(e,t){let i=t.getContent().firstElementChild.offsetHeight;return e&&e.getBoundingClientRect().top>i}function li(e,t){return e&&e.getBoundingClientRect().top<t}function ai(e,t){let i=t.getRowHeight(),s=t.getContent().firstElementChild.scrollTop/i;return e<s+t.getContent().firstElementChild.offsetHeight/i&&e>s}function oi(e,t){let i,s=e.getPrimaryKeyFieldNames()[0];return e.getCurrentViewRecords().filter((e,r)=>{e[s]===t[s]&&(i=r)}),i}function hi(e,t){let i;i=function(e){let t=new l.h,i=new l.a({url:"",adaptor:new l.h}),s=t.processQuery(i,e);return JSON.parse(s.data)}(t);let s=new l.c;return i.dataSource=s.resolve,i.action=e,{state:i,deffered:s}}function di(e){let t=e.getVisibleColumns(),i=0,s=0;for(let r=0;r<t.length;r++)Object(n.ab)(t[r].width)?s++:-1!==t[r].width.toString().indexOf("%")&&i++;return("auto"===e.width||"string"==typeof e.width&&-1!==e.width.indexOf("%"))&&"chrome"!==n.d.info.name&&!e.groupSettings.showGroupedColumn&&e.groupSettings.columns.length&&i&&!s}function ci(e,t,i,s){let r=s||0;for(let n=0;n<t.length;n++)if(t[n].isDataRow){t[n].index=r,t[n].isAltRow=!!e.enableAltRow&&r%2!=0,i[n].setAttribute("aria-rowindex",r.toString()),t[n].isAltRow?i[n].classList.add("e-altrow"):i[n].classList.remove("e-altrow");for(let e=0;e<i[n].cells.length;e++)i[n].cells[e].setAttribute("index",r.toString());r++}t.length||e.renderModule.emptyRow(!0)}function pi(e,t,i,s){let r=e.dataToBeUpdated[i].concat(t[i]).reduce((e,t)=>(e[t[s]]=void 0===e[t[s]]?t:Object.assign(e[t[s]],t),e),{});e.dataToBeUpdated[i]=Object.keys(r).map(e=>r[e])}function ui(e){if(e.isFrozenGrid()){e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));let t="Left-Right"===e.getFrozenMode()?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";e.contentModule.freezeRowElements=[].slice.call(e.element.querySelectorAll(t)),"Left-Right"===e.getFrozenMode()&&(e.contentModule.frozenRightRowElements=[].slice.call(e.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function gi(e){return e.tableIndex===e.getTablesCount()&&(e.tableIndex=0),++e.tableIndex}function mi(e,t){let i,s=e.getFrozenColumns(),r=e.getFrozenLeftColumnsCount(),l=e.getFrozenRightColumnsCount();return!s||r||l?s||!r&&!l||(i=function(e,t){let i,s=e.getFrozenLeftColumnsCount(),r=e.getFrozenRightColumnsCount(),l=Object(n.X)(t)?gi(e):t;return s&&!r?1===l?i="frozen-left":2===l&&(i="movable"):r&&!s?1===l?i="frozen-right":2===l&&(i="movable"):1===l?i="frozen-left":2===l?i="movable":3===l&&(i="frozen-right"),i}(e,t)):i=function(e,t){let i,s=Object(n.X)(t)?gi(e):t;return 1===s?i="frozen-left":2===s&&(i="movable"),i}(e,t),i}function bi(e,t,i){let s=e.getFrozenLeftCount(),r=e.getMovableColumnsCount(),n=e.getFrozenRightColumnsCount(),l=e.getFrozenMode(),a=e.isRowDragable()?1:0,o="Right"===l?s+r:s+r+a,h="Right"===l?s:s+a,d="Right"===l?t.length-n-a:n?t.length-n:t.length;return"frozen-left"===i?t=t.slice(0,s?s+a:t.length):"frozen-right"===i?t=t.slice(o,t.length):"movable"===i&&(t=t.slice(h,d)),t}function fi(e,t,i,s){(i[0].length||s)&&t("frozen-left",i[0]),e.isFrozenGrid()&&(i[1].length||s)&&t("movable",i[1]),"Left-Right"!==e.getFrozenMode()&&"Right"!==e.getFrozenMode()||!i[2].length&&!s||t("frozen-right",i[2])}function yi(e){return["Right"!==e.getFrozenMode()?e.getRowsObject():[],e.getMovableRowsObject(),e.getFrozenRightRowsObject()]}function Ci(e){return["Right"!==e.getFrozenMode()?e.getAllDataRows(!0):[],e.getAllMovableDataRows(!0),e.getAllFrozenRightDataRows(!0)]}function vi(e,t,i){let s=e.children.length,r=0;for(let n=0;n<s;n++,r++)n>=t&&n<i||(e.removeChild(e.children[r]),r--)}function wi(e,t,i){return"movable"===t.getFreezeTableName()?[].slice.call(e.getMovableDataRows()[i].querySelectorAll(".e-rowcell")):"frozen-right"===t.getFreezeTableName()?[].slice.call(e.getFrozenRightDataRows()[i].querySelectorAll(".e-rowcell")):[].slice.call(e.getDataRows()[i].querySelectorAll(".e-rowcell"))}function Si(e,t,i,s){let r=e.getFrozenLeftCount(),n=e.getMovableColumnsCount();return s="movable"===t.getFreezeTableName()?s-r:"frozen-right"===t.getFreezeTableName()?s-(r+n):s,wi(e,t,i)[s]}function Oi(e,t,i,s,r,n){"frozen-left"===e.getFreezeTableName()||!t&&"frozen-right"===e.getFreezeTableName()||1===n?i[Mt(e.field)]=e.validationRules:"movable"!==e.getFreezeTableName()&&e.getFreezeTableName()?"frozen-right"===e.getFreezeTableName()&&(r[Mt(e.field)]=e.validationRules):s[Mt(e.field)]=e.validationRules}function xi(e){let t;return e.isFrozenGrid()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getMovableHeaderTbody():e.getMovableContentTbody()),t}function ji(e){let t;return"Left-Right"===e.getFrozenMode()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getFrozenRightHeaderTbody():e.getFrozenRightContentTbody()),t}function Ri(e,t,i,s,r,n,l){e&&s&&l(e,s),t&&r&&l(t,r),i&&n&&l(i,n)}function Di(e,t){let i,s=new n.n;if("number"===t)try{i=s.getNumberPattern({format:e,currency:this.currency,useGrouping:!0},!0)}catch(r){i=e}else if("date"===t||"time"===t||"datetime"===t)try{i=s.getDatePattern({skeleton:e,type:t},!1)}catch(r){try{i=s.getDatePattern({format:e,type:t},!1)}catch(r){i=e}}else i=e;if("number"!==t){let e={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};i=i.replace(/G|H|c|'| a|yy|y|EEEE|E/g,t=>e[t])}return i}!function(e){e.timer=null}(ii||(ii={}));class Ei{constructor(e){this.existingPredicate={},this.foreignKeyQuery=new l.g,this.filterState=!0,this.values={},this.renderEmpty=!1,this.parent=e,this.id=this.parent.element.id,this.valueFormatter=new m(this.parent.locale),this.cBoxTrue=Object(o.f)(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=Object(o.f)(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Object(n.v)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}destroy(){this.closeDialog()}wireEvents(){n.l.add(this.dlg,"click",this.clickHandler,this),n.l.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=Object(n.G)(this.searchBoxKeyUp,200),n.l.add(this.dlg.querySelector(".e-searchinput"),"keyup",this.searchHandler,this)}unWireEvents(){n.l.remove(this.dlg,"click",this.clickHandler),n.l.remove(this.dlg,"keyup",this.keyupHandler);let e=this.dlg.querySelector(".e-searchinput");e&&n.l.remove(e,"keyup",this.searchHandler)}foreignKeyFilter(e,t,i){let s={},r=[],n=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(n.where(i)).then(i=>{this.options.column.columnData=i.result,this.parent.notify("generateQuery",{predicate:s,column:this.options.column}),e.ejpredicate=s.predicate.predicates;let n=s.predicate.predicates;for(let e=0;e<n.length;e++)r.push({field:n[e].field,predicate:"or",matchCase:n[e].ignoreCase,ignoreAccent:n[e].ignoreAccent,operator:n[e].operator,value:n[e].value,type:this.options.type});e.filterCollection=r.length?r:t.filter(e=>e.field=this.options.field),this.options.handler(e)})}foreignFilter(e,t){let i=new l.f(this.options.column.foreignKeyValue,this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",t,!0,this.options.ignoreAccent);this.foreignKeyFilter(e,[e.filterCollection],i)}searchBoxClick(e){e.target.classList.contains("e-searchclear")&&(this.sInput.value="",this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())}searchBoxKeyUp(e){this.refreshCheckboxes(),this.updateSearchIcon()}updateSearchIcon(){this.sInput.value.length?Object(n.A)(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):Object(n.A)(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])}getLocalizedLabel(e){return this.localeObj.getConstant(e)}updateDataSource(){let e=this.options.dataSource;if(!(e instanceof l.a))for(let t=0;t<e.length;t++)if("object"!=typeof e){let i={};i[this.options.field]=e[t],e[t]=i}}updateModel(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new l.g,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length}getAndSetChkElem(e){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!e.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);let e={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};h.c.createInput(e,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox}showDialog(e){let t={requestType:"filterbeforeopen",columnName:this.options.field,columnType:this.options.type,cancel:!1};Object(n.W)()&&!this.parent.isJsComponent||(t.filterModel=this),this.parent.notify("cbox-filter-begin",t),t.cancel||(this.dialogObj=new a.a({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),width:!Object(n.X)(mt(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this)}),this.dialogObj.isStringTemplate=!0,this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),this.parent.element.appendChild(this.dlg),this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=this.options.height+"px",this.dialogObj.show(),this.wireEvents(),Object(a.g)({target:this.spinner},this.parent.createElement),Object(a.n)(this.spinner),this.getAllData())}dialogCreated(e){n.d.isDevice?this.dialogObj.position={X:"center",Y:"center"}:Bt(this.options.target,this.dialogObj,this.parent),this.parent.notify("filterDialogCreated",e)}openDialog(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)}closeDialog(){if(this.dialogObj&&!this.dialogObj.isDestroyed){let e=this.options.columns.filter(e=>e.getFilterItemTemplate()),t=this.parent.registeredTemplate;e.length&&!Object(n.X)(t)&&t.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.isReact&&(this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.renderTemplates()),this.parent.notify("filter-menu-close",{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),Object(n.hb)(this.dlg),this.dlg=null}}clearFilter(){let e={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify("filter-Prevent",e),e.cancel||this.options.handler({action:"clear-filter",field:this.options.field})}btnClick(e){if(this.filterState){if("input"===e.target.tagName.toLowerCase()&&e.target.classList.contains("e-searchinput")){let t=e.target.value;"boolean"===this.options.column.type&&(""!==t&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(t.toLowerCase())?t=!0:""!==t&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(t.toLowerCase())&&(t=!1));let i={action:"filtering",filterCollection:{field:this.options.field,operator:this.options.isRemote?"string"===this.options.column.type?"contains":"equal":"date"===this.options.column.type||"datetime"===this.options.column.type||"boolean"===this.options.column.type?"equal":"contains",value:t,matchCase:!1,type:this.options.column.type},field:this.options.field};null!=t&&""!==t?this.isForeignColumn(this.options.column)?this.foreignFilter(i,t):this.options.handler(i):this.closeDialog()}else if(13===e.keyCode)this.fltrBtnHandler();else{let t=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===t?this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===t&&this.clearFilter()}this.closeDialog()}else"input"!==e.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog())}fltrBtnHandler(){let e,t,i,s,r=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),l=r,a="equal",o=this.searchBox.querySelector(".e-searchinput"),h={field:this.options.field,predicate:"or",uid:this.options.uid,operator:a,type:this.options.type,matchCase:this.options.allowCaseSensitive,ignoreAccent:this.options.ignoreAccent},d=this.itemsCnt!==r.length&&this.itemsCnt-r.length<r.length;d&&""===o.value&&(a="notequal",r=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),h.predicate="and",h.operator="notequal");let c=[];if(r.length!==this.itemsCnt||o.value&&""!==o.value){for(let t=0;t<r.length;t++){e=this.values[mt(r[t],"e-ftrchk").getAttribute("uid")],s=Object(n.K)({},{value:e},h),e&&!e.toString().length&&(s.operator=d?"notequal":"equal"),""===e||Object(n.X)(e)?c=c.concat(Ei.generateNullValuePredicates(h)):c.push(s);let i={instance:this,handler:this.fltrBtnHandler,arg1:s.field,arg2:s.predicate,arg3:s.operator,arg4:s.matchCase,arg5:s.ignoreAccent,arg6:s.value,cancel:!1};if(this.parent.notify("filter-Prevent",i),i.cancel)return}"date"!==this.options.type&&"datetime"!==this.options.type||(i=l.length-1,t=this.values[mt(l[i],"e-ftrchk").getAttribute("uid")],Object(n.X)(t)&&d&&c.push({field:h.field,matchCase:h.matchCase,operator:"equal",predicate:"and",value:null})),this.initiateFilter(c)}else this.clearFilter()}static generateNullValuePredicates(e){let t=[];return"string"===e.type&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t}initiateFilter(e){let t,i=e[0];if(!Object(n.X)(i)){t=i.ejpredicate?i.ejpredicate:new l.f(i.field,i.operator,i.value,!i.matchCase,i.ignoreAccent);for(let i=1;i<e.length;i++)t=void 0!==e[i].ejpredicate?t[e[i].predicate](e[i].ejpredicate):t[e[i].predicate](e[i].field,e[i].operator,e[i].value,!e[i].matchCase,e[i].ignoreAccent);let s={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:l.f.or(t)};this.options.handler(s)}}isForeignColumn(e){return!!e.isForeignColumn&&e.isForeignColumn()}refreshCheckboxes(){let e=this.sInput.value,t=this.options.column,i=this.isForeignColumn(t)?this.foreignKeyQuery.clone():this.options.query.clone(),s=this.options.query.clone(),r=i.queries.filter(e=>e&&"onWhere"===e.fn)[0];i.queries=[],s.queries=[];let o,h="string"!==this.options.type&&parseFloat(e)?parseFloat(e):e,d=this.options.isRemote?"string"===this.options.type?"contains":"equal":this.options.type?"contains":"equal",c=this.options.ignoreAccent,p=this.isForeignColumn(t)?t.foreignKeyValue:t.field;h=""===h||void 0===h?void 0:h;let u=this.options.dataManager.adaptor.getModuleName;"boolean"===this.options.type&&(void 0!==h&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(h.toLowerCase())&&u?(u(),h=!0):void 0!==h&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(h.toLowerCase())&&u&&(u(),h=!1),d="equal"),"date"!==this.options.type&&"datetime"!==this.options.type||(h=this.valueFormatter.fromView(e,this.options.parserFn,this.options.type)),this.addDistinct(i);let g={requestType:"filtersearchbegin",filterModel:this,columnName:p,column:t,operator:d,matchCase:!0,ignoreAccent:c,filterChoiceCount:null,query:i,value:h};Object(n.W)()&&!this.parent.isJsComponent&&(g.filterModel={}),this.parent.trigger(f,g,u=>{if(u.operator=Object(n.W)()&&"none"!==u.excelSearchOperator?u.excelSearchOperator:u.operator,o=new l.f(p,u.operator,h,u.matchCase,u.ignoreAccent),"date"===this.options.type||"datetime"===this.options.type){if(d="equal",Object(n.X)(h)&&e.length)return;o=Kt({field:p,operator:d,value:h,matchCase:!0,ignoreAccent:c},this.options.type)}e.length?(o=Object(n.X)(r)?o:o.and(r.e),i.where(o)):Object(n.X)(r)||i.where(r.e),u.filterChoiceCount=Object(n.X)(u.filterChoiceCount)?1e3:u.filterChoiceCount;let g={};Object(a.n)(this.spinner),this.renderEmpty=!1,this.isForeignColumn(t)&&e.length?("result"in t.dataSource?new l.a(t.dataSource.result):t.dataSource).executeQuery(i).then(e=>{let i=this.options.column.columnData;this.options.column.columnData=e.result,this.parent.notify("generateQuery",{predicate:g,column:t}),g.predicate.predicates.length?s.where(g.predicate):this.renderEmpty=!0,this.options.column.columnData=i,s.take(u.filterChoiceCount),this.search(u,s)}):(i.take(u.filterChoiceCount),this.search(u,i))})}search(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)}getPredicateFromCols(e){let t=Ei.getPredicate(e),i=[],s={},r=void 0!==this.parent.getForeignKeyColumns,n=r?this.parent.getForeignKeyColumns():[];for(let a of Object.keys(t)){let e;r&&this.parent.getColumnByField(a).isForeignColumn()&&(e=Gt(a,n)),e?(this.parent.notify("generateQuery",{predicate:s,column:e}),s.predicate.predicates.length&&i.push(l.f.or(s.predicate.predicates))):i.push(t[a])}return i.length&&l.f.and(i)}getQuery(){return this.parent.getQuery?this.parent.getQuery().clone():new l.g}getAllData(){let e=this.getQuery();e.requiresCount(),this.addDistinct(e);let t={requestType:"filterchoicerequest",query:e,filterChoiceCount:null};Object(n.W)()&&!this.parent.isJsComponent||(t.filterModel=this),this.parent.trigger(f,t,t=>{t.filterChoiceCount=Object(n.X)(t.filterChoiceCount)?1e3:t.filterChoiceCount,e.take(t.filterChoiceCount),this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(t,e):this.processDataOperation(e,!0)})}addDistinct(e){let t=l.b.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),e.distinct(t),e}filterEvent(e,t){let i=hi(e,t);this.parent.trigger("dataStateChange",i.state),i.deffered.promise.then(e=>{this.dataSuccess(e)})}processDataOperation(e,t){this.options.dataSource=this.options.dataSource instanceof l.a?this.options.dataSource:new l.a(this.options.dataSource);let i=[],s=[];if(this.isForeignColumn(this.options.column)&&t){let t="result"in this.options.column.dataSource?new l.a(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,i.push(t.executeQuery(this.foreignKeyQuery)),s.push(e=>this.foreignKeyData=e)}i.push(this.options.dataSource.executeQuery(e)),s.push(this.dataSuccess.bind(this));let r=0;Promise.all(i).then(e=>{for(let t=0;t<e.length;t++)s[r++](e[t].result)})}dataSuccess(e){this.fullData=e;let t={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify("beforeCheckboxRenderer",t),t.executeQuery){let e=new l.g;if(this.parent.searchSettings&&this.parent.searchSettings.key.length){let t=this.parent.searchSettings,i=t.fields.length?t.fields:this.options.columns.map(e=>e.field);e.search(t.key,i,t.operator,t.ignoreCase,t.ignoreAccent)}if(this.options.filteredColumns.length){let t=[];for(let e=0;e<this.options.filteredColumns.length;e++){let i=this.options.filteredColumns[e];this.options.uid?(i.uid=i.uid||this.parent.getColumnByField(i.field).uid,i.uid!==this.options.uid&&t.push(this.options.filteredColumns[e])):i.field!==this.options.field&&t.push(this.options.filteredColumns[e])}let i=this.getPredicateFromCols(t);i&&e.where(i)}let i=new l.a(t.dataSource).executeLocal(e);this.filteredData=Ei.getDistinct(i,this.options.field,this.options.column,this.foreignKeyData).records||[]}this.processDataSource(null,!0,t.executeQuery?this.filteredData:t.dataSource),this.sInput.focus();let i={requestType:"filterafteropen",columnName:this.options.field,columnType:this.options.type};Object(n.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.parent.notify("cbox-filter-complete",i)}processDataSource(e,t,i){Object(a.n)(this.spinner),this.updateResult(),this.createFilterItems(i,t)}processSearch(e){this.processDataOperation(e)}updateResult(){this.result={};let e=this.getPredicateFromCols(this.options.filteredColumns),t=new l.g;e&&t.where(e);let i=new l.a(this.fullData).executeLocal(t);for(let s of i)this.result[_t(this.options.field,s)]=!0}clickHandler(e){let t=e.target,i=mt(t,"e-checkbox-wrapper");if(mt(t,"e-searchbox")&&this.searchBoxClick(e),i){let e=i.querySelector(".e-selectall");e?this.updateAllCBoxes(!e.classList.contains("e-check")):qt(i.parentElement),this.updateIndeterminatenBtn(),i.querySelector(".e-chk-hidden").focus()}this.setFocus(mt(i,"e-ftrchk"))}keyupHandler(e){this.setFocus(mt(e.target,"e-ftrchk"))}setFocus(e){let t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e.classList.add("e-chkfocus")}updateAllCBoxes(e){let t=[].slice.call(this.cBox.querySelectorAll(".e-frame"));for(let i of t)Nt(i,e),Vt(i.previousSibling,e)}dialogOpen(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.dialogObj.element.querySelector(".e-btn").focus())}createCheckbox(e,t,i){let s=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);Vt(s.querySelector("input"),t);let r=s.querySelector(".e-label"),l=$t({},i,{column:this.options.column,parent:this.parent});return r.innerHTML=!Object(n.X)(e)&&e.toString().length?e:this.getLocalizedLabel("Blanks"),Object(n.v)([r],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&(r.innerHTML="",this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate?(this.options.template(l,this.parent,"filterItemTemplate",null,null,null,r),this.parent.renderTemplates()):Ot(r,this.options.template(l,this.parent,"filterItemTemplate"))),s}updateIndeterminatenBtn(){let e=this.cBox.children.length-1,t=[],i=this.cBox.querySelector(".e-selectall"),s=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length,r=this.dialogObj.btnObj[0];r.disabled=!1;let l=i.previousSibling;Vt(l,!1),l.indeterminate=!1,e===s?(t=["e-check"],Vt(l,!0)):s?(t=["e-stop"],l.indeterminate=!0):(t=["e-uncheck"],r.disabled=!0),this.filterState=!r.disabled,r.dataBind(),Object(n.ib)([i],["e-check","e-stop","e-uncheck"]),Object(n.v)([i],t)}createFilterItems(e,t){let i=this.parent.createElement("div"),s=this.dialogObj.btnObj[0],r=-1;for(let l=0;l<e.length;l++){let t=Object(n.V)("ejValue",e[l]);(""===t||Object(n.X)(t))&&(r+=1)}if(this.itemsCnt=-1!==r?e.length-r:e.length,e.length&&!this.renderEmpty){let t=this.getLocalizedLabel("SelectAll"),r=this.createCheckbox(t,!1,{[this.options.field]:t}),a=Ht(St("cbox"),r,"e-ftrchk");a.querySelector(".e-frame").classList.add("e-selectall"),i.appendChild(a);let o=new l.f("field","equal",this.options.field);this.options.foreignKeyValue&&(o=o.or("field","equal",this.options.foreignKeyValue));let h,d=new l.a(this.options.filteredColumns).executeLocal((new l.g).where(o)).length;for(let s=0;s<e.length;s++){let t=St("cbox");this.values[t]=Object(n.V)("ejValue",e[s]);let r=Object(n.V)(this.options.field,e[s]);this.options.formatFn&&(r=this.valueFormatter.toView(r,this.options.formatFn));let l={value:r,column:this.options.column,data:e[s]};if(this.parent.notify("filter-cbox-value",l),r=l.value,""===r||Object(n.X)(r)){if(h)continue;h=!0}let a=this.createCheckbox(r,this.getCheckedState(d,this.values[t]),Object(n.V)("dataObj",e[s]));i.appendChild(Ht(t,a,"e-ftrchk"))}this.cBox.innerHTML="",Ot(this.cBox,[].slice.call(i.children)),this.updateIndeterminatenBtn(),s.disabled=!1}else i.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",Ot(this.cBox,[].slice.call(i.children)),s.disabled=!0;this.filterState=!s.disabled,s.dataBind();let o={requestType:"filterchoicerequest",dataSource:this.renderEmpty||Object(n.W)()&&this.parent.isServerRendered?[]:e};Object(n.W)()&&!this.parent.isJsComponent||(o.filterModel=this),this.parent.notify("cbox-filter-complete",o),Object(a.k)(this.spinner)}getCheckedState(e,t){return!this.isFiltered||!e||this.result[t]}static getDistinct(e,t,i,s){let r,a=e.length,o=[],h={},d=!(!i||!i.isForeignColumn)&&i.isForeignColumn();for(;a--;)if(r=e[a],r=_t(t,r),!(r in h)){let l={};if(l.ejValue=r,h[r]=!0,d){let t=Xt(i,{},r,s)[0];Object(n.qb)("foreignKeyData",t,e[a]),r=Object(n.V)(i.foreignKeyValue,t)}Object(n.qb)(t,Object(n.X)(r)?null:r,l),Object(n.qb)("dataObj",e[a],l),o.push(l)}return l.b.group(l.b.sort(o,t,l.b.fnAscending),"ejValue")}static getPredicate(e){let t=l.b.distinct(e,"field",!0)||[],i=[],s={};for(let r=0;r<t.length;r++)i=new l.a(e).executeLocal((new l.g).where("field","equal",t[r].field)),0!==i.length&&(s[t[r].field]=Ei.generatePredicate(i));return s}static generatePredicate(e){let t,i,s=e?e.length:0;i=Ei.updateDateFilter(e[0]),i.ignoreAccent=!Object(n.X)(i.ignoreAccent)&&i.ignoreAccent,t="date"===i.type||"datetime"===i.type?Kt(i,i.type):i.ejpredicate?i.ejpredicate:new l.f(i.field,i.operator,i.value,!Ei.getCaseValue(i),i.ignoreAccent);for(let r=1;r<s;r++)e[r]=Ei.updateDateFilter(e[r]),s>2&&r>1&&"or"===e[r].predicate?t.predicates.push("date"===e[r].type||"datetime"===e[r].type?Kt(e[r],e[r].type):new l.f(e[r].field,e[r].operator,e[r].value,!Ei.getCaseValue(e[r]),e[r].ignoreAccent)):t="date"===e[r].type||"datetime"===e[r].type?"and"===e[r].predicate&&"equal"===e[r].operator?t.or(Kt(e[r],e[r].type),e[r].type,e[r].ignoreAccent):t[e[r].predicate](Kt(e[r],e[r].type),e[r].type,e[r].ignoreAccent):e[r].ejpredicate?t[e[r].predicate](e[r].ejpredicate):t[e[r].predicate](e[r].field,e[r].operator,e[r].value,!Ei.getCaseValue(e[r]),e[r].ignoreAccent);return t||null}static getCaseValue(e){return Object(n.X)(e.matchCase)?!("string"===e.type||Object(n.X)(e.type)&&"string"==typeof e.value):e.matchCase}static updateDateFilter(e){return("date"===e.type||"datetime"===e.type||e.value instanceof Date)&&(e.type=e.type||"date"),e}}class Ii extends Ei{constructor(e,t){super(e),this.customFilterOperators=t,this.isExcel=!0}getCMenuDS(e,t){let i={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]};i.date=i.number,i.datetime=i.number;let s=[];for(let r=0;r<i[e].length;r++)s.push(i[e][r].length?t?{text:this.getLocalizedLabel(i[e][r])+"...",iconCss:"e-icons e-icon-check "+(t===i[e][r].toLowerCase()?"":"e-emptyicon")}:{text:this.getLocalizedLabel(i[e][r])+"..."}:{separator:!0});return s}destroy(){this.dlg&&(this.unwireExEvents(),super.destroy()),this.cmenu&&this.cmenu.parentElement&&Object(n.hb)(this.cmenu)}createMenu(e,t,i,s){this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl");let r=this.parent.createElement("ul"),n=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&"grid"===this.parent.getModuleName()){let t=this.parent.getColumnHeaderByUid(s.uid).getAttribute("aria-sort"),i=this.parent.getColumnByField(s.field).allowSorting,n=i&&"Ascending"!==t?"e-excel-ascending":"e-disabled e-excel-ascending",l=i&&"Descending"!==t?"e-excel-descending":"e-disabled e-excel-descending",a=this.getLocalizedLabel("string"===e?"SortAtoZ":"datetime"===e||"date"===e?"SortByOldest":"SortSmallestToLargest"),o=this.getLocalizedLabel("string"===e?"SortZtoA":"datetime"===e||"date"===e?"SortByNewest":"SortLargestToSmallest");r.appendChild(this.createMenuElem(a,n,"e-sortascending")),r.appendChild(this.createMenuElem(o,l,"e-sortdescending"));let h=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});r.appendChild(h)}r.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",n)),"boolean"!==e&&r.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[e]),"e-submenu",i&&this.ensureTextFilter()?"e-icon-check":n+" e-emptyicon",!0)),this.menu.appendChild(r),this.parent.notify("before-filter-cmenu-open",{element:this.menu})}createMenuElem(e,t,i,s){let r=this.parent.createElement("li",{className:t+" e-menu-item"});return r.innerHTML=e,r.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+i}),r.firstChild),s&&r.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),r}wireExEvents(){n.l.add(this.dlg,"mouseover",this.hoverHandler,this),n.l.add(this.dlg,"click",this.clickExHandler,this)}unwireExEvents(){n.l.remove(this.dlg,"mouseover",this.hoverHandler),n.l.remove(this.dlg,"click",this.clickExHandler)}clickExHandler(e){let t=mt(e.target,"e-menu-item");t&&this.getLocalizedLabel("ClearFilter")===t.innerText.trim()&&(this.clearFilter(),this.closeDialog())}destroyCMenu(){this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),Object(n.hb)(this.cmenu))}hoverHandler(e){let t,i=e.target.querySelector(".e-contextmenu"),s=mt(e.target,"e-menu-item"),r=this.menu.querySelector(".e-focused");if(r&&r.classList.remove("e-focused"),s&&(s.classList.add("e-focused"),t=s.classList.contains("e-submenu")),i)return;if(!t){let e=this.menu.querySelector(".e-submenu");Object(n.X)(e)||e.classList.remove("e-selected"),this.isCMenuOpen=!1,this.destroyCMenu()}let l=this.ensureTextFilter();if(!this.isCMenuOpen&&t){s.classList.add("e-selected"),this.isCMenuOpen=!0;let t={items:this.getCMenuDS(this.options.type,l?l.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose};this.parent.element.appendChild(this.cmenu),this.menuObj=new p.a(t,this.cmenu);let i=this.menu.querySelector(".e-submenu").getBoundingClientRect(),r={top:0,left:0};if(n.d.isDevice){let e=this.getContextBounds(this.menuObj);r.top=(window.innerHeight-e.height)/2,r.left=(window.innerWidth-e.width)/2,this.closeDialog()}else r.top=n.d.isIE?window.pageYOffset+i.top:window.scrollY+i.top,r.left=this.getCMenuYPosition(this.dlg,this.menuObj);this.menuObj.open(r.top,r.left,e.target),si(this.parent.element,this.menuObj.element.parentElement)}}ensureTextFilter(){let e,t=this.existingPredicate[this.options.field];return t&&2===t.length?e="greaterthanorequal"===t[0].operator&&"lessthanorequal"===t[1].operator?"between":"customfilter":t&&1===t.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=t[0].operator),e}preventClose(e){e.event instanceof MouseEvent&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)}getContextBounds(e){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()}getCMenuYPosition(e,t){let i=this.getContextBounds(t).width,s=e.getBoundingClientRect(),r=e.offsetWidth-e.clientWidth;return r=r?r+1:0,s.right+i-this.parent.element.clientWidth<1?s.right+1-r:s.left-i-1+r}openDialog(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),this.dialogObj.dataBind();let t=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter(e=>this.options.field===e.field).length;this.createMenu(e.type,t>0,1===t||2===t,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),this.wireExEvents()}closeDialog(){super.closeDialog()}selectHandler(e){e.item&&(this.menuItem=e.item,this.renderDialogue(e))}renderDialogue(e){let t=e.element,i=this.options.field,s=!Object(n.X)(i)&&It(i),r=!Object(n.X)(i)&&Mt(i),l=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:s?r+"-xlflmenu":i+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:s?r+"-xlfldlg":i+"-xlfldlg"}),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new a.a({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:()=>{let e=this.dlgObj.element.querySelector("table.e-xlfl-table>tr");this.options.column.filterTemplate?Object(n.W)()?e.querySelector(".e-xlfl-valuediv").children[0].focus():e.querySelector("#"+this.options.column.field+"-xlfl-frstvalue").focus():e.cells[1].querySelector("input:not([type=hidden])").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,t,i),buttons:[{click:this.filterBtnClick.bind(this,i),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:"e-xlfl-cancelbtn"}}],content:l,width:430,animationSettings:{effect:"None"}}),this.dlgObj.isStringTemplate=!0,this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.dlgObj.appendTo(this.dlgDiv)}removeDialog(){if(Object(n.W)()){let e=this.options.columns||[];for(let t=0;t<e.length;t++)if(e[t].filterTemplate){let i=this.parent.element.id+e[t].uid+"filterTemplate";Object(n.sb)(i,"FilterTemplate",e[t])}}this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates()),this.removeObjects([this.dropOptr,this.datePicker,this.dateTimePicker,this.actObj,this.numericTxtObj,this.dlgObj]),Object(n.hb)(this.dlgDiv)}createdDialog(e,t){this.renderCustomFilter(e,t),this.dlgObj.element.style.left="0px",this.dlgObj.element.style.top="0px",n.d.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify("beforeCustomFilterOpen",{column:t,dialog:this.dialogObj}),this.dlgObj.show(),si(this.parent.element,this.dlgObj.element.parentElement)}renderCustomFilter(e,t){let i=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),s=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});i.appendChild(s);let r=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});i.appendChild(r),this.renderFilterUI(t,i)}filterBtnClick(e){let t,i=!Object(n.X)(e)&&It(e),s=!Object(n.X)(e)&&Mt(e),r=i?s:e,l=this.options.column.filterTemplate&&Object(n.W)()?this.dlgDiv.querySelector(".-xlfl-frstvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+r+"-xlfl-frstvalue").ej2_instances[0],a=this.dlgDiv.querySelector("#"+r+"-xlfl-frstoptr").ej2_instances[0],o=this.options.column.filterTemplate&&Object(n.W)()?this.dlgDiv.querySelector(".-xlfl-secndvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+r+"-xlfl-secndvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+r+"-xlfl-secndoptr").ej2_instances[0];"string"===this.options.type&&(t=this.dlgDiv.querySelector("#"+r+"-xlflmtcase").ej2_instances[0].checked);let d=this.dlgDiv.querySelector("#"+r+"e-xlfl-frstpredicate").ej2_instances[0],c=(this.dlgDiv.querySelector("#"+r+"e-xlfl-secndpredicate"),d.checked?"and":"or");null===o.value&&(c="or"),this.filterByColumn(this.options.field,a.value,l.value,c,t,this.options.ignoreAccent,h.value,o.value),this.removeDialog()}filterByColumn(e,t,i,s,r,a,o,h){let d,c=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,p=this.isForeignColumn(c)?c.foreignKeyValue:e,u=[];u.push({field:p,predicate:s,matchCase:r,ignoreAccent:a,operator:t,value:i,type:this.options.type});let g={instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:s,arg5:r,arg6:a,arg7:o,arg8:h,cancel:!1};if(this.parent.notify("filter-Prevent",g),g.cancel)return;d=new l.f(p,t.toLowerCase(),i,!r,a),Object(n.X)(h)||Object(n.X)(o)||(u.push({field:p,predicate:s,matchCase:r,ignoreAccent:a,operator:o,value:h,type:this.options.type}),d=d[s](p,o.toLowerCase(),h,!r,a));let m={action:"filtering",filterCollection:u,field:this.options.field,ejpredicate:d,actualPredicate:u};this.isForeignColumn(c)?this.foreignKeyFilter(m,u,d):this.options.handler(m)}renderOperatorUI(e,t,i,s,r){let l=this.parent.createElement("tr",{className:"e-xlfl-fields"});t.appendChild(l);let a=this.parent.createElement("td",{className:"e-xlfl-optr"});l.appendChild(a);let o=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),h=!Object(n.X)(e)&&It(e),c=!Object(n.X)(e)&&Mt(e),p=this.parent.createElement("input",{id:h?c+i:e+i});o.appendChild(p),a.appendChild(o);let u=this.customFilterOperators[this.options.type+"Operator"];this.optrData=u;let g=this.dropSelectedVal(this.options.column,s,r),m="";this.menuItem&&(m=this.menuItem.text.slice(0,-3),m!==this.getLocalizedLabel("CustomFilter")&&(g=r?m:void 0),m===this.getLocalizedLabel("Between")&&(g=this.getLocalizedLabel(r?"GreaterThanOrEqual":"LessThanOrEqual")));let b=this.options.column;return this.dropOptr=new d.d(dt({dataSource:u,fields:{text:"text",value:"value"},text:g,open:this.dropDownOpen.bind(this),enableRtl:this.parent.enableRtl,change:this.dropDownValueChange.bind(this)},b.filter.params)),this.dropOptr.appendTo(p),{fieldElement:l,operator:this.getSelectedValue(g)}}dropDownOpen(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}dropDownValueChange(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString()}getFilterUIInfo(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}}getSelectedValue(e){let t=new l.a(this.optrData).executeLocal((new l.g).where("text","equal",e));return Object(n.X)(t[0])?"":t[0].value}dropSelectedVal(e,t,i){let s;return s=t&&t.length>0?2===t.length?i?t[0].operator:t[1].operator:i?t[0].operator:void 0:i&&"string"===e.type&&!e.filter.operator?"startswith":i?e.filter.operator||"equal":void 0,this.getSelectedText(s)}getSelectedText(e){let t=new l.a(this.optrData).executeLocal((new l.g).where("value","equal",e));return Object(n.X)(t[0])?"":t[0].text}renderFilterUI(e,t){let i=this.existingPredicate[e],s=this.parent.createElement("table",{className:"e-xlfl-table"});t.appendChild(s);let r=this.parent.createElement("colGroup");r.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',s.appendChild(r);let n=this.renderOperatorUI(e,s,"-xlfl-frstoptr",i,!0);this.firstOperator=n.operator,this.renderFlValueUI(e,n,"-xlfl-frstvalue",i,!0);let l=this.parent.createElement("tr",{className:"e-xlfl-predicate"});s.appendChild(l),this.renderRadioButton(e,l,i),n=this.renderOperatorUI(e,s,"-xlfl-secndoptr",i,!1),this.secondOperator=n.operator,this.renderFlValueUI(e,n,"-xlfl-secndvalue",i,!1)}renderRadioButton(e,t,i){let s=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});t.appendChild(s);let r=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),l=!Object(n.X)(e)&&It(e),a=!Object(n.X)(e)&&Mt(e),h=this.parent.createElement("input",{id:l?a+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),d=this.parent.createElement("input",{id:l?a+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});r.appendChild(h),r.appendChild(d),s.appendChild(r),"string"===this.options.type&&this.renderMatchCase(e,t,s,"-xlflmtcase",i);let c=new o.d({label:this.getLocalizedLabel("AND"),name:"default",cssClass:"e-xlfl-radio-and",checked:!0,enableRtl:this.parent.enableRtl}),p=new o.d({label:this.getLocalizedLabel("OR"),name:"default",cssClass:"e-xlfl-radio-or",enableRtl:this.parent.enableRtl});"and"===(i&&2===i.length?i[1].predicate:"and")?(c.checked=!0,p.checked=!1):(p.checked=!0,c.checked=!1),c.appendTo(h),p.appendTo(d)}removeObjects(e){for(let t of e)t&&!t.isDestroyed&&t.destroy()}renderFlValueUI(e,t,i,s,r){let l=this.parent.createElement("td",{className:"e-xlfl-value"});t.fieldElement.appendChild(l);let a=!Object(n.X)(e)&&It(e),o=!Object(n.X)(e)&&Mt(e),h=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),d=this.options.filteredColumns.some(t=>e===t.field),c=this.options.filteredColumns.filter(t=>t.field===e);if(this.options.column.filterTemplate){let t={},r=this.options.column;d&&i&&(t=this.getExcelFilterData(i,t,r,s,c));let p=this.parent.element.id+r.uid+"filterTemplate";this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate?(this.options.column.getFilterTemplate()(t,this.parent,"filterTemplate",p,null,null,h),this.parent.renderTemplates()):Ot(h,this.options.column.getFilterTemplate()(t,this.parent,"filterTemplate",p)),Object(n.W)()?(h.children[0].classList.add(i),this.dlgDiv.querySelectorAll(".e-xlfl-value").length>1&&Object(n.sb)(p,"FilterTemplate",r)):h.children[0].id=a?o+i:e+i,l.appendChild(h)}else{let n,d,c=this.parent.createElement("input",{id:a?o+i:e+i});h.appendChild(c),l.appendChild(h),s&&s.length>0&&(d=2===s.length?r?s[0]:s[1]:r?s[0]:void 0,n=d&&d.operator===t.operator?d.value:void 0),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,e,c,n,this.parent.enableRtl)}}getExcelFilterData(e,t,i,s,r){let n="-xlfl-frstvalue"===e?0:1;if("-xlfl-frstvalue"===e||r.length>1){let e=this.options.column.columnData&&r.length>1?1===this.options.column.columnData.length?0:1:n;(t={column:s instanceof Array?s[n]:s})[this.options.field]=i.foreignKeyValue?this.options.column.columnData[e][i.foreignKeyValue]:r[e].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[e][i.foreignKeyValue])}return t}renderMatchCase(e,t,i,s,r){let l=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),a=!Object(n.X)(e)&&It(e),h=!Object(n.X)(e)&&Mt(e),d=this.parent.createElement("input",{id:a?h+s:e+s,attrs:{type:"checkbox"}});l.appendChild(d),i.appendChild(l);let c=!!(r&&r.length>0)&&(r&&2===r.length?r[1].matchCase:r[0].matchCase);new o.b({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:c}).appendTo(d)}renderDate(e,t,i,s,r){let n=Qt(e.format,e.type);this.datePicker=new c.b(dt({format:n,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:r,value:new Date(s),locale:this.parent.locale},e.column.filter.params)),this.datePicker.appendTo(i)}renderDateTime(e,t,i,s,r){let n=Qt(e.format,e.type);this.dateTimePicker=new c.d(dt({format:n,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:r,value:new Date(s),locale:this.parent.locale},e.column.filter.params)),this.dateTimePicker.appendTo(i)}completeAction(e){e.result=function(e){let t={},i=[];for(let s=0;s<e.length;s++)e[s]in t||(i.push(e[s].toString()),t[e[s]]=1);return i}(e.result)}renderNumericTextBox(e,t,i,s,r){this.numericTxtObj=new h.e(dt({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:r,value:s,locale:this.parent.locale},e.column.filter.params)),this.numericTxtObj.appendTo(i)}renderAutoComplete(e,t,i,s,r){let a=this.options.column,o=this.isForeignColumn(a),h=o?a.dataSource:e.dataSource,c={value:o?a.foreignKeyValue:t},p=new d.a(dt({dataSource:h instanceof l.a?h:new l.a(h),fields:c,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:"e-popup-flmenu",autofill:!0,focus:()=>{let s=!Object(n.X)(t)&&It(t),r=!Object(n.X)(t)&&Mt(t),l=s?r:t;p.filterType=this.dlgDiv.querySelector("#"+l+(i.id===l+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,p.ignoreCase="string"!==e.type||!this.dlgDiv.querySelector("#"+l+"-xlflmtcase").ej2_instances[0].checked,p.filterType=Object(n.X)(p.filterType)?"equal":p.filterType},placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:r,actionComplete:e=>{let i=!Object(n.X)(t)&&It(t);e.result=e.result.filter((e,t,s)=>s.map(e=>i?this.performComplexDataOperation(p.fields.value,e):e[p.fields.value]).indexOf(i?this.performComplexDataOperation(p.fields.value,e):e[this.actObj.fields.value])===t)},text:s},a.filter.params));if(h&&"result"in h){let e=hi({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger("dataStateChange",e.state),e.deffered.promise.then(e=>{p.dataSource=new l.a(e)})}p.appendTo(i),this.actObj=p}performComplexDataOperation(e,t){let i,s=e.split(".").length,r=e.split("."),n=t;for(let l=0;l<s;l++)i=n[r[l]],n=i;return i}}class Mi{constructor(e,t,i,s){this.contentRefresh=!0,this.isModelChanged=!0,this.aria=new Q,this.currentTarget=null,this.parent=e,this.sortSettings=t,this.sortedColumns=i,this.focus=s.getService("focus"),this.addEventListener()}updateModel(){let e,t={field:this.columnName,direction:this.direction},i=this.parent.groupSettings.columns,s=!1;if(this.isMultiSort)e=this.getSortedColsIndexByField(this.columnName),e>-1&&this.sortSettings.columns.splice(e,1),this.sortSettings.columns.push(t),this.sortSettings.columns=this.sortSettings.columns;else if(i.length){let r=[];for(let n=0,l=i.length;n<l;n++)if(e=this.getSortedColsIndexByField(i[n],r),this.columnName===i[n])s=!0,r.push(t);else{let e=this.getSortColumnFromField(i[n]);r.push({field:e.field,direction:e.direction,isFromGroup:e.isFromGroup})}s||r.push(t),this.sortSettings.columns=r}else this.sortSettings.columns=[t];this.parent.dataBind(),this.lastSortedCol=this.columnName}onActionComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null);let t=this.isRemove?{requestType:"sorting",type:y}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:y};this.isRemove=!1,this.parent.trigger(y,Object(n.K)(e,t))}sortColumn(e,t,i){let s=this.parent;!1===this.parent.getColumnByField(e).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:e}):(s.allowMultiSorting||(i=s.allowMultiSorting),this.isActionPrevent()?s.notify(z,{instance:this,handler:this.sortColumn,arg1:e,arg2:t,arg3:i}):(this.backupSettings(),this.columnName=e,this.direction=t,this.isMultiSort=i,this.removeSortIcons(),s.getColumnHeaderByField(e),this.updateSortedCols(e,i),this.updateModel()))}backupSettings(){this.lastSortedCols=at(this.sortSettings.columns),this.lastCols=this.sortedColumns}restoreSettings(){this.isModelChanged=!1,this.isMultiSort=!0,this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0),this.sortedColumns=this.lastCols,this.isModelChanged=!0}updateSortedCols(e,t){if(!t)if(this.parent.allowGrouping)for(let i=0,s=this.sortedColumns.length;i<s;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[i])<0&&(this.sortedColumns.splice(i,1),s--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(e)<0&&this.sortedColumns.push(e)}onPropertyChanged(e){e.module===this.getModuleName()&&(this.contentRefresh&&this.parent.notify(D,this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:f,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:f,cancel:!1,target:this.currentTarget}),this.refreshSortSettings(),this.removeSortIcons(),this.addSortIcons())}refreshSortSettings(){this.sortedColumns.length=0;let e=this.sortSettings.columns;for(let t=0;t<e.length;t++)e[t].isFromGroup||this.sortedColumns.push(e[t].field)}clearSorting(){let e=yt(this.sortSettings.columns);if(this.isActionPrevent())this.parent.notify(z,{instance:this,handler:this.clearSorting});else{for(let t=0,i=e.length;t<i;t++)this.removeSortColumn(e[t].field);Object(n.W)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)}}isActionPrevent(){return kt(this.parent)}removeSortColumn(e){let t=this.parent,i=this.sortSettings.columns;if(!(0===i.length&&this.sortedColumns.indexOf(e)<0))if(this.isActionPrevent())this.parent.notify(z,{instance:this,handler:this.removeSortColumn,arg1:e});else{this.backupSettings(),this.removeSortIcons();for(let s=0,r=i.length;s<r;s++)if(i[s].field===e){if(t.allowGrouping&&t.groupSettings.columns.indexOf(i[s].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(i[s].field),1),i.splice(s,1),this.isRemove=!0,this.isModelChanged&&this.parent.notify(D,{requestType:"sorting",type:f,target:this.currentTarget});break}this.addSortIcons()}}getSortedColsIndexByField(e,t){let i=t||this.sortSettings.columns;for(let s=0,r=i.length;s<r;s++)if(i[s].field===e)return s;return-1}getModuleName(){return"sort"}initialEnd(){if(this.parent.off(O,this.initialEnd),(!Object(n.W)()||!this.parent.isServerRendered)&&this.parent.getColumns().length&&this.sortSettings.columns.length){let e=this.parent;this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1;for(let t of e.sortSettings.columns.slice())this.sortedColumns.indexOf(t.field)>-1&&this.sortColumn(t.field,t.direction,!0);this.isMultiSort=!1,this.contentRefresh=!0}}addEventListener(){this.parent.isDestroyed||(this.parent.on(O,this.initialEnd,this),this.parent.on("sorting-complete",this.onActionComplete,this),this.parent.on(R,this.onPropertyChanged,this),this.parent.on(M,this.clickHandler,this),this.parent.on(E,this.refreshSortIcons,this),this.parent.on(I,this.keyPressed,this),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off("sorting-complete",this.onActionComplete),this.parent.off(R,this.onPropertyChanged),this.parent.off(M,this.clickHandler),this.parent.off(E,this.refreshSortIcons),this.parent.off(I,this.keyPressed),this.parent.off("cancel-Begin",this.cancelBeginEvent))}destroy(){this.isModelChanged=!1;let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())}cancelBeginEvent(e){"sorting"===e.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)}clickHandler(e){let t=this.parent;this.currentTarget=null,this.popUpClickHandler(e);let i=Object(n.C)(e.target,".e-headercell");if(i&&!e.target.classList.contains("e-grptogglebtn")&&!i.classList.contains("e-resized")&&!e.target.classList.contains("e-rhandler")&&!e.target.classList.contains("e-columnmenu")&&!e.target.classList.contains("e-filtermenudiv")&&!mt(e.target,"e-stackedheadercell")&&!(t.allowSelection&&t.selectionSettings.allowColumnSelection&&e.target.classList.contains("e-headercell"))){let t=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));i.querySelectorAll(".e-ascending"),"checkbox"!==t.type&&(this.initiateSort(i,e,t),n.d.isDevice&&this.showPopUp(e))}if(i&&i.classList.remove("e-resized"),mt(e.target,"e-excel-ascending")||mt(e.target,"e-excel-descending")){let i=Object(n.C)(e.target,".e-filter-popup").getAttribute("uid"),s=Object(n.X)(mt(e.target,"e-excel-descending"))?"Ascending":"Descending";this.sortColumn(t.getColumnByUid(i).field,s,!1)}}keyPressed(e){let t=e.target;if(!this.parent.isEdit&&("enter"===e.action||"ctrlEnter"===e.action||"shiftEnter"===e.action)&&Object(n.C)(t,".e-headercell")){let t=this.focus.getFocusedElement();if(Object(n.X)(t)||!t.classList.contains("e-headercell")||!t.querySelector(".e-headercelldiv"))return;let i=this.parent.getColumnByUid(t.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(t,e,i)}}initiateSort(e,t,i){let s=this.parent,r=i.field;this.currentTarget=t.target;let l=e.querySelectorAll(".e-ascending").length?"Descending":"Ascending";t.shiftKey||this.sortSettings.allowUnsort&&e.querySelectorAll(".e-descending").length&&!(s.groupSettings.columns.indexOf(r)>-1)?(this.removeSortColumn(r),Object(n.W)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)):this.sortColumn(r,l,t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey)}showPopUp(e){let t=Object(n.C)(e.target,".e-headercell");!this.parent.allowMultiSorting||Object(n.X)(t)&&!this.parent.isContextMenuOpen()||ut(this.parent.element.querySelector(".e-gridpopup"),e,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))}popUpClickHandler(e){let t=e.target;Object(n.C)(t,".e-headercell")||e.target.classList.contains("e-rowcell")||Object(n.C)(t,".e-gridpopup")?t.classList.contains("e-sortdirect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}addSortIcons(){let e,t,i=this.parent,s=this.sortSettings.columns,r=this.parent.getColumns().map(e=>e.field);for(let l=0,a=s.length;l<a;l++)e=i.getColumnHeaderByField(s[l].field),-1===r.indexOf(s[l].field)||Object(n.X)(e)||(this.aria.setSort(e,s[l].direction),this.isMultiSort&&s.length>1&&e.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(l+1).toString()}),e.querySelector(".e-headertext")),t=e.querySelector(".e-sortfilterdiv"),"Ascending"===s[l].direction?Object(n.A)(t,["e-ascending","e-icon-ascending"],[]):Object(n.A)(t,["e-descending","e-icon-descending"],[]))}removeSortIcons(e){let t,i=this.parent,s=this.sortSettings.columns,r=this.parent.getColumns().map(e=>e.field);for(let l=e||0,a=Object(n.X)(e)?s.length:e+1;l<a;l++)t=i.getColumnHeaderByField(s[l].field),Object(n.X)(t)||i.allowGrouping&&i.groupSettings.columns.indexOf(s[l].field)>-1&&!t.querySelector(".e-sortfilterdiv")||-1!==r.indexOf(s[l].field)&&(this.aria.setSort(t,"none"),Object(n.A)(t.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),t.querySelector(".e-sortnumber")&&t.querySelector(".e-headercelldiv").removeChild(t.querySelector(".e-sortnumber")))}getSortColumnFromField(e){for(let t=0,i=this.sortSettings.columns.length;t<i;t++)if(this.sortSettings.columns[t].field===e)return this.sortSettings.columns[t];return!1}updateAriaAttr(){let e=this.parent.getColumns().map(e=>e.field);for(let t of this.sortedColumns){if(-1===e.indexOf(t))continue;let i=this.parent.getColumnHeaderByField(t);this.aria.setSort(i,this.getSortColumnFromField(t).direction)}}refreshSortIcons(e={args:{isFrozen:!1}}){e.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())}}class Fi{constructor(e){this.pagerModule=e}render(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()}refresh(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.updateStyles()}refreshNumericLinks(){let e,t=this.pagerModule,i=t.element.querySelector(".e-numericcontainer"),s=document.createDocumentFragment();i.innerHTML="";for(let r=1;r<=t.pageCount;r++)e=Object(n.F)("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Goto Page "+r,href:"javascript:void(0);",name:"Goto page"+r}}),t.currentPage===r&&Object(n.A)(e,["e-currentitem","e-active"],["e-pager-default"]),s.appendChild(e);i.appendChild(s),this.links=[].slice.call(i.childNodes)}wireEvents(){n.l.add(this.pagerElement,"click",this.clickHandler,this)}unwireEvents(){n.l.remove(this.pagerModule.element,"click",this.clickHandler)}destroy(){this.unwireEvents()}renderNumericContainer(){this.element=Object(n.F)("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(Object(n.F)("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)}renderFirstNPrev(e){this.first=Object(n.F)("div",{className:"e-first e-icons e-icon-first",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}),this.prev=Object(n.F)("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}),Object(n.w)([this.first,this.prev],e)}renderPrevPagerSet(e){let t=Object(n.F)("div");this.PP=Object(n.F)("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:Object(n.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.PP),e.appendChild(t)}renderNextPagerSet(e){let t=Object(n.F)("div");this.NP=Object(n.F)("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:Object(n.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.NP),e.appendChild(t)}renderNextNLast(e){this.next=Object(n.F)("div",{className:"e-next e-icons e-icon-next",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}),this.last=Object(n.F)("div",{className:"e-last e-icons e-icon-last",attrs:{title:Object(n.W)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":Object(n.W)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}),Object(n.w)([this.next,this.last],e)}clickHandler(e){let t=this.pagerModule,i=e.target;return t.previousPageNo=t.currentPage,i.classList.contains("e-disable")||Object(n.X)(i.getAttribute("index"))||(t.currentPage=parseInt(i.getAttribute("index"),10),t.dataBind()),!1}updateLinksHtml(){let e,t,i=this.pagerModule;i.currentPage=1===i.totalPages?1:i.currentPage,i.currentPage>i.totalPages&&i.totalPages&&(i.currentPage=i.totalPages),e=parseInt((i.currentPage/i.pageCount).toString(),10),i.currentPage%i.pageCount==0&&e>0&&(e-=1);for(let s=0;s<i.pageCount;s++)t=e*i.pageCount+1+s,t<=i.totalPages?(this.links[s].style.display="",this.links[s].setAttribute("index",t.toString()),this.links[s].innerHTML=i.customText?i.customText+t:t.toString(),i.currentPage!==t?this.links[s].classList.add("e-pager-default"):this.links[s].classList.remove("e-pager-default")):(this.links[s].innerHTML=i.customText?i.customText+t:t.toString(),this.links[s].style.display="none"),Object(n.A)(this.links[s],[],["e-currentitem","e-active"]);this.first.setAttribute("index","1"),this.last.setAttribute("index",i.totalPages.toString()),this.prev.setAttribute("index",(i.currentPage-1).toString()),this.next.setAttribute("index",(i.currentPage+1).toString()),this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1"),this.pagerElement.querySelector(".e-mlast").setAttribute("index",i.totalPages.toString()),this.pagerElement.querySelector(".e-mprev").setAttribute("index",(i.currentPage-1).toString()),this.pagerElement.querySelector(".e-mnext").setAttribute("index",(i.currentPage+1).toString()),this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-i.pageCount).toString()),this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())}updateStyles(){this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length&&Object(n.A)(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[])}updateFirstNPrevStyles(){let e=["e-firstpage","e-pager-default"],t=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],s=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(Object(n.A)(this.prev,i,s),Object(n.A)(this.first,e,t),Object(n.A)(this.pagerElement.querySelector(".e-mfirst"),e,t),Object(n.A)(this.pagerElement.querySelector(".e-mprev"),i,s)):(Object(n.A)(this.prev,s,i),Object(n.A)(this.first,t,e),Object(n.A)(this.pagerElement.querySelector(".e-mprev"),s,i),Object(n.A)(this.pagerElement.querySelector(".e-mfirst"),t,e))}updatePrevPagerSetStyles(){this.pagerModule.currentPage>this.pagerModule.pageCount?Object(n.A)(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):Object(n.A)(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])}updateNextPagerSetStyles(){let e=this.pagerModule,t=this.links[0].innerHTML.replace(e.customText,"");!t.length||!this.links.length||parseInt(t,10)+e.pageCount>e.totalPages?Object(n.A)(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):Object(n.A)(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])}updateNextNLastStyles(){let e=["e-lastpage","e-pager-default"],t=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],s=["e-nextpagedisabled","e-disable"],r=this.pagerModule;r.currentPage===r.totalPages||0===r.totalRecordsCount?(Object(n.A)(this.last,t,e),Object(n.A)(this.next,s,i),Object(n.A)(this.pagerElement.querySelector(".e-mlast"),t,e),Object(n.A)(this.pagerElement.querySelector(".e-mnext"),s,i)):(Object(n.A)(this.last,e,t),Object(n.A)(this.next,i,s),Object(n.A)(this.pagerElement.querySelector(".e-mlast"),e,t),Object(n.A)(this.pagerElement.querySelector(".e-mnext"),i,s))}}class Ti{constructor(e){this.pagerModule=e}render(){let e=Object(n.F)("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=Object(n.F)("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=Object(n.F)("span",{className:"e-pagecountmsg",styles:"textalign:right"}),Object(n.w)([this.pageNoMsgElem,this.pageCountMsgElem],e),this.pagerModule.element.appendChild(e),this.refresh()}refresh(){let e=this.pagerModule;Object(n.W)()?(this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("CurrentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel("TotalItemsInfo"),[e.totalRecordsCount||0])):(this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("currentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0,e.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel(e.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[e.totalRecordsCount||0,e.totalRecordsCount?e.pageSize*(e.currentPage-1)+1:0,e.pageSize*e.currentPage>e.totalRecordsCount?e.totalRecordsCount:e.pageSize*e.currentPage])),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)}hideMessage(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")}showMessage(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""}destroy(){}format(e,t){let i;for(let s=0;s<t.length;s++)i=new RegExp("\\{"+s+"\\}","gm"),e=e.replace(i,t[s].toString());return e}}var ki=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};let zi=(()=>{let e=class extends n.h{constructor(e,t){super(e,t),this.hasParent=!1}requiredModules(){let e=[];return this.enableExternalMessage&&e.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&e.push({member:"pagerdropdown",args:[this]}),e}preRender(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager",previousPagerTooltip:"Go to previous pager",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager",PreviousPagerTooltip:"Go to previous pager",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All"},this.containerModule=new Fi(this),this.pagerMessageModule=new Ti(this)}render(){this.template?this.isReactTemplate()?(this.on("pager-refresh",this.pagerTemplate,this),this.notify("pager-refresh",{})):this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}))}getPersistData(){return this.addOnPersist(["currentPage","pageSize"])}destroy(){this.isReactTemplate()&&(this.off("pager-refresh",this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),super.destroy(),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML="")}destroyTemplate(e,t){this.clearTemplate(e,t)}getModuleName(){return"pager"}onPropertyChanged(e,t){if(!this.isDestroyed){e.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(let i of Object.keys(e))switch(i){case"currentPage":this.checkGoToPage(e.currentPage,t.currentPage)&&this.currentPageChanged(e,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==e.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize)),e.pageSize!==t.pageSize?(this.pageSize=e.pageSize,this.currentPageChanged(e,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}}}getLocalizedLabel(e){return this.localeObj.getConstant(e)}goToPage(e){this.checkGoToPage(e)&&(this.currentPage=e,this.dataBind())}setPageSize(e){this.pageSize=e,this.dataBind()}checkpagesizes(){return!(!0!==this.pageSizes&&!this.pageSizes.length)}checkGoToPage(e,t){return e!==this.currentPage&&(this.previousPageNo=this.currentPage),Object(n.X)(t)||(this.previousPageNo=t),this.previousPageNo!==e&&e>=1&&e<=this.totalPages}currentPageChanged(e,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),e.currentPage!==t.currentPage||e.pageSize!==t.pageSize){let i={currentPage:this.currentPage,newProp:e,oldProp:t,cancel:!1};this.trigger("click",i),i.cancel||this.refresh()}}pagerTemplate(){if(this.isReactTemplate()&&this.hasParent)return;let e;this.element.classList.add("e-pagertemplate"),this.compile(this.template);let t={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},i=this.element.parentElement.id+"_template";this.isReactTemplate()?(this.getPagerTemplate()(t,this,"template",i,null,null,this.element),this.renderReactTemplates()):(e=Object(n.W)()?this.getPagerTemplate()(t,this,"template",i,this.isStringTemplate):this.getPagerTemplate()(t),Ot(this.element,e))}updateTotalPages(){this.totalPages=this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1}getPagerTemplate(){return this.templateFn}compile(e){if(e)try{document.querySelectorAll(e).length&&(this.templateFn=Object(n.E)(document.querySelector(e).innerHTML.trim()))}catch(t){this.templateFn=Object(n.E)(e)}}refresh(){this.template?this.isReactTemplate()?(this.updateTotalPages(),this.notify("pager-refresh",{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate()):(this.updateRTL(),this.containerModule.refresh(),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh())}updateRTL(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}initLocalization(){this.localeObj=new n.p(this.getModuleName(),this.defaultConstants,this.locale)}updateQueryString(e){let t=this.getUpdatedURL(window.location.href,"page",e.toString());window.history.pushState({path:t},"",t)}getUpdatedURL(e,t,i){let s=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i");if(e.match(s))return e.replace(s,"$1"+t+"="+i+"$2");{let s="";return-1!==e.indexOf("#")&&(s=e.replace(/.*#/,"#"),e=e.replace(/#.*/,"")),e+(-1!==e.indexOf("?")?"&":"?")+t+"="+i+s}}renderFirstPrevDivForDevice(){this.element.appendChild(Object(n.F)("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:Object(n.W)()?this.getLocalizedLabel("FirstPageTooltip"):this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(n.F)("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:Object(n.W)()?this.getLocalizedLabel("PreviousPageTooltip"):this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))}renderNextLastDivForDevice(){this.element.appendChild(Object(n.F)("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:Object(n.W)()?this.getLocalizedLabel("NextPageTooltip"):this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(n.F)("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:Object(n.W)()?this.getLocalizedLabel("LastPageTooltip"):this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))}addAriaLabel(){let e=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"];if(!n.d.isDevice)for(let t=0;t<e.length;t++){let i=this.element.querySelector(e[t]);i.setAttribute("aria-label",i.getAttribute("title"))}}isReactTemplate(){return this.isReact&&this.template&&"string"!=typeof this.template}};return ki([Object(n.s)(!1)],e.prototype,"enableQueryString",void 0),ki([Object(n.s)(!1)],e.prototype,"enableExternalMessage",void 0),ki([Object(n.s)(!0)],e.prototype,"enablePagerMessage",void 0),ki([Object(n.s)(12)],e.prototype,"pageSize",void 0),ki([Object(n.s)(10)],e.prototype,"pageCount",void 0),ki([Object(n.s)(1)],e.prototype,"currentPage",void 0),ki([Object(n.s)()],e.prototype,"totalRecordsCount",void 0),ki([Object(n.s)()],e.prototype,"externalMessage",void 0),ki([Object(n.s)(!1)],e.prototype,"pageSizes",void 0),ki([Object(n.s)()],e.prototype,"template",void 0),ki([Object(n.s)("")],e.prototype,"customText",void 0),ki([Object(n.k)()],e.prototype,"click",void 0),ki([Object(n.k)()],e.prototype,"dropDownChanged",void 0),ki([Object(n.k)()],e.prototype,"created",void 0),e=ki([n.q],e),e})();class Ai{constructor(e){this.pagerModule=e}getModuleName(){return"pagerdropdown"}render(){let e=this.pagerModule;this.pagerDropDownDiv=Object(n.F)("div",{className:"e-pagesizes"});let t=Object(n.F)("div",{className:"e-pagerdropdown"}),i=Object(n.F)("div",{className:"e-pagerconstant"}),s=Object(n.F)("input",{attrs:{type:"text",tabindex:"1"}});this.pagerCons=Object(n.F)("span",{className:"e-constant",innerHTML:Object(n.W)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown")}),t.appendChild(s),i.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(t),this.pagerDropDownDiv.appendChild(i),this.pagerModule.element.appendChild(this.pagerDropDownDiv);let r=this.pagerModule.pageSizes,l=r.length?this.convertValue(r):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],a=this.pagerModule.pageSize;this.dropDownListObject=new d.d({dataSource:l,value:a.toString(),change:this.onChange.bind(this),cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(s),r.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),e.pageSize=a,e.dataBind(),e.trigger("dropDownChanged",{pageSize:a}),this.addEventListener()}onChange(e){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.refresh(),e.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh()),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:parseInt(this.dropDownListObject.value,10)})}refresh(){this.pagerCons&&(this.pagerCons.innerHTML=this.pagerModule.pageSize===this.pagerModule.totalRecordsCount?Object(n.W)()?this.pagerModule.getLocalizedLabel("PagerAllDropDown"):this.pagerModule.getLocalizedLabel("pagerAllDropDown"):Object(n.W)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown"))}beforeValueChange(e){if("number"==typeof e.newProp.value){let t=e.newProp.value.toString();e.newProp.value=t}}convertValue(e){let t=e;for(let i=0;i<t.length;i++)t[i]=parseInt(t[i],10)?t[i].toString():""!==this.pagerModule.getLocalizedLabel(t[i])?this.pagerModule.getLocalizedLabel(t[i]):t[i];return t}setDropDownValue(e,t){this.dropDownListObject&&(this.dropDownListObject[e]=t)}addEventListener(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)}removeEventListener(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)}destroy(e){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),Object(n.hb)(this.pagerDropDownDiv))}}class Li{constructor(e){this.pagerModule=e}getModuleName(){return"externalMessage"}render(){this.element=Object(n.F)("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}}),this.pagerModule.element.appendChild(this.element),this.refresh()}refresh(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()}hideMessage(){Object(n.X)(this.element)||(this.element.style.display="none")}showMessage(){this.element.style.display=""}destroy(){Object(n.hb)(this.element)}}class Bi{constructor(e,t){this.isInitialRender=!0,zi.Inject(Li,Ai),this.parent=e,this.pageSettings=t,this.addEventListener()}getModuleName(){return"pager"}render(){let e,t=this.parent;this.pagerDestroy(),Object(n.X)(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0),this.element=this.parent.createElement("div",{className:"e-gridpager"}),e=dt({},Object(n.K)({},gt(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:t.enableRtl,locale:t.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]),this.pagerObj=new zi(e),this.pagerObj.hasParent=!0,this.pagerObj.on("pager-refresh",this.renderReactPagerTemplate,this),this.pagerObj.allowServerDataBinding=!1}onSelect(e){this.pageSettings.pageSize=e.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)}addAriaAttr(){if(!this.pageSettings.template){let e=this.parent.createElement("div",{className:"e-numericcontainer"}),t=this.element.querySelector(".e-pagercontainer"),i=document.createDocumentFragment(),s=this.element.querySelector(".e-numericcontainer"),r=s.querySelectorAll("a");for(let l=0;l<r.length;l++){this.parent.getContentTable()?r[l].setAttribute("aria-owns",this.parent.getContentTable().id):r[l].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");let e=this.parent.createElement("div");e.appendChild(r[l]),i.appendChild(e)}e.appendChild(i),t.replaceChild(e,s);let n=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"];for(let l=0;l<n.length;l++){let e=this.element.querySelector(n[l]);this.parent.getContentTable()&&e.setAttribute("aria-owns",this.parent.getContentTable().id)}}}dataReady(e){this.updateModel(e)}refresh(){this.pagerObj.refresh()}goToPage(e){this.pagerObj.goToPage(e)}setPageSize(e){this.pagerObj.setPageSize(e)}updateModel(e){this.parent.pageSettings.totalRecordsCount=e.count,this.parent.dataBind()}onActionComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(y,Object(n.K)(e,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:y}))}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let t=e.properties;for(let i of Object.keys(t))this.pagerObj[i]=t[i];this.pagerObj.dataBind()}clickHandler(e){let t=this.parent;if(this.isForceCancel||kt(t)&&!t.prevPageMoving)return this.isForceCancel?this.isForceCancel=!1:(Object(n.X)(e.newProp)||Object(n.X)(e.newProp.pageSize)?e.currentPage&&(t.notify(z,{instance:this,handler:this.goToPage,arg1:e.currentPage}),this.pagerObj.currentPage=t.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:t.pageSettings.currentPage):(t.notify(z,{instance:this,handler:this.setPageSize,arg1:e.newProp.pageSize}),this.pagerObj.pageSize=e.oldProp.pageSize,t.pageSettings.pageSize=e.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(e.cancel=!0);t.pageSettings.pageSize=this.pagerObj.pageSize,t.prevPageMoving=!1;let i=this.pageSettings.currentPage;this.pageSettings.currentPage=e.currentPage;let s={cancel:!1,requestType:"paging",previousPage:i,currentPage:e.currentPage,type:f};this.parent.notify(D,s),s.cancel&&(e.cancel=!0),this.parent.requestTypeAction="paging"}keyPressHandler(e){e.action in Pi&&(e.preventDefault(),this.element.querySelector(Pi[e.action]).click())}updateExternalMessage(e){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=e,this.pagerObj.dataBind()}appendToElement(e){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.isReact=this.parent.isReact,this.pagerObj.appendTo(this.element),this.isInitialLoad=!1}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))}addEventListener(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created},this.parent.isDestroyed||(this.parent.isReact&&this.parent.addEventListener("created",this.handlers.created.bind(this)),this.parent.on(v,this.handlers.load,this),this.parent.on(w,this.handlers.end,this),this.parent.on(S,this.handlers.ready,this),this.parent.on("paging-complete",this.handlers.complete,this),this.parent.on(x,this.handlers.updateLayout,this),this.parent.on(R,this.handlers.inboundChange,this),this.parent.on(I,this.handlers.keyPress,this))}created(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())}isReactTemplate(){return this.parent.isReact&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template}renderReactPagerTemplate(){if(!this.isInitialRender&&this.isReactTemplate()){this.parent.destroyTemplate(["pagerTemplate"]),this.element.classList.add("e-pagertemplate"),this.pagerObj.compile(this.pagerObj.template);let e=this.parent.pageSettings;this.pagerObj.templateFn({currentPage:e.currentPage,pageSize:e.pageSize,pageCount:e.pageCount,totalRecordsCount:e.totalRecordsCount,totalPages:this.pagerObj.totalPages},this.parent,"pagerTemplate",this.parent.id+"_pagertemplate",null,null,this.pagerObj.element),this.parent.renderTemplates()}}removeEventListener(){this.parent.isDestroyed||(this.parent.isReact&&this.parent.removeEventListener("created",this.handlers.created),this.parent.off("pager-refresh",this.renderReactPagerTemplate),this.parent.off(v,this.handlers.load),this.parent.off(w,this.handlers.end),this.parent.off(S,this.handlers.ready),this.parent.off("paging-complete",this.handlers.complete),this.parent.off(x,this.handlers.updateLayout),this.parent.off(R,this.handlers.inboundChange),this.parent.off(I,this.handlers.keyPress))}destroy(){this.removeEventListener(),this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]),this.pagerObj.destroy()}pagerDestroy(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),Object(n.hb)(this.element))}}const Pi={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"};class qi extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TH",{className:"e-filterbarcell"})}getGui(){return this.parent.createElement("div")}render(e,t){let i,s=this.parent.element.querySelector(".e-filterbar"),r=this.element.cloneNode(),l=this.getGui(),a=e.column;if(s.appendChild(r),r.setAttribute("e-mappinguid",a.uid),a.filterTemplate){let e={};if(t&&(e[a.field]=t[a.field]),e.column=a,a.visible){let t=this.parent.element.id+a.uid+"filterTemplate";this.parent.isReact&&"string"!=typeof a.filterTemplate?(a.getFilterTemplate()(e,this.parent,"filterTemplate",t,null,null,r),this.parent.renderTemplates()):Ot(r,a.getFilterTemplate()(e,this.parent,"filterTemplate",t))}else r.classList.add("e-hide")}else if("checkbox"!==a.type){if(!Object(n.X)(a.allowFiltering)&&!a.allowFiltering||Object(n.X)(a.filterBarTemplate))Object(n.x)(l,{class:"e-filterdiv e-fltrinputdiv"}),i=this.parent.createElement("input",{id:a.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:a.headerText+e.attributes.title,value:t[e.column.field]?t[e.column.field]:"",role:"search"}}),l.appendChild(i),h.c.createInput({element:i,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},this.parent.createElement);else if(r.classList.add("e-fltrtemp"),Object(n.x)(l,{class:"e-fltrtempdiv"}),Object(n.X)(a.filterBarTemplate.create))i=this.parent.createElement("input",{id:a.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:a.headerText}}),l.appendChild(i);else{let e={column:a,node:Element},t=a.filterBarTemplate.create;if("string"==typeof t&&(t=Object(n.V)(t,window)),i=t(e),"string"==typeof i){let e=this.parent.createElement("div");e.innerHTML=i,i=e.firstChild}Object(n.x)(l,{class:"e-filterUi_input e-filtertext e-fltrTemp",title:a.headerText,id:a.field+"_filterBarcell"}),l.appendChild(i)}if((!1===a.allowFiltering||""===a.field||Object(n.X)(a.field))&&(i.setAttribute("disabled","true"),i.classList.add("e-disable")),a.visible||r.classList.add("e-hide"),this.appendHtml(r,l),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&Object(n.X)(a.filterTemplate)&&this.operatorIconRender(l,a,e),(Object(n.X)(a.allowFiltering)||a.allowFiltering)&&!Object(n.X)(a.filterBarTemplate)){let e=a.filterBarTemplate.write,t={element:i,column:a};"string"==typeof e&&(e=Object(n.V)(e,window)),e.call(this,t)}}return r}appendHtml(e,t){return e.appendChild(t),e}operatorIconRender(e,t,i){let s=this.parent,r=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:i.column.uid});e.querySelector("span").appendChild(r);let l=t.filter&&t.filter.operator?t.filter.operator:"equal";Object(n.X)(s.filterModule.operators[t.field])||(l=s.filterModule.operators[t.field]),this.dropOptr=new d.d({fields:{text:"text",value:"value"},popupHeight:"auto",value:l,width:"0px",enabled:t.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){this.dataSource=s.filterModule.customOperators[s.getColumnByUid(this.element.id).type+"Operator"];for(let e=0;e<this.dataSource.length;e++)t.filter&&t.filter.operator&&Object(n.X)(s.filterModule.operators[t.field])&&this.dataSource[e].value===t.filter.operator&&(this.value=t.filter.operator)}}),this.dropOptr.appendTo(r);let a=Object(n.C)(this.dropOptr.element,"span");a.classList.add("e-filterbardropdown"),a.removeAttribute("tabindex")}internalEvent(e){let t=this.parent,i=t.getColumnByUid(e.element.getAttribute("id"));e.column=i,t.filterModule.operators[i.field]=e.value,t.notify("get-filterbar-operator",e)}}class Vi{constructor(e,t,i,s){this.parent=e,this.serviceLocator=i,this.filterSettings=s,this.customFilterOperators=t}renderOperatorUI(e,t,i,s){this.dialogObj=s;let r=i.type+"Operator";this.optrData=this.customOptr=Object(n.X)(this.parent.filterSettings.operators)||Object(n.X)(this.parent.filterSettings.operators[r])?this.customFilterOperators[r]:this.parent.filterSettings.operators[r];let l=this.customOptr,a=this.dropSelectedVal(i,r),o=this.parent.createElement("div",{className:"e-flm_optrdiv"});e.appendChild(o);let h=this.parent.createElement("input",{id:i.uid+"-floptr"});o.appendChild(h),this.dropOptr=new d.d({dataSource:l,fields:{text:"text",value:"value"},open:this.dropDownOpen.bind(this),cssClass:"e-popup-flmenu",text:a}),this.dropOptr.appendTo("#"+i.uid+"-floptr")}dropDownOpen(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}dropSelectedVal(e,t){let i="",s=this.parent.filterSettings.columns;for(let r of s)if(e.field===r.field||e.isForeignColumn()&&e.foreignKeyValue===r.field){let e=new l.a(this.optrData).executeLocal((new l.g).where("value","equal",r.operator));i=Object(n.X)(e[0])?"":e[0].text}if(""===i)if(e.filter.operator){let t=Object.keys(this.optrData).length;for(let s=0;s<t;s++)this.optrData[s].value===e.filter.operator&&(i=this.optrData[s].text)}else i=this.optrData[0].text;return i}getFlOperator(){return this.dropOptr.value}}class Hi{constructor(e,t,i){this.parent=e,this.serLocator=t,this.filterSettings=i}create(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+e.column.uid}),e.target.appendChild(this.instance),this.dialogObj=e.dialogObj,this.actObj=this.getAutoCompleteOptions(e),this.actObj.appendTo(this.instance)}getAutoCompleteOptions(e){let t,i=e.column.isForeignColumn();i&&(t=new l.g,t.params=this.parent.query.params);let s=i?e.column.dataSource:this.parent.dataSource,r={value:i?e.column.foreignKeyValue:e.column.field},a=new d.a(Object(n.K)({dataSource:s instanceof l.a?s:new l.a(s),fields:r,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:i?t:this.parent.query.clone(),sortOrder:"Ascending",open:this.openPopup.bind(this),cssClass:"e-popup-flmenu",focus:()=>{this.actObj.filterType=e.getOptrInstance.getFlOperator()},autofill:!0,placeholder:e.localizeText.getConstant("EnterValue"),actionComplete:e=>{e.result=e.result.filter((e,t,i)=>i.map(e=>Object(n.V)(this.actObj.fields.value,e)).indexOf(Object(n.V)(this.actObj.fields.value,e))===t)}},e.column.filter.params));if(s&&"result"in s){let e=hi({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new l.g);this.parent.trigger("dataStateChange",e.state),e.deffered.promise.then(e=>{a.dataSource=new l.a(e)})}return a}write(e){""===e.filteredValue||Object(n.X)(e.filteredValue)||(document.querySelector("#strui-"+e.column.uid).ej2_instances[0].value=e.filteredValue)}read(e,t,i,s){let r=document.querySelector("#strui-"+t.uid).ej2_instances[0];n.d.isDevice&&(r.hidePopup(),r.focusOut());let l=r.value;(Object(n.X)(l)||""===l)&&(l=null),s.filterByColumn(t.field,i,l,"and",this.parent.filterSettings.enableCaseSensitivity)}openPopup(e){Pt(e,this.dialogObj)}}class Ni{constructor(e,t,i){this.filterSettings=i,this.parent=e,this.serviceLocator=t}create(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+e.column.uid}),e.target.appendChild(this.instance),this.numericTxtObj=new h.e(Object(n.K)({format:"string"==typeof e.column.format||Object(n.ab)(e.column.format)?e.column.format:e.column.format.format,locale:this.parent.locale,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},e.column.filter.params)),this.numericTxtObj.appendTo(this.instance)}write(e){document.querySelector("#numberui-"+e.column.uid).ej2_instances[0].value=e.filteredValue}read(e,t,i,s){let r=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;Object(n.X)(r)&&(r=parseFloat(e.value)),s.filterByColumn(t.field,i,r,"and",!0)}}class Wi{constructor(e,t,i){this.parent=e,this.serviceLocator=t,this.filterSettings=i}create(e){let t=e.column.isForeignColumn(),i=t?e.column.dataSource:this.parent.dataSource,s=t?e.column.foreignKeyValue:e.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+e.column.uid}),e.target.appendChild(this.elem),this.dialogObj=e.dialogObj,this.dropInstance=new d.d(Object(n.K)({dataSource:i instanceof l.a?i:new l.a(i),query:(new l.g).select(s),fields:{text:s,value:s},placeholder:e.localizeText.getConstant("SelectValue"),cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this),actionComplete:e=>{e.result=l.b.distinct(e.result,s,!0)}},e.column.filter.params)),this.dropInstance.appendTo(this.elem)}write(e){let t=document.querySelector("#bool-ui-"+e.column.uid).ej2_instances[0];Object(n.X)(e.filteredValue)||(t.text=e.filteredValue)}read(e,t,i,s){let r=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0];s.filterByColumn(t.field,i,r.value,"and",!1)}openPopup(e){Pt(e,this.dialogObj)}}class Xi{constructor(e,t,i){this.parent=e,this.locator=t,this.fltrSettings=i}create(e){let t=Qt(e.column.format,e.column.type);this.dialogObj=e.dialogObj,this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+e.column.uid}),e.target.appendChild(this.inputElem),"date"===e.column.type?this.datePickerObj=new c.b(Object(n.K)({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},e.column.filter.params)):"datetime"===e.column.type&&(this.datePickerObj=new c.d(Object(n.K)({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},e.column.filter.params))),this.datePickerObj.appendTo(this.inputElem)}write(e){document.querySelector("#dateui-"+e.column.uid).ej2_instances[0].value=Object(n.X)(e.filteredValue)?null:new Date(e.filteredValue)}read(e,t,i,s){let r=document.querySelector("#dateui-"+t.uid).ej2_instances[0].value;r=Object(n.X)(r)?null:r,s.filterByColumn(t.field,i,r,"and",!0)}openPopup(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}}class Gi{constructor(e,t,i,s,r){this.isDialogOpen=!1,this.colTypes={string:Hi,number:Ni,date:Xi,boolean:Wi,datetime:Xi},this.parent=e,this.filterSettings=t,this.serviceLocator=i,this.customFilterOperators=s,this.filterObj=r,this.flMuiObj=new Vi(this.parent,this.customFilterOperators,this.serviceLocator),this.l10n=this.serviceLocator.getService("localization")}openDialog(e){this.col=this.parent.getColumnByField(e.field),(Object(n.X)(this.col.filter)||Object(n.X)(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(e.target,this.col)}closeDialog(e){if(!this.dlgObj)return;if(Object(n.W)()){let e=this.parent.getColumns();for(let t=0;t<e.length;t++)if(e[t].filterTemplate){let i=this.parent.element.id+e[t].uid+"filterTemplate";Object(n.sb)(i,"FilterTemplate",e[t])}}this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates());let t=document.getElementById(this.dlgObj.element.id);if(this.dlgObj&&!this.dlgObj.isDestroyed&&t){let i={cancel:!1,column:this.col,target:e,element:t};if(this.parent.notify("filter-menu-close",i),i.cancel)return;this.isDialogOpen=!1,this.dlgObj.destroy(),Object(n.hb)(t)}}renderDlgContent(e,t){let i={requestType:"filterbeforeopen",columnName:t.field,columnType:t.type};Object(n.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.parent.trigger(f,i);let s=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:t.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:t.uid+"-flmdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new a.a({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,e,t),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:"e-flmenu-cancelbtn"}}],content:s,width:!Object(n.X)(mt(e,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:"e-filter-popup"}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv)}dialogCreated(e,t){n.d.isDevice||Bt(e,this.dlgObj,this.parent),this.renderFilterUI(e,t),this.parent.notify("filterDialogCreated",{}),this.dlgObj.element.style.maxHeight="350px",this.dlgObj.show(),t.filterTemplate||this.writeMethod(t,this.dlgObj.element.querySelector("#"+t.uid+"-flmenu"));let i={requestType:"filterafteropen",columnName:t.field,columnType:t.type};Object(n.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.isDialogOpen=!0,this.parent.trigger(y,i)}renderFilterUI(e,t){let i=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t}),this.renderOperatorUI(i,e,t),this.renderFlValueUI(i,e,t)}renderOperatorUI(e,t,i){this.flMuiObj.renderOperatorUI(e,t,i,this.dlgObj)}renderFlValueUI(e,t,i){let s=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),r=this.filterObj;e.appendChild(s);let l=new this.colTypes[i.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(i.filterTemplate){let e={};e[i.field]=e.value=r.values[i.field],i.foreignKeyValue&&(e[i.foreignKeyValue]=r.values[i.field],e[i.field]=void 0),e.column=i;let t=this.parent.element.id+i.uid+"filterTemplate";if(this.parent.isReact&&"string"!=typeof i.filterTemplate)i.getFilterTemplate()(e,this.parent,"filterTemplate",t,null,null,s),this.parent.renderTemplates();else{let r=i.getFilterTemplate()(e,this.parent,"filterTemplate",t);Object(n.sb)(t,"FilterTemplate",i),Ot(s,r)}}else if(Object(n.X)(i.filter)||Object(n.X)(i.filter.ui)||Object(n.X)(i.filter.ui.create))l.create({column:i,target:s,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj});else{let e=i.filter.ui.create;"string"==typeof e&&(e=Object(n.V)(e,window)),e({column:i,target:s,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj})}}writeMethod(e,t){let i,s=t.querySelector(".e-flmenu-valinput"),r=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings),l=this.filterSettings.columns;for(let n of l)e.uid===n.uid&&(i=n.value);if(Object(n.X)(e.filter)||Object(n.X)(e.filter.ui)||Object(n.X)(e.filter.ui.write))r.write({column:e,target:s,parent:this.parent,filteredValue:i});else{let t=e.filter.ui.write;"string"==typeof t&&(t=Object(n.V)(t,window)),t({column:e,target:s,parent:this.parent,filteredValue:i})}}filterBtnClick(e){let t,i,s=this.dlgObj.element.querySelector(".e-flmenu-valuediv input");i=this.flMuiObj.getFlOperator();let r=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(e.filterTemplate){let t,s=this.dlgDiv.querySelector(".e-flmenu-valuediv");if(s.children[0].value)t=s.children[0].value;else if(Object(n.W)()||Object(n.X)(s.children[0].ej2_instances)){let i=s.querySelector(".e-control");t="boolean"===e.type?i.checked:Object(n.X)(i.ej2_instances)?i.value:i.ej2_instances[0].value}else t=s.children[0].ej2_instances[0].value;this.filterObj.filterByColumn(e.field,i,t)}else if(Object(n.X)(e.filter)||Object(n.X)(e.filter.ui)||Object(n.X)(e.filter.ui.read))r.read(s,e,i,this.filterObj);else{let r=e.filter.ui.read;"string"==typeof r&&(r=Object(n.V)(r,window)),t=r({element:s,column:e,operator:i,fltrObj:this.filterObj})}this.closeDialog()}clearBtnClick(e){this.filterObj.removeFilteredColsByField(e.field),Object(n.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.closeDialog();let t=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",i=this.parent.element.querySelector('[e-mappinguid="'+e.uid+'"]').parentElement.querySelector(t);i&&i.classList.remove("e-filtered")}destroy(){this.closeDialog()}getFilterUIInfo(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}}}class Ki{constructor(e,t,i){this.parent=e,this.isresetFocus=!0,this.checkBoxBase=new Ei(e),this.addEventListener()}destroy(){this.removeEventListener(),this.checkBoxBase.closeDialog()}openDialog(e){this.checkBoxBase.openDialog(e),this.parent.log("column_type_missing",{column:e.column})}closeDialog(){this.removeEventListener(),this.checkBoxBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})}getModuleName(){return"checkboxFilter"}actionBegin(e){this.parent.trigger(f,e)}actionComplete(e){this.parent.trigger(y,e)}actionPrevent(e){kt(this.parent)&&(this.parent.notify(z,e),e.cancel=!0)}addEventListener(){this.parent.isDestroyed||(this.parent.on("cbox-filter-begin",this.actionBegin,this),this.parent.on("cbox-filter-complete",this.actionComplete,this),this.parent.on("filter-Prevent",this.actionPrevent,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off("cbox-filter-begin",this.actionBegin),this.parent.off("cbox-filter-complete",this.actionComplete),this.parent.off("filter-Prevent",this.actionPrevent))}}class Ui extends Ki{constructor(e,t,i,s){super(e,t,i),this.parent=e,this.isresetFocus=!0,this.excelFilterBase=new Ii(e,s)}destroy(){this.excelFilterBase.closeDialog()}openDialog(e){this.excelFilterBase.openDialog(e)}closeDialog(){this.excelFilterBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})}filterByColumn(e,t,i,s,r,n,l,a){this.excelFilterBase.filterByColumn(e,t,i,s,r,n,l,a)}getFilterUIInfo(){return this.excelFilterBase.getFilterUIInfo()}getModuleName(){return"excelFilter"}}class Yi{constructor(e,t,i){this.predicate="and",this.contentRefresh=!0,this.filterByMethod=!0,this.refresh=!0,this.values={},this.operators={},this.cellText={},this.nextFlMenuOpen="",this.type={Menu:Gi,CheckBox:Ki,Excel:Ui},this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.fltrDlgDetails={field:"",isOpen:!1},this.skipNumberInput=["="," ","!"],this.skipStringInput=[">","<","="],this.actualPredicate={},this.parent=e,this.filterSettings=t,this.serviceLocator=i,this.addEventListener()}render(e){if(l.b.getObject("args.isFrozen",e)||"Left-Right"===this.parent.getFrozenMode()&&l.b.getObject("args.renderFrozenRightContent",e))return;let t=this.parent;if(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&t.columns.length){let e=this.parent.element.querySelector(".e-filterbar");e&&Object(n.hb)(e);let i,s=new H(this.serviceLocator,A.Filter,t);this.serviceLocator.getService("cellRendererFactory").addCellRenderer(A.Filter,new qi(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),s.element=this.parent.createElement("tr",{className:"e-filterbar"}),i=this.generateRow(),i.data=this.values,"Right"===t.getFrozenMode()?t.getFrozenRightHeader().querySelector("thead").appendChild(s.element):this.parent.getHeaderContent().querySelector("thead").appendChild(s.element);let r=this.parent.element.querySelector(".e-rowdragheader");this.element=s.render(i,t.getColumns(),null,null,s.element);let l=this.element.querySelector(".e-detailheadercell");l&&(l.className="e-filterbarcell e-mastercell"),r&&(r.className="e-dragheadercell e-mastercell");let a=[].slice.call(this.element.querySelectorAll(".e-grouptopleftcell"));a.length&&a[a.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify("freezerender",{case:"filter"})}}destroy(){let e=this.parent.element;if(e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator){let e=this.element.querySelectorAll(".e-filterbaroperator");for(let t=0;t<e.length;t++)e[t].ej2_instances[0].destroy()}if(this.element){Object(n.hb)(this.element);let e=this.parent.getHeaderContent().querySelector(".e-filterbar");this.parent.isFrozenGrid()&&e&&Object(n.hb)(e)}}}generateRow(e){let t=new P({});return t.cells=this.generateCells(),t}generateCells(){let e=[];if(this.parent.allowGrouping)for(let t=0,i=this.parent.groupSettings.columns.length;t<i;t++)e.push(this.generateCell({},A.HeaderIndent));(this.parent.detailTemplate||this.parent.childGrid)&&e.push(this.generateCell({},A.DetailHeader)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&e.push(this.generateCell({},A.RowDragHIcon));for(let t of this.parent.getColumns())e.push(this.generateCell(t));return"Right"===this.parent.getFrozenMode()&&e.push(this.generateCell({},A.RowDragHIcon)),e}generateCell(e,t){let i={visible:e.visible,isDataCell:!1,rowId:"",column:e,cellType:t||A.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new q(i)}updateModel(){let e=this.parent.getColumnByField(this.fieldName);this.filterObjIndex=this.getFilteredColsIndexByField(e),this.prevFilterObject=this.filterSettings.columns[this.filterObjIndex];let t=Array.isArray(this.value)?this.value:[this.value];for(let i=0,s=t.length;i<s;i++){let s=e.isForeignColumn()?e.foreignKeyValue:this.fieldName;this.currentFilterObject={field:s,uid:e.uid,isForeignKey:e.isForeignColumn(),operator:this.operator,value:t[i],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}};let r=this.getFilteredColsIndexByField(e);r>-1&&!Array.isArray(this.value)?this.filterSettings.columns[r]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject)}this.filterSettings.columns=this.filterSettings.columns,this.parent.dataBind()}getFilteredColsIndexByField(e){let t=this.filterSettings.columns;for(let i=0,s=t.length;i<s;i++)if(t[i].uid===e.uid||e.isForeignColumn()&&this.parent.getColumnByUid(e.uid).field===e.foreignKeyValue)return i;return-1}onActionComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null);let t=this.isRemove?{requestType:"filtering",type:y}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:Object(n.X)(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:y};this.parent.trigger(y,Object(n.K)(e,t)),this.isRemove=!1}wireEvents(){n.l.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)}unWireEvents(){n.l.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())}initialEnd(){if(this.parent.off(O,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){let e=this.parent;this.contentRefresh=!1,this.initialLoad=!0;for(let t of e.filterSettings.columns)this.filterByColumn(t.field,t.operator,t.value,t.predicate,t.matchCase,t.ignoreAccent,t.actualFilterValue,t.actualOperator);this.initialLoad=!1,this.updateFilterMsg(),this.contentRefresh=!0}}addEventListener(){this.parent.isDestroyed||(this.parent.on(x,this.enableAfterRender,this),this.parent.on("filtering-complete",this.onActionComplete,this),this.parent.on(R,this.onPropertyChanged,this),this.parent.on(I,this.keyUpHandler,this),this.parent.on("column-position-changed",this.columnPositionChanged,this),this.parent.on(E,this.render,this),this.parent.on(O,this.initialEnd,this),this.parent.on("filter-menu-close",this.filterMenuClose,this),n.l.add(document,"click",this.clickHandler,this),this.parent.on("filterOpen",this.columnMenuFilter,this),this.parent.on(M,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on("close-filter-dialog",this.clickHandler,this))}removeEventListener(){n.l.remove(document,"click",this.clickHandler),this.parent.isDestroyed||(this.parent.off(x,this.enableAfterRender),this.parent.off("filtering-complete",this.onActionComplete),this.parent.off(R,this.onPropertyChanged),this.parent.off(I,this.keyUpHandler),this.parent.off("column-position-changed",this.columnPositionChanged),this.parent.off(E,this.render),this.parent.off("filterOpen",this.columnMenuFilter),this.parent.off("filter-menu-close",this.filterMenuClose),this.parent.off(M,this.filterIconClickHandler),this.parent.off("close-filter-dialog",this.clickHandler))}filterMenuClose(e){this.fltrDlgDetails.isOpen=!1}filterByColumn(e,t,i,s,r,l,a,o){let h,d=this.parent;if(this.column=d.grabColumnByFieldFromAllCols(e),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(t=this.getOperatorName(e)),!this.column)return;if("FilterBar"===this.filterSettings.type&&(h=d.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),!Object(n.X)(this.column.allowFiltering)&&!this.column.allowFiltering)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText});if(kt(d))return void d.notify(z,{instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:s,arg5:r,arg6:l,arg7:a,arg8:o});if(this.predicate=s||(Array.isArray(i)?"or":"and"),this.value=i,this.matchCase=r||!1,this.ignoreAccent=this.ignoreAccent=Object(n.X)(l)?this.parent.filterSettings.ignoreAccent:l,this.fieldName=e,this.operator=t,i=!Object(n.X)(i)&&i.toString(),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),d.getColumnHeaderByField(e).setAttribute("aria-filtered","true"),h&&"FilterBar"===this.filterSettings.type){if(i.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,i))return this.filterStatusMsg=i.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();h.value!==i&&(h.value=i)}Object(n.X)(this.column.format)?this.values[this.column.field]=i:(this.applyColumnFormat(i),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(h.value=this.values[this.column.field]));let c={field:this.fieldName,predicate:s,matchCase:r,ignoreAccent:l,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter(e=>e.field===this.fieldName).length>1&&!Object(n.X)(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(c):this.actualPredicate[this.fieldName]=[c],this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}applyColumnFormat(e){let t="date"===this.column.type||"datetime"===this.column.type?new Date(e):parseFloat(e);this.values[this.column.field]=this.setFormatForFlColumn(t,this.column)}skipUid(e){let t=!0,i=Object.keys(e);for(let s=0;s<i.length;s++){let r=Object.keys(e[i[s]]);1===r.length&&"uid"===r[0]&&(t=!1)}return t}onPropertyChanged(e){if(e.module===this.getModuleName())for(let t of Object.keys(e.properties))switch(t){case"columns":let i="columns",s={currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:f,cancel:!1};if(this.contentRefresh&&this.skipUid(e.properties[i])){if(this.parent.notify(D,s),s.cancel)return void(Object(n.X)(this.prevFilterObject)?this.filterSettings.columns.splice(this.filterSettings.columns.length-1,1):this.filterSettings.columns[this.filterObjIndex]=this.prevFilterObject);this.addFilteredClass(s.currentFilteringColumn),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter()}break;case"showFilterBarStatus":e.properties[t]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader(),this.refreshFilterSettings()}}refreshFilterSettings(){if("FilterBar"===this.filterSettings.type){for(let e=0;e<this.filterSettings.columns.length;e++){this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[e].uid);let t=this.filterSettings.columns[e].value;t=!Object(n.X)(t)&&t.toString(),Object(n.X)(this.column.format)?this.values[this.filterSettings.columns[e].field]=this.filterSettings.columns[e].value:this.applyColumnFormat(t);let i=this.getFilterBarElement(this.column.field);i&&(i.value=""===this.cellText[this.filterSettings.columns[e].field]||Object(n.X)(this.cellText[this.filterSettings.columns[e].field])?this.filterSettings.columns[e].value:this.cellText[this.column.field])}if(0===this.filterSettings.columns.length){let e=this.parent.getColumns();for(let t=0;t<e.length;t++){let i=this.getFilterBarElement(e[t].field);i&&""!==i.value&&(i.value="",delete this.values[e[t].field])}}}}getFilterBarElement(e){let t,i="[id='"+e+"_filterBarcell']";return i&&!Object(n.X)(this.element)&&(t=this.element.querySelector(i)),t}refreshFilter(){this.refreshFilterSettings(),this.updateFilterMsg()}clearFiltering(e){let t=yt(this.filterSettings.columns);if(!Object(n.X)(e))return this.refresh=!1,e.forEach(e=>{this.removeFilteredColsByField(e,!1)}),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(kt(this.parent))return void this.parent.notify(z,{instance:this,handler:this.clearFiltering});for(let r=0;r<t.length;r++)t[r].uid=t[r].uid||this.parent.getColumnByField(t[r].field).uid;let i=t.map(e=>e.uid),s=i.filter((e,t)=>i.indexOf(e)===t);this.refresh=!1;for(let r=0,n=s.length;r<n;r++)this.removeFilteredColsByField(this.parent.getColumnByUid(s[r]).field,!1);if(Object(n.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.refresh=!0,s.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered")){let e=[].slice.call(this.parent.element.querySelectorAll(".e-filtered"));for(let t=0,i=e.length;t<i;t++)e[0].removeAttribute("aria-filtered"),e[0].classList.remove("e-filtered")}this.isRemove=!0,this.filterStatusMsg="",this.updateFilterMsg()}checkAlreadyColFiltered(e){let t=this.filterSettings.columns;for(let i of t)if(i.field===e&&i.value===this.value&&i.operator===this.operator&&i.predicate===this.predicate)return!0;return!1}columnMenuFilter(e){this.column=e.col;let t=Object(n.C)(e.target,"#"+e.id);e.isClose&&!t?this.filterModule.closeDialog():t&&this.filterDialogOpen(this.column,e.target)}filterDialogOpen(e,t,i,s){let r=this.parent;this.filterModule&&this.filterModule.closeDialog(),this.filterModule=new this.type[e.filter.type||this.parent.filterSettings.type](this.parent,r.filterSettings,this.serviceLocator,this.customOperators,this);let l=e.filter.dataSource||r.dataSource&&"result"in r.dataSource?r.dataSource:r.getDataModule().dataManager;this.filterModule.openDialog({type:e.type,field:e.field,displayName:e.headerText,dataSource:l,format:e.format,height:800,columns:r.getColumns(),filteredColumns:r.filterSettings.columns,target:t,dataManager:r.getDataModule().dataManager,formatFn:e.getFormatter(),ignoreAccent:r.filterSettings.ignoreAccent,parserFn:e.getParser(),query:r.query,template:e.getFilterItemTemplate(),hideSearchbox:!Object(n.X)(e.filter.hideSearchbox)&&e.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:r.getLocaleConstants(),position:{X:i,Y:s},column:e,foreignKeyValue:e.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:r.localeObj,isRemote:r.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity})}removeFilteredColsByField(e,t){let i,s=this.filterSettings.columns;if(kt(this.parent))return void this.parent.notify(z,{instance:this,handler:this.removeFilteredColsByField,arg1:e,arg2:t});let r=s.map(e=>e.uid),l=r.filter((e,t)=>r.indexOf(e)===t);for(let a=0,o=l.length;a<o;a++){s[a].uid=s[a].uid||this.parent.getColumnByField(s[a].field).uid;let r=s.length,o=this.parent.grabColumnByUidFromAllCols(l[a]);if(o.field===e||o.field===o.foreignKeyValue&&o.isForeignColumn()){let l=this.filterSettings.columns.filter(e=>e.uid===o.uid)[0];if("FilterBar"===this.filterSettings.type&&!t){let t="[id='"+o.field+"_filterBarcell']";i=this.parent.getHeaderContent().querySelector(t),i&&(i.value="",delete this.values[e])}for(;r--;)s[r].uid===o.uid&&s.splice(r,1);let a=this.parent.getColumnHeaderByField(o.field);a.removeAttribute("aria-filtered"),"FilterBar"!==this.filterSettings.type&&a.querySelector(this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter").classList.remove("e-filtered"),this.isRemove=!0,this.actualPredicate[e]&&delete this.actualPredicate[e],this.values[e]&&delete this.values[e],this.refresh&&(Object(n.W)()&&!this.parent.isJsComponent?(this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.notify(D,{requestType:"filtering",type:f,currentFilterObject:{field:o.field,operator:this.operator,value:this.value,predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}},currentFilterColumn:o})):this.parent.notify(D,{requestType:"filtering",type:f,currentFilterObject:l,currentFilterColumn:o,action:"clearFilter"}));break}}this.updateFilterMsg()}getModuleName(){return"filter"}keyUpHandlerImmediate(e){13!==e.keyCode&&this.keyUpHandler(e)}keyUpHandler(e){let t=this.parent,i=e.target;if(i&&Object(n.cb)(i,".e-filterbar input")){let s=Object(n.C)(i,"th.e-filterbarcell");if(this.column=t.getColumnByUid(s.getAttribute("e-mappinguid")),!this.column)return;if("altDownArrow"===e.action&&this.parent.filterSettings.showFilterBarOperator){let e=Object(n.C)(i,"span").querySelector(".e-filterbaroperator");e.ej2_instances[0].showPopup(),e.focus()}"Immediate"!==this.filterSettings.mode&&(13!==e.keyCode||e.target.classList.contains("e-filterbaroperator"))||9===e.keyCode||(this.value=i.value.trim(),this.processFilter(e))}if("altDownArrow"===e.action&&"FilterBar"!==this.filterSettings.type){let e=t.focusModule.currentInfo.element;if(e&&e.classList.contains("e-headercell")){let i=t.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid"));this.openMenuByField(i.field),this.parent.focusModule.clearIndicator()}}"escape"===e.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),t.notify("restore-Focus",{}))}updateCrossIcon(e){e.value.length&&e.nextElementSibling.classList.remove("e-hide")}updateFilterMsg(){if("FilterBar"===this.filterSettings.type){let e,t,i=this.parent,s=this.filterSettings.columns;if(this.serviceLocator.getService("valueFormatter"),!this.filterSettings.showFilterBarStatus)return;if(s.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage")){this.filterStatusMsg="";for(let r=0;r<s.length;r++)if(t=i.grabColumnByUidFromAllCols(s[r].uid)||i.grabColumnByFieldFromAllCols(s[r].field),r&&(this.filterStatusMsg+=" && "),Object(n.X)(t.format))this.filterStatusMsg+=t.headerText+": "+this.values[t.field];else{let i="date"===t.type||"datetime"===t.type?this.valueFormatter.fromView(this.values[t.field],t.getParser(),t.type):this.values[t.field];e="date"!==t.type&&"datetime"!==t.type?this.serviceLocator.getService("valueFormatter").toView(i,t.getParser()).toString():this.setFormatForFlColumn(i,t),this.filterStatusMsg+=t.headerText+": "+e}}i.allowPaging&&i.updateExternalMessage(this.filterStatusMsg),this.filterStatusMsg=""}}setFormatForFlColumn(e,t){return this.serviceLocator.getService("valueFormatter").toView(e,t.getFormatter()).toString()}checkForSkipInput(e,t){let i;if("number"===e.type)(l.b.operatorSymbols[t]||this.skipNumberInput.indexOf(t)>-1)&&(i=!0);else if("string"===e.type)for(let s of t)this.skipStringInput.indexOf(s)>-1&&(i=!0);return i}processFilter(e){this.stopTimer(),this.startTimer(e)}startTimer(e){this.timer=window.setInterval(()=>{this.onTimerTick()},13===e.keyCode?0:this.filterSettings.immediateModeDelay)}stopTimer(){window.clearInterval(this.timer)}onTimerTick(){let e,t="[id='"+this.column.field+"_filterBarcell']",i=this.element.querySelector(t);if(!i&&this.parent.isFrozenGrid()&&(i=this.parent.getHeaderContent().querySelector(t)),this.cellText[this.column.field]=i.value,this.stopTimer(),Object(n.X)(this.column.filterBarTemplate))e=JSON.parse(JSON.stringify(i.value));else{let e=this.column.filterBarTemplate.read;"string"==typeof e&&(e=Object(n.V)(e,window)),Object(n.X)(e)||(this.value=e.call(this,i))}Object(n.X)(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,i.value=e,this.updateFilterMsg())}validateFilterValue(e){let t,i;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal,t=[">","<","=","!"];for(let s=0;s<e.length;s++)if(t.indexOf(e[s])>-1){i=s;break}this.getOperator(e.substring(i)),0!==i&&(this.value=e.substring(0,i)),""!==this.value&&e.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type)),isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal,""===this.value||this.value instanceof Date||(this.getOperator(e),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),Object(n.X)(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1,"*"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(e.length-1)?(this.value=this.value.slice(0,-1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.endsWith):this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.startsWith;break;case"boolean":"true"===e.toLowerCase()||"1"===e?this.value=!0:"false"===e.toLowerCase()||"0"===e?this.value=!1:e.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")),this.operator=this.filterOperators.equal;break;default:this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal}}getOperator(e){let t=e.charAt(0),i=e.slice(0,2),s=Object(n.K)({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},l.b.operatorSymbols);(s.hasOwnProperty(t)||s.hasOwnProperty(i))&&(this.operator=s[t],this.value=e.substring(1),this.operator||(this.operator=s[i],this.value=e.substring(2))),this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))}columnPositionChanged(e){}getLocalizedCustomOperators(){let e=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}],numberOperator:e,dateOperator:e,datetimeOperator:e,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}}openMenuByField(e){let t=this.parent,i=t.getColumnByField(e),s=t.getColumnHeaderByField(e).querySelector(".e-filtermenudiv");if(!s)return;let r=t.element.getBoundingClientRect(),n=s.getBoundingClientRect();this.filterDialogOpen(i,s,n.right-r.left,n.bottom-r.top)}filterIconClickHandler(e){let t=e.target;if(t.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){let e=this.parent.getColumnByUid(mt(t,"e-headercell").firstElementChild.getAttribute("e-mappinguid"));if(this.column=e,this.fltrDlgDetails.field===e.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog(),this.fltrDlgDetails={field:e.field,isOpen:!0},this.openMenuByField(e.field)}}clickHandler(e){if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(mt(e.target,"e-filterbarcell")&&e.target.classList.contains("e-input-group-icon")&&Object(n.C)(e.target,"div").querySelector(".e-filterbaroperator").focus(),e.target.classList.contains("e-list-item"))){let e=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup","");-1!==e.indexOf("grid-column")&&Object(n.C)(document.getElementById(e),"div").querySelector(".e-filtertext").focus()}if("Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){let t=e.target,i=t.classList.contains("e-day"),s=mt(this.parent.element,"e-dialog"),r=!1,l=mt(t,"e-popup"),a=this.parent.element.querySelector(".e-filter-popup");if(s&&l&&(r=s.id===l.id),a&&(mt(t,"e-excel-ascending")||mt(t,"e-excel-descending"))&&this.filterModule.closeDialog(t),mt(t,"e-filter-popup")||t.classList.contains("e-filtermenudiv"))return;!this.filterModule||mt(t,"e-popup-wrapper")||Object(n.C)(t,".e-filter-item.e-menu-item")||i||(r&&!mt(t,"e-filter-popup")&&!mt(t,"e-popup-flmenu")||!l&&a)&&(this.filterModule.isresetFocus=mt(t,"e-grid")&&mt(t,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(t)),"Immediate"===this.filterSettings.mode&&t.classList.contains("e-clear-icon")&&this.removeFilteredColsByField(t.previousElementSibling.id.slice(0,-14))}}filterHandler(e){let t;this.actualPredicate[e.field]=e.actualPredicate;let i=new l.a(this.filterSettings.columns),s=(new l.g).where("field",this.filterOperators.equal,e.field),r=i.executeLocal(s);for(let n=0;n<r.length;n++){let e=-1;for(let t=0;t<this.filterSettings.columns.length;t++)if(r[n].field===this.filterSettings.columns[t].field){e=t;break}-1!==e&&this.filterSettings.columns.splice(e,1)}"clear-filter"===e.action&&Object(n.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.values[e.field]&&delete this.values[e.field];let a=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";t=this.parent.getColumnHeaderByField(e.field).querySelector(a),"filtering"===e.action?(this.filterSettings.columns=this.filterSettings.columns.concat(e.filterCollection),this.filterSettings.columns.length&&t&&t.classList.add("e-filtered")):(t&&t.classList.remove("e-filtered"),e.requestType="filtering",this.parent.renderModule.refresh(e)),this.parent.dataBind()}updateFilter(){let e=this.filterSettings.columns;this.actualPredicate={};for(let t=0;t<e.length;t++){this.column=this.parent.getColumnByField(e[t].field)||Gt(e[t].field,this.parent.getForeignKeyColumns());let i=e[t].field;this.parent.getColumnByField(e[t].field)||(i=Gt(e[t].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(i,e[t].operator,e[t].value,e[t].type,e[t].predicate,e[t].matchCase,e[t].ignoreAccent,e[t].uid)}}refreshFilterIcon(e,t,i,s,r,n,l,a){let o;o={field:e,predicate:r,matchCase:n,ignoreAccent:l,operator:t,value:i,type:s},this.actualPredicate[e]?this.actualPredicate[e].push(o):this.actualPredicate[e]=[o];let h=a?this.parent.grabColumnByUidFromAllCols(a).field:e;this.addFilteredClass(h)}addFilteredClass(e){let t;this.parent.showColumnMenu?t=this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu"):this.parent.getColumnByField(e)&&(t=this.parent.getColumnHeaderByField(e).querySelector(".e-icon-filter")),t&&t.classList.add("e-filtered")}getFilterUIInfo(){return this.filterModule?this.filterModule.getFilterUIInfo():{}}getOperatorName(e){return document.getElementById(this.parent.getColumnByField(e).uid).ej2_instances[0].value}}class _i{constructor(e){this.tapped=!1,this.isDblClk=!0,this.parent=e,this.parent.isDestroyed||(this.widthService=new ge(e),this.addEventListener())}autoFitColumns(e){let t=null==e||e.length<=0?this.parent.getColumns().map(e=>e.field):"string"==typeof e?[e]:e;this.findColumn(t)}autoFit(){let e=this.parent.getColumns().filter(e=>!0===e.autoFit).map(e=>e.field||e.headerText);e.length>0&&this.autoFitColumns(e),"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()}resizeColumn(e,t,i){let s,r,l,a,o,h,d=this.parent,c=0,p=0,u=i||this.parent.getUidByColumnField(e),g=this.parent.getNormalizedColumnIndex(u),m=this.parent.getColumnIndexByField(e),f=d.getFrozenColumns()||d.getFrozenLeftColumnsCount(),y=d.getMovableColumnsCount();if(Object(n.X)(d.getFooterContent())||(l=d.getFooterContentTable()),d.isFrozenGrid()){let t=d.getColumnByField(e);"frozen-left"===t.getFreezeTableName()?(s=d.getHeaderTable(),r=d.getContentTable(),a=s.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),o=r.querySelectorAll(`td:nth-child(${g+1})`),l&&(h=l.querySelectorAll(`td:nth-child(${g+1})`))):"movable"===t.getFreezeTableName()?(s=d.getHeaderContent().querySelector(".e-movableheader").children[0],r=d.getContent().querySelector(".e-movablecontent").children[0],a=s.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),o=r.querySelectorAll(`td:nth-child(${g-f+1})`),l&&(l=d.getFooterContent().querySelector(".e-movablefootercontent").children[0],h=l.querySelectorAll(`td:nth-child(${g-f+1})`))):"frozen-right"===t.getFreezeTableName()&&(s=d.getHeaderContent().querySelector(".e-frozen-right-header").children[0],r=d.getContent().querySelector(".e-frozen-right-content").children[0],a=s.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),o=r.querySelectorAll(`td:nth-child(${g-(f+y)+1})`),l&&(l=d.getFooterContent().querySelector(".e-movablefootercontent").children[0],h=l.querySelectorAll(`td:nth-child(${g-(f+y)+1})`)))}else s=d.getHeaderTable(),r=d.getContentTable(),a=s.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),o=r.querySelectorAll(`td:nth-child(${g+1}):not(.e-groupcaption)`),l&&(h=l.querySelectorAll(`td:nth-child(${g+1}):not(.e-groupcaption)`));let C=s.querySelector("tr").querySelectorAll(".e-grouptopleftcell");if(C.length>0)for(let n=0;n<C.length;n++)p+=C[n].offsetWidth;let v=r.querySelector(".e-detailrowcollapse")||r.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&v&&(p+=v.offsetWidth);let w=[a],S=[],O=[];if(l)for(let n=0;n<h.length;n++)O[n]=h[n].cloneNode(!0);for(let n=0;n<o.length;n++)S[n]=o[n].cloneNode(!0);let x=this.createTable(s,w,"e-gridheader"),j=this.createTable(r,S,"e-gridcontent"),R=null;O.length&&(R=this.createTable(l,O,"e-gridfooter"));let D,E=d.getColumns()[m],I=E.width=Object(n.L)(Math.max(x,j,R)),M=E.maxWidth&&parseFloat(E.maxWidth.toString());if(parseInt(I,10)>M&&(E.width=M),this.widthService.setColumnWidth(d.getColumns()[m]),D=d.getColumns().some(e=>null==e.width||e.width.length<=0),!1===D){let e=d.getColumns();for(let t=0;t<e.length;t++)e[t].visible&&(c+=parseFloat(e[t].width))}let F=c+p;c>0&&!d.isFrozenGrid()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new b({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(F="100%"),s.style.width=Object(n.L)(F),r.style.width=Object(n.L)(F),Object(n.X)(l)||(l.style.width=Object(n.L)(F)));let T=s.offsetWidth;d.getContent().scrollWidth>T?(s.classList.add("e-tableborder"),r.classList.add("e-tableborder")):(s.classList.remove("e-tableborder"),r.classList.remove("e-tableborder")),Object(n.X)(l)||l.classList.add("e-tableborder")}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())}getModuleName(){return"resize"}findColumn(e){for(let t=0;t<e.length;t++){let i=e[t],s=this.parent.getColumnIndexByField(i),r=this.parent.getColumns()[s];s>-1&&!Object(n.X)(r)&&!0===r.visible&&this.resizeColumn(i,s)}}createTable(e,t,i){let s=this.parent.createElement("div");s.className=this.parent.element.className,s.style.cssText="display: inline-block;visibility:hidden;position:absolute";let r=this.parent.createElement("div");r.className=i;let n=this.parent.createElement("table");n.className=e.className,n.classList.add("e-resizetable"),n.style.cssText="table-layout: auto;width: auto";let l=this.parent.createElement("tr");for(let o=0;o<t.length;o++){let i=l.cloneNode();i.className=e.querySelector("tr").className,i.appendChild(t[o]),n.appendChild(i)}r.appendChild(n),s.appendChild(r),document.body.appendChild(s);let a=n.getBoundingClientRect().width;return document.body.removeChild(s),Math.ceil(a)}addEventListener(){this.parent.isDestroyed||(this.parent.on(E,this.refreshHeight,this),this.parent.on(w,this.wireEvents,this),this.parent.on(O,this.autoFit,this),this.parent.on("refreshResizeHandlers",this.refreshHeight,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(E,this.refreshHeight),this.parent.off(w,this.wireEvents),this.parent.off("refreshResizeHandlers",this.refreshHeight))}render(){this.unwireEvents(),this.wireEvents(),this.setHandlerHeight()}refreshHeight(){let e=this.getResizeHandlers();for(let t=0;t<e.length;t++)e[t].parentElement.offsetHeight>0&&(e[t].style.height=e[t].parentElement.offsetHeight+"px");this.setHandlerHeight()}wireEvents(){n.l.add(this.parent.getHeaderContent(),n.d.touchStartEvent,this.touchResizeStart,this),n.l.add(this.parent.getHeaderContent(),"dblclick",this.callAutoFit,this)}unwireEvents(){n.l.remove(this.parent.getHeaderContent(),n.d.touchStartEvent,this.touchResizeStart),n.l.remove(this.parent.getHeaderContent(),"dblclick",this.callAutoFit)}getResizeHandlers(){return this.parent.isFrozenGrid()?[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")):[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-rhandler"))}setHandlerHeight(){let e=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-rsuppress"));for(let t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"}callAutoFit(e){if(e.target.classList.contains("e-rhandler")){let t=this.getTargetColumn(e);if(t.columns)return;this.resizeColumn(t.field,this.parent.getNormalizedColumnIndex(t.uid),t.uid),Object(n.C)(e.target,"th.e-headercell").classList.add("e-resized")}}touchResizeStart(e){if(!ii.timer)return ii.timer=setTimeout(()=>{ii.timer=null},300),this.resizeStart(e);clearTimeout(ii.timer),ii.timer=null,this.callAutoFit(e)}resizeStart(e){if(e.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.parent.allowGrouping)for(let e=0;e<this.parent.groupSettings.columns.length;e++)this.widthService.setColumnWidth(new b({width:"30px"}),e);for(let e of this.refreshColumnWidth())this.widthService.setColumnWidth(e);this.widthService.setWidthToTable()}if(this.refreshStackedColumnWidth(),this.element=e.target,this.parent.getVisibleFrozenColumns()){let e=this.parent.getMovableContentTbody(),t=this.parent.getFrozenLeftContentTbody(),i=this.parent.getFrozenRightContentTbody(),s=[].slice.call(e.querySelectorAll("tr")),r=[].slice.call(t.querySelectorAll("tr")),n=[];"Left-Right"===this.parent.getFrozenMode()&&i&&(n=[].slice.call(i.querySelectorAll("tr")));for(let l=0;l<s.length;l++)fi(this.parent,(e,t)=>{this.parent.rowHeight?t[l].style.height=this.parent.rowHeight+"px":t[l].style.removeProperty("height")},[r,s,n])}this.parentElementWidth=this.parent.element.getBoundingClientRect().width,this.appendHelper(),this.column=this.getTargetColumn(e),this.pageX=this.getPointX(e),this.minMove="frozen-right"===this.column.getFreezeTableName()?this.parent.enableRtl?(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(Object(n.X)(this.column.width)?"":this.column.width.toString()):parseFloat(Object(n.X)(this.column.width)?"":this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.parent.enableRtl?parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(Object(n.X)(this.column.width)?"":this.column.width.toString()),this.minMove+=this.pageX}if(n.d.isDevice&&!this.helper.classList.contains("e-ricon"))this.helper.classList.add("e-ricon"),n.l.add(document,n.d.touchStartEvent,this.removeHelper,this),n.l.add(this.helper,n.d.touchStartEvent,this.resizeStart,this);else{let t;t=!Object(n.W)()||this.parent.isJsComponent?{e,column:this.column}:{column:Object(n.K)({},this.column)},this.parent.trigger("resizeStart",t,e=>{e.cancel||this.parent.isEdit?this.cancelResizeAction():(n.l.add(document,n.d.touchEndEvent,this.resizeEnd,this),n.l.add(this.parent.element,n.d.touchMoveEvent,this.resizing,this),this.updateCursor("add"))})}}}cancelResizeAction(e){e&&(n.l.remove(this.parent.element,n.d.touchMoveEvent,this.resizing),n.l.remove(document,n.d.touchEndEvent,this.resizeEnd),this.updateCursor("remove")),n.d.isDevice&&(n.l.remove(document,n.d.touchStartEvent,this.removeHelper),n.l.remove(this.helper,n.d.touchStartEvent,this.resizeStart)),Object(n.I)(this.helper),this.refresh()}getWidth(e,t,i){return t&&e<t?t:i&&e>i?i:e}updateResizeEleHeight(){let e=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler"));for(let t=0;t<e.length;t++)e[t].style.height=this.element.parentElement.offsetHeight+"px"}getColData(e,t){return{width:parseFloat(Object(n.X)(this.widthService.getWidth(e))||"auto"===this.widthService.getWidth(e)?"0":this.widthService.getWidth(e).toString())+t,minWidth:e.minWidth?parseFloat(e.minWidth.toString()):null,maxWidth:e.maxWidth?parseFloat(e.maxWidth.toString()):null}}resizing(e){if(Object(n.X)(this.column))return;let t=0;Object(n.X)(this.column)&&(t=mt(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight());let i=this.getPointX(e),s=this.parent.enableRtl?-(i-this.pageX):i-this.pageX;"frozen-right"===this.column.getFreezeTableName()&&(s=this.parent.enableRtl?i-this.pageX:this.pageX-i);let r=this.getColData(this.column,s);r.width||(r.width=Object(n.C)(this.element,"th").offsetWidth);let l=this.getWidth(r.width,r.minWidth,r.maxWidth);if(this.parent.log("resize_min_max",{column:this.column,width:l}),"frozen-right"===this.column.getFreezeTableName()&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i)&&(l=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),("frozen-right"!==this.column.getFreezeTableName()&&(!this.parent.enableRtl&&this.minMove>=i||this.parent.enableRtl&&this.minMove<=i)||"frozen-right"===this.column.getFreezeTableName()&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i))&&(l=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),l!==parseFloat(Object(n.X)(this.column.width)||"auto"===this.column.width?t.toString():this.column.width.toString())){this.pageX=i,this.column.width=Object(n.L)(l);let t={e,column:this.column};if(this.parent.trigger("resizing",t),t.cancel)return void this.cancelResizeAction(!0);let r=[this.column],a=[this.column];this.column.columns&&(r=this.getSubColumns(this.column,[]),r=this.calulateColumnsWidth(r,!1,s),a=this.calulateColumnsWidth(r,!0,s));for(const e of a)this.widthService.setColumnWidth(e,null,"resize");this.updateHelper()}this.isDblClk=!1}calulateColumnsWidth(e,t,i){let s=[];for(const r of e){let l=0;for(let t=0;t<e.length;t++)l+=parseFloat(e[t].width.toString());let a=this.getColData(r,parseFloat(r.width)*i/l),o=this.getWidth(a.width,a.minWidth,a.maxWidth);o!==parseFloat(r.width.toString())&&(t&&(r.width=Object(n.L)(o<1?1:o)),s.push(r))}return s}getSubColumns(e,t){for(const i of e.columns)!1!==i.visible&&i.allowResizing&&(i.columns?this.getSubColumns(i,t):t.push(i));return t}resizeEnd(e){if(!this.helper||this.parent.isDestroyed)return;let t;n.l.remove(this.parent.element,n.d.touchMoveEvent,this.resizing),n.l.remove(document,n.d.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),Object(n.I)(this.helper),t=!Object(n.W)()||this.parent.isJsComponent?{e,column:this.column}:{column:Object(n.K)({},this.column)};let i=this.parent.getContent().querySelector(".e-content"),s=i.querySelector(".e-movablecontent")?i.querySelector(".e-movablecontent"):i;s.scrollHeight>s.clientHeight&&(this.parent.scrollModule.setPadding(),s.style.overflowY="scroll"),this.parent.trigger("resizeStop",t),Object(n.C)(this.element,".e-headercell").classList.add("e-resized"),this.isFrozenColResized=!!mt(this.element,"e-frozenheader"),this.parent.isFrozenGrid()&&this.parent.notify("freezerender",{case:"textwrap"}),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify("textWrapRefresh",{case:"textwrap"})),this.refresh(),this.doubleTapEvent(e),this.isDblClk=!0}getPointX(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX}refreshColumnWidth(){let e=this.parent.getColumns();for(let t of[].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell")))for(let i of e)if(t.querySelector("[e-mappinguid]")&&t.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===i.uid&&i.visible){i.width=t.getBoundingClientRect().width;break}return e}refreshStackedColumnWidth(){for(const e of this.parent.getStackedColumns(this.parent.columns))e.width=this.getStackedWidth(e,0)}getStackedWidth(e,t){for(const i of e.columns)!1!==i.visible&&(i.columns?this.getStackedWidth(i,t):t+=i.width);return t}getTargetColumn(e){let t=Object(n.C)(e.target,"th.e-headercell");t=t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv");let i=t.getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}updateCursor(e){let t=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th"));t.push(this.parent.element);for(let i of t)i.classList[e]("e-rcursor")}refresh(){this.column=null,this.pageX=null,this.element=null,this.helper=null}appendHelper(){this.helper=this.parent.createElement("div",{className:"e-rhelper"}),this.parent.element.appendChild(this.helper),this.setHelperHeight()}setHelperHeight(){let e=this.parent.isFrozenGrid(),t=e?this.parent.getContent().querySelector(".e-content").offsetHeight:this.parent.getContent().offsetHeight-this.getScrollBarWidth(),i=Object(n.C)(this.element,"th.e-headercell"),s=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),r=this.parent.getFrozenRightColumnsCount();e&&(s=mt(i,"e-movableheader")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll("tr")):r&&mt(i,"e-frozen-right-header")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelectorAll("tr")):[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelectorAll("tr")));for(let n=s.indexOf(i.parentElement);n<s.length&&n>-1;n++)t+=s[n].offsetHeight;let l=this.calcPos(i);mt(i,"e-frozen-right-header")?l.left+=this.parent.enableRtl?i.offsetWidth-2:-1:l.left+=this.parent.enableRtl?-1:i.offsetWidth-2,this.helper.style.cssText="height: "+t+"px; top: "+l.top+"px; left:"+Math.floor(l.left)+"px;"}getScrollBarWidth(e){let t=this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&e||t.scrollWidth>t.clientWidth?Et():0}removeHelper(e){let t=e.target.classList;t.contains("e-rhandler")||t.contains("e-ricon")||!this.helper||(n.l.remove(document,n.d.touchStartEvent,this.removeHelper),n.l.remove(this.helper,n.d.touchStartEvent,this.resizeStart),Object(n.I)(this.helper),this.refresh())}updateHelper(){let e,t=Object(n.C)(this.element,"th.e-headercell");if(e=mt(t,"e-frozen-right-header")?Math.floor(this.calcPos(t).left+(this.parent.enableRtl?t.offsetWidth-2:-1)):Math.floor(this.calcPos(t).left+(this.parent.enableRtl?-1:t.offsetWidth-2)),e>this.parentElementWidth&&(e=this.parentElementWidth-2),this.parent.isFrozenGrid()){let i=Object(n.C)(t,".e-table").offsetLeft;e<i&&(e=i)}this.helper.style.left=e+"px"}calcPos(e){let t={top:0,left:0},i=e.getBoundingClientRect(),s=e.ownerDocument,r=mt(e,"e-grid")||s.documentElement;for(;r&&(r===s.body||r===s.documentElement)&&"static"===r.style.position;)r=r.parentNode;return r&&r!==e&&1===r.nodeType&&(t=r.getBoundingClientRect()),{top:i.top-t.top,left:i.left-t.left}}doubleTapEvent(e){this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(e),this.tapped=null):this.tapped=setTimeout(this.timeoutHandler(),300))}getUserAgent(){let e=n.d.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)}timeoutHandler(){this.tapped=null}}class Qi{constructor(e,t,i,s){this.sortRequired=!0,this.isAppliedGroup=!1,this.isAppliedUnGroup=!1,this.reorderingColumns=[],this.visualElement=Object(n.F)("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}}),this.helper=e=>{let t=this.parent,i=e.sender.target,s=i.classList.contains("e-groupheadercell")?i:mt(i,"e-groupheadercell");return!(!s||!i.classList.contains("e-drag")&&this.groupSettings.allowReordering)&&(this.column=t.getColumnByField(s.firstElementChild.getAttribute("ej-mappingname")),this.visualElement.textContent=s.textContent,this.visualElement.style.width=s.offsetWidth+2+"px",this.visualElement.style.height=s.offsetHeight+2+"px",this.visualElement.setAttribute("e-mappinguid",this.column.uid),t.element.appendChild(this.visualElement),this.visualElement)},this.dragStart=e=>{this.parent.element.classList.add("e-ungroupdrag"),Object(n.W)()&&e.bindEvents(e.dragElement)},this.drag=e=>{this.groupSettings.allowReordering&&this.animateDropper(e);let t=e.target,i=this.parent.element.querySelector(".e-cloneproperties");this.parent.trigger("columnDrag",{target:t,draggableType:"headercell",column:this.column}),this.groupSettings.allowReordering||(Object(n.A)(i,["e-defaultcur"],["e-notallowedcur"]),mt(t,"e-gridcontent")||mt(t,"e-headercell")||Object(n.A)(i,["e-notallowedcur"],["e-defaultcur"]))},this.dragStop=e=>{this.parent.element.classList.remove("e-ungroupdrag");let t=!(mt(e.target,"e-gridcontent")||mt(e.target,"e-gridheader"));if(this.groupSettings.allowReordering&&t){if(Object(n.hb)(e.helper),mt(e.target,"e-groupdroparea"))this.rearrangeGroup(e);else if(!mt(e.target,"e-grid")){let t=this.parent.getColumnByUid(e.helper.getAttribute("e-mappinguid")).field;-1!==this.groupSettings.columns.indexOf(t)&&this.ungroupColumn(t)}}else t&&Object(n.hb)(e.helper)},this.animateDropper=e=>{let t=this.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),i=this.parent.getColumnByUid(t).field,s=mt(e.target,"e-groupdroparea"),r=mt(e.target,"e-group-animator"),n=[].slice.call(this.element.querySelectorAll(".e-groupheadercell")).map(e=>e.querySelector("div").getAttribute("ej-mappingname")),l=JSON.parse(JSON.stringify(n));if(r||s){if(r){let e=r.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),t=+r.getAttribute("index");if(e!==i){let e=l.indexOf(i);-1!==e&&l.splice(e,1),l.splice(t+(-1!==t&&e===t?1:0),0,i)}}else s&&-1===l.indexOf(i)&&l.push(i);this.element.innerHTML="",l.length&&!this.element.classList.contains("e-grouped")&&this.element.classList.add("e-grouped"),this.reorderingColumns=l;for(let e=0;e<l.length;e++)this.addColToGroupDrop(l[e])}else this.addLabel(),this.removeColFromGroupDrop(i)},this.drop=e=>{let t=this.parent,i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));this.element.classList.remove("e-hover"),Object(n.hb)(e.droppedElement),this.aria.setDropTarget(this.parent.element.querySelector(".e-groupdroparea"),!1),this.aria.setGrabbed(this.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1),Object(n.X)(i)||!1===i.allowGrouping||mt(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id")?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):this.groupColumn(i.field)},this.contentRefresh=!0,this.aria=new Q,this.parent=e,this.groupSettings=t,this.serviceLocator=s,this.sortedColumns=i,this.focus=s.getService("focus"),this.addEventListener(),this.groupGenerator=new K(this.parent)}addLabel(){if(!this.element.querySelectorAll(".e-group-animator").length){let e=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=e,this.element.classList.remove("e-grouped")}}rearrangeGroup(e){this.sortRequired=!1,this.updateModel()}columnDrag(e){this.groupSettings.allowReordering&&this.animateDropper(e);let t=this.parent.element.querySelector(".e-cloneproperties");Object(n.A)(t,["e-defaultcur"],["e-notallowedcur"]),mt(e.target,"e-groupdroparea")||this.parent.allowReordering&&mt(e.target,"e-headercell")||Object(n.A)(t,["e-notallowedcur"],["e-defaultcur"]),e.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")}columnDragStart(e){if(e.target.classList.contains("e-stackedheadercell"))return;let t=this.parent.element.querySelector(".e-groupdroparea");this.aria.setDropTarget(t,e.column.allowGrouping);let i=e.target.classList.contains("e-headercell")?e.target:mt(e.target,"e-headercell");this.aria.setGrabbed(i,!0,!e.column.allowGrouping)}columnDrop(e){let t=this.parent;if("grouping"===e.droppedElement.getAttribute("action")){let i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(Object(n.X)(i)||!1===i.allowGrouping||mt(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id"))return;this.ungroupColumn(i.field)}}addEventListener(){this.parent.isDestroyed||(this.parent.on(x,this.enableAfterRender,this),this.parent.on("grouping-complete",this.onActionComplete,this),this.parent.on("ungrouping-complete",this.onActionComplete,this),this.parent.on(R,this.onPropertyChanged,this),this.parent.on(M,this.clickHandler,this),this.parent.on("columnDrag",this.columnDrag,this),this.parent.on("columnDragStart",this.columnDragStart,this),this.parent.on("header-drop",this.columnDrop,this),this.parent.on("columnDrop",this.columnDrop,this),this.parent.on(E,this.refreshSortIcons,this),this.parent.on("sorting-complete",this.refreshSortIcons,this),this.parent.on(I,this.keyPressHandler,this),this.parent.on(O,this.initialEnd,this),this.parent.on(j,this.initialEnd,this),this.parent.on(w,this.render,this),this.parent.on("group-aggregates",this.onGroupAggregates,this),this.parent.on("blazor-action-begin",this.blazorActionBegin,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(w,this.render),this.parent.off(x,this.enableAfterRender),this.parent.off("grouping-complete",this.onActionComplete),this.parent.off("ungrouping-complete",this.onActionComplete),this.parent.off(R,this.onPropertyChanged),this.parent.off(M,this.clickHandler),this.parent.off("columnDrag",this.columnDrag),this.parent.off("columnDragStart",this.columnDragStart),this.parent.off("columnDrop",this.columnDrop),this.parent.off("header-drop",this.columnDrop),this.parent.off(E,this.refreshSortIcons),this.parent.off("sorting-complete",this.refreshSortIcons),this.parent.off(I,this.keyPressHandler),this.parent.off("group-aggregates",this.onGroupAggregates),this.parent.off("blazor-action-begin",this.blazorActionBegin),this.parent.off("group-expand-collapse",this.updateExpand))}blazorActionBegin(){this.parent.allowGrouping&&!this.parent.isCollapseStateEnabled()&&this.expandAll()}initialEnd(){let e=this.parent;if(this.parent.off(O,this.initialEnd),this.parent.off(j,this.initialEnd),Object(n.W)()&&e.isServerRendered){for(let t=0;t<e.columns.length;t++)this.removeColFromGroupDrop(e.columns[t].field);this.updateGroupDropArea()}if(this.parent.getColumns().length&&this.groupSettings.columns.length){this.contentRefresh=!1;for(let t of e.groupSettings.columns)this.groupColumn(t);this.contentRefresh=!0}}keyPressHandler(e){let t=this.parent;if("ctrlSpace"===e.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(e.action))switch(e.preventDefault(),e.action){case"altDownArrow":case"altUpArrow":let i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){let s,r=t.getContentTable().querySelector("tbody").children;for(let e=t.getDataRows()[i[i.length-1]].rowIndex;e>=0;e--)if(!r[e].classList.contains("e-row")&&!r[e].classList.contains("e-detailrow")){s=r[e];break}this.expandCollapseRows(s.querySelector("altUpArrow"===e.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(this.parent.isEdit||null!==Object(n.C)(e.target,"#"+this.parent.element.id+"_searchbar"))return;let s=this.focus.getFocusedElement(),r=s?s.parentElement.querySelector('[class^="e-record"]'):null;if(!r)break;this.expandCollapseRows(r);break;case"ctrlSpace":let l=t.focusModule.currentInfo.element;if(l&&l.classList.contains("e-headercell")){let e=t.getColumnByUid(l.firstElementChild.getAttribute("e-mappinguid"));e.field&&t.groupSettings.columns.indexOf(e.field)<0?this.groupColumn(e.field):this.ungroupColumn(e.field)}}}clickHandler(e){this.expandCollapseRows(e.target),this.applySortFromTarget(e.target),this.unGroupFromTarget(e.target),this.toogleGroupFromHeader(e.target)}unGroupFromTarget(e){e.classList.contains("e-ungroupbutton")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname"))}toogleGroupFromHeader(e){this.groupSettings.showToggleButton&&(e.classList.contains("e-grptogglebtn")?e.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):e.classList.contains("e-toggleungroup")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname")))}applySortFromTarget(e){let t=this.parent,i=Object(n.C)(e,".e-groupheadercell");if(t.allowSorting&&i&&!e.classList.contains("e-ungroupbutton")&&!e.classList.contains("e-toggleungroup")){let e=i.firstElementChild.getAttribute("ej-mappingname");t.getColumnHeaderByField(e).querySelectorAll(".e-ascending").length?t.sortColumn(e,"Descending",!0):t.sortColumn(e,"Ascending",!0)}}expandCollapseRows(e){let t=mt(e,"e-recordplusexpand")||mt(e,"e-recordpluscollapse");if(t){let i,s,r,l,a=t.cellIndex,o=t.parentElement.rowIndex,h=this.parent.getContentTable().querySelector("tbody").children,d=[].slice.call(h).slice(o+1,h.length),c=[],p=this.parent,u=t.parentElement.querySelectorAll(".e-indentcell").length,g=!1;if(Object(n.W)()&&this.parent.isCollapseStateEnabled())return void this.parent.notify("group-expand-collapse",{uid:t.parentElement.getAttribute("data-uid"),isExpand:t.classList.contains("e-recordpluscollapse")});if(t.classList.contains("e-recordpluscollapse")?(Object(n.v)([t],"e-recordplusexpand"),Object(n.ib)([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",g=!0,Yt(p)&&this.updateVirtualRows(p,e,g,l,r),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionExpand(t.parentElement)):(i=!0,Object(n.ib)([t],"e-recordplusexpand"),Object(n.v)([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",Yt(p)&&this.updateVirtualRows(p,e,!i,l,r),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionCollapse(t.parentElement)),this.aria.setExpand(t,g),!Yt(p)&&!this.parent.groupSettings.enableLazyLoading)for(let e=0,t=d.length;e<t&&d[e].querySelectorAll("td")[a]&&d[e].querySelectorAll("td")[a].classList.contains("e-indentcell")&&d;e++)i?d[e].style.display="none":d[e].querySelectorAll(".e-indentcell").length===u+1&&(d[e].style.display="",s=d[e].querySelector(".e-recordplusexpand"),s&&c.push(s),d[e].classList.contains("e-detailrow")&&d[e-1].querySelectorAll(".e-detailrowcollapse").length&&(d[e].style.display="none"));for(let e=0,t=c.length;e<t;e++)Object(n.ib)([c[e]],"e-recordplusexpand"),Object(n.v)([c[e]],"e-recordpluscollapse"),c[e].firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",this.expandCollapseRows(c[e])}}updateVirtualRows(e,t,i,s,r){let n=e.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid"));n.isExpand=i,function(e){let t=[],i=e.vRows;for(let s=0;s<i.length;s++)i[s].isDataRow?t.push(i[s]):i[s].isDataRow||(t.push(i[s]),!i[s].isExpand&&i[s].isCaptionRow&&(s+=rt(i[s],e)));e.vcRows=t}(e),(s=e.getDataModule().generateQuery(!1)).queries=e.getDataModule().aggregateQuery(e.getQuery().clone()).queries;let l={requestType:"virtualscroll",rowObject:n};e.getDataModule().getData(l,s.requiresCount()).then(t=>e.renderModule.dataManagerSuccess(t,l))}expandCollapse(e){if(Object(n.W)()&&this.parent.isCollapseStateEnabled())return void this.parent.notify("group-expand-collapse",{isExpand:e});e||this.parent.notify("initial-collapse",e);let t,i=this.parent.getContentTable().querySelector("tbody").children;for(let s=0,r=i.length;s<r;s++)i[s].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?(t=i[s].querySelector(e?".e-recordpluscollapse":".e-recordplusexpand"),t&&(t.className=e?"e-recordplusexpand":"e-recordpluscollapse",t.firstElementChild.className=e?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"),i[s].firstElementChild.classList.contains("e-recordplusexpand")||i[s].firstElementChild.classList.contains("e-recordpluscollapse")||(i[s].style.display=e?"":"none")):i[s].style.display=e?"":"none"}expandAll(){this.expandCollapse(!0)}collapseAll(){this.expandCollapse(!1)}render(){this.l10n=this.serviceLocator.getService("localization"),this.renderGroupDropArea(),this.initDragAndDrop(),this.refreshToggleBtn()}renderGroupDropArea(){let e=this.parent.element.querySelector(".e-groupdroparea");e&&Object(n.hb)(e),this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}}),this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate"),this.updateGroupDropArea(),this.parent.element.insertBefore(this.element,this.parent.element.firstChild),this.groupSettings.showDropArea||(this.element.style.display="none")}updateGroupDropArea(e){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){let e=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=e,this.element.classList.remove("e-grouped")}else(this.element.innerHTML===this.l10n.getConstant("GroupDropArea")&&(1===this.groupSettings.columns.length||!this.isAppliedGroup&&!this.isAppliedUnGroup)||e)&&(this.element.innerHTML=""),this.element.classList.add("e-grouped")}initDragAndDrop(){this.initializeGHeaderDrop(),this.initializeGHeaderDrag()}initializeGHeaderDrag(){new n.i(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})}initializeGHeaderDrop(){new n.j(this.element,{accept:".e-dragclone",drop:this.drop})}groupColumn(e){let t=this.parent,i=t.getColumnByField(e);Object(n.X)(i)||!1===i.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(e)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):kt(t)?t.notify(z,{instance:this,handler:this.groupColumn,arg1:e}):(i.visible=t.groupSettings.showGroupedColumn,this.colName=e,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(e),this.updateGroupDropArea(),this.isAppliedGroup=!1)}ungroupColumn(e){let t=this.parent,i=this.parent.enableColumnVirtualization?this.parent.columns.filter(t=>t.field===e)[0]:t.getColumnByField(e);if(Object(n.X)(i)||!1===i.allowGrouping||this.groupSettings.columns.indexOf(e)<0)return;if(kt(t))return void t.notify(z,{instance:this,handler:this.ungroupColumn,arg1:e});if(i.visible=!0,Object(n.W)()&&t.isServerRendered){let e=[];e[0]=i,this.parent.notify("setvisibility",e)}this.colName=i.field;let s=JSON.parse(JSON.stringify(this.groupSettings.columns));if(s.splice(s.indexOf(this.colName),1),this.sortedColumns.indexOf(e)<0)for(let r=0,n=t.sortSettings.columns.length;r<n;r++)if(e===t.sortSettings.columns[r].field){t.sortSettings.columns.splice(r,1);break}Object(n.W)()&&this.parent.isServerRendered&&(t.sortSettings.columns=t.sortSettings.columns),this.groupSettings.allowReordering&&(this.reorderingColumns=s),this.groupSettings.columns=s,t.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}updateModel(){let e=JSON.parse(JSON.stringify(this.groupSettings.columns));e=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):e,this.sortRequired&&(-1===e.indexOf(this.colName)&&e.push(this.colName),this.groupAddSortingQuery(this.colName)),this.sortRequired=!0,this.parent.groupSettings.columns=e,this.parent.dataBind()}onActionComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),"grouping"===e.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);let t=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:y}:{requestType:"ungrouping",type:y};this.parent.trigger(y,Object(n.K)(e,t)),this.colName=null}groupAddSortingQuery(e){let t=0;for(;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[t].field!==e;)t++;if(this.parent.sortSettings.columns.length===t){this.parent.sortSettings.columns.push({field:e,direction:"Ascending",isFromGroup:!0});let t="isServerRendered";Object(n.W)()&&this.parent[t]&&(this.parent.sortSettings.columns=this.parent.sortSettings.columns)}else this.parent.allowSorting||(this.parent.sortSettings.columns[t].direction="Ascending")}createElement(e){let t=this.parent,i="Ascending",s=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),r=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),l=this.parent.createElement("div",{attrs:{"ej-mappingname":e}}),a=this.parent.getColumnByField(e),o=t.getColumnHeaderByUid(a.uid);return this.groupSettings.allowReordering&&l.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":"Drag the grouped column"}})),l.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:a.headerText,attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),this.groupSettings.showToggleButton&&l.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"ungroup button"}})),o.querySelectorAll(".e-ascending,.e-descending").length&&(i=o.querySelector(".e-ascending")?"Ascending":"Descending"),l.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+i.toLowerCase()+" e-icon-"+i.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),l.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:Object(n.W)()?this.l10n.getConstant("UnGroupButton"):this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":"ungroup the grouped column"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),r.appendChild(l),this.groupSettings.columns.indexOf(e),this.groupSettings.allowReordering&&(s.appendChild(r),s.appendChild(this.createSeparator()),r=s),r}addColToGroupDrop(e){if(this.groupSettings.allowReordering&&this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+e+"]"))return;let t=this.parent.getColumnByField(e);if(Object(n.X)(t))return;let i=this.createElement(e);if(this.groupSettings.allowReordering){let e=this.element.querySelectorAll(".e-group-animator").length;i.setAttribute("index",e.toString())}this.element.appendChild(i)}createSeparator(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"Separator for the grouped columns"},styles:this.groupSettings.showUngroupButton?"":"display:none"})}refreshToggleBtn(e){if(this.groupSettings.showToggleButton){let t=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv"));for(let i=0,s=t.length;i<s;i++)if(!t[i].classList.contains("e-emptycell")&&!t[i].classList.contains("e-headerchkcelldiv")){let s=this.parent.getColumnByUid(t[i].getAttribute("e-mappinguid"));(!this.parent.showColumnMenu||this.parent.showColumnMenu&&!s.showColumnMenu)&&(t[i].querySelectorAll(".e-grptogglebtn").length&&Object(n.hb)(t[i].querySelectorAll(".e-grptogglebtn")[0]),e||t[i].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(s.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":"Group button"}})))}}}removeColFromGroupDrop(e){if(!Object(n.X)(this.getGHeaderCell(e))){let t=this.getGHeaderCell(e);if(this.groupSettings.allowReordering){let e=mt(t,"e-group-animator");Object(n.hb)(e)}else Object(n.hb)(t);this.updateGroupDropArea()}this.isAppliedUnGroup=!1}onPropertyChanged(e){if(e.module===this.getModuleName())for(let t of Object.keys(e.properties))switch(t){case"columns":let i;if(this.contentRefresh){if(this.isAppliedUnGroup)i={columnName:this.colName,requestType:"ungrouping",type:f};else{if(!this.isAppliedGroup){this.updateGroupDropArea(!0);for(let e=0;e<this.parent.sortSettings.columns.length;e++)this.parent.sortSettings.columns[e].isFromGroup&&(this.parent.sortSettings.columns.splice(e,1),e--);for(let e=0;e<this.groupSettings.columns.length;e++)this.colName=this.groupSettings.columns[e],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),e<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[e])}i={columnName:this.colName,requestType:e.properties[t].length?"grouping":"ungrouping",type:f}}if(!this.groupSettings.showGroupedColumn){let i=e.oldProperties[t];for(let s=0;s<i.length;s++)-1===e.properties[t].indexOf(i[s])&&(this.parent.getColumnByField(i[s]).visible=!0)}let s="requestType";Object(n.W)()&&this.parent.isServerRendered&&this.parent.isCollapseStateEnabled()&&"grouping"===i[s]&&this.parent.refreshHeader(),this.parent.notify(D,i)}break;case"showDropArea":this.updateGroupDropArea(),this.element.style.display=this.groupSettings.showDropArea?"":"none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn),this.parent.notify(D,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton "),this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}updateGroupedColumn(e){for(let t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[t]).visible=e}updateButtonVisibility(e,t){let i=[].slice.call(this.element.querySelectorAll("."+t));for(let s=0;s<i.length;s++)i[s].style.display=e?"":"none"}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.render()}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.isDestroyed||this.parent.refreshing||this.clearGrouping(),this.removeEventListener(),this.refreshToggleBtn(!0),Object(n.hb)(this.element))}clearGrouping(){let e=JSON.parse(JSON.stringify(this.groupSettings.columns));this.contentRefresh=!1;for(let t=0,i=e.length;t<i;t++)t===i-1&&(this.contentRefresh=!0),this.ungroupColumn(e[t]);this.contentRefresh=!0}getModuleName(){return"group"}refreshSortIcons(e){let t,i=this.parent,s=i.sortSettings.columns,r=i.groupSettings.columns,l=this.parent.getColumns().map(e=>e.field);this.refreshToggleBtn();for(let a=0,o=s.length;a<o;a++)-1!==l.indexOf(s[a].field)&&(t=i.getColumnHeaderByField(s[a].field),!i.allowSorting&&(this.sortedColumns.indexOf(s[a].field)>-1||this.groupSettings.columns.indexOf(s[a].field)>-1)?(Object(n.A)(t.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),s.length>1&&t.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(a+1).toString()}))):this.getGHeaderCell(s[a].field)&&this.getGHeaderCell(s[a].field).querySelectorAll(".e-groupsort").length&&("Ascending"===s[a].direction?Object(n.A)(this.getGHeaderCell(s[a].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):Object(n.A)(this.getGHeaderCell(s[a].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(let n=0,a=r.length;n<a;n++)-1!==l.indexOf(r[n])&&i.getColumnHeaderByField(r[n]).setAttribute("aria-grouped","true")}getGHeaderCell(e){return this.element&&this.element.querySelector('[ej-mappingname="'+e+'"]')?this.element.querySelector('[ej-mappingname="'+e+'"]').parentElement:null}onGroupAggregates(e){let t=this.iterateGroupAggregates(e),i=this.groupGenerator.generateRows(t,{}),s=this.parent.getRowsObject().filter(e=>!e.isDataRow),r=i.filter(e=>!e.isDataRow);this.parent.isReact&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]);for(let n=0;n<r.length;n++){let e=r[n],t=e.cells.filter(e=>e.isDataCell);this.parent.notify("refresh-aggregate-cell",{cells:t,data:e.data,dataUid:s[n]?s[n].uid:""})}}iterateGroupAggregates(e){let t=e instanceof Array?e:[],i=this.parent.getRowsObject(),s=this.parent.getCurrentViewRecords(),r=[],n=i.map(e=>("delete"===e.edit&&r.push(e.data),e.changes instanceof Object?e.changes:e.data)),a=this.parent.getPrimaryKeyFieldNames()[0];n=0===t.length?n:t;let o=s.map(e=>{let t,i=l.b.getObject(a,e);return n.some(e=>(t=e,i===l.b.getObject(a,e)))?t:e});if((!e.type||"cancel"!==e.type)&&r.length>0)for(let l=0;l<r.length;l++){let e=o.indexOf(r[l]);o.splice(e,1)}let h,d,c=[],p=this.parent.aggregates;for(let l=0;l<p.length;l++){let e=p[l];for(let t=0;t<e.columns.length;t++){let i={};i={type:e.columns[t].type.toString().toLowerCase(),field:e.columns[t].field},c.push(i)}}let u=this.parent.groupSettings.columns;for(let g=0;g<u.length;g++)d=h||o,h=l.b.group(d,u[g],c,null,null);return h}updateExpand(e){let t=e.uid,i=e.isExpand,s=this.parent.getRowsObject();for(let r=0;r<s.length;r++){let e=s[r];if(e.uid===t||Object(n.X)(t)){e.isExpand=i;for(let i=r+1;i<s.length;i++){let r,l=s[i];if(l.parentUid!==e.uid&&(r=s.filter(e=>e.uid===l.parentUid)[0]),l.parentUid===e.uid?l.visible=e.isExpand:Object(n.X)(r)||l.parentUid!==r.uid||(r.isExpand&&!0===r.visible?l.visible=!0:r.isExpand&&!1===r.visible&&(l.visible=!1)),Object(n.X)(t))break}}}this.parent.notify(O,{rows:s,args:{isFrozen:!1,rows:s}})}}class Ji extends U{constructor(e,t){super(e,t),this.aggregates={},this.parent=e,this.locator=t,this.modelGenerator=new W(this.parent),this.addEventListener()}renderPanel(){let e=this.parent.createElement("div",{className:"e-gridfooter"}),t=this.parent.createElement("div",{className:"e-summarycontent"}),i=t;if(this.parent.isFrozenGrid()){let e=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-left-footercontent"}),s=this.parent.createElement("div",{className:"e-movablefootercontent"}),r=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-right-footercontent"});(this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&(t.appendChild(e),this.frozenContent=e),t.appendChild(s),this.movableContent=s,i=s,this.parent.getFrozenRightColumnsCount()&&(t.appendChild(r),this.frozenRightContent=r)}n.d.isDevice&&(i.style.overflowX="scroll"),e.appendChild(t),this.setPanel(e),null!=this.parent.getPager()?this.parent.element.insertBefore(e,this.parent.getPager()):this.parent.element.appendChild(e)}renderTable(){let e=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),t=this.createContentTable("_footer_table").querySelector(".e-table"),i=this.parent.createElement("tfoot");if(t.appendChild(i),this.parent.isFrozenGrid()){let i=t.cloneNode(!0),s=t.cloneNode(!0);if(e&&(this.frozenContent.appendChild(i),this.freezeTable=i),this.parent.getFrozenRightColumnsCount()){Object(n.hb)(s.querySelector("colgroup"));let e=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").cloneNode(!0);s.insertBefore(e,s.querySelector("tbody")),this.frozenRightContent.appendChild(s),this.frTable=s}this.movableContent.appendChild(t),Object(n.hb)(t.querySelector("colgroup"));let r=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);t.insertBefore(r,t.querySelector("tbody")),this.setColGroup(r)}this.setTable(t)}renderSummaryContent(e,t,i,s){let r=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData,l=this.modelGenerator.getData(),a=Object(n.X)(i)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(i,s),o=Object(n.X)(i)?this.modelGenerator.generateRows(r,e||this.aggregates):this.modelGenerator.generateRows(r,e||this.aggregates,i,s),h=document.createDocumentFragment(),d=new H(this.locator,null,this.parent);d.element=this.parent.createElement("TR",{className:"e-summaryrow"});for(let n=0,c=l.length;n<c;n++){let e=o[n];if(!e)continue;let t=d.render(e,a);h.appendChild(t)}t.tFoot.appendChild(h),this.aggregates=Object(n.X)(e)?this.aggregates:e}refresh(e){let t=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),i=this.parent.getMovableColumnsCount(),s=this.parent.getFrozenRightColumnsCount();if(this.parent.isFrozenGrid()&&(Object(n.hb)(this.getPanel()),this.renderPanel(),this.renderTable(),t&&(this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.freezeTable,0,t))),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(e,this.getTable(),t,s?t+i:void 0),this.parent.getFrozenRightColumnsCount()){this.frTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.frTable,t+i,t+i+s);let r=[].slice.call(this.getTable().querySelectorAll(".e-lastsummarycell"));if(r.length)for(let e=0;e<r.length;e++)r[e].style.borderRight="0px"}if(this.parent.isFrozenGrid()){let e,i=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").querySelectorAll(".e-summaryrow"));if(t){e=[].slice.call(this.parent.element.querySelector(".e-frozen-left-footercontent").querySelectorAll(".e-summaryrow")),this.refreshHeight(e,i);let t=this.frozenContent;t.offsetHeight||(t.style.height=this.getTable().offsetHeight+"px")}if(s){let t=[].slice.call(this.parent.element.querySelector(".e-frozen-right-footercontent").querySelectorAll(".e-summaryrow"));this.refreshHeight(t,i),e&&this.refreshHeight(t,e);let s=this.frTable;s.offsetHeight||(s.style.height=this.getTable().offsetHeight+"px")}this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable())}this.onScroll()}refreshHeight(e,t){for(let i=0;i<e.length;i++){let s=e[i].getBoundingClientRect().height,r=t[i].getBoundingClientRect().height;s<r?(e[i].classList.remove("e-hide"),e[i].style.height=r+"px"):s>r&&(t[i].classList.remove("e-hide"),t[i].style.height=s+"px")}}refreshCol(){let e,t=e=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?e=this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):(e=Ut(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector("colGroup")))),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)}onWidthChange(e){this.getColFromIndex(e.index).style.width=Object(n.L)(e.width),this.parent.allowResizing&&"resize"===e.module&&this.updateFooterTableWidth(this.getTable())}onScroll(e={left:this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent").scrollLeft:this.parent.getContent().firstChild.scrollLeft}){this.getTable().parentElement.scrollLeft=e.left}getColFromIndex(e){let t=this.parent.getFrozenColumns();return t=t&&this.parent.isRowDragable()?t+1:t,t&&t>e?this.freezeTable.querySelector("colGroup").children[e]:this.getColGroup().children[e-t]}columnVisibilityChanged(){this.refresh()}addEventListener(){this.parent.on("colgroup-refresh",this.refreshCol,this),this.parent.on("column-width-changed",this.onWidthChange,this),this.parent.on("scroll",this.onScroll,this),this.parent.on("column-visible-changed",this.columnVisibilityChanged,this),this.parent.on("refresh-footer-rendered",this.refreshFooterRenderer,this)}removeEventListener(){this.parent.off("colgroup-refresh",this.refreshCol),this.parent.off("column-width-changed",this.onWidthChange),this.parent.off("scroll",this.onScroll),this.parent.off("column-visible-changed",this.columnVisibilityChanged),this.parent.off("refresh-footer-rendered",this.refreshFooterRenderer)}updateFooterTableWidth(e){let t=this.parent.getHeaderTable();t&&e&&(e.style.width=t.style.width)}refreshFooterRenderer(e){let t=this.onAggregates(e);this.refresh(t)}getIndexByKey(e,t){let i=this.parent.getPrimaryKeyFieldNames()[0];for(let s=0;s<t.length;s++)if(t[s][i]===e[i])return s;return-1}onAggregates(e){e=e instanceof Array?e:[];let t=this.parent.getPrimaryKeyFieldNames()[0],i=[],s=!1,r={},n=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.dataSource.dataSource.json.length?this.parent.dataSource.dataSource.json:this.parent.getCurrentViewRecords();if(this.parent.editModule&&(r=this.parent.editModule.getBatchChanges()),Object.keys(r).length){for(let e=0;e<n.length;e++)s=!1,r.changedRecords.length&&this.getIndexByKey(n[e],r.changedRecords)>-1&&(s=!0,i.push(r.changedRecords[this.getIndexByKey(n[e],r.changedRecords)])),r.deletedRecords.length&&this.getIndexByKey(n[e],r.deletedRecords)>-1?s=!0:s||i.push(n[e]);if(r.addedRecords.length)for(let e=0;e<r.addedRecords.length;e++)i.push(r.addedRecords[e])}else i=e.length?at(n).map(i=>{let s,r=l.b.getObject(t,i);return e.some(e=>(s=e,r===l.b.getObject(t,e)))?s:i}):n;e.type&&"cancel"===e.type&&(i=n);let a,o={},h=this.parent.aggregates;for(let l=0;l<h.length;l++)for(let e=0;e<h[l].columns.length;e++){let t=[],s=h[l].columns[e].type.toString();t=i,a=jt(s,t,h[l].columns[e],this.parent),o[h[l].columns[e].field+" - "+s.toLowerCase()]=a}return{result:i,count:i.length,aggregates:o}}}class $i extends _{constructor(){super(...arguments),this.element=this.parent.createElement("TD",{className:"e-summarycell",attrs:{role:"gridcell",tabindex:"-1"}})}getValue(e,t,i){let s;return s=Object(n.X)(i.type)?i.columnName:i.field+" - "+("string"==typeof i.type?i.type.toLowerCase():""),t[i.columnName]?t[i.columnName][s]:""}evaluate(e,t,i,s){let r=t.column;if(this.parent.on("refresh-aggregate-cell",this.refreshWithAggregate(e,t),this),!(r.footerTemplate||r.groupFooterTemplate||r.groupCaptionTemplate))return!0;let l=r.getTemplate(t.cellType),a="",o=this.parent.getColumnByField(i[r.columnName].field);if(!Object(n.X)(o)&&(i[r.columnName].headerText=o.headerText,o.isForeignColumn())){let e=o.columnData.filter(e=>e[o.foreignKeyField]===i[r.columnName].key)[0];e&&(i[r.columnName].foreignKey=e[o.foreignKeyValue])}return Object(n.W)()&&(a=this.parent.element.id+r.guid+l.property),this.parent.isReact&&(r.footerTemplate?"string"!=typeof r.footerTemplate:r.groupFooterTemplate?"string"!=typeof r.groupFooterTemplate:r.groupCaptionTemplate&&"string"!=typeof r.groupCaptionTemplate)?(l.fn(i[r.columnName],this.parent,l.property,a,null,null,e),this.parent.renderTemplates()):Ot(e,l.fn(i[r.columnName],this.parent,l.property,a)),!1}refreshWithAggregate(e,t){let i=t;return t=>{let s=i.column.columnName?i.column.columnName:null,r=Object(n.X)(s)?null:t.cells.filter(e=>e.column.columnName===s)[0];e.parentElement&&e.parentElement.getAttribute("data-uid")===t.dataUid&&s&&s===r.column.columnName&&this.refreshTD(e,r,t.data)}}}class Zi{constructor(e,t,i){this.fromWheel=!1,this.touchMove=!1,this.options={},this.sentinelInfo={up:{check:(e,t)=>{let i=e.top-this.containerRect.top;return t.entered=i>=0,i+this.options.pageHeight/2>=0},axis:"Y"},down:{check:(e,t)=>{let i=e.bottom;return t.entered=e.bottom<=this.containerRect.bottom,i-this.options.pageHeight/2<=this.options.pageHeight/2},axis:"Y"},right:{check:(e,t)=>{let i=e.right;return this.movableEle?(t.entered=i<this.movableContainerRect.right,i-this.movableContainerRect.width<=this.movableContainerRect.right):(t.entered=i<this.containerRect.right,i-this.containerRect.width<=this.containerRect.right)},axis:"X"},left:{check:(e,t)=>{let i=e.left;return t.entered=i>0,this.movableEle?i+this.movableContainerRect.width>=this.movableContainerRect.left:i+this.containerRect.width>=this.containerRect.left},axis:"X"}},this.element=e,this.options=t,this.movableEle=i}observe(e,t){this.containerRect=this.options.container.getBoundingClientRect(),n.l.add(this.options.container,"wheel",()=>this.fromWheel=!0,this),n.l.add(this.options.container,"scroll",this.virtualScrollHandler(e,t),this),this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),n.l.add(this.options.scrollbar,"wheel",()=>this.fromWheel=!0,this),n.l.add(this.options.scrollbar,"scroll",this.virtualScrollHandler(e,t),this))}check(e){let t=this.sentinelInfo[e];return t.check(!this.movableContainerRect||"left"!==e&&"right"!==e?this.element.getBoundingClientRect():this.movableEle.getBoundingClientRect(),t)}virtualScrollHandler(e,t){let i="chrome"===n.d.info.name?200:100,s=Object(n.G)(e,i),r=Object(n.G)(e,50);return this.options.prevTop=this.options.prevLeft=0,e=>{let i=this.options.movableContainer?this.options.container.scrollTop:e.target.scrollTop,n=this.options.movableContainer?this.options.scrollbar.scrollLeft:e.target.scrollLeft,l=this.options.prevTop<i?"down":"up";l=this.options.prevLeft===n?l:this.options.prevLeft<n?"right":"left",this.options.prevTop=i,this.options.prevLeft=n;let a=this.sentinelInfo[l];if(-1===this.options.axes.indexOf(a.axis))return;let o=this.check(l);if(a.entered&&t(!this.movableEle||"right"!==l&&"left"!==l?this.element:this.movableEle,a,l,{top:i,left:n},this.fromWheel,o),o){let e=s;"X"===a.axis&&(e=r),e({direction:l,sentinel:a,offset:{top:i,left:n},focusElement:document.activeElement})}this.fromWheel=!1}}setPageHeight(e){this.options.pageHeight=e}}class es{constructor(e){this.cOffsets={},this.cache={},this.movableCache={},this.frozenRightCache={},this.rowCache={},this.data={},this.groups={},this.parent=e,this.model=this.parent.pageSettings,this.rowModelGenerator=this.parent.allowGrouping?new K(this.parent):new N(this.parent)}generateRows(e,t){let i=this.parent.isFrozenGrid(),s=t.virtualInfo=t.virtualInfo||this.getData(),r=s.sentinelInfo&&"X"===s.sentinelInfo.axis,l=[],a=this.getBlockIndexes(r||!s.loadNext||s.loadSelf?s.page:s.nextInfo.page),o=[];if((i&&2===this.parent.getTablesCount()&&!t.renderMovableContent||3===this.parent.getTablesCount()&&!t.renderMovableContent&&!t.renderFrozenRightContent||!i)&&this.checkAndResetCache(t.requestType),Yt(this.parent)&&this.parent.vcRows.length)return this.parent.vcRows;if(this.parent.enableColumnVirtualization)for(let n=0;n<s.blockIndexes.length;n++)if(this.isBlockAvailable(s.blockIndexes[n])&&(this.cache[s.blockIndexes[n]]=this.rowModelGenerator.refreshRows(this.cache[s.blockIndexes[n]])),t.renderMovableContent&&this.isMovableBlockAvailable(s.blockIndexes[n])||t.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(s.blockIndexes[n])){let e=t.renderMovableContent?this.movableCache:this.frozenRightCache;e[s.blockIndexes[n]]=this.rowModelGenerator.refreshRows(e[s.blockIndexes[n]])}if(Object(n.W)()&&this.parent.isServerRendered){let i="virtualStartIndex",s="startIndex",r="endIndex";if(t[i]||0!==Object.keys(this.rowCache).length){if(t[i]){let i=t[s],r=[];for(let e=0;e<Object.keys(this.rowCache).length;e++)r.push(Number(Object.keys(this.rowCache)[e]));for(let t=0;t<e.length;t++){let s=[],n=r.indexOf(i);s.push(e[t]),-1===n&&(this.rowCache[i]=this.rowModelGenerator.generateRows(s,{startIndex:i})[0]),i++}}}else{for(let i=0;i<e.length;i++){let t=[];t.push(e[i]),this.rowCache[i]=this.rowModelGenerator.generateRows(t,{startIndex:i})[0]}let t=0;for(let e=0;e<this.parent.pageSettings.pageSize;e++)l[t]=this.rowCache[e],t++}if(!Object(n.X)(t[i])){let e=0;for(let i=t[s];i<t[r];i++)l[e]=this.rowCache[i],e++}}else{let i=s.blockIndexes;for(let n=0;n<i.length;n++){if(!this.isBlockAvailable(i[n])){let t,r=this.rowModelGenerator.generateRows(e,{virtualInfo:s,startIndex:this.getStartIndex(i[n],e)});Yt(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=r,this.parent.vcRows=r),Yt(this.parent)?(t=this.model.pageSize/2,this.isBlockAvailable(a[0])||(this.cache[a[0]]=r.slice(0,t)),this.isBlockAvailable(a[1])||(this.cache[a[1]]=r.slice(t,this.model.pageSize))):(t=~~Math.max(r.length,this.model.pageSize)/2,this.isBlockAvailable(a[0])||(this.cache[a[0]]=r.slice(0,t)),this.isBlockAvailable(a[1])||(this.cache[a[1]]=r.slice(t)))}if(this.parent.groupSettings.columns.length&&!r&&this.cache[i[n]]&&(this.cache[i[n]]=this.updateGroupRow(this.cache[i[n]],i[n])),t.renderMovableContent&&!this.isMovableBlockAvailable(i[n])||t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(i[n])){let r=t.renderMovableContent?this.movableCache:this.frozenRightCache,l=this.rowModelGenerator.generateRows(e,{virtualInfo:s,startIndex:this.getStartIndex(i[n],e)}),o=~~Math.max(l.length,this.model.pageSize)/2;(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(a[0])||t.renderMovableContent&&!this.isMovableBlockAvailable(a[0]))&&(r[a[0]]=l.slice(0,o)),(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(a[1])||t.renderMovableContent&&!this.isMovableBlockAvailable(a[1]))&&(r[a[1]]=l.slice(o))}if(t.renderMovableContent||t.renderFrozenRightContent||!this.cache[i[n]]){let e=t.renderMovableContent?this.movableCache:this.frozenRightCache;e[i[n]]&&l.push(...e[i[n]])}else l.push(...this.cache[i[n]]);this.isBlockAvailable(i[n])&&o.push(i[n])}s.blockIndexes=o}if(!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered){let e="records";this.parent.allowGrouping?this.parent.currentViewData[e]=l.map(e=>e.data):i?(t.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||t.renderFrozenRightContent)&&(this.parent.currentViewData=l.map(e=>e.data)):this.parent.currentViewData=l.map(e=>e.data)}return l}getBlockIndexes(e){return[e+(e-1),2*e]}getPage(e){return e%2==0?e/2:(e+1)/2}isBlockAvailable(e){return e in this.cache}isMovableBlockAvailable(e){return e in this.movableCache}isFrozenRightBlockAvailable(e){return e in this.frozenRightCache}getData(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}}getStartIndex(e,t,i=!0){let s=(this.getPage(e)-1)*this.model.pageSize;return i||e%2!=0?s:s+~~(this.model.pageSize/2)}getColumnIndexes(e=this.parent.getHeaderContent().querySelector(".e-headercontent")){this.parent.isFrozenGrid()&&(e=e.querySelector(".e-movableheader"));let t=[],i=0|e.scrollLeft,s=Object.keys(this.cOffsets),r=e.getBoundingClientRect().width;i=Math.min(this.cOffsets[s.length-1]-r,i);let l=n.d.isDevice?2*r:r/2,a=i+r+(0===i?l:0);return s.some((e,s,r)=>{let n=Number(e),o=this.cOffsets[e];return i-l<=o&&a+l>=o&&t.push(n),a+l<o}),Object(n.W)()&&this.parent.isServerRendered&&(this.parent.contentModule.startColIndex=t[0],this.parent.contentModule.endColIndex=t[t.length-1]),this.addFrozenIndex(t),t}addFrozenIndex(e){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===e[0])for(let t=0;t<this.parent.getFrozenColumns();t++)e.push(e[e.length-1]+1)}checkAndResetCache(e){let t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"];this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===e&&t.splice(t.indexOf(e),1);let i=t.some(t=>e===t);return i&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),i}refreshColOffsets(){let e=0;this.cOffsets={};let t=this.parent.groupSettings.columns.length,i=this.parent.columns,s=i.length,r=e=>e.visible&&(this.parent.groupSettings.showGroupedColumn?e.visible:this.parent.groupSettings.columns.indexOf(e.field)<0),n=this.parent.groupSettings.columns;for(let a=0;a<n.length;a++)this.cOffsets[a]=30+(0|this.cOffsets[a-1]);let l=Array.apply(null,Array(s)).map(()=>e++);for(let a=0;a<l.length;a++)l[a]=l[a]+t,this.cOffsets[l[a]]=(0|this.cOffsets[l[a]-1])+(r(i[a])?parseInt(i[a].width,10):0)}updateGroupRow(e,t){let i=e[0],s=[],r=Object.keys(this.cache);for(let n=0;n<r.length;n++)Number(r[n])<t&&(s=[...s,...this.cache[r[n]]]);return i&&i.isDataRow||t%2==0?e:this.iterateGroup(e,s)}iterateGroup(e,t){let i=e[0],s=0;return i&&i.isDataRow||e.some(e=>t.some((t,i)=>{let r=t&&void 0!==t.data.field&&t.data.field===e.data.field&&t.data.key===e.data.key;return r&&(s=i),r}))&&(e.shift(),e=this.iterateGroup(e,t.slice(s))),e}getRows(){let e=[],t=!(!Object(n.W)()||!this.parent.isServerRendered),i=Object.keys(t?this.rowCache:this.cache);for(let s=0;s<i.length;s++)e=t?[...e,...this.rowCache[i[s]]]:[...e,...this.cache[i[s]]];return e}}class ts extends U{constructor(e,t){super(e,t),this.prevHeight=0,this.startIndex=0,this.preStartIndex=0,this.preventEvent=!1,this.actions=["filtering","searching","grouping","ungrouping"],this.offsets={},this.tmpOffsets={},this.virtualEle=new ss,this.offsetKeys=[],this.isFocused=!1,this.isSelection=!1,this.isBottom=!1,this.rndrCount=0,this.empty=void 0,this.isCancel=!1,this.requestTypes=["beginEdit","cancel","delete","add","save"],this.isNormaledit="Normal"===this.parent.editSettings.mode,this.virtualData={},this.emptyRowData={},this.vfColIndex=[],this.frzIdx=1,this.locator=t,this.eventListener("on"),this.parent.on("column-visible-changed",this.setVisible,this),this.vgenerator=this.generator}renderTable(){this.header=this.locator.getService("rendererFactory").getRenderer(L.Header),super.renderTable(),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.content=this.getPanel().querySelector(".e-content"),this.virtualEle.renderWrapper(this.parent.height),this.virtualEle.renderPlaceHolder(),this.virtualEle.wrapper.style.position="absolute";let e=this.parent.dataSource instanceof l.a&&!this.parent.dataSource.dataSource.offline,t={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:e,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new Zi(this.virtualEle.wrapper,t)}renderEmpty(e){this.getTable().appendChild(e),this.virtualEle.adjustTable(0,0)}scrollListener(e){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=e.offset),this.preventEvent||this.parent.isDestroyed)return void(this.preventEvent=!1);this.isFocused=!Object(n.X)(document.activeElement)&&(this.content===Object(n.C)(document.activeElement,".e-content")||this.content===document.activeElement);let t=e.sentinel,i=this.preStartIndex,s=this.parent.getColumnIndexesInView(),r=this.currentInfo=this.getInfoFromView(e.direction,t,e.offset);if(Object(n.W)()&&this.parent.isServerRendered&&this.parent.enableColumnVirtualization&&JSON.stringify(s)!==JSON.stringify(r.columnIndexes)){this.parent.refreshHeader();let e=this.getColumnOffset(this.startColIndex-1),t=this.getColumnOffset(this.endColIndex-1)-e+"";this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",startColumnIndex:r.columnIndexes[0],endColumnIndex:r.columnIndexes[r.columnIndexes.length-1],axis:"X",VTablewidth:t,translateX:this.getColumnOffset(r.columnIndexes[0]-1)}),this.parent.notify("setcolumnstyles",{})}return Yt(this.parent)&&!Object(n.W)()?"Y"===t.axis&&r.blockIndexes&&this.prevInfo.blockIndexes.toString()===r.blockIndexes.toString()&&"up"===e.direction&&2!==r.blockIndexes[r.blockIndexes.length-1]?void 0:(r.event="refresh-virtual-block",Object(n.X)(r.offsets)||(r.offsets.top=this.content.scrollTop),void this.parent.notify(r.event,{requestType:"virtualscroll",virtualInfo:r,focusElement:e.focusElement})):(!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered)&&this.prevInfo&&("Y"===t.axis&&this.prevInfo.blockIndexes.toString()===r.blockIndexes.toString()||"X"===t.axis&&this.prevInfo.columnIndexes.toString()===r.columnIndexes.toString())?(n.d.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,void this.restoreEdit()):(this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?r.columnIndexes:[]),!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered?this.parent.pageSettings.currentPage=r.loadNext&&!r.loadSelf?r.nextInfo.page:r.page:Object(n.W)()&&this.parent.isServerRendered&&this.preStartIndex!==i&&this.parent.pageSettings.currentPage===r.currentPage&&this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",virtualStartIndex:r.startIndex,virtualEndIndex:r.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}),void(!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered?(this.requestType="virtualscroll",this.parent.notify(r.event,{requestType:"virtualscroll",virtualInfo:r,focusElement:e.focusElement})):this.preStartIndex!==i&&this.parent.pageSettings.currentPage!==r.currentPage&&(this.parent.pageSettings.currentPage=r.currentPage,this.parent.notify(r.event,{requestType:"virtualscroll",virtualStartIndex:r.startIndex,virtualEndIndex:r.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}))))}block(e){return this.vgenerator.isBlockAvailable(e)}getInfoFromView(e,t,i){let s=!1,r=[],l={direction:e,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex},a=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;l.page=this.getPageFromTop(i.top,l),l.blockIndexes=r=this.vgenerator.getBlockIndexes(l.page),l.loadSelf=!this.vgenerator.isBlockAvailable(r[l.block]);let o=this.ensureBlocks(l);if("upArrow"===this.activeKey&&l.blockIndexes.toString()!==o.toString()&&-1===l.blockIndexes.indexOf(o[o.length-1])&&(s=!0),l.blockIndexes=o,l.loadNext=!o.filter(e=>-1===r.indexOf(e)).every(this.block.bind(this)),l.event=l.loadNext||l.loadSelf?D:"refresh-virtual-block",l.nextInfo=l.loadNext?{page:Math.max(1,l.page+("down"===e?1:-1))}:{},s&&(l.blockIndexes=[l.blockIndexes[0]-1,l.blockIndexes[0],l.blockIndexes[0]+1]),"downArrow"===this.activeKey){let e=Math.ceil(this.rowIndex/this.getBlockSize());1!==e&&(l.blockIndexes[1]!==e||l.blockIndexes.length<3)&&(l.blockIndexes=[e-1,e,e+1])}if(l.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(l.event="refresh-virtual-block"),Object(n.W)()&&this.parent.isServerRendered){let e=this.parent.getRowHeight(),t=i.top/e,s=a/e,r=t+s,o=this.parent.pageSettings.pageSize/4;if("down"===l.direction){let e=Math.round(r)-Math.round(o);if(Object(n.X)(l.startIndex)||r>l.startIndex+Math.round(this.parent.pageSettings.pageSize/2+o)&&l.endIndex!==this.count){l.startIndex=e>=0?Math.round(e):0,l.startIndex=l.startIndex>t?Math.floor(t):l.startIndex;let i=l.startIndex+this.parent.pageSettings.pageSize;l.startIndex=i<r?Math.ceil(r)-this.parent.pageSettings.pageSize:l.startIndex,l.endIndex=i<this.count?i:this.count,l.startIndex=i>=this.count?l.endIndex-this.parent.pageSettings.pageSize:l.startIndex,l.currentPage=Math.ceil(l.endIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex()}}else if("up"===l.direction&&l.startIndex&&l.endIndex&&t<Math.round((l.startIndex*e+o*e)/e)){let e=Math.round(t+(o>s?o:s+s/4));l.endIndex=e<this.count?e:this.count;let i=l.endIndex-this.parent.pageSettings.pageSize;l.startIndex=i>0?i:0,l.endIndex=i<0?this.parent.pageSettings.pageSize:l.endIndex,l.currentPage=Math.ceil(l.startIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex()}this.preStartIndex=this.startIndex=l.startIndex,this.preEndIndex=l.endIndex,l.event=l.currentPage!==this.parent.pageSettings.currentPage?D:"refresh-virtual-block"}return l}setKeyboardNavIndex(){this.blazorDataLoad=!0,"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())}ensureBlocks(e){let t,i=e.blockIndexes[e.block],s=i,r=Math.max,n="down"===e.direction?[r(i,1),++i,++i]:[r(i-1,1),i,i+1];return this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===e.sentinelInfo.axis||"Y"===e.sentinelInfo.axis&&e.page===this.prevInfo.page)&&(n=this.prevInfo.blockIndexes),n=n.filter((e,t)=>n.indexOf(e)===t),this.prevInfo.blockIndexes.toString()===n.toString()||((e.loadSelf||"down"===e.direction&&this.isEndBlock(s))&&(n=this.vgenerator.getBlockIndexes(e.page)),n.some((e,i)=>{let s=e===(Yt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks());return s&&(t=i),s}),void 0!==t&&(n=n.slice(0,t+1),0===e.block&&1===n.length&&this.vgenerator.isBlockAvailable(n[0]-1)&&(n=[n[0]-1,n[0]]))),n}appendContent(e,t,i){let s=this.parent.isFrozenGrid(),r=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),l=this.parent.enableColumnVirtualization&&s;this.checkFirstBlockColIndexes(i);let a=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo;this.prevInfo=this.prevInfo||i.virtualInfo;let o=a.columnIndexes[0]-1;l&&a.columnIndexes[0]===r&&(o=a.columnIndexes[0]-r-1);let h,d=this.getColumnOffset(o),c=a.blockIndexes;this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%");let p,u=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;if(!this.requestTypes.some(e=>e===this.requestType)){let e=this.getTranslateY(this.content.scrollTop,u,a);this.virtualEle.adjustTable(l?0:d,e),l&&this.virtualEle.adjustMovableTable(d,0)}if(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(l?0:d,0),l&&this.header.virtualEle.adjustMovableTable(d,0)),this.parent.enableColumnVirtualization){let e=a.columnIndexes;h=this.getColumnOffset(e[e.length-1])-this.getColumnOffset(e[0]-1)+"",l?this.header.virtualEle.setMovableWrapperWidth(h):this.header.virtualEle.setWrapperWidth(h)}if(l?this.virtualEle.setMovableWrapperWidth(h,n.d.isIE||"edge"===n.d.info.name):this.virtualEle.setWrapperWidth(h,n.d.isIE||"edge"===n.d.info.name),Object(n.X)(e.parentNode)||Object(n.hb)(e),s?i.renderFrozenRightContent?p=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("tbody"):i.renderMovableContent?i.renderMovableContent&&(p=this.parent.getMovableVirtualContent().querySelector("tbody")):p=this.parent.getFrozenVirtualContent().querySelector("tbody"):p=this.parent.element.querySelector(".e-content").querySelector("tbody"),p&&(Object(n.hb)(p),e=null),this.parent.isReact&&!Object(n.X)(this.parent.rowTemplate)?e=t:(e=this.parent.createElement("tbody")).appendChild(t),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(let n=0;n<this.parent.frozenRows;n++)e.children[0].remove();if(s?(i.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table").appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType):i.renderMovableContent?i.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(e),"Left-Right"!==this.parent.getFrozenMode()&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType)):this.parent.getFrozenVirtualContent().querySelector(".e-table").appendChild(e),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=a.columnIndexes=Object(n.K)([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length){if(!Yt(this.parent)&&"up"===a.direction){let e=this.offsets[this.getTotalBlocks()]-this.prevHeight;this.preventEvent=!0,this.content.scrollTop=this.content.scrollTop+e}this.setVirtualHeight(),this.observer.setPageHeight(this.getOffset(c[c.length-1])-this.getOffset(c[0]-1))}this.prevInfo=a,this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();let g=Math.ceil(this.getTotalBlocks()/2);this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===g&&1===c.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(k,{}),this.focusCell(i),this.restoreEdit(i),this.restoreAdd(i),this.initialRowTop||(this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top)}checkFirstBlockColIndexes(e){if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===e.virtualInfo.columnIndexes[0]){let t=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount();if(!e.renderMovableContent&&e.virtualInfo.columnIndexes.length>i){this.vfColIndex=e.virtualInfo.columnIndexes;for(let e=0;e<i;e++)t.push(e);e.virtualInfo.columnIndexes=t}else e.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=Object(n.K)([],e.virtualInfo.columnIndexes)),e.virtualInfo.columnIndexes=Object(n.K)([],this.vfColIndex),e.virtualInfo.columnIndexes.splice(0,i))}}focusCell(e){if("upArrow"!==this.activeKey&&"downArrow"!==this.activeKey)return;let t=this.parent.getRowByIndex(this.rowIndex);t.cells[this.cellIndex].focus({preventScroll:!0}),this.parent.selectRow(parseInt(t.getAttribute("aria-rowindex"),10)),this.activeKey=this.empty}restoreEdit(e){if(this.isNormaledit){let t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),s=this.parent.getFrozenMode(),r=e&&(t||"Left"===s||"Right"===s?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&r)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!Object(n.X)(this.editedRowIndex)){let e=this.getRowByIndex(this.editedRowIndex);if(Object.keys(this.virtualData).length&&e&&!this.content.querySelector(".e-editedrow")){let t=e.getBoundingClientRect().top;t<this.content.offsetHeight&&t>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(e))}if(e&&this.content.querySelector(".e-editedrow")&&!Object.keys(this.virtualData).length){let e=Object(n.K)({},this.getRowObjectByIndex(this.editedRowIndex));this.virtualData=this.getVirtualEditedData(e)}}this.restoreAdd(e)}}getVirtualEditedData(e){let t=[].slice.call(this.parent.element.querySelectorAll(".e-gridform")),i=this.parent.isFrozenGrid(),s=this.parent.editModule.getCurrentEditedData(t[0],e);return i&&(2===this.parent.getTablesCount()&&(s=this.parent.editModule.getCurrentEditedData(t[1],e)),3===this.parent.getTablesCount()&&(s=this.parent.editModule.getCurrentEditedData(t[1],e),s=this.parent.editModule.getCurrentEditedData(t[2],e))),s}restoreAdd(e){let t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),s=this.parent.getFrozenMode();if((!i||i&&e&&(t||"Left"===s||"Right"===s?e.renderMovableContent:e.renderFrozenRightContent))&&this.isNormaledit&&this.isAdd&&!this.parent.element.querySelector(".e-addedrow")){let e="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),t="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(e||t)&&(this.parent.isEdit=!1,this.parent.addRecord())}}onDataReady(e){Object(n.X)(e.count)||(this.count=e.count,this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(e.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some(t=>e.requestType===t)&&this.refreshOffsets(),this.setVirtualHeight(),this.resetScrollPosition(e.requestType)}setVirtualHeight(e){let t=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%";if(this.parent.isFrozenGrid()){let e=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2];e=e>this.content.clientHeight?e:0,this.virtualEle.setVirtualHeight(e,t)}else{let i=Object(n.W)()&&this.parent.isServerRendered&&this.parent.groupSettings.columns.length&&e?e:this.offsets[Yt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()];this.virtualEle.setVirtualHeight(i,t)}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,t),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,t),this.header.virtualEle.setMovableVirtualHeight(1,t)))}getPageFromTop(e,t){let i=Yt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),s=0;return this.offsetKeys.some(r=>{let n=Number(r),l=e<=this.offsets[r]||n===i&&e>this.offsets[r];return l&&(this.offsetKeys.length%2!=0&&n.toString()===this.offsetKeys[this.offsetKeys.length-2]&&e<=this.offsets[this.offsetKeys.length-1]&&(n+=1),t.block=n%2==0?1:0,s=Math.max(1,Math.min(this.vgenerator.getPage(n),this.maxPage))),l}),s}getTranslateY(e,t,i,s){void 0===i&&((i={page:this.getPageFromTop(e,{})}).blockIndexes=this.vgenerator.getBlockIndexes(i.page));let r=(i.blockIndexes[0]||1)-1,n=this.getOffset(r),l=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);s&&(i=this.prevInfo);let a=n>e?this.getOffset(r-1):l<e+t?this.getOffset(r+1):n,o=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]];return a+o>this.offsets[Yt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()]&&(a-=a+o-this.offsets[this.getTotalBlocks()]),a}getOffset(e){return Math.min(0|this.offsets[e],0|this.offsets[this.maxBlock])}onEntered(){return(e,t,i,s,r,l)=>{n.d.isIE&&!r&&l&&!this.preventEvent&&this.parent.showSpinner();let a=this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid(),o="X"===t.axis,h=this.prevInfo.offsets?this.prevInfo.offsets.top:null,d=this.content.getBoundingClientRect().height,c=this.getColumnOffset(o?this.vgenerator.getColumnIndexes()[0]-1:this.prevInfo.columnIndexes[0]-1),p=this.getTranslateY(s.top,d,o&&h===s.top?this.prevInfo:void 0,!0);Object(n.W)()&&this.parent.isServerRendered&&this.currentInfo&&this.currentInfo.startIndex&&o&&(p=this.currentInfo.startIndex*this.parent.getRowHeight()),this.virtualEle.adjustTable(a?0:c,Math.min(p,this.offsets[this.maxBlock])),a&&this.virtualEle.adjustMovableTable(c,0),Object(n.W)()&&this.parent.isServerRendered&&o&&this.parent.notify("setcolumnstyles",{refresh:!0}),this.parent.enableColumnVirtualization&&(!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered)&&(this.header.virtualEle.adjustTable(a?0:c,0),a&&this.header.virtualEle.adjustMovableTable(c,0))}}dataBound(){this.parent.notify("refresh-virtual-frozen-height",{}),this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):Object(n.W)()||(this.activeKey=this.empty)}rowSelected(e){if(this.isSelection&&!this.isLastBlockRow(e.rowIndex)){let t=function(e){let t=document.defaultView.getComputedStyle(e,null).getPropertyValue("transform").replace(/,/g,"");return{width:parseFloat(t.split(" ")[4]),height:parseFloat(t.split(" ")[5])}}(this.content.firstElementChild),i=e.row.getBoundingClientRect().top,s=this.content.getBoundingClientRect().height,r=s<i,n=r?i-s:this.initialRowTop-i;this.virtualEle.adjustTable(t.width,r?t.height-n:t.height+n)}this.isSelection=!1}isLastBlockRow(e){let t=this.parent.getContent().firstElementChild,i=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1;return e>=this.maxPage*this.parent.pageSettings.pageSize-i}eventListener(e){this.parent[e](S,this.onDataReady,this),this.parent.addEventListener(C,this.dataBound.bind(this)),this.parent.addEventListener(f,this.actionBegin.bind(this)),this.parent.addEventListener(y,this.actionComplete.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelected.bind(this)),this.parent[e]("refresh-virtual-block",this.refreshContentRows,this),this.parent[e]("select-virtual-Row",this.selectVirtualRow,this),this.parent[e]("virtaul-cell-focus",this.virtualCellFocus,this),this.parent[e]("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent[e]("virtual-scroll-add-action-begin",this.addActionBegin,this),this.parent[e]("virtual-scroll-edit",this.restoreEdit,this),this.parent[e]("virtual-scroll-edit-success",this.editSuccess,this),this.parent[e]("refresh-virtual-cache",this.refreshCache,this),this.parent[e]("edit-reset",this.resetIsedit,this),this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("virtual-scroll-edit-cancel",this.editCancel,this);let t=this.actions;for(let s=0;s<t.length;s++)this.parent[e](t[s]+"-begin",this.onActionBegin,this);let i=()=>{this.observer.observe(e=>this.scrollListener(e),this.onEntered());let e=this.parent;e.enablePersistence&&e.scrollPosition&&(this.content.scrollTop=e.scrollPosition.top,this.scrollListener({direction:"down",sentinel:this.observer.sentinelInfo.down,offset:e.scrollPosition,focusElement:e.element}),e.enableColumnVirtualization&&(this.content.scrollLeft=e.scrollPosition.left)),this.parent.off(O,i)};this.parent.on(O,i,this)}getVirtualData(e){e.virtualData=this.virtualData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}editCancel(e){let t=oi(this.parent,e.data);Object(n.X)(t)||(e.data=this.parent.getCurrentViewRecords()[t])}editSuccess(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewData(e.data),this.isAdd=!1)}updateCurrentViewData(e){let t=oi(this.parent,e);Object(n.X)(t)||(this.parent.getCurrentViewRecords()[t]=e)}actionBegin(e){"virtualscroll"!==e.requestType&&(this.requestType=e.requestType),e.cancel||this.parent.notify("refresh-virtual-frozenrows",e)}virtualCellFocus(e){let t=document.activeElement;if(t.classList.contains("e-rowcell")&&e&&("upArrow"===e.action||"downArrow"===e.action)){let i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);if(e&&("downArrow"===e.action||"upArrow"===e.action)){let s=this.parent.getContent().firstElementChild;"downArrow"===e.action?i+=1:i-=1,this.rowIndex=i,this.cellIndex=parseInt(t.getAttribute("aria-colindex"),10);let r=this.parent.getRowByIndex(i),l=this.parent.pageSettings.currentPage,a=Math.floor(s.offsetHeight/this.parent.getRowHeight())-1,o=!1;Object(n.X)(r)&&(o=!0,("downArrow"===e.action&&l===this.maxPage-1||"upArrow"===e.action&&1===l)&&(o=!1)),o||ni(r,this.parent)&&"downArrow"===e.action||li(r,2*this.parent.getRowHeight())&&"upArrow"===e.action?(this.activeKey=e.action,s.scrollTop="downArrow"===e.action?(i-a)*this.parent.getRowHeight():i*this.parent.getRowHeight()):this.activeKey=this.empty,(!Object(n.W)()||Object(n.W)()&&!this.blazorDataLoad)&&this.parent.selectRow(i)}}}editActionBegin(e){this.editedRowIndex=e.index;let t=Object(n.K)({},this.getRowObjectByIndex(e.index));e.data=Object.keys(this.virtualData).length?this.virtualData:t}refreshCache(e){let t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.vgenerator.cache[t][i].data=e,this.vgenerator.movableCache[t]&&(this.vgenerator.movableCache[t][i].data=e),this.vgenerator.frozenRightCache[t]&&(this.vgenerator.frozenRightCache[t][i].data=e)}actionComplete(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.refreshOffsets(),this.refreshVirtualElement(),this.isNormaledit&&("cancel"===e.requestType&&(this.isCancel=!0),this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule.previousVirtualData={})),this.parent.enableColumnVirtualization&&"filterafteropen"===e.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(e.columnName)}resetIsedit(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)}scrollAfterEdit(){if(this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")){let e=this.parent.element.querySelector(".e-editedrow"),t=this.parent.element.querySelector(".e-addedrow");if(e||t){let t=e?Object(n.K)({},this.getRowObjectByIndex(this.editedRowIndex)):Object(n.K)({},this.emptyRowData);this.virtualData=this.getVirtualEditedData(t)}}}createEmptyRowdata(){this.parent.getColumns().filter(e=>{this.emptyRowData[e.field]=this.empty})}addActionBegin(e){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.isAdd=!0;let t=this.parent.pageSettings.currentPage;t>1&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),e.startEdit=!1,this.content.scrollTop=0),t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),e.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}}getRowObjectByIndex(e){return this.getRowCollection(e,!1,!0)}getBlockSize(){return this.parent.pageSettings.pageSize>>1}getBlockHeight(){return this.getBlockSize()*this.parent.getRowHeight()}isEndBlock(e){let t=this.getTotalBlocks();return e>=t||e===t-1}getGroupedTotalBlocks(){let e=this.parent.vcRows;return Math.floor(e.length/this.getBlockSize()<1?1:e.length/this.getBlockSize())}getTotalBlocks(){return Math.ceil(this.count/this.getBlockSize())}getColumnOffset(e){return 0|this.vgenerator.cOffsets[e]}getModelGenerator(){return new es(this.parent)}resetScrollPosition(e){this.actions.some(t=>t===e)&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0),"virtualscroll"!==e&&(this.isAdd=!1)}onActionBegin(e){this.parent.setProperties({pageSettings:{currentPage:1}},!0)}getRows(){return this.vgenerator.getRows()}getRowByIndex(e){return Yt(this.parent)?this.parent.getDataRows()[e]:this.getRowCollection(e,!1)}getMovableVirtualRowByIndex(e){return this.getRowCollection(e,!0)}getFrozenRightVirtualRowByIndex(e){return this.getRowCollection(e,!1,!1,!0)}getRowCollection(e,t,i,s){let r=this.prevInfo.blockIndexes,l=!Object(n.W)()||Object(n.W)()&&!this.parent.isServerRendered?(r[0]-1)*this.getBlockSize():this.startIndex,a=t?this.parent.getMovableDataRows():this.parent.getDataRows();a=s?this.parent.getFrozenRightDataRows():a;let o=(i?this.parent.getCurrentViewRecords():a)[e-l];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(o=i?e<=this.parent.frozenRows?this.parent.getRowsObject()[e].data:o:e<=this.parent.frozenRows?a[e]:a[e-l+this.parent.frozenRows]),o}getVirtualRowIndex(e){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+e}refreshOffsets(){let e=this.parent,t=0,i=this.getBlockSize(),s=Yt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();this.prevHeight=this.offsets[s],this.maxBlock=s%2==0?s-2:s-1,this.offsets={};let r=Array.apply(null,Array(s)).map(()=>++t);for(let n=0;n<r.length;n++){let t=(this.vgenerator.cache[r[n]]||[]).length,l=Yt(this.parent)?e.vcRows.length%i:this.count%i,a=!Yt(this.parent)&&r[n]in this.vgenerator.cache?t*this.parent.getRowHeight():l&&r[n]===s?l*this.parent.getRowHeight():this.getBlockHeight();this.offsets[r[n]]=(0|this.offsets[r[n]-1])+a,this.tmpOffsets[r[n]]=0|this.offsets[r[n]-1]}this.offsetKeys=Object.keys(this.offsets),Yt(this.parent)&&(this.parent.vGroupOffsets=this.offsets),this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()}refreshVirtualElement(){this.vgenerator.refreshColOffsets(),this.setVirtualHeight()}setVisible(e){let t,i,s=this.parent,r=this.parent.getFrozenColumns();r&&(t=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),i=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col"))),Object(n.W)()&&s.isServerRendered&&this.parent.notify("setvisibility",e);let l,a=[];a=this.getRows(),a.some(e=>(e.isDataRow&&(l=e),e.isDataRow));let o=!0;!s.groupSettings.columns.length&&l&&(o=!1);let h=s.getDataRows();for(let d=0,c=e.length;d<c;d++){let c,p=e[d],u=s.getNormalizedColumnIndex(p.uid),g=!0===p.visible?"":"none";if(t&&i?u>=r?(c=i,h=this.parent.getMovableRows(),u-=r):c=t:c=this.getColGroup().children,-1!==u&&l&&u<l.cells.length&&Object(n.ob)(c[u],{display:g}),!o){let e;e=p.visible?this.virtualEle.wrapper.offsetWidth+parseInt(p.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(p.width.toString(),10),e>s.width?(this.setDisplayNone(h,u,g,a),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(e+""),this.refreshVirtualElement()):o=!0}!this.parent.invokedFromMedia&&p.hideAtMedia&&this.parent.updateMediaColumns(p),this.parent.invokedFromMedia=!1}if(Object(n.W)()&&this.parent.isServerRendered&&o){let e=this.parent.inViewIndexes,t=this.getColumnOffset(e[0]-1),i=this.getColumnOffset(e[e.length-1])-t+"";this.parent.notify("refresh-virtual-indices",{requestType:"virtualScrollRefresh",startColumnIndex:e[0],endColumnIndex:e[e.length-1],axis:"X",VTablewidth:i,translateX:t}),this.parent.notify("setcolumnstyles",{})}o||r?this.refreshContentRows({requestType:"refresh"}):this.parent.notify("partial-refresh",{rows:a,args:{isFrozen:!1,rows:a}})}selectVirtualRow(e){if("upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.requestTypes.some(e=>e===this.requestType)&&!this.parent.selectionModule.isInteracted){let t=this.parent.getRowByIndex(e.selectedIndex),i=this.parent.getRowHeight();if(!t||!this.isRowInView(t)){this.isSelection=!0,this.selectedRowIndex=e.selectedIndex;let t=(e.selectedIndex+1)*i;Object(n.X)(t)||(this.content.scrollTop=t)}}this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty}isRowInView(e){let t=e.getBoundingClientRect().top;return t>=this.initialRowTop&&t<=this.content.offsetHeight}}class is extends Y{constructor(e,t){super(e,t),this.virtualEle=new ss,this.isMovable=!1,this.gen=new es(this.parent),this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("refresh-virtual-block",e=>"X"===e.virtualInfo.sentinelInfo.axis?this.refreshUI():null,this)}renderTable(){this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),Object(n.W)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{startColumnIndex:this.parent.contentModule.startColIndex,endColumnIndex:this.parent.contentModule.endColIndex,axis:"X"}),super.renderTable(),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.getPanel().querySelector(".e-headercontent"),this.virtualEle.content.style.position="relative",this.virtualEle.renderWrapper(),this.virtualEle.renderPlaceHolder("absolute")}appendContent(e){this.isMovable?(this.virtualEle.movableWrapper.appendChild(e),this.isMovable=!1):this.virtualEle.wrapper.appendChild(e)}refreshUI(){this.isMovable=this.parent.isFrozenGrid(),this.setFrozenTable(this.parent.getMovableVirtualContent()),this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),super.refreshUI(),this.setFrozenTable(this.parent.getFrozenVirtualContent())}setVisible(e){let t,i,s,r,l,a=this.parent,o=this.parent.getFrozenColumns();o&&(r=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),l=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col")));for(let h=0,d=e.length;h<d;h++){let d,c=e[h];if(i=a.getNormalizedColumnIndex(c.uid),t=c.visible?"":"none",r&&l?i>=o?(d=l,i-=o):d=r:d=this.getColGroup().children,Object(n.ob)(d[i],{display:t}),a.enableColumnVirtualization&&!a.groupSettings.columns.length){let e;e=c.visible?this.virtualEle.wrapper.offsetWidth+parseInt(c.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(c.width.toString(),10),e>a.width?(this.setDisplayNone(c,t),this.virtualEle.setWrapperWidth(e+""),this.gen.refreshColOffsets()):s=!0}else s=!0;s&&!o&&this.refreshUI()}o&&this.parent.notify("column-position-changed",{})}setFrozenTable(e){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(e.querySelector(".e-table"))}setDisplayNone(e,t){let i=this.parent.isFrozenGrid(),s=this.getTable();i&&"movable"===e.getFreezeTableName()&&(s=this.parent.getMovableVirtualHeader().querySelector(".e-table"));for(let r of[].slice.apply(s.querySelectorAll("th.e-headercell")))if(r.querySelector("[e-mappinguid]")&&r.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===e.uid){Object(n.ob)(r,{display:t}),""===t&&Object(n.ib)([r],"e-hide");break}}}class ss{renderWrapper(e){Object(n.W)()?(this.wrapper=this.content.querySelector(".e-virtualtable")?this.content.querySelector(".e-virtualtable"):Object(n.F)("div",{className:"e-virtualtable"}),this.wrapper.setAttribute("styles","min-height:"+Object(n.L)(e))):this.wrapper=Object(n.F)("div",{className:"e-virtualtable",styles:"min-height:"+Object(n.L)(e)}),this.wrapper.appendChild(this.table),this.content.appendChild(this.wrapper)}renderPlaceHolder(e="relative"){Object(n.W)()?(this.placeholder=this.content.querySelector(".e-virtualtrack")?this.content.querySelector(".e-virtualtrack"):Object(n.F)("div",{className:"e-virtualtrack"}),this.placeholder.setAttribute("styles","position:"+e)):this.placeholder=Object(n.F)("div",{className:"e-virtualtrack",styles:"position:"+e}),this.content.appendChild(this.placeholder)}renderFrozenWrapper(e){this.wrapper=Object(n.F)("div",{className:"e-virtualtable",styles:`min-height:${Object(n.L)(e)}; display: flex`}),this.content.appendChild(this.wrapper)}renderFrozenPlaceHolder(){this.placeholder=Object(n.F)("div",{className:"e-virtualtrack"}),this.content.appendChild(this.placeholder)}renderMovableWrapper(e){this.movableWrapper=Object(n.F)("div",{className:"e-virtualtable",styles:"min-height:"+Object(n.L)(e)}),this.movableContent.appendChild(this.movableWrapper)}renderMovablePlaceHolder(){this.movablePlaceholder=Object(n.F)("div",{className:"e-virtualtrack"}),this.movableContent.appendChild(this.movablePlaceholder)}adjustTable(e,t){this.wrapper.style.transform=`translate(${e}px, ${t}px)`}adjustMovableTable(e,t){this.movableWrapper.style.transform=`translate(${e}px, ${t}px)`}setMovableWrapperWidth(e,t){this.movableWrapper.style.width=e?e+"px":t?"100%":""}setMovableVirtualHeight(e,t){this.movablePlaceholder.style.height=e+"px",this.movablePlaceholder.style.width=t}setWrapperWidth(e,t){this.wrapper.style.width=e?e+"px":t?"100%":""}setVirtualHeight(e,t){this.placeholder.style.height=e+"px",this.placeholder.style.width=t}setFreezeWrapperWidth(e,t,i){e.style.width=t?t+"px":i?"100%":""}}class rs{constructor(e){this.parent=e}addNew(e,t){let i;this.isEdit=!1;let s=xi(this.parent),r=ji(this.parent);if(i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderTable().querySelector("tbody"):this.parent.getContentTable().querySelector("tbody"),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),i.querySelector(".e-emptyrow")){let e=i.querySelector(".e-emptyrow");if(e.parentNode.removeChild(e),this.parent.isFrozenGrid()){let e=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody");if(e.firstElementChild.parentNode.removeChild(e.firstElementChild),"Left-Right"===this.parent.getFrozenMode()){let e=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");e.firstElementChild.parentNode.removeChild(e.firstElementChild)}}}if("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(e,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),this.parent.isFrozenGrid()){let e=this.renderMovableform(t.row,t);if("Top"===this.parent.editSettings.newRowPosition?s.insertBefore(e,s.firstChild):s.appendChild(e),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),e.setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),r){let e=this.renderFrozenRightForm(t.row,t);"Top"===this.parent.editSettings.newRowPosition?r.insertBefore(e,r.firstChild):r.appendChild(e);let i=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount();t.row.querySelector(".e-normaledit").setAttribute("colspan",i+""),e.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())}"auto"===this.parent.height&&this.parent.notify("frozenHeight",{})}}renderFrozenRightForm(e,t){let i=e.cloneNode(!0),s=t.frozenRightForm=i.querySelector("form");return this.parent.editSettings.template?(s.innerHTML="",this.appendChildren(s,t.rowData,!1),i):(this.renderRightFrozen(e,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").innerHTML,i)}renderMovableform(e,t){let i=e.cloneNode(!0),s=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(s.innerHTML="",this.appendChildren(s,t.rowData,!1),i):(this.renderMovable(e,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,i)}updateFreezeEdit(e,t){return t=t.concat([].slice.call(this.getFreezeRow(e).querySelectorAll("td.e-rowcell"))),"Left-Right"===this.parent.getFrozenMode()&&(t=t.concat([].slice.call(this.getFreezeRightRow(e).querySelectorAll("td.e-rowcell")))),t}getFreezeRightRow(e){let t=parseInt(e.getAttribute("aria-rowindex"),10),i=this.parent.getFrozenLeftContentTbody(),s=this.parent.getFrozenHeaderTbody(),r=this.parent.getFrozenRightHeaderTbody(),n=this.parent.getFrozenRightContentTbody();return i.contains(e)||s.contains(e)?this.parent.getFrozenRightRowByIndex(t):n.contains(e)||r.contains(e)?this.parent.getRowByIndex(t):e}getFreezeRow(e){if(this.parent.isFrozenGrid()){let t=parseInt(e.getAttribute("aria-rowindex"),10),i=this.parent.getFrozenLeftContentTbody(),s=this.parent.getMovableContentTbody(),r=this.parent.getFrozenHeaderTbody(),n=this.parent.getMovableHeaderTbody();if(i.contains(e)||r.contains(e))return this.parent.getMovableRowByIndex(t);if(s.contains(e)||n.contains(e))return this.parent.getRowByIndex(t)}return e}update(e,t){if(this.isEdit=!0,(Object(n.C)(t.row,".e-movablecontent")||Object(n.C)(t.row,".e-movableheader"))&&(t.row=this.getFreezeRow(t.row),Object(n.W)()&&this.parent.isServerRendered&&(t.cloneRow=t.row.cloneNode(!0))),(Object(n.C)(t.row,".e-frozen-right-content")||Object(n.C)(t.row,".e-frozen-right-header"))&&(t.row=this.getFreezeRightRow(t.row)),Object(n.W)()&&this.parent.isServerRendered){t.row.parentNode.insertBefore(t.cloneRow,t.row),t.row.classList.add("e-hiddenrow");let i=[].slice.call(t.cloneRow.querySelectorAll("td.e-rowcell"));t.cloneRow.innerHTML="",i=this.updateFreezeEdit(t.cloneRow,i),t.cloneRow.appendChild(this.getEditElement(e,!0,i,t,!0)),t.cloneRow.classList.add("e-editedrow"),this.refreshFreezeEdit(t.cloneRow,t)}else{let i=[].slice.call(t.row.querySelectorAll("td.e-rowcell"));t.row.innerHTML="",i=this.updateFreezeEdit(t.row,i),t.row.appendChild(this.getEditElement(e,!0,i,t,!0)),t.row.classList.add("e-editedrow"),this.parent.editModule.checkLastRow(t.row,t),this.refreshFreezeEdit(t.row,t)}}refreshFreezeEdit(e,t){let i,s,r=e.firstChild;this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(r.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("colgroup").innerHTML);let l=parseInt(e.getAttribute("aria-rowindex"),10);if(this.parent.isFrozenGrid()){l<this.parent.frozenRows?(s=this.parent.getHeaderContent(),i=".e-frozenheader"):(s=this.parent.getContent(),i=".e-frozencontent");let a,o,h=r.cloneNode(!0),d=r.cloneNode(!0),c=t.movableForm=h.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(c,t.rowData),s.querySelector(i).contains(e)?(a=this.parent.getMovableRowByIndex(l),Object(n.W)()&&this.parent.isServerRendered?(t.frozen=a,t.cloneFrozen=a.cloneNode(!0),a.classList.add("e-hiddenrow"),a.parentNode.insertBefore(t.cloneFrozen,a),this.updateFrozenCont(t.cloneFrozen,r,h)):(this.updateFrozenCont(a,r,h),"Left-Right"===this.parent.getFrozenMode()&&(t.frozenRightForm=d.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),o=this.parent.getFrozenRightRowByIndex(l),this.updateFrozenRightCont(o,r,d)))):(a=this.parent.getRowByIndex(l),Object(n.W)()&&this.parent.isServerRendered?(t.frozen=a,t.cloneFrozen=a.cloneNode(!0),a.parentNode.insertBefore(t.cloneFrozen,a),a.classList.add("e-hiddenrow"),this.updateFrozenCont(t.cloneFrozen,h,r)):(this.updateFrozenCont(a,h,r),"Left-Right"===this.parent.getFrozenMode()&&(t.frozenRightForm=d.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),o=this.parent.getFrozenRightRowByIndex(l),this.updateFrozenRightCont(o,d,r)))),Object(n.W)()&&this.parent.isServerRendered?(t.cloneFrozen.appendChild(h),t.cloneFrozen.classList.add("e-editedrow")):(a.appendChild(h),a.classList.add("e-editedrow"),"Left-Right"===this.parent.getFrozenMode()&&(o.appendChild(d),o.classList.add("e-editedrow"),ri(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)")))),ri(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}}refreshEditForm(e,t){this.parent.editSettings.template&&(e.innerHTML="",this.appendChildren(e,t,!1))}updateFrozenRightCont(e,t,i){e.innerHTML="",this.renderRightFrozen(t,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+""),i.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")}updateFrozenCont(e,t,i){e.innerHTML="",this.renderMovable(t,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),i.setAttribute("colspan",this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns()+"")}renderRightFrozen(e,t){t.querySelector("tr").innerHTML="";let i=this.parent.getColumns(),s=0;for(let r=0;r<i.length;r++,s++)if("frozen-right"===i[r].getFreezeTableName()){let i=s-this.parent.getMovableColumnsCount();t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[i])),s--}}renderMovable(e,t){t.querySelector("tr").innerHTML="";let i=this.parent.getColumns(),s=0;for(let r=0;r<i.length;r++,s++)"movable"===i[r].getFreezeTableName()&&(t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[s])),s--)}getEditElement(e,t,i,s,r){let l=this.parent,a=0,o=Object(n.X)(l.detailTemplate)&&Object(n.X)(l.childGrid)?0:1;l.allowGrouping&&(a=l.groupSettings.columns.length);let h=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(l.getVisibleColumns().length-l.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),d=s.form=this.parent.createElement("form",{id:l.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(d,s.rowData,r),h.appendChild(d),h;let c=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25"}});c.appendChild(l.getContentTable().querySelector("colgroup").cloneNode(!0));let p=this.parent.createElement("tbody"),u=this.parent.createElement("tr"),g=0;for(o&&u.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),u.firstChild),l.isRowDragable()&&u.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));g<a;)u.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),g++;let m=0;for(g=0;t&&m<i.length&&g<l.getColumns().length||g<l.getColumns().length;){let s=t?i[m].getAttribute("colspan"):null,r=l.getColumns()[g],a=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(r.textAlign?r.textAlign:""),colspan:s||""}});r.visible?(a.appendChild(e[r.uid]),"booleanedit"===r.editType?a.classList.add("e-boolcell"):(r.commands||r.commandsTemplate)&&Object(n.v)([a],"e-unboundcell")):a.classList.add("e-hide"),u.appendChild(a),g=s?g+parseInt(s,10):g+1,m++}return p.appendChild(u),c.appendChild(p),d.appendChild(c),h.appendChild(d),h}removeEventListener(){}appendChildren(e,t,i){let s=Object(n.K)({},t,{isAdd:!this.isEdit,isFrozen:i},!0),r=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(s,this.parent,"editSettingsTemplate",r,null,null,e),this.parent.renderTemplates()):Ot(e,this.parent.getEditTemplate()(s,this.parent,"editSettingsTemplate",r)),Object(n.sb)(r,"Template",this.parent.editSettings,!0,()=>{let e=this.parent.getColumns();for(let t=0;t<e.length;t++)e[t].validationRules&&(this.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)})}}class ns{constructor(e){this.parent=e}update(e,t){if(Object(n.W)()&&this.parent.isServerRendered){let i="cloneCell";t[i].innerHTML="",t[i].appendChild(this.getEditElement(e,t)),t[i].classList.remove("e-ellipsistooltip"),t[i].classList.add("e-editedbatchcell"),Object(n.A)(t.row,["e-editedrow","e-batchrow"],[])}else t.cell.innerHTML="",t.cell.appendChild(this.getEditElement(e,t)),t.cell.classList.remove("e-ellipsistooltip"),t.cell.classList.add("e-editedbatchcell"),Object(n.A)(t.row,["e-editedrow","e-batchrow"],[])}getEditElement(e,t){let i=this.parent.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-gridform"});return i.appendChild(e[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),i}removeEventListener(){}}class ls{constructor(e,t){this.parent=e,this.serviceLocator=t,this.parent.isDestroyed||(this.parent.on("dialog-destroy",this.destroy,this),this.parent.on(F,this.destroy,this))}setLocaleObj(){this.l10n=this.serviceLocator.getService("localization")}addNew(e,t){this.isEdit=!1,this.createDialog(e,t)}update(e,t){this.isEdit=!0,this.createDialog(e,t)}createDialog(e,t){let i=this.parent;this.dialog=this.parent.createElement("div",{id:i.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),this.dialog.setAttribute("aria-label","Dialog edit"),i.element.appendChild(this.dialog),this.setLocaleObj(),this.dialogObj=new a.a(Object(n.K)({header:i.editSettings.headerTemplate?this.getDialogEditTemplateElement("HeaderTemplate",t):this.isEdit?this.l10n.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle"),isModal:!0,visible:!0,cssClass:"e-edit-dialog",content:this.getEditElement(e,t),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),closeOnEscape:!0,width:i.editSettings.template?"auto":"330px",target:t.target?t.target:document.body,animationSettings:{effect:"None"},footerTemplate:i.editSettings.footerTemplate?this.getDialogEditTemplateElement("FooterTemplate",t):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},i.editSettings.dialog&&i.editSettings.dialog.params||{})),Object(n.W)()?this.dialogObj.locale=this.parent.locale:t.dialog=this.dialogObj,this.dialogObj.isStringTemplate=!0,this.dialogObj.appendTo(this.dialog),si(this.parent.element,this.dialogObj.element.parentElement)}btnClick(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()}dialogClose(){this.parent.closeEdit()}destroy(e){let t=["template","headerTemplate","footerTemplate"];for(let i=0;i<t.length;i++)if(this.parent.editSettings[t[i]]){let e=t[i].charAt(0).toUpperCase()+t[i].slice(1),s=this.parent.element.id+"editSettings"+e;Object(n.sb)(s,e,this.parent.editSettings)}this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.parent.notify(T,{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),Object(n.hb)(this.dialog))}getDialogEditTemplateElement(e,t){let i=this.parent.createElement("div",{className:"e-dialog"+e}),s=Object(n.K)({},t.rowData,{isAdd:!this.isEdit},!0),r=this.parent.element.id+"editSettings"+e;return Ot(i,("HeaderTemplate"===e?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(s,this.parent,"editSettings"+e,r)),Object(n.sb)(r,e,this.parent.editSettings),i}getEditElement(e,t){let i=this.parent,s=this.parent.createElement("div",{className:this.isEdit?"e-editedrow":"e-insertedrow"}),r=t.form=this.parent.createElement("form",{id:i.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){let e=this.parent.element.id+"editSettingsTemplate",i=Object(n.K)({},t.rowData,{isAdd:!this.isEdit},!0);this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(i,this.parent,"editSettingsTemplate",e,null,null,r),this.parent.renderTemplates()):Ot(r,this.parent.getEditTemplate()(i,this.parent,"editSettingsTemplate",e));let l=()=>{let e=this.parent.getColumns();for(let t=0;t<e.length;t++)e[t].validationRules&&(this.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)};return Object(n.sb)(e,"Template",this.parent.editSettings,!0,l),s.appendChild(r),s}let l=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"6px"}}),a=this.parent.createElement("tbody"),o=i.getColumns();for(let n=0;n<o.length;n++){if(this.parent.editModule.checkColumnIsGrouped(o[n])||o[n].commands||o[n].commandsTemplate||"checkbox"===o[n].type)continue;let t=this.parent.createElement("tr"),i=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});this.parent.createElement("label",{innerHTML:o[n].field}),e[o[n].uid].classList.remove("e-input"),i.appendChild(e[o[n].uid]),t.appendChild(i),a.appendChild(t)}return l.appendChild(a),r.appendChild(l),s.appendChild(r),s}removeEventListener(){this.parent.isDestroyed||(this.parent.off("dialog-destroy",this.destroy),this.parent.off(F,this.destroy))}}class as{constructor(e,t){this.editType={Inline:rs,Normal:rs,Batch:ns,Dialog:ls},this.parent=e,this.serviceLocator=t,this.renderer=new this.editType[this.parent.editSettings.mode](e,t),this.focus=t.getService("focus")}addNew(e){this.renderer.addNew(this.getEditElements(e),e),this.convertWidget(e)}update(e){this.renderer.update(this.getEditElements(e),e),this.parent.notify("edit-form",e),this.convertWidget(e)}convertWidget(e){let t,i,s,r,l,a=this.parent,o=a.isFrozenGrid(),h="Right"===a.getFrozenMode()&&"Normal"===a.editSettings.mode?1:0,d="Dialog"===a.editSettings.mode?Object(n.lb)("#"+a.element.id+"_dialogEdit_wrapper .e-gridform",document):a.element.querySelectorAll(".e-gridform")[h];if(o&&"Normal"===a.editSettings.mode){let t=parseInt(e.row.getAttribute("aria-rowindex"),10);a.frozenRows&&("add"===e.requestType&&"Top"===a.editSettings.newRowPosition||t<a.frozenRows)?(r=a.element.querySelector(".e-movableheader").querySelector(".e-gridform"),"Left-Right"===this.parent.getFrozenMode()&&(l=e.frozenRightForm)):(r=a.element.querySelector(".e-movablecontent").querySelector(".e-gridform"),"Left-Right"===this.parent.getFrozenMode()&&(l=e.frozenRightForm))}let c="Batch"!==a.editSettings.mode?a.getColumns():[a.getColumnByField(e.columnName)];for(let p of c){if(this.parent.editSettings.template&&!Object(n.X)(p.field)){let t=Object(n.K)({},e);t.element=d.querySelector("[name="+Mt(p.field)+"]"),Object(n.X)(t.element)&&o&&(t.element=r.querySelector("[name="+Mt(p.field)+"]")),"string"==typeof p.edit.write?_t(p.edit.write,window)(t):p.edit.write(t);continue}if(this.parent.editModule.checkColumnIsGrouped(p)||p.commands)continue;s=p.valueAccessor(p.field,e.rowData,p),i="movable"===p.getFreezeTableName()&&"Normal"===a.editSettings.mode?r.querySelector("[e-mappinguid="+p.uid+"]"):l&&"frozen-right"===p.getFreezeTableName()&&"Normal"===a.editSettings.mode?l.querySelector("[e-mappinguid="+p.uid+"]"):d.querySelector("[e-mappinguid="+p.uid+"]");let h=p.edit.write;Object(n.X)(i)||("string"==typeof h?(h=_t(h,window),h({rowData:e.rowData,element:i,column:p,requestType:e.requestType,row:e.row,foreignKeyData:p.isForeignColumn()&&_t(p.field,e.foreignKeyData)})):p.edit.write({rowData:e.rowData,element:i,column:p,requestType:e.requestType,row:e.row,foreignKeyData:p.isForeignColumn()&&_t(p.field,e.foreignKeyData)}),t||i.getAttribute("disabled")||(this.focusElement(i,e.type),t=!0))}if(o&&!this.parent.allowTextWrap&&("add"===e.requestType||"beginEdit"===e.requestType)&&"Dialog"!==this.parent.editSettings.mode&&!Object(n.X)(d)&&!Object(n.X)(r)){let e=r.querySelector("tr").children[0],t=d.querySelector("tr").children[0];t.offsetHeight>e.offsetHeight?(e.style.height=t.offsetHeight+"px",l&&(r.querySelector("tr").children[0].style.height=t.offsetHeight+"px")):(t.style.height=e.offsetHeight+"px",l&&(r.querySelector("tr").children[0].style.height=e.offsetHeight+"px"))}}focusElement(e,t){let i=this.parent.element.querySelector(".e-edit-checkselect");Object(n.X)(i)||i.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode?this.focus.onClick({target:Object(n.C)(e,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&mt(e,"e-addedrow")?e.focus():e.focus({preventScroll:!0}),e.classList.contains("e-defaultcell")&&e.setSelectionRange(e.value.length,e.value.length)}getEditElements(e){let t=this.parent,i={},s="Batch"!==t.editSettings.mode?t.getColumns():[t.getColumnByField(e.columnName)];if(this.parent.editSettings.template)return{};for(let r=0,l=s.length;r<l;r++){let l=s[r];if(this.parent.editModule.checkColumnIsGrouped(l))continue;if(l.commands||l.commandsTemplate){let t,s=this.serviceLocator.getService("cellRendererFactory"),n=new N(this.parent),a=s.getCellRenderer(A.CommandColumn);t=n.generateRows(e.rowData)[0].cells;let o=t.filter(e=>e.rowID),h=a.render(o[r],e.rowData,{index:e.row?e.row.getAttribute("aria-rowindex"):0}),d=h.firstElementChild;d.setAttribute("textAlign",h.getAttribute("textAlign")),i[l.uid]=d;continue}let a,o=l.valueAccessor(l.field,e.rowData,l),h={column:l,value:o,type:e.requestType,data:e.rowData},d=l.edit.create;if(l.editTemplate){a=this.parent.createElement("span",{attrs:{"e-mappinguid":l.uid}});let t=this.parent.element.id+l.uid+"editTemplate",i=$t({},e.rowData,{column:l});if(this.parent.isReact&&"string"!=typeof l.editTemplate?(l.getEditTemplate()(Object(n.K)({index:e.rowIndex},i),this.parent,"editTemplate",t,null,null,a),this.parent.renderTemplates()):Ot(a,l.getEditTemplate()(Object(n.K)({index:e.rowIndex},i),this.parent,"editTemplate",t)),Object(n.W)()){let e=e=>{let t=e;return()=>{this.parent.editModule.formObj.rules[t.field]=t.validationRules}};Object(n.sb)(t,"EditTemplate",l,!0,e(l))}}else{if("string"==typeof d?(d=_t(d,window),a=d(h)):a=l.edit.create(h),"string"==typeof a){let e=this.parent.createElement("div");e.innerHTML=a,a=e.firstChild}let i="input"!==a.tagName&&a.querySelectorAll("input").length,s=Mt(l.field);Object(n.x)(i?a.querySelector("input"):a,{name:s,"e-mappinguid":l.uid,id:t.element.id+s}),Object(n.A)(a,["e-input","e-field"],[]),"Right"===l.textAlign&&a.classList.add("e-ralign"),((l.isPrimaryKey||l.isIdentity)&&"beginEdit"===e.requestType||l.isIdentity&&"add"===e.requestType)&&a.setAttribute("disabled","")}i[l.uid]=a}return i}destroy(){this.renderer.removeEventListener()}}class os{constructor(e){this.activeClasses=["e-selectionbackground","e-active"],this.parent=e}create(e){let t=e.column,i="e-field e-boolcell";"checkbox"===t.type&&(i="e-field e-boolcell e-edit-checkselect");let s=Mt(e.column.field);return this.parent.createElement("input",{className:i,attrs:{type:"checkbox",value:e.value,"e-mappinguid":t.uid,id:this.parent.element.id+s,name:s}})}read(e){return e.checked}write(e){let t,i;if("add"===e.requestType||e.row.classList.contains("e-addedrow"),Object(n.X)(e.row)||(t=e.row.querySelector(".e-edit-checkselect")),_t(e.column.field,e.rowData)&&(i=JSON.parse(_t(e.column.field,e.rowData).toString().toLowerCase())),!Object(n.X)(t)&&"checkbox"===e.column.type){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){let t=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));i=!!t&&t.isSelected}Lt([].slice.call(e.row.querySelectorAll(".e-rowcell")),i,...this.activeClasses)}this.obj=new o.b(Object(n.K)({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:i,disabled:!Tt(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,change:this.checkBoxChange.bind(this)},e.column.edit.params)),Object(n.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element)}checkBoxChange(e){if(this.editRow&&"Dialog"!==this.editType){let t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),Lt([].slice.call(this.editRow.querySelectorAll(".e-rowcell")),t,...this.activeClasses)}}destroy(){this.obj&&this.obj.destroy()}}class hs{constructor(e){this.parent=e,this.flag=!1}create(e){let t=Mt(e.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":e.column.uid}})}write(e){this.column=e.column;let t="Dialog"!==this.parent.editSettings.mode,i=new l.f(e.column.field,"notequal",null,!0,!1);this.obj=new d.d(Object(n.K)({dataSource:this.parent.dataSource instanceof l.a?this.parent.dataSource:new l.a(this.parent.dataSource),query:(new l.g).where(i).select(e.column.field),enabled:Tt(e.column,e.requestType,e.element),fields:{value:e.column.field},value:_t(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.ddActionComplete.bind(this),created:this.dropdownCreated.bind(this),placeholder:t?"":e.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always",open:this.dropDownOpen.bind(this),sortOrder:"Ascending"},e.column.edit.params)),this.obj.query.params=this.parent.query.params,Object(n.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element),e.element.setAttribute("name",Mt(e.column.field))}read(e){return e.ej2_instances[0].value}dropdownCreated(e){this.flag=!0}ddActionComplete(e){e.result=l.b.distinct(e.result,this.obj.fields.value,!0),this.flag&&this.column.dataSource&&("result"in this.column.dataSource?this.column.dataSource.result=e.result:this.column.dataSource instanceof l.a&&(this.column.dataSource.dataSource.json=e.result)),this.flag=!1}dropDownOpen(e){let t=mt(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!Object(n.X)(t)){let i=Object(n.lb)("#"+t.id,document).ej2_instances[0];e.popup.element.style.zIndex=(i.zIndex+1).toString()}}destroy(){this.obj&&this.obj.destroy()}}class ds{constructor(e){this.parent=e}keyEventHandler(e){if(13===e.keyCode||9===e.keyCode){let e=document.createEvent("HTMLEvents");e.initEvent("change",!1,!0),this.dispatchEvent(e)}}create(e){let t=Mt(e.column.field);return this.instances=new n.n(this.parent.locale),this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,"e-mappinguid":e.column.uid}})}read(e){return this.obj.value}write(e){let t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new h.e(Object(n.K)({value:parseFloat(_t(e.column.field,e.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,enabled:Tt(e.column,e.requestType,e.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale},t.edit.params)),e.element.setAttribute("name",Mt(e.column.field)),this.obj.appendTo(e.element),this.obj.element.addEventListener("keydown",this.keyEventHandler)}destroy(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())}}class cs{constructor(e){this.parent=e}create(e){let t=e.column;return this.parent.createElement("input",{className:"e-field e-input e-defaultcell",attrs:{type:"text",value:Object(n.X)(e.value)?"":e.value,"e-mappinguid":t.uid,id:this.parent.element.id+Mt(t.field),name:Mt(t.field),style:"text-align:"+t.textAlign}})}read(e){return e.value}write(e){let t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new h.g(Object(n.K)({element:e.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:Tt(e.column,e.requestType,e.element),placeholder:i?"":e.column.headerText},t.edit.params)),this.obj.appendTo(e.element)}destroy(){this.obj&&this.obj.destroy()}}class ps{constructor(e,t,i){this.args={},this.currentVirtualData={},this.parent=e,this.renderer=i,this.serviceLocator=t,this.addEventListener()}clickHandler(e){let t=e.target,i=this.parent;(mt(t,"e-gridcontent")&&mt(mt(t,"e-gridcontent"),"e-grid").id===i.element.id||i.frozenRows&&mt(t,"e-headercontent"))&&!mt(t,"e-unboundcelldiv")&&(this.rowIndex=mt(t,"e-rowcell")?parseInt(t.parentElement.getAttribute("aria-rowindex"),10):-1,i.isEdit&&i.editModule.endEdit())}dblClickHandler(e){mt(e.target,"e-rowcell")&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(mt(e.target,"e-row"))}editComplete(e){switch(this.parent.isEdit=!1,Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==e.action&&this.parent.selectRow(0),this.parent.trigger(y,Object(n.K)(e,{requestType:"save",type:y}));break;case"delete":if(Object(n.W)()&&!this.parent.isJsComponent){let t="data";e[t]=e[t][0]}this.parent.trigger(y,Object(n.K)(e,{requestType:"delete",type:y})),this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}}startEdit(e){let t=this.parent,i=t.getPrimaryKeyFieldNames(),s=[];if(this.rowIndex=this.editRowIndex=parseInt(e.getAttribute("aria-rowindex"),10),(t.enableVirtualization||t.enableInfiniteScrolling)&&!this.parent.element.querySelector('.e-row[aria-rowindex="'+this.rowIndex+'"]'))return;if(Object(n.W)()){let e=this.parent.getColumns();for(let i=0;i<e.length;i++){let s=e[i];s.template&&Object(n.jb)(t.element.id+s.uid,"Template",this.rowIndex)}}if(Yt(t)){let i=t.getRowObjectFromUID(e.getAttribute("data-uid"));this.previousData=i.data}else if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){let e={data:this.previousData,index:this.rowIndex};this.parent.notify("virtual-scroll-edit-action-begin",e),this.previousData=e.data}else this.previousData=t.getCurrentViewRecords()[this.rowIndex];for(let n=0;n<i.length;n++)s.push(_t(i[n],this.previousData));this.uid=e.getAttribute("data-uid");let r=t.getRowObjectFromUID(this.uid),l={primaryKey:i,primaryKeyValue:s,requestType:"beginEdit",rowData:this.previousData,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:r&&r.foreignKeyData,target:void 0};Object(n.W)()&&!this.parent.isJsComponent||(l.row=e),t.trigger("beginEdit",l,i=>{i.type="actionBegin",t.trigger(f,i,i=>{if(!i.cancel){let s="cloneRow",r="frozen",l="cloneFrozen";t.isEdit=!0,i.row=i.row?i.row:e,Object(n.W)()&&t.isServerRendered&&(this.originalRow=i.row,this.cloneRow=i.row.cloneNode(!0),i[s]=this.cloneRow),"Dialog"!==t.editSettings.mode&&t.clearSelection(),"Dialog"===t.editSettings.mode&&t.selectionModule&&(t.selectionModule.preventFocus=!0,i.row.classList.add("e-dlgeditrow")),this.renderer.update(i),Object(n.W)()&&(i.form=null,this.cloneFrozen=i[l],this.frozen=i[r],this.cloneRow=i[s],this.originalRow=i.row),this.uid=e.getAttribute("data-uid"),t.editModule.applyFormValidation(),i.type="actionComplete",t.trigger(y,i),this.args=i,this.parent.allowTextWrap&&this.parent.notify("freezerender",{case:"textwrap"}),Object(n.W)()&&(this.parent.notify(T,{}),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{}))}})})}updateRow(e,t){let i=this.parent;this.editRowIndex=e;let s={requestType:"save",action:"edit",type:f,data:t,cancel:!1,previousData:i.getCurrentViewRecords()[e],row:i.getRowByIndex(e)};i.showSpinner(),i.notify("update-data",s),s.promise?s.promise.then(()=>i.refresh()).catch(e=>this.edFail(e)):i.refresh()}editFormValidate(){let e=this.parent,t=e.editModule.formObj.validate(),i=!e.editModule.mFormObj||e.editModule.mFormObj.validate(),s=!e.editModule.frFormObj||e.editModule.frFormObj.validate();return t&&i&&s}endEdit(){let e=this.parent;if(!this.parent.isEdit||!this.editFormValidate())return;let t=Object(n.K)({},{},this.previousData,!0),i=Object(n.K)(this.args,{requestType:"save",type:f,data:t,cancel:!1,previousData:this.previousData,selectedRow:e.selectedRowIndex,foreignKeyData:{}}),s="Right"===e.getFrozenMode()?1:0,r="Dialog"===e.editSettings.mode,l=Object(n.lb)("#"+e.element.id+"_dialogEdit_wrapper",document),a=r?l.querySelector(".e-gridform"):e.element.querySelectorAll(".e-gridform")[s],o={virtualData:{},isAdd:!1};if(this.parent.notify("get-virtual-data",o),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||"Normal"!==this.parent.editSettings.mode||a?t=e.editModule.getCurrentEditedData(a,t):this.parent.isEdit&&(this.currentVirtualData=t=i.data=o.virtualData),e.isFrozenGrid()&&"Normal"===e.editSettings.mode){let i,s,r=e.getMovableVirtualHeader().querySelector(".e-gridform"),n=e.getMovableVirtualContent().querySelector(".e-gridform"),l=[r||n],a=[];"Left-Right"===e.getFrozenMode()&&(i=e.getFrozenRightHeader().querySelector(".e-gridform"),s=e.getFrozenRightContent().querySelector(".e-gridform"),a=[i||s]),fi(this.parent,(i,s)=>{for(let r of s)r&&(t=e.editModule.getCurrentEditedData(r,t))},[[],l,a])}if(Object(n.W)()){let e="movableForm";i.form=null,i[e]=null,i.row={}}let h=[].slice.call(e.element.querySelectorAll(".e-editedrow")).length;if(o.isAdd||!Object.keys(this.currentVirtualData).length||h||(h=1),r?l.querySelectorAll(".e-editedrow").length:h)i.action="edit",e.trigger(f,i,t=>{t.cancel||(e.showSpinner(),e.notify("update-data",t))});else if(i.action="add",i.selectedRow=0,i.index=this.addedRowIndex,e.notify("virtual-scroll-edit-success",{}),e.notify(D,i),this.addedRowIndex=null,i.cancel)return}destroyElements(){let e=this.parent;e.editModule.destroyWidgets(),e.editModule.destroyForm(),this.parent.notify("dialog-destroy",{})}editHandler(e){e.promise?e.promise.then(t=>this.edSucc(t,e)).catch(e=>this.edFail(e)):this.editSuccess(e.data,e)}edSucc(e,t){this.editSuccess(e,t)}edFail(e){if(Object(n.W)()&&this.parent.isServerRendered){let t="error",i="message";Object(n.X)(e[t])||Object(n.X)(e[t][i])||(e[t]=e[t][i])}this.editFailure(e)}updateCurrentViewData(e){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=e)}requestSuccess(e){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==e.action&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))}editSuccess(e,t){if(!(Object(n.X)(e)||e instanceof Array)){let i="rowData";t.data=Object(n.K)({},Object(n.K)({},t[i],t.data),e)}let i;this.requestSuccess(t),this.parent.trigger("beforeDataBound",t),t.type=y,this.parent.isEdit=!1,Object(n.W)()&&this.parent.isServerRendered?(this.closeForm(),i={requestType:t.requestType,rowIndex:t.rowIndex,action:t.action,data:t.data},this.parent.notify("editsuccess",i)):this.refreshRow(t.data),this.parent.notify("virtual-scroll-edit-success",t),this.parent.editModule.checkLastRow(t.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(t.data),this.blazorTemplate(),Object(n.W)()&&this.parent.isServerRendered||(this.editRowIndex=null,this.parent.trigger(y,t)),Object(n.W)()&&this.parent.notify(T,{}),(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&(this.parent.isPersistSelection||this.parent.selectionSettings.checkboxOnly)||"Dialog"===this.parent.editSettings.mode||(Object(n.W)()&&this.parent.isServerRendered?i.editRowIndex=this.rowIndex>-1?this.rowIndex:this.editRowIndex:this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex)),this.parent.hideSpinner()}closeForm(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus(),this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow")),this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))}blazorTemplate(){let e=this.parent.getColumns();this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&Object(n.sb)(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings);for(let t=0;t<e.length;t++){let i=e[t];i.template&&Object(n.sb)(this.parent.element.id+i.uid,"Template",i,!1),i.editTemplate&&Object(n.sb)(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i)}}editFailure(e){this.parent.trigger("actionFailure",Object(n.W)()&&e instanceof Array?e[0]:{error:e}),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})}needRefresh(){let e=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(e=!1),e}refreshRow(e){let t=this.parent.isFrozenGrid(),i=new H(this.serviceLocator,null,this.parent),s=this.parent.getRowObjectFromUID(this.uid);if(s){s.changes=e,this.parent.notify("refresh-virtual-cache",e),Wt(s,this.parent.getForeignKeyColumns(),s.changes),this.needRefresh()&&i.refresh(s,this.parent.getColumns(),!0);let r=[].slice.call(this.parent.element.querySelectorAll('[aria-rowindex="'+s.index+'"]'));if(t&&r.length)for(let t=0;t<r.length;t++){let n=r[t].getAttribute("data-uid");n!==this.uid&&(s=this.parent.getRowObjectFromUID(n),s.changes=e,i.refresh(s,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(r[t]))}}}closeEdit(){if(!this.parent.isEdit)return;let e=this.parent,t=Object(n.K)(this.args,{requestType:"cancel",type:f,cancel:!1,data:this.previousData,selectedRow:e.selectedRowIndex});e.notify("virtual-scroll-edit-cancel",t),this.blazorTemplate(),Object(n.W)()&&(t.form=null),e.trigger(f,t,t=>{if(t.cancel)return;"Dialog"===this.parent.editSettings.mode&&this.parent.notify("dialog-destroy",{}),e.isEdit=!1,this.stopEditStatus(),t.type=y,"Dialog"!==e.editSettings.mode&&(Object(n.W)()&&e.isServerRendered?this.closeForm():this.refreshRow(t.data));let i=e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length&&!e.getContentTable().querySelector("tr.e-emptyrow");e.getContentTable().querySelector("tr.e-emptyrow")||e.getContentTable().querySelector("tr.e-row")||i||e.renderModule.emptyRow(),"Dialog"!==e.editSettings.mode&&e.selectRow(this.rowIndex),e.trigger(y,t),Object(n.W)()&&(this.parent.notify(T,{}),this.parent.notify("close-edit",{}))})}addRecord(e,t){let i=this.parent;if(this.addedRowIndex=t=Object(n.X)(t)?0:t,e)return void i.notify(D,{requestType:"save",type:f,data:e,selectedRow:0,action:"add",index:t});if(i.isEdit)return;this.previousData={},this.uid="";let s=i.columnModel;for(let n=0;n<s.length;n++)s[n].field&&l.b.setValue(s[n].field,s[n].defaultValue,this.previousData);let r={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:f,index:t,rowData:this.previousData,target:void 0},a={virtualData:{}};this.parent.notify("get-virtual-data",a),(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(a.virtualData).length&&(r.data=r.rowData=a.virtualData),Object(n.W)()&&(r.form=null),i.trigger(f,r,e=>{e.cancel||(i.isEdit=!0,"Dialog"!==i.editSettings.mode&&i.clearSelection(),this.renderer.addNew(e),i.editModule.applyFormValidation(),e.type=y,e.row=i.element.querySelector(".e-addedrow"),i.trigger(y,e),Object(n.W)()&&(this.parent.notify(T,{}),this.parent.notify("start-add",{})),this.args=e)})}deleteRecord(e,t){if(this.editRowIndex=this.parent.selectedRowIndex,t){t=t instanceof Array?t:[t];let i=this.parent,s=Object.keys(t).length;e=e||this.parent.getPrimaryKeyFieldNames()[0];for(let r=0;r<s;r++){let s,n=i.currentViewData.some(i=>(s=i,t[r]===_t(e,i)||t[r]===i));t[r]=n?s:{[e]:t[r]}}}let i={requestType:"delete",type:f,foreignKeyData:{},data:t||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};if(Object(n.X)(this.parent.commandDelIndex)||(i.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&i.data.length>1){let e=this.parent.getSelectedRows()[0].getAttribute("data-uid");i.data=[this.parent.getRowObjectFromUID(e).data]}Object(n.W)()&&!this.parent.isJsComponent&&(i.data=i.data[0]),this.parent.notify(D,i)}stopEditStatus(){let e=this.parent,t=[].slice.call(e.element.querySelectorAll(".e-addedrow")),i=[].slice.call(e.element.querySelectorAll(".e-editedrow"));for(let s=0;s<t.length;s++)Object(n.hb)(t[s]);for(let s=0;s<i.length;s++)i[s].classList.remove("e-editedrow")}addEventListener(){this.parent.isDestroyed||(this.parent.on("crud-Action",this.editHandler,this),this.parent.on("double-tap",this.dblClickHandler,this),this.parent.on(M,this.clickHandler,this),this.parent.on("recordAdded",this.requestSuccess,this),this.parent.on("dblclick",this.dblClickHandler,this),this.parent.on("delete-complete",this.editComplete,this),this.parent.on("save-complete",this.editComplete,this),this.parent.on("closeinline",this.closeForm,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off("crud-Action",this.editHandler),this.parent.off("double-tap",this.dblClickHandler),this.parent.off(M,this.clickHandler),this.parent.off("recordAdded",this.requestSuccess),this.parent.off("dblclick",this.dblClickHandler),this.parent.off("delete-complete",this.editComplete),this.parent.off("save-complete",this.editComplete),this.parent.off("closeinline",this.closeForm))}destroy(){this.removeEventListener(),this.renderer.destroy()}}class us extends ps{constructor(e,t,i){super(e,t),this.parent=e,this.serviceLocator=t,this.renderer=i}closeEdit(){super.closeEdit()}addRecord(e,t){super.addRecord(e,t)}endEdit(){super.endEdit()}updateRow(e,t){super.updateRow(e,t)}deleteRecord(e,t){super.deleteRecord(e,t)}startEdit(e){super.startEdit(e)}}class gs{constructor(e,t,i){this.cellDetails={},this.originalCell={},this.cloneCell={},this.editNext=!1,this.preventSaveCell=!1,this.parent=e,this.serviceLocator=t,this.renderer=i,this.focus=t.getService("focus"),this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(M,this.clickHandler,this),this.parent.on("dblclick",this.dblClickHandler,this),this.parent.on("beforecellfocused",this.onBeforeCellFocused,this),this.parent.on("cellfocused",this.onCellFocused,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(C,this.dataBoundFunction),this.parent.addEventListener("batchCancel",this.batchCancelFunction),this.parent.on("double-tap",this.dblClickHandler,this),this.parent.on(I,this.keyDownHandler,this),this.parent.on("editNextValCell",this.editNextValCell,this),this.parent.on("closebatch",this.closeForm,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(M,this.clickHandler),this.parent.off("dblclick",this.dblClickHandler),this.parent.off("beforecellfocused",this.onBeforeCellFocused),this.parent.off("cellfocused",this.onCellFocused),this.parent.removeEventListener(C,this.dataBoundFunction),this.parent.removeEventListener("batchCancel",this.batchCancelFunction),this.parent.off("double-tap",this.dblClickHandler),this.parent.off(I,this.keyDownHandler),this.parent.off("editNextValCell",this.editNextValCell),this.parent.off("closebatch",this.closeForm))}batchCancel(e){this.parent.focusModule.restoreFocus()}dataBound(){this.parent.notify(T,{})}destroy(){this.removeEventListener()}clickHandler(e){mt(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&Object(n.C)(this.form,"td")!==Object(n.C)(e.target,"td")&&(this.saveCell(),this.editNextValCell()),mt(e.target,"e-rowcell")&&!this.parent.isEdit&&this.setCellIdx(e.target))}dblClickHandler(e){let t=mt(e.target,"e-rowcell"),i=mt(e.target,"e-row");t&&i&&!isNaN(parseInt(t.getAttribute("aria-colindex"),10))&&!t.parentElement.classList.contains("e-editedrow")&&this.editCell(parseInt(i.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(t.getAttribute("aria-colindex"),10)].field,this.isAddRow(parseInt(i.getAttribute("aria-rowindex"),10)))}onBeforeCellFocused(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())}onCellFocused(e){let t=this.parent.getFrozenLeftCount(),i=this.parent.getFrozenRightColumnsCount(),s=this.parent.getContent().querySelector(".e-movablecontent"),r=this.parent.getHeaderContent().querySelector(".e-movableheader"),n=!(e.container.isContent&&e.container.isDataCell||this.parent.frozenRows&&e.container.isHeader);if(!e.byKey||n)return void(this.parent.isEdit&&n&&this.saveCell());let[l,a]=e.container.indexes;if(t&&(s.contains(e.element)||this.parent.frozenRows&&r.contains(e.element))&&(a+=t),i){let i=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");(this.parent.getContent().querySelector(".e-frozen-right-content").contains(e.element)||this.parent.frozenRows&&i.contains(e.element))&&(a+=t+this.parent.getMovableColumnsCount())}this.parent.frozenRows&&e.container.isContent&&(l+=this.parent.frozenRows);let o=this.parent.isEdit;if(!this.parent.element.querySelectorAll(".e-popup-open").length)switch(o=o&&!this.validateFormObj(),e.keyArgs.action){case"tab":case"shiftTab":let t=this.parent.getColumns()[e.indexes[1]];t&&!this.parent.isEdit&&this.editCell(e.indexes[0],t.field),(o||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(l,a);break;case"enter":case"shiftEnter":e.keyArgs.preventDefault(),o&&this.editCell(l,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(l,a),this.focus.focus()}}isAddRow(e){return this.parent.getDataRows()[e].classList.contains("e-insertedrow")}editCellFromIndex(e,t){this.cellDetails.rowIndex=e,this.cellDetails.cellIndex=t,this.editCell(e,this.parent.getColumns()[t].field,this.isAddRow(e))}closeEdit(){let e=this.parent,t=this.parent.getRowsObject(),i={cancel:!1,batchChanges:this.getBatchChanges()};if(e.notify("before-batch-cancel",i),i.cancel)return;let s=this.parent.getColumns();if(Object(n.W)())for(let a=0;a<s.length;a++){let e=s[a];e.template&&Object(n.sb)(this.parent.element.id+e.uid,"Template",e,!1)}e.isEdit&&this.saveCell(!0),this.isAdded=!1,e.clearSelection();let r=yi(this.parent);for(let n=0;n<t.length;n++){let e=!1,i=t[n].isDirty;fi(this.parent,(t,s)=>{e=this.removeBatchElementChanges(s[n],i),e&&s.splice(n,1)},r),e&&n--}Object(n.W)()&&e.isServerRendered&&e.selectRow(e.selectionModule.prevRowIndex),e.getContentTable().querySelector("tr.e-row")||e.renderModule.renderEmptyRow();let l={requestType:"batchCancel",rows:this.parent.getRowsObject()};e.notify("batchCancel",{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new P({isDataRow:!0,cells:[new q({isDataCell:!0,visible:!0})]})]}),e.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),e.notify(T,{}),this.parent.notify("tooltip-destroy",{}),l={requestType:"batchCancel",rows:this.parent.getRowsObject()},e.trigger("batchCancel",l)}removeBatchElementChanges(e,t){let i=this.parent,s=new H(this.serviceLocator,null,this.parent),r=!1;if(t){e.isDirty=t;let l=i.getRowElementByUID(e.uid);if(l&&(l.classList.contains("e-insertedrow")?(Object(n.hb)(l),r=!0):(Wt(e,this.parent.getForeignKeyColumns(),e.data),delete e.changes,delete e.edit,e.isDirty=!1,Object(n.W)()&&i.isServerRendered?(this.removeHideAndSelection(l),this.closeForm()):(Object(n.A)(l,[],["e-hiddenrow","e-updatedtd"]),s.refresh(e,i.getColumns(),!1))),this.parent.aggregates.length>0)){let e=[];e.type="cancel",this.parent.notify("refresh-footer-rendered",e),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",e)}}return r}removeHideAndSelection(e){if(e.classList.contains("e-hiddenrow")){e.removeAttribute("aria-selected");let t=[].slice.call(e.querySelectorAll(".e-selectionbackground"));for(let e=0;e<t.length;e++)Object(n.ib)([t[e]],["e-selectionbackground","e-active"])}Object(n.A)(e,[],["e-hiddenrow","e-updatedtd"])}deleteRecord(e,t){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(e,t),this.parent.aggregates.length>0&&(this.parent.notify("refresh-footer-rendered",{}),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",{}))}addRecord(e){this.bulkAddRow(e)}endEdit(e){this.parent.isEdit&&this.validateFormObj()||this.batchSave()}closeForm(){for(let e=0;e<Object.keys(this.originalCell).length;e++)for(let t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[e]===Object.keys(this.cloneCell)[t]&&(this.cloneCell[Object.keys(this.cloneCell)[t]].replaceWith(this.originalCell[Object.keys(this.originalCell)[e]]),this.originalCell[Object.keys(this.originalCell)[e]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[e]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={},this.originalCell={}}validateFormObj(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()}batchSave(){let e=this.parent;if(e.isCheckBoxSelection){let t=e.element.querySelector(".e-checkselectall").parentElement;t.classList.contains("e-checkbox-disabled")&&e.pageSettings.totalRecordsCount>e.currentViewData.length&&Object(n.ib)([t],["e-checkbox-disabled"])}let t=this.parent.getColumns();if(Object(n.W)())for(let r=0;r<t.length;r++){let e=t[r];e.template&&(n.z[this.parent.element.id+e.uid]=[],Object(n.jb)(this.parent.element.id+e.uid,"Template"))}if(this.saveCell(),e.isEdit||this.editNextValCell()||e.isEdit)return;let i=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&i.deletedRecords.length&&this.parent.selectionSettings.persistSelection&&(i.deletedRecords=this.removeSelectedData,this.removeSelectedData=[]);let s={changedRecords:this.parent.getRowsObject().filter(e=>e.isDirty&&-1===["add","delete"].indexOf(e.edit)).map(e=>e.data)};e.trigger("beforeBatchSave",{batchChanges:i,cancel:!1},t=>{if(!t.cancel){if(Object(n.W)()&&this.parent.isServerRendered){let e=this.parent.getContent();if(this.closeForm(),Object(n.ib)(e.querySelectorAll(".e-updatedtd"),["e-updatedtd"]),e.querySelector(".e-insertedrow, .e-hiddenrow")){Object(n.ib)(e.querySelectorAll(".e-hiddenrow"),["e-hiddenrow"]);let t=[].slice.call(e.querySelectorAll(".e-insertedrow"));for(let e=0;e<t.length;e++)t[e].remove()}this.refreshRowIdx()}e.showSpinner(),e.notify("bulk-save",{changes:i,original:s})}})}getBatchChanges(){let e={addedRecords:[],deletedRecords:[],changedRecords:[]},t=this.parent.getRowsObject();for(let i of t)if(i.isDirty)switch(i.edit){case"add":e.addedRecords.push(i.changes);break;case"delete":e.deletedRecords.push(i.data);break;default:e.changedRecords.push(i.changes)}return e}removeRowObjectFromUID(e){let t=this.parent.getRowsObject(),i=0;for(let s=t.length;i<s&&t[i].uid!==e;i++);fi(this.parent,(e,t)=>{t.splice(i,1)},yi(this.parent))}addRowObject(e){let t=this.parent,i="Top"===t.editSettings.newRowPosition;fi(this.parent,(s,r)=>{let n=e.clone();n.cells=bi(t,n.cells,s),i?r.unshift(n):r.push(n)},yi(this.parent),!0)}bulkDelete(e,t){this.removeSelectedData=[];let i=this.parent,s=i.selectedRowIndex,r=i.getSelectedRows(),l={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:s,rowData:t||i.getSelectedRecords()[0],cancel:!1};(Object(n.W)()&&!this.parent.isJsComponent||(l.row=t?i.editModule.deleteRowUid?i.getRowElementByUID(i.editModule.deleteRowUid):i.getRows()[i.getCurrentViewRecords().indexOf(t)]:t?i.getRows()[s]:r[0],l.row))&&i.trigger("beforeBatchDelete",l,e=>{if(!e.cancel){if(this.removeSelectedData=i.getSelectedRecords(),i.clearSelection(),e.row=e.row?e.row:t?i.getRows()[s]:r[0],this.parent.isFrozenGrid()){t&&(s=parseInt(e.row.getAttribute("aria-rowindex"),10),r=[],r.push(i.getRowByIndex(s)),r.push(i.getMovableRowByIndex(s)),"Left-Right"===i.getFrozenMode()&&r.push(i.getFrozenRightRowByIndex(s)));for(let e=0;e<r.length;e++){let t=r[e].getAttribute("data-uid");if(r[e].classList.contains("e-insertedrow"))this.removeRowObjectFromUID(t),Object(n.hb)(r[e]);else{let l=i.getRowObjectFromUID(t);l.isDirty=!0,l.edit="delete",Object(n.A)(r[e],["e-hiddenrow","e-updatedtd"],[]),i.frozenRows&&s<i.frozenRows&&i.getMovableDataRows().length>=i.frozenRows&&(i.getMovableHeaderTbody().appendChild(i.getMovableRowByIndex(i.frozenRows-1)),i.getFrozenHeaderTbody().appendChild(i.getRowByIndex(i.frozenRows-1)),"Left-Right"===i.getFrozenMode()&&i.getFrozenRightHeaderTbody().appendChild(i.getFrozenRightRowByIndex(i.frozenRows-1))),i.frozenRows&&s<i.frozenRows&&i.getDataRows().length>=i.frozenRows&&i.getHeaderTable().querySelector("tbody").appendChild(i.getRowByIndex(i.frozenRows-1))}delete r[e]}}else if(this.parent.isFrozenGrid()||1!==r.length&&!t)for(let e=0;e<r.length;e++){let t=r[e].getAttribute("data-uid");if(r[e].classList.contains("e-insertedrow"))this.removeRowObjectFromUID(t),Object(n.hb)(r[e]);else{Object(n.A)(r[e],["e-hiddenrow","e-updatedtd"],[]);let s=i.getRowObjectFromUID(t);s.isDirty=!0,s.edit="delete",delete r[e]}}else{let s=e.row.getAttribute("data-uid");if(s=t&&this.parent.editModule.deleteRowUid?s=this.parent.editModule.deleteRowUid:s,e.row.classList.contains("e-insertedrow"))this.removeRowObjectFromUID(s),Object(n.hb)(e.row);else{let t=i.getRowObjectFromUID(s);t.isDirty=!0,t.edit="delete",Object(n.A)(e.row,["e-hiddenrow","e-updatedtd"],[])}delete e.row}this.refreshRowIdx(),t&&(i.editModule.deleteRowUid=void 0,i.getSelectedRows().length&&(s=parseInt(i.getSelectedRows()[0].getAttribute("aria-rowindex"),10))),i.isCheckBoxSelection||i.selectRow(s),i.trigger("batchDelete",e),i.notify("batchDelete",{rows:this.parent.getRowsObject()}),i.notify(T,{})}})}refreshRowIdx(){let e=this.parent.getAllDataRows(!0),t=Ci(this.parent);for(let i=0,s=0,r=e.length;i<r;i++)e[i].classList.contains("e-row")&&!e[i].classList.contains("e-hiddenrow")?(fi(this.parent,(e,t)=>{t[i].setAttribute("aria-rowindex",s.toString())},t),s++):fi(this.parent,(e,t)=>{t[i].removeAttribute("aria-rowindex")},t)}getIndexFromData(e){return ft(e,this.parent.getCurrentViewRecords())}bulkAddRow(e){let t=this.parent;if(!t.editSettings.allowAdding)return;if(t.isEdit&&(this.saveCell(),this.parent.notify("editNextValCell",{})),t.isEdit)return;this.parent.element.classList.add("e-editing");let i={defaultData:e||this.getDefaultData(),primaryKey:t.getPrimaryKeyFieldNames(),cancel:!1};t.trigger("beforeBatchAdd",i,i=>{if(i.cancel)return;let s,r;this.isAdded=!0,t.clearSelection();let l,a,o=new H(this.serviceLocator,null,this.parent),h=new N(this.parent).generateRows([i.defaultData]),d=o.render(h[0],t.getColumns());for(let e=0;e<this.parent.groupSettings.columns.length;e++)d.insertBefore(this.parent.createElement("td",{className:"e-indentcell"}),d.firstChild),h[0].cells.unshift(new q({cellType:A.Indent}));let c=t.getContentTable().querySelector("tbody");if(d.classList.add("e-insertedrow"),c.querySelector(".e-emptyrow")){let e=c.querySelector(".e-emptyrow");e.parentNode.removeChild(e),this.removeFrozenTbody()}t.isFrozenGrid()&&(r=d.cloneNode(!0),s=this.renderMovable(d,r),d="Right"===t.getFrozenMode()?r:d,this.renderFrozenAddRow(d,s,r)),c=t.frozenRows&&"Top"===t.editSettings.newRowPosition?t.getHeaderTable().querySelector("tbody"):t.getContentTable().querySelector("tbody"),"Top"===this.parent.editSettings.newRowPosition?c.insertBefore(d,c.firstChild):c.appendChild(d),Object(n.v)(d.querySelectorAll(".e-rowcell"),["e-updatedtd"]),h[0].isDirty=!0,h[0].changes=Object(n.K)({},{},h[0].data,!0),h[0].edit="add",this.addRowObject(h[0]),this.refreshRowIdx(),this.focus.forgetPrevious(),t.notify("batchAdd",{rows:this.parent.getRowsObject(),args:{isFrozen:this.parent.isFrozenGrid()}});let p=this.getBatchChanges(),u=this.parent.getCurrentViewRecords().length+p.addedRecords.length-p.deletedRecords.length-1;t.selectRow("Top"===this.parent.editSettings.newRowPosition?0:u),e||(a=this.findNextEditableCell(0,!0),l=t.getColumns()[a],this.editCell("Top"===this.parent.editSettings.newRowPosition?0:u,l.field,!0)),this.parent.aggregates.length>0&&(e||p.addedRecords.length)&&this.parent.notify("refresh-footer-rendered",{}),t.trigger("batchAdd",{defaultData:i.defaultData,row:d,columnObject:l,columnIndex:a,primaryKey:i.primaryKey,cell:d.cells[a]}),t.isFrozenGrid()&&ri(s.querySelector("td:not(.e-hide)"),d.querySelector("td:not(.e-hide)")),Object(n.W)()&&(this.parent.notify(T,{}),this.parent.notify("start-add",{}))})}renderFrozenAddRow(e,t,i){let s=this.parent,r=xi(this.parent),l=ji(this.parent);"Top"===s.editSettings.newRowPosition?r.insertBefore(t,r.firstChild):r.appendChild(t),Object(n.v)(t.querySelectorAll(".e-rowcell"),["e-updatedtd"]),l&&i&&("Top"===s.editSettings.newRowPosition?l.insertBefore(i,l.firstChild):l.appendChild(i),Object(n.v)(i.querySelectorAll(".e-rowcell"),["e-updatedtd"]),ri(i.querySelector("td:not(.e-hide)"),e.querySelector("td:not(.e-hide)"))),"auto"===s.height&&s.notify("frozenHeight",{})}removeFrozenTbody(){let e=this.parent;if(e.isFrozenGrid()){let t=e.getContent().querySelector(".e-movablecontent").querySelector("tbody");if(t.firstElementChild.parentNode.removeChild(t.firstElementChild),"Left-Right"===e.getFrozenMode()){let t=e.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");t.firstElementChild.parentNode.removeChild(t.firstElementChild)}}}renderMovable(e,t){let i=e.cloneNode(!0),s=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenLeftCount(),n=this.parent.getFrozenRightColumnsCount();return vi(e,0,r),vi(i,r,n?i.children.length-n:i.children.length),vi(t,r+s,t.children.length),i}findNextEditableCell(e,t,i){let s,r=this.parent.getColumns(),l=r.length;for(let a=e;a<l;a++){if(s=!!i&&Object(n.X)(r[a].validationRules),!t&&this.checkNPCell(r[a]))return a;if(t&&!r[a].template&&r[a].visible&&r[a].allowEditing&&(!r[a].isIdentity||!r[a].isPrimaryKey)&&!s)return a}return-1}checkNPCell(e){return!e.template&&e.visible&&!e.isPrimaryKey&&!e.isIdentity&&e.allowEditing}getDefaultData(){let e=this.parent,t={},i={number:0,string:null,boolean:!1,date:null,datetime:null};for(let s of e.columnModel)s.field&&Object(n.qb)(s.field,s.defaultValue?s.defaultValue:i[s.type],t);return t}setCellIdx(e){let t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=e.cellIndex-t,this.cellDetails.rowIndex=parseInt(e.getAttribute("index"),10)}editCell(e,t,i){let s=this.parent,r=s.getColumnByField(t);this.index=e,this.field=t,this.isAdd=i;let l=s.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===e&&this.parent.getDataRows().length-1!==e);Object(n.W)()&&r.template&&!i&&Object(n.jb)(this.parent.element.id+r.uid,"Template",e),s.editSettings.allowEditing&&(!l&&r.allowEditing?this.editCellExtend(e,t,i):l&&(this.editNext=!0,this.saveCell()))}editCellExtend(e,t,i){let s,r,l=this.parent,a=l.getColumnByField(t),o=l.getPrimaryKeyFieldNames();if(l.isEdit)return;let h=Object(n.K)({},{},this.getDataByIndex(e),!0);if("movable"===a.getFreezeTableName()||"frozen-right"===a.getFreezeTableName()?(s="movable"===a.getFreezeTableName()?l.getMovableDataRows()[e]:l.getFrozenRightDataRows()[e],r=this.parent.getRowObjectFromUID(s.getAttribute("data-uid")),h=r.changes?Object(n.K)({},{},r.changes,!0):h):(s=l.getDataRows()[e],h=Object(n.K)({},{},this.getDataByIndex(e),!0)),o[0]===a.field&&!s.classList.contains("e-insertedrow")||a.columns||a.isPrimaryKey&&a.isIdentity)return void(this.parent.isLastCellPrimaryKey=!0);this.parent.isLastCellPrimaryKey=!1,this.parent.element.classList.add("e-editing");let d=l.getRowObjectFromUID(s.getAttribute("data-uid")),c=[].slice.apply(s.cells),p={columnName:a.field,isForeignKey:!Object(n.X)(a.foreignKeyValue),primaryKey:o,rowData:h,validationRules:Object(n.K)({},a.validationRules?a.validationRules:{}),value:_t(a.field,h),type:i?"add":"edit",cancel:!1,foreignKeyData:d&&d.foreignKeyData};(Object(n.W)()&&!this.parent.isJsComponent||(p.cell=c[this.getColIndex(c,this.getCellIdx(a.uid))],p.row=s,p.columnObject=a,p.cell))&&l.trigger("cellEdit",p,t=>{if(!t.cancel){if(t.cell=t.cell?t.cell:c[this.getColIndex(c,this.getCellIdx(a.uid))],t.row=t.row?t.row:s,t.columnObject=t.columnObject?t.columnObject:a,t.columnObject.index=Object(n.X)(t.columnObject.index)?0:t.columnObject.index,this.cellDetails={rowData:h,column:a,value:t.value,isForeignKey:t.isForeignKey,rowIndex:e,cellIndex:parseInt(t.cell.getAttribute("aria-colindex"),10),foreignKeyData:t.foreignKeyData},t.cell.classList.contains("e-updatedtd")&&(this.isColored=!0,t.cell.classList.remove("e-updatedtd")),Object(n.W)()&&l.isServerRendered){let e="cells",i="cloneCell",s=t.row.querySelectorAll(".e-indentcell, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop").length;this.cloneCell[`${this.cellDetails.rowIndex}${t.columnObject.index}`]=t[i]=t.cell.cloneNode(!0),mt(t.cell,"e-movableheader")||mt(t.cell,"e-movablecontent")?(t.row.insertCell(t.columnObject.index-l.getFrozenColumns()),t.row.replaceChild(t[i],t.row[e][t.columnObject.index-l.getFrozenColumns()])):(t.row.insertCell(t.columnObject.index+s),t.row.replaceChild(t[i],t.row[e][t.columnObject.index+s])),this.originalCell[`${this.cellDetails.rowIndex}${t.columnObject.index}`]=t.cell.parentElement.removeChild(t.cell),Object(n.ib)([this.cloneCell[`${this.cellDetails.rowIndex}${t.columnObject.index}`]],["e-focus","e-focused"])}l.isEdit=!0,l.clearSelection(),l.isCheckBoxSelection&&l.isPersistSelection||l.selectRow(this.cellDetails.rowIndex,!0),this.renderer.update(t),this.parent.notify("batcheditform-rendered",t),this.form=Object(n.lb)("#"+l.element.id+"EditForm",l.element),l.editModule.applyFormValidation([a]),this.parent.element.querySelector(".e-gridpopup").style.display="none"}})}updateCell(e,t,i){let s=this.parent,r=s.getColumnByField(t),n=s.getColumnIndexByField(t);if(r&&!r.isPrimaryKey){let t=Si(this.parent,r,e,n),l="movable"===r.getFreezeTableName()?this.parent.getMovableRowsObject()[e]:"frozen-right"===r.getFreezeTableName()?s.getFrozenRightRowsObject()[e]:s.getRowObjectFromUID(t.parentElement.getAttribute("data-uid"));this.refreshTD(t,r,l,i),this.parent.trigger("queryCellInfo",{cell:t,column:r,data:l.changes})}}setChanges(e,t,i,s){let r;if(this.parent.isFrozenGrid()){let l,a=this.parent.getRowElementByUID(e.uid),o=parseInt(a.getAttribute("aria-rowindex"),10);if(r=this.parent.getRowsObject()[o],r.changes||(r.changes=Object(n.K)({},{},e.data,!0)),Object(n.X)(t)||Object(n.qb)(t,i,r.changes),Object(n.W)()&&this.parent.isServerRendered&&(mt(s,"e-movableheader")||mt(s,"e-movablecontent"))){let e=this.parent.getMovableRowByIndex(this.cellDetails.rowIndex),t=parseInt(e.getAttribute("aria-rowindex"),10);l=this.parent.getMovableRowsObject()[t]}else l=this.parent.getMovableRowsObject()[o];if(l.changes=Object(n.K)({},{},r.changes,!0),e.data[t]!==i&&(l.isDirty=!0,r.isDirty=!0),"Left-Right"===this.parent.getFrozenMode()){let s=this.parent.getFrozenRightRowsObject()[o];s.changes=Object(n.K)({},{},r.changes,!0),e.data[t]!==i&&(s.isDirty=!0)}}else e.changes||(e.changes=Object(n.K)({},{},e.data,!0)),Object(n.X)(t)||l.b.setValue(t,i,e.changes),e.data[t]!==i&&(e.isDirty=!0)}updateRow(e,t){let i=Object.keys(t);for(let s of i)this.updateCell(e,s,t[s])}getCellIdx(e){let t=this.parent.getColumnIndexByUid(e)+this.parent.groupSettings.columns.length;return Object(n.X)(this.parent.detailTemplate)&&Object(n.X)(this.parent.childGrid)||t++,this.parent.isRowDragable()&&t++,t}refreshTD(e,t,i,s){let r,l=new _(this.parent,this.serviceLocator);s="number"!==t.type||Object(n.X)(s)?s:parseFloat(s),this.setChanges(i,t.field,s,e);let a,o,h=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();h=h&&this.parent.isRowDragable()?h+1:h,Wt(i,this.parent.getForeignKeyColumns(),i.changes),r=h&&"movable"===t.getFreezeTableName()&&this.parent.getColumns().length===i.cells.length?i.cells.slice(h,i.cells.length):i.cells,this.parent.isReact&&(a=e.parentElement,o=e.cellIndex);let d=0;h&&(d="movable"===t.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?h:"frozen-right"===t.getFreezeTableName()?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():d),l.refreshTD(e,r[this.getCellIdx(t.uid)-d],i.changes,{index:this.getCellIdx(t.uid)}),this.parent.isReact?(this.newReactTd=a.cells[o],a.cells[o].classList.add("e-updatedtd")):e.classList.add("e-updatedtd"),e.classList.add("e-updatedtd"),this.parent.notify(T,{})}getColIndex(e,t){let i=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(i=this.parent.groupSettings.columns.length),Object(n.X)(this.parent.detailTemplate)&&Object(n.X)(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++;for(let s=0;s<e.length;s++)if(parseInt(e[s].getAttribute("aria-colindex"),10)===t-i)return s;return-1}editNextValCell(){let e=this.parent,t=this.getBatchChanges(),i=this.parent.getCurrentViewRecords().length+t.addedRecords.length-t.deletedRecords.length-1;if(this.isAdded&&!e.isEdit){for(let t=this.cellDetails.cellIndex;t<e.getColumns().length;t++){if(e.isEdit)return;let t=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),s=e.getColumns()[t];if(s){if("Bottom"===this.parent.editSettings.newRowPosition)this.editCell(i,s.field,!0);else{let e={index:0,column:s};this.parent.notify("next-cell-index",e),this.editCell(e.index,s.field,!0)}this.saveCell()}}e.isEdit||(this.isAdded=!1)}}escapeCellEdit(){let e=this.generateCellArgs();e.value=e.previousValue,this.successCallBack(e,e.cell.parentElement,e.column,!0)(e)}generateCellArgs(){let e=this.parent;this.parent.element.classList.remove("e-editing");let t=this.cellDetails.column,i={};i[t.field]=_t(t.field,this.cellDetails.rowData);let s=e.editModule.getCurrentEditedData(this.form,i),r=Object(n.K)({},s);s=Object(n.K)({},s,this.cellDetails.rowData);let l=_t(t.field,r);Object(n.X)(t.field)||Object(n.ab)(l)||Object(n.qb)(t.field,l,s);let a={columnName:t.field,value:_t(t.field,s),rowData:this.cellDetails.rowData,column:t,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};return Object(n.W)()&&!this.parent.isJsComponent||(a.cell=this.form.parentElement,a.columnObject=t),a}saveCell(e){if(this.preventSaveCell)return;let t=this.parent;if(!e&&(!t.isEdit||this.validateFormObj()))return;this.preventSaveCell=!0;let i=this.generateCellArgs(),s=Object(n.W)()?mt(this.form,"e-row"):i.cell.parentElement,r=Object(n.W)()?this.cellDetails.column:i.column;Object(n.W)()&&delete i.column,e?this.successCallBack(i,s,r)(i):(t.trigger("cellSave",i,this.successCallBack(i,s,r)),t.notify("batchedit-form",{formObj:this.form}))}successCallBack(e,t,i,s){return e=>{let r=this.parent;if(e.cell=e.cell?e.cell:this.form.parentElement,e.columnObject=e.columnObject?e.columnObject:i,e.columnObject.index=Object(n.X)(e.columnObject.index)?0:e.columnObject.index,e.cancel){if(this.preventSaveCell=!1,this.editNext){if(this.editNext=!1,this.cellDetails.rowIndex===this.index&&this.cellDetails.column.field===this.field)return;this.editCellExtend(this.index,this.field,this.isAdd)}}else{if(r.editModule.destroyWidgets([i]),r.isEdit=!1,r.editModule.destroyForm(),Object(n.W)()&&i.template&&!e.cell.parentElement.classList.contains("e-insertedrow")&&Object(n.sb)(r.element.id+i.uid,"Template",i,!1),this.parent.notify("tooltip-destroy",{}),Object(n.W)()&&r.isServerRendered&&(mt(e.cell,"e-movableheader")||mt(e.cell,"e-movablecontent")))this.refreshTD(e.cell,i,r.getMovableRowsObject()[this.cellDetails.rowIndex],e.value);else{let s=mt(e.cell,"e-movablecontent")||mt(e.cell,"e-movableheader")?r.getRowObjectFromUID(t.getAttribute("data-uid"),!0):r.getRowObjectFromUID(t.getAttribute("data-uid"));"Left-Right"===r.getFrozenMode()&&(mt(e.cell,"e-frozen-right-header")||mt(e.cell,"e-frozen-right-content"))&&(s=r.getRowObjectFromUID(t.getAttribute("data-uid"),!1,!0)),this.refreshTD(e.cell,i,s,e.value),this.parent.isReact&&(e.cell=this.newReactTd)}if(Object(n.ib)([t],["e-editedrow","e-batchrow"]),Object(n.ib)([e.cell],["e-editedbatchcell","e-boolcell"]),(!Object(n.X)(e.value)&&e.value.toString()===(Object(n.X)(this.cellDetails.value)?"":this.cellDetails.value).toString()&&!this.isColored||Object(n.X)(e.value)&&Object(n.X)(this.cellDetails.value)&&!e.cell.parentElement.classList.contains("e-insertedrow"))&&(e.cell.classList.remove("e-updatedtd"),Object(n.W)()&&r.isServerRendered&&(Object(n.X)(e.value)?"":e.value).toString()===(Object(n.X)(this.cellDetails.value)?"":this.cellDetails.value).toString()&&(this.cloneCell[`${parseInt(t.getAttribute("aria-rowindex"),10)}${e.columnObject.index}`].classList.contains("e-selectionbackground")?this.originalCell[`${parseInt(t.getAttribute("aria-rowindex"),10)}${e.columnObject.index}`].classList.add("e-selectionbackground","e-active"):this.originalCell[`${parseInt(t.getAttribute("aria-rowindex"),10)}${e.columnObject.index}`].classList.remove("e-selectionbackground","e-active"),this.cloneCell[`${parseInt(t.getAttribute("aria-rowindex"),10)}${e.columnObject.index}`].replaceWith(this.originalCell[`${parseInt(t.getAttribute("aria-rowindex"),10)}${e.columnObject.index}`]))),Object(n.X)(s)&&r.trigger("cellSaved",e),r.notify(T,{}),this.isColored=!1,this.parent.aggregates.length>0&&(this.parent.notify("refresh-footer-rendered",{}),this.parent.groupSettings.columns.length>0&&!this.isAddRow(this.cellDetails.rowIndex)&&this.parent.notify("group-aggregates",{})),this.preventSaveCell=!1,this.editNext){if(this.editNext=!1,this.cellDetails.rowIndex===this.index&&this.cellDetails.column.field===this.field)return;let e=r.getColumnByField(this.field);e&&e.allowEditing&&this.editCellExtend(this.index,this.field,this.isAdd)}s&&r.notify("restore-Focus",{})}}}getDataByIndex(e){let t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[e].getAttribute("data-uid"));return t.changes?t.changes:t.data}keyDownHandler(e){if(("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){let t=this.parent,i=this.getBatchChanges(),s="addedRecords",r="deletedRecords",n=this.parent.getCurrentViewRecords().length+i[s].length-i[r].length-1,l=mt(e.target,"e-rowcell");if(l){let i=l.querySelector(".e-field");if(i){let s=this.parent.getVisibleColumns();s["tab"===e.action?s.length-1:0].field===i.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex===n&&"tab"===e.action?"Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord():this.saveCell())}}}}addCancelWhilePaging(){this.validateFormObj()&&(this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.isColored=!1)}}class ms extends ps{constructor(e,t,i){super(e,t),this.parent=e,this.serviceLocator=t,this.renderer=i}closeEdit(){super.closeEdit()}addRecord(e,t){super.addRecord(e,t)}endEdit(){super.endEdit()}updateRow(e,t){super.updateRow(e,t)}deleteRecord(e,t){super.deleteRecord(e,t)}startEdit(e){super.startEdit(e)}}class bs{constructor(e){this.parent=e}create(e){let t=Mt(e.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":e.column.uid}})}read(e){return e.ej2_instances[0].value}write(e){"datepickeredit"===e.column.editType?this.obj=new c.b(Object(n.K)(fs(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params)):"datetimepickeredit"===e.column.editType&&(this.obj=new c.d(Object(n.K)(fs(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params))),Object(n.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element)}destroy(){this.obj&&this.obj.destroy()}}function fs(e,t,i){let s="Dialog"!==t,r=Qt(e.column.format,e.column.type),n=_t(e.column.field,e.rowData);return n=n?new Date(n):null,{floatLabelType:s?"Never":"Always",value:n,format:r,placeholder:s?"":e.column.headerText,enableRtl:i,enabled:Tt(e.column,e.requestType,e.element)}}class ys{constructor(e){this.parent=e}read(e,t){return t}write(){}destroy(){}}let Cs=(()=>{class e{constructor(e,t){this.editType={Inline:us,Normal:us,Batch:gs,Dialog:ms},this.parent=e,this.serviceLocator=t,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}updateColTypeObj(){let t=this.parent.columnModel;for(let i=0;i<t.length;i++)if(this.parent.editSettings.template||t[i].editTemplate){let s="templateedit";t[i].edit=Object(n.K)(new e.editCellType[s](this.parent),t[i].edit||{})}else t[i].edit=Object(n.K)(new e.editCellType[t[i].editType&&e.editCellType[t[i].editType]?t[i].editType:"defaultedit"](this.parent,this.serviceLocator),t[i].edit||{});this.parent.log("primary_column_missing")}getModuleName(){return"edit"}onPropertyChanged(e){if(e.module!==this.getModuleName())return;let t=this.parent;for(let i of Object.keys(e.properties))switch(i){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),t.isEdit=!1,t.refresh()}}updateEditObj(){this.editModule&&this.editModule.destroy(),this.renderer=new as(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)}initialEnd(){this.updateColTypeObj()}startEdit(e){let t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)e||(e=t.getSelectedRows()[0]);else if(!e)return void this.showDialog("EditOperationAlert",this.alertDObj);this.isLastRow=e.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex,"none"!==e.style.display&&(this.editModule.startEdit(e),Object(n.W)()||(this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{})))}}checkLastRow(e,t){let i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&t&&"add"===t.requestType&&this.parent.height>this.parent.getContentTable().scrollHeight?Object(n.v)(e.querySelectorAll(".e-rowcell"),"e-lastrowadded"):i&&e&&e.classList&&Object(n.v)(e.querySelectorAll(".e-rowcell"),"e-lastrowcell")}closeEdit(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.querySelectorAll(".e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),Object(n.W)()||(this.refreshToolbar(),this.parent.notify("close-edit",{})))}refreshToolbar(){this.parent.notify(T,{})}addRecord(e,t){if(!this.parent.editSettings.allowAdding)return;let i={startEdit:!0};e||this.parent.notify("virtual-scroll-add-action-begin",i),i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(e,t),Object(n.W)()||(this.refreshToolbar(),this.parent.notify("start-add",{})))}deleteRecord(e,t){let i=this.parent;i.editSettings.allowDeleting&&(t||i.getSelectedRecords().length||!Object(n.X)(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(e,t):this.showDialog("DeleteOperationAlert",this.alertDObj))}deleteRow(e){this.deleteRowUid=e.getAttribute("data-uid");let t=this.parent.getRowObjectFromUID(this.deleteRowUid);Object(n.X)(t)||this.deleteRecord(null,t.data)}endEdit(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(Object(n.X)(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify("editNextValCell",{}),Object(n.X)(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()}updateCell(e,t,i){this.editModule.updateCell(e,t,i)}updateRow(e,t){this.editModule.updateRow(e,t)}batchCancel(){this.closeEdit()}batchSave(){this.endEdit()}editCell(e,t){this.editModule.editCell(e,t)}editFormValidate(){return!!this.formObj&&this.formObj.validate()}getBatchChanges(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}}getCurrentEditCellData(){let e=this.getCurrentEditedData(this.formObj.element,{});return e[Object.keys(e)[0]]}saveCell(){this.editModule.saveCell()}endEditing(){this.parent.element.classList.remove("e-editing"),this.editModule.endEdit(),this.refreshToolbar()}showDialog(e,t){t.content="<div>"+this.l10n.getConstant(e)+"</div>",t.dataBind(),t.show()}getValueFromType(e,t){let i=t;switch(e.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==e.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==e.editType&&"datetimepickeredit"!==e.editType&&t&&t.length?i=new Date(t):""===t&&(i=null)}return i}destroyToolTip(){let e=[].slice.call(this.parent.element.querySelectorAll(".e-griderror"));for(let t of e)Object(n.hb)(t);this.parent.getContent().firstElementChild.style.position="relative"}createConfirmDlg(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")}createAlertDlg(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-flat",isPrimary:!0}}],"EditAlert")}alertClick(){this.alertDObj.hide()}dlgWidget(e,t){let i=this.parent.createElement("div",{id:this.parent.element.id+t});this.parent.element.appendChild(i);let s={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"}};s.buttons=e;let r=new a.a(s);return r.isStringTemplate=!0,r.appendTo(i),r}dlgCancel(){this.parent.focusModule.clearIndicator(),this.parent.focusModule.restoreFocus(),this.dialogObj.hide()}dlgOk(e){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&(this.editModule.addCancelWhilePaging(),Object(n.W)()&&this.parent.isServerRendered&&this.editModule.closeEdit()),this.executeAction()}this.dlgCancel()}addEventListener(){this.parent.isDestroyed||(this.parent.on(R,this.onPropertyChanged,this),this.parent.on(w,this.initialEnd,this),this.parent.on(I,this.keyPressHandler,this),this.parent.on(k,this.updateColTypeObj,this),this.parent.on("tooltip-destroy",this.destroyToolTip,this),this.parent.on(z,this.preventBatch,this),this.parent.on("destroy-form",this.destroyForm,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(f,this.actionBeginFunction),this.parent.addEventListener(y,this.actionCompleteFunction))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(R,this.onPropertyChanged),this.parent.off(w,this.initialEnd),this.parent.off(I,this.keyPressHandler),this.parent.off(k,this.updateColTypeObj),this.parent.off("tooltip-destroy",this.destroyToolTip),this.parent.off(z,this.preventBatch),this.parent.off("destroy-form",this.destroyForm),this.parent.removeEventListener(y,this.actionCompleteFunction),this.parent.removeEventListener(f,this.actionBeginFunction))}actionComplete(e){["add","beginEdit","save","delete","cancel"].indexOf(e.requestType)<0&&(this.parent.isEdit=!1),"batchsave"===e.requestType&&this.parent.focusModule.restoreFocus(),this.refreshToolbar()}getCurrentEditedData(e,t){let i=this.parent;if(i.editSettings.template){let s=[].slice.call(e.elements);for(let e=0;e<s.length;e++)if(s[e].hasAttribute("name")&&"e-multi-hidden"!==s[e].className||s[e].classList.contains("e-multiselect")){let r,a=s[e].hasAttribute("name")?Ft(s[e].getAttribute("name")):Ft(s[e].getAttribute("id")),o=i.getColumnByField(a)||{field:a,type:s[e].getAttribute("type")};"checkbox"===o.type||"boolean"===o.type?r=s[e].checked:s[e].value?(r=s[e].value,s[e].ej2_instances&&s[e].ej2_instances.length&&!Object(n.X)(s[e].ej2_instances[0].value)&&(s[e].blur(),r=s[e].ej2_instances[0].value,"date"!==o.type&&"dateTime"!==o.type&&"datetime"!==o.type||!s[e].ej2_instances[0].isServerRendered||(r=s[e].value))):s[e].ej2_instances&&(r=s[e].ej2_instances[0].value),o.edit&&"string"==typeof o.edit.read?r=Object(n.V)(o.edit.read,window)(s[e],r):o.edit&&o.edit.read&&(r=o.edit.read(s[e],r)),r=i.editModule.getValueFromType(o,r),"radio"===s[e].type?s[e].checked&&l.b.setValue(o.field,r,t):l.b.setValue(o.field,r,t)}return t}let s=i.columnModel.filter(e=>e.editTemplate);for(let a=0;a<s.length;a++)if(e[Mt(s[a].field)]){let i=[].slice.call(e[Mt(s[a].field)]);i=i.length?i:[e[Mt(s[a].field)]];let r=i.filter(e=>!Object(n.X)(e.ej2_instances));0===r.length&&(r=i.filter(e=>e.hasAttribute("name")));for(let e=0;e<r.length;e++){let i=this.getValue(s[a],r[e],t);l.b.setValue(s[a].field,i,t)}}let r=[].slice.call(e.querySelectorAll(".e-field"));for(let n=0,a=r.length;n<a;n++){let e=i.getColumnByUid(r[n].getAttribute("e-mappinguid"));if(e&&e.field){let i=this.getValue(e,r[n],t);l.b.setValue(e.field,i,t)}}return t}getValue(e,t,i){let s=!t.ej2_instances||Object(n.W)()&&t.ej2_instances[0].isServerRendered&&("date"===e.type||"datetime"===e.type)?t.value:t.ej2_instances[0].value,r=this.parent,l=e.edit.read;return"checkbox"!==e.type&&"boolean"!==e.type||(s=t.checked),"string"==typeof l?(l=Object(n.V)(l,window),s=r.editModule.getValueFromType(e,l(t,s))):s=r.editModule.getValueFromType(e,e.edit.read(t,s)),Object(n.X)(i[e.field])&&""===s&&(s=i[e.field]),s}onActionBegin(e){if("columnstate"===e.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{let t=this.parent.element.querySelector(".e-editedrow");if(t&&this.parent.frozenRows&&"virtualscroll"===e.requestType&&parseInt(mt(t,"e-row").getAttribute("aria-rowindex"),10)<this.parent.frozenRows)return;let i=["filterafteropen","filterbeforeopen","filterchoicerequest","save","infiniteScroll"];"Batch"===this.parent.editSettings.mode||!this.formObj||this.formObj.isDestroyed||-1!==i.indexOf(e.requestType)||e.cancel||(this.destroyWidgets(),this.destroyForm())}}destroyWidgets(e){this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(e=e||this.parent.getVisibleColumns()).some(e=>!Object(n.X)(e.editTemplate))&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates());for(let i of e){let e=i.edit.destroy;Object(n.W)()&&i.editTemplate&&(Object(n.jb)(this.parent.element.id+i.uid+"editTemplate","EditTemplate"),Object(n.sb)(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i,!1)),i.edit.destroy&&("string"==typeof e?(e=Object(n.V)(e,window),e()):i.edit.destroy())}let t=[].slice.call(this.formObj.element.elements);for(let i=0;i<t.length;i++)t[i].hasAttribute("name")&&t[i].ej2_instances&&t[i].ej2_instances.length&&!t[i].ej2_instances[0].isDestroyed&&t[i].ej2_instances[0].destroy()}destroyForm(){this.destroyToolTip(),this.formObj&&!this.formObj.isDestroyed&&this.formObj.destroy(),this.destroyToolTip()}destroy(){let e=this.parent.element;if(!e)return;let t=!(!e.querySelector(".e-gridheader")||!e.querySelector(".e-gridcontent"));t&&this.destroyForm(),this.removeEventListener();let i=this.dialogObj.element;i.childElementCount>0&&(this.dialogObj.destroy(),Object(n.hb)(i)),i=this.alertDObj.element,i.childElementCount>0&&(this.alertDObj.destroy(),Object(n.hb)(i)),t&&this.editModule&&this.editModule.destroy()}keyPressHandler(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":mt(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(mt(e.target,"e-gridcontent")||this.parent.frozenRows&&mt(e.target,"e-headercontent"))||document.querySelectorAll(".e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.closeEdit())}}preventBatch(e){this.preventObj=e,this.showDialog("BatchSaveLostChanges",this.dialogObj)}executeAction(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)}applyFormValidation(e){let t=this.parent,i=t.isFrozenGrid(),s="Normal"===this.parent.editSettings.mode,r="Right"===this.parent.getFrozenMode()&&s?1:0,l="Dialog"!==this.parent.editSettings.mode?t.element.querySelectorAll(".e-gridform")[r]:Object(n.lb)("#"+t.element.id+"_dialogEdit_wrapper .e-gridform",document),a="Right"===this.parent.getFrozenMode()&&s?0:1,o=t.element.querySelectorAll(".e-gridform")[a],h={},d={},c={};e=e||t.getColumns();for(let p=0;p<e.length;p++)e[p].visible&&(Object(n.W)()&&e[p].editTemplate||e[p].validationRules&&Oi(e[p],a,h,d,c,e.length));if(i&&"Dialog"!==this.parent.editSettings.mode){if(this.parent.editModule.mFormObj=this.createFormObj(o,d),"Left-Right"===this.parent.getFrozenMode()){let e=t.element.querySelectorAll(".e-gridform")[2];this.parent.editModule.frFormObj=this.createFormObj(e,c)}}else h=Object(n.K)(h,d,c);this.parent.editModule.formObj=Object(n.W)()&&this.parent.editSettings.template?this.createFormObj(l,{}):this.createFormObj(l,h)}createFormObj(e,t){return new h.b(e,{rules:t,locale:this.parent.locale,validationComplete:e=>{this.validationComplete(e)},customPlacement:(e,t)=>{let i=e.getAttribute("e-mappinguid"),s={column:this.parent.getColumnByUid(i),error:t,inputElement:e,value:e.value};this.valErrorPlacement(e,t),this.parent.notify("validation-custom-placement",s)}})}valErrorPlacement(e,t){if(this.parent.isEdit){let i=t.getAttribute("for"),s=this.getElemTable(e).querySelector("#"+i+"_Error");s?s.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(e,t,i,"")}}getElemTable(e){let t;return"Dialog"!==this.parent.editSettings.mode&&(t=this.parent.frozenRows&&this.parent.frozenRows>(parseInt(Object(n.C)(e,".e-row").getAttribute("aria-rowindex"),10)||0)),"Dialog"!==this.parent.editSettings.mode?t?this.parent.getHeaderTable():this.parent.getContentTable():Object(n.lb)("#"+this.parent.element.id+"_dialogEdit_wrapper",document)}resetElemPosition(e,t){let i=mt(t.element,"e-rowcell");if(i){let t=i.getBoundingClientRect().right,s=e.getBoundingClientRect().right;s>t&&(e.style.left=e.offsetLeft-(s-t)+"px")}}validationComplete(e){if(this.parent.isEdit){let t=this.getElemTable(e.element).querySelector("#"+e.inputName+"_Error");t&&("failure"===e.status?(t.style.display="",this.resetElemPosition(t,e)):t.style.display="none")}}createTooltip(e,t,i,s){let r=this.parent.getColumnByField(i),l="Left-Right"===this.parent.getFrozenMode()&&"Normal"===this.parent.editSettings.mode&&"frozen-right"===r.getFreezeTableName()?this.frFormObj.element:this.formObj.element,o=this.parent.getContent().firstElementChild,h=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();h&&(o=this.parent.getMovableVirtualContent());let d,c,p=o.scrollHeight>o.clientHeight||o.scrollWidth>o.clientWidth,u="Dialog"!==this.parent.editSettings.mode,g=Object(n.C)(e,".e-rowcell"),m=Object(n.C)(e,".e-row"),b=this.parent.getContent().querySelector(".e-frozencontent"),f=!1,y=!1,C=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,v=[].slice.call(b?this.parent.getFrozenVirtualContent().querySelectorAll(".e-row"):this.parent.getContent().querySelectorAll(".e-row"));if("Batch"===this.parent.editSettings.mode&&C>1&&v.length>=C&&v[v.length-1].getAttribute("aria-rowindex")===m.getAttribute("aria-rowindex")&&(y=!0),u){if(this.parent.frozenRows){let e=h?this.parent.getFrozenVirtualHeader().querySelector("tbody").children:this.parent.getHeaderTable().querySelector("tbody").children;d=e.length>(parseInt(m.getAttribute("aria-rowindex"),10)||0),f=d&&parseInt(m.getAttribute("aria-rowindex"),10)===e.length-1}(f||C>1&&v.length>=C&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||g.classList.contains("e-lastrowcell")&&!m.classList.contains("e-addedrow"))||y)&&(c=!0)}let w=u?d?this.parent.getHeaderTable():this.parent.getContentTable():Object(n.lb)("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),S=w.getBoundingClientRect(),O=u?this.parent.element.getBoundingClientRect().left:S.left,x=Object(n.C)(e,"td"),j=x?x.getBoundingClientRect():e.parentElement.getBoundingClientRect(),R=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:i+"_Error",styles:"display:"+s+";top:"+((d?j.top+j.height:j.bottom-S.top-(h?b.scrollTop:0))+w.scrollTop+9)+"px;left:"+(j.left-O+w.scrollLeft+j.width/2)+"px;max-width:"+j.width+"px;text-align:center;"});u&&S.left<O&&(R.style.left=parseInt(R.style.left,10)-S.left+O+"px");let D,E=this.parent.createElement("div",{className:"e-tip-content"});E.appendChild(t),c?(D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"}),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):(D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"}),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),R.appendChild(E),R.appendChild(D),(h||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?(("Normal"===this.parent.editSettings.mode?Object(n.C)(e,".e-editcell"):Object(n.C)(e,".e-table")).style.position="relative",R.style.position="absolute","Batch"===this.parent.editSettings.mode||Object(n.C)(e,".e-frozencontent")||Object(n.C)(e,".e-frozenheader")||this.parent.frozenRows&&!h?l.appendChild(R):this.mFormObj.element.appendChild(R)):this.formObj.element.appendChild(R),!c&&u&&o.getBoundingClientRect().bottom<j.bottom+j.height&&(o.scrollTop=o.scrollTop+R.offsetHeight+D.scrollHeight);let I=parseInt(document.defaultView.getComputedStyle(R,null).getPropertyValue("font-size"),10);if(R.getBoundingClientRect().width<j.width&&R.querySelector("label").getBoundingClientRect().height/(1.2*I)>=2&&(R.style.width=R.style.maxWidth),R.style.left=(h||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?x.offsetLeft+(x.offsetWidth/2-R.offsetWidth/2)+"px":parseInt(R.style.left,10)-R.offsetWidth/2+"px",u&&!p&&!this.parent.allowPaging||h||this.parent.frozenRows){o.style.position="static";let e=Object(a.f)(x,R);R.style.top=e.top+j.height+9+"px"}if(c){if(!p||h||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization)R.style.bottom=j.height+9+"px";else{let e=o.scrollWidth>o.offsetWidth?Et():0;R.style.bottom=this.parent.height-o.querySelector("table").offsetHeight-e+j.height+9+"px"}if(v.length<C&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType){let e=(this.parent.frozenRows?this.parent.frozenRows+(v.length-1):v.length-1)*this.parent.getRowHeight(),t=this.parent.getContent().clientHeight-e;R.style.bottom=t+9+"px"}R.style.top=null}}checkColumnIsGrouped(e){return!(e.visible||this.parent.groupSettings.columns.indexOf(e.field)>-1)}static AddEditors(t){e.editCellType=Object(n.K)(e.editCellType,t)}}return e.editCellType={dropdownedit:hs,numericedit:ds,datepickeredit:bs,datetimepickeredit:bs,booleanedit:os,defaultedit:cs,templateedit:ys},e})();class vs{constructor(e){this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=e}static getQuery(e,t){let i=t.generateQuery(!0).requiresCount();return t.isRemote()&&(e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length?i.lazyLoad=[]:i.take(e.pageSettings.totalRecordsCount)),i}getFData(e,t){return Xt(t,{},e,this.foreignKeyData[t.field])[0]}getGridRowModel(e,t,i,s=0){let r=[],n=t.length;if(n){for(let l=0;l<n;l++,s++){let n={isExpand:!1};n.data=t[l],n.index=s,i.childGrid&&("All"===i.hierarchyPrintMode?n.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[s]&&(n.isExpand=i.expandedRows[s].isExpand));let a=new P(n);a.cells=this.generateCells(e,i),r.push(a)}this.processColumns(r)}return r}generateCells(e,t){let i=[];if(t.childGridLevel){let e=t.childGridLevel;for(let t=0;e>t;t++)i.push(this.generateCell({},A.Indent))}for(const s of e)i.push(this.generateCell(s,A.Data));return i}getColumnData(e){let t,i=[],s=e.getForeignKeyColumns();if(s.length){for(let e=0;e<s.length;e++){let t="result"in s[e].dataSource?new l.a(s[e].dataSource.result):s[e].dataSource;i.push(t.executeQuery(new l.g))}t=Promise.all(i).then(e=>{for(let t=0;t<s.length;t++)this.foreignKeyData[s[t].field]=e[t].result})}return t}getHeaders(e,t){this.hideColumnInclude=!!t,this.colDepth=ei(e);let i=[];for(let s=0;s<this.colDepth;s++)i[s]=new P({}),i[s].cells=[];return i=this.processColumns(i),i=this.processHeaderCells(i,e),{rows:i,columns:this.generateActualColumns(e)}}getConvertedWidth(e){let t=parseFloat(e);return-1!==e.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t}generateActualColumns(e,t=[]){for(const i of e)i.commands||(i.columns?(i.visible||this.hideColumnInclude)&&0!==this.getCellCount(i,0)&&this.generateActualColumns(i.columns,t):(i.visible||this.hideColumnInclude)&&t.push(i));return t}processHeaderCells(e,t){let i=t;for(let s=0;s<i.length;s++)i[s].commands||(e=this.appendGridCells(i[s],e,0));return e}appendGridCells(e,t,i){if(e.columns||!1===e.visible&&!this.hideColumnInclude||e.commands){if(e.columns){let s,r=this.getCellCount(e,0);r&&t[i].cells.push(new q({cellType:A.StackedHeader,column:e,colSpan:r}));for(let n=0,l=e.columns.length;n<l;n++)e.columns[n].visible&&!s&&(s=!0),t=this.appendGridCells(e.columns[n],t,i+1)}}else t[i].cells.push(this.generateCell(e,A.Header,this.colDepth-i,i));return t}generateCell(e,t,i,s){let r={visible:e.visible,isDataCell:t===A.Data,column:e,cellType:t,rowSpan:i,index:s};return(!r.rowSpan||r.rowSpan<2)&&delete r.rowSpan,new q(r)}processColumns(e){let t=this.parent,i=[];t.enableColumnVirtualization&&(i=t.getColumnIndexesInView());for(let s=0,r=e.length;s<r;s++)if(t.allowGrouping)for(let n=0,l=t.groupSettings.columns.length;n<l;n++)t.enableColumnVirtualization&&-1===i.indexOf(n)||e[s].cells.splice(0,0,this.generateCell({},A.HeaderIndent));return e}getCellCount(e,t){if(e.columns)for(let i=0;i<e.columns.length;i++)t=this.getCellCount(e.columns[i],t);else(e.visible||this.hideColumnInclude)&&t++;return t}checkAndExport(e,t){Object.keys(e).some(t=>!e[t])||t()}failureHandler(e,t,i){return()=>{e[t.id]=!0,this.checkAndExport(e,i)}}createChildGrid(e,t,i,s){let r=new Qe(this.parent.detailRowModule.getGridModel(e,t,i));e.isPrinting=!1,r.parentDetails={parentID:e.element.id,parentPrimaryKeys:e.getPrimaryKeyFieldNames(),parentKeyField:e.childGrid.queryString,parentKeyFieldValue:Object(n.V)(r.queryString,t.data),parentRowData:t.data};let l=St("child-grid"),a=Object(n.F)("div",{id:l,styles:"display: none"});return document.body.appendChild(a),r.id=l,s[l]=!1,{childGrid:r,element:a}}getGridExportColumns(e){let t=[];for(let i=0,s=e;i<s.length;i++)"checkbox"!==s[i].type&&t.push(s[i]);return t}}class ws{constructor(e){this.valueFormatter=new m(e),this.internationalization=new n.n(e)}returnFormattedValue(e,t){return!Object(n.X)(e.value)&&e.value?this.valueFormatter.getFormatFunction(t)(e.value):""}formatCellValue(e,t){if(e.isForeignKey&&(e.value=Object(n.V)(e.column.foreignKeyValue,Xt(e.column,{},e.value)[0])),"number"===e.column.type&&void 0!==e.column.format&&""!==e.column.format)return e.value||0===e.value?this.internationalization.getNumberFormat({format:e.column.format})(e.value):"";if("boolean"===e.column.type&&""!==e.value)return e.value?"true":"false";if("date"!==e.column.type&&"datetime"!==e.column.type&&"time"!==e.column.type||void 0===e.column.format)return(Object(n.X)(e.column.type)||Object(n.X)(e.value))&&Object(n.X)(e.value)?"":e.value.toString();if("string"==typeof e.value&&(e.value=new Date(e.value)),"string"==typeof e.column.format){let i,s=e.column.format;return i="date"===e.column.type?t?{type:"date",format:s}:{type:"date",skeleton:s}:"time"===e.column.type?t?{type:"time",format:s}:{type:"time",skeleton:s}:t?{type:"dateTime",format:s}:{type:"dateTime",skeleton:s},this.returnFormattedValue(e,i)}if(e.column.format instanceof Object&&void 0===e.column.format.type)return e.value.toString();{let t;return t="date"===e.column.type?{type:e.column.format.type,format:e.column.format.format,skeleton:e.column.format.skeleton}:"time"===e.column.type?{type:"time",format:e.column.format.format,skeleton:e.column.format.skeleton}:{type:"dateTime",format:e.column.format.format,skeleton:e.column.format.skeleton},this.returnFormattedValue(e,t)}}}class Ss{constructor(e,t){this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isElementIdChanged=!1,this.foreignKeyData={},this.gridPool={},this.parent=e,this.helper=new vs(e),this.locator=t,this.l10n=this.locator.getService("localization")}getModuleName(){return"ExcelExport"}init(e){null!==e.element&&""===e.element.id&&(e.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=e,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new ws(e.locale),e.id=St("main-grid"),this.gridPool[e.id]=!1)}Map(e,t,i,s,r,l){let a=e;this.gridPool={},e.childGrid&&(Object(n.X)(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=Jt(e).expandedRows);let o={requestType:"beforeExcelExport",gridObject:a,cancel:!1,isMultipleExport:i,workbook:s,isCsv:r,isBlob:l};return a.trigger("beforeExcelExport",o),o.cancel?new Promise((e,t)=>e()):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new B(a),this.isExporting=!0,this.isBlob=o.isBlob,this.isCsvExport=!!o.isCsv&&o.isCsv,tt(t)&&it(t,a),this.processRecords(a,t,o.isMultipleExport,o.workbook))}exportingSuccess(e){this.isExporting=!1,this.parent.trigger("excelExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),e(this.book)}processRecords(e,t,i,s){if(Object(n.X)(t)||Object(n.X)(t.dataSource)){if(Object(n.X)(t)||"CurrentPage"!==t.exportType){let r=[];return r.push(this.data.getData({},vs.getQuery(e,this.data))),r.push(this.helper.getColumnData(e)),new Promise((n,l)=>{Promise.all(r).then(r=>{this.init(e),this.processInnerRecords(e,t,i,s,r[0]).then(()=>{this.exportingSuccess(n)})}).catch(e=>{l(this.book),this.parent.trigger("actionFailure",e)})})}return new Promise((r,n)=>{this.init(e),this.processInnerRecords(e,t,i,s,this.parent.getCurrentViewRecords()),this.exportingSuccess(r)})}{t.dataSource instanceof l.a||(t.dataSource=new l.a(t.dataSource));let r=t.query?t.query:new l.g;return(Object(n.X)(r.isCountRequired)||e.aggregates)&&(r.isCountRequired=!0),new Promise((n,l)=>{t.dataSource.executeQuery(r).then(r=>{this.init(e),this.processInnerRecords(e,t,i,s,r).then(()=>{this.exportingSuccess(n)})})})}}processInnerRecords(e,t,i,s,r){this.groupedColLength=e.groupSettings.columns.length;let l,a=5,o=[],h=!Object(n.X)(t);return h&&!Object(n.X)(t.multipleExport)&&(this.expType=Object(n.X)(t.multipleExport.type)?"AppendToSheet":t.multipleExport.type,Object(n.X)(t.multipleExport.blankRows)||(a=t.multipleExport.blankRows)),Object(n.X)(s)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[]):"NewSheet"===this.expType?(this.workSheet=s.worksheets,this.rows=[],this.columns=[],this.styles=s.styles):(this.workSheet=[],this.rows=s.worksheets[0].rows,this.columns=s.worksheets[0].columns,this.styles=s.styles,this.rowLength=this.rows[this.rows.length-1].index+a,this.rowLength++),h&&(Object(n.X)(i)?(Object(n.X)(t.header)||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(n.X)(t.footer)||(this.footer=JSON.parse(JSON.stringify(t.footer)))):(Object(n.X)(t.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(n.X)(t.footer)||"AppendToSheet"===this.expType&&i||(this.footer=JSON.parse(JSON.stringify(t.footer))))),this.includeHiddenColumn=!!h&&t.includeHiddenColumn,new Promise((i,s)=>{e.childGridLevel=0,o=this.processGridExport(e,t,r),this.globalResolve=i,this.gridPool[e.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve)}).then(()=>{let r=[];this.organiseRows(o,o[0].index,r),this.rows=this.rows.concat(r),Object(n.X)(this.footer)||("AppendToSheet"===this.expType&&!i||"NewSheet"===this.expType)&&this.processExcelFooter(this.footer);let a={};if(this.columns.length>0&&(a.columns=this.columns),a.rows=this.rows,a.enableRtl=this.parent.enableRtl,this.workSheet.push(a),this.book.worksheets=this.workSheet,this.book.styles=this.styles,e.notify("finalPageSetup",this.book),!i){if(this.isCsvExport){Object(n.W)()&&e.isServerRendered&&(this.book.isServerRendered=e.isServerRendered),h&&!Object(n.X)(t.separator)&&","!==t.separator&&(l=t.separator);let i=new u.a(this.book,"csv",e.locale,e.currencyCode,l);this.isBlob?this.blobPromise=i.saveAsBlob("text/csv"):i.save(h&&t.fileName?t.fileName:"Export.csv")}else{let i=new u.a(this.book,"xlsx",e.locale,e.currencyCode);this.isBlob?this.blobPromise=i.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):i.save(h&&t.fileName?t.fileName:"Export.xlsx")}this.isElementIdChanged&&(e.element.id=""),delete e.expandedRows}return s})}organiseRows(e,t,i){if(!e.length)return t;for(let s=0;s<e.length;s++){let r=e[s],n=r.childRows;n?(r.index=t++,delete r.childRows,i.push(r),t=this.organiseRows(n,t,i)):(r.index=t++,i.push(r))}return t}processGridExport(e,t,i){let s=[],r=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(n.X)(t)||Object(n.X)(t.theme)||(this.theme=t.theme),e.childGrid&&!Object(n.X)(t)&&(e.hierarchyPrintMode=t.hierarchyExportMode||"Expanded");let a=new vs(e),o=tt(t)?pt(t.columns,e.enableColumnVirtualization):a.getGridExportColumns(r?e.getColumns():e.columns),h=a.getHeaders(o,this.includeHiddenColumn);return s=this.processHeaderContent(e,h,e.groupSettings.columns.length,s),s=Object(n.X)(t)||Object(n.X)(t.dataSource)||t.dataSource instanceof l.a?Object(n.X)(t)||"CurrentPage"!==t.exportType?this.processRecordContent(e,i,h,t,void 0,s,a):this.processRecordContent(e,i,h,t,e.currentViewData,s,a):this.processRecordContent(e,i,h,t,t.dataSource,s,a),e.notify("export-DataBound",{excelRows:s,type:"excel"}),s}processRecordContent(e,t,i,s,r,l,a){let o;return o=!Object(n.X)(r)&&r.length?r:t.result,Object(n.X)(o.level)?this.processRecordRows(e,o,i,0,0,s,l,a):this.processGroupedRows(e,o,i,o.level,0,s,l,a),Object(n.X)(t.aggregates)||(Object(n.X)(r)?this.processAggregates(e,t.result.GroupGuid?t.result.records:t.result,l):this.processAggregates(e,t.result,l,r)),l}processGroupedRows(e,t,i,s,r,l,a,o){for(let h of t){let d=[],c={};c.index=1+s;let p=e.getColumnByField(h.field),u={value:h.key,column:p,style:void 0,isForeignKey:p.isForeignColumn()},g=e.getColumnByField(h.field).headerText+": "+(p.enableGroupByFormat?h.key:this.exportValueFormatter.formatCellValue(u))+" - ";g+=h.count>1?h.count+" items":h.count+" item";let m={captionText:g,type:this.isCsvExport?"CSV":"Excel"};this.parent.trigger("exportGroupCaption",m),c.value=m.captionText,c.style=this.getCaptionThemeStyle(this.theme);let b=new G(e).generateRows(h);if(this.fillAggregates(e,b,t.level+t.childLevels,a,this.rowLength),d.push(c),a[a.length-1].cells.length>0){let e=t.level+t.childLevels+b[0].cells.length,r=0;for(let t of a[a.length-1].cells)t.index<e&&(e=t.index),t.index>r&&(r=t.index),d[d.length-1].index!==t.index&&d.push(t);for(e-c.index>1&&(c.colSpan=e-c.index);r<i.columns.length+s+t.childLevels;){let e={};e.index=r+1,e.style=this.getCaptionThemeStyle(this.theme),d.push(e),r++}}else{let e=0;for(let t of i.columns)t.visible&&e++;c.colSpan=t.childLevels+e}a[a.length-1].cells=d,this.rowLength++,this.groupedColLength<8&&s>1&&(a[a.length-1].grouping={outlineLevel:s-1,isCollapsed:!0}),!Object(n.X)(t.childLevels)&&t.childLevels>0?this.processGroupedRows(e,h.items,i,h.items.level,r,l,a,o):(r=this.processRecordRows(e,h.items,i,s,r,l,a,o),this.processAggregates(e,h,a,void 0,s,!0))}}processRecordRows(e,t,i,s,r,l,a,o){let h=1,d=[],c=o.getGridRowModel(i.columns,t,e,r);for(const p of c){d=[],r++,h=1;for(let i=0,r=p.cells.length;i<r;i++){let t=p.cells[i];if(t.cellType!==A.Data)continue;let r,l=t.column,a=l.field,c=Object(n.X)(a)?"":l.valueAccessor(a,p.data,l),u=Object(n.X)(c)?"":c;if(l.isForeignColumn&&l.isForeignColumn()&&(r=o.getFData(u,l),u=Object(n.V)(l.foreignKeyValue,r)),!Object(n.X)(u)){let t={},i={data:p.data,column:l,foreignKeyData:r,value:u,style:void 0,colSpan:1,cell:t};if(e.trigger("excelQueryCellInfo",i),t=i.cell,t.index=h+s+e.childGridLevel,t.value=i.value,""===i.data&&e.childGridLevel&&1===h&&(i={style:{hAlign:"left"}},t.colSpan=e.getVisibleColumns().length,t.value=this.l10n.getConstant("EmptyRecord")),i.colSpan>1&&(t.colSpan=i.colSpan),Object(n.X)(i.style))t.style={name:e.element.id+"column"+(h+s)};else{let r=this.getColumnStyle(e,h+s);t.style=this.mergeOptions(this.styles[r],i.style)}d.push(t)}h++}let t={index:this.rowLength++,cells:d};if(this.groupedColLength<8&&s>0?(t.grouping={outlineLevel:s,isCollapsed:!0},a.push(t)):a.push(t),!Object(n.X)(e.childGrid)){e.isPrinting=!0;let i=!Object(n.X)(l)&&l.exportType?l.exportType:"AllPages",s=this.helper.createChildGrid(e,p,i,this.gridPool),r=s.childGrid,a=s.element;r.actionFailure=o.failureHandler(this.gridPool,r,this.globalResolve),r.childGridLevel=e.childGridLevel+1,this.parent.trigger("exportdetaildatabound",{childGrid:r,row:p,exportProperties:l}),r.beforeDataBound=this.childGridCell(t,r,l,p),r.appendTo(a)}e.notify("export-RowDataBound",{rowObj:p,type:"excel",excelRows:a})}return r}childGridCell(e,t,i,s){return r=>{t.beforeDataBound=null,r.cancel=!0,0===r.result.length&&(r.result=[""]),e.childRows=this.processGridExport(t,i,r);let l=this.parent.groupSettings.columns.length,a=e.childRows;for(let e=0;e<a.length;e++)a[e].grouping={outlineLevel:l+t.childGridLevel,isCollapsed:!s.isExpand,isHidden:!s.isExpand};return t.destroy(),Object(n.I)(t.element),this.gridPool[t.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve),e}}processAggregates(e,t,i,s,r,l){let a=new W(e),o=a.getColumns();o=o.filter(e=>Object(n.X)(e.commands)&&"checkbox"!==e.type),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo();let h=void 0;if(h=Object(n.X)(s)?t:s,void 0===r&&(r=0),e.groupSettings.columns.length>0&&l){let t=new X(e).generateRows(h,{level:h.level});t.length>0&&(i=this.fillAggregates(e,t,r,i))}else{r=e.groupSettings.columns.length>0&&!l?e.groupSettings.columns.length:r;let s=a.generateRows(h,t.aggregates,null,null,o);s.length>0&&!l&&(i=this.fillAggregates(e,s,r,i))}return i}fillAggregates(e,t,i,s,r){for(let l of t){let t=[],a=0;for(let s of l.cells){let o={};if(s.cellType!==A.DetailFooterIntent&&(s.visible||this.includeHiddenColumn))if(a++,s.isDataCell){let r=!Object(n.X)(s.column.footerTemplate),h=!Object(n.X)(s.column.groupFooterTemplate),d=!Object(n.X)(s.column.groupCaptionTemplate);if(o.index=a+i+e.childGridLevel,r)o.value=this.getAggreateValue(A.Summary,s.column.footerTemplate,s,l);else if(h)o.value=this.getAggreateValue(A.GroupSummary,s.column.groupFooterTemplate,s,l);else if(d)o.value=this.getAggreateValue(A.CaptionSummary,s.column.groupCaptionTemplate,s,l);else for(let e of Object.keys(l.data[s.column.field]))e===s.column.type&&(Object(n.X)(l.data[s.column.field].Sum)?Object(n.X)(l.data[s.column.field].Average)?Object(n.X)(l.data[s.column.field].Max)?Object(n.X)(l.data[s.column.field].Min)?Object(n.X)(l.data[s.column.field].Count)?Object(n.X)(l.data[s.column.field].TrueCount)?Object(n.X)(l.data[s.column.field].FalseCount)?Object(n.X)(l.data[s.column.field].Custom)||(o.value=l.data[s.column.field].Custom):o.value=l.data[s.column.field][s.column.field+" - falsecount"]:o.value=l.data[s.column.field][s.column.field+" - truecount"]:o.value=l.data[s.column.field][s.column.field+" - count"]:o.value=l.data[s.column.field][s.column.field+" - min"]:o.value=l.data[s.column.field][s.column.field+" - max"]:o.value=l.data[s.column.field][s.column.field+" - average"]:o.value=l.data[s.column.field][s.column.field+" - sum"]);o.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(s.column,o.style,s.column.field);let c=s.attributes.style;c.textAlign&&(o.style.hAlign=c.textAlign.toLowerCase()),this.parent.trigger("excelAggregateQueryCellInfo",{row:l,type:r?"Footer":h?"GroupFooter":"GroupCaption",style:o}),t.push(o)}else void 0===r&&(o.index=a+i+e.childGridLevel,o.style=this.getCaptionThemeStyle(this.theme),t.push(o))}if(Object(n.X)(r)){let e={};if(this.groupedColLength<8&&this.groupedColLength>0){let i={outlineLevel:s[s.length-1].grouping.outlineLevel,isCollapsed:!0};e={index:this.rowLength++,cells:t,grouping:i}}else e={index:this.rowLength++,cells:t};s.push(e)}else s.push({index:r,cells:t})}return s}aggregateStyle(e,t,i){let s=this.parent.getColumnByField(i);if("object"==typeof e.format){let i=e.format;t.numberFormat=Object(n.X)(i.format)?i.skeleton:i.format,Object(n.X)(i.type)||(t.type=i.type.toLowerCase())}else t.numberFormat=e.format;!Object(n.X)(s)&&Object(n.X)(t.type)&&(t.type=s.type.toLowerCase())}getAggreateValue(e,t,i,s){let r,l={};l[Object(n.P)(A,i.cellType)]=Object(n.E)(t);let a=s.data[i.column.field?i.column.field:i.column.columnName];return this.parent.isReact||this.parent.isVue?(r=l[Object(n.P)(A,i.cellType)](a,this.parent),this.parent.isReact&&this.parent.renderTemplates()):r=l[Object(n.P)(A,i.cellType)](a),r[0].textContent}mergeOptions(e,t){let i={},s=Object.keys(e);for(let r=0;r<s.length;r++)"name"!==s[r]&&(i[s[r]]=e[s[r]]);s=Object.keys(t);for(let r=0;r<s.length;r++)"name"!==s[r]&&(i[s[r]]=t[s[r]]);return i}getColumnStyle(e,t){let i=0;for(let s of this.styles){if(s.name===e.element.id+"column"+t)return i;i++}}processHeaderContent(e,t,i,s){let r=t.rows,l=t.columns,a=[];if(i>0){let e=0;for(;e!==i;)this.columns.push({index:e+1,width:30}),e++}for(let o=0;o<r.length;o++){let t=1+i,l=[];for(let i=0;i<r[o].cells.length;i++){let s={},h={},d=r[o].cells[i];if(d.cellType===A.HeaderIndent||d.cellType===A.DetailHeader)continue;let c={contains:!0,index:1};for(;c.contains;)if(c=this.getIndex(a,1,t),t=c.index,!c.contains){h.index=c.index+e.childGridLevel;break}if(!Object(n.X)(d.rowSpan)&&1!==d.rowSpan){h.rowSpan=d.rowSpan;for(let e=1;e<d.rowSpan+1;e++){let i={rowIndex:0,columnIndex:0};i.rowIndex=e,i.columnIndex=t,a.push(i)}}Object(n.X)(d.colSpan)||1===d.colSpan||(h.colSpan=d.colSpan,t=t+h.colSpan-1),h.value=d.column.headerText,s=this.getHeaderThemeStyle(this.theme),Object(n.X)(d.column.textAlign)||(s.hAlign=d.column.textAlign.toLowerCase()),Object(n.X)(d.column.headerTextAlign)||(s.hAlign=d.column.headerTextAlign.toLowerCase());let p={cell:h,gridCell:d,style:s};e.trigger("excelHeaderQueryCellInfo",p),h.style=p.style,l.push(h),t++}s.push({index:this.rowLength++,cells:l})}for(let n=0;n<l.length;n++)this.parseStyles(e,l[n],this.getRecordThemeStyle(this.theme),i+n+1);return s}getHeaderThemeStyle(e){let t={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return Object(n.X)(e)||Object(n.X)(e.header)||(t=this.updateThemeStyle(e.header,t)),t}updateThemeStyle(e,t){return Object(n.K)(t,e)}getCaptionThemeStyle(e){let t={fontSize:13,backColor:"#F6F6F6"};return Object(n.X)(e)||Object(n.X)(e.caption)||(t=this.updateThemeStyle(e.caption,t)),t}getRecordThemeStyle(e){let t={fontSize:13,borders:{color:"#E0E0E0"}};return Object(n.X)(e)||Object(n.X)(e.record)||(t=this.updateThemeStyle(e.record,t)),t}processExcelHeader(e){if(!Object(n.X)(e.rows)&&("NewSheet"===this.expType||1===this.rowLength)){let t;this.rowLength=void 0===e.headerRows?e.rows.length:e.headerRows,t=this.rowLength<e.rows.length?this.rowLength:e.rows.length,this.rowLength++;for(let i=0;i<t;i++){let t=e.rows[i];(null===t.index||Object(n.X)(t.index))&&(t.index=i+1),this.updatedCellIndex(t)}}}updatedCellIndex(e){let t=e.cells.length;for(let i=0;i<t;i++){let t=e.cells[i];(null===t.index||Object(n.X)(t.index))&&(t.index=i+1)}this.rows.push(e)}processExcelFooter(e){if(!Object(n.X)(e.rows)){let t;void 0===e.footerRows?this.rowLength+=e.rows.length:e.footerRows>e.rows.length?(this.rowLength+=e.footerRows-e.rows.length,t=e.rows.length):t=e.footerRows;for(let i=0;i<t;i++){let t=e.rows[i];null==t.index?t.index=this.rowLength++:t.index+=this.rowLength,this.updatedCellIndex(t)}}}getIndex(e,t,i){for(let s of e)if(s.rowIndex===t&&s.columnIndex===i)return{contains:!0,index:i+=1};return{contains:!1,index:i}}parseStyles(e,t,i,s){if(!Object(n.X)(t.format))if("object"==typeof t.format){let e=t.format;i.numberFormat=Object(n.X)(e.format)?e.skeleton:e.format,Object(n.X)(e.type)||(i.type=e.type.toLowerCase())}else i.numberFormat=t.format,i.type=t.type;Object(n.X)(t.textAlign)||(i.hAlign=t.textAlign.toLowerCase()),Object.keys(i).length>0&&(i.name=e.element.id+"column"+s,this.styles.push(i)),Object(n.X)(t.width)||this.columns.push({index:s+e.childGridLevel,width:"number"==typeof t.width?t.width:this.helper.getConvertedWidth(t.width)})}destroy(){}}class Os{constructor(e){this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.headerOnPages=[],this.drawPosition={xPosition:0,yPosition:0},this.parent=e,this.helper=new vs(e),this.gridPool={}}getModuleName(){return"PdfExport"}init(e){this.exportValueFormatter=new ws(e.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=e,this.isGrouping=!1,this.isExporting=!0,e.id=St("main-grid"),this.gridPool[e.id]=!1,this.pdfPageSettings=new g.m}exportWithData(e,t,i,s,r,l,a){this.init(e),this.pdfDocument=Object(n.X)(t)?new g.e:t,this.processExport(e,s,r,l).then(()=>{this.isExporting=!1,e.trigger("pdfExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),i(this.pdfDocument)}).catch(e=>{a(this.pdfDocument),this.parent.trigger("actionFailure",e)})}Map(e,t,i,s,r){this.data=new B(this.parent),this.isBlob=r,this.gridPool={},e.childGrid&&(Object(n.X)(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=Jt(e).expandedRows);let a={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0}};if(Object(n.W)()||(a.gridObject=e),e.trigger("beforePdfExport",a),!0===a.cancel)return new Promise((e,t)=>e());if(tt(t)&&it(t,e),this.headerOnPages=a.headerPageNumbers,this.drawPosition=a.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),!Object(n.X)(t)&&!Object(n.X)(t.dataSource)&&t.dataSource instanceof l.a)return new Promise((r,n)=>{t.dataSource.executeQuery(new l.g).then(l=>{this.exportWithData(e,s,r,l,t,i,n)})});if(Object(n.X)(t)||"CurrentPage"!==t.exportType){let r=[];return r.push(this.data.getData({},vs.getQuery(e,this.data))),r.push(this.helper.getColumnData(e)),new Promise((l,a)=>{Promise.all(r).then(r=>{this.init(e),this.pdfDocument=Object(n.X)(s)?new g.e:s,this.processExport(e,r[0],t,i).then(()=>{this.isExporting=!1,e.trigger("pdfExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),l(this.pdfDocument)}).catch(e=>{a(this.pdfDocument),this.parent.trigger("actionFailure",e)})})})}return new Promise((r,n)=>{this.exportWithData(e,s,r,this.parent.getCurrentViewRecords(),t,i,n)})}processExport(e,t,i,s){let r,l=this.pdfDocument.sections.add();this.processSectionExportProperties(l,i);let a=l.pages.add();return new Promise((s,n)=>{r=this.processGridExport(e,t,i),this.globalResolve=s,this.gridPool[e.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve)}).then(()=>(r.draw(a,this.drawPosition.xPosition,this.drawPosition.yPosition),this.drawHeader(i),s||(this.isBlob?this.blobPromise=this.pdfDocument.save():!Object(n.X)(i)&&i.fileName?this.pdfDocument.save(i.fileName):this.pdfDocument.save("Export.pdf"),this.pdfDocument.destroy(),delete e.expandedRows),this.pdfDocument))}processSectionExportProperties(e,t){return Object(n.X)(t)||Object(n.X)(t.pageOrientation)&&Object(n.X)(t.pageSize)||(this.pdfPageSettings.orientation="Landscape"===t.pageOrientation?g.l.Landscape:g.l.Portrait,this.pdfPageSettings.size=this.getPageSize(t.pageSize),e.setPageSettings(this.pdfPageSettings)),e}processGridExport(e,t,i){let s=!0,r=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(n.X)(i)||(this.gridTheme=i.theme,Object(n.W)()&&!Object(n.X)(this.gridTheme)&&this.getGridPdfFont(this.gridTheme),s=!!Object(n.X)(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);let l=new vs(e),a=this.processExportProperties(i,t.result),o=tt(i)?pt(i.columns,e.enableColumnVirtualization):l.getGridExportColumns(r?e.getColumns():e.columns);o=o.filter(e=>Object(n.X)(e.commands));let h=!1;e.groupSettings.columns.length&&(h=!0),e.childGrid&&!Object(n.X)(i)&&(e.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");let d=new g.h,c=this.getHeaderThemeStyle(),p=c.border,u=c.font,m=c.brush,b=l.getHeaders(o,this.hideColumnInclude),f=b.columns;d=this.processGridHeaders(e.groupSettings.columns.length,d,b.rows,f,p,u,m,e,s,o),this.setColumnProperties(f,d,l,e,s);let y=this.getSummaryCaptionThemeStyle();if(!Object(n.X)(a)&&a.length){if(h?(Object(n.X)(y.border)||(p=y.border),this.processGroupedRecords(d,a,f,e,p,0,y.font,y.brush,y.backgroundBrush,t,i,l,0)):this.processRecord(p,f,e,a,d,0,i,l,0),!Object(n.X)(t.aggregates)){let i,s=new W(e),r=s.getColumns();r=r.filter(e=>Object(n.X)(e.commands)&&"checkbox"!==e.type),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo(),i=this.customDataSource?s.generateRows(a,t.aggregates):this.currentViewData?s.generateRows(this.parent.getCurrentViewRecords(),t.aggregates):h?s.generateRows(a.records,t.aggregates):s.generateRows(t.result,t.aggregates,null,null,r),this.processAggregates(i,d,p,y.font,y.brush,y.backgroundBrush,!1)}}else d.rows.addRow().style.setBorder(p);return d}getSummaryCaptionThemeStyle(){if(Object(n.X)(this.gridTheme)||Object(n.X)(this.gridTheme.caption))return{font:new g.q(g.f.Helvetica,9.75),brush:new g.p(new g.c(0,0,0)),backgroundBrush:new g.p(new g.c(246,246,246))};{let e=Object(n.X)(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,t=Object(n.X)(this.gridTheme.caption.fontName)?g.f.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),i=this.getFontStyle(this.gridTheme.caption),s=new g.c(0,0,0);if(!Object(n.X)(this.gridTheme.caption.fontColor)){let e=this.hexToRgb(this.gridTheme.caption.fontColor);s=new g.c(e.r,e.g,e.b)}let r=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,l=new g.q(t,e,i);return Object(n.X)(this.gridTheme.caption.font)||(l=this.gridTheme.caption.font),{font:l,brush:new g.p(s),backgroundBrush:new g.p(new g.c(246,246,246)),border:r}}}getGridPdfFont(e){let t=0;if(e.header&&e.header.font){let i=e.header.font.fontFamily,s=e.header.font.fontSize,r=e.header.font.fontStyle;if(t=Object(n.X)(g.g[r])?0:g.g[r],e.header.font.isTrueType)e.header.font=new g.t(i,s,t);else{let r=Object(n.X)(i)?g.f.Helvetica:this.getFontFamily(i);e.header.font=new g.q(r,s,t)}}if(e.caption&&e.caption.font){let i=e.caption.font.fontFamily,s=e.caption.font.fontSize,r=e.caption.font.fontStyle;if(t=Object(n.X)(g.g[r])?0:g.g[r],e.caption.font.isTrueType)e.caption.font=new g.t(i,s,t);else{let r=Object(n.X)(i)?g.f.Helvetica:this.getFontFamily(i);e.caption.font=new g.q(r,s,t)}}if(e.record&&e.record.font){let i=e.record.font.fontFamily,s=e.record.font.fontSize,r=e.record.font.fontStyle;if(t=Object(n.X)(g.g[r])?0:g.g[r],e.record.font.isTrueType)e.record.font=new g.t(i,s,t);else{let r=Object(n.X)(i)?g.f.Helvetica:this.getFontFamily(i);e.record.font=new g.q(r,s,t)}}}getHeaderThemeStyle(){let e=new g.b;if(Object(n.X)(this.gridTheme)||Object(n.X)(this.gridTheme.header))return e.all=new g.o(new g.c(234,234,234)),{border:e,font:new g.q(g.f.Helvetica,10.5),brush:new g.p(new g.c(102,102,102))};{let e=Object(n.X)(this.gridTheme.header.fontName)?g.f.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),t=this.getFontStyle(this.gridTheme.header),i=Object(n.X)(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,s=new g.c;if(!Object(n.X)(this.gridTheme.header.fontColor)){let e=this.hexToRgb(this.gridTheme.header.fontColor);s=new g.c(e.r,e.g,e.b)}let r=new g.q(e,i,t);return Object(n.X)(this.gridTheme.header.font)||(r=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:r,brush:new g.p(s)}}}processGroupedRecords(e,t,i,s,r,l,a,o,h,d,c,p,u){let m=l;for(let b of t){let l=e.rows.addRow(),f=s.getColumnByField(b.field),y={value:b.key,column:f,style:void 0,isForeignKey:f.isForeignColumn()},C=this.parent.getColumnByField(b.field).headerText+": "+(f.enableGroupByFormat?b.key:this.exportValueFormatter.formatCellValue(y))+" - "+b.count+(t.count>1?" items":" item");this.parent.trigger("exportGroupCaption",{captionText:C,type:"PDF"},f=>{let y;l.cells.getCell(m).value=f.captionText,l.cells.getCell(m+1).style.stringFormat=new g.r(g.s.Left),l.style.setBorder(r),l.style.setFont(a),l.style.setTextBrush(o),l.style.setBackgroundBrush(h);let C=new G(s);y=Object(n.X)(b.items.records)?C.generateRows(b.items,b):C.generateRows(b.items.records,b),Object(n.X)(y)||0!==y.length||(l.cells.getCell(m+1).columnSpan=e.columns.count-(m+1)),!Object(n.X)(t.childLevels)&&t.childLevels>0?(this.processAggregates(y,e,r,a,o,h,!0,l,m),this.processGroupedRecords(e,b.items,i,s,r,m+1,a,o,h,d,c,p,u),y=new X(s).generateRows(b.items.records,b),this.processAggregates(y,e,r,a,o,h,!1)):(this.processAggregates(y,e,r,a,o,h,!0,l,m),u=this.processRecord(r,i,s,b.items,e,m+1,c,p,u),y=new X(s).generateRows(b.items,b),this.processAggregates(y,e,r,a,o,h,!1,null,null,!0))})}}processGridHeaders(e,t,i,s,r,l,a,o,h,d){let c=s.length+e,p=ei(d),u=d,g=0;this.parent.allowGrouping&&(g=this.parent.groupSettings.columns.length),t.columns.add(c),t.headers.add(i.length);let m=(e,s,o,h,d)=>{let c=t.headers.getHeader(e),p=c.cells.getCell(s),u=i[e].cells[s];Object(n.X)(o.headerTextAlign)||(p.style.stringFormat=this.getHorizontalAlignment(o.headerTextAlign)),h>0&&(p.rowSpan=h,p.style.stringFormat=this.getVerticalAlignment("Bottom",p.style.stringFormat,o.textAlign)),d>0&&(p.columnSpan=d),c.style.setBorder(r),c.style.setFont(l),c.style.setTextBrush(a),p.value=o.headerText,Object(n.X)(u)||u.cellType!==A.HeaderIndent&&u.cellType!==A.DetailHeader||(p.value="",p.width=20),this.parent.trigger("pdfHeaderQueryCellInfo",{cell:p,gridCell:u,style:p.style})},b=(e,t,i,s,r,n)=>{let l=0;for(let a=0;a<e.length;a++)if(n&&(l=l+i+(0===a?0:-1),s=l,i=0),e[a].columns&&e[a].columns.length){let n=b(e[a].columns,t-1,0,a+s,r+1,!1);m(r,a+s,e[a],0,n),i+=n,s=s+n-1}else(e[a].visible||this.hideColumnInclude)&&(i++,m(r,a+s+g,e[a],t,0));return i};return b(u,p,0,0,0,!0),t.columns.count>=6&&h&&(t.style.allowHorizontalOverflow=!0),t}processExportProperties(e,t){if(Object(n.X)(e))this.currentViewData=!1,this.customDataSource=!1;else{Object(n.X)(e.theme)||(this.gridTheme=e.theme);let i=this.pdfPageSettings.size;if(this.drawHeader(e),!Object(n.X)(e.footer)){let t=e.footer,s=new g.v(0,i.width-80-.75*t.fromBottom),r=new g.x(i.width-80,.75*t.height),n=new g.w(s,r);this.pdfDocument.template.bottom=this.drawPageTemplate(new g.n(n),t)}Object(n.X)(e.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=e.includeHiddenColumn),Object(n.X)(e.dataSource)?Object(n.X)(e.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===e.exportType?(t=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(e.dataSource instanceof l.a||(t=e.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return t}drawHeader(e){let t=this.pdfPageSettings.size;if(!Object(n.X)(e)&&!Object(n.X)(e.header)){let i=e.header,s=new g.v(0,i.fromTop),r=new g.x(t.width-80,.75*i.height),n=new g.w(s,r);if(this.headerOnPages.length){let e=this.drawPageTemplate(new g.n(n),i);this.headerOnPages.filter(t=>{t-1>=0&&t-1<this.pdfDocument.pages.count-1&&this.pdfDocument.pages.getPageByIndex(t-1).graphics.drawPdfTemplate(e.template,new g.v(0,0))})}else this.pdfDocument.template.top=this.drawPageTemplate(new g.n(n),i)}}drawPageTemplate(e,t){for(let i of t.contents)switch(this.processContentValidation(i),i.type){case"Text":if(""===i.value||null==i.value||"string"!=typeof i.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,i);break;case"PageNumber":this.drawPageNumber(e,i);break;case"Image":if(null==i.src||""===i.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,i);break;case"Line":this.drawLine(e,i);break;default:throw new Error("Please set valid content type...")}return e}processContentValidation(e){if(null==e.type)throw new Error("please set valid content type...");if("Line"===e.type){if(null==e.points)throw new Error("please enter valid points in "+e.type+" content...");if(null==e.points.x1||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if(null==e.points.y1||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if(null==e.points.x2||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if(null==e.points.y2||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if(null==e.position)throw new Error("please enter valid position in "+e.type+" content...");if(null==e.position.x||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if(null==e.position.y||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}}drawText(e,t){let i=this.getFont(t),s=this.getBrushFromContent(t),r=null;if(!Object(n.X)(t.style.textPenColor)){let e=this.hexToRgb(t.style.textPenColor);r=new g.o(new g.c(e.r,e.g,e.b))}null==s&&null==r&&(s=new g.p(new g.c(0,0,0)));let l=t.value.toString(),a=.75*t.position.x,o=.75*t.position.y,h=new g.r,d=this.setContentFormat(t,h);null===d||Object(n.X)(d.format)||Object(n.X)(d.size)?e.graphics.drawString(l,i,r,s,a,o,h):e.graphics.drawString(l,i,r,s,a,o,d.size.width,d.size.height,d.format)}drawPageNumber(e,t){let i=this.getFont(t),s=null;if(Object(n.X)(t.style.textBrushColor))s=new g.p(new g.c(0,0,0));else{let e=this.hexToRgb(t.style.textBrushColor);s=new g.p(new g.c(e.r,e.g,e.b))}let r,l,a=new g.k(i,s);if(a.numberStyle=this.getPageNumberStyle(t.pageNumberType),Object(n.X)(t.format))l="{0}",r=new g.d(i,s,l,a);else if(-1!==t.format.indexOf("$total")&&-1!==t.format.indexOf("$current")){let e=new g.j(i);e.numberStyle=this.getPageNumberStyle(t.pageNumberType),t.format.indexOf("$total")>t.format.indexOf("$current")?(l=t.format.replace("$current","0"),l=l.replace("$total","1")):(l=t.format.replace("$current","1"),l=l.replace("$total","0")),r=new g.d(i,s,l,a,e)}else if(-1!==t.format.indexOf("$current")&&-1===t.format.indexOf("$total"))l=t.format.replace("$current","0"),r=new g.d(i,s,l,a);else{let e=new g.j(i);l=t.format.replace("$total","0"),r=new g.d(i,s,l,e)}let o=.75*t.position.x,h=.75*t.position.y,d=this.setContentFormat(t,r.stringFormat);null===d||Object(n.X)(d.format)||Object(n.X)(d.size)||(r.stringFormat=d.format,r.bounds=new g.w(o,h,d.size.width,d.size.height)),r.draw(e.graphics,o,h)}drawImage(e,t){let i=.75*t.position.x,s=.75*t.position.y,r=Object(n.X)(t.size)?void 0:.75*t.size.width,l=Object(n.X)(t.size)?void 0:.75*t.size.height,a=new g.a(t.src);Object(n.X)(r)?e.graphics.drawImage(a,i,s):e.graphics.drawImage(a,i,s,r,l)}drawLine(e,t){let i=.75*t.points.x1,s=.75*t.points.y1,r=.75*t.points.x2,l=.75*t.points.y2,a=this.getPenFromContent(t);Object(n.X)(t.style)||null===t.style||(Object(n.X)(t.style.penSize)||null===t.style.penSize||"number"!=typeof t.style.penSize||(a.width=.75*t.style.penSize),a.dashStyle=this.getDashStyle(t.style.dashStyle)),e.graphics.drawLine(a,i,s,r,l)}processAggregates(e,t,i,s,r,l,a,o,h,d){for(let c of e){let e=-1,p=0,u=!0,g=[];for(let i=0;i<t.columns.count;i++){let t=c.cells[p];if(t.cellType!==A.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===t.visible;)t.cellType!==A.DetailFooterIntent&&(Object(n.X)(o)||Object(n.X)(o.cells.getCell(i).value)?g.push(""):(this.parent.trigger("pdfAggregateQueryCellInfo",{row:c,type:"GroupCaption",style:o.cells}),g.push(""),g.push(o.cells.getCell(i).value),u=!1,a||(i+=1)),i+=1,p+=1,t=c.cells[p]);for(;!Object(n.X)(t.visible)&&!t.visible;)p+=1,t=c.cells[p]}if(t.isDataCell){let s={};if(Object(n.X)(t.column.footerTemplate)&&Object(n.X)(t.column.groupCaptionTemplate)&&Object(n.X)(t.column.groupFooterTemplate)){let e=this.getSummaryWithoutTemplate(c.data[t.column.field]);Object(n.X)(e)||g.push(e)}else{let r,l=this.getTemplateFunction(s,i,e,t);s=l.templateFunction,e=l.leastCaptionSummaryIndex;let a=c.data[t.column.field?t.column.field:t.column.columnName];this.parent.isReact||this.parent.isVue?(r=s[Object(n.P)(A,t.cellType)](a,this.parent),this.parent.isReact&&this.parent.renderTemplates()):r=s[Object(n.P)(A,t.cellType)](a),g.push(r[0].textContent),u=!1}}else g.push("");u&&""!==g[i]&&!Object(n.X)(g[i])&&null!==g[i]&&(u=!1),p+=1}else i--,p++}if(a)for(let t=this.parent.groupSettings.columns.length+1;t<g.length-1;t++)g[t]=g[t+1];if(!u)if(a)for(let i=0;i<t.columns.count;i++)o.cells.getCell(i).value=g[i].toString(),i===h+1&&-1!==e&&1!==e?o.cells.getCell(i).columnSpan=e-(h+1):i===h+1&&-1===e&&(o.cells.getCell(i).columnSpan=t.columns.count-(h+1));else{let e=t.rows.addRow();e.style.setBorder(i),e.style.setFont(s),e.style.setTextBrush(r),e.style.setBackgroundBrush(l),this.parent.trigger("pdfAggregateQueryCellInfo",{row:c,type:d?"GroupFooter":"Footer",style:e.cells});for(let i=0;i<t.columns.count;i++)e.cells.getCell(i).value=g[i].toString()}}}getTemplateFunction(e,t,i,s){return Object(n.X)(s.column.footerTemplate)||s.cellType!==A.Summary?Object(n.X)(s.column.groupCaptionTemplate)?e[Object(n.P)(A,A.GroupSummary)]=Object(n.E)(s.column.groupFooterTemplate):(-1===i&&(i=t),e[Object(n.P)(A,A.CaptionSummary)]=Object(n.E)(s.column.groupCaptionTemplate)):e[Object(n.P)(A,A.Summary)]=Object(n.E)(s.column.footerTemplate),{templateFunction:e,leastCaptionSummaryIndex:i}}getSummaryWithoutTemplate(e){return Object(n.X)(e.Sum)?Object(n.X)(e.Average)?Object(n.X)(e.Max)?Object(n.X)(e.Min)?Object(n.X)(e.Count)?Object(n.X)(e.TrueCount)?Object(n.X)(e.FalseCount)?Object(n.X)(e.Custom)?void 0:e.Custom:e.FalseCount:e.TrueCount:e.Count:e.Min:e.Max:e.Average:e.Sum}setColumnProperties(e,t,i,s,r){let l=s.groupSettings.columns.length;for(let n=0;n<l;n++)t.columns.getColumn(n).width=20;for(let a=0;a<e.length;a++)Object(n.X)(e[a].textAlign)||(t.columns.getColumn(a+l).format=this.getHorizontalAlignment(e[a].textAlign)),t.style.allowHorizontalOverflow&&!Object(n.X)(e[a].width)&&r&&(t.columns.getColumn(a+l).width="number"==typeof e[a].width?.75*e[a].width:.75*i.getConvertedWidth(e[a].width))}setRecordThemeStyle(e,t){if(Object(n.X)(this.gridTheme)||Object(n.X)(this.gridTheme.record))e.style.setTextBrush(new g.p(new g.c(0,0,0)));else{let t=Object(n.X)(this.gridTheme.record.fontName)?g.f.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),i=Object(n.X)(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,s=this.getFontStyle(this.gridTheme.record),r=new g.q(t,i,s);Object(n.X)(this.gridTheme.record.font)||(r=this.gridTheme.record.font),e.style.setFont(r);let l=new g.c;if(!Object(n.X)(this.gridTheme.record.fontColor)){let e=this.hexToRgb(this.gridTheme.record.fontColor);l=new g.c(e.r,e.g,e.b)}e.style.setTextBrush(new g.p(l))}let i=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):t;return e.style.setBorder(i),e}processRecord(e,t,i,s,r,l,a,o,h){let d=o.getGridRowModel(t,s,i,h);for(const c of d){h++;let t=this.setRecordThemeStyle(r.rows.addRow(),e),s=c.cells.length;for(let e=0;e<s;e++){let s=c.cells[e];if(s.cellType!==A.Data)continue;let r,l=s.column,a=l.field,h=Object(n.X)(a)?"":l.valueAccessor(a,c.data,l),d=Object(n.X)(h)?"":h;l.isForeignColumn&&l.isForeignColumn()&&(r=o.getFData(d,l),d=Object(n.V)(l.foreignKeyValue,r));let p=c.data,u=t.cells.getCell(e),g={data:p,value:d,column:l,style:void 0,colSpan:1,cell:u};if(g.value=this.exportValueFormatter.formatCellValue(g,i.isServerRendered),this.parent.trigger("pdfQueryCellInfo",g),u.value=g.value,Object(n.X)(g.style)||this.processCellStyle(u,g),g.colSpan>1){e+1+g.colSpan>t.cells.count&&(g.colSpan=t.cells.count-(e+1)),u.columnSpan=g.colSpan;for(let i=1;i<u.columnSpan;i++)t.cells.getCell(e+i).value="";e+=g.colSpan-1}}if(c.isExpand){let t=this.setRecordThemeStyle(r.rows.addRow(),e),s=t.cells.getCell(l);s.columnSpan=t.cells.count-l,s.style.cellPadding=new g.i(10,10,10,10),i.isPrinting=!0;let h=!Object(n.X)(a)&&a.exportType?a.exportType:"AllPages",d=this.helper.createChildGrid(i,c,h,this.gridPool),p=d.childGrid,u=d.element;p.actionFailure=o.failureHandler(this.gridPool,p,this.globalResolve),this.parent.trigger("exportdetaildatabound",{childGrid:p,row:c,cell:s,exportProperties:a}),p.beforeDataBound=this.childGridCell(s,p,a),p.appendTo(u)}this.parent.notify("export-RowDataBound",{type:"pdf",rowObj:c})}return h}childGridCell(e,t,i){return s=>(t.beforeDataBound=null,s.cancel=!0,e.value=this.processGridExport(t,s,i),t.destroy(),Object(n.I)(t.element),this.gridPool[t.id]=!0,this.helper.checkAndExport(this.gridPool,this.globalResolve),e)}processCellStyle(e,t){if(!Object(n.X)(t.style.backgroundColor)){let i=this.hexToRgb(t.style.backgroundColor);e.style.backgroundBrush=new g.p(new g.c(i.r,i.g,i.b))}if(Object(n.X)(t.style.textAlignment)||(e.style.stringFormat=this.getHorizontalAlignment(t.style.textAlignment)),Object(n.X)(t.style.cellPadding)||(e.style.cellPadding=t.style.cellPadding),Object(n.X)(t.style.verticalAlignment)||(e.style.stringFormat=this.getVerticalAlignment(t.style.verticalAlignment,e.style.stringFormat)),!Object(n.X)(t.style.textBrushColor)){let i=this.hexToRgb(t.style.textBrushColor);e.style.textBrush=new g.p(new g.c(i.r,i.g,i.b))}if(!Object(n.X)(t.style.textPenColor)){let i=this.hexToRgb(t.style.textPenColor);e.style.textPen=new g.o(new g.c(i.r,i.g,i.b))}if(Object(n.X)(t.style.fontFamily)&&Object(n.X)(t.style.fontSize)&&Object(n.X)(t.style.bold)&&Object(n.X)(t.style.italic)&&Object(n.X)(t.style.underline)&&Object(n.X)(t.style.strikeout)||(e.style.font=this.getFont(t)),!Object(n.X)(t.style.border)){let i=new g.b,s=t.style.border.width,r=Object(n.X)(s)||"number"!=typeof s?void 0:.75*s,l=new g.c(196,196,196);if(!Object(n.X)(t.style.border.color)){let e=this.hexToRgb(t.style.border.color);l=new g.c(e.r,e.g,e.b)}let a=new g.o(l,r);Object(n.X)(t.style.border.dashStyle)||(a.dashStyle=this.getDashStyle(t.style.border.dashStyle)),i.all=a,e.style.borders=i}Object(n.X)(t.style.paragraphIndent)||(e.style.stringFormat=new g.r,e.style.stringFormat.paragraphIndent=t.style.paragraphIndent)}getHorizontalAlignment(e,t){switch(void 0===t&&(t=new g.r),e){case"Right":t.alignment=g.s.Right;break;case"Center":t.alignment=g.s.Center;break;case"Justify":t.alignment=g.s.Justify;break;case"Left":t.alignment=g.s.Left}return t}getVerticalAlignment(e,t,i){switch(void 0===t&&(t=new g.r,t=this.getHorizontalAlignment(i,t)),e){case"Bottom":t.lineAlignment=g.u.Bottom;break;case"Middle":t.lineAlignment=g.u.Middle;break;case"Top":t.lineAlignment=g.u.Top}return t}getFontFamily(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}}getFont(e){if(e.font)return e.font;let t=Object(n.X)(e.style.fontSize)?9.75:.75*e.style.fontSize,i=Object(n.X)(e.style.fontFamily)?g.f.TimesRoman:this.getFontFamily(e.style.fontFamily),s=g.g.Regular;return!Object(n.X)(e.style.bold)&&e.style.bold&&(s|=g.g.Bold),!Object(n.X)(e.style.italic)&&e.style.italic&&(s|=g.g.Italic),!Object(n.X)(e.style.underline)&&e.style.underline&&(s|=g.g.Underline),!Object(n.X)(e.style.strikeout)&&e.style.strikeout&&(s|=g.g.Strikeout),new g.q(i,t,s)}getPageNumberStyle(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}}setContentFormat(e,t){if(!Object(n.X)(e.size)){let i=.75*e.size.width,s=.75*e.size.height;if(t=new g.r(g.s.Left,g.u.Middle),!Object(n.X)(e.style.hAlign))switch(e.style.hAlign){case"Right":t.alignment=g.s.Right;break;case"Center":t.alignment=g.s.Center;break;case"Justify":t.alignment=g.s.Justify;break;default:t.alignment=g.s.Left}return Object(n.X)(e.style.vAlign)||(t=this.getVerticalAlignment(e.style.vAlign,t)),{format:t,size:new g.x(i,s)}}return null}getPageSize(e){switch(e){case"Letter":return new g.x(612,792);case"Note":return new g.x(540,720);case"Legal":return new g.x(612,1008);case"A0":return new g.x(2380,3368);case"A1":return new g.x(1684,2380);case"A2":return new g.x(1190,1684);case"A3":return new g.x(842,1190);case"A5":return new g.x(421,595);case"A6":return new g.x(297,421);case"A7":return new g.x(210,297);case"A8":return new g.x(148,210);case"A9":return new g.x(105,148);case"B0":return new g.x(2836,4008);case"B1":return new g.x(2004,2836);case"B2":return new g.x(1418,2004);case"B3":return new g.x(1002,1418);case"B4":return new g.x(709,1002);case"B5":return new g.x(501,709);case"Archa":return new g.x(648,864);case"Archb":return new g.x(864,1296);case"Archc":return new g.x(1296,1728);case"Archd":return new g.x(1728,2592);case"Arche":return new g.x(2592,3456);case"Flsa":return new g.x(612,936);case"HalfLetter":return new g.x(396,612);case"Letter11x17":return new g.x(792,1224);case"Ledger":return new g.x(1224,792);default:return new g.x(595,842)}}getDashStyle(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}}getPenFromContent(e){let t=new g.o(new g.c(0,0,0));if(!Object(n.X)(e.style)&&null!==e.style&&!Object(n.X)(e.style.penColor)){let i=this.hexToRgb(e.style.penColor);t=new g.o(new g.c(i.r,i.g,i.b))}return t}getBrushFromContent(e){let t=null;if(!Object(n.X)(e.style.textBrushColor)){let i=this.hexToRgb(e.style.textBrushColor);t=new g.p(new g.c(i.r,i.g,i.b))}return t}hexToRgb(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color...");e=e.substring(1);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}getFontStyle(e){let t=g.g.Regular;return!Object(n.X)(e)&&e.bold&&(t|=g.g.Bold),!Object(n.X)(e)&&e.italic&&(t|=g.g.Italic),!Object(n.X)(e)&&e.underline&&(t|=g.g.Underline),!Object(n.X)(e)&&e.strikeout&&(t|=g.g.Strikeout),t}getBorderStyle(e){let t=new g.b;if(Object(n.X)(e))t.all=new g.o(new g.c(234,234,234));else{let i=e.width,s=Object(n.X)(i)||"number"!=typeof i?void 0:.75*i,r=new g.c(196,196,196);if(!Object(n.X)(e.color)){let t=this.hexToRgb(e.color);r=new g.c(t.r,t.g,t.b)}let l=new g.o(r,s);Object(n.X)(e.dashStyle)||(l.dashStyle=this.getDashStyle(e.dashStyle)),t.all=l}return t}destroy(){}}class xs extends _{constructor(e,t){super(e,t),this.buttonElement=this.parent.createElement("button",{}),this.unbounDiv=this.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),this.element=this.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{role:"gridcell",tabindex:"-1"}})}render(e,t,i){let s=this.element.cloneNode();if(s.appendChild(this.unbounDiv.cloneNode()),s.setAttribute("aria-label","is Command column column header "+e.column.headerText),e.column.commandsTemplate)if(this.parent.isReact&&"string"!=typeof e.column.commandsTemplate){let i=this.parent+"commandsTemplate";e.column.getColumnTemplate()(t,this.parent,"commandsTemplate",i,null,null,s.firstElementChild),this.parent.renderTemplates()}else Ot(s.firstElementChild,e.column.getColumnTemplate()(t));else for(let r of e.commands)s=this.renderButton(s,r,i.index,r.uid);return this.setAttributes(s,e,i),this.parent.isEdit?(Object(n.v)(s.querySelectorAll(".e-edit-delete"),"e-hide"),Object(n.ib)(s.querySelectorAll(".e-save-cancel"),"e-hide")):(Object(n.v)(s.querySelectorAll(".e-save-cancel"),"e-hide"),Object(n.ib)(s.querySelectorAll(".e-edit-delete"),"e-hide")),s}renderButton(e,t,i,s){let r=this.buttonElement.cloneNode();Object(n.x)(r,{id:this.parent.element.id+(t.type||"")+"_"+i+"_"+s,type:"button",title:Object(n.X)(t.title)?t.buttonOption.content||this.localizer.getConstant(t.type)||t.type:t.title,"data-uid":s}),r.onclick=t.buttonOption.click;let l=new o.a(t.buttonOption,r);switch(l.commandType=t.type,e.firstElementChild.appendChild(l.element),t.type){case"Edit":case"Delete":Object(n.v)([r],["e-edit-delete","e-"+t.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":Object(n.v)([r],["e-save-cancel","e-"+t.type.toLowerCase()+"button"])}return e}}class js{constructor(e){this.parent=e,this.rowModelGenerator=new N(this.parent)}generateRows(e,t,i){let s=this.parent.getFrozenColumns(),r=mi(this.parent);if(s=s&&this.parent.isRowDragable()?s+1:s,"virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&"movable"!==r)return null;let l=this.parent.enableVirtualization&&!t.isFrozenRowsRender?i:this.rowModelGenerator.generateRows(e,t);if(Object(n.W)()&&!this.parent.isJsComponent)return l;for(let n=0,a=l.length;n<a;n++)l[n].cells=bi(this.parent,l[n].cells,r);return l}}class Rs extends U{constructor(e,t){super(e,t),this.isInitialRender=!0,this.widthService=t.getService("widthService"),this.addEventListener()}addEventListener(){this.parent.addEventListener(y,this.actionComplete.bind(this)),this.parent.addEventListener("batchAdd",this.batchAdd.bind(this)),this.parent.on("batchCancel",this.batchAdd.bind(this)),this.parent.addEventListener("batchDelete",this.batchAdd.bind(this)),this.parent.on("set-height-to-frozen-element",this.refreshScrollOffset),this.parent.on("column-visible-changed",this.widthService.refreshFrozenScrollbar,this)}batchAdd(e){if("auto"!==this.parent.height&&("batchCancel"!==e.name&&(!this.parent.frozenRows||"Top"!==this.parent.editSettings.newRowPosition)||"batchCancel"===e.name||"batchDelete"===e.name)){this.refreshScrollOffset();let t=this.getTable().offsetHeight;"add"===e.name&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}}setHeightToContent(e){this.getFrozenContent().style.height=e.toString()+"px",this.getMovableContent().style.height=e.toString()+"px"}actionComplete(e){if("Dialog"!==this.parent.editSettings.mode&&("add"===e.requestType||"cancel"===e.requestType&&e.row.classList.contains("e-addedrow"))&&(!this.parent.frozenRows||"Bottom"===this.parent.editSettings.newRowPosition)&&"auto"!==this.parent.height){this.refreshScrollOffset();let t=this.getTable().offsetHeight;"add"===e.requestType&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}}removeEventListener(){this.parent.isDestroyed||(this.parent.removeEventListener(y,this.actionComplete),this.parent.removeEventListener("batchAdd",this.batchAdd),this.parent.off("column-visible-changed",this.widthService.refreshFrozenScrollbar))}renderPanel(){super.renderPanel();let e=this.parent.element.querySelector(".e-frozencontent"),t=this.parent.element.querySelector(".e-movablecontent");Object(n.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-left-content"}),t=this.parent.createElement("div",{className:"e-movablecontent"}),this.getPanel().querySelector(".e-content").appendChild(e),this.getPanel().querySelector(".e-content").appendChild(t)),this.setFrozenContent(e),this.setMovableContent(t)}renderFrozenRigthPanel(){super.renderPanel()}renderEmpty(e){Object(n.W)()&&!this.parent.isJsComponent||(super.renderEmpty(e),this.getMovableContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(n.v)([this.getMovableContent().querySelector("tbody").querySelector("tr")],["e-emptyrow"]),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenColumns(),this.getFrozenContent().style.borderRightWidth="0px",this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").innerHTML="",this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").innerHTML=""))}renderFrozenRightEmpty(e){super.renderEmpty(e)}setFrozenContent(e){this.frozenContent=e}setMovableContent(e){this.movableContent=e}getFrozenContent(){return this.frozenContent}getMovableContent(){return this.movableContent}getModelGenerator(){return new js(this.parent)}renderFrozenRightTable(){super.renderTable()}renderTable(){let e;null==this.getFrozenContent().querySelector(".e-table")?(super.renderTable(),this.getFrozenContent().appendChild(this.getTable()),e=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(e)):(this.setTable(this.getFrozenContent().querySelector(".e-table")),this.setColGroup(this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)),this.getFrozenContent().querySelector(".e-table").appendChild(this.getColGroup()),e=this.getMovableContent().querySelector(".e-table"),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")),this.getMovableContent().querySelector("colgroup")&&Object(n.hb)(this.getMovableContent().querySelector("colgroup"));let t=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"));let i=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=i,this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-left-scrollbar",this.getScrollbarDisplay())}getScrollbarDisplay(){let e="";return(this.parent.getFrozenColumns()&&!this.parent.getVisibleFrozenColumns()||this.parent.getFrozenLeftColumnsCount()&&!this.parent.getVisibleFrozenLeftCount())&&(e="none"),e}renderHorizontalScrollbar(e,t,i){let s=this.parent.createElement("div",{className:e,styles:"display:"+t}),r=this.parent.createElement("div",{className:"e-movablescrollbar"}),n=this.parent.createElement("div",{className:"e-movablechild"}),l=Et().toString();this.setScrollbarHeight(r,l),this.setScrollbarHeight(n,l),r.appendChild(n),this.appendScrollbar(s,r,i)}appendScrollbar(e,t,i){let s=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});s.appendChild(e),s.appendChild(t),this.parent.getContent().appendChild(s)}setScrollbarHeight(e,t){e.style.minHeight=t+"px",e.style.maxHeight=t+"px"}setIsFrozen(e,t){e.isFrozen=!e.isFrozen}setTbody(e,t){let i;Object(n.X)(e[0].cells[0])&&(this.getMovableContent().querySelector("tbody").innerHTML="");let s=e[0].cells[0],r=s.index;return Object(n.ab)(r)&&this.parent.isRowDragable()&&(s=e[0].cells[1],r=s.index),0===r&&(this.getPanel().firstChild.style.overflowX="hidden"),this.parent.enableColumnVirtualization&&t.renderMovableContent&&"virtualscroll"===t.requestType&&this.getMovableContent().scrollLeft>0&&0!==t.virtualInfo.columnIndexes[0]&&(r=this.parent.getFrozenColumns()),s&&s.column&&(i=s.column.getFreezeTableName()),this.setIdx(r),i}splitRows(e){"frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows}renderNextFrozentPart(e,t){"frozen-left"===t&&(this.parent.enableVirtualization&&(e.renderMovableContent=!0),this.refreshContentRows(Object(n.K)({},e)))}appendContent(e,t,i,s){this.parent.isReact&&!Object(n.X)(this.parent.rowTemplate)?e=t:e.appendChild(t),"frozen-left"===s?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e)):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset(),this.widthService.refreshFrozenScrollbar()),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1)}refreshScrollOffset(){if("auto"!==this.parent.height){let e=this.getTable().offsetHeight+1;this.setHeightToContent(e)}this.parent.notify("refresh-frozen-height",{})}getFrozenHeader(e){return"frozen-left"===e?this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"):this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody")}refreshTbody(e){e.childElementCount<1&&e.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td")))}refreshHeight(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"}),this.getFrozenContent().style.borderRightWidth="1px"}setIdx(e){this.idx=e}getIdx(){return this.idx}getTbody(e){return"frozen-left"===e?this.getTable().querySelector("tbody"):this.getMovableContent().querySelector("tbody")}}class Ds extends Y{constructor(e,t){super(e,t),this.addEventListener()}addEventListener(){this.parent.on("freezerender",this.refreshFreeze,this),this.parent.on("frozenHeight",this.setFrozenHeight,this),this.parent.on(x,this.enableAfterRender,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("frozenHeight",this.setFrozenHeight),this.parent.off(x,this.enableAfterRender))}renderTable(){Object(n.W)()?(this.setTable(this.createTable(this.getFrozenHeader().querySelector(".e-table"))),this.parent.notify(E,{rows:this.rows,args:{isFrozen:!0}}),this.createTable(this.getMovableHeader().querySelector(".e-table"))):super.renderTable(),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(E,{rows:this.rows,args:{isFrozen:!1}})}renderPanel(){let e=this.parent.element.querySelector(".e-frozenheader"),t=this.parent.element.querySelector(".e-movableheader");super.renderPanel(),Object(n.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozenheader e-frozen-left-header"}),t=this.parent.createElement("div",{className:"e-movableheader"}),this.getPanel().querySelector(".e-headercontent").appendChild(e),this.getPanel().querySelector(".e-headercontent").appendChild(t)),this.setFrozenHeader(e),this.setMovableHeader(t)}renderFrozenRightPanel(){super.renderPanel()}renderFrozenRightTable(){super.renderTable()}refreshUI(){if(Object(n.W)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows)this.parent.getFrozenColumns()&&this.freezeReorder&&(super.refreshUI(),this.freezeReorder=!1,super.refreshUI()),this.rfshMovable();else{let e=this.getMovableHeader().querySelector("tbody");Object(n.hb)(this.getMovableHeader().querySelector("table")),super.refreshUI(),this.rfshMovable(),this.getMovableHeader().querySelector("tbody").innerHTML=e.innerHTML}Object(n.W)()&&0!==this.parent.frozenRows||this.updateColgroup(),this.parent.enableVirtualization||this.widthService.setWidthToTable(),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&zt([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor(),Object(n.W)()&&0!==this.parent.frozenRows||Ut(this.parent.getContentTable().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent),this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(E,{rows:this.rows,args:{isFrozen:!1}})}refreshFrozenLeftUI(){super.refreshUI()}rfshMovable(){Object(n.W)()&&0!==this.parent.frozenRows||(this.getFrozenHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createTable())),this.refreshStackedHdrHgt(),this.addMovableFirstCls()}addMovableFirstCls(){if(this.parent.getVisibleFrozenColumns()){let e=this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll(".e-columnheader"),t=e.length;for(let i=0;i<t;i++){let t="cells",s=e[i][t][0];s&&(Object(n.v)([s],["e-movablefirst"]),e[i][t][0].rowSpan>1&&(i+=e[i][t][0].rowSpan-1))}}}refreshFreeze(e){if("filter"===e.case){let e=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&e&&this.getMovableHeader().querySelector("thead")){this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(e,this.parent.getFrozenColumns()));let t=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));for(let e of t)h.c.bindInitialEvent({element:e,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}})}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())}refreshHeight(e){let t,i,s=this.getFrozenHeader(),r=this.getMovableHeader(),n=this.parent.getContent(),l=this.parent.textWrapSettings.wrapMode,a=this.parent.getHeaderContent().querySelector(".e-headercontent").classList;"textwrap"===e.case?(("Header"!==l||e.isModeChg)&&(t=n.querySelector(".e-frozencontent").querySelectorAll("tr"),i=n.querySelector(".e-movablecontent").querySelectorAll("tr"),this.setWrapHeight(t,i,e.isModeChg,!0)),"Content"===l&&this.parent.allowTextWrap?a.add("e-wrap"):a.remove("e-wrap"),"Both"===l||e.isModeChg?(t=s.querySelectorAll("tr"),i=r.querySelectorAll("tr")):(i=r.querySelector("Content"===l?"tbody":"thead").querySelectorAll("tr"),t=s.querySelector("Content"===l?"tbody":"thead").querySelectorAll("tr")),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(t,i,e.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(this.setWrapHeight(n.querySelector(".e-frozencontent").querySelectorAll("tr"),n.querySelector(".e-movablecontent").querySelectorAll("tr"),e.isModeChg),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(s.querySelectorAll("tr"),r.querySelectorAll("tr"),e.isModeChg))}enableAfterRender(e){"scroll"===e.module&&this.setFrozenHeight()}updateResizeHandler(){let e=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler"));for(let t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"}setWrapHeight(e,t,i,s,r){let l,a,o=this.parent.allowTextWrap,h=this.parent.textWrapSettings.wrapMode,d=this.parent.getHeaderContent().querySelector("thead"),c=this.parent.getHeaderContent().querySelector("tbody"),p=[],u=[];for(let g=0,m=e.length;g<m;g++)Object(n.X)(e[g])||Object(n.X)(t[g])||(p[g]=e[g].getBoundingClientRect().height,u[g]=t[g].getBoundingClientRect().height);for(let g=0,m=e.length;g<m;g++)(i&&("Header"===h&&s||"Content"===h&&d.contains(e[g])||"Header"===h&&c.contains(e[g]))||r)&&(e[g].style.height=null,t[g].style.height=null),l=p[g],a=u[g],!Object(n.X)(e[g])&&e[g].childElementCount&&(o&&l<a||!o&&l<a||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[g].style.height=a+"px"),t&&!Object(n.X)(t[g])&&t[g].childElementCount&&(o&&l>a||!o&&l>a||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[g].style.height=l+"px");o&&this.setFrozenHeight()}setFrozenHeight(e=Et()){let t=this.parent.element.querySelector(".e-movablecontent").getBoundingClientRect().height,i=this.parent.element.querySelector(".e-movablecontent"),s=this.parent.element.querySelector(".e-frozencontent"),r=this.parent.getContent().scrollWidth,n=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;i.scrollWidth-i.clientWidth?(s.style.height=t-e+"px",s.style.borderBottom=""):(s.style.height=t+"px",(s.scrollHeight<=s.clientHeight||i.scrollHeight<=i.clientHeight)&&r===n&&this.parent.scrollModule.removePadding(),s.style.borderBottom="0px")}refreshStackedHdrHgt(){let e,t,i=this.getFrozenHeader().querySelectorAll(".e-columnheader"),s=this.getMovableHeader().querySelectorAll(".e-columnheader");for(let r=0,n=i.length;r<n;r++)e=this.getRowSpan(i[r]),t=this.getRowSpan(s[r]),e.min>1?this.updateStackedHdrRowHgt(r,e.max,i[r],s):t.min>1&&this.updateStackedHdrRowHgt(r,t.max,s[r],i);this.parent.allowResizing&&this.updateResizeHandler()}getRowSpan(e){let t,i,s;for(let r=0,n=e.childElementCount;r<n;r++)0===r&&(i=e.children[0].rowSpan),t=e.children[r].rowSpan,i=Math.min(t,i),s=Math.max(t,i);return{min:i,max:s}}updateStackedHdrRowHgt(e,t,i,s){let r=0;for(let n=0;n<t;n++)r+=s[e+n].style.height?parseInt(s[e+n].style.height,10):s[e+n].offsetHeight;i.style.height=r+"px"}setFrozenHeader(e){this.frozenHeader=e}setMovableHeader(e){this.movableHeader=e}getFrozenHeader(){return this.frozenHeader}getMovableHeader(){return this.movableHeader}updateColgroup(){let e=this.getMovableHeader().querySelector("table");Object(n.hb)(this.getMovableHeader().querySelector("colgroup")),e.insertBefore(Ut(this.getFrozenHeader().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent),e.querySelector("thead"))}filterRenderer(e,t,i){let s=e.cloneNode(!0);s.innerHTML="";let r=i||this.parent.getColumns().length;for(let n=t;n<r;n++)s.appendChild(e.removeChild(e.children[t]));return s}}class Es extends Ds{constructor(e,t){super(e,t),this.addEventListener()}addEventListener(){this.parent.on("freezerender",this.refreshFreeze,this),this.parent.on("refresh-frozen-columns",this.refreshFrozenColumns,this),this.parent.on("set-reorder-destination-element",this.setReorderElement,this),this.parent.on("column-visible-changed",this.setVisible,this)}removeEventListener(){this.parent.isDestroyed||(this.parent.off("freezerender",this.refreshFreeze),this.parent.off("refresh-frozen-columns",this.refreshFrozenColumns),this.parent.off("set-reorder-destination-element",this.setReorderElement),this.parent.off("column-visible-changed",this.setVisible))}setReorderElement(e){this.destEle=e.ele}refreshFrozenColumns(e){e.parent||this.parent.setProperties({columns:e.columns},!0);let t=mt(this.destEle,"e-frozen-left-header"),i=mt(this.destEle,"e-frozen-right-header"),s=this.parent.getFrozenLeftColumnsCount(),r=this.parent.getFrozenRightColumnsCount();e.column.freeze=null,t?e.column.freeze="Left":i&&(e.column.freeze="Right"),this.parent.setFrozenCount(),e.cancel=s!==this.parent.getFrozenLeftColumnsCount()||r!==this.parent.getFrozenRightColumnsCount(),e.cancel&&this.parent.refreshColumns()}setWrapHeight(e,t,i,s,r,l){let a,o,h,d=this.parent.allowTextWrap,c=this.parent.getHeaderContent().querySelector("tbody"),p=this.parent.textWrapSettings.wrapMode,u=this.parent.getHeaderContent().querySelector("thead"),g=[],m=[],b=[];for(let f=0,y=e.length;f<y;f++)Object(n.X)(e[f])||Object(n.X)(t[f])||(l&&(b[f]=l[f].getBoundingClientRect().height),m[f]=t[f].getBoundingClientRect().height,g[f]=e[f].getBoundingClientRect().height);for(let f=0,y=e.length;f<y;f++){(i&&("Content"===p&&u.contains(e[f])||"Header"===p&&c.contains(e[f])||"Header"===p&&s)||r)&&(l[f]&&(l[f].style.height=null),e[f].style.height=null,t[f].style.height=null),a=g[f],o=m[f],h=b[f]?b[f]:0;let y=Math.max(a,o,h);!Object(n.X)(e[f])&&e[f].childElementCount&&(d&&a<y||!d&&a<y||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[f].style.height=y+"px"),t&&!Object(n.X)(t[f])&&t[f].childElementCount&&(d&&y>o||!d&&y>o||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[f].style.height=y+"px"),l&&!Object(n.X)(l[f])&&l[f].childElementCount&&(d&&y>h||!d&&y>h||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(l[f].style.height=y+"px")}d&&this.setFrozenHeight()}refreshHeight(e){let t,i,s,r="Left-Right"===this.parent.getFrozenMode(),n=this.getFrozenRightHeader(),l=this.parent.getHeaderContent().querySelector(".e-frozenheader"),a=this.parent.getContent(),o=this.getMovableHeader(),h=this.parent.getHeaderContent().querySelector(".e-headercontent").classList,d=this.parent.textWrapSettings.wrapMode;"textwrap"===e.case?(("Header"!==d||e.isModeChg)&&(r&&(i=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),s=a.querySelector(".e-movablecontent").querySelectorAll("tr"),t=a.querySelector(".e-frozencontent").querySelectorAll("tr"),this.setWrapHeight(t,s,e.isModeChg,!0,!1,i)),"Content"===d&&this.parent.allowTextWrap?h.add("e-wrap"):h.remove("e-wrap"),"Both"===d||e.isModeChg?(r&&(i=n.querySelectorAll("tr")),t=l.querySelectorAll("tr"),s=o.querySelectorAll("tr")):(r&&(i=n.querySelector("Content"===d?"tbody":"thead").querySelectorAll("tr")),t=l.querySelector("Content"===d?"tbody":"thead").querySelectorAll("tr"),s=o.querySelector("Content"===d?"tbody":"thead").querySelectorAll("tr")),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(t,s,e.isModeChg,!1,this.colDepth>1,i),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(s=a.querySelector(".e-movablecontent").querySelectorAll("tr"),t=a.querySelector(".e-frozencontent").querySelectorAll("tr"),r&&(i=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),this.setWrapHeight(t,s,e.isModeChg,!1,!1,i),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||(r&&(i=n.querySelectorAll("tr")),t=l.querySelectorAll("tr"),s=o.querySelectorAll("tr"),this.setWrapHeight(t,s,e.isModeChg,!1,!1,i)))}setVisible(e){let t,i,s=this.parent,r=this.parent.getFrozenLeftColumnsCount(),l=this.parent.getFrozenRightColumnsCount(),a=this.parent.getMovableColumnsCount();for(let o=0,h=e.length;o<h;o++){let h=e[o];if(i=s.getNormalizedColumnIndex(h.uid),t=h.visible?"":"none","Left"===h.freeze||"Right"===h.freeze){if(r&&!l){let e=s.getHeaderContent().querySelector(".e-frozen-left-header").querySelector("colgroup");Object(n.ob)(e.children[i],{display:t})}else if(!r&&l){let e=s.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup");Object(n.ob)(e.children[i-a],{display:t})}}else{let e=s.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup");Object(n.ob)(e.children[i-r],{display:t})}}this.refreshUI()}filterRenderer(e,t,i){return super.filterRenderer(e,t,i)}refreshUI(){let e,t=this.getMovableHeader().querySelector("tbody");Object(n.hb)(this.getMovableHeader().querySelector("table")),"Left-Right"===this.parent.getFrozenMode()&&(e=this.getFrozenRightHeader().querySelector("tbody"),Object(n.hb)(this.getFrozenRightHeader().querySelector("table"))),super.refreshFrozenLeftUI(),this.rfshMovable(),this.getMovableHeader().querySelector("tbody").innerHTML=t.innerHTML,e&&(this.getFrozenRightHeader().querySelector("tbody").innerHTML=e.innerHTML),this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.notify("colgroup-refresh",{}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&zt([].slice.call(this.getMovableHeader().querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor();let i=this.parent.getContent().querySelector(".e-movablecontent").querySelector(".e-table");Object(n.hb)(i.querySelector("colgroup"));let s=this.getMovableHeader().querySelector("colgroup").cloneNode(!0);if(i.insertBefore(s,i.querySelector("tbody")),e){let e=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table");Object(n.hb)(e.querySelector("colgroup"));let t=this.getFrozenRightHeader().querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"))}this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(E,{rows:this.rows,args:{isFrozen:!1}})}refreshFreeze(e){let t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount(),s=this.parent.getMovableColumnsCount();if("filter"===e.case){let e=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&e&&this.getMovableHeader().querySelector("thead")){let r=this.parent.isRowDragable(),n=t?r?t+1:t:0,l=t+s+(t&&r?1:0);if(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(e,n,l)),"Left-Right"===this.parent.getFrozenMode()){let t=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.getFrozenRightHeader().querySelector("thead").appendChild(this.filterRenderer(e,n,n+i)),this.adjudtFilterBarCell(t)}let a=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.adjudtFilterBarCell(a)}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())}updateFrozenColGroup(e,t){e&&!1===e.visible&&Object(n.ob)(t,{display:"none"})}adjudtFilterBarCell(e){for(let t of e)h.c.bindInitialEvent({element:t,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}})}renderPanel(){this.parent.getFrozenLeftColumnsCount()?(super.renderPanel(),this.parent.getFrozenRightColumnsCount()&&this.renderLeftWithRightFrozenPanel()):this.renderRightFrozenPanelAlone(),this.getPanel().firstChild.style.display="flex",this.getMovableHeader().style.flex="1"}renderTable(){this.parent.getFrozenLeftColumnsCount()?super.renderTable():this.renderFrozenRightTableAlone()}rfshMovable(){if(this.parent.getFrozenLeftColumnsCount()){if(super.rfshMovable(),this.parent.getFrozenRightColumnsCount()){let e=this.rows;this.getFrozenRightHeader().appendChild(this.createTable()),this.refreshStackedHdrHgt(),this.parent.notify(E,{rows:this.rows,args:{renderFrozenRightContent:!0}}),this.rows=e}}else this.getFrozenRightHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createTable()),this.refreshStackedHdrHgt(),this.addMovableFirstCls()}refreshStackedHdrHgt(){this.parent.getFrozenLeftColumnsCount()?(super.refreshStackedHdrHgt(),this.parent.getFrozenRightColumnsCount()&&this.refreshFrozenRightStackedHdrHgt()):this.refreshFrozenRightStackedHdrHgt()}refreshFrozenRightStackedHdrHgt(){let e,t,i=this.getFrozenRightHeader().querySelectorAll(".e-columnheader"),s=this.getMovableHeader().querySelectorAll(".e-columnheader");for(let r=0,n=i.length;r<n;r++)e=this.getRowSpan(i[r]),t=this.getRowSpan(s[r]),e.min>1&&this.updateStackedHdrRowHgt(r,e.max,i[r],s)}updateColgroup(){this.updateMovableColGroup(),this.parent.getFrozenLeftColumnsCount()&&this.updateFrozenLeftColGroup(),this.parent.getFrozenRightColumnsCount()&&this.updateFrozenRightColGroup()}renderRightFrozenPanelAlone(){let e=this.parent.element.querySelector(".e-movableheader"),t=this.parent.element.querySelector(".e-frozen-right-header");super.renderFrozenRightPanel(),Object(n.X)(t)&&(e=this.parent.createElement("div",{className:"e-movableheader"}),t=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector(".e-headercontent").appendChild(e),this.getPanel().querySelector(".e-headercontent").appendChild(t)),super.setMovableHeader(e),this.setFrozenRightHeader(t)}renderLeftWithRightFrozenPanel(){let e=this.parent.element.querySelector(".e-frozen-right-header");super.renderFrozenRightPanel(),Object(n.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector(".e-headercontent").appendChild(e)),this.setFrozenRightHeader(e)}renderFrozenRightTableAlone(){super.renderFrozenRightTable(),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(E,{rows:this.rows,args:{isFrozen:!1}})}updateFrozenLeftColGroup(){let e=this.getFrozenHeader().querySelector("colgroup").children,t=this.parent.isRowDragable()?1:0,i=this.parent.isRowDragable()?this.parent.getFrozenLeftColumnsCount()+1:this.parent.getFrozenLeftColumnsCount();for(let s=t;s<e.length;s++)s>=i&&(Object(n.hb)(e[s]),s--)}updateMovableColGroup(){let e=this.getMovableHeader().querySelector("colgroup").children;this.parent.isRowDragable()&&Object(n.hb)(e[0]);let t=e.length,i=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getMovableColumnsCount(),r=0;for(let l=0;l<t;l++,r++)(l<i||l>=i+s)&&(Object(n.hb)(e[r]),r--)}updateFrozenRightColGroup(){let e=this.parent.isRowDragable(),t=this.parent.getFrozenRightColumns(),i=this.getFrozenRightHeader().querySelector("colgroup").children;"Left-Right"===this.parent.getFrozenMode()&&e&&Object(n.hb)(i[0]);let s=i.length,r=this.parent.getFrozenLeftColumnsCount(),l=this.parent.getMovableColumnsCount(),a=0;for(let o=0;o<s;o++)o<r+l?Object(n.hb)(i[0]):(this.updateFrozenColGroup(t[a],i[a]),a++)}setFrozenRightHeader(e){this.frozenRightHeader=e}getFrozenRightHeader(){return this.frozenRightHeader}}class Is extends Rs{constructor(e,t){super(e,t),this.frzCount=0,this.isColGroupRefresh=!1,this.widthService=t.getService("widthService")}renderPanel(){this.parent.getFrozenLeftColumnsCount()?(super.renderPanel(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightPanel()):this.renderFrozenRightPanelAlone();let e=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=e}renderTable(){if(this.parent.getFrozenLeftColumnsCount()){if(super.renderTable(),this.parent.getFrozenRightColumnsCount()){this.renderFrozenLeftWithRightTable();let e=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",e,!0)}}else{this.renderFrozenRightTableAlone();let e=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",e)}this.getMovableContent().style.flex="1"}appendScrollbar(e,t,i){let s=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});if(this.parent.getFrozenLeftColumnsCount()){if(i)return void this.parent.getContent().querySelector(".e-scrollbar").appendChild(e);s.appendChild(e),s.appendChild(t)}else s.appendChild(t),s.appendChild(e);this.parent.getContent().appendChild(s)}renderFrozenRightPanelAlone(){this.renderFrozenRigthPanel();let e=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozen-right-content");Object(n.X)(t)&&(e=this.parent.createElement("div",{className:"e-movablecontent"}),t=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector(".e-content").appendChild(e),this.getPanel().querySelector(".e-content").appendChild(t)),super.setMovableContent(e),this.setFrozenRightContent(t)}renderFrozenLeftWithRightPanel(){this.renderFrozenRigthPanel();let e=this.parent.element.querySelector(".e-frozen-right-content");Object(n.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector(".e-content").appendChild(e)),this.setFrozenRightContent(e)}renderFrozenRightTableAlone(){let e;null==this.getFrozenRightContent().querySelector(".e-table")?(super.renderFrozenRightTable(),this.getFrozenRightContent().appendChild(this.getTable()),e=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(e)):(this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"),this.setTable(this.getFrozenRightContent().querySelector(".e-table")),this.setColGroup(this.getFrozenRightHeaderColGroup()),e=this.getMovableContent().querySelector(".e-table"),this.getFrozenRightContent().querySelector(".e-table").appendChild(this.getColGroup())),this.getMovableContent().querySelector("colgroup")&&Object(n.hb)(this.getMovableContent().querySelector("colgroup"));let t=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"))}renderFrozenLeftWithRightTable(){let e=this.getTable().cloneNode(!0);this.getFrozenRightContent().appendChild(e);let t=this.getFrozenRightContent().querySelector("colgroup");t&&Object(n.hb)(t);let i=this.getFrozenRightContent().querySelector(".e-table");i.insertBefore(this.getFrozenRightHeaderColGroup(),i.querySelector("tbody"))}renderFrozenRightEmptyRowAlone(e){super.renderFrozenRightEmpty(e),this.getMovableContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(n.v)([this.parent.getMovableContentTbody().querySelector("tr")],["e-emptyrow"]),this.getFrozenRightContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenRightCount(),this.parent.frozenRows&&(this.parent.getFrozenRightHeaderTbody().innerHTML="",this.parent.getMovableHeaderTbody().innerHTML="")}getFrozenHeader(e){return"frozen-left"===e?this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelector("tbody"):"movable"===e?this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody")}renderFrozenLeftWithRightEmptyRow(){this.getFrozenRightContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(n.v)([this.getFrozenRightContent().querySelector("tbody").querySelector("tr")],["e-emptyrow"]),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody").innerHTML="")}setFrozenRightContent(e){this.frozenRigthContent=e}getFrozenRightContent(){return this.frozenRigthContent}getHeaderColGroup(){let e=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);if(!this.parent.getFrozenLeftColumnsCount()){let t=this.getFrozenRightHeaderColGroup();e=t&&this.frzCount?t.cloneNode(!0):e,this.frzCount++,this.isColGroupRefresh=!0}return e}getFrozenRightHeaderColGroup(){let e=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup");return e||(e=this.parent.getHeaderContent().querySelector("colgroup")),e.cloneNode(!0)}setColGroup(e){return this.parent.getFrozenLeftColumnsCount()?super.setColGroup(e):(e=this.isColGroupRefresh?e:this.getFrozenRightHeaderColGroup(),Object(n.X)(e)||(e.id="content-"+e.id),this.isColGroupRefresh=!1,2===this.frzCount&&(this.frzCount=0),this.colgroup=e)}renderEmpty(e){this.parent.getFrozenLeftColumnsCount()?(super.renderEmpty(e),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenLeftCount(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightEmptyRow()):this.renderFrozenRightEmptyRowAlone(e),this.parent.notify("freezerender",{case:"refreshHeight"})}setHeightToContent(e){this.parent.getFrozenRightColumnsCount()&&(this.getFrozenRightContent().style.height=e.toString()+"px"),this.parent.getFrozenLeftColumnsCount()&&(this.getFrozenContent().style.height=e.toString()+"px"),this.getMovableContent().style.height=e.toString()+"px"}actionComplete(e){super.actionComplete(e)}batchAdd(e){super.batchAdd(e)}getTbody(e){let t;return"frozen-left"===e?t=this.parent.getFrozenLeftContentTbody():"movable"===e?t=this.parent.getMovableContentTbody():"frozen-right"===e&&(t=this.parent.getFrozenRightContentTbody()),t}setIsFrozen(e,t){e.isFrozen="frozen-left"===t||"Right"===this.parent.getFrozenMode()&&"frozen-right"===t,e.renderFrozenRightContent="Left-Right"===this.parent.getFrozenMode()&&"frozen-right"===t,e.renderMovableContent="movable"===t}appendContent(e,t,i,s){!Object(n.X)(this.parent.rowTemplate)&&this.parent.isReact?e=t:e.appendChild(t),"Left"===this.parent.getFrozenMode()?"frozen-left"===s?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(n.K)({},i))):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):"Right"===this.parent.getFrozenMode()?"movable"===s?(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):(this.isLoaded=!1,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(n.K)({},i))):"Left-Right"===this.parent.getFrozenMode()&&("frozen-left"===s?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(n.K)({},i))):"movable"===s?(this.refreshTbody(e),this.isLoaded=!1,this.getMovableContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(n.K)({},i))):(this.isLoaded=!0,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset())),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1),this.widthService.refreshFrozenScrollbar()}refreshHeight(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"})}splitRows(e){let t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount();t&&!i?"frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows:!t&&i?"movable"===e?this.movableRows=this.rows:(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):t&&i&&("frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):"movable"===e?(this.movableRows=this.rows,this.movableRowElements=this.rowElements):(this.frozenRightRows=this.rows,this.frozenRightRowElements=this.rowElements))}getMovableRowElements(){return 2===this.parent.getTablesCount()?this.rowElements:this.movableRowElements}getFrozenRightRowElements(){return 2===this.parent.getTablesCount()?this.freezeRowElements:this.frozenRightRowElements}getFrozenRightRows(){return"Left-Right"===this.parent.getFrozenMode()?this.parent.enableInfiniteScrolling?this.rightFreezeRows:this.frozenRightRows:this.getRows()}getFrozenRightRowByIndex(e){return this.parent.getFrozenRightDataRows()[e]}getRows(){let e=this.getInfiniteRows();return e.length?e:this.freezeRows}getRowElements(){return this.freezeRowElements}}class Ms extends Rs{constructor(e,t){super(e,t),this.frzRows=[],this.mvblRows=[],this.frRows=[],this.serviceLoc=t,this.eventListener("on"),this.rowModelGenerator=new N(this.parent)}eventListener(e){this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent.addEventListener(y,this.actionComplete.bind(this))}actionComplete(e){if("delete"===e.requestType&&this.parent.frozenRows)for(let t=0;t<this.parent.frozenRows;t++)Gs(this,t)}refreshVirtualFrozenRows(e){let t=this.parent;if("delete"===e.requestType&&t.frozenRows){e.isFrozenRowsRender=!0;let i=t.getSelectedRowIndexes(),s=t.renderModule.data.generateQuery(!0).clone();s.page(1,t.pageSettings.pageSize),t.renderModule.data.getData({},s).then(s=>{Ts(e,s.result,i,t,this.rowModelGenerator,this.serviceLoc,this.virtualRenderer,this)})}}getVirtualData(e){this.virtualRenderer.getVirtualData(e)}setFreezeSelection(e){As(e,this.virtualRenderer)}renderTable(){this.freezeRowGenerator=new js(this.parent),this.virtualRenderer=new ts(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(L.Header).virtualHdrRenderer,super.renderTable(),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");let e=this.getFrozenContent(),t=this.getMovableContent(),i=this.parent.height;if(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(i),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization){this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector(".e-movablecontent"),this.virtualRenderer.virtualEle.renderMovableWrapper(i),this.virtualRenderer.virtualEle.renderMovablePlaceHolder();let e=t.querySelector("table");this.virtualRenderer.virtualEle.movableTable=e,this.virtualRenderer.virtualEle.movableWrapper.appendChild(e),t.appendChild(this.virtualRenderer.virtualEle.movableWrapper),t.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder)}this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.table=this.getTable(),Ks(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())}appendContent(e,t,i){Bs(this.virtualRenderer,this.widthService,e,t,i)}generateRows(e,t){return this.firstPageRecords||(this.firstPageRecords=e),Ps(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)}getRowByIndex(e){return this.virtualRenderer.getRowByIndex(e)}getMovableRowByIndex(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)}collectRows(e){return zs(e,this.virtualRenderer,this.parent)}getMovableRows(){return this.collectRows("movable")}getRows(){return this.collectRows("frozen-left")}getColGroup(){let e=this.parent.getMovableVirtualContent();return this.isXaxis()?e.querySelector("colgroup"):this.colgroup}getReorderedFrozenRows(e){return qs(e,this.virtualRenderer,this.parent,0,this.firstPageRecords)}isXaxis(){return Vs(this.virtualRenderer)}getHeaderCells(){return Hs(this.virtualRenderer,this.parent)}getVirtualFreezeHeader(){return Ns(this.virtualRenderer,this.parent)}ensureFrozenCols(e){return Ws(e,this.parent)}getRowObjectByIndex(e){return this.virtualRenderer.getRowObjectByIndex(e)}setColGroup(e){return Xs(e,this.virtualRenderer,this)}}class Fs extends Ds{constructor(e,t){super(e,t),this.serviceLoc=t}renderTable(){this.virtualHdrRenderer=new is(this.parent,this.serviceLoc),this.virtualHdrRenderer.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.virtualHdrRenderer.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),this.virtualHdrRenderer.virtualEle.content=this.getPanel().querySelector(".e-headercontent"),this.virtualHdrRenderer.virtualEle.renderFrozenWrapper(),this.virtualHdrRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization&&(this.virtualHdrRenderer.virtualEle.movableContent=this.getPanel().querySelector(".e-movableheader"),this.virtualHdrRenderer.virtualEle.renderMovableWrapper(),this.virtualHdrRenderer.virtualEle.renderMovablePlaceHolder()),super.renderTable(),this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent())}rfshMovable(){this.getFrozenHeader().appendChild(this.getTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getFrozenHeader()),this.parent.enableColumnVirtualization?this.virtualHdrRenderer.virtualEle.movableWrapper.appendChild(this.createTable()):this.getMovableHeader().appendChild(this.createTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getMovableHeader())}}function Ts(e,t,i,s,r,n,l,a){s.clearSelection(),e.startIndex=0;let o=new H(n,null,s),h=r.generateRows(t,e);e.renderMovableContent?(l.vgenerator.movableCache[1]=h,h=s.getMovableRowsObject()):e.renderFrozenRightContent||e.renderMovableContent?e.renderFrozenRightContent&&(l.vgenerator.frozenRightCache[1]=h,h=s.getFrozenRightRowsObject()):(l.vgenerator.cache[1]=h,h=s.getRowsObject());let d=e.renderMovableContent||e.renderFrozenRightContent?e.renderMovableContent?s.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):s.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody"):s.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody");d.innerHTML="";for(let c=0;c<s.frozenRows;c++)if(d.appendChild(o.render(h[c],s.getColumns())),i.indexOf(c)>-1){h[c].isSelected=!0;for(let e=0;e<h[c].cells.length;e++)h[c].cells[e].isSelected=!0}e.renderMovableContent?a.mvblRows=l.vgenerator.movableCache[1]:e.renderMovableContent||e.renderFrozenRightContent?e.renderFrozenRightContent&&(a.frRows=l.vgenerator.frozenRightCache[1]):a.frzRows=l.vgenerator.cache[1],e.renderMovableContent=!e.renderMovableContent&&!e.renderFrozenRightContent,e.renderFrozenRightContent="Left-Right"===s.getFrozenMode()&&!e.renderMovableContent&&!e.renderFrozenRightContent,(e.renderMovableContent||e.renderFrozenRightContent)&&(Ts(e,t,i,s,r,n,l,a),e.renderMovableContent||e.renderFrozenRightContent||(e.isFrozenRowsRender=!1))}function ks(e,t,i){let s=[];for(let r=0;r<e.length;r++)s.push(Object(n.K)({},e[r])),s[r].cells=bi(i,s[r].cells,t);return s}function zs(e,t,i){let s,r=[];"frozen-left"===e?s=t.vgenerator.cache:"movable"===e?s=t.vgenerator.movableCache:"frozen-right"===e&&(s="Right"===i.getFrozenMode()?t.vgenerator.cache:t.vgenerator.frozenRightCache);let n=Object.keys(s);for(let l=0;l<n.length;l++)r=[...r,...ks(s[n[l]],e,i)];return r}function As(e,t){let i=Object.keys(t.vgenerator.cache),s=Object.keys(t.vgenerator.movableCache),r=Object.keys(t.vgenerator.frozenRightCache);for(let n=0;n<i.length;n++)Ls(e,t.vgenerator.cache[i[n]]);for(let n=0;n<s.length;n++)Ls(e,t.vgenerator.movableCache[s[n]]);for(let n=0;n<r.length;n++)Ls(e,t.vgenerator.frozenRightCache[r[n]])}function Ls(e,t){let i=t.filter(t=>e.clearAll||e.uid===t.uid);for(let s=0;s<i.length;s++){i[s].isSelected=e.set;let t=i[s].cells;for(let i=0;i<t.length;i++)t[i].isSelected=e.set}}function Bs(e,t,i,s,r){e.appendContent(i,s,r),t.refreshFrozenScrollbar()}function Ps(e,t,i,s,r){let l=[];l=e.vgenerator.generateRows(t,i).map(e=>Object(n.K)({},e));let a=s.generateRows(t,i,l);return r.frozenRows&&"delete"===i.requestType&&1===r.pageSettings.currentPage&&(a=a.slice(r.frozenRows)),a}function qs(e,t,i,s,r){let n,l=e.virtualInfo.blockIndexes,a=e.virtualInfo.columnIndexes,o=e.virtualInfo.page;return e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]),n=function(e,t,i){let s=mi(t,t.tableIndex);for(let r=0,n=e.length;r<n;r++)e[r].cells=bi(t,e[r].cells,s);return e}(t.vgenerator.generateRows(r,e),i),e.virtualInfo.blockIndexes=l,e.virtualInfo.columnIndexes=a,e.virtualInfo.page=o,n.splice(0,i.frozenRows)}function Vs(e){let t=!1;return e&&(t="virtualscroll"===e.requestType&&"X"===e.currentInfo.sentinelInfo.axis),t}function Hs(e,t){let i=Vs(e)?t.getMovableVirtualHeader():t.getHeaderContent();return i?[].slice.call(i.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]}function Ns(e,t){let i;return i=Vs(e)?t.getMovableVirtualHeader().querySelector(".e-table"):t.getFrozenVirtualHeader().querySelector(".e-table"),i}function Ws(e,t){return t.columns.slice(0,t.getFrozenColumns()).concat(e)}function Xs(e,t,i){return Vs(t)||(Object(n.X)(e)||(e.id="content-"+e.id),i.colgroup=e),i.colgroup}function Gs(e,t){e.virtualRenderer.vgenerator.cache[1]?e.virtualRenderer.vgenerator.cache[1][t]=e.frzRows[t]:e.virtualRenderer.vgenerator.cache[1]=e.frzRows,e.virtualRenderer.vgenerator.movableCache[1]?e.virtualRenderer.vgenerator.movableCache[1][t]=e.mvblRows[t]:e.virtualRenderer.vgenerator.movableCache[1]=e.mvblRows}function Ks(e,t,i,s){let r=e.dataSource instanceof l.a&&!e.dataSource.dataSource.offline,n={container:t.content,pageHeight:2*t.getBlockHeight(),debounceEvent:r,axes:e.enableColumnVirtualization?["X","Y"]:["Y"],scrollbar:i,movableContainer:s};t.observer=new Zi(t.virtualEle.wrapper,n,t.virtualEle.movableWrapper)}class Us extends Is{constructor(e,t){super(e,t),this.frRows=[],this.frzRows=[],this.mvblRows=[],this.serviceLoc=t,this.eventListener("on"),this.rowModelGenerator=new N(this.parent)}actionComplete(e){if("delete"===e.requestType&&this.parent.frozenRows)for(let t=0;t<this.parent.frozenRows;t++){if(!this.virtualRenderer.vgenerator.frozenRightCache[1]){this.virtualRenderer.vgenerator.frozenRightCache[1]=this.frRows.length?this.frRows:this.frzRows;break}this.virtualRenderer.vgenerator.frozenRightCache[1][t]=this.frRows.length?this.frRows[t]:this.frzRows[t],Gs(this,t)}}eventListener(e){this.parent.addEventListener(y,this.actionComplete.bind(this)),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this)}refreshVirtualFrozenRows(e){if("delete"===e.requestType&&this.parent.frozenRows){e.isFrozenRowsRender=!0;let t=this.parent.renderModule.data.generateQuery(!0).clone();t.page(1,this.parent.pageSettings.pageSize);let i=this.parent.getSelectedRowIndexes();this.parent.renderModule.data.getData({},t).then(t=>{Ts(e,t.result,i,this.parent,this.rowModelGenerator,this.serviceLoc,this.virtualRenderer,this)})}}setFreezeSelection(e){As(e,this.virtualRenderer)}getVirtualData(e){this.virtualRenderer.getVirtualData(e)}renderNextFrozentPart(e){"Left"!==this.parent.getFrozenMode()&&"Right"!==this.parent.getFrozenMode()||1===this.parent.tableIndex&&(e.renderMovableContent=!0,this.refreshContentRows(Object(n.K)({},e))),"Left-Right"===this.parent.getFrozenMode()&&(1!==this.parent.tableIndex&&2!==this.parent.tableIndex||(e.renderMovableContent=1===this.parent.tableIndex,e.renderFrozenRightContent=2===this.parent.tableIndex,this.refreshContentRows(Object(n.K)({},e))))}renderTable(){this.virtualRenderer=new ts(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(L.Header).virtualHdrRenderer,this.freezeRowGenerator=new js(this.parent),super.renderTable(),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");let e=this.getFrozenRightContent(),t=this.getFrozenContent(),i=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(t=e),this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(this.parent.height),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.renderVirtualFrozenLeft(t,i),this.renderVirtualFrozenRight(t,i),this.renderVirtualFrozenLeftRight(t,i,e),this.virtualRenderer.virtualEle.table=this.getTable(),Ks(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())}renderVirtualFrozenLeft(e,t){"Left"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t))}renderVirtualFrozenRight(e,t){"Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(e))}renderVirtualFrozenLeftRight(e,t,i){"Left-Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(i))}appendContent(e,t,i){Bs(this.virtualRenderer,this.widthService,e,t,i),this.refreshScrollOffset()}generateRows(e,t){return this.firstPageRecords||(this.firstPageRecords=e),Ps(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)}getRowByIndex(e){return this.virtualRenderer.getRowByIndex(e)}getFrozenRightRowByIndex(e){return this.virtualRenderer.getFrozenRightVirtualRowByIndex(e)}collectRows(e){return zs(e,this.virtualRenderer,this.parent)}getMovableRowByIndex(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)}getFrozenRightRows(){return this.collectRows("frozen-right")}getMovableRows(){return this.collectRows("movable")}getColGroup(){let e=this.parent.getMovableVirtualContent();return Vs(this.virtualRenderer)?e.querySelector("colgroup"):this.colgroup}getRows(){return this.collectRows("Right"===this.parent.getFrozenMode()?"frozen-right":"frozen-left")}getReorderedFrozenRows(e){return qs(e,this.virtualRenderer,this.parent,0,this.firstPageRecords)}getHeaderCells(){return Hs(this.virtualRenderer,this.parent)}isXaxis(){return Vs(this.virtualRenderer)}getVirtualFreezeHeader(){return Ns(this.virtualRenderer,this.parent)}getRowObjectByIndex(e){return this.virtualRenderer.getRowObjectByIndex(e)}ensureFrozenCols(e){return Ws(e,this.parent)}setColGroup(e){return Xs(e,this.virtualRenderer,this)}}class Ys extends U{constructor(e,t){super(e,t),this.childCount=0,this.scrollData=[],this.isFirstChildRow=!1,this.groupCache={},this.startIndexes={},this.captionCounts={},this.rowsByUid={},this.objIdxByUid={},this.initialGroupCaptions={},this.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete"],this.cacheMode=!1,this.cacheBlockSize=5,this.ignoreAccent=!!this.parent.allowFiltering&&this.parent.filterSettings.ignoreAccent,this.allowCaseSensitive=!1,this.locator=t,this.groupGenerator=new K(this.parent),this.summaryModelGen=new X(this.parent),this.captionModelGen=new G(this.parent),this.rowRenderer=new H(this.locator,null,this.parent),this.eventListener()}eventListener(){this.parent.addEventListener(f,this.actionBegin.bind(this)),this.parent.addEventListener(y,this.actionComplete.bind(this)),this.parent.on(w,this.setLazyLoadPageSize,this),this.parent.on("group-cache",this.setCache,this),this.parent.on("lazy-load-scroll-handler",this.scrollHandler,this),this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("group-collapse",this.collapseShortcut,this)}captionExpand(e){let t=this.parent.pageSettings.currentPage,i=this.groupCache[t],s=e.getAttribute("data-uid"),r=this.getRowObjectIndexByUid(s),n=!!i[r+1]&&i[r].indent<i[r+1].indent,l=i[r],a=this.getGroupKeysAndFields(r,i);this.parent.trigger("lazyLoadGroupExpand",{captionRowElement:e,groupInfo:l,enableCaching:!0,cancel:!1},i=>{i.cancel||(i.keys=a.keys,i.fields=a.fields,i.rowIndex=e.rowIndex,i.makeRequest=!i.enableCaching||!n,!i.enableCaching&&n&&this.clearCache([s]),i.skip=0,i.take=this.pageSize,l.isExpand=this.rowsByUid[t][l.uid].isExpand=!0,this.captionRowExpand(i))})}captionCollapse(e){let t=this.groupCache[this.parent.pageSettings.currentPage],i=e.rowIndex,s=e.getAttribute("data-uid"),r=this.getRowObjectIndexByUid(s);this.parent.trigger("lazyLoadGroupCollapse",{captionRowElement:e,groupInfo:t[r],cancel:!1},e=>{e.cancel||(e.isExpand=!1,this.removeRows(r,i))})}setLazyLoadPageSize(){let e=this.parent.getContent().firstElementChild,t=Math.floor(e.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t,this.blockSize=Math.ceil(this.pageSize/2)}clearLazyGroupCache(){this.clearCache()}clearCache(e){e=e||this.getInitialCaptionIndexes();let t=this.groupCache[this.parent.pageSettings.currentPage];if(e.length)for(let i=0;i<e.length;i++){let s=this.getRowObjectIndexByUid(e[i]),r=t[s];if(!r)continue;if(this.captionCounts[this.parent.pageSettings.currentPage][r.uid])for(let e=s+1;e<t.length;e++){if(t[e].indent===r.indent||t[e].indent<r.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][r.uid];break}t[e].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[e].uid]}if(r.isExpand){let e=this.parent.getRowElementByUID(r.uid);if(!e)return;this.parent.groupModule.expandCollapseRows(e.querySelector(".e-recordplusexpand"))}let n=this.getNextChilds(s);if(!n.length)continue;let l=[];n[n.length-1].isCaptionRow&&(l=this.getChildRowsByParentIndex(t.indexOf(n[n.length-1]),!1,!1,null,!0,!0));let a=t.indexOf(n[0]),o=t.indexOf(l.length?l[l.length-1]:n[n.length-1]);t.splice(a,o-(a-1)),this.refreshCaches()}}refreshCaches(){let e=this.groupCache[this.parent.pageSettings.currentPage];this.rowsByUid={},this.objIdxByUid={};for(let t=0;t<e.length;t++)this.maintainRows(e[t],t)}getInitialCaptionIndexes(){let e=this.parent.pageSettings.currentPage,t=[];for(let i=0;i<this.initialGroupCaptions[e].length;i++)t.push(this.initialGroupCaptions[e][i].uid);return t}getRowObjectIndexByUid(e){return this.objIdxByUid[this.parent.pageSettings.currentPage][e]}collapseShortcut(e){if(this.parent.groupSettings.columns.length&&e.target&&mt(e.target,"e-content")&&"TR"===e.target.parentElement.tagName){if(!e.collapse&&mt(e.target,"e-row"))return;let t=e.target.parentElement.getAttribute("data-uid");if(e.collapse){let e=this.getRowByUid(t),i=this.getRowByUid(e.parentUid);if(i.isCaptionRow&&i.isExpand){let t=this.getRowElementByUid(e.parentUid);this.parent.groupModule.expandCollapseRows(t.cells[e.indent-1])}}else{let e=this.getRowByUid(t);if(e.isCaptionRow&&!e.isExpand){let i=this.getRowElementByUid(t);this.parent.groupModule.expandCollapseRows(i.cells[e.indent])}}}}getRowByUid(e){return this.rowsByUid[this.parent.pageSettings.currentPage][e]}actionBegin(e){if(!e.cancel){if(this.requestType.some(t=>t===e.requestType)||(this.groupCache={},this.resetRowMaintenance()),"reorder"===e.requestType&&this.parent.groupSettings.columns.length){let t=Object.keys(this.groupCache);for(let i=0;i<t.length;i++){let s=this.groupCache[t[i]];for(let r=0;r<s.length;r++)s[r].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(s[r],null,t[i]),s[r].isDataRow&&this.moveCells(s[r].cells,e.fromIndex+s[r].indent,e.toIndex+s[r].indent)}}("delete"===e.requestType||"add"===e.action&&"save"===e.requestType)&&(this.groupCache={},this.resetRowMaintenance())}}actionComplete(e){e.cancel||"columnstate"===e.requestType||"beginEdit"===e.requestType||"delete"===e.requestType||"save"===e.requestType||"reorder"===e.requestType||this.scrollReset()}resetRowMaintenance(){this.startIndexes={},this.captionCounts={},this.rowsByUid={},this.objIdxByUid={},this.initialGroupCaptions={}}moveCells(e,t,i){if(t>=e.length){let i=t-e.length;for(;1+i--;)e.push(void 0)}e.splice(t,0,e.splice(i,1)[0])}removeRows(e,t){let i,s=this.parent.pageSettings.currentPage,r=this.groupCache[s],l=[].slice.call(this.parent.getContent().querySelectorAll("tr"));if(this.parent.aggregates.length){let t=this.getAggregateByCaptionIndex(e);i=t.length?t[t.length-1].uid:void 0}let a,o=r[e].indent;this.addClass(this.getNextChilds(e)),r[e].isExpand=this.rowsByUid[s][r[e].uid].isExpand=!1;for(let n=e+1;n<r.length;n++){if(r[n].indent===o||r[n].indent<o){a=r[n].uid;break}r[n].isCaptionRow&&r[n].isExpand&&this.addClass(this.getNextChilds(n))}for(let h=t+1;h<l.length&&l[h].getAttribute("data-uid")!==a;h++){if(l[h].getAttribute("data-uid")===i){Object(n.hb)(l[h]);break}Object(n.hb)(l[h])}}addClass(e){let t=e[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")}getNextChilds(e,t){let i=this.groupCache[this.parent.pageSettings.currentPage],s=t||i,r=i[e].indent+1,n=[];for(let l=t?0:e+1;l<s.length&&!(s[l].indent<r);l++)s[l].indent===r&&n.push(s[l]);return n}lazyLoadHandler(e){this.setStartIndexes();let t=this.parent.getContent().querySelectorAll("tr")[e.index].getAttribute("data-uid"),i=this.getRowObjectIndexByUid(t),s=this.groupCache[this.parent.pageSettings.currentPage][i],r=e.isRowExist?e.isScroll?this.scrollData:this.getChildRowsByParentIndex(i,!0,!0,null,!0):[];if(this.scrollData=[],!e.isRowExist)if(this.setRowIndexes(i,s),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][i],e.count),-1!==Object.keys(e.data).indexOf("GroupGuid"))for(let h=0;h<e.data.length;h++){let t=this.groupGenerator.generateCaptionRow(e.data[h],e.level,s.parentGid,void 0,0,s.uid);r.push(t),this.parent.aggregates.length&&(r=r.concat(this.summaryModelGen.generateRows(e.data[h],{level:e.level+1,parentUid:t.uid})))}else this.groupGenerator.index=this.getStartIndex(i,e.isScroll),r=this.groupGenerator.generateDataRows(e.data,e.level,s.parentGid,0,s.uid);let n=e.isScroll?this.rowIndex:e.index,l=this.getNextChilds(i,r),a=!!e.up||this.hasLastChildRow(e.isScroll,e.count,l.length);e.isRowExist||a||(l[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down"),a||(l[l.length-1].lazyLoadCssClass="e-not-lazyload-end");let o=e.isScroll||e.isRowExist?[]:this.getAggregateByCaptionIndex(i);e.up||e.isRowExist||this.refreshRowObjects(r,e.isScroll?this.rowObjectIndex:i),this.render(n,r,a,o),this.isFirstChildRow&&!e.up&&(this.parent.getContent().firstElementChild.scrollTop=r.length*this.parent.getRowHeight()),this.isFirstChildRow=!1,this.rowIndex=void 0,this.rowObjectIndex=void 0,this.childCount=0}setRowIndexes(e,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={}),t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)}getStartIndex(e,t){let i=this.parent.pageSettings.currentPage,s=this.groupCache[i];if(t)return s[this.rowObjectIndex].index+1;let r=0,n=0,l=this.getRowByUid(s[e].parentUid);if(l&&(n=this.prevCaptionCount(l)),s[e].indent>0)for(let a=e-1;a>=0&&!(s[a].indent<s[e].indent);a--)s[a].isCaptionRow&&s[a].indent===s[e].indent&&(r+=s[a].data.count);return r+n+this.startIndexes[i][s[e].parentGid]}prevCaptionCount(e){let t=this.parent.pageSettings.currentPage,i=this.groupCache[t],s=0;for(let n=i.indexOf(e)-1;n>=0&&0!==i[n].indent&&!(i[n].indent<e.indent);n--)i[n].isCaptionRow&&i[n].indent===e.indent&&(s+=this.captionCounts[t][i[n].uid]||i[n].data.count);let r=this.getRowByUid(e.parentUid);return r&&(s+=this.prevCaptionCount(r)),s}setStartIndexes(){let e=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){let t,i=[];for(let s=0;s<e.length;s++)e[s].isCaptionRow&&(i.push(i.length?e[t].data.count+i[i.length-1]:0),t=s);this.startIndexes[this.parent.pageSettings.currentPage]=i}}hasLastChildRow(e,t,i){return e?t===this.childCount+i:t===i}refreshCaptionRowCount(e,t){e.data.count=t}render(e,t,i,s){let r=this.parent.getContent().querySelectorAll("tr")[e];if(r&&s.length)for(let n=s.length-1;n>=0;n--)r.insertAdjacentElement("afterend",this.rowRenderer.render(s[n],this.parent.getColumns()));if(r&&t.length)for(let n=t.length-1;n>=0;n--)this.confirmRowRendering(t[n])&&r.insertAdjacentElement("afterend",this.rowRenderer.render(t[n],this.parent.getColumns()))}maintainRows(e,t){let i=this.parent.pageSettings.currentPage;this.rowsByUid[i]||(this.rowsByUid[i]={},this.objIdxByUid[i]={}),e.uid&&(this.rowsByUid[i][e.uid]=e),this.objIdxByUid[i][e.uid]=t}confirmRowRendering(e){let t=!0;if(Object(n.X)(e.indent)&&!e.isDataRow&&!e.isCaptionRow){let i=this.getRowByUid(e.parentUid);i.isCaptionRow&&!i.isExpand&&(t=!1)}return t}refreshRowObjects(e,t){let i=this.parent.pageSettings.currentPage,s=this.groupCache[i];this.rowsByUid[i]={},this.objIdxByUid[i]={};let r=[],l=0;for(let n=0;n<s.length;n++)if(n===t){this.maintainRows(s[n],l),r.push(s[n]),l++;for(let t=0;t<e.length;t++)this.maintainRows(e[t],l),r.push(e[t]),l++}else this.maintainRows(s[n],l),r.push(s[n]),l++;this.groupCache[this.parent.pageSettings.currentPage]=Object(n.K)([],r),this.updateCurrentViewData()}getAggregateByCaptionIndex(e){let t=this.groupCache[this.parent.pageSettings.currentPage],i=t[e],s=i.indent,r=i.uid,l=[];for(let a=e+1;a<t.length&&t[a].indent!==s;a++)Object(n.X)(t[a].indent)&&t[a].parentUid===r&&l.push(t[a]);return l}getChildRowsByParentIndex(e,t,i,s,r,l){let a=s||this.groupCache[this.parent.pageSettings.currentPage],o=a[e],h=[];if(!o.isCaptionRow||o.isCaptionRow&&!o.isExpand&&!l)return[];r&&this.parent.aggregates.length&&(h=this.getAggregateByCaptionIndex(e));let d=o.indent,c=o.uid,p=[],u=0;for(let g=e+1;g<a.length;g++){if(a[g].parentUid===c){if(Object(n.X)(a[g].indent))continue;if(u++,p.push(a[g]),t&&a[g].isCaptionRow&&(p=p.concat(this.getChildRowsByParentIndex(g,t,i,s,r))),i&&u===this.pageSize)break}if(a[g].indent===d)break}return p.concat(h)}initialGroupRows(e){let t=[],i=this.groupCache[this.parent.pageSettings.currentPage];if(e)return this.getRenderedRowsObject();for(let s=0;s<i.length;s++)0===i[s].indent&&(t.push(i[s]),t=t.concat(this.getChildRowsByParentIndex(s,!0,!0,i,!0)));return t}getRenderedRowsObject(){let e=[],t=[].slice.call(this.parent.getContent().querySelectorAll("tr"));for(let i=0;i<t.length;i++)e.push(this.getRowByUid(t[i].getAttribute("data-uid")));return e}getCacheRowsOnDownScroll(e){let t=[],i=this.groupCache[this.parent.pageSettings.currentPage],s=e;for(let r=0;r<this.pageSize&&i[s]&&!(i[s].indent<i[e].indent);r++)i[s].indent===i[e].indent&&(t.push(i[s]),i[s].isCaptionRow&&i[s].isExpand&&(t=t.concat(this.getChildRowsByParentIndex(s,!0,!0,null,!0)))),(i[s].indent>i[e].indent||Object(n.X)(i[s].indent))&&r--,s++;return t}getCacheRowsOnUpScroll(e,t,i){let s=[],r=this.groupCache[this.parent.pageSettings.currentPage],n=!1;for(let l=0;l<r.length&&(!n||r[l]&&!(r[l].indent<r[i].indent)&&r[l].uid!==t);l++)n||r[l].uid!==e||(n=!0),n&&r[l].indent===r[i].indent&&(s.push(r[l]),r[l].isCaptionRow&&r[l].isExpand&&(s=s.concat(this.getChildRowsByParentIndex(l,!0,!0,null,!0))));return s}scrollHandler(e){if(this.parent.isDestroyed||this.childCount)return;let t,i=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-down")),s=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-up")),r=[].slice.call(this.parent.getContent().querySelectorAll(".e-not-lazyload-end")),n=!1,l=!1,a=!1;if(e.scrollDown&&i.length){let e=this.findRowElements(i);t=e.tr,n=e.entered}if(!e.scrollDown&&r)for(let o=0;o<r.length;o++){let e=r[o].getBoundingClientRect().top,i=this.parent.getContent().scrollHeight;if(e>0&&e<i){t=r[o],a=!0,this.rowIndex=t.rowIndex;break}}if(!e.scrollDown&&s.length&&!a){let e=this.findRowElements(s);t=e.tr,l=e.entered}t&&(n&&e.scrollDown&&n&&t&&this.scrollDownHandler(t),!e.scrollDown&&a&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!e.scrollDown&&!a&&l&&t&&this.scrollUpHandler(t))}scrollUpEndRowHandler(e){let t=this.groupCache[this.parent.pageSettings.currentPage],i=e.getAttribute("data-uid"),s=this.rowObjectIndex=this.getRowObjectIndexByUid(i),r=s,n=t[s],l=this.getRowByUid(n.parentUid),a=this.getRowObjectIndexByUid(l.uid),o=this.parent.getContent().querySelector("tr[data-uid="+l.uid+"]").rowIndex,h=this.getChildRowsByParentIndex(a).indexOf(n),d=Math.ceil(h/this.pageSize);if(1!==d)if(this.childCount=d*this.pageSize,s=this.getCurrentBlockEndIndex(n,s),this.childCount<l.data.count){e.classList.remove("e-not-lazyload-end"),n.lazyLoadCssClass="";let h=!!t[s+1]&&n.indent===t[s+1].indent;this.scrollData=h?this.getCacheRowsOnDownScroll(s+1):[];let d=this.getGroupKeysAndFields(a,t),c={rowIndex:o,makeRequest:!h,groupInfo:l,fields:d.fields,keys:d.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize){let e=this.getChildRowsByParentIndex(a),s=Math.ceil(e.indexOf(t[r])/this.pageSize)-(this.cacheBlockSize-1);this.removeBlock(i,h,s,e),c.cachedRowIndex=s*this.pageSize}this.captionRowExpand(c)}else this.childCount=0}scrollDownHandler(e){let t=this.groupCache[this.parent.pageSettings.currentPage],i=e.getAttribute("data-uid"),s=this.getRowObjectIndexByUid(i),r=s,l=t[s],a=this.getRowByUid(l.parentUid),o=this.getRowObjectIndexByUid(a.uid),h=this.getRowElementByUid(a.uid).rowIndex,d=this.getChildRowsByParentIndex(o),c=d.indexOf(l),p=Math.ceil(c/this.pageSize);this.childCount=p*this.pageSize,s=this.rowObjectIndex=this.getRowObjectIndexByUid(d[this.childCount-1].uid);let u=t[s],g=this.getRowElementByUid(u.uid);if(this.rowIndex=g.rowIndex,s=this.getCurrentBlockEndIndex(u,s),this.childCount<a.data.count){let d=!!t[s+1]&&l.indent===t[s+1].indent;if(d&&!Object(n.X)(this.getRowElementByUid(t[s+1].uid)))return void(this.childCount=0);(p>1||!this.cacheMode)&&(e.classList.remove("e-lazyload-middle-down"),g.classList.remove("e-not-lazyload-end"),u.lazyLoadCssClass=""),this.scrollData=d?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];let c=this.getGroupKeysAndFields(o,t),m={rowIndex:h,makeRequest:!d,groupInfo:a,fields:c.fields,keys:c.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize){let e=this.getChildRowsByParentIndex(o),s=Math.ceil(e.indexOf(t[r])/this.pageSize)-1-(this.cacheBlockSize-1)+1;this.removeBlock(i,d,s,e,u),m.cachedRowIndex=s*this.pageSize}this.captionRowExpand(m)}else this.childCount=0}getCurrentBlockEndIndex(e,t){let i=this.groupCache[this.parent.pageSettings.currentPage];if(e.isCaptionRow){if(e.isExpand){let e=this.getChildRowsByParentIndex(t,!0).length;this.rowIndex=this.rowIndex+e}let s=this.getAggregateByCaptionIndex(t);this.rowObjectIndex=this.rowObjectIndex+s.length;let r=t;for(let e=r+1;e<i.length;e++){if(i[e].indent===i[t].indent||i[e].indent<i[t].indent){t=r;break}r++}}return t}removeBlock(e,t,i,s,r){let n=s[(i+1)*this.pageSize-1-this.blockSize].uid,l=s[i*this.pageSize-this.pageSize].uid,a=s[i*this.pageSize].uid;this.groupCache[this.parent.pageSettings.currentPage][this.getRowObjectIndexByUid(n)].lazyLoadCssClass="e-lazyload-middle-up",this.getRowElementByUid(n).classList.add("e-lazyload-middle-up"),r&&(this.getRowElementByUid(a).classList.add("e-not-lazyload-first"),this.getRowByUid(a).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(l).lazyLoadCssClass=""),t?this.removeTopRows(r?r.uid:e,l,a):(this.uid1=l,this.uid2=a,this.uid3=r?r.uid:e)}scrollUpHandler(e){let t=this.parent.pageSettings.currentPage,i=this.groupCache[t],s=e.getAttribute("data-uid"),r=this.getRowByUid(s),l=this.rowObjectIndex=this.getRowObjectIndexByUid(s),a=this.getRowByUid(r.parentUid),o=this.rowIndex=this.getRowObjectIndexByUid(a.uid),h=this.parent.getRowElementByUID(a.uid).rowIndex,d=this.getChildRowsByParentIndex(o),c=d.indexOf(i[l]),p=Math.floor(c/this.pageSize),u=this.blockSize;2*this.blockSize>this.pageSize&&(u=2*this.blockSize-this.pageSize,u=this.blockSize-u);let g=d[c-(u-1)-this.pageSize].uid,m=d[c-(u-1)].uid;this.scrollData=this.getCacheRowsOnUpScroll(g,m,l-(u-1)),this.isFirstChildRow=p>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(m).lazyLoadCssClass="",this.getRowElementByUid(m).classList.remove("e-not-lazyload-first");let b=p+this.cacheBlockSize;if(d.length!==a.data.count&&b*this.pageSize>d.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(m).classList.add("e-not-lazyload-first");let f=b*this.pageSize>a.data.count?a.data.count:b*this.pageSize,y=b*this.pageSize>a.data.count?this.pageSize-(this.pageSize*b-a.data.count):this.pageSize,C=this.getChildRowsByParentIndex(i.indexOf(d[f-1]),!0,!1,null,!0),v=C.length?C[C.length-1].uid:d[f-1].uid,w=d[f-y].uid,S=d[f-y-1].uid,O=this.objIdxByUid[t][w]-u;if("e-lazyload-middle-down"===i[O].lazyLoadCssClass){let e=this.getRowElementByUid(i[O].uid);e&&e.classList.add("e-lazyload-middle-down")}if(this.getRowByUid(v).lazyLoadCssClass="",this.getRowByUid(S).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(S).classList.add("e-not-lazyload-end"),this.removeBottomRows(v,w,S),this.rowIndex=e.rowIndex-u,e.classList.length>1?e.classList.remove("e-lazyload-middle-up"):e.removeAttribute("class"),!Object(n.X)(this.getRowElementByUid(g)))return this.childCount=0,void(this.scrollData=[]);let x=this.getGroupKeysAndFields(this.getRowObjectIndexByUid(a.uid),i);this.captionRowExpand({rowIndex:h,makeRequest:!1,groupInfo:a,fields:x.fields,keys:x.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0})}findRowElements(e){let t,i=!1;for(let s=0;s<e.length;s++){let r=e[s].rowIndex;if(ai(r,this.parent)){i=!0,this.rowIndex=r,t=e[s];break}}return{entered:i,tr:t}}getRowElementByUid(e){return this.parent.getContent().querySelector("tr[data-uid="+e+"]")}removeTopRows(e,t,i){let s=[].slice.call(this.parent.getContent().querySelectorAll("tr")),r=!1;for(let l=0;l<s.length;l++){if(s[l].getAttribute("data-uid")===i){let t=this.parent.getContent().querySelector("tr[data-uid="+e+"]");t&&(this.rowIndex=t.rowIndex);break}s[l].getAttribute("data-uid")===t&&(r=!0),r&&Object(n.hb)(s[l])}}removeBottomRows(e,t,i){let s=[].slice.call(this.parent.getContent().querySelectorAll("tr")),r=!1;for(let l=0;l<s.length&&(s[l].getAttribute("data-uid")===t&&(r=!0),!r||(Object(n.hb)(s[l]),s[l].getAttribute("data-uid")!==e));l++);}setCache(e){let t=this.parent.pageSettings.currentPage;this.groupCache[t]=this.initialGroupCaptions[t]=Object(n.K)([],e.data)}getGroupKeysAndFields(e,t){let i=[],s=[];for(let r=e;r>=0&&(!t[r].isCaptionRow||-1!==i.indexOf(t[r].data.field)||!(t[r].indent<t[e].indent||r===e)||(i.push(t[r].data.field),s.push(t[r].data.key),0!==t[r].indent));r--);return{fields:i,keys:s}}generateExpandPredicates(e,t){let i=[];for(let s=0;s<e.length;s++){let r=this.parent.getColumnByField(e[s]),l="null"===t[s]?null:t[s],a={field:e[s],predicate:"or",uid:r.uid,operator:"equal",type:r.type,matchCase:this.allowCaseSensitive,ignoreAccent:this.ignoreAccent};""===l||Object(n.X)(l)?i=i.concat(Ei.generateNullValuePredicates(a)):i.push(Object(n.K)({},{value:l},a))}return Ei.getPredicate(i)}getPredicates(e){let t=[];for(let i of Object.keys(e))t.push(e[i]);return t}captionRowExpand(e){let t=this.parent.groupSettings.columns.indexOf(e.groupInfo.data.field)+1,i=this.generateExpandPredicates(e.fields,e.keys),s=this.getPredicates(i),r={level:t,skip:e.skip,take:e.take,where:s};if(e.makeRequest){let i=this.parent.renderModule.data.generateQuery(!0);i.isCountRequired||(i.isCountRequired=!0),i.lazyLoad.push({key:"onDemandGroupInfo",value:r}),this.parent.showSpinner(),this.parent.renderModule.data.getData({},i).then(i=>{this.parent.hideSpinner(),0!==i.result.length&&(this.cacheMode&&this.uid1&&this.uid2&&(this.removeTopRows(this.uid3,this.uid1,this.uid2),this.uid1=this.uid2=this.uid3=void 0),this.lazyLoadHandler({data:i.result,count:i.count,level:t,index:e.rowIndex,isRowExist:!1,isScroll:e.isScroll,up:!1,rowIndex:e.cachedRowIndex}))}).catch(e=>this.parent.renderModule.dataManagerFailure(e,{requestType:"grouping"}))}else this.lazyLoadHandler({data:null,count:e.groupInfo.data.count,level:t,index:e.rowIndex,isRowExist:!0,isScroll:e.isScroll,up:e.scrollUp,rowIndex:e.cachedRowIndex})}scrollReset(e){this.parent.getContent().firstElementChild.scrollTop=e?this.parent.getContent().firstElementChild.scrollTop+e:0}updateCurrentViewData(){let e=[];this.getRows().filter(t=>{t.isDataRow&&(e[t.index]=t.data)}),this.parent.currentViewData=e.length?e:this.parent.currentViewData}getGroupCache(){return this.groupCache}getRows(){return this.groupCache[this.parent.pageSettings.currentPage]||[]}getRowElements(){return[].slice.call(this.parent.getContent().querySelectorAll(".e-row"))}getRowByIndex(e){let t,i=[].slice.call(this.parent.getContent().querySelectorAll(".e-row"));for(let s=0;!Object(n.X)(e)&&s<i.length;s++)if(i[s].getAttribute("aria-rowindex")===e.toString()){t=i[s];break}return t}setVisible(e){let t,i=this.parent;this.getRows().some(e=>(e.isDataRow&&(t=e),e.isDataRow));let s=this.getRows().filter(e=>!e.isDetailRow);for(let r=0;r<e.length;r++){let l=e[r],a=this.parent.getNormalizedColumnIndex(l.uid),o=this.parent.getColumnIndexByUid(l.uid),h=!0===l.visible?"":"none";-1!==a&&t&&a<t.cells.length&&Object(n.ob)(this.getColGroup().childNodes[a],{display:h}),this.setDisplayNone(i.getDataRows(),o,h,s,a),!this.parent.invokedFromMedia&&l.hideAtMedia&&this.parent.updateMediaColumns(l),this.parent.invokedFromMedia=!1}}setDisplayNone(e,t,i,s,r){let l=Object.keys(e);if(this.parent.groupSettings.columns.length){let e=Object.keys(this.groupCache);for(let s=0;s<e.length;s++){let l=this.rowsByUid[e[s]],a=Object.keys(l);for(let o=0;o<a.length;o++){let h=this.parent.getContent().querySelector("tr[data-uid="+a[o]+"]"),d=l[a[o]];d.isCaptionRow&&(this.captionModelGen.isEmpty()?(d.cells[d.indent+1].colSpan=""===i?d.cells[d.indent+1].colSpan+1:d.cells[d.indent+1].colSpan-1,h&&(h.cells[d.indent+1].colSpan=d.cells[d.indent+1].colSpan)):this.changeCaptionRow(d,h,e[s])),d.isDataRow&&(this.showAndHideCells(h,t,i,!1),d.cells[r].visible=""===i),d.isCaptionRow||d.isDataRow||!Object(n.X)(d.indent)||(d.cells[r].visible=""===i,d.visible=d.cells.some(e=>e.isDataCell&&e.visible),this.showAndHideCells(h,t,i,!0,d))}}}else for(let a=0;a<l.length;a++){let r=e[l[a]].querySelectorAll("td.e-rowcell")[t];e[l[a]].querySelectorAll("td.e-rowcell").length&&r&&(Object(n.ob)(e[l[a]].querySelectorAll("td.e-rowcell")[t],{display:i}),e[l[a]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(n.ib)([e[l[a]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),s[l[a]].cells[t].visible=""===i)}}changeCaptionRow(e,t,i){let s=this.groupGenerator.generateCaptionRow(e.data,e.indent,e.parentGid,void 0,e.tIndex,e.parentUid);s.uid=e.uid,s.isExpand=e.isExpand,s.lazyLoadCssClass=e.lazyLoadCssClass,this.rowsByUid[i][e.uid]=s,this.groupCache[i][this.objIdxByUid[i][e.uid]]=s,t&&this.parent.getContentTable().querySelector("tbody").replaceChild(this.rowRenderer.render(s,this.parent.getColumns()),t)}showAndHideCells(e,t,i,s,r){if(e){let l=s?"td.e-summarycell":"td.e-rowcell";Object(n.ob)(e.querySelectorAll(l)[t],{display:i}),e.querySelectorAll(l)[t].classList.contains("e-hide")&&Object(n.ib)([e.querySelectorAll(l)[t]],["e-hide"]),s&&(r.visible&&e.classList.contains("e-hide")?Object(n.ib)([e],["e-hide"]):r.visible||Object(n.v)([e],["e-hide"]))}}}var _s=i("ofXK");const Qs=["template"],Js=["headerTemplate"],$s=["commandsTemplate"],Zs=["filterItemTemplate"],er=["editTemplate"],tr=["filterTemplate"],ir=["footerTemplate"],sr=["groupFooterTemplate"],rr=["groupCaptionTemplate"],nr=["rowTemplate"],lr=["detailTemplate"],ar=["toolbarTemplate"],or=["pagerTemplate"],hr=["editSettingsTemplate"],dr=["groupSettingsCaptionTemplate"];var cr=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l},pr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ur=["allowEditing","allowFiltering","allowGrouping","allowReordering","allowResizing","allowSearching","allowSorting","autoFit","clipMode","columns","commands","customAttributes","dataSource","defaultValue","disableHtmlEncode","displayAsCheckBox","edit","editTemplate","editType","enableGroupByFormat","field","filter","filterBarTemplate","filterTemplate","foreignKeyField","foreignKeyValue","format","formatter","freeze","headerTemplate","headerText","headerTextAlign","headerValueAccessor","hideAtMedia","index","isFrozen","isIdentity","isPrimaryKey","lockColumn","maxWidth","minWidth","showColumnMenu","showInColumnChooser","sortComparer","template","textAlign","type","uid","validationRules","valueAccessor","visible","width"],gr=[],mr=(()=>{class e extends r.b{constructor(e){super(),this.viewContainerRef=e,Object(r.g)("currentInstance",this,this.viewContainerRef),this.registerEvents(gr),this.directivePropList=ur}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(s.O))},e.\u0275dir=s.Ib({type:e,selectors:[["e-column"]],contentQueries:function(e,t,i){var r;1&e&&(s.Gb(i,Qs,!0),s.Gb(i,Js,!0),s.Gb(i,$s,!0),s.Gb(i,Zs,!0),s.Gb(i,er,!0),s.Gb(i,tr,!0)),2&e&&(s.xc(r=s.fc())&&(t.template=r.first),s.xc(r=s.fc())&&(t.headerTemplate=r.first),s.xc(r=s.fc())&&(t.commandsTemplate=r.first),s.xc(r=s.fc())&&(t.filter_itemTemplate=r.first),s.xc(r=s.fc())&&(t.editTemplate=r.first),s.xc(r=s.fc())&&(t.filterTemplate=r.first))},inputs:{allowEditing:"allowEditing",allowFiltering:"allowFiltering",allowGrouping:"allowGrouping",allowReordering:"allowReordering",allowResizing:"allowResizing",allowSearching:"allowSearching",allowSorting:"allowSorting",autoFit:"autoFit",clipMode:"clipMode",columns:"columns",commands:"commands",customAttributes:"customAttributes",dataSource:"dataSource",defaultValue:"defaultValue",disableHtmlEncode:"disableHtmlEncode",displayAsCheckBox:"displayAsCheckBox",edit:"edit",editTemplate:"editTemplate",editType:"editType",enableGroupByFormat:"enableGroupByFormat",field:"field",filter:"filter",filterBarTemplate:"filterBarTemplate",filterTemplate:"filterTemplate",foreignKeyField:"foreignKeyField",foreignKeyValue:"foreignKeyValue",format:"format",formatter:"formatter",freeze:"freeze",headerTemplate:"headerTemplate",headerText:"headerText",headerTextAlign:"headerTextAlign",headerValueAccessor:"headerValueAccessor",hideAtMedia:"hideAtMedia",index:"index",isFrozen:"isFrozen",isIdentity:"isIdentity",isPrimaryKey:"isPrimaryKey",lockColumn:"lockColumn",maxWidth:"maxWidth",minWidth:"minWidth",showColumnMenu:"showColumnMenu",showInColumnChooser:"showInColumnChooser",sortComparer:"sortComparer",template:"template",textAlign:"textAlign",type:"type",uid:"uid",validationRules:"validationRules",valueAccessor:"valueAccessor",visible:"visible",width:"width"},features:[s.ub]}),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"template",void 0),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"headerTemplate",void 0),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"commandsTemplate",void 0),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"filter_itemTemplate",void 0),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"editTemplate",void 0),cr([Object(r.f)(),pr("design:type",Object)],e.prototype,"filterTemplate",void 0),e})(),br=(()=>{class e extends r.a{constructor(){super("columns")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Ib({type:e,selectors:[["e-columns"]],contentQueries:function(e,t,i){var r;1&e&&s.Gb(i,mr,!1),2&e&&s.xc(r=s.fc())&&(t.children=r)},features:[s.ub]}),e})();var fr=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l},yr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Cr=["columnName","customAggregate","field","footerTemplate","format","groupCaptionTemplate","groupFooterTemplate","type"],vr=[],wr=(()=>{class e extends r.b{constructor(e){super(),this.viewContainerRef=e,Object(r.g)("currentInstance",this,this.viewContainerRef),this.registerEvents(vr),this.directivePropList=Cr}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(s.O))},e.\u0275dir=s.Ib({type:e,selectors:[["e-column"]],contentQueries:function(e,t,i){var r;1&e&&(s.Gb(i,ir,!0),s.Gb(i,sr,!0),s.Gb(i,rr,!0)),2&e&&(s.xc(r=s.fc())&&(t.footerTemplate=r.first),s.xc(r=s.fc())&&(t.groupFooterTemplate=r.first),s.xc(r=s.fc())&&(t.groupCaptionTemplate=r.first))},inputs:{columnName:"columnName",customAggregate:"customAggregate",field:"field",footerTemplate:"footerTemplate",format:"format",groupCaptionTemplate:"groupCaptionTemplate",groupFooterTemplate:"groupFooterTemplate",type:"type"},features:[s.ub]}),fr([Object(r.f)(),yr("design:type",Object)],e.prototype,"footerTemplate",void 0),fr([Object(r.f)(),yr("design:type",Object)],e.prototype,"groupFooterTemplate",void 0),fr([Object(r.f)(),yr("design:type",Object)],e.prototype,"groupCaptionTemplate",void 0),e})(),Sr=(()=>{class e extends r.a{constructor(){super("columns")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Ib({type:e,selectors:[["e-columns"]],contentQueries:function(e,t,i){var r;1&e&&s.Gb(i,wr,!1),2&e&&s.xc(r=s.fc())&&(t.children=r)},features:[s.ub]}),e})(),Or=["columns"],xr=[],jr=(()=>{class e extends r.b{constructor(e){super(),this.viewContainerRef=e,this.tags=["columns"],Object(r.g)("currentInstance",this,this.viewContainerRef),this.registerEvents(xr),this.directivePropList=Or}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(s.O))},e.\u0275dir=s.Ib({type:e,selectors:[["e-aggregate"]],contentQueries:function(e,t,i){var r;1&e&&s.Gb(i,Sr,!0),2&e&&s.xc(r=s.fc())&&(t.childColumns=r.first)},inputs:{columns:"columns"},features:[s.ub]}),e})(),Rr=(()=>{class e extends r.a{constructor(){super("aggregates")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Ib({type:e,selectors:[["e-aggregates"]],contentQueries:function(e,t,i){var r;1&e&&s.Gb(i,jr,!1),2&e&&s.xc(r=s.fc())&&(t.children=r)},features:[s.ub]}),e})();var Dr=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l},Er=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ir=["actionBegin","actionComplete","actionFailure","batchAdd","batchCancel","batchDelete","beforeAutoFill","beforeBatchAdd","beforeBatchDelete","beforeBatchSave","beforeCopy","beforeDataBound","beforeExcelExport","beforeOpenColumnChooser","beforePaste","beforePdfExport","beforePrint","beginEdit","cellDeselected","cellDeselecting","cellEdit","cellSave","cellSaved","cellSelected","cellSelecting","checkBoxChange","columnDataStateChange","columnDeselected","columnDeselecting","columnDrag","columnDragStart","columnDrop","columnMenuClick","columnMenuOpen","columnSelected","columnSelecting","commandClick","contextMenuClick","contextMenuOpen","created","dataBound","dataSourceChanged","dataStateChange","destroyed","detailDataBound","excelAggregateQueryCellInfo","excelExportComplete","excelHeaderQueryCellInfo","excelQueryCellInfo","exportDetailDataBound","exportGroupCaption","headerCellInfo","keyPressed","lazyLoadGroupCollapse","lazyLoadGroupExpand","load","pdfAggregateQueryCellInfo","pdfExportComplete","pdfHeaderQueryCellInfo","pdfQueryCellInfo","printComplete","queryCellInfo","recordClick","recordDoubleClick","resizeStart","resizeStop","resizing","rowDataBound","rowDeselected","rowDeselecting","rowDrag","rowDragStart","rowDragStartHelper","rowDrop","rowSelected","rowSelecting","toolbarClick","dataSourceChange"],Mr=["dataSource"];let Fr=(()=>{let e=class extends Qe{constructor(e,t,i,s){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=s,this.tags=["columns","aggregates"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let e=this.injector.get("GridsFilter");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(n){}try{let e=this.injector.get("GridsPage");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(l){}try{let e=this.injector.get("GridsSelection");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(a){}try{let e=this.injector.get("GridsSort");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(o){}try{let e=this.injector.get("GridsGroup");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(h){}try{let e=this.injector.get("GridsReorder");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(d){}try{let e=this.injector.get("GridsRowDD");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(c){}try{let e=this.injector.get("GridsDetailRow");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(p){}try{let e=this.injector.get("GridsToolbar");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(u){}try{let e=this.injector.get("GridsAggregate");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(g){}try{let e=this.injector.get("GridsSearch");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(m){}try{let e=this.injector.get("GridsVirtualScroll");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(b){}try{let e=this.injector.get("GridsEdit");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(f){}try{let e=this.injector.get("GridsResize");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(y){}try{let e=this.injector.get("GridsExcelExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(C){}try{let e=this.injector.get("GridsPdfExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(v){}try{let e=this.injector.get("GridsCommandColumn");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(w){}try{let e=this.injector.get("GridsContextMenu");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(S){}try{let e=this.injector.get("GridsFreeze");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(O){}try{let e=this.injector.get("GridsColumnMenu");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(x){}try{let e=this.injector.get("GridsColumnChooser");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(j){}try{let e=this.injector.get("GridsForeignKey");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(R){}try{let e=this.injector.get("GridsBlazorAction");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(D){}try{let e=this.injector.get("GridsInfiniteScroll");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(E){}try{let e=this.injector.get("GridsLazyLoadGroup");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(I){}this.registerEvents(Ir),this.addTwoWay.call(this,Mr),Object(r.g)("currentInstance",this,this.viewContainerRef),this.context=new r.c}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.tagObjects[0].instance=this.childColumns,this.childAggregates&&(this.tagObjects[1].instance=this.childAggregates),this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(s.Nb(s.l),s.Nb(s.D),s.Nb(s.O),s.Nb(s.r))},e.\u0275cmp=s.Hb({type:e,selectors:[["ejs-grid"]],contentQueries:function(e,t,i){var r;1&e&&(s.Gb(i,nr,!0),s.Gb(i,lr,!0),s.Gb(i,ar,!0),s.Gb(i,or,!0),s.Gb(i,hr,!0),s.Gb(i,dr,!0),s.Gb(i,br,!0),s.Gb(i,Rr,!0)),2&e&&(s.xc(r=s.fc())&&(t.rowTemplate=r.first),s.xc(r=s.fc())&&(t.detailTemplate=r.first),s.xc(r=s.fc())&&(t.toolbarTemplate=r.first),s.xc(r=s.fc())&&(t.pagerTemplate=r.first),s.xc(r=s.fc())&&(t.editSettings_template=r.first),s.xc(r=s.fc())&&(t.groupSettings_captionTemplate=r.first),s.xc(r=s.fc())&&(t.childColumns=r.first),s.xc(r=s.fc())&&(t.childAggregates=r.first))},inputs:{aggregates:"aggregates",allowExcelExport:"allowExcelExport",allowFiltering:"allowFiltering",allowGrouping:"allowGrouping",allowKeyboard:"allowKeyboard",allowMultiSorting:"allowMultiSorting",allowPaging:"allowPaging",allowPdfExport:"allowPdfExport",allowReordering:"allowReordering",allowResizing:"allowResizing",allowRowDragAndDrop:"allowRowDragAndDrop",allowSelection:"allowSelection",allowSorting:"allowSorting",allowTextWrap:"allowTextWrap",childGrid:"childGrid",clipMode:"clipMode",columnChooserSettings:"columnChooserSettings",columnMenuItems:"columnMenuItems",columnQueryMode:"columnQueryMode",columns:"columns",contextMenuItems:"contextMenuItems",currencyCode:"currencyCode",currentAction:"currentAction",dataSource:"dataSource",detailTemplate:"detailTemplate",editSettings:"editSettings",ej2StatePersistenceVersion:"ej2StatePersistenceVersion",enableAltRow:"enableAltRow",enableAutoFill:"enableAutoFill",enableColumnVirtualization:"enableColumnVirtualization",enableHeaderFocus:"enableHeaderFocus",enableHover:"enableHover",enableImmutableMode:"enableImmutableMode",enableInfiniteScrolling:"enableInfiniteScrolling",enablePersistence:"enablePersistence",enableRtl:"enableRtl",enableVirtualization:"enableVirtualization",filterSettings:"filterSettings",frozenColumns:"frozenColumns",frozenRows:"frozenRows",gridLines:"gridLines",groupSettings:"groupSettings",height:"height",hierarchyPrintMode:"hierarchyPrintMode",infiniteScrollSettings:"infiniteScrollSettings",locale:"locale",pageSettings:"pageSettings",pagerTemplate:"pagerTemplate",parentDetails:"parentDetails",printMode:"printMode",query:"query",queryString:"queryString",resizeSettings:"resizeSettings",rowDropSettings:"rowDropSettings",rowHeight:"rowHeight",rowTemplate:"rowTemplate",searchSettings:"searchSettings",selectedRowIndex:"selectedRowIndex",selectionSettings:"selectionSettings",showColumnChooser:"showColumnChooser",showColumnMenu:"showColumnMenu",sortSettings:"sortSettings",textWrapSettings:"textWrapSettings",toolbar:"toolbar",toolbarTemplate:"toolbarTemplate",width:"width"},outputs:{actionBegin:"actionBegin",actionComplete:"actionComplete",actionFailure:"actionFailure",batchAdd:"batchAdd",batchCancel:"batchCancel",batchDelete:"batchDelete",beforeAutoFill:"beforeAutoFill",beforeBatchAdd:"beforeBatchAdd",beforeBatchDelete:"beforeBatchDelete",beforeBatchSave:"beforeBatchSave",beforeCopy:"beforeCopy",beforeDataBound:"beforeDataBound",beforeExcelExport:"beforeExcelExport",beforeOpenColumnChooser:"beforeOpenColumnChooser",beforePaste:"beforePaste",beforePdfExport:"beforePdfExport",beforePrint:"beforePrint",beginEdit:"beginEdit",cellDeselected:"cellDeselected",cellDeselecting:"cellDeselecting",cellEdit:"cellEdit",cellSave:"cellSave",cellSaved:"cellSaved",cellSelected:"cellSelected",cellSelecting:"cellSelecting",checkBoxChange:"checkBoxChange",columnDataStateChange:"columnDataStateChange",columnDeselected:"columnDeselected",columnDeselecting:"columnDeselecting",columnDrag:"columnDrag",columnDragStart:"columnDragStart",columnDrop:"columnDrop",columnMenuClick:"columnMenuClick",columnMenuOpen:"columnMenuOpen",columnSelected:"columnSelected",columnSelecting:"columnSelecting",commandClick:"commandClick",contextMenuClick:"contextMenuClick",contextMenuOpen:"contextMenuOpen",created:"created",dataBound:"dataBound",dataSourceChanged:"dataSourceChanged",dataStateChange:"dataStateChange",destroyed:"destroyed",detailDataBound:"detailDataBound",excelAggregateQueryCellInfo:"excelAggregateQueryCellInfo",excelExportComplete:"excelExportComplete",excelHeaderQueryCellInfo:"excelHeaderQueryCellInfo",excelQueryCellInfo:"excelQueryCellInfo",exportDetailDataBound:"exportDetailDataBound",exportGroupCaption:"exportGroupCaption",headerCellInfo:"headerCellInfo",keyPressed:"keyPressed",lazyLoadGroupCollapse:"lazyLoadGroupCollapse",lazyLoadGroupExpand:"lazyLoadGroupExpand",load:"load",pdfAggregateQueryCellInfo:"pdfAggregateQueryCellInfo",pdfExportComplete:"pdfExportComplete",pdfHeaderQueryCellInfo:"pdfHeaderQueryCellInfo",pdfQueryCellInfo:"pdfQueryCellInfo",printComplete:"printComplete",queryCellInfo:"queryCellInfo",recordClick:"recordClick",recordDoubleClick:"recordDoubleClick",resizeStart:"resizeStart",resizeStop:"resizeStop",resizing:"resizing",rowDataBound:"rowDataBound",rowDeselected:"rowDeselected",rowDeselecting:"rowDeselecting",rowDrag:"rowDrag",rowDragStart:"rowDragStart",rowDragStartHelper:"rowDragStartHelper",rowDrop:"rowDrop",rowSelected:"rowSelected",rowSelecting:"rowSelecting",toolbarClick:"toolbarClick",dataSourceChange:"dataSourceChange"},features:[s.ub],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"rowTemplate",void 0),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"detailTemplate",void 0),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"toolbarTemplate",void 0),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"pagerTemplate",void 0),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"editSettings_template",void 0),Dr([Object(r.f)(),Er("design:type",Object)],e.prototype,"groupSettings_captionTemplate",void 0),e=Dr([Object(r.d)([r.c]),Er("design:paramtypes",[s.l,s.D,s.O,s.r])],e),e})(),Tr=(()=>{class e{}return e.\u0275mod=s.Lb({type:e}),e.\u0275inj=s.Kb({factory:function(t){return new(t||e)},imports:[[_s.b]]}),e})();const kr={provide:"GridsFilter",useValue:Yi},zr={provide:"GridsPage",useValue:Bi},Ar={provide:"GridsSelection",useValue:De},Lr={provide:"GridsSort",useValue:Mi},Br={provide:"GridsGroup",useValue:Qi},Pr={provide:"GridsReorder",useValue:class{constructor(e){this.parent=e,this.parent.isDestroyed||(this.parent.on("header-drop",this.headerDrop,this),this.parent.on(x,this.enableAfterRender,this),this.parent.on("reorder-complete",this.onActionComplete,this),this.parent.on("columnDrag",this.drag,this),this.parent.on("columnDragStart",this.dragStart,this),this.parent.on("column-drag-stop",this.dragStop,this),this.parent.on("header-drop",this.headerDrop,this),this.parent.on(E,this.createReorderElement,this),this.parent.on(I,this.keyPressHandler,this))}chkDropPosition(e,t){let i=this.parent.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),s=!i||!i.lockColumn;return(e.parentElement.isEqualNode(t.parentElement)||this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()&&Array.prototype.indexOf.call(Object(n.C)(e,"thead").children,e.parentElement)===Array.prototype.indexOf.call(Object(n.C)(t,"thead").children,t.parentElement))&&this.targetParentContainerIndex(e,t)>-1&&s}chkDropAllCols(e,t){let i,s,r=this.getHeaderCells();for(;!i&&r.length>0;)s=r.pop(),i=e!==s&&this.targetParentContainerIndex(e,t)>-1;return i}findColParent(e,t,i){i=i;for(let s=0,r=t.length;s<r;s++){if(e===t[s])return!0;if(t[s].columns){let r=i.length;if(i.push(t[s]),this.findColParent(e,t[s].columns,i))return!0;i.splice(r,i.length-r)}}return!1}getColumnsModel(e){let t=[],i=[];if(!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid())return this.parent.getColumns();for(let s=0,r=e.length;s<r;s++)t.push(e[s]),e[s].columns&&(i=i.concat(e[s].columns));return i.length&&(t=t.concat(this.getColumnsModel(i))),t}headerDrop(e){let t=this.parent,i=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),s=t.getColumnByUid(i);if(!Object(n.C)(e.target,"th")||!Object(n.X)(s)&&(!s.allowReordering||s.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:s});let r=Object(n.C)(e.target,".e-headercell"),l=(r.querySelector(".e-headercelldiv")||r.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");if(!Object(n.X)(l)){let e=t.getColumnByUid(l);if(Object(n.X)(e)||!e.allowReordering||e.lockColumn)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:s,destColumn:e})}if(r&&this.chkDropPosition(this.element,r)&&this.chkDropAllCols(this.element,r))if(this.parent.enableColumnVirtualization){let e=this.parent.columns,t=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),i=this.parent.columns.filter(e=>e.uid===t),s=null,l=i[0],a=r.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");e.some((e,t)=>e.uid===a&&(s=t,e.uid===a)),Object(n.X)(s)||this.moveColumns(s,l)}else{let e=this.targetParentContainerIndex(this.element,r),t=this.element.firstElementChild.getAttribute("e-mappinguid");if(this.destElement=r,this.parent.notify("set-reorder-destination-element",{ele:r}),t)this.moveColumns(e,this.parent.getColumnByUid(t));else{let t=this.getHeaderCells(),i=bt(this.element,t),s=this.getColumnsModel(this.parent.columns);this.moveColumns(e,s[i])}}}isActionPrevent(e){return kt(e)}moveColumns(e,t,i,s){let r=this.parent;if(this.isActionPrevent(r))return void r.notify(z,{instance:this,handler:this.moveColumns,arg1:e,arg2:t});let n=!r.getFrozenColumns()&&r.isFrozenGrid(),l=this.getColParent(t,this.parent.columns),a=l?l.columns:n?this.parent.getColumns():this.parent.columns,o=ft(t,a);if((this.parent.isFrozenGrid()&&l||this.parent.lockcolPositionCount)&&!i){for(let e=0;e<a.length;e++)if(a[e].field===t.field){o=e;break}let i=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid"));if(i){for(let t=0;t<a.length;t++)if(a[t].field===i.field){e=t;break}}else for(let t=0;t<a.length;t++)a[t].headerText===this.destElement.innerText.trim()&&(e=t)}if(!r.allowReordering||o===e||-1===o||-1===e)return;a.splice(e,0,a.splice(o,1)[0]);let h={column:t,destIndex:e,columns:a,parent:l,cancel:!1};r.notify("refresh-frozen-columns",h),h.cancel||(r.getColumns(!0),r.notify("column-position-changed",{fromIndex:e,toIndex:o}),!1!==s&&r.notify(D,{type:f,requestType:"reorder",fromIndex:e,toIndex:o,toColumnUid:t.uid}))}targetParentContainerIndex(e,t){let i=!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid()?this.parent.getColumns():this.parent.columns,s=this.getHeaderCells(),r=this.getColumnsModel(i),n=this.getColParent(r[bt(e,s)],i);return i=n?n.columns:i,ft(r[bt(t,s)],i)}getHeaderCells(){let e=this.parent.getFrozenColumns();if(e||this.parent.lockcolPositionCount){let t,i,s=[],r=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-columnheader"));if(e){let e=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll(".e-columnheader"));for(let n=0;n<r.length;n++){let l;t=[].slice.call(r[n].getElementsByClassName("e-headercell")),i=[].slice.call(e[n].getElementsByClassName("e-headercell"));for(let e=0;e<t.length;e++){for(let s=0;s<i.length;s++)if(i[s].innerText===t[e].innerText){l=!0;break}l||(s=s.concat([t[e]]))}for(let e=0;e<i.length;e++)s.push(i[e])}}else for(let e=0;e<r.length;e++){i=[].slice.call(r[e].getElementsByClassName("e-headercell"));for(let e=0;e<i.length;e++){let t;for(let s=e+1;s<i.length;s++)if(i[s].innerText===i[e].innerText){t=!0;break}t||(s=s.concat([i[e]]))}}return s}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))}getColParent(e,t){let i=[];return this.findColParent(e,t,i),i[i.length-1]}reorderSingleColumn(e,t){let i=this.parent.enableColumnVirtualization?this.parent.columns.filter(t=>t.field===e)[0]:this.parent.getColumnByField(e),s=this.parent.enableColumnVirtualization?this.parent.columns.filter(e=>e.field===t)[0]:this.parent.getColumnByField(t);if(!Object(n.X)(i)&&(!i.allowReordering||i.lockColumn)||!Object(n.X)(s)&&(!s.allowReordering||i.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:s});let r=s,l=this.getColParent(r,this.parent.columns),a=ft(r,l?l.columns:this.parent.columns);a>-1&&this.moveColumns(a,i,!0)}reorderMultipleColumns(e,t){let i=this.parent.getColumnIndexByField(t),s=this.parent.getColumnByField(t);if(!(i<0)&&(Object(n.X)(s)||s.allowReordering&&!s.lockColumn)){for(let t=0;t<e.length;t++){let i=this.parent.getColumnByField(e[t]);if(!Object(n.X)(i)&&(!i.allowReordering||i.lockColumn))return}for(let t=0;t<e.length;t++){let s=this.parent.getColumnByIndex(i),r=this.getColParent(s,this.parent.columns),l=ft(s,r?r.columns:this.parent.columns);l>-1&&this.moveColumns(l,this.parent.getColumnByField(e[t]),!0,!(Object(n.W)()&&!this.parent.isJsComponent)),this.parent.getColumnIndexByField(e[t+1])>=l&&i++}if(Object(n.W)()&&!this.parent.isJsComponent){let t=this.parent.getColumns();this.parent.notify(D,{fromColumnUid:e.map(e=>t.filter(t=>t.field===e)[0].uid),toColumnUid:s.uid,isMultipleReorder:!0,requestType:"reorder",type:"actionBegin"})}}}moveTargetColumn(e,t){t>-1&&this.moveColumns(t,e,!0)}reorderSingleColumnByTarget(e,t){let i=this.parent.getColumnByField(e);this.moveTargetColumn(i,t)}reorderMultipleColumnByTarget(e,t){for(let i=0;i<e.length;i++)this.reorderSingleColumnByTarget(e[i],t)}reorderColumns(e,t){"string"==typeof e?(this.reorderSingleColumn(e,t),this.fromCol=e):(this.reorderMultipleColumns(e,t),this.fromCol=e[0])}reorderColumnByIndex(e,t){let i=this.parent.getColumnByIndex(e);this.moveTargetColumn(i,t)}reorderColumnByTargetIndex(e,t){"string"==typeof e?this.reorderSingleColumnByTarget(e,t):this.reorderMultipleColumnByTarget(e,t)}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.createReorderElement()}createReorderElement(e){e&&e.args.isXaxis&&this.setDisplay("none");let t=this.parent.element.querySelector(".e-headercontent");this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}})),this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))}onActionComplete(e){Object(n.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(y,Object(n.K)(e,{type:y}));let t=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);t&&this.parent.focusModule.onClick({target:t},!0)}destroy(){let e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(Object(n.hb)(this.upArrow),Object(n.hb)(this.downArrow),this.parent.off("header-drop",this.headerDrop),this.parent.off(x,this.enableAfterRender),this.parent.off("reorder-complete",this.onActionComplete),this.parent.off("columnDrag",this.drag),this.parent.off("columnDragStart",this.dragStart),this.parent.off("column-drag-stop",this.dragStop),this.parent.off(E,this.createReorderElement),this.parent.off(I,this.keyPressHandler))}keyPressHandler(e){let t=this.parent;switch(e.action){case"ctrlLeftArrow":case"ctrlRightArrow":let i=t.focusModule.currentInfo.element;if(i&&i.classList.contains("e-headercell")){let s=t.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid")),r=t.getVisibleColumns(),n=r.indexOf(s),l="ctrlLeftArrow"===e.action?r[n-1]:r[n+1];l&&l.field&&s.field&&this.reorderColumns(s.field,l.field)}}}drag(e){let t=this.parent,i=e.target;if(!e.column.allowReordering||e.column.lockColumn)return;let s=Object(n.C)(i,".e-headercell:not(.e-stackedHeaderCell)"),r=t.element.querySelector(".e-cloneproperties"),l=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild,a=this.x>vt(e.event).x+l.scrollLeft;Object(n.ib)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"]),this.setDisplay("none"),this.stopTimer(),Object(n.A)(r,["e-defaultcur"],["e-notallowedcur"]),this.updateScrollPostion(e.event),s&&!s.isEqualNode(this.element)&&(i=s,this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i)?(this.updateArrowPosition(i,a),Object(n.A)(i,["e-allowDrop","e-reorderindicate"],[])):t.allowGrouping&&mt(e.target,"e-groupdroparea")||Object(n.A)(r,["e-notallowedcur"],["e-defaultcur"])),t.trigger("columnDrag",{target:i,draggableType:"headercell",column:e.column})}updateScrollPostion(e){let t=vt(e).x,i=this.parent.element.getBoundingClientRect(),s=i.right;if(this.parent.isFrozenGrid())this.updateFrozenScrollPosition(t,i);else{let e=i.left,r=this.parent.getContent().firstElementChild;t>e&&t<e+35?this.timer=window.setInterval(()=>{this.setScrollLeft(r,!0)},50):t<s&&t>s-35&&(this.timer=window.setInterval(()=>{this.setScrollLeft(r,!1)},50))}}updateFrozenScrollPosition(e,t){let i=this.parent.getContent().querySelector(".e-movablecontent"),s=this.parent.element.querySelector(".e-movableheader").getBoundingClientRect(),r=this.parent.getFrozenLeftCount(),n=this.parent.getFrozenRightColumnsCount()?s.right:t.right,l=r?s.left:t.left;e>l&&e<l+35?this.timer=window.setInterval(()=>{this.setScrollLeft(i,!0)},50):e<n&&e>n-35&&(this.timer=window.setInterval(()=>{this.setScrollLeft(i,!1)},50))}setScrollLeft(e,t){let i=e.scrollLeft;e.scrollLeft=e.scrollLeft+(t?-5:5),i!==e.scrollLeft&&this.setDisplay("none")}stopTimer(){window.clearInterval(this.timer)}updateArrowPosition(e,t){let i=e.getBoundingClientRect(),s=this.parent.element.getBoundingClientRect();if(!(t&&i.left<s.left||!t&&i.right>s.right)){if(this.parent.isFrozenGrid()&&e.classList.contains("e-headercell")){let s=this.parent.getFrozenLeftCount(),r=this.parent.getFrozenRightColumnsCount(),n=this.element.querySelector(".e-headercelldiv"),l=n?this.parent.getColumnByUid(n.getAttribute("data-uid")):null,a=this.parent.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid")),o=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),h=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(a){if(s&&!r&&this.parent.getNormalizedColumnIndex(a.uid)>=s&&(t&&Math.round(i.left)<o||!t&&h<i.right))return;if(!s&&r&&l&&l.getFreezeTableName()!==a.getFreezeTableName()&&!t&&Math.round(i.right)<o)return}}this.upArrow.style.top=i.top+i.height-s.top+"px",this.downArrow.style.top=i.top-s.top-4+"px",this.upArrow.style.left=this.downArrow.style.left=(t?i.left:i.right)-s.left-4+"px",this.setDisplay("")}}dragStart(e){let t=this.parent,i=e.target;if(this.element=i.classList.contains("e-headercell")?i:mt(i,"e-headercell"),!e.column.allowReordering||e.column.lockColumn)return;let s=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild;this.x=vt(e.event).x+s.scrollLeft,t.trigger("columnDragStart",{target:i,draggableType:"headercell",column:e.column})}dragStop(e){let t=this.parent;this.setDisplay("none"),this.stopTimer(),e.cancel||t.trigger("columnDrop",{target:e.target,draggableType:"headercell",column:e.column}),Object(n.ib)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"])}setDisplay(e){this.upArrow.style.display=e,this.downArrow.style.display=e}getModuleName(){return"reorder"}}},qr={provide:"GridsRowDD",useValue:class{constructor(e){this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.isReplaceDragEle=!0,this.helper=e=>{let t=this.parent,i=this.draggable.currentStateTarget,s=this.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+t.element.offsetWidth}),r=this.parent.createElement("table",{styles:"width:"+t.element.offsetWidth}),l=this.parent.createElement("tbody");if(document.getElementsByClassName("e-griddragarea").length||t.rowDropSettings.targetID&&!i.classList.contains("e-selectionbackground")&&"Single"!==t.selectionSettings.type||!t.rowDropSettings.targetID&&!mt(e.sender.target,"e-rowdragdrop"))return!1;t.rowDropSettings.targetID&&"Row"===t.selectionSettings.mode&&"Single"===t.selectionSettings.type&&t.selectRow(parseInt(this.draggable.currentStateTarget.parentElement.getAttribute("aria-rowindex"),10)),this.startedRow=Object(n.C)(i,"tr").cloneNode(!0);let a=this.parent.isFrozenGrid();if(a){let e=parseInt(Object(n.C)(i,"tr").getAttribute("aria-rowindex"),10),t=Ci(this.parent);this.startedRow.innerHTML="",fi(this.parent,(t,i)=>{this.startedRow.innerHTML+=i[e].innerHTML},t)}this.processArgs(i);let o={selectedRow:this.rows,dragelement:i,cloneElement:s,cancel:!1,data:this.rowData},h=t.getSelectedRows();if(t.trigger("rowDragStartHelper",o),o.cancel)return!1;Ct(this.startedRow,".e-indentcell"),Ct(this.startedRow,".e-detailrowcollapse"),Ct(this.startedRow,".e-detailrowexpand"),this.removeCell(this.startedRow,"e-gridchkbox");let d=new RegExp("e-active","g");if(this.startedRow.innerHTML=this.startedRow.innerHTML.replace(d,""),l.appendChild(this.startedRow),t.getSelectedRowIndexes().length>1&&this.startedRow.hasAttribute("aria-selected")){let e="Left-Right"===t.getFrozenMode()?3:2,i=this.parent.createElement("span",{className:"e-dropitemscount",innerHTML:a?""+h.length/e:""+h.length});s.appendChild(i)}let c=Object(n.C)(i,"tr").querySelector(".e-icon-rowdragicon");return c&&c.classList.add("e-dragstartrow"),r.appendChild(l),s.appendChild(r),t.element.appendChild(s),s},this.dragStart=e=>{let t=this.parent;if(document.getElementsByClassName("e-griddragarea").length)return;let i=e.target;const s=this.parent.element.querySelector(".e-dropitemscount");this.parent.getSelectedRecords().length>1&&s&&(s.style.left=this.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),this.processArgs(i),t.trigger("rowDragStart",{rows:Object(n.W)()?null:this.rows,target:Object(n.W)()?null:e.target,draggableType:"rows",fromIndex:parseInt(this.rows[0].getAttribute("aria-rowindex"),10),data:Object.keys(this.rowData[0]).length>0?this.rowData:this.currentViewData()}),Object(n.W)()&&e.bindEvents(e.dragElement),this.dragStartData=this.rowData;let r=document.getElementById(t.rowDropSettings.targetID);t.rowDropSettings.targetID&&r&&r.ej2_instances&&"grid"===r.ej2_instances[0].getModuleName()&&r.ej2_instances[0].getContent().classList.add("e-allowRowDrop")},this.drag=e=>{let t=this.parent,i=this.parent.element.querySelector(".e-cloneproperties"),s=this.getElementFromPosition(i,e.event);Object(n.A)(i,["e-defaultcur"],["e-notallowedcur","e-movecur"]),this.isOverflowBorder=!0,this.hoverState=t.enableHover;let r=mt(s,"e-grid")?Object(n.C)(e.target,"tr"):null;if(t.enableHover=!1,!e.target)return;this.processArgs(s);let l={rows:this.rows,target:s,draggableType:"rows",data:this.rowData,originalEvent:e,cancel:!1};if(t.trigger("rowDrag",l),this.stopTimer(),!l.cancel){if(t.element.classList.add("e-rowdrag"),this.dragTarget=r&&mt(s,"e-grid").id===i.parentElement.id?parseInt(r.getAttribute("aria-rowindex"),10):parseInt(this.startedRow.getAttribute("aria-rowindex"),10),t.rowDropSettings.targetID)mt(s,"e-grid")&&mt(i.parentElement,"e-grid").id!==mt(s,"e-grid").id?Object(n.A)(i,["e-defaultcur"],["e-notallowedcur"]):Object(n.A)(i,["e-notallowedcur"],["e-defaultcur"]);else{let e=mt(s,"e-grid");e&&e.id===i.parentElement.id?Object(n.A)(i,["e-movecur"],["e-defaultcur"]):Object(n.A)(i,["e-notallowedcur"],["e-movecur"])}if(!t.rowDropSettings.targetID&&(!t.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground")))if(mt(s,"e-grid")&&this.updateScrollPostion(e.event,s),(this.isOverflowBorder||this.parent.frozenRows>this.dragTarget)&&parseInt(this.startedRow.getAttribute("aria-rowindex"),10)!==this.dragTarget)this.moveDragRows(e,this.startedRow,r);else{if(r&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")===r.getAttribute("data-uid")){let e=this.parent.createElement("div",{className:"e-lastrow-dragborder"}),t=this.parent.getContent();e.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",t.querySelectorAll(".e-lastrow-dragborder").length||(t.classList.add("e-grid-relative"),t.appendChild(e),e.style.bottom=this.getScrollWidth()+"px")}this.removeBorder(r)}}},this.dragStop=e=>{kt(this.parent)?this.parent.notify(z,{instance:this,handler:this.processDragStop,arg1:e}):this.processDragStop(e)},this.processDragStop=e=>{let t=this.parent;if(this.parent.isDestroyed)return;let i=this.getElementFromPosition(e.helper,e.event),s=i&&!i.classList.contains("e-dlg-overlay")?i:e.target;this.parent.element.querySelector(".e-cloneproperties"),t.element.classList.remove("e-rowdrag");let r=document.getElementById(t.rowDropSettings.targetID);if(t.rowDropSettings.targetID&&r&&r.ej2_instances&&"grid"===r.ej2_instances[0].getModuleName()&&r.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),t.isRowDragable()){this.stopTimer(),t.enableHover=this.hoverState,this.parent.getContent().classList.remove("e-grid-relative"),this.removeBorder(i);let e=t.element.querySelector(".e-dragstartrow");e&&e.classList.remove("e-dragstartrow")}this.processArgs(s);let a={target:Object(n.W)()?null:s,draggableType:"rows",cancel:!1,fromIndex:parseInt(this.rows[0].getAttribute("aria-rowindex"),10),dropIndex:this.dragTarget,rows:Object(n.W)()?null:this.rows,data:Object.keys(this.dragStartData[0]).length>0?this.dragStartData:this.currentViewData()};t.trigger("rowDrop",a,()=>{if(!mt(s,"e-row")&&!mt(s,"e-emptyrow")||a.cancel)return this.dragTarget=null,void Object(n.hb)(e.helper);this.isRefresh=!1;let i=this.parent.getSelectedRowIndexes();if(t.isRowDragable()){if(Object(n.W)()){let e=this.parent.getSelectedRecords().length?this.parent.getSelectedRecords():this.currentViewData(),t={addedRecords:[],deletedRecords:e,changedRecords:[]},i=this.dragTarget?this.dragTarget:a.dropIndex,s="dragDropDestinationIndex",r=new l.g;r[s]=i,this.saveChange(t,r),t.deletedRecords=[],t.addedRecords=e,this.saveChange(t,r)}else!this.parent.rowDropSettings.targetID&&this.startedRow.querySelector("td.e-selectionbackground")&&i.length>1&&i.length!==this.parent.getCurrentViewRecords().length?this.reorderRows(i,a.dropIndex):this.reorderRows([parseInt(this.startedRow.getAttribute("aria-rowindex"),10)],this.dragTarget);this.dragTarget=null,t.rowDropSettings.targetID||(Object(n.hb)(e.helper),this.rowOrder(a))}this.isRefresh=!0})},this.removeCell=(e,t)=>[].slice.call(e.querySelectorAll("td")).filter(i=>{i.classList.contains(t)&&e.deleteCell(i.cellIndex)}),this.parent=e,this.parent.isDestroyed||(this.parent.on(w,this.initializeDrag,this),this.parent.on("columnDrop",this.columnDrop,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(C,this.onDataBoundFn),this.parent.on(x,this.enableAfterRender,this))}refreshRow(e,t,i,s){let r,n,l,a,o,h,d,c=this.parent,p=c.isFrozenGrid(),u="Left-Right"===c.getFrozenMode(),g=c.getContentTable().querySelector("tbody"),m=c.getHeaderTable().querySelector("tbody");p&&(a=c.getMovableHeaderTbody(),o=c.getMovableContentTbody(),u&&(h=c.getFrozenRightHeaderTbody(),d=c.getFrozenRightContentTbody()));let b=parseInt(e.target.parentElement.getAttribute("aria-rowindex"),10);(e.fromIndex<e.dropIndex||e.fromIndex===e.dropIndex)&&(b+=1),r=t.querySelectorAll(".e-row")[b],p&&(n=i.querySelectorAll(".e-row")[b],u&&(l=s.querySelectorAll(".e-row")[b]));let f="Left-Right"===c.getFrozenMode()?3:2;for(let w=0,S=e.rows.length;w<S;w++)p?1===e.rows.length?(e.rows[w]=t.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)],e.rows[w+1]=i.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)],u&&(e.rows[w+2]=s.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)])):w%f==0?e.rows[w]=t.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)]:w%f==1?e.rows[w]=i.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)]:u&&w%f==2&&(e.rows[w]=s.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)]):e.rows[w]=t.children[parseInt(e.rows[w].getAttribute("aria-rowindex"),10)];for(let w=0,S=e.rows.length;w<S;w++)p?w%f==0?t.insertBefore(e.rows[w],r):w%f==1?i.insertBefore(e.rows[w],n):s.insertBefore(e.rows[w],l):t.insertBefore(e.rows[w],r);let y,C,v=[].slice.call(t.querySelectorAll(".e-row"));if(p&&(y=[].slice.call(i.querySelectorAll(".e-row")),u&&(C=[].slice.call(s.querySelectorAll(".e-row")))),this.refreshData(v,y,C),this.parent.frozenRows)for(let w=0,S=v.length;w<S;w++)w<this.parent.frozenRows?Ri(m,a,h,v,y,C,(e,t)=>{e.appendChild(t[w])}):Ri(g,o,d,v,y,C,(e,t)=>{e.appendChild(t[w])})}updateFrozenRowreOrder(e){let t,i,s,r,n=this.parent,l=this.parent.isFrozenGrid(),a="Left-Right"===n.getFrozenMode(),o=n.getContentTable().querySelector("tbody"),h=n.getHeaderTable().querySelector("tbody");l&&(t=n.getMovableHeaderTbody(),i=n.getMovableContentTbody(),a&&(s=n.getFrozenRightHeaderTbody(),r=n.getFrozenRightContentTbody()));let d,c,p=[].slice.call(h.querySelectorAll(".e-row")).concat([].slice.call(o.querySelectorAll(".e-row")));l&&(d=[].slice.call(t.querySelectorAll(".e-row")).concat([].slice.call(i.querySelectorAll(".e-row"))),a&&(c=[].slice.call(s.querySelectorAll(".e-row")).concat([].slice.call(r.querySelectorAll(".e-row")))));let u=n.createElement("tbody"),g=n.createElement("tbody"),m=n.createElement("tbody");this.parent.clearSelection();for(let b=0,f=p.length;b<f;b++)u.appendChild(p[b]),l&&(g.appendChild(d[b]),a&&m.appendChild(c[b]));this.refreshRow(e,u,g,m)}updateFrozenColumnreOrder(e){let t,i,s=this.parent,r=this.parent.isFrozenGrid(),n=s.getContentTable().querySelector("tbody");r&&(t=s.getMovableContentTbody(),"Left-Right"===s.getFrozenMode()&&(i=s.getFrozenRightContentTbody())),this.parent.clearSelection(),this.refreshRow(e,n,t,i)}refreshData(e,t,i){let s={},r={},n={},l={};for(let a=0,o=e.length;a<o;a++){let t=parseInt(e[a].getAttribute("aria-rowindex"),10);s[a]=this.parent.getRowsObject()[t],l[a]=this.parent.getCurrentViewRecords()[t],this.parent.isFrozenGrid()&&(r[a]=this.parent.getMovableRowsObject()[t],i&&(n[a]=this.parent.getFrozenRightRowsObject()[t]))}for(let a=0,o=e.length;a<o;a++)e[a].setAttribute("aria-rowindex",a.toString()),e[a].setAttribute("data-uid","grid-row"+a.toString()),this.parent.getRows()[a]=e[a],this.parent.getRowsObject()[a]=s[a],this.parent.getRowsObject()[a].uid="grid-row"+a.toString(),this.parent.getRowsObject()[a].index=a,this.parent.getCurrentViewRecords()[a]=l[a],this.parent.isFrozenGrid()&&(t[a].setAttribute("aria-rowindex",a.toString()),t[a].setAttribute("data-uid","grid-row"+(a+e.length).toString()),this.parent.getMovableRows()[a]=t[a],this.parent.getMovableRowsObject()[a]=r[a],this.parent.getMovableRowsObject()[a].uid="grid-row"+(a+e.length).toString(),this.parent.getMovableRowsObject()[a].index=a,i&&(i[a].setAttribute("aria-rowindex",a.toString()),i[a].setAttribute("data-uid","grid-row"+(a+e.length).toString()),this.parent.getFrozenRightRows()[a]=i[a],this.parent.getFrozenRightRowsObject()[a]=n[a],this.parent.getFrozenRightRowsObject()[a].uid="grid-row"+(a+e.length).toString(),this.parent.getFrozenRightRowsObject()[a].index=a))}rowOrder(e){e.target.classList.contains("e-rowcelldrag")&&(e.target=e.target.parentElement),this.parent.frozenRows?this.updateFrozenRowreOrder(e):this.updateFrozenColumnreOrder(e),this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])}currentViewData(){let e=this.parent.getSelectedRowIndexes(),t=[],i=parseInt(this.startedRow.getAttribute("aria-rowindex"),10);for(let s=0,r=e.length;s<r;s++)t[s]=this.parent.currentViewData[e[s]];return this.parent.rowDropSettings.targetID||0!==e.length||(t[0]=this.parent.currentViewData[i]),t}saveChange(e,t){this.parent.getDataModule().saveChanges(e,this.parent.getPrimaryKeyFieldNames()[0],{},t).then(()=>{this.parent.notify(D,{type:f,requestType:"rowdraganddrop"})}).catch(e=>{Object(n.X)(e.error)||Object(n.X)(e.error.message)||(e.error=e.error.message),this.parent.trigger("actionFailure",e)})}reorderRows(e,t){let i=this.parent.getSelectedRowIndexes(),s=[],r=[],n=this.parent.renderModule.data.dataManager.dataSource.json,l=t,a=e[0];for(let o=0,h=e.length;o<h;o++)r[o]=n[e[o]];for(let o=0,h=i.length;o<h;o++)s[o]=n[i[o]];for(let o=0,h=r.length;o<h;o++){if(0!==o){for(let e=0,t=n.length;e<t;e++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[e])===JSON.stringify(r[o])){a=e;break}for(let e=0,t=n.length;e<t;e++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[e])===JSON.stringify(r[o-1])){a>e&&(l=e+1);break}}this.reorderRow(a,l)}this.isRefresh&&this.parent.notify(D,{type:f,requestType:"rowdraganddrop"});for(let o=0,h=s.length;o<h;o++)for(let e=0,t=n.length;e<t;e++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[e])===JSON.stringify(s[o])){i[o]=e;break}this.selectedRowColls=i}stopTimer(){window.clearInterval(this.timer)}initializeDrag(){this.draggable=new n.i(this.parent.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle})}updateScrollPostion(e,t){let i=vt(e).y,s=this.parent.getContent().getBoundingClientRect(),r=this.parent.getRowHeight()-15,n=this.parent.getContent().firstElementChild;if(s.top+r>=i){let e=-this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(()=>{this.setScrollDown(n,e,!0)},200)}else if(s.top+this.parent.getContent().clientHeight-r-33<=i){let e=this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(()=>{this.setScrollDown(n,e,!0)},200)}}setScrollDown(e,t,i){e.scrollTop=e.scrollTop+t}moveDragRows(e,t,i){let s=this.parent.element.querySelector(".e-cloneproperties"),r=Object(n.C)(e.target,"tr");mt(r,"e-grid")&&mt(s.parentElement,"e-grid").id===mt(r,"e-grid").id&&this.setBorder(r||this.startedRow,e.event,t,i)}setBorder(e,t,i,s){let r=this.parent.element,l=this.parent.element.querySelector(".e-cloneproperties");if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),mt(e,"e-grid")&&mt(l.parentElement,"e-grid").id===mt(e,"e-grid").id){Object(n.ib)(r.querySelectorAll(".e-rowcell,.e-rowdragdrop"),["e-dragborder"]);let t=[],l=parseInt(s.getAttribute("aria-rowindex"),10);if(s&&0===l){let e=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),t=this.parent.getHeaderContent();t.classList.add("e-grid-relative"),e.style.width=r.offsetWidth-this.getScrollWidth()+"px",t.querySelectorAll(".e-firstrow-dragborder").length||t.appendChild(e)}else s&&parseInt(i.getAttribute("aria-rowindex"),10)>l?(e=this.parent.getRowByIndex(l-1),t=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):t=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));let a=this.parent.isFrozenGrid();if(s&&0!==l&&a){let i=parseInt(e.getAttribute("aria-rowindex"),10),s=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse";t=[],fi(this.parent,(e,r)=>{t=t.concat([].slice.call(r[i].querySelectorAll(s)))},Ci(this.parent))}t.length>0&&Lt(t,!0,"e-dragborder")}}getScrollWidth(){let e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?Me.getScrollBarWidth():0}removeFirstRowBorder(e){this.parent.element.getElementsByClassName("e-firstrow-dragborder").length>0&&e&&0!==e.rowIndex&&Object(n.hb)(this.parent.element.getElementsByClassName("e-firstrow-dragborder")[0])}removeLastRowBorder(e){let t=e&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid");this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&e&&t&&Object(n.hb)(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])}removeBorder(e){if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),e=this.parent.getRows().filter(e=>e.querySelector("td.e-dragborder"))[0]){let t=[].slice.call(e.querySelectorAll(".e-dragborder"));if(this.parent.isFrozenGrid()){let i=parseInt(e.getAttribute("aria-rowindex"),10);t=[],fi(this.parent,(e,s)=>{t=t.concat([].slice.call(s[i].querySelectorAll(".e-dragborder")))},Ci(this.parent))}Lt(t,!1,"e-dragborder")}}getElementFromPosition(e,t){let i,s=vt(t);return e.style.display="none",i=document.elementFromPoint(s.x,s.y),e.style.display="",i}onDataBound(e){this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])}getTargetIdx(e){return e?parseInt(e.getAttribute("aria-rowindex"),10):0}singleRowDrop(e){let t,i,s=Object(n.C)(e.target,"tr");i=e.droppedElement.parentElement.ej2_instances[0],t=s?s.rowIndex:i.currentViewData.length-1,this.reorderRow(this.startedRowIndex,t)}columnDrop(e){let t=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")&&(mt(e.target,"e-row")||mt(e.target,"e-emptyrow"))){let i,s,r=Object(n.C)(e.target,"tr");if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id===t.element.id||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==t.element.id)return;if(e.droppedElement.parentElement.id!==t.element.id)i=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(i.element.id!==t.element.id&&i.rowDropSettings.targetID!==t.element.id)return;let a=i.getSelectedRecords(),o=s=this.getTargetIdx(r);if(isNaN(o)&&(o=s=0),t.allowPaging&&(o=o+t.pageSettings.currentPage*t.pageSettings.pageSize-t.pageSettings.pageSize),Object(n.W)()){let e=[],s=i.getSelectedRowIndexes();for(let t=0;t<s.length;t++)e[t]=i.currentViewData[s[t]];a=e;let r={addedRecords:a,deletedRecords:[],changedRecords:[]},h="dragDropDestinationIndex",d=new l.g;d[h]=o,t.getDataModule().saveChanges(r,t.getPrimaryKeyFieldNames()[0],{},d).then(()=>{t.notify(D,{type:f,requestType:"rowdraganddrop"})}).catch(e=>{Object(n.X)(e.error)||Object(n.X)(e.error.message)||(e.error=e.error.message),t.trigger("actionFailure",e)}),r.deletedRecords=a,r.addedRecords=[],i.getDataModule().saveChanges(r,i.getPrimaryKeyFieldNames()[0],{},d).then(()=>{i.notify(D,{type:f,requestType:"rowdraganddrop"})}).catch(e=>{Object(n.X)(e.error)||Object(n.X)(e.error.message)||(e.error=e.error.message),i.trigger("actionFailure",e)})}else{t.notify("rows-added",{toIndex:o,records:a}),t.notify(D,{type:f,requestType:"rowdraganddrop"});let e=i.getSelectedRowIndexes(),s=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;this.selectedRows=[];for(let t=0,i=a.length;t<i;t++)this.selectedRows.push(s+e[t]);i.notify("rows-removed",{indexes:this.selectedRows,records:a}),i.notify(D,{type:f,requestType:"rowdraganddrop"})}}}reorderRow(e,t){let i=this.parent;if(!i.sortSettings.columns.length&&!i.groupSettings.columns.length&&!i.filterSettings.columns.length){let s=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;t+=s,this.selectedRows=i.getSelectedRowIndexes(),i.notify("row-position-changed",{fromIndex:e+s,toIndex:t})}}enableAfterRender(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()}destroy(){let e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.draggable.destroy(),this.parent.off(w,this.initializeDrag),this.parent.off("columnDrop",this.columnDrop),this.parent.removeEventListener(C,this.onDataBoundFn),this.parent.off(x,this.enableAfterRender))}getModuleName(){return"rowDragAndDrop"}processArgs(e){let t=this.parent;t.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===t.getSelectedRecords().length?(this.rows=[this.startedRow],this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector(".e-rowcell")).rowData]):(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())}}},Vr={provide:"GridsDetailRow",useValue:class{constructor(e,t){this.aria=new Q,this.parent=e,this.parent.isDestroyed||(this.focus=t.getService("focus"),this.parent.on(M,this.clickHandler,this),this.parent.on(F,this.destroy,this),this.parent.on(I,this.keyPressHandler,this),this.parent.on("expandchildgrid",this.expand,this),this.parent.on("column-visible-changed",this.refreshColSpan,this))}clickHandler(e){this.toogleExpandcollapse(Object(n.C)(e.target,"td"))}toogleExpandcollapse(e){let t,i=this.parent,s=this.parent.getContentTable(),r=this.parent.getCurrentViewRecords().length-1,l=e&&e.classList.contains("e-detailrowcollapse");if(!e||!e.classList.contains("e-detailrowcollapse")&&!e.classList.contains("e-detailrowexpand"))return;if(Object(n.W)()&&this.parent.isServerRendered)return void this.parent.notify("detailclick",e);let a=e.parentElement,o=a.getAttribute("data-uid"),h=i.getRowObjectFromUID(o),d=this.parent.getContentTable().querySelector("tbody").children[a.rowIndex+1];if(e.classList.contains("e-detailrowcollapse")){let r=h.data;if(this.isDetailRow(d))d.style.display="",i.notify("detail-state-change",{data:r,childGrid:i.childGrid,detailElement:e,isExpanded:l});else if(i.getDetailTemplate()||i.childGrid){let e=St("grid-row"),s=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":e}}),l=this.parent.createElement("td",{className:"e-detailcell"}),o=this.parent.getVisibleColumns().length;this.parent.allowRowDragAndDrop&&o++,l.setAttribute("colspan",o.toString());let d=new P({isDataRow:!0,isExpand:!0,uid:e,isDetailRow:!0,cells:[new q({cellType:A.Indent}),new q({isDataCell:!0,visible:!0})]});for(let t=0,r=i.groupSettings.columns.length;t<r;t++)s.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),d.cells.unshift(new q({cellType:A.Indent}));if(s.appendChild(this.parent.createElement("td",{className:"e-detailindentcell"})),s.appendChild(l),a.parentNode.insertBefore(s,a.nextSibling),i.detailTemplate){let e=i.element.id+"detailTemplate";this.parent.isReact&&"string"!=typeof i.detailTemplate?(i.getDetailTemplate()(r,i,"detailTemplate",e,null,null,l),this.parent.renderTemplates()):Ot(l,i.getDetailTemplate()(r,i,"detailTemplate",e)),Object(n.W)()&&Object(n.sb)(e,"DetailTemplate",i,!1)}else{t=new Qe(this.getGridModel(i,h,i.printMode)),t.query&&(t.query=t.query.clone()),t.parentDetails={parentID:i.element.id,parentPrimaryKeys:i.getPrimaryKeyFieldNames(),parentKeyField:i.childGrid.queryString,parentKeyFieldValue:r[i.childGrid.queryString],parentRowData:r},t.isLegacyTemplate=i.isReact||i.isLegacyTemplate,i.isPrinting&&(t.isPrinting=!0,t.on(O,this.promiseResolve(t),this),t.on(j,this.promiseResolve(t),this)),h.childGrid=t;let e=t.getInjectedModules(),s=i.getInjectedModules();e&&e.length===s.length||t.setInjectedModules(s);let n=this.parent.createElement("div",{id:"child"+xt(a,"e-grid").length+"_grid"+a.rowIndex+St("")});l.appendChild(n),t.appendTo(n)}s.appendChild(l),a.nextSibling?a.parentNode.insertBefore(s,a.nextSibling):a.parentNode.appendChild(s),i.getRows().splice(a.rowIndex+1,0,s),i.getRowsObject().splice(h.index+1,0,d),i.trigger("detailDataBound",{detailElement:l,data:r,childGrid:t}),i.notify("detailDataBound",{rows:i.getRowsObject()})}if(Object(n.A)(e,["e-detailrowexpand"],["e-detailrowcollapse"]),Object(n.A)(e.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),h.isExpand=!0,e.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>s.scrollHeight){Object(n.ib)(e.parentElement.querySelectorAll("td"),"e-lastrowcell");let t=s.querySelector("tbody").querySelectorAll(".e-detailrow").length-1;Object(n.v)(s.querySelector("tbody").querySelectorAll(".e-detailrow")[t].childNodes,["e-lastrowcell"]),this.lastrowcell=!0}this.aria.setExpand(e,!0)}else this.isDetailRow(d)&&(d.style.display="none",i.notify("detail-state-change",{data:h.data,childGrid:i.childGrid,detailElement:e,isExpanded:l})),Object(n.A)(e,["e-detailrowcollapse"],["e-detailrowexpand"]),Object(n.A)(e.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(a.getAttribute("aria-rowindex"),10)===r&&this.lastrowcell&&(Object(n.v)(e.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),h.isExpand=!1,this.aria.setExpand(e,!1)}getGridModel(e,t,i){let s;return e.isPrinting&&t.isExpand&&e.expandedRows&&e.expandedRows[t.index]&&e.expandedRows[t.index].gridModel?(e.expandedRows[t.index].gridModel.hierarchyPrintMode=e.childGrid.hierarchyPrintMode,s=e.expandedRows[t.index].gridModel):e.isPrinting&&e.childGrid.allowPaging?(e.childGrid.allowPaging="CurrentPage"===i,s=e.childGrid):s=e.childGrid,s}promiseResolve(e){return()=>{e.off(O,this.promiseResolve),e.off(j,this.promiseResolve),e.notify("hierarchyprint",{})}}isDetailRow(e){return e&&e.classList.contains("e-detailrow")}destroy(){let e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.off(M,this.clickHandler),this.parent.off(F,this.destroy),this.parent.off(I,this.keyPressHandler),this.parent.off("expandchildgrid",this.expand),this.parent.off("column-visible-changed",this.refreshColSpan))}getTDfromIndex(e,t){let i=this.parent.getDataRows()[e];return i&&i.querySelector(t)?i.querySelector(t):null}expand(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowcollapse")),e&&e.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(e)}collapse(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowexpand")),e&&e.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(e)}expandAll(){this.expandCollapse(!0),this.parent.trigger(y,{requestType:"expandAllComplete",type:y,moduleObj:this})}collapseAll(){this.expandCollapse(!1),this.parent.trigger(y,{requestType:"collapseAllComplete",type:y,moduleObj:this})}expandCollapse(e){let t,i=this.parent.getDataRows();for(let s=0,r=i.length;s<r;s++)t=i[s].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),e?this.expand(t):this.collapse(t)}keyPressHandler(e){let t=this.parent;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":let i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){let s=t.getDataRows()[i[i.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand");"altDownArrow"===e.action?this.expand(s):this.collapse(s)}break;case"enter":if(this.parent.isEdit)return;let s=this.focus.getFocusedElement();if(!e.target.classList.contains("e-detailrowcollapse")&&!e.target.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(s)}}refreshColSpan(){let e=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),t=this.parent.getVisibleColumns().length;for(let i=0;i<e.length;i++)e[i].querySelector(".e-detailcell").setAttribute("colspan",t+"")}getModuleName(){return"detailRow"}}},Hr={provide:"GridsToolbar",useValue:class{constructor(e,t){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}render(){this.l10n=this.serviceLocator.getService("localization");let e=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];for(let t of e){let e=t.toLowerCase(),i=e[0].toUpperCase()+e.slice(1);this.predefinedItems[t]={id:this.gridID+"_"+e,prefixIcon:"e-"+e,text:this.l10n.getConstant(i),tooltipText:this.l10n.getConstant(i)}}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},this.createToolbar()}getToolbar(){return this.toolbar.element}destroy(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),Object(n.hb)(this.element))}bindSearchEvents(){this.searchElement=Object(n.lb)("#"+this.gridID+"_searchbar",this.element),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()}toolbarCreated(){this.element.querySelector(".e-search-wrapper")&&(this.element.querySelector(".e-search-wrapper").innerHTML='<div class="e-input-group e-search" role="search">        <input id="'+this.gridID+'_searchbar" class="e-input" name="input" type="search"         placeholder= "'+this.l10n.getConstant("Search")+'"/>        <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"         tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>         </div>'),this.bindSearchEvents()}createToolbar(){let e=this.getItems();this.toolbar=new p.b({items:e,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this)}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this),this.toolbar.isStringTemplate=!0;let t="viewContainerRef";if(this.parent[t]&&(this.toolbar.registeredTemplate={},this.toolbar[t]=this.parent[t]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.toolbarTemplate)if(Object(n.W)()||"string"!=typeof this.parent.toolbarTemplate)if(Object(n.W)()){let e=this.parent.element.id+"toolbarTemplate",t=Ot(this.element,ot(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",e)),i=this.getItem(t);this.toolbar.items.push(i),this.toolbar.appendTo(this.element),Object(n.sb)(this.parent.element.id+"toolbarTemplate","ToolbarTemplate",this.parent)}else{let e=this.parent.element.id+"toolbarTemplate";this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate?(ot(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",e,null,null,this.element),this.parent.renderTemplates()):Ot(this.element,ot(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}else this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent())}addReactToolbarPortals(e){this.parent.isReact&&e&&(this.parent.portals=this.parent.portals.concat(e),this.parent.renderTemplates())}refreshToolbarItems(e){let t=this.parent,i=[],s=[],r=t.editSettings,n=t.currentViewData&&t.currentViewData.length;r.allowAdding?i.push(this.gridID+"_add"):s.push(this.gridID+"_add"),r.allowEditing&&n?i.push(this.gridID+"_edit"):s.push(this.gridID+"_edit"),r.allowDeleting&&n?i.push(this.gridID+"_delete"):s.push(this.gridID+"_delete"),"Batch"===t.editSettings.mode?t.element.querySelectorAll(".e-updatedtd").length&&(r.allowAdding||r.allowEditing)?(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")):(s.push(this.gridID+"_update"),s.push(this.gridID+"_cancel")):t.isEdit&&(r.allowAdding||r.allowEditing)?(i=[this.gridID+"_update",this.gridID+"_cancel"],s=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(s.push(this.gridID+"_update"),s.push(this.gridID+"_cancel")),this.enableItems(i,!0),this.enableItems(s,!1)}getItems(){let e=[],t=this.parent.toolbar||[];if("string"==typeof this.parent.toolbar)return[];for(let i of t)switch(typeof i){case"number":e.push(this.getItemObject(this.items[i]));break;case"string":e.push(this.getItemObject(i));break;default:e.push(this.getItem(i))}return e}getItem(e){let t=this.predefinedItems[e.text];return t?Object(n.K)(t,t,e):e}getItemObject(e){return this.predefinedItems[e]||{text:e,id:this.gridID+"_"+e}}enableItems(e,t){for(let i of e){let e=Object(n.lb)("#"+i,this.element);e&&this.toolbar.enableItems(e.parentElement,t)}}toolbarClickHandler(e){let t=this.parent,i=this.gridID;Object(n.K)(e,{cancel:!1});let s=!Object(n.W)()||this.parent.isJsComponent?e:{item:e.item,cancel:e.cancel,name:e.name},r=e.originalEvent;t.trigger("toolbarClick",s,e=>{if(e.originalEvent=e.originalEvent?e.originalEvent:r,!e.cancel)switch(!Object(n.X)(e.item)&&e.item.id){case i+"_print":t.print();break;case i+"_edit":t.startEdit();break;case i+"_update":t.endEdit();break;case i+"_cancel":t.closeEdit();break;case i+"_add":t.addRecord();break;case i+"_delete":t.deleteRecord();break;case i+"_search":e.originalEvent.target.id===i+"_searchbutton"&&this.search();break;case i+"_columnchooser":let s=this.parent.element.querySelector(".e-ccdiv"),r=s.getBoundingClientRect().top,l=s.getBoundingClientRect().left,a=e.originalEvent.target;r=s.getBoundingClientRect().top+s.offsetTop,t.createColumnchooser(l,r,a);break;case"copy":Object(n.W)()&&t.copy();break;case"copyheader":case"copyHeader":Object(n.W)()&&t.copy(!0)}})}modelChanged(e){"edit"===e.module&&this.refreshToolbarItems()}onPropertyChanged(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&Object(n.hb)(this.element),this.render())}keyUpHandler(e){13===e.keyCode&&this.search()}search(){this.parent.search(this.searchElement.value)}updateSearchBox(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)}wireEvent(){this.searchElement&&(this.searchBoxObj=new we(this.searchElement),n.l.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent())}unWireEvent(){this.searchElement&&(n.l.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent())}addEventListener(){this.parent.isDestroyed||(this.parent.on(w,this.render,this),this.parent.on(x,this.onPropertyChanged,this),this.parent.on(R,this.updateSearchBox.bind(this)),this.parent.on(D,this.refreshToolbarItems,this),this.parent.on(T,this.refreshToolbarItems,this),this.parent.on(R,this.modelChanged,this),this.parent.on(C,this.refreshToolbarItems,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(w,this.render),this.parent.off(x,this.onPropertyChanged),this.parent.off(R,this.updateSearchBox),this.parent.off(D,this.refreshToolbarItems),this.parent.off(T,this.refreshToolbarItems),this.parent.off(R,this.modelChanged),this.parent.off(C,this.refreshToolbarItems))}getModuleName(){return"toolbar"}}},Nr={provide:"GridsAggregate",useValue:class{constructor(e,t){this.parent=e,this.locator=t,this.addEventListener()}getModuleName(){return"aggregate"}initiateRender(){let e=this.locator.getService("cellRendererFactory"),t=new $i(this.parent,this.locator),i=[A.Summary,A.CaptionSummary,A.GroupSummary];for(let n=0;n<i.length;n++)e.addCellRenderer(i[n],t);this.footerRenderer=new Ji(this.parent,this.locator),this.footerRenderer.renderPanel(),this.footerRenderer.renderTable();let s=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&s&&Object(n.v)([s],["e-footerpadding"]),this.locator.register("footerRenderer",this.footerRenderer);let r=()=>{this.prepareSummaryInfo(),this.parent.off(S,r)};this.parent.on(S,r,this),this.parent.on(S,this.footerRenderer.refresh,this.footerRenderer)}prepareSummaryInfo(){if(function(e,t){for(let i=0;i<e.length;i++)for(let s=0;s<e[i].columns.length;s++)t(e[i].columns[s])}(this.parent.aggregates,e=>{if(this.parent.getColumnByField(e.field),Object(n.X)(e.customFormat)||e.setPropertiesSilent({format:e.customFormat}),"object"==typeof e.format){let t=new m;e.setFormatter(t.getFormatFunction(Object(n.K)({},e.format)))}else if("string"==typeof e.format){let t=this.locator.getService("valueFormatter");e.setFormatter(t.getFormatFunction({format:e.format}))}e.setPropertiesSilent({columnName:e.columnName||e.field})}),Object(n.W)()&&this.parent.isServerRendered){let e="bulkChanges",t="aggregates",i=Object.keys(this.parent[e]);for(let s=0;s<i.length;s++)i[s].startsWith(t)&&delete this.parent[e][i[s]]}}onPropertyChanged(e){if(e.module!==this.getModuleName())return;Object(n.X)(this.footerRenderer)&&this.initiateRender(),this.prepareSummaryInfo(),this.footerRenderer.refresh();let t=new G(this.parent);0===new X(this.parent).getData().length&&t.isEmpty()||this.parent.notify(D,{})}addEventListener(){this.parent.isDestroyed||(this.parent.on(w,this.initiateRender,this),this.parent.on(x,this.onPropertyChanged,this),this.parent.on("refresh-aggregates",this.refresh,this))}removeEventListener(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(w,this.initiateRender),this.parent.off(S,this.footerRenderer.refresh),this.parent.off(x,this.onPropertyChanged),this.parent.off("refresh-aggregates",this.refresh))}destroy(){this.removeEventListener(),Object(n.hb)(this.parent.element.querySelector(".e-gridfooter"))}refresh(e){let t=e instanceof Array?e:[e];this.parent.notify("refresh-footer-rendered",t),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",t)}}},Wr={provide:"GridsSearch",useValue:Ee},Xr={provide:"GridsVirtualScroll",useValue:class{constructor(e,t){this.parent=e,this.locator=t,this.addEventListener()}getModuleName(){return"virtualscroll"}instantiateRenderer(){this.parent.log(["limitation","virtual_height"],"virtualization");let e=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&e.addRenderer(L.Header,new is(this.parent,this.locator)),e.addRenderer(L.Content,new ts(this.parent,this.locator))),this.ensurePageSize()}ensurePageSize(){let e=this.parent.getRowHeight(),t=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height;this.blockSize=~~(t/e);let i=2*this.blockSize,s=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:s<i?i:s}},!0),Object(n.W)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{})}addEventListener(){this.parent.isDestroyed||(this.parent.on(v,this.instantiateRenderer,this),this.parent.on("column-width-changed",this.refreshVirtualElement,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(v,this.instantiateRenderer),this.parent.off("column-width-changed",this.refreshVirtualElement))}refreshVirtualElement(e){this.parent.enableColumnVirtualization&&"resize"===e.module&&this.locator.getService("rendererFactory").getRenderer(L.Content).refreshVirtualElement()}destroy(){this.removeEventListener()}}},Gr={provide:"GridsEdit",useValue:Cs},Kr={provide:"GridsResize",useValue:_i},Ur={provide:"GridsExcelExport",useValue:Ss},Yr={provide:"GridsPdfExport",useValue:Os},_r={provide:"GridsCommandColumn",useValue:class{constructor(e,t){this.parent=e,this.locator=t,this.initiateRender(),this.addEventListener()}initiateRender(){this.locator.getService("cellRendererFactory").addCellRenderer(A.CommandColumn,new xs(this.parent,this.locator))}commandClickHandler(e){let t=this.parent,i=Object(n.C)(e.target,"button");if(!i||!Object(n.C)(e.target,".e-unboundcell"))return;let s,r=i.ej2_instances[0],l=r.commandType,a=i.getAttribute("data-uid"),o=t.getRowObjectFromUID(Object(n.C)(i,".e-row").getAttribute("data-uid")),h=this.parent.columnModel;for(let c=0;c<h.length;c++)if(h[c].commands){let e=h[c].commands;for(let i=0;i<e.length;i++){let r="uid",o="type";Object(n.W)()&&!t.isJsComponent&&e[i][r]===a?(s=e[i],l=e[i][o]):e[i][r]===a&&e[i][o]===l&&(s=e[i])}}let d={cancel:!1,target:i,commandColumn:s,rowData:Object(n.X)(o)?void 0:o.data};this.parent.trigger("commandClick",d,e=>{if(!r.disabled&&t.editModule&&!e.cancel)switch(l){case"Edit":t.editModule.endEdit(),t.editModule.startEdit(Object(n.C)(i,"tr"));break;case"Cancel":t.editModule.closeEdit();break;case"Save":t.editModule.endEdit();break;case"Delete":"Batch"!==t.editSettings.mode&&t.editModule.endEdit(),t.commandDelIndex=parseInt(Object(n.C)(i,"tr").getAttribute("aria-rowindex"),10),t.clearSelection(),t.selectRow(t.commandDelIndex,!1),t.editModule.deleteRecord(),t.commandDelIndex=void 0}})}getModuleName(){return"commandColumn"}destroy(){this.parent.isDestroyed||this.removeEventListener()}removeEventListener(){this.parent.isDestroyed||(this.parent.off(M,this.commandClickHandler),this.parent.off(I,this.keyPressHandler),this.parent.off(w,this.load))}addEventListener(){this.parent.isDestroyed||(this.parent.on(M,this.commandClickHandler,this),this.parent.on(I,this.keyPressHandler,this),this.parent.on(w,this.load,this))}keyPressHandler(e){"enter"===e.action&&Object(n.C)(e.target,".e-unboundcelldiv")&&(this.commandClickHandler(e),e.preventDefault())}load(){if(Object(n.W)()&&!this.parent.isJsComponent)return;let e=this.parent.columnModel;for(let t=0;t<e.length;t++)if(e[t].commands){let i=e[t].commands;for(let e=0;e<i.length;e++)i[e].uid=St("gridcommand")}}}},Qr={provide:"GridsContextMenu",useValue:class{constructor(e,t){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on(x,this.enableAfterRenderMenu,this),this.parent.on(v,this.render,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(v,this.render),this.parent.off(x,this.enableAfterRenderMenu),n.l.remove(this.element,"keydown",this.keyDownHandler.bind(this)))}keyDownHandler(e){"Tab"!==e.code&&9!==e.which||this.contextMenu.close(),"Escape"===e.code&&(this.contextMenu.close(),this.parent.notify("restore-Focus",{}))}render(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),n.l.add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);let e="#"+this.gridID;this.contextMenu=new p.a({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:e,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)}enableAfterRenderMenu(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),Object(n.hb)(this.element),this.parent.element.classList.remove("e-noselect")),this.render())}getMenuItems(){let e=[],t=[];for(let i of this.parent.contextMenuItems)"string"==typeof i&&-1!==this.getDefaultItems().indexOf(i)?-1!==i.toLocaleLowerCase().indexOf("export")?t.push(this.buildDefaultItems(i)):e.push(this.buildDefaultItems(i)):"string"!=typeof i&&e.push(i);if(t.length>0){let i=this.buildDefaultItems("export");i.items=t,e.push(i)}return e}getLastPage(){let e=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(e+=1),e}contextMenuOpen(){this.isOpen=!0}contextMenuItemClick(e){switch(this.getKeyFromId(e.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute("aria-colindex"),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(this.cell.getAttribute("aria-colindex"),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}e.column=this.targetColumn,e.rowInfo=this.targetRowdata,Object(n.W)()?this.parent.trigger("contextMenuClick",e.rowInfo.row?{element:e.element,item:e.item,event:e.event,column:this.targetColumn,rowInfo:{rowData:this.targetRowdata.rowData,rowIndex:this.targetRowdata.rowIndex,cellIndex:this.targetRowdata.cellIndex}}:this.targetColumn?{element:e.element,item:e.item,event:e.event,column:this.targetColumn}:{element:e.element,item:e.item,event:e.event}):this.parent.trigger("contextMenuClick",e)}contextMenuOnClose(e){e.items.length>0&&e.items[0].parentObj instanceof p.a&&this.updateItemStatus()}getLocaleText(e){return this.l10n.getConstant(this.localeText[e])}updateItemStatus(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1}contextMenuBeforeOpen(e){let t=Object(n.C)(e.event.target,".e-grid");if(e.event&&t&&t!==this.parent.element)e.cancel=!0;else if(e.event&&(Object(n.C)(e.event.target,".e-groupdroparea")||Object(n.C)(e.event.target,".e-gridpopup")||Object(n.C)(e.event.target,".e-summarycell")||Object(n.C)(e.event.target,".e-groupcaption")||Object(n.C)(e.event.target,".e-filterbarcell")))e.cancel=!0;else{this.targetColumn=this.getColumn(e.event),this.targetRowdata=this.parent.getRowInfo(e.event.target),Object(n.X)(e.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&this.selectRow(e.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type);let t=[],i=[];for(let s of e.items){let r=this.getKeyFromId(s.id),l=this.defaultItems[r];if(-1!==this.getDefaultItems().indexOf(r))if(this.ensureDisabledStatus(r)&&this.disableItems.push(s.text),e.event&&(this.ensureTarget(e.event.target,".e-inline-edit")||this.ensureTarget(e.event.target,".e-editedbatchcell")))"Save"!==r&&"Cancel"!==r&&this.hiddenItems.push(s.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(Object(n.C)(e.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===r||"Cancel"===r))continue;Object(n.X)(e.parentItem)&&e.event&&!this.ensureTarget(e.event.target,l.target)&&this.hiddenItems.push(s.text)}else s.target&&e.event&&!this.ensureTarget(e.event.target,s.target)?s.separator?t.push(s.id):this.hiddenItems.push(s.text):this.ensureTarget(e.event.target,s.target)&&s.separator&&i.push(s.id)}i.length>0&&this.contextMenu.showItems(i,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),t.length>0&&this.contextMenu.hideItems(t,!0),this.eventArgs=e.event,e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuOpen",e),(e.cancel||this.hiddenItems.length===e.items.length&&!e.parentItem)&&(this.updateItemStatus(),e.cancel=!0)}si(this.parent.element,this.contextMenu.element.parentElement)}ensureTarget(e,t){let i=e;return i=!this.ensureFrozenHeader(e)||".e-gridheader"!==t&&".e-gridcontent"!==t?".e-gridcontent"===t||".e-gridheader"===t?mt(Object(n.C)(e,".e-table"),t.substr(1,t.length)):Object(n.C)(e,t):Object(n.C)(e,".e-gridheader"===t?"thead":"tbody"),i&&mt(i,"e-grid")===this.parent.element}ensureFrozenHeader(e){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!Object(n.C)(e,".e-gridheader"))}ensureDisabledStatus(e){let t=!1;switch(e){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(_i)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===e;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(Qi)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(Qi)||this.parent.ensureModuleInjected(Qi)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":0!==this.parent.getSelectedRowIndexes().length&&0!==this.parent.getCurrentViewRecords().length||(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(Os)||this.parent.ensureModuleInjected(Ss))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(Os)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(Ss)||(t=!0);break;case"SortAscending":case"SortDescending":if(!this.parent.allowSorting||!this.parent.ensureModuleInjected(Mi)||this.targetColumn&&!this.targetColumn.field)t=!0;else if(this.parent.ensureModuleInjected(Mi)&&this.parent.sortSettings.columns.length>0&&this.targetColumn){let i=this.parent.sortSettings.columns;for(let s=0;s<i.length;s++)i[s].field===this.targetColumn.field&&i[s].direction.toLowerCase()===e.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0)}break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(Bi)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(Bi)&&1===this.parent.pageSettings.currentPage)&&(t=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(Bi)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(Bi)&&this.parent.pageSettings.currentPage===this.getLastPage())&&(t=!0)}return t}getContextMenu(){return this.element}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.contextMenu.destroy(),Object(n.hb)(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))}getModuleName(){return"contextMenu"}generateID(e){return this.gridID+"_cmenu_"+e}getKeyFromId(e){return e.replace(this.gridID+"_cmenu_","")}buildDefaultItems(e){let t;switch(e){case"AutoFitAll":case"AutoFit":t={target:".e-gridheader"};break;case"Group":t={target:".e-gridheader",iconCss:"e-icon-group"};break;case"Ungroup":t={target:".e-gridheader",iconCss:"e-icon-ungroup"};break;case"Edit":t={target:".e-gridcontent",iconCss:"e-edit"};break;case"Delete":t={target:".e-gridcontent",iconCss:"e-delete"};break;case"Save":t={target:".e-inline-edit",iconCss:"e-save"};break;case"Cancel":t={target:".e-inline-edit",iconCss:"e-cancel"};break;case"Copy":t={target:".e-gridcontent",iconCss:"e-copy"};break;case"export":t={target:".e-gridcontent"};break;case"PdfExport":t={target:".e-gridcontent",iconCss:"e-pdfexport"};break;case"ExcelExport":t={target:".e-gridcontent",iconCss:"e-excelexport"};break;case"CsvExport":t={target:".e-gridcontent",iconCss:"e-csvexport"};break;case"SortAscending":t={target:".e-gridheader",iconCss:"e-icon-ascending"};break;case"SortDescending":t={target:".e-gridheader",iconCss:"e-icon-descending"};break;case"FirstPage":t={target:".e-gridpager",iconCss:"e-icon-first"};break;case"PrevPage":t={target:".e-gridpager",iconCss:"e-icon-prev"};break;case"LastPage":t={target:".e-gridpager",iconCss:"e-icon-last"};break;case"NextPage":t={target:".e-gridpager",iconCss:"e-icon-next"}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[e]}getDefaultItems(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]}setLocaleKey(){let e={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"};return Object(n.W)()&&(e.AutoFitAll="AutoFitAll",e.AutoFit="AutoFit"),e}getColumn(e){let t=Object(n.C)(e.target,"th.e-headercell");if(t){let e=t.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(e)}return this.parent.getRowInfo(e.target).column||null}selectRow(e,t){this.cell=e.target,this.row=Object(n.C)(e.target,"tr.e-row")||this.row,this.row&&t&&!mt(e.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute("aria-rowindex"),10))}}},Jr={provide:"GridsFreeze",useValue:class{constructor(e,t){this.parent=e,this.locator=t,this.addEventListener()}getModuleName(){return"freeze"}addEventListener(){this.parent.isDestroyed||this.parent.on(v,this.instantiateRenderer,this)}instantiateRenderer(){this.parent.log("limitation",this.getModuleName());let e=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(e.addRenderer(L.Header,this.parent.enableColumnVirtualization?new Fs(this.parent,this.locator):new Ds(this.parent,this.locator)),e.addRenderer(L.Content,this.parent.enableVirtualization?new Ms(this.parent,this.locator):new Rs(this.parent,this.locator))),(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(e.addRenderer(L.Header,new Es(this.parent,this.locator)),e.addRenderer(L.Content,this.parent.enableVirtualization?new Us(this.parent,this.locator):new Is(this.parent,this.locator)))}removeEventListener(){this.parent.isDestroyed||this.parent.off(v,this.instantiateRenderer)}destroy(){this.removeEventListener()}}},$r={provide:"GridsColumnMenu",useValue:class{constructor(e,t){this.defaultItems={},this.localeText=this.setLocaleKey(),this.disableItems=[],this.hiddenItems=[],this.isOpen=!1,this.GROUP="e-icon-group",this.UNGROUP="e-icon-ungroup",this.ASCENDING="e-icon-ascending",this.DESCENDING="e-icon-descending",this.ROOT="e-columnmenu",this.FILTER="e-icon-filter",this.POP="e-filter-popup",this.WRAP="e-col-menu",this.CHOOSER="_chooser_",this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}wireEvents(){let e=this.getColumnMenuHandlers();for(let t=0;t<e.length;t++)n.l.add(e[t],"mousedown",this.columnMenuHandlerDown,this)}unwireEvents(){let e=this.getColumnMenuHandlers();for(let t=0;t<e.length;t++)n.l.remove(e[t],"mousedown",this.columnMenuHandlerDown)}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),Object(n.hb)(this.element))}columnMenuHandlerClick(e){e.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(e)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(e)):this.isOpen?this.columnMenu.close():this.openColumnMenu(e))}openColumnMenuByField(e){this.openColumnMenu({target:this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu")})}openColumnMenu(e){let t={top:0,left:0};this.element.style.cssText="display:block;visibility:hidden";let i=this.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible",this.headerCell=this.getHeaderCell(e),n.d.isDevice?(t.top=window.innerHeight/2-i.height/2,t.left=window.innerWidth/2-i.width/2):this.parent.enableRtl?t=Object(a.e)(this.headerCell,"left","bottom"):(t=Object(a.e)(this.headerCell,"right","bottom"),t.left-=i.width),this.columnMenu.open(t.top,t.left),e.preventDefault&&e.preventDefault(),si(this.parent.element,this.columnMenu.element.parentElement)}columnMenuHandlerDown(e){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)}getColumnMenuHandlers(){return[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+this.ROOT))}addEventListener(){this.parent.isDestroyed||(this.parent.on(E,this.wireEvents,this),this.parent.on(x,this.enableAfterRenderMenu,this),this.parent.on(w,this.render,this),this.isFilterItemAdded()&&this.parent.on("filterDialogCreated",this.filterPosition,this),this.parent.on(M,this.columnMenuHandlerClick,this),this.parent.on(I,this.keyPressHandler,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(E,this.unwireEvents),this.parent.off(x,this.enableAfterRenderMenu),this.parent.off(w,this.render),this.isFilterItemAdded()&&this.parent.off("filterDialogCreated",this.filterPosition),this.parent.off(M,this.columnMenuHandlerClick),this.parent.off(I,this.keyPressHandler))}keyPressHandler(e){let t=this.parent;if("altDownArrow"===e.action){let e=t.focusModule.currentInfo.element;if(e&&e.classList.contains("e-headercell")){let i=t.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid"));this.openColumnMenuByField(i.field)}}}enableAfterRenderMenu(e){e.module===this.getModuleName()&&e.enable&&(this.columnMenu&&(this.columnMenu.destroy(),Object(n.hb)(this.element)),this.render())}render(){this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"}),this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA")),this.parent.element.appendChild(this.element),this.columnMenu=new p.a({cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)}),this.columnMenu.appendTo(this.element),this.wireFilterEvents()}wireFilterEvents(){!n.d.isDevice&&this.isFilterItemAdded()&&n.l.add(this.element,"mouseover",this.appendFilter,this)}unwireFilterEvents(){!n.d.isDevice&&this.isFilterItemAdded()&&n.l.remove(this.element,"mouseover",this.appendFilter)}beforeMenuItemRender(e){if(this.isChooserItem(e.item)){let t=this.getKeyFromId(e.item.id,this.CHOOSER),i=this.parent.columnModel.filter(e=>e.field===t),s=Object(o.f)(this.parent.createElement,!1,{label:e.item.text,checked:i[0].visible});this.parent.enableRtl&&s.classList.add("e-rtl"),e.element.innerHTML="",e.element.appendChild(s)}else e.item.id&&"Filter"===this.getKeyFromId(e.item.id)&&(e.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),e.element.className+="e-filter-item e-menu-caret-icon")}columnMenuBeforeClose(e){let t=e.event?Object(n.C)(e.event.target,".e-menu-item"):null;(!Object(n.X)(e.parentItem)&&"ColumnChooser"===this.getKeyFromId(e.parentItem.id)&&t&&this.isChooserItem(t)||e.event&&(Object(n.C)(e.event.target,"."+this.POP)||e.event.currentTarget&&e.event.currentTarget.activeElement&&mt(e.event.currentTarget.activeElement,"e-filter-popup")||mt(e.event.target,"e-popup")||mt(e.event.target,"e-popup-wrapper"))&&!n.d.isDevice)&&(e.cancel=!0)}isChooserItem(e){return e.id&&e.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(e.id,this.CHOOSER).indexOf("_colmenu_")}columnMenuBeforeOpen(e){e.column=this.targetColumn=this.getColumn(),this.parent.trigger("columnMenuOpen",e);for(let t of e.items){let e=this.getKeyFromId(t.id),i=this.defaultItems[e];-1!==this.getDefaultItems().indexOf(e)&&this.ensureDisabledStatus(e)&&!i.hide&&this.disableItems.push(t.text),t.hide&&this.hiddenItems.push(t.text)}this.columnMenu.enableItems(this.disableItems,!1),this.columnMenu.hideItems(this.hiddenItems)}columnMenuOnOpen(e){"e-menu-parent e-ul "===e.element.className&&(e.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(e.element.style.maxHeight=.8*window.innerHeight+"px",e.element.style.overflowY="auto")}ensureDisabledStatus(e){let t=!1;switch(e){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(Qi)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(_i);break;case"Ungroup":(!this.parent.ensureModuleInjected(Qi)||this.parent.ensureModuleInjected(Qi)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(Mi)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting){let i=this.parent.sortSettings.columns;for(let s=0;s<i.length;s++)i[s].field===this.targetColumn.field&&i[s].direction.toLocaleLowerCase()===e.toLocaleLowerCase().replace("sort","")&&(t=!0)}else(!this.parent.allowSorting||!this.parent.ensureModuleInjected(Mi)||this.parent.allowSorting&&this.targetColumn&&!this.targetColumn.allowSorting)&&(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Yi)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(Yi)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t}columnMenuItemClick(e){switch(this.isChooserItem(e.item)?"ColumnChooser":this.getKeyFromId(e.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":let t=this.getKeyFromId(e.item.id,this.CHOOSER),i=e.element.querySelector(".e-checkbox-wrapper .e-frame");i&&i.classList.contains("e-check")?(i.classList.remove("e-check"),this.parent.hideColumns(t,"field")):i&&(this.parent.showColumns(t,"field"),i.classList.add("e-check"));break;case"Filter":this.getFilter(e.element,e.item.id)}e.column=this.targetColumn,this.parent.trigger("columnMenuClick",e)}columnMenuOnClose(e){e.items.length>0&&e.items[0].parentObj instanceof p.a&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(e.element,e.element.id,!0)),this.parent.isFrozenGrid()||this.parent.notify("restore-Focus",{})}getDefaultItems(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]}getItems(){let e=[],t=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();for(let i of t)if("string"==typeof i)if("ColumnChooser"===i){let t=this.getDefaultItem(i);t.items=this.createChooserItems(),e.push(t)}else e.push(this.getDefaultItem(i));else e.push(i);return e}getDefaultItem(e){let t={};switch(e){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[e]}getLocaleText(e){return this.l10n.getConstant(this.localeText[e])}generateID(e,t){return this.gridID+"_colmenu_"+(t?t+e:e)}getKeyFromId(e,t){return e.indexOf("_colmenu_")>0&&e.replace(this.gridID+"_colmenu_"+(t||""),"")}getColumnMenu(){return this.element}getModuleName(){return"columnMenu"}setLocaleKey(){let e={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"};return Object(n.W)()&&(e.AutoFitAll="AutoFitAll",e.AutoFit="AutoFit"),e}getHeaderCell(e){return Object(n.C)(e.target,"th.e-headercell")}getColumn(){if(this.headerCell){let e=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(e)}return null}createChooserItems(){let e=[];for(let t of this.parent.columnModel)t.showInColumnChooser&&t.field&&e.push({id:this.generateID(t.field,this.CHOOSER),text:t.headerText?t.headerText:t.field});return e}appendFilter(e){if(this.defaultItems.Filter){let t=this.defaultItems.Filter.id;Object(n.C)(e.target,"#"+t)&&!this.isFilterPopupOpen()?this.getFilter(e.target,t):!Object(n.C)(e.target,"#"+t)&&this.isFilterPopupOpen()&&this.getFilter(e.target,t,!0)}}getFilter(e,t,i){let s=this.getFilterPop();s?s.style.display=!n.d.isDevice&&i?"none":"block":this.parent.notify("filterOpen",{col:this.targetColumn,target:e,isClose:i,id:t})}setPosition(e,t){let i=this.parent.element.getBoundingClientRect(),s=e.getBoundingClientRect(),r=s.left-i.left,n=s.top-i.top;i.height<n?n=n-t.offsetHeight+s.height:i.height<n+t.offsetHeight&&(n=i.height-t.offsetHeight),window.innerHeight<t.offsetHeight+n+i.top&&(n=window.innerHeight-t.offsetHeight-i.top),r+=this.parent.enableRtl?-t.offsetWidth:s.width,i.width<=r+t.offsetWidth?r-=s.width+t.offsetWidth:r<0&&(r+=t.offsetWidth+s.width),t.style.top=n+"px",t.style.left=r+"px"}filterPosition(e){let t=this.getFilterPop();if(t.classList.add(this.WRAP),!n.d.isDevice){let e=t.style.display;t.style.cssText+="display:block;visibility:hidden";let i=this.element.querySelector("."+this.FILTER);i&&(this.setPosition(i.parentElement,t),t.style.cssText+="display:"+e+";visibility:visible")}}getDefault(){let e=[];return this.parent.ensureModuleInjected(_i)&&(e.push("AutoFitAll"),e.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(Qi)&&(e.push("Group"),e.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(Mi)&&(e.push("SortAscending"),e.push("SortDescending")),e.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Yi)&&e.push("Filter"),e}isFilterPopupOpen(){let e=this.getFilterPop();return e&&"none"!==e.style.display}getFilterPop(){return n.d.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)}isFilterItemAdded(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems}}},Zr={provide:"GridsColumnChooser",useValue:class{constructor(e,t){this.showColumn=[],this.hideColumn=[],this.changedColumns=[],this.unchangedColumns=[],this.isDlgOpen=!1,this.dlghide=!1,this.initialOpenDlg=!0,this.stateChangeColumns=[],this.changedStateColumns=[],this.isInitialOpen=!1,this.isCustomizeOpenCC=!1,this.searchOperator="startswith",this.prevShowedCols=[],this.parent=e,this.serviceLocator=t,this.addEventListener(),this.cBoxTrue=Object(o.f)(this.parent.createElement,!0,{checked:!0,label:" "}),this.cBoxFalse=Object(o.f)(this.parent.createElement,!0,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Object(n.v)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}destroy(){let e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.removeEventListener(),this.unWireEvents(),Object(n.X)(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())}rtlUpdate(){this.parent.enableRtl?Object(n.v)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"]):Object(n.ib)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"])}addEventListener(){this.parent.isDestroyed||(n.l.add(document,"click",this.clickHandler,this),this.parent.on(x,this.enableAfterRenderEle,this),this.parent.on(w,this.render,this),this.parent.addEventListener(C,this.hideDialog.bind(this)),this.parent.on(F,this.destroy,this),this.parent.on("rtl-updated",this.rtlUpdate,this),this.parent.on(I,this.keyUpHandler,this),this.parent.on("reset-columns",this.onResetColumns,this))}removeEventListener(){this.parent.isDestroyed||(n.l.remove(document,"click",this.clickHandler),this.parent.off(w,this.render),this.parent.off(F,this.destroy),this.parent.off(x,this.enableAfterRenderEle),this.parent.off("rtl-updated",this.rtlUpdate),this.parent.on(I,this.keyUpHandler,this),this.parent.off("reset-columns",this.onResetColumns))}render(){this.l10n=this.serviceLocator.getService("localization"),this.renderDlgContent(),this.getShowHideService=this.serviceLocator.getService("showHideService")}clickHandler(e){let t=e.target;if(!this.isCustomizeOpenCC){if(Object(n.X)(Object(n.C)(t,".e-cc"))&&Object(n.X)(Object(n.C)(t,".e-cc-toolbar")))Object(n.X)(this.dlgObj)||!this.dlgObj.visible||t.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(t.classList.contains("e-columnchooser-btn")||t.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else t.classList.contains("e-cc-cancel")&&(t.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=e.target)}this.isCustomizeOpenCC&&e.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState(),this.rtlUpdate()}hideDialog(){!Object(n.X)(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)}renderColumnChooser(e,t,i){if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;i&&(this.targetdlg=i),this.refreshCheckboxState(),this.dlgObj.dataBind(),this.dlgObj.element.style.maxHeight="430px";let e=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";let t=Object(a.f)(Object(n.C)(i,".e-toolbar-item"),this.dlgObj.element);this.dlgObj.element.style.display=e,this.dlgObj.element.style.top=t.top+Object(n.C)(i,".e-cc-toolbar").getBoundingClientRect().height+"px";let s=250;Object(n.X)(Object(n.C)(i,".e-bigger"))||(this.dlgObj.width=258),n.d.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.dlgObj.element.style.left=this.parent.enableRtl?i.offsetLeft+"px":t.left-s+Object(n.C)(i,".e-cc-toolbar").clientWidth+2+"px",this.removeCancelIcon(),this.dlgObj.show(),this.parent.notify("columnChooserOpened",{dialog:this.dlgObj})}this.rtlUpdate()}openColumnChooser(e,t){this.isCustomizeOpenCC=!0,this.dlgObj.visible?this.hideDialog():this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},Object(n.X)(e)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=t+"px",this.dlgObj.element.style.left=e+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))}enableAfterRenderEle(e){e.module===this.getModuleName()&&e.enable&&this.render()}keyUpHandler(e){"escape"===e.action&&this.hideDialog()}customDialogOpen(){let e=this.dlgObj.content.querySelector("input.e-ccsearch");n.l.add(e,"keyup",this.columnChooserManualSearch,this)}customDialogClose(){let e=this.dlgObj.content.querySelector("input.e-ccsearch");n.l.remove(e,"keyup",this.columnChooserManualSearch)}getColumns(){return this.parent.getColumns().filter(e=>"checkbox"!==e.type&&!0===e.showInColumnChooser||"checkbox"===e.type&&void 0!==e.field)}renderDlgContent(){let e;this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.parent.element.getBoundingClientRect();let t=this.parent.element.querySelector(".e-ccdiv");Object(n.X)(t)||(e=t.getBoundingClientRect().top),this.dlgObj=new a.a({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:"e-cc",animationSettings:{effect:"None"}}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv),this.wireEvents()}renderChooserList(){this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});let e=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search")}}),i=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),s=this.parent.createElement("div",{className:"e-cc-contentdiv"});this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),e.appendChild(t),e.appendChild(i),this.searchBoxObj=new we(t);let r=this.refreshCheckboxList(this.parent.getColumns());return this.innerDiv.appendChild(r),s.appendChild(this.innerDiv),this.mainDiv.appendChild(e),this.mainDiv.appendChild(s),this.mainDiv}confirmDlgBtnClick(e){this.stateChangeColumns=[],this.changedStateColumns=[],this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns,this.changedColumnState(this.changedColumns);let t=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;!Object(n.X)(e)&&t<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify("tooltip-destroy",{module:"edit"}),0===this.parent.getCurrentViewRecords().length)&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString())}onResetColumns(e){if("columnstate"===e.requestType)return this.showColumn=[],this.hideColumn=[],void this.hideDialog()}resetColumnState(){this.showColumn=[],this.hideColumn=[],this.hideDialog()}changedColumnState(e){for(let t=0;t<e.length;t++){let i=this.parent.getColumnByUid(e[t]);Object(n.W)()?this.changedStateColumns.push(JSON.parse(JSON.stringify(i))):this.changedStateColumns.push(i)}}columnStateChange(e,t){for(let i=0;i<e.length;i++){let s=this.parent.getColumnByUid(e[i]);"checkbox"!==s.type&&(s.visible=t),Object(n.W)()?this.stateChangeColumns.push(JSON.parse(JSON.stringify(s))):this.stateChangeColumns.push(s)}}clearActions(){this.hideColumn=[],this.showColumn=[],this.hideDialog(),this.addcancelIcon()}clearBtnClick(){this.clearActions(),this.parent.notify("columnChooserCancelBtnClick",{dialog:this.dlgObj})}checkstatecolumn(e,t,i=!1){e?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1===this.showColumn.indexOf(t)&&this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&this.hideColumn.push(t)),i?e?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)}columnChooserSearch(e){let t,i,s=!1,r=this.dlgDiv.querySelector(".e-footer-content"),n=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length;if(this.isInitialOpen=!0,r&&(i=r.querySelector(".e-btn").ej2_instances[0]),""===e?(this.removeCancelIcon(),t=this.getColumns(),s=!0):t=new l.a(this.getColumns()).executeLocal((new l.g).where("headerText",this.searchOperator,e,!0)),t.length)this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(t,e)),s?i&&n&&(i.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton());else{let e=this.parent.createElement("span",{className:"e-cc e-nmatch"});e.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(e),this.innerDiv.classList.add("e-ccnmdiv"),i&&(i.disabled=!0)}this.flag=!0,this.stopTimer()}wireEvents(){n.l.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this),n.l.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this),this.searchBoxObj.wireEvent()}unWireEvents(){this.parent.isDestroyed||(this.dlgObj.element&&n.l.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),n.l.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())}checkBoxClickHandler(e){let t,i=mt(e.target,"e-checkbox-wrapper");if(i){if(i.querySelector(".e-selectall")?this.updateSelectAll(!i.querySelector(".e-check")):qt(i.parentElement),i.querySelector(".e-chk-hidden").focus(),i.querySelector(".e-check"))t=!0;else{if(!i.querySelector(".e-uncheck"))return;t=!1}this.updateIntermediateBtn();let e=mt(i,"e-ccheck").getAttribute("uid"),s=this.parent.getColumns();if("grid-selectAll"===e){this.changedColumns=[],this.unchangedColumns=[];for(let e=0;e<s.length;e++)s[e].showInColumnChooser&&this.checkstatecolumn(t,s[e].uid,!0)}else this.checkstatecolumn(t,e);this.refreshCheckboxButton()}}updateIntermediateBtn(){let e=this.ulElement.children.length-1,t=[],i=this.ulElement.children[0].querySelector(".e-frame"),s=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,r=this.dlgObj.btnObj[0];r.disabled=!1,e===s?t=["e-check"]:s?t=["e-stop"]:(t=["e-uncheck"],r.disabled=!0),r.dataBind(),Object(n.ib)([i],["e-check","e-stop","e-uncheck"]),Object(n.v)([i],t)}updateSelectAll(e){let t=[].slice.call(this.ulElement.querySelectorAll(".e-frame"));for(let i of t)Nt(i,e)}refreshCheckboxButton(){this.dlgObj.element.querySelector(".e-cc.e-input");let e,t=this.parent.getVisibleColumns();for(let l=0;l<t.length;l++){let e=t[l].uid;-1===this.prevShowedCols.indexOf(e)&&this.prevShowedCols.push(e)}for(let l=0;l<this.hideColumn.length;l++){let e=this.prevShowedCols.indexOf(this.hideColumn[l]);-1!==e&&this.prevShowedCols.splice(e,1)}e=0!==this.showColumn.length?1:this.prevShowedCols.length;let i=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];i.disabled=!1;let s=[],r=this.parent.element.querySelectorAll(".e-cc-chbox");for(let l=0,a=r.length;l<a;l++){let e=mt(r[l],"e-ccheck").getAttribute("uid");s.push(e)}let n=this.showColumn.filter(e=>-1!==s.indexOf(e));0===e&&0===n.length&&(i.disabled=!0),i.dataBind()}refreshCheckboxList(e,t){this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});let i=this.l10n.getConstant("SelectAll"),s=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),r=this.createCheckBox(i,!1,"grid-selectAll");e.length&&(r.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),r.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(r.querySelector(".e-icons"),!0),s.appendChild(r),this.ulElement.appendChild(s));for(let n=0;n<e.length;n++)this.renderCheckbox(e[n]);return this.ulElement}refreshCheckboxState(){this.dlgObj.element.querySelector(".e-cc.e-input").value="",this.columnChooserSearch("");let e=this.parent,t=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)");for(let i=0,s=t.length;i<s;i++){let s,r=t[i];s=this.parent.childGrid||this.parent.detailTemplate?mt(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[i],"e-ccheck").getAttribute("uid"):mt(r,"e-ccheck").getAttribute("uid");let n=e.getColumnByUid(s),l=r.parentElement.querySelectorAll(".e-uncheck");n.visible&&!l.length?(r.checked=!0,this.checkState(r.parentElement.querySelector(".e-icons"),!0)):(r.checked=!1,this.checkState(r.parentElement.querySelector(".e-icons"),!1))}}checkState(e,t){t?Object(n.A)(e,["e-check"],["e-uncheck"]):Object(n.A)(e,["e-uncheck"],["e-check"])}createCheckBox(e,t,i){let s=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return s.querySelector(".e-label").innerHTML=e,Ht(i,s,"e-ccheck")}renderCheckbox(e){let t,i,s;if(e.showInColumnChooser){t=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+e.uid}),i=-1!==this.hideColumn.indexOf(e.uid),s=-1!==this.showColumn.indexOf(e.uid);let r=this.createCheckBox(e.headerText,e.visible&&!i||s,e.uid);t.appendChild(r),this.ulElement.appendChild(t)}this.isInitialOpen&&this.updateIntermediateBtn()}columnChooserManualSearch(e){this.addcancelIcon(),this.searchValue=e.target.value,this.stopTimer(),this.startTimer(e)}startTimer(e){let t=this;this.timer=window.setInterval(()=>{t.columnChooserSearch(t.searchValue)},t.flag||13===e.keyCode?0:500)}stopTimer(){window.clearInterval(this.timer)}addcancelIcon(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel")}removeCancelIcon(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel")}mOpenDlg(){n.d.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())}getModuleName(){return"columnChooser"}hideOpenedDialog(){let e=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter(e=>e.classList.contains("e-popup-open"));for(let t=0,i=e.length;t<i;t++)(e[t].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==e[t].id)&&e[t].ej2_instances[0].hide()}beforeOpenColumnChooserEvent(){Object(n.W)()&&this.parent.isServerRendered&&"none"===this.parent.columnChooserSettings.operator&&(this.parent.columnChooserSettings.operator="startsWith");let e={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return Object(n.W)()&&!this.parent.isJsComponent&&(e={requestType:"beforeOpenColumnChooser",cancel:!1,searchOperator:this.parent.columnChooserSettings.operator}),this.parent.trigger("beforeOpenColumnChooser",e),this.searchOperator=e.searchOperator,e}}},en={provide:"GridsForeignKey",useValue:class extends B{constructor(e,t){super(e,t),this.parent=e,this.serviceLocator=t,this.initEvent()}initEvent(){this.parent.isDestroyed||(this.parent.on("initForeignKeyColumn",this.initForeignKeyColumns,this),this.parent.on("getForeignKeyData",this.getForeignKeyData,this),this.parent.on("generateQuery",this.generateQueryFormData,this))}initForeignKeyColumns(e){for(let t=0;t<e.length;t++)e[t].dataSource=e[t].dataSource instanceof l.a?e[t].dataSource:Object(n.X)(e[t].dataSource)?new l.a:"result"in e[t].dataSource?e[t].dataSource:new l.a(e[t].dataSource)}eventfPromise(e,t,i,s){let r=this.getStateEventArgument(t),a=new l.c,o=new l.c;r.action=e.action;let h=this.parent.getDataModule();return!Object(n.X)(e.action)&&e.action.requestType&&!1!==h.foreignKeyDataState.isDataChanged?(h.setForeignKeyDataState({isPending:!0,resolver:o.resolve}),o.promise.then(()=>{a.resolve(s.dataSource)}),r.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger("columnDataStateChange",r)):(h.setForeignKeyDataState({}),a.resolve(i)),a}getForeignKeyData(e){let t=e.column?[e.column]:this.parent.getForeignKeyColumns(),i=[];for(let s=0;s<t.length;s++){let r,n=e.isComplex?this.genarateColumnQuery(t[s]):this.genarateQuery(t[s],e.result.result,!1,!0);n.params=this.parent.query.params;let l=t[s].dataSource;r=l&&"result"in l?this.eventfPromise(e,n,l,t[s]).promise:!l.ready||l.dataSource.offline?l.executeQuery(n):l.ready.then(()=>l.executeQuery(n)),i.push(r)}Promise.all(i).then(i=>{for(let e=0;e<i.length;e++)t[e].columnData=i[e].result,"dropdownedit"===t[e].editType&&"result"in t[e].dataSource&&(t[e].edit.params=Object(n.K)(t[e].edit.params,{dataSource:i[e].result,query:new l.g,fields:{value:t[e].foreignKeyField||t[e].field,text:t[e].foreignKeyValue}}));e.promise.resolve(e.result)}).catch(t=>(this.parent.log(["actionfailure","foreign_key_failure"]),e.promise&&e.promise.reject&&e.promise.reject(t),t))}generateQueryFormData(e){e.predicate.predicate=this.genarateQuery(e.column,e.column.columnData,!0)}genarateQuery(e,t,i,s){let r,n=this.parent,a=[],o=new l.g,h=i?e.foreignKeyField:e.field;if(n.allowPaging||n.enableVirtualization||i){t=new l.a(n.allowGrouping&&n.groupSettings.columns.length&&!i?t.records:t).executeLocal((new l.g).select(h));let s=l.b.distinct(t,h,!1);h=i?e.field:e.foreignKeyField;for(let e=0;e<s.length;e++)a.push(s[e]&&s[e].getDay?Kt({field:h,operator:"equal",value:s[e],matchCase:!1}):new l.f(h,"equal",s[e],!1))}return s?a.length?o.where(l.f.or(a)):o:(r=a.length?l.f.or(a):{predicates:[]},r)}genarateColumnQuery(e){let t=this.parent,i=new l.g,s=this.isFiltered(e);if(s.isTrue&&(i=this.filterQuery(i,s.column,!0)),t.searchSettings.key.length){let s=t.searchSettings;e.dataSource instanceof l.a&&e.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===e.dataSource.adaptor.getModuleName()?i=this.searchQuery(i,e,!0):i.search(s.key,e.foreignKeyValue,s.operator,s.ignoreCase)}return i}isFiltered(e){let t=this.parent.filterSettings.columns.filter(t=>t.field===e.foreignKeyValue&&t.uid===e.uid);return{column:t,isTrue:!!t.length}}getModuleName(){return"foreignKey"}destroy(){this.destroyEvent()}destroyEvent(){this.parent.isDestroyed||(this.parent.off("initForeignKeyColumn",this.initForeignKeyColumns),this.parent.off("getForeignKeyData",this.getForeignKeyData),this.parent.off("generateQuery",this.generateQueryFormData))}}},tn={provide:"GridsBlazorAction",useValue:class{constructor(e){this.aria=new Q,this.actionArgs={},this.virtualHeight=0,this.parent=e,this.addEventListener()}addEventListener(){this.parent.isDestroyed||(this.parent.on("detailclick",this.onDetailRowClick,this),this.parent.on("add-delete-success",this.addDeleteSuccess,this),this.parent.on("editsuccess",this.editSuccess,this),this.parent.on("setvisibility",this.setColumnVisibility,this),this.parent.on("offset",this.setServerOffSet,this),this.parent.on("updateaction",this.modelChanged,this),this.parent.on(D,this.modelChanged,this),this.parent.on("group-expand-collapse",this.onGroupClick,this),this.parent.on("setcolumnstyles",this.setColVTableWidthAndTranslate,this),this.parent.on("refresh-virtual-indices",this.invokeServerDataBind,this),this.parent.on("contentcolgroup",this.contentColGroup,this),this.parent.on("datasource-modified",this.dataSourceModified,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off("detailclick",this.onDetailRowClick),this.parent.off("add-delete-success",this.addDeleteSuccess),this.parent.off("editsuccess",this.editSuccess),this.parent.off("setvisibility",this.setColumnVisibility),this.parent.off("offset",this.setServerOffSet),this.parent.off("updateaction",this.modelChanged),this.parent.off(D,this.modelChanged),this.parent.off("group-expand-collapse",this.onGroupClick),this.parent.off("setcolumnstyles",this.setColVTableWidthAndTranslate),this.parent.off("refresh-virtual-indices",this.invokeServerDataBind),this.parent.off("contentcolgroup",this.contentColGroup),this.parent.off("datasource-modified",this.dataSourceModified))}getModuleName(){return"blazor"}modelChanged(e){this.actionArgs=e,this.parent.currentAction=e}addDeleteSuccess(e){let t;t={requestType:e.requestType,data:e.data,action:e.action},Object(n.X)(e.index)||(t.index=e.index),e.promise.then(e=>this.editSuccess(t)).catch(e=>{if(Object(n.W)()&&this.parent.isServerRendered){let t="error",i="message";Object(n.X)(e[t])||Object(n.X)(e[t][i])||(e[t]=e[t][i])}this.parent.trigger("actionFailure",Object(n.W)()&&e instanceof Array?e[0]:e),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})})}editSuccess(e){this.parent.renderModule.resetTemplates(),this.invokeServerDataBind(e)}invokeServerDataBind(e){this.actionArgs=e,this.parent.currentAction=e,this.parent.allowServerDataBinding=!0,this.parent.serverDataBind(),this.parent.allowServerDataBinding=!1}onDetailRowClick(e){let t=this.parent,i=e.parentElement,s=i.getAttribute("data-uid"),r=t.getRowObjectFromUID(s),n={uid:s,classList:e.classList[0],index:i.getAttribute("aria-rowindex"),rowIndex:t.getRowsObject().indexOf(r),colSpan:this.parent.getVisibleColumns().length};if(t.interopAdaptor.invokeMethodAsync("OnDetailClick",n),e.classList.contains("e-detailrowcollapse")){let i=t.getRowsObject(),s=r.data,l=this.parent.getRowUid("grid-row"),a=t.groupSettings.columns.length,o=new P({isDataRow:!0,isExpand:!0,uid:l,isDetailRow:!0,cells:[new q({cellType:A.Indent}),new q({isDataCell:!0,visible:!0})]});for(let e=0;e<a;e++)o.cells.unshift(new q({cellType:A.Indent}));i.splice(n.rowIndex+1,0,o),t.trigger("detailDataBound",{data:s}),t.notify("detailDataBound",{rows:t.getRowsObject()}),r.isExpand=!0,this.aria.setExpand(e,!0)}else t.getRowsObject().splice(n.rowIndex+1,1),t.notify("detailDataBound",{rows:t.getRowsObject()}),r.isExpand=!1,this.aria.setExpand(e,!1)}setColumnVisibility(e){let t={};for(let i=0;i<e.length;i++)t[e[i].uid]=e[i].visible;this.parent.interopAdaptor.invokeMethodAsync("setColumnVisibility",{visible:t})}dataSuccess(e){if(this.parent.enableVirtualization&&0===Object.keys(this.actionArgs).length&&(this.actionArgs.requestType="virtualscroll"),this.actionArgs.startIndex=e.startIndex,this.actionArgs.endIndex=e.endIndex,this.parent.enableVirtualization){if(this.virtualContentModule=this.parent.contentModule,"downArrow"===this.virtualContentModule.activeKey||"upArrow"===this.virtualContentModule.activeKey){let e=this.parent.getRowByIndex(this.virtualContentModule.blzRowIndex);e&&(this.parent.selectRow(parseInt(e.getAttribute("aria-rowindex"),10)),e.cells[0].focus({preventScroll:!0}))}this.virtualContentModule.blazorDataLoad=!1}if(e.foreignColumnsData){let t=this.parent.getColumns();for(let i=0;i<t.length;i++)e.foreignColumnsData[t[i].field]&&(t[i].columnData=e.foreignColumnsData[t[i].field])}if(this.parent.allowGrouping&&this.parent.groupSettings.columns){let t,i,s=[],r=this.parent.aggregates;for(let e=0;e<r.length;e++){let t=r[e];for(let e=0;e<t.columns.length;e++){let i={};i={type:t.columns[e].type.toString().toLowerCase(),field:t.columns[e].field},s.push(i)}}let n=this.parent.groupSettings.columns;for(let a=0;a<n.length;a++)i=t||e.result,t=l.b.group(i,n[a],s,null,null);e.result=t||e.result}let t="offset";if(this.parent.rowUid=e.rowUid,e[t]=1===Math.sign(e[t])?-Math.abs(e[t]):Math.abs(e[t]),this.parent.offsetTime=e[t],this.parent.offsetTime!==(new Date).getTimezoneOffset()/60)if("Batch"!==this.parent.editSettings.mode){let t="action",i="rowIndex",s="index";"edit"===this.actionArgs[t]?this.setClientOffSet(e,this.actionArgs[i]):"add"===this.actionArgs[t]&&this.setClientOffSet(e,this.actionArgs[s])}else if("Batch"===this.parent.editSettings.mode){let t="changes",i="changedRecords",s="addedRecords",r=this.parent.getPrimaryKeyFieldNames()[0],n=this.actionArgs[t]||{changedRecords:[],addedRecords:[]};for(let l=0;l<n[i].length;l++)for(let t=0;t<e.result.length;t++)n[i][l][r]===e.result[t][r]&&this.setClientOffSet(e,t);for(let l=0;l<n[s].length;l++)for(let t=0;t<e.result.length;t++)n[s][l][r]===e.result[t][r]&&this.setClientOffSet(e,t)}this.parent.renderModule.dataManagerSuccess(e,this.actionArgs),this.parent.getMediaColumns(),this.parent.enableVirtualization&&(this.virtualContentModule=this.parent.contentModule,this.setColVTableWidthAndTranslate(),this.parent.groupSettings.columns.length&&this.virtualContentModule.setVirtualHeight(this.virtualHeight)),this.actionArgs=this.parent.currentAction={}}removeDisplayNone(){let e=this.parent.getContentTable().querySelectorAll("tr");for(let t=0;t<e.length;t++){let i=e[t].querySelectorAll("td");for(let e=0;e<i.length;e++)i[e].style.display=""}}setVirtualTrackHeight(e){this.virtualHeight=e.VisibleGroupedRowsCount*this.parent.getRowHeight(),this.virtualContentModule.setVirtualHeight(this.virtualHeight)}setColVTableWidthAndTranslate(e){if(this.parent.enableColumnVirtualization&&this.virtualContentModule.prevInfo&&JSON.stringify(this.virtualContentModule.currentInfo.columnIndexes)!==JSON.stringify(this.virtualContentModule.prevInfo.columnIndexes)||e&&e.refresh){let e=this.virtualContentModule.getColumnOffset(this.virtualContentModule.startColIndex-1),t=this.virtualContentModule.getColumnOffset(this.virtualContentModule.endColIndex-1)-e+"";this.virtualContentModule.header.virtualEle.setWrapperWidth(t),this.virtualContentModule.virtualEle.setWrapperWidth(t),this.virtualContentModule.header.virtualEle.adjustTable(e,0),this.parent.getContentTable().parentElement.style.width=t+"px"}this.dataSourceChanged&&(this.virtualContentModule.getPanel().firstElementChild.scrollTop=0,this.virtualContentModule.getPanel().firstElementChild.scrollLeft=0,this.virtualContentModule.header.virtualEle&&this.virtualContentModule.header.virtualEle.adjustTable(0,0),this.parent.getContentTable().parentElement.style.transform="translate(0px,0px)",this.virtualContentModule.refreshOffsets(),this.virtualContentModule.refreshVirtualElement(),this.dataSourceChanged=!1)}dataSourceModified(){this.dataSourceChanged=!0}setClientOffSet(e,t){let i=l.b.serverTimezoneOffset;l.b.serverTimezoneOffset=0,e.result[t]=l.b.parse.parseJson(JSON.stringify(e.result[t])),l.b.serverTimezoneOffset=i}setServerOffSet(e){let t=l.b.serverTimezoneOffset,i=(new Date).getTimezoneOffset()/60*2+this.parent.offsetTime;l.b.serverTimezoneOffset=i,e.data=l.b.parse.parseJson(JSON.stringify(e.data)),l.b.serverTimezoneOffset=t}onGroupClick(e){e.exactTopIndex=Math.round(this.parent.element.querySelector(".e-content").scrollTop/this.parent.getRowHeight()),e.rowHeight=this.parent.getRowHeight(),this.parent.interopAdaptor.invokeMethodAsync("OnGroupExpandClick",e).then(()=>{this.parent.contentModule.rowElements=[].slice.call(this.parent.getContentTable().querySelectorAll("tr.e-row[data-uid]"))})}setPersistData(e){let t=this.parent;t.mergePersistGridData(e),t.bulkChanges.columns&&delete t.bulkChanges.columns,t.headerModule.refreshUI(),t.notify("persist-data-changed",{}),t.notify("column-visible-changed",t.getColumns())}resetPersistData(e){let t=this.parent,i=JSON.parse(e),s={filterSettings:i.filterSettings,groupSettings:i.groupSettings,pageSettings:i.pageSettings,sortSettings:i.sortSettings,searchSettings:i.searchSettings,columns:i.columns};s.sortSettings.columns||(s.sortSettings.columns=[]),s.groupSettings.columns||(s.groupSettings.columns=[]),s.pageSettings.currentPage||(t.pageSettings.currentPage=1);for(let r=0;r<t.columns.length;r++)t.groupSettings.columns.indexOf(t.columns[r].field)>-1&&(t.columns[r].visible=!0);t.mergePersistGridData(s),t.notify("persist-data-changed",{}),t.bulkChanges.columns&&delete t.bulkChanges.columns,t.headerModule.refreshUI();for(let r=0;r<t.columns.length;r++)t.columns[r].editType=t.columns[r].editType.toLowerCase();t.setProperties({filterSettings:{columns:[]}},!0)}contentColGroup(){let e=this.parent,t=e.getContent().querySelector(".e-table");if(t.insertBefore(t.querySelector(`#content-${e.element.id}colGroup`),t.querySelector("tbody")),e.frozenRows){let t=e.getHeaderContent().querySelector(".e-table");t.insertBefore(t.querySelector(`#${e.element.id}colGroup`),t.querySelector("tbody"))}if(0!==e.getFrozenColumns()){let t=e.getContent().querySelector(".e-movablecontent").querySelector(".e-table");if(t.insertBefore(t.querySelector(`#${e.element.id}colGroup`),t.querySelector("tbody")),e.frozenRows){let t=e.getHeaderContent().querySelector(".e-movableheader").querySelector(".e-table");t.insertBefore(t.querySelector(`#${e.element.id}colGroup`),t.querySelector("tbody"))}}}dataFailure(e){this.parent.renderModule.dataManagerFailure(e,this.actionArgs),this.actionArgs=this.parent.currentAction={}}destroy(){this.removeEventListener()}}},sn={provide:"GridsInfiniteScroll",useValue:class{constructor(e,t){this.infiniteCache={},this.infiniteCurrentViewData={},this.infiniteFrozenCache={},this.isDownScroll=!1,this.isUpScroll=!1,this.isScroll=!0,this.enableContinuousScroll=!1,this.initialRender=!0,this.isRemove=!1,this.isInitialCollapse=!1,this.prevScrollTop=0,this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting"],this.keys=["downArrow","upArrow","PageUp","PageDown"],this.rowTop=0,this.isInitialMovableRender=!0,this.virtualInfiniteData={},this.isCancel=!1,this.emptyRowData={},this.isNormaledit=!1,this.isInfiniteScroll=!1,this.isLastPage=!1,this.isInitialRender=!0,this.parent=e,this.serviceLocator=t,this.isNormaledit="Normal"===this.parent.editSettings.mode,this.addEventListener(),this.widthService=t.getService("widthService"),this.rowModelGenerator=this.parent.isFrozenGrid()?new js(this.parent):new N(this.parent)}getModuleName(){return"infiniteScroll"}addEventListener(){this.parent.on(S,this.onDataReady,this),this.parent.on("datasource-modified",this.dataSourceModified,this),this.parent.on("infinite-page-query",this.infinitePageQuery,this),this.parent.on("infinite-scroll-handler",this.infiniteScrollHandler,this),this.parent.on("beforecellfocused",this.infiniteCellFocus,this),this.parent.on("append-infinite-content",this.appendInfiniteRows,this),this.parent.on("remove-infinite-rows",this.removeInfiniteCacheRows,this),this.parent.on("reset-infinite-blocks",this.resetInfiniteBlocks,this),this.parent.on("set-infinite-cache",this.setCache,this),this.parent.on("initial-collapse",this.ensureIntialCollapse,this),this.parent.on(I,this.infiniteCellFocus,this),this.parent.on("infinite-show-hide",this.setDisplayNone,this),this.parent.on("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent.on("get-virtual-data",this.getVirtualInfiniteData,this),this.parent.on("edit-reset",this.resetInfiniteEdit,this),this.parent.on("virtual-scroll-edit-success",this.infiniteEditSuccess,this),this.parent.on("refresh-virtual-cache",this.refreshInfiniteCache,this),this.parent.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.on("virtual-scroll-add-action-begin",this.infiniteAddActionBegin,this),this.parent.on(D,this.modelChanged,this),this.parent.on("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData,this),this.parent.on("delete-complete",this.deleteComplate,this),this.parent.addEventListener(f,this.actionBegin.bind(this)),this.parent.addEventListener(y,this.actionComplete.bind(this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(S,this.onDataReady),this.parent.off("datasource-modified",this.dataSourceModified),this.parent.off("infinite-page-query",this.infinitePageQuery),this.parent.off("infinite-scroll-handler",this.infiniteScrollHandler),this.parent.off("beforecellfocused",this.infiniteCellFocus),this.parent.off("append-infinite-content",this.appendInfiniteRows),this.parent.off("remove-infinite-rows",this.removeInfiniteCacheRows),this.parent.off("reset-infinite-blocks",this.resetInfiniteBlocks),this.parent.off("set-infinite-cache",this.setCache),this.parent.off("initial-collapse",this.ensureIntialCollapse),this.parent.off(I,this.infiniteCellFocus),this.parent.off("infinite-show-hide",this.setDisplayNone),this.parent.off("virtual-scroll-edit-action-begin",this.editActionBegin),this.parent.off("get-virtual-data",this.getVirtualInfiniteData),this.parent.off("edit-reset",this.resetInfiniteEdit),this.parent.off("virtual-scroll-edit-success",this.infiniteEditSuccess),this.parent.off("refresh-virtual-cache",this.refreshInfiniteCache),this.parent.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off("virtual-scroll-add-action-begin",this.infiniteAddActionBegin),this.parent.off(D,this.modelChanged),this.parent.off("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData),this.parent.removeEventListener(f,this.actionBegin.bind(this)),this.parent.removeEventListener(y,this.actionComplete.bind(this)))}updateCurrentViewData(){let e=this.parent;if(e.groupSettings.columns.length)return;let t=Object.keys(this.infiniteCurrentViewData);e.currentViewData=[];let i=e.pageSettings.currentPage,s=e.infiniteScrollSettings.enableCache,r=e.infiniteScrollSettings.maxBlocks,n=s&&(i>r||this.isUpScroll&&i>1),l=n?this.isUpScroll?i:i-r+1:1,a=n?l+r-1:s?r:t.length;for(let o=l;o<=a;o++)this.infiniteCurrentViewData[o]&&(e.currentViewData=e.currentViewData.concat(this.infiniteCurrentViewData[o]))}refreshInfiniteCurrentViewData(e){let t=this.parent.pageSettings.currentPage,i=this.parent.pageSettings.pageSize,s=this.parent.infiniteScrollSettings.initialBlocks,r=Object.keys(this.infiniteCurrentViewData),n=this.parent.infiniteScrollSettings.enableCache;if(!this.parent.groupSettings.columns.length){let l="save"===e.args.requestType,a="delete"===e.args.requestType;n||!l&&!a?e.data.length===s*i?this.setInitialCache(e.data.slice(),{},n&&"delete"===e.args.requestType,!0):this.infiniteCurrentViewData[t]=e.data.slice():l?this.infiniteCurrentViewData[1]=e.data.concat(this.infiniteCurrentViewData[1]):this.infiniteCurrentViewData[r[r.length-1]].push(e.data[0])}}deleteComplate(){this.parent.isFrozenGrid()&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.contentModule.refreshScrollOffset()}modelChanged(e){if("infiniteScroll"!==e.requestType&&("delete"===e.requestType||"add"===this.requestType)){let t=this.parent.getRows();if(this.firstIndex=parseInt(t[0].getAttribute("aria-rowindex"),10),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=parseInt(t[t.length-1].getAttribute("aria-rowindex"),10),"delete"===e.requestType){let t=this.parent.getRowsObject();e.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:t[t.length-1].index}else e.startIndex=this.firstIndex;this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==e.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1)}}infiniteAddActionBegin(e){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(e.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))}infiniteEditHandler(e){if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===e.e.requestType||"save"===e.e.requestType&&"add"===this.requestType)){let t=this.parent.isFrozenGrid(),i=this.parent.getRows(),s=this.parent.getRowsObject();if(this.ensureRowAvailability(s,e.result[0])){if(this.resetRowIndex(s,e.e,i,"add"===this.requestType,!0),t){let t=this.parent.getMovableRowsObject();if(this.resetRowIndex(t,e.e,this.parent.getMovableDataRows(),"add"===this.requestType),"Left-Right"===this.parent.getFrozenMode()){let t=this.parent.getFrozenRightRowsObject();this.resetRowIndex(t,e.e,this.parent.getFrozenRightRows(),"add"===this.requestType)}}if(this.isLastPage){if(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows){if(Object(n.hb)(i[this.parent.frozenRows-1]),this.createRow([s[this.parent.frozenRows-1]],e,!1,!0),t){let t=this.parent.getMovableDataRows();if(Object(n.hb)(t[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],e,!0,!0),"Left-Right"===this.parent.getFrozenMode()){let t=this.parent.getFrozenRightDataRows();Object(n.hb)(t[this.parent.frozenRows]),this.createRow([this.parent.getFrozenRightRowsObject()[this.parent.frozenRows-1]],e,!1,!0,!0)}}ui(this.parent)}}else this.createRow(s,e)}this.parent.hideSpinner(),this.parent.notify("delete"===this.requestType?"delete-complete":"save-complete",e.e)}this.parent.notify("freezerender",{case:"refreshHeight"})}createRow(e,t,i,s,r){let l,a=s?e:this.generateRows(t.result,t.e),o=new H(this.serviceLocator,null,this.parent);l=r?this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody"):this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualContent().querySelector("tbody"):this.parent.getFrozenVirtualContent().querySelector("tbody"):this.parent.getContent().querySelector("tbody"),this.parent.frozenRows&&(l=s&&"add"!==this.requestType||!s&&"add"===this.requestType?this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualHeader().querySelector("tbody"):r?this.parent.element.querySelector(".e-frozen-right-header").querySelector("tbody"):this.parent.getFrozenVirtualHeader().querySelector("tbody"):this.parent.getHeaderContent().querySelector("tbody"):l);for(let n=a.length-1;n>=0;n--)"delete"===this.requestType?l.appendChild(o.render(a[n],this.parent.getColumns())):l.insertBefore(o.render(a[n],this.parent.getColumns()),l.firstElementChild);if(!s&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)){let s=i?this.parent.getMovableDataRows():r?this.parent.getFrozenRightDataRows():this.parent.getRows(),l=(i||r)&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1;Object(n.hb)(s[l]),this.createRow([e[this.parent.frozenRows-1]],t,i,!0,r)}this.parent.infiniteScrollSettings.enableCache||s||(r?(ui(this.parent),this.parent.contentModule.rightFreezeRows="add"===this.requestType?a.concat(e):e.concat(a)):!this.parent.isFrozenGrid()||i?(ui(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?a.concat(e):e.concat(a),"Left-Right"===this.parent.getFrozenMode()&&this.createRow(this.parent.getFrozenRightRowsObject(),t,!1,!1,!0)):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?a.concat(e):e.concat(a),this.createRow(this.parent.getMovableRowsObject(),t,!0)))}ensureRowAvailability(e,t){let i=!0;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType){let s=this.parent.getPrimaryKeyFieldNames()[0];for(let r=0;r<e.length;r++)if(e[r].data[s]===t[s]){i=!1;break}}return i}generateRows(e,t){return this.rowModelGenerator.generateRows(e,t)}resetRowIndex(e,t,i,s,r){let l=this.parent.getPrimaryKeyFieldNames()[0];s?!(i.length%this.parent.pageSettings.pageSize)&&(r&&!this.parent.groupSettings.columns.length&&this.swapCurrentViewData(1,!0),Object(n.hb)(i[e.length-1]),i.splice(e.length-1,1),e.splice(e.length-1,1)):e.filter((s,a)=>{if(s.data[l]===t.data[0][l]){if(r&&!this.parent.groupSettings.columns.length){let e=Math.ceil((a+1)/this.parent.pageSettings.pageSize);this.resetInfiniteCurrentViewData(e,a)}e.splice(a,1),Object(n.hb)(i[a]),i.splice(a,1)}}),ci(this.parent,e,i,s?1:0)}resetInfiniteCurrentViewData(e,t){this.infiniteCurrentViewData[e].splice(t-=(e-1)*this.parent.pageSettings.pageSize,1),this.swapCurrentViewData(e,!1)}swapCurrentViewData(e,t){let i=Object.keys(this.infiniteCurrentViewData),s=t?i.length+1:i.length;for(let r=e;r<s;r++)if(this.infiniteCurrentViewData[r+1]){let e=this.infiniteCurrentViewData[t?r:r+1].splice(t?this.infiniteCurrentViewData[r].length-1:0,1);t?(this.infiniteCurrentViewData[r+1]=e.concat(this.infiniteCurrentViewData[r+1]),r+1===s-1&&this.infiniteCurrentViewData[r+1].splice(this.infiniteCurrentViewData[r+1].length-1,1)):this.infiniteCurrentViewData[r].push(e[0])}this.updateCurrentViewData()}setDisplayNone(e){if(this.parent.infiniteScrollSettings.enableCache){let t=this.parent.isFrozenGrid(),i=Object.keys(t?this.infiniteFrozenCache:this.infiniteCache);for(let s=1;s<=i.length;s++)(t?e.isFreeze?this.infiniteFrozenCache[s][0]:this.infiniteFrozenCache[s][1]:this.infiniteCache[s]).filter(t=>{t.cells[e.index].visible=""===e.visible});this.resetContentModuleCache(t?this.infiniteFrozenCache:this.infiniteCache)}}refreshInfiniteCache(e){this.getEditedRowObject().data=e}getEditedRowObject(){let e,t=this.parent.getRowsObject();for(let i=0;i<t.length;i++)t[i].index===this.editRowIndex&&(e=t[i]);return e}infiniteEditSuccess(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewRecords(e.data),this.isAdd=!1)}updateCurrentViewRecords(e){let t=oi(this.parent,e);Object(n.X)(t)||(this.parent.getCurrentViewRecords()[t]=e)}actionBegin(e){"add"!==e.requestType&&"delete"!==e.requestType||(this.requestType=e.requestType),(this.parent.isFrozenGrid()&&!e.cancel&&"searching"===e.requestType||"sorting"===e.requestType||"filtering"===e.requestType)&&(this.isInitialRender=!0)}actionComplete(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.requestType=this.empty,this.isCancel="cancel"===e.requestType||"save"===e.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))}resetInfiniteEdit(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)}getVirtualInfiniteData(e){e.virtualData=this.virtualInfiniteData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}editActionBegin(e){this.isEdit=!0,this.editRowIndex=e.index;let t=Object(n.K)({},this.getEditedRowObject().data);e.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:t}dataSourceModified(){this.resetInfiniteBlocks({requestType:this.empty},!0)}onDataReady(e){Object(n.X)(e.count)||(this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize))}ensureIntialCollapse(e){this.isInitialCollapse=!e}infiniteScrollHandler(e){this.restoreInfiniteEdit(),this.restoreInfiniteAdd();let t=e.target;if(t.classList.contains("e-content")&&this.parent.enableInfiniteScrolling){let e=this.parent.getContent().firstElementChild;this.prevScrollTop=e.scrollTop;let i,s=this.parent.getRows(),r=parseInt(s[s.length-1].getAttribute("aria-rowindex"),10)+1,l=this.parent.pageSettings.currentPage,a=t.scrollHeight-t.scrollTop,o=Math.round(t.scrollHeight-t.scrollTop),h=(a<t.clientHeight?Math.ceil(a):Math.floor(a))===t.clientHeight||o===t.clientHeight;if(this.isScroll&&h&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0,setTimeout(()=>{this.isScroll=!0},600));let t=[].slice.call(e.querySelectorAll(".e-row:not(.e-addedrow)")),s=parseInt(t[t.length-1].getAttribute("aria-rowindex"),10);this.parent.pageSettings.currentPage=Math.ceil(s/this.parent.pageSettings.pageSize)+1,i={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:r,direction:"down"},this.makeRequest(i)}if(this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===t.scrollTop&&1!==this.parent.pageSettings.currentPage){this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0,setTimeout(()=>{this.isScroll=!0},600));let t=[].slice.call(e.querySelectorAll(".e-row")),s=parseInt(t[this.parent.pageSettings.pageSize-1].getAttribute("aria-rowindex"),10),r=parseInt(t[0].getAttribute("aria-rowindex"),10)-this.parent.pageSettings.pageSize;this.parent.pageSettings.currentPage=Math.ceil(s/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(i={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:r,direction:"up"},this.makeRequest(i))}this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&Object(n.X)(i)&&(this.isDownScroll||this.isUpScroll)&&(e.scrollTop=this.top)}}makeRequest(e){this.parent.pageSettings.currentPage!==e.prevPage&&(this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,Object(n.X)(this.infiniteCache[e.currentPage])?setTimeout(()=>{this.getVirtualInfiniteEditedData(),this.parent.notify("model-changed",e)},100):setTimeout(()=>{this.getVirtualInfiniteEditedData(),this.parent.notify("refresh-infinite-mode-blocks",e)},100)):this.parent.pageSettings.currentPage=this.maxPage)}infinitePageQuery(e){this.initialRender?(this.initialRender=!1,this.intialPageQuery(e)):this.isInfiniteScroll||"delete"!==this.requestType&&"add"!==this.requestType?e.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(e)}editPageQuery(e){let t=this.parent.infiniteScrollSettings.initialBlocks;this.parent.infiniteScrollSettings.enableCache?(this.infiniteCache={},this.infiniteFrozenCache={},this.infiniteCurrentViewData={},e.skip(this.firstIndex),e.take(t*this.parent.pageSettings.pageSize)):("Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection(),e.skip("delete"===this.requestType?this.lastIndex:this.firstIndex),e.take(1))}intialPageQuery(e){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks),e.page(1,this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks)}infiniteCellFocus(e){if(!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action)"PageDown"!==e.key&&"PageUp"!==e.key||(this.pressedKey=e.key);else{this.pressedKey=e.keyArgs.action;let t=document.activeElement,i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),s=this.parent.getContent().firstElementChild;this.rowIndex="downArrow"===e.keyArgs.action?i+1:i-1,this.cellIndex=parseInt(t.getAttribute("aria-colindex"),10);let r=this.parent.getRowByIndex(i),n=Math.floor(s.offsetHeight/this.parent.getRowHeight());if(!r||ni(r,this.parent)||li(r,this.rowTop)){let t=r?r.getBoundingClientRect().height:this.parent.getRowHeight();if(!this.parent.infiniteScrollSettings.enableCache){if("downArrow"===e.keyArgs.action&&(ni(r,this.parent)||!r)){let e=(this.rowIndex-n)*t,i=s.scrollTop+this.parent.getRowHeight();s.scrollTop=e<i?i:e}"upArrow"===e.keyArgs.action&&li(r,this.rowTop)&&(s.scrollTop=this.rowIndex*t)}}else this.pressedKey=this.empty}}createEmptyRowdata(){this.parent.getColumns().filter(e=>{this.emptyRowData[e.field]=this.empty})}getVirtualInfiniteEditedData(){let e=this.parent.element.querySelector(".e-editedrow"),t=this.parent.element.querySelector(".e-addedrow"),i=this.parent.element.querySelector(".e-gridform");if(this.parent.infiniteScrollSettings.enableCache&&(e||t)){let t=e?Object(n.K)({},this.getEditedRowObject().data):Object(n.K)({},this.emptyRowData);this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(i,t),this.parent.isFrozenGrid()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),t))}}restoreInfiniteEdit(){let e=this.parent.getContent().firstElementChild;if(this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&(!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows)&&this.parent.editSettings.allowEditing&&!Object(n.X)(this.editRowIndex)){let t=this.parent.getRowByIndex(this.editRowIndex);if(Object.keys(this.virtualInfiniteData).length&&t&&!this.parent.getContent().querySelector(".e-editedrow")){let i=t.getBoundingClientRect().top;i<e.offsetHeight&&i>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(t))}}}restoreInfiniteAdd(){let e=this.parent.getContent().firstElementChild;this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!e.querySelector(".e-addedrow")&&e.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord())}appendInfiniteRows(e){document;let t=this.parent.isFrozenGrid(),i=this.parent.getContent().firstElementChild,s=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType,r="Left-Right"===this.parent.getFrozenMode()&&"movable"===e.tableName;if((!s||e.args.isFrozen||r)&&s||(s&&"up"===e.args.direction?e.tbody.insertBefore(e.frag,e.tbody.firstElementChild):e.tbody.appendChild(e.frag)),t)if(s)if("frozen-left"===e.tableName||"Right"===this.parent.getFrozenMode()&&"frozen-right"===e.tableName)this.frozenFrag=e.frag;else if("Left-Right"===this.parent.getFrozenMode()&&"movable"===e.tableName)this.movableFrag=e.frag;else{let t=this.parent.getFrozenVirtualContent().querySelector("tbody");"up"===e.args.direction?t.insertBefore(this.frozenFrag,t.firstElementChild):t.appendChild(this.frozenFrag),"frozen-right"===e.tableName?(this.parent.getMovableVirtualContent().querySelector("tbody").appendChild(this.movableFrag),this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody").appendChild(e.frag)):this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(e.tbody),this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData()}else{let t;"frozen-left"===e.tableName?t=this.parent.getFrozenVirtualContent().querySelector(".e-table"):"movable"===e.tableName?(t=this.parent.getMovableVirtualContent().querySelector(".e-table"),"Left-Right"!==this.parent.getFrozenMode()&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())):(t=this.parent.element.querySelector(".e-frozen-right-content").querySelector(".e-table"),"Left-Right"===this.parent.getFrozenMode()&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())),t.appendChild(e.tbody),this.widthService.refreshFrozenScrollbar()}else this.parent.contentModule.getTable().appendChild(e.tbody),this.updateCurrentViewData();this.isInitialRender&&!e.args.isFrozen&&(this.isInitialRender=!1,this.parent.scrollModule.setHeight()),e.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,s&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(i.scrollTop=this.top),ui(this.parent),this.selectNewRow(e.tbody,e.args.startIndex),this.pressedKey=void 0),this.restoreInfiniteAdd()),this.isInfiniteScroll=!1}selectNewRow(e,t){let i=this.parent.getRowByIndex(this.rowIndex);if(this.keys.some(e=>e===this.pressedKey)){if(("downArrow"===this.pressedKey||this.parent.infiniteScrollSettings.enableCache&&"upArrow"===this.pressedKey)&&setTimeout(()=>{i.cells[0].focus({preventScroll:!0}),this.parent.selectRow(this.rowIndex),this.parent.getContent().firstElementChild.scrollTop+=this.parent.getRowHeight()},0),"PageDown"===this.pressedKey){let e=this.parent.getRowByIndex(t);e&&e.cells[0].focus()}"PageUp"===this.pressedKey&&e.querySelector(".e-row").cells[0].focus()}}removeInfiniteCacheRows(e){if(!e.args.isFrozen&&this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove){let t=[].slice.call(this.parent.getContentTable().querySelectorAll(".e-row"));if("down"===e.args.direction){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){let t=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(t,e.args)}let i=this.parent.element.querySelector(".e-addedrow")?0:1;this.removeTopRows(t,this.parent.pageSettings.pageSize-i)}if("up"===e.args.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){let t=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(t,e.args)}else this.removeBottomRows(t,t.length-1,e.args);this.isScroll=!1,this.top=this.calculateScrollTop(e.args)}}calculateScrollTop(e){let t=0,i=this.parent.getContent().firstElementChild;if("down"===e.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(t=this.captionRowHeight());let e=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)")),s=0;this.isInitialCollapse&&!Object(n.X)(e)&&(s=Math.round((e.length-1)/this.parent.groupSettings.columns.length));let r=s||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),l=0,a=0;for(;l<i.clientHeight;)a++,l=a*this.parent.getRowHeight();a-=1,t+=(r-a)*this.parent.getRowHeight()}if("up"===e.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)t=this.infiniteCache[this.parent.pageSettings.currentPage].length*this.parent.getRowHeight();else if(this.isInitialCollapse){let e=this.infiniteCache[this.parent.pageSettings.currentPage],i=0;for(let t=0;t<e.length;t++)e[t].isCaptionRow&&i++;t+=Math.round(i/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else t+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+Et();return t}captionRowHeight(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()}removeTopRows(e,t){let i=this.parent.isFrozenGrid(),s="Left-Right"===this.parent.getFrozenMode()?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").querySelectorAll(".e-row")):null,r=i?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null;for(let l=0;l<=t;l++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&l>t-this.parent.frozenRows||(Object(n.hb)(e[l]),r&&Object(n.hb)(r[l]),s&&Object(n.hb)(s[l]))}removeBottomRows(e,t,i){let s=0,r=this.parent.isFrozenGrid(),l=r?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null,a="Left-Right"===this.parent.getFrozenMode()?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").querySelectorAll(".e-row")):null,o=this.parent.pageSettings.pageSize;!r&&this.infiniteCache[i.prevPage].length<o&&(s=this.parent.pageSettings.pageSize-this.infiniteCache[i.prevPage].length),r&&this.infiniteFrozenCache[i.prevPage][1].length<o&&(s=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[i.prevPage][1].length);for(let h=t;s<o;h--)s++,Object(n.hb)(e[h]),l&&Object(n.hb)(l[h]),a&&Object(n.hb)(a[h])}removeCaptionRows(e,t){if("down"===t.direction){let t=this.parent.getRows()[this.parent.pageSettings.pageSize],i=parseInt(t.getAttribute("aria-rowindex"),10)-1,s=0;for(let r=0;s<i;r++)e[r].classList.contains("e-row")?s=parseInt(e[r].getAttribute("aria-rowindex"),10):Object(n.hb)(e[r])}if("up"===t.direction){let t=[].slice.call(this.parent.getContent().querySelectorAll(".e-row")),i=parseInt(t[t.length-1].getAttribute("aria-rowindex"),10),s=Math.ceil(i/this.parent.pageSettings.pageSize),r=0;for(let e=this.parent.pageSettings.currentPage+1;e<s;e++)r+=this.infiniteCache[e].length;for(let l=r;l<e.length;l++)Object(n.hb)(e[l])}}resetInfiniteBlocks(e,t){let i=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==e.requestType;if(!this.initialRender&&!Object(n.X)(this.parent.infiniteScrollModule)&&i&&(this.actions.some(t=>t===e.requestType)||t)){let e=this.parent.getContent().firstElementChild;this.initialRender=!0,e.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.infiniteCurrentViewData={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[]}}setCache(e){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){let t=this.parent.isFrozenGrid(),i=e.args.isFrozen?1:0,s="infiniteScroll"!==e.args.requestType&&("delete"===this.requestType||"add"===this.requestType),r=this.parent.pageSettings.currentPage;(t&&this.isInitialMovableRender||!t&&!Object.keys(this.infiniteCache).length||s)&&(this.isInitialMovableRender=!e.args.isFrozen,this.setInitialCache(e.modelData,e.args,s)),!t&&Object(n.X)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=e.modelData,this.resetContentModuleCache(this.infiniteCache)),t&&(0===i&&Object(n.X)(this.infiniteFrozenCache[r])||!this.infiniteFrozenCache[r][i].length)&&(this.createFrozenCache(r),this.infiniteFrozenCache[r][i]=e.modelData,1===i&&this.resetContentModuleCache(this.infiniteFrozenCache)),e.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(r-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}}setInitialCache(e,t,i,s){let r=this.parent.isFrozenGrid(),n=t.isFrozen?1:0,l=i?this.firstBlock:1;for(let a=1;a<=this.parent.infiniteScrollSettings.initialBlocks;a++){let t=(a-1)*this.parent.pageSettings.pageSize,i=a*this.parent.pageSettings.pageSize;this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!s?this.setInitialGroupCache(e,l,t,i):s?this.infiniteCurrentViewData[l]=e.slice(t,i):r?(this.createFrozenCache(l),this.infiniteFrozenCache[l][n]=e.slice(t,i),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[l]=e.slice(t,i),this.resetContentModuleCache(this.infiniteCache)),l++}}createFrozenCache(e){this.infiniteFrozenCache[e]||(this.infiniteFrozenCache[e]=[[],[]])}setInitialGroupCache(e,t,i,s){let r=[],n=0;for(let a=1;a<=Object.keys(this.infiniteCache).length;a++)n+=this.infiniteCache[a].length;let l=i;for(let a=n;a<e.length&&l<s&&((e[a].index<s||e[a].isCaptionRow)&&(l=e[a].isCaptionRow?l:e[a].index,r.push(e[a])),!(e[a].index>=s||e[a].index===s-1));a++);this.infiniteCache[t]=r,this.resetContentModuleCache(this.infiniteCache)}resetContentModuleCache(e){this.parent.contentModule.infiniteCache=e}destroy(){this.removeEventListener()}}},rn={provide:"GridsLazyLoadGroup",useValue:class{constructor(e,t){this.parent=e,this.serviceLocator=t,this.addEventListener()}getModuleName(){return"lazyLoadGroup"}addEventListener(){this.parent.isDestroyed||this.parent.on(v,this.instantiateRenderer,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off(v,this.instantiateRenderer)}instantiateRenderer(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());let e=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&e.addRenderer(L.Content,new Ys(this.parent,this.serviceLocator))}destroy(){this.removeEventListener()}}};let nn=(()=>{class e{}return e.\u0275mod=s.Lb({type:e}),e.\u0275inj=s.Kb({factory:function(t){return new(t||e)},providers:[kr,zr,Ar,Lr,Br,Pr,qr,Vr,Hr,Nr,Wr,Xr,Gr,Kr,Ur,Yr,_r,Qr,Jr,$r,Zr,en,tn,sn,rn],imports:[[_s.b,Tr],Tr]}),e})();var ln=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l},an=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const on=["click","created","dropDownChanged"],hn=[];let dn=(()=>{let e=class extends zi{constructor(e,t,i,s){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=s,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[],this.registerEvents(on),this.addTwoWay.call(this,hn),Object(r.g)("currentInstance",this,this.viewContainerRef),this.context=new r.c}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(s.Nb(s.l),s.Nb(s.D),s.Nb(s.O),s.Nb(s.r))},e.\u0275cmp=s.Hb({type:e,selectors:[["ejs-pager"]],contentQueries:function(e,t,i){var r;1&e&&s.Gb(i,Qs,!0),2&e&&s.xc(r=s.fc())&&(t.template=r.first)},inputs:{currentPage:"currentPage",customText:"customText",enableExternalMessage:"enableExternalMessage",enablePagerMessage:"enablePagerMessage",enablePersistence:"enablePersistence",enableQueryString:"enableQueryString",enableRtl:"enableRtl",externalMessage:"externalMessage",locale:"locale",pageCount:"pageCount",pageSize:"pageSize",pageSizes:"pageSizes",template:"template",totalRecordsCount:"totalRecordsCount"},outputs:{click:"click",created:"created",dropDownChanged:"dropDownChanged"},features:[s.ub],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),ln([Object(r.f)(),an("design:type",Object)],e.prototype,"template",void 0),e=ln([Object(r.d)([r.c]),an("design:paramtypes",[s.l,s.D,s.O,s.r])],e),e})(),cn=(()=>{class e{}return e.\u0275mod=s.Lb({type:e}),e.\u0275inj=s.Kb({factory:function(t){return new(t||e)},imports:[[_s.b]]}),e})(),pn=(()=>{class e{}return e.\u0275mod=s.Lb({type:e}),e.\u0275inj=s.Kb({factory:function(t){return new(t||e)},providers:[],imports:[[_s.b,cn],cn]}),e})()},gnsf:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"e",(function(){return f})),i.d(t,"b",(function(){return w})),i.d(t,"c",(function(){return H})),i.d(t,"f",(function(){return Q})),i.d(t,"d",(function(){return le}));var s=i("4SUy"),r=i("Naoh"),n=i("ngVE"),l=i("TF3C"),a=i("72GX"),o=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};const h="e-other-month",d="e-calendar",c="e-disabled",p="e-overlay",u="e-selected",g="e-focused-date";let m=(()=>{let e=class extends s.h{constructor(e,t){super(e,t),this.effect="",this.isPopupClicked=!1,this.isDateSelected=!0,this.isTodayClicked=!1,this.preventChange=!1,this.isAngular=!1}render(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),"Islamic"===this.calendarMode&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new s.n(this.locale),(Object(s.X)(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date((new Date).setHours(0,0,0,0)),"calendar"===this.getModuleName()?(this.element.classList.add(d),this.enableRtl&&this.element.classList.add("e-rtl"),s.d.isDevice&&this.element.classList.add("e-device"),Object(s.x)(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(d),this.enableRtl&&this.calendarElement.classList.add("e-rtl"),s.d.isDevice&&this.calendarElement.classList.add("e-device"),Object(s.x)(this.calendarElement,{role:"calendar"})),this.createHeader(),this.createContent(),this.wireEvents()}rangeValidation(e,t){Object(s.X)(e)&&this.setProperties({min:new Date(1900,0,1)},!0),Object(s.X)(t)&&this.setProperties({max:new Date(2099,11,31)},!0)}getDefaultKeyConfig(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs}validateDate(e){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date((new Date).setHours(0,0,0,0)),!Object(s.X)(e)&&this.min<=this.max&&e>=this.min&&e<=this.max&&(this.currentDate=new Date(this.checkValue(e)))}setOverlayIndex(e,t,i,r){if(r&&!Object(s.X)(t)&&!Object(s.X)(i)&&!Object(s.X)(e)){let s=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(s-1).toString(),e.style.zIndex=s.toString()}}minMaxUpdate(e){+this.min<=+this.max?Object(s.ib)([this.element],p):(this.setProperties({min:this.min},!0),Object(s.v)([this.element],p)),this.min=Object(s.X)(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=Object(s.X)(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&e&&+e<=+this.max&&+e>=+this.min?this.currentDate=new Date(this.checkValue(e)):+this.min<=+this.max&&!e&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))}createHeader(){this.headerElement=this.createElement("div",{className:"e-header"});let e=this.createElement("div",{className:"e-icon-container"});this.previousIcon=this.createElement("button",{className:"e-prev",attrs:{type:"button"}}),Object(s.kb)(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),Object(s.x)(this.previousIcon,{"aria-disabled":"false","aria-label":"previous month"}),this.nextIcon=this.createElement("button",{className:"e-next",attrs:{type:"button"}}),Object(s.kb)(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),Object(s.x)(this.nextIcon,{"aria-disabled":"false","aria-label":"next month"}),this.headerTitleElement=this.createElement("div",{className:"e-day e-title"}),Object(s.x)(this.headerTitleElement,{"aria-atomic":"true","aria-live":"assertive","aria-label":"title"}),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:"e-date-icon-prev e-icons"})),this.nextIcon.appendChild(this.createElement("span",{className:"e-date-icon-next  e-icons"})),e.appendChild(this.previousIcon),e.appendChild(this.nextIcon),this.headerElement.appendChild(e),"calendar"===this.getModuleName()?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()}createContent(){this.contentElement=this.createElement("div",{className:"e-content"}),this.table=this.createElement("table",{attrs:{tabIndex:"0",role:"grid","aria-activedescendant":""}}),"calendar"===this.getModuleName()?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter()}getCultureValues(){let e,t=[],i=(Object(s.W)()?"days.":"days.stand-alone.")+this.dayHeaderFormat.toLowerCase();e="en"===this.locale||"en-US"===this.locale?Object(s.V)(i,Object(s.N)()):this.getCultureObjects(s.B,""+this.locale);for(let r of Object.keys(e))t.push(Object(s.V)(r,e));return t}toCapitalize(e){return!Object(s.X)(e)&&e.length?e[0].toUpperCase()+e.slice(1):e}createContentHeader(){"calendar"===this.getModuleName()?Object(s.X)(this.element.querySelectorAll(".e-content .e-week-header")[0])||Object(s.I)(this.element.querySelectorAll(".e-content .e-week-header")[0]):Object(s.X)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||Object(s.I)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);let e,t="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:"e-week-header"}),this.weekNumber&&(t+='<th class="e-week-number"></th>',"calendar"===this.getModuleName()?Object(s.v)([this.element],"e-week-number"):Object(s.v)([this.calendarElement],"e-week-number")),e=this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek);for(let i=0;i<=6;i++)t+='<th  class="">'+this.toCapitalize(e[i])+"</th>";t="<tr>"+t+"</tr>",this.tableHeadElement.innerHTML=t,this.table.appendChild(this.tableHeadElement)}createContentBody(){switch("calendar"===this.getModuleName()?Object(s.X)(this.element.querySelectorAll(".e-content tbody")[0])||Object(s.I)(this.element.querySelectorAll(".e-content tbody")[0]):Object(s.X)(this.calendarElement.querySelectorAll(".e-content tbody")[0])||Object(s.I)(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}}updateFooter(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today"))}createContentFooter(){if(this.showTodayButton){let e=new Date(+this.min),t=new Date(+this.max),i={today:"Today"};this.globalize=new s.n(this.locale),this.l10=new s.p(this.getModuleName(),i,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),Object(s.kb)(this.todayElement),this.updateFooter(),Object(s.v)([this.todayElement],["e-btn","e-today","e-flat","e-primary","e-css"]),+new Date(e.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(t.setHours(0,0,0,0))&&!this.todayDisabled||Object(s.v)([this.todayElement],c),this.footer=this.createElement("div",{className:"e-footer-container"}),this.footer.appendChild(this.todayElement),"calendar"===this.getModuleName()&&this.element.appendChild(this.footer),"datepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),"datetimepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(c)||s.l.add(this.todayElement,"click",this.todayButtonClick,this)}}wireEvents(e,t,i,r){Object(s.W)()&&t?(this.element=document.getElementById(e),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,i),this.blazorRef=t,this.serverModuleName=r):(s.l.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs)),this.keyboardModule="calendar"===this.getModuleName()?new s.o(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):new s.o(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}dateWireEvents(e,t,i,r){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,i),this.blazorRef=t,this.serverModuleName=r}todayButtonClick(e,t,i){this.showTodayButton&&(this.effect=this.currentView()===this.depth?"":"e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(t)),i):this.navigateTo("Month",new Date(this.checkValue(t)),i))}checkDeviceMode(e){s.d.isDevice&&Object(s.W)()&&e&&e.invokeMethodAsync("OnDevice",!0)}keyActionHandle(e,t,i){Object(s.W)()&&this.blazorRef&&(e.preventDefault(),this.tableBodyElement||(this.element=Object(s.C)(e.target,".e-calendar"),this.tableBodyElement=this.element.querySelector("tbody")),i=!1);let r,n=this.tableBodyElement.querySelector("tr td.e-focused-date");if(r=i?Object(s.X)(n)||+t!==parseInt(n.getAttribute("id").split("_")[0],10)?this.tableBodyElement.querySelector("tr td.e-selected"):n:this.tableBodyElement.querySelector("tr td.e-selected"),Object(s.W)()&&this.blazorRef){this.tableBodyElement.focus();let t=e.target,i={Action:e.action,Key:e.key,Events:e,SelectDate:r?r.id:null,FocusedDate:n?n.id:null,classList:r?r.classList.toString():n?n.classList.toString():"e-cell",Id:n?n.id:r?r.id:null,TargetClassList:t.classList.toString()};this.blazorRef.invokeMethodAsync("OnCalendarKeyboardEvent",i),t.classList.contains("e-today")&&(t.blur(),this.tableBodyElement.focus()),"sf.calendars.Calendar"===this.serverModuleName&&(this.tableBodyElement=null)}else{let i=this.getViewNumber(this.currentView()),l=this.getViewNumber(this.depth),a=i===l&&this.getViewNumber(this.start)>=l;switch(this.effect="",e.action){case"moveLeft":this.KeyboardNavigate(-1,i,e,this.max,this.min),e.preventDefault();break;case"moveRight":this.KeyboardNavigate(1,i,e,this.max,this.min),e.preventDefault();break;case"moveUp":this.KeyboardNavigate(0===i?-7:-4,i,e,this.max,this.min),e.preventDefault();break;case"moveDown":this.KeyboardNavigate(0===i?7:4,i,e,this.max,this.min),e.preventDefault();break;case"select":if(e.target===this.todayElement)this.todayButtonClick(e,t);else{let l=Object(s.X)(n)?r:n;if(!Object(s.X)(l)&&!l.classList.contains(c))if(a){let t=new Date(parseInt(""+l.id,0));this.selectDate(e,t,l)}else this.contentClick(null,--i,l,t)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":Object(s.X)(n)&&(Object(s.X)(r)||a)||this.contentClick(null,--i,n||r,t),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),Object(s.I)(this.tableBodyElement),0===i?this.renderMonths(e):1===i?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,i),Object(s.I)(this.tableBodyElement),0===i?this.renderMonths(e):1===i?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault()}"calendar"===this.getModuleName()&&this.table.focus()}}KeyboardNavigate(e,t,i,r,n){let l=new Date(this.checkValue(this.currentDate));switch(t){case 2:this.addYears(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(Object(s.I)(this.tableBodyElement),this.renderDecades(i)):this.currentDate=l;break;case 1:this.addMonths(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(Object(s.I)(this.tableBodyElement),this.renderYears(i)):this.currentDate=l;break;case 0:this.addDay(this.currentDate,e,i,r,n),this.isMinMaxRange(this.currentDate)?(Object(s.I)(this.tableBodyElement),this.renderMonths(i)):this.currentDate=l}}preRender(e){this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=e=>{this.triggerNavigate(e)}}minMaxDate(e){let t=new Date(new Date(+e).setHours(0,0,0,0)),i=new Date(new Date(+this.min).setHours(0,0,0,0)),s=new Date(new Date(+this.max).setHours(0,0,0,0));return+t!=+i&&+t!=+s||(+e<+this.min&&(e=new Date(+this.min)),+e>+this.max&&(e=new Date(+this.max))),e}renderMonths(e,t,i){let s,r=this.weekNumber?8:7;s="Gregorian"===this.calendarMode?this.renderDays(this.currentDate,t,null,null,i):this.islamicModule.islamicRenderDays(this.currentDate,t),this.createContentHeader(),"Gregorian"===this.calendarMode?this.renderTemplate(s,r,"e-month",e,t):this.islamicModule.islamicRenderTemplate(s,r,"e-month",e,t)}renderDays(e,t,i,r,n){let l,a=[],o=n?new Date(+e):new Date,d=new Date(this.checkValue(e)),g=d.getMonth();this.titleUpdate(e,"days");let m=d;for(d=new Date(m.getFullYear(),m.getMonth(),0,m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds());d.getDay()!==this.firstDayOfWeek;)this.setStartDate(d,-864e5);for(let b=0;b<42;++b){let n=this.createElement("td",{className:"e-cell"}),m=this.createElement("span");if(b%7==0&&this.weekNumber){let e;e="FirstDay"===this.weekRule?6:"FirstFourDayWeek"===this.weekRule?3:0;let t=new Date(d.getFullYear(),d.getMonth(),d.getDate()+e);m.textContent=""+this.getWeek(t),n.appendChild(m),Object(s.v)([n],"e-week-number"),a.push(n)}l=new Date(+d),d=this.minMaxDate(d);let f={type:"dateTime",skeleton:Object(s.W)()?"D":"full"},y=this.globalize.parseDate(this.globalize.formatDate(d,f),f),C=this.dayCell(d),v=this.globalize.formatDate(d,{type:"date",skeleton:Object(s.W)()?"D":"full"}),w=this.createElement("span");w.textContent=this.globalize.formatDate(d,{format:"d",type:"date",skeleton:Object(s.W)()?"d":"yMd"});let S=this.min>d||this.max<d;S?(Object(s.v)([C],c),Object(s.v)([C],p)):w.setAttribute("title",""+v),g!==d.getMonth()&&Object(s.v)([C],h),0!==d.getDay()&&6!==d.getDay()||Object(s.v)([C],"e-weekend"),C.appendChild(w),this.renderDayCellArgs={date:d,isDisabled:!1,element:C,isOutOfRange:S};let O=this.renderDayCellArgs;if(this.renderDayCellEvent(O),O.isDisabled){let e=new Date(this.checkValue(t)),n=new Date(this.checkValue(O.date));if(i){if(!Object(s.X)(r)&&r.length>0)for(let e=0;e<r.length;e++)+new Date(this.globalize.formatDate(O.date,{type:"date",skeleton:Object(s.W)()?"d":"yMd"}))==+new Date(this.globalize.formatDate(r[e],{type:"date",skeleton:Object(s.W)()?"d":"yMd"}))&&(r.splice(e,1),e=-1)}else e&&+e==+n&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!C.classList.contains(u)&&(Object(s.v)([C],c),Object(s.v)([C],p),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));let x=C.classList.contains(h),j=C.classList.contains(c);if(j||s.l.add(C,"click",this.clickHandler,this),!i||Object(s.X)(r)||j)!j&&this.getDateVal(d,t)?Object(s.v)([C],u):this.updateFocus(x,j,d,C,e);else{for(let i=0;i<r.length;i++){let n="Gregorian"===this.calendarMode?"gregorian":"islamic",l={format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:n};this.globalize.formatDate(d,l)===this.globalize.formatDate(r[i],l)&&this.getDateVal(d,r[i])||this.getDateVal(d,t)?Object(s.v)([C],u):this.updateFocus(x,j,d,C,e)}r.length<=0&&this.updateFocus(x,j,d,C,e)}y.getFullYear()===o.getFullYear()&&y.getMonth()===o.getMonth()&&y.getDate()===o.getDate()&&Object(s.v)([C],"e-today"),a.push(this.renderDayCellArgs.element),d=new Date(+l),this.addDay(d,1,null,this.max,this.min)}return a}updateFocus(e,t,i,r,n){n.getDate()!==i.getDate()||e||t?(n>=this.max&&parseInt(r.id,0)===+this.max&&!e&&!t&&Object(s.v)([r],g),n<=this.min&&parseInt(r.id,0)===+this.min&&!e&&!t&&Object(s.v)([r],g)):Object(s.v)([r],g)}renderYears(e,t){this.removeTableHeadElement();let i=[],r=Object(s.X)(t),n=new Date(this.checkValue(this.currentDate)),l=n.getMonth(),a=n.getFullYear(),o=n,h=o.getFullYear(),d=new Date(this.checkValue(this.min)).getFullYear(),p=new Date(this.checkValue(this.min)).getMonth(),m=new Date(this.checkValue(this.max)).getFullYear(),b=new Date(this.checkValue(this.max)).getMonth();o.setMonth(0),this.titleUpdate(this.currentDate,"months"),o.setDate(1);for(let f=0;f<12;++f){let e=this.dayCell(o),n=this.createElement("span"),y=t&&t.getMonth()===o.getMonth(),C=t&&t.getFullYear()===a&&y;n.textContent=this.toCapitalize(this.globalize.formatDate(o,{format:Object(s.W)()?"MMM":null,type:"dateTime",skeleton:"MMM"})),this.min&&(h<d||f<p&&h===d)||this.max&&(h>m||f>b&&h>=m)?Object(s.v)([e],c):!r&&C?Object(s.v)([e],u):o.getMonth()===l&&this.currentDate.getMonth()===l&&Object(s.v)([e],g),o.setDate(1),o.setMonth(o.getMonth()+1),e.classList.contains(c)||s.l.add(e,"click",this.clickHandler,this),e.appendChild(n),i.push(e)}this.renderTemplate(i,4,"e-year",e,t)}renderDecades(e,t){this.removeTableHeadElement();let i=[],r=new Date(this.checkValue(this.currentDate));r.setMonth(0),r.setDate(1);let n=r.getFullYear(),l=new Date(r.setFullYear(n-n%10)),a=new Date(r.setFullYear(n-n%10+9)),o=l.getFullYear(),h=a.getFullYear(),d=this.globalize.formatDate(l,{format:Object(s.W)()?"yyyy":null,type:"dateTime",skeleton:"y"}),p=this.globalize.formatDate(a,{format:Object(s.W)()?"yyyy":null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=d+" - "+p;let m=new Date(n-n%10-1,0,1).getFullYear();for(let b=0;b<12;++b){let e=m+b;r.setFullYear(e);let n=this.dayCell(r);Object(s.x)(n,{role:"gridcell"});let l=this.createElement("span");l.textContent=this.globalize.formatDate(r,{format:Object(s.W)()?"yyyy":null,type:"dateTime",skeleton:"y"}),e<o||e>h?(Object(s.v)([n],"e-other-year"),Object(s.X)(t)||r.getFullYear()!==t.getFullYear()||Object(s.v)([n],u),(e<new Date(this.checkValue(this.min)).getFullYear()||e>new Date(this.checkValue(this.max)).getFullYear())&&Object(s.v)([n],c)):e<new Date(this.checkValue(this.min)).getFullYear()||e>new Date(this.checkValue(this.max)).getFullYear()?Object(s.v)([n],c):Object(s.X)(t)||r.getFullYear()!==t.getFullYear()?r.getFullYear()!==this.currentDate.getFullYear()||n.classList.contains(c)||Object(s.v)([n],g):Object(s.v)([n],u),n.classList.contains(c)||s.l.add(n,"click",this.clickHandler,this),n.appendChild(l),i.push(n)}this.renderTemplate(i,4,"e-decade",e,t)}dayCell(e){let t="Gregorian"===this.calendarMode?"gregorian":"islamic",i={skeleton:Object(s.W)()?"F":"full",type:"dateTime",calendar:t},r=this.globalize.parseDate(this.globalize.formatDate(e,i),i).valueOf(),n={className:"e-cell",attrs:{id:""+Object(s.U)(""+r),"aria-selected":"false",role:"gridcell"}};return this.createElement("td",n)}firstDay(e){let t="Decade"!==this.currentView()?this.tableBodyElement.querySelectorAll("td:not(."+h):this.tableBodyElement.querySelectorAll("td:not(.e-other-year");if(t.length)for(let i=0;i<t.length;i++)if(!t[i].classList.contains(c)){e=new Date(parseInt(t[i].id,0));break}return e}lastDay(e,t){let i=new Date(e.getFullYear(),e.getMonth()+1,0);if(2!==t){let t=Math.abs(i.getTimezoneOffset()-this.firstDay(e).getTimezoneOffset());return t&&i.setHours(this.firstDay(e).getHours()+t/60),this.findLastDay(i)}return this.findLastDay(this.firstDay(i))}checkDateValue(e){return!Object(s.X)(e)&&e instanceof Date&&!isNaN(+e)?e:null}findLastDay(e){let t="Decade"===this.currentView()?this.tableBodyElement.querySelectorAll("td:not(.e-other-year"):this.tableBodyElement.querySelectorAll("td:not(."+h);if(t.length)for(let i=t.length-1;i>=0;i--)if(!t[i].classList.contains(c)){e=new Date(parseInt(t[i].id,0));break}return e}removeTableHeadElement(){"calendar"===this.getModuleName()?Object(s.X)(this.element.querySelectorAll(".e-content table thead")[0])||Object(s.I)(this.tableHeadElement):Object(s.X)(this.calendarElement.querySelectorAll(".e-content table thead")[0])||Object(s.I)(this.tableHeadElement)}renderTemplate(e,t,i,r,n){let l,a=this.getViewNumber(this.currentView());this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),Object(s.ib)([this.contentElement,this.headerElement],["e-month","e-decade","e-year"]),Object(s.v)([this.contentElement,this.headerElement],[i]);let o=t,d=0;for(let c=0;c<e.length/t;++c){for(l=this.createElement("tr",{attrs:{role:"row"}}),d=0+d;d<o;d++)e[d].classList.contains("e-week-number")||Object(s.X)(e[d].children[0])||(Object(s.v)([e[d].children[0]],["e-day"]),Object(s.kb)(e[d].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(e[d]),this.weekNumber&&7===d&&e[7].classList.contains(h)&&Object(s.v)([l],"e-month-hide"),!this.weekNumber&&6===d&&e[6].classList.contains(h)&&Object(s.v)([l],"e-month-hide"),this.weekNumber?41===d&&e[41].classList.contains(h)&&Object(s.v)([l],"e-month-hide"):35===d&&e[35].classList.contains(h)&&Object(s.v)([l],"e-month-hide");o+=t,d+=0,this.tableBodyElement.appendChild(l)}this.table.querySelector("tbody").className=this.effect,"Gregorian"===this.calendarMode?this.iconHandler():this.islamicModule.islamicIconHandler(),(a!==this.getViewNumber(this.currentView())||0===a&&a!==this.getViewNumber(this.currentView()))&&this.navigateHandler(r),this.setAriaActiveDescendant()}clickHandler(e,t){this.clickEventEmitter(e);let i=e.currentTarget,s=this.getViewNumber(this.currentView());i.classList.contains(h)?this.contentClick(e,0,null,t):s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)||2===s?this.contentClick(e,1,null,t):i.classList.contains(h)||0!==s?this.contentClick(e,0,i,t):this.selectDate(e,this.getIdValue(e,null),null),"calendar"===this.getModuleName()&&this.table.focus()}clickEventEmitter(e){e.preventDefault()}contentClick(e,t,i,r){let n=this.getViewNumber(this.currentView()),l=this.getIdValue(e,i);switch(t){case 0:n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(Object(s.I)(this.tableBodyElement),this.currentDate=l,this.effect="e-zoomin",this.renderMonths(e)):("Gregorian"===this.calendarMode?(this.currentDate.setMonth(l.getMonth()),l.getMonth()>0&&this.currentDate.getMonth()!==l.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(l.getFullYear())):this.currentDate=l,this.effect="e-zoomin",Object(s.I)(this.tableBodyElement),this.renderMonths(e));break;case 1:if(n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,l,null);else{if("Gregorian"===this.calendarMode)this.currentDate.setFullYear(l.getFullYear());else{let e=this.islamicModule.getIslamicDate(l);this.currentDate=this.islamicModule.toGregorian(e.year,e.month,1)}this.effect="e-zoomin",Object(s.I)(this.tableBodyElement),this.renderYears(e)}}}switchView(e,t,i,r){switch(e){case 0:Object(s.I)(this.tableBodyElement),this.renderMonths(t,null,r),i&&!Object(s.X)(this.tableBodyElement.querySelectorAll("."+g)[0])&&this.tableBodyElement.querySelectorAll("."+g)[0].classList.remove(g);break;case 1:Object(s.I)(this.tableBodyElement),this.renderYears(t);break;case 2:Object(s.I)(this.tableBodyElement),this.renderDecades(t)}}getModuleName(){return"calendar"}requiredModules(){let e=[];return this&&e.push({args:[this],member:"islamic"}),e}getPersistData(){return this.addOnPersist(["value"])}onPropertyChanged(e,t,i,r){this.effect="";for(let n of Object.keys(e))switch(n){case"enableRtl":e.enableRtl?"calendar"===this.getModuleName()?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):"calendar"===this.getModuleName()?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),this.setProperties("min"===n?{min:this.checkDateValue(new Date(this.checkValue(e.min)))}:{max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.setProperties({start:this.currentView()},!0),Object(s.I)(this.tableBodyElement),this.minMaxUpdate(),i&&this.validateValues(i,r),this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(Object(s.I)(this.todayElement),Object(s.I)(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(Object(s.ib)([this.todayElement],c),Object(s.I)(this.todayElement),Object(s.I)(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.createContentHeader(),this.createContentBody();break;case"locale":this.globalize=new s.n(this.locale),this.createContentHeader(),this.createContentBody(),this.l10.setLocale(this.locale),this.updateFooter();break;case"showTodayButton":e.showTodayButton?this.createContentFooter():Object(s.X)(this.todayElement)||Object(s.X)(this.footer)||(Object(s.I)(this.todayElement),Object(s.I)(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:e.showTodayButton},!0)}}validateValues(e,t){if(e&&!Object(s.X)(t)&&t.length>0){let e=this.copyValues(t);for(let t=0;t<e.length;t++){let i,r="Gregorian"===this.calendarMode?"gregorian":"islamic";i=this.globalize.formatDate(e[t],"Gregorian"===this.calendarMode?{type:"date",skeleton:Object(s.W)()?"d":"yMd"}:{type:"dateTime",skeleton:"full",calendar:"islamic"});let n={type:"date",skeleton:Object(s.W)()?"d":"yMd",calendar:r},l=this.globalize.formatDate(this.min,n),a={type:"date",skeleton:Object(s.W)()?"d":"yMd",calendar:r},o=this.globalize.formatDate(this.max,a);(+new Date(i)<+new Date(l)||+new Date(i)>+new Date(o))&&(e.splice(t,1),t=-1)}this.setProperties({values:e},!0)}}setValueUpdate(){Object(s.X)(this.tableBodyElement)||(Object(s.I)(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())}copyValues(e){let t=[];if(!Object(s.X)(e)&&e.length>0)for(let i=0;i<e.length;i++)t.push(new Date(+e[i]));return t}titleUpdate(e,t){let i,r,n=new s.n(this.locale),l="Gregorian"===this.calendarMode?"gregorian":"islamic";switch("Gregorian"===this.calendarMode?(i=n.formatDate(e,{type:"dateTime",skeleton:Object(s.W)()?"y":"yMMMM",calendar:l}),r=n.formatDate(e,{format:Object(s.W)()?"yyyy":null,type:"dateTime",skeleton:"y",calendar:l})):(i=n.formatDate(e,{type:"dateTime",format:"MMMM y",calendar:l}),r=n.formatDate(e,{type:"dateTime",format:"y",calendar:l})),t){case"days":this.headerTitleElement.textContent=this.toCapitalize(i);break;case"months":this.headerTitleElement.textContent=r}}setActiveDescendant(){let e,t,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n="Gregorian"===this.calendarMode?"gregorian":"islamic",l=this.currentView();return t=this.globalize.formatDate(this.currentDate,"Month"===l?{type:"date",skeleton:Object(s.W)()?"D":"full",calendar:n}:"Year"===l?"islamic"!==n?{type:"date",skeleton:Object(s.W)()?"y":"yMMMM",calendar:n}:{type:"date",skeleton:"GyMMM",calendar:n}:{format:Object(s.W)()?"yyyy":null,type:"date",skeleton:"y",calendar:n}),(r||i)&&(Object(s.X)(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",t),e=(i||r).getAttribute("id")),e}iconHandler(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}}destroy(){("calendar"===this.getModuleName()||this.calendarElement)&&Object(s.ib)([this.element],[d]),"calendar"===this.getModuleName()&&(s.l.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&s.l.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),Object(s.X)(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element.innerHTML="",super.destroy()}title(e){let t=this.getViewNumber(this.currentView());this.effect="e-zoomin",this.switchView(++t,e)}getViewNumber(e){return"Month"===e?0:"Year"===e?1:2}navigateTitle(e){e.preventDefault(),this.title(e),"calendar"===this.getModuleName()&&this.table.focus()}previous(){this.effect="";let e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(e)}}navigatePrevious(e){e.preventDefault(),"Gregorian"===this.calendarMode?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e),"calendar"===this.getModuleName()&&this.table.focus()}next(){this.effect="";let e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(e)}}navigateNext(e){e.preventDefault(),"Gregorian"===this.calendarMode?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(e),"calendar"===this.getModuleName()&&this.table.focus()}navigateTo(e,t,i){+t>=+this.min&&+t<=+this.max&&(this.currentDate=t),+t<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+t>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(e)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(e))&&(e=this.depth),this.switchView(this.getViewNumber(e),null,null,i)}currentView(){return this.contentElement.classList.contains("e-year")?"Year":this.contentElement.classList.contains("e-decade")?"Decade":"Month"}getDateVal(e,t){return!Object(s.X)(t)&&e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}getCultureObjects(e,t){let i=(Object(s.W)()?".dates.days.":".dates.calendars.gregorian.days.format.")+this.dayHeaderFormat.toLowerCase(),r=(Object(s.W)()?".dates.days.":".dates.calendars.islamic.days.format.")+this.dayHeaderFormat.toLowerCase(),n=Object(s.W)()?"":"main.";return"Gregorian"===this.calendarMode?Object(s.V)(n+""+this.locale+i,e):Object(s.V)("main."+this.locale+r,e)}getWeek(e){let t=new Date(this.checkValue(e)).valueOf(),i=new Date(e.getFullYear(),0,1).valueOf();return Math.ceil((t-i+864e5)/864e5/7)}setStartDate(e,t){let i=e.getTimezoneOffset(),s=new Date(e.getTime()+t),r=s.getTimezoneOffset()-i;e.setTime(s.getTime()+6e4*r)}addMonths(e,t){if("Gregorian"===this.calendarMode){let i=e.getDate();e.setDate(1),e.setMonth(e.getMonth()+t),e.setDate(Math.min(i,this.getMaxDays(e)))}else{let i=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(i.year,i.month+t,1)}}addYears(e,t){if("Gregorian"===this.calendarMode){let i=e.getDate();e.setDate(1),e.setFullYear(e.getFullYear()+t),e.setDate(Math.min(i,this.getMaxDays(e)))}else{let i=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(i.year+t,i.month,1)}}getIdValue(e,t){let i;i=e?e.currentTarget:t;let r="Gregorian"===this.calendarMode?"gregorian":"islamic",n={type:"dateTime",skeleton:Object(s.W)()?"F":"full",calendar:r},l=this.globalize.formatDate(new Date(parseInt(""+i.getAttribute("id"),0)),n),a=this.globalize.parseDate(l,n),o=a.valueOf()-a.valueOf()%1e3;return new Date(o)}adjustLongHeaderSize(){Object(s.ib)([this.element],"e-calendar-day-header-lg"),"Wide"===this.dayHeaderFormat&&Object(s.v)(["calendar"===this.getModuleName()?this.element:this.calendarElement],"e-calendar-day-header-lg")}selectDate(e,t,i,r,n){let l=i||e.currentTarget;if(this.isDateSelected=!1,"Decade"===this.currentView())this.setDateDecade(this.currentDate,t.getFullYear());else if("Year"===this.currentView())this.setDateYear(this.currentDate,t);else{if(r&&!this.checkPresentDate(t,n)){let e=this.copyValues(n);!Object(s.X)(n)&&e.length>0?(e.push(new Date(this.checkValue(t))),this.setProperties({values:e},!0),this.setProperties({value:n[n.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(t))]},!0)}else this.setProperties({value:new Date(this.checkValue(t))},!0);this.currentDate=new Date(this.checkValue(t))}let a=Object(s.C)(l,"."+d);if(Object(s.X)(a)&&(a=this.tableBodyElement),r||Object(s.X)(a.querySelector("."+u))||Object(s.ib)([a.querySelector("."+u)],u),r||Object(s.X)(a.querySelector("."+g))||Object(s.ib)([a.querySelector("."+g)],g),r){let e=this.copyValues(n),i=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td"));for(let t=0;t<i.length;t++){let e=a.querySelectorAll("td."+g)[0],r=a.querySelectorAll("td."+u)[0];i[t]===e&&Object(s.ib)([i[t]],g),i[t]!==r||this.checkPresentDate(new Date(parseInt(r.getAttribute("id").split("_")[0],10)),n)||Object(s.ib)([i[t]],u)}if(l.classList.contains(u)){Object(s.ib)([l],u);for(let i=0;i<e.length;i++){let r="Gregorian"===this.calendarMode?"gregorian":"islamic",n={format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:r};if(this.globalize.formatDate(t,n)===this.globalize.formatDate(e[i],n)){let t=e.indexOf(e[i]);e.splice(t,1),Object(s.v)([l],g)}}this.setProperties({values:e},!0)}else Object(s.v)([l],u)}else Object(s.v)([l],u);this.isDateSelected=!0}getFromatStringValue(){return Object(s.W)()?"M"+Object(s.N)().dateSeperator+"d"+Object(s.N)().dateSeperator+"yy":null}checkPresentDate(e,t){let i=!1;if(!Object(s.X)(t))for(let s=0;s<t.length;s++){let r="Gregorian"===this.calendarMode?"gregorian":"islamic";this.globalize.formatDate(e,{format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:r})===this.globalize.formatDate(t[s],{format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:r})&&(i=!0)}return i}setAriaActiveDescendant(){Object(s.x)(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})}previousIconHandler(e){e?(s.l.remove(this.previousIcon,"click",this.navigatePreviousHandler),Object(s.v)([this.previousIcon],""+c),Object(s.v)([this.previousIcon],""+p),this.previousIcon.setAttribute("aria-disabled","true")):(s.l.add(this.previousIcon,"click",this.navigatePreviousHandler),Object(s.ib)([this.previousIcon],""+c),Object(s.ib)([this.previousIcon],""+p),this.previousIcon.setAttribute("aria-disabled","false"))}renderDayCellEvent(e){Object(s.K)(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)}navigatedEvent(e){Object(s.K)(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)}triggerNavigate(e){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(e)}nextIconHandler(e){e?(s.l.remove(this.nextIcon,"click",this.navigateNextHandler),Object(s.v)([this.nextIcon],c),Object(s.v)([this.nextIcon],p),this.nextIcon.setAttribute("aria-disabled","true")):(s.l.add(this.nextIcon,"click",this.navigateNextHandler),Object(s.ib)([this.nextIcon],c),Object(s.ib)([this.nextIcon],p),this.nextIcon.setAttribute("aria-disabled","false"))}compare(e,t,i){let s,r,n=t.getFullYear();return s=n,r=0,i&&(n-=n%i,s=n-n%i+i-1),e.getFullYear()>s?r=1:e.getFullYear()<n&&(r=-1),r}isMinMaxRange(e){return+e>=+this.min&&+e<=+this.max}isMonthYearRange(e){if("Gregorian"===this.calendarMode)return e.getMonth()>=this.min.getMonth()&&e.getFullYear()>=this.min.getFullYear()&&e.getMonth()<=this.max.getMonth()&&e.getFullYear()<=this.max.getFullYear();{let t=this.islamicModule.getIslamicDate(e);return t.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&t.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&t.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&t.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year}}compareYear(e,t){return this.compare(e,t,0)}compareDecade(e,t){return this.compare(e,t,10)}shiftArray(e,t){return e.slice(t).concat(e.slice(0,t))}addDay(e,t,i,r,n){let l=t,a=new Date(+e);if(!Object(s.X)(this.tableBodyElement)&&!Object(s.X)(i)){for(;this.findNextTD(new Date(+e),l,r,n);)l+=t;let i=new Date(a.setDate(a.getDate()+l));l=+i>+r||+i<+n?l===t?t-t:t:l}e.setDate(e.getDate()+l)}findNextTD(e,t,i,r){let n=new Date(e.setDate(e.getDate()+t)),l=[],a=!1;if((!Object(s.X)(n)&&n.getMonth())===(!Object(s.X)(this.currentDate)&&this.currentDate.getMonth())){let e;e="Gregorian"===this.calendarMode?this.renderDays(n):this.islamicModule.islamicRenderDays(this.currentDate,n),l=e.filter(e=>e.classList.contains(c))}else l=this.tableBodyElement.querySelectorAll("td."+c);if(+n<=+i&&+n>=+r&&l.length)for(let s=0;s<l.length&&(a=+n==+new Date(parseInt(l[s].id,0)),!a);s++);return a}getMaxDays(e){let t,i,s=new Date(this.checkValue(e));for(t=28,i=s.getMonth();s.getMonth()===i;)++t,s.setDate(t);return t-1}setDateDecade(e,t){e.setFullYear(t),this.setProperties({value:new Date(this.checkValue(e))},!0)}setDateYear(e,t){e.setFullYear(t.getFullYear(),t.getMonth(),e.getDate()),t.getMonth()!==e.getMonth()&&(e.setDate(0),this.currentDate=new Date(this.checkValue(t))),this.setProperties({value:new Date(this.checkValue(e))},!0)}compareMonth(e,t){let i;return i=e.getFullYear()>t.getFullYear()?1:e.getFullYear()<t.getFullYear()?-1:e.getMonth()===t.getMonth()?0:e.getMonth()>t.getMonth()?1:-1,i}checkValue(e){return e instanceof Date?e.toUTCString():""+e}checkView(){"Decade"!==this.start&&"Year"!==this.start&&this.setProperties({start:"Month"},!0),"Decade"!==this.depth&&"Year"!==this.depth&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)}};return o([Object(s.s)(new Date(1900,0,1))],e.prototype,"min",void 0),o([Object(s.s)(new Date(2099,11,31))],e.prototype,"max",void 0),o([Object(s.s)(null)],e.prototype,"firstDayOfWeek",void 0),o([Object(s.s)("Gregorian")],e.prototype,"calendarMode",void 0),o([Object(s.s)("Month")],e.prototype,"start",void 0),o([Object(s.s)("Month")],e.prototype,"depth",void 0),o([Object(s.s)(!1)],e.prototype,"weekNumber",void 0),o([Object(s.s)("FirstDay")],e.prototype,"weekRule",void 0),o([Object(s.s)(!0)],e.prototype,"showTodayButton",void 0),o([Object(s.s)("Short")],e.prototype,"dayHeaderFormat",void 0),o([Object(s.s)(!1)],e.prototype,"enablePersistence",void 0),o([Object(s.s)(null)],e.prototype,"keyConfigs",void 0),o([Object(s.s)(null)],e.prototype,"serverTimezoneOffset",void 0),o([Object(s.k)()],e.prototype,"created",void 0),o([Object(s.k)()],e.prototype,"destroyed",void 0),o([Object(s.k)()],e.prototype,"navigated",void 0),o([Object(s.k)()],e.prototype,"renderDayCell",void 0),e=o([s.q],e),e})(),b=(()=>{let e=class extends m{constructor(e,t){super(e,t)}render(){if("Islamic"===this.calendarMode&&void 0===this.islamicModule&&Object(s.rb)("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&"object"==typeof this.values&&!Object(s.X)(this.values)&&this.values.length>0){let e=[],t=[];for(let i=0;i<this.values.length;i++)-1===e.indexOf(+this.values[i])&&(e.push(+this.values[i]),t.push(this.values[i]));this.setProperties({values:t},!0);for(let i=0;i<this.values.length;i++)if(!this.checkDateValue(this.values[i]))if("string"==typeof this.values[i]&&this.checkDateValue(new Date(this.checkValue(this.values[i])))){let e=new Date(this.checkValue(this.values[i]));this.values.splice(i,1),this.values.splice(i,0,e)}else this.values.splice(i,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),super.render(),"calendar"===this.getModuleName()){let e=Object(s.C)(this.element,"form");e&&s.l.add(e,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()}isDayLightSaving(){let e=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),t=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(t,e)}setTimeZone(e){if(!Object(s.X)(this.serverTimezoneOffset)&&this.value){let t=e+(new Date).getTimezoneOffset()/60;t=this.isDayLightSaving()?t--:t,this.value=new Date(this.value.getTime()+60*t*60*1e3)}}formResetHandler(){this.setProperties({value:null},!0)}validateDate(){"string"==typeof this.value&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),super.validateDate(this.value),!Object(s.X)(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)}minMaxUpdate(){"calendar"===this.getModuleName()&&(!Object(s.X)(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!Object(s.X)(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),"calendar"===this.getModuleName()||Object(s.X)(this.value)?super.minMaxUpdate(this.value):!Object(s.X)(this.value)&&this.value<this.min&&this.min<=this.max?super.minMaxUpdate(this.min):!Object(s.X)(this.value)&&this.value>this.max&&this.min<=this.max&&super.minMaxUpdate(this.max)}generateTodayVal(e){let t=new Date;return e?(t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds()),t.setMilliseconds(e.getMilliseconds())):t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),t}todayButtonClick(e){if(this.showTodayButton){let t=this.generateTodayVal(this.value);if(this.setProperties({value:t},!0),this.isTodayClicked=!0,this.todayButtonEvent=e,this.isMultiSelection){let e=this.copyValues(this.values);super.checkPresentDate(t,this.values)||(e.push(t),this.setProperties({values:e}))}super.todayButtonClick(e,new Date(+this.value))}}keyActionHandle(e){super.keyActionHandle(e,this.value,this.isMultiSelection)}preRender(){this.changeHandler=e=>{this.triggerChange(e)},this.checkView(),super.preRender(this.value)}createContent(){this.previousDate=this.value,this.previousDateTime=this.value,super.createContent()}minMaxDate(e){return super.minMaxDate(e)}renderMonths(e,t,i){super.renderMonths(e,this.value,i)}renderDays(e,t,i,s,r){let n=super.renderDays(e,this.value,this.isMultiSelection,this.values,r);return this.isMultiSelection&&super.validateValues(this.isMultiSelection,this.values),n}renderYears(e){"Gregorian"===this.calendarMode?super.renderYears(e,this.value):this.islamicModule.islamicRenderYears(e,this.value)}renderDecades(e){"Gregorian"===this.calendarMode?super.renderDecades(e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)}renderTemplate(e,t,i,s){"Gregorian"===this.calendarMode?super.renderTemplate(e,t,i,s,this.value):this.islamicModule.islamicRenderTemplate(e,t,i,s,this.value),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}clickHandler(e){let t=e.currentTarget;if(this.isPopupClicked=!0,t.classList.contains(h))if(this.isMultiSelection){let t=this.copyValues(this.values);t.push(this.getIdValue(e,null)),this.setProperties({values:t},!0),this.setProperties({value:this.values[this.values.length-1]},!0)}else this.setProperties({value:this.getIdValue(e,null)},!0);let i=this.currentView();super.clickHandler(e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!Object(s.X)(this.tableBodyElement.querySelectorAll("."+g)[0])&&"Year"===i&&this.tableBodyElement.querySelectorAll("."+g)[0].classList.remove(g)}switchView(e,t,i,s){super.switchView(e,t,this.isMultiSelection,s)}getModuleName(){return super.getModuleName(),"calendar"}getPersistData(){return super.getPersistData(),this.addOnPersist(["value","values"])}onPropertyChanged(e,t){this.effect="",this.rangeValidation(this.min,this.max);for(let i of Object.keys(e))switch(i){case"value":this.isDateSelected&&("string"==typeof e.value?this.setProperties({value:new Date(this.checkValue(e.value))},!0):e.value=new Date(this.checkValue(e.value)),isNaN(+this.value)&&this.setProperties({value:t.value},!0),this.update());break;case"values":if(this.isDateSelected){if("string"==typeof e.values||"number"==typeof e.values)this.setProperties({values:null},!0);else{let t=this.copyValues(this.values);for(let e=0;e<t.length;e++){let i=t[e];this.checkDateValue(i)&&!super.checkPresentDate(i,t)&&t.push(i)}this.setProperties({values:t},!0),this.values.length>0&&this.setProperties({value:e.values[e.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:e.isMultiSelection},!0),this.update());break;default:super.onPropertyChanged(e,t,this.isMultiSelection,this.values)}}destroy(){if(super.destroy(),"calendar"===this.getModuleName()){let e=Object(s.C)(this.element,"form");e&&s.l.remove(e,"reset",this.formResetHandler.bind(this))}}navigateTo(e,t,i){this.minMaxUpdate(),super.navigateTo(e,t,i)}currentView(){return super.currentView()}addDate(e){if("string"!=typeof e&&"number"!=typeof e){let t=this.copyValues(this.values);if("object"==typeof e&&e.length>0){let i=e;for(let e=0;e<i.length;e++)this.checkDateValue(i[e])&&!super.checkPresentDate(i[e],t)&&(!Object(s.X)(t)&&t.length>0?t.push(i[e]):t=[new Date(+i[e])])}else this.checkDateValue(e)&&!super.checkPresentDate(e,t)&&(!Object(s.X)(t)&&t.length>0?t.push(e):t=[new Date(+e)]);this.setProperties({values:t},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,t),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}removeDate(e){if("string"!=typeof e&&"number"!=typeof e&&!Object(s.X)(this.values)&&this.values.length>0){let t=this.copyValues(this.values);if("object"==typeof e&&e.length>0){let i=e;for(let e=0;e<i.length;e++)for(let s=0;s<t.length;s++)+t[s]==+i[e]&&t.splice(s,1)}else for(let i=0;i<t.length;i++)+t[i]==+e&&t.splice(i,1);this.setProperties({values:t},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}setTodayDate(e){let t=new Date(+e);this.setProperties({value:t},!0),super.todayButtonClick(null,t,!0)}update(){this.validateDate(),this.minMaxUpdate(),super.setValueUpdate()}selectDate(e,t,i){super.selectDate(e,t,i,this.isMultiSelection,this.values),this.isMultiSelection&&!Object(s.X)(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)}changeEvent(e){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))}triggerChange(e){!Object(s.X)(this.todayButtonEvent)&&this.isTodayClicked&&(e=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=e||null,this.changedArgs.isInteracted=!Object(s.X)(e),Object(s.X)(this.value)||this.setProperties({value:this.value},!0),this.isMultiSelection||+this.value===Number.NaN||+this.value==+this.previousDate&&(null!=this.previousDate||isNaN(+this.value))?Object(s.X)(this.values)||this.previousValues===this.values.length||(this.changeEvent(e),this.previousValues=this.values.length):this.changeEvent(e)}};return o([Object(s.s)(null)],e.prototype,"value",void 0),o([Object(s.s)(null)],e.prototype,"values",void 0),o([Object(s.s)(!1)],e.prototype,"isMultiSelection",void 0),o([Object(s.k)()],e.prototype,"change",void 0),e=o([s.q],e),e})();class f{constructor(e){this.calendarInstance=e}getModuleName(){return"islamic"}islamicTitleUpdate(e,t){let i=new s.n(this.calendarInstance.locale);switch(t){case"days":this.calendarInstance.headerTitleElement.textContent=i.formatDate(e,{type:"dateTime",format:"MMMMyyyy",calendar:"islamic"});break;case"months":this.calendarInstance.headerTitleElement.textContent=i.formatDate(e,{type:"dateTime",format:"yyyy",calendar:"islamic"})}}islamicRenderDays(e,t,i,r){let n,l=[],a=new Date(this.islamicInValue(e));this.islamicTitleUpdate(e,"days");let o=this.getIslamicDate(a),h=this.toGregorian(o.year,o.month,1),d=o.month;for(a=h;a.getDay()!==this.calendarInstance.firstDayOfWeek;)this.calendarInstance.setStartDate(a,-864e5);for(let c=0;c<42;++c){let i=this.calendarInstance.createElement("td",{className:"e-cell"}),o=this.calendarInstance.createElement("span");c%7==0&&this.calendarInstance.weekNumber&&(o.textContent=""+this.calendarInstance.getWeek(a),i.appendChild(o),Object(s.v)([i],"e-week-number"),l.push(i)),n=new Date(+a),a=this.calendarInstance.minMaxDate(a);let h={type:"dateTime",skeleton:"full",calendar:"islamic"},p=this.calendarInstance.globalize.parseDate(this.calendarInstance.globalize.formatDate(a,h),h),u=this.islamicDayCell(a),g=this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"full",calendar:"islamic"}),m=this.calendarInstance.createElement("span");m.textContent=this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"d",calendar:"islamic"});let b=this.calendarInstance.min>a||this.calendarInstance.max<a;b?(Object(s.v)([u],"e-disabled"),Object(s.v)([u],"e-overlay")):m.setAttribute("title",""+g),d!==this.getIslamicDate(a).month&&Object(s.v)([u],"e-other-month"),0!==a.getDay()&&6!==a.getDay()||Object(s.v)([u],"e-weekend"),u.appendChild(m),this.calendarInstance.renderDayCellArgs={date:a,isDisabled:!1,element:u,isOutOfRange:b};let f=this.calendarInstance.renderDayCellArgs;if(this.calendarInstance.renderDayCellEvent(f),f.isDisabled)if(this.calendarInstance.isMultiSelection){if(!Object(s.X)(this.calendarInstance.values)&&this.calendarInstance.values.length>0)for(let e=0;e<r.length;e++)+new Date(this.calendarInstance.globalize.formatDate(f.date,{type:"date",skeleton:"yMd",calendar:"islamic"}))==+new Date(this.calendarInstance.globalize.formatDate(this.calendarInstance.values[e],{type:"date",skeleton:"yMd",calendar:"islamic"}))&&(this.calendarInstance.values.splice(e,1),e=-1)}else t&&+t==+f.date&&this.calendarInstance.setProperties({value:null},!0);this.calendarInstance.renderDayCellArgs.isDisabled&&!u.classList.contains("e-selected")&&(Object(s.v)([u],"e-disabled"),Object(s.v)([u],"e-overlay"),+this.calendarInstance.renderDayCellArgs.date==+this.calendarInstance.todayDate&&(this.calendarInstance.todayDisabled=!0));let y=u.classList.contains("e-other-month"),C=u.classList.contains("e-disabled");if(C||s.l.add(u,"click",this.calendarInstance.clickHandler,this.calendarInstance),!this.calendarInstance.isMultiSelection||Object(s.X)(this.calendarInstance.values)||y||C)y||C||!this.calendarInstance.getDateVal(a,t)?this.calendarInstance.updateFocus(y,C,a,u,e):Object(s.v)([u],"e-selected");else{for(let t=0;t<this.calendarInstance.values.length;t++)this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"short",calendar:"islamic"})===this.calendarInstance.globalize.formatDate(this.calendarInstance.values[t],{type:"date",skeleton:"short",calendar:"islamic"})&&this.calendarInstance.getDateVal(a,this.calendarInstance.values[t])?Object(s.v)([u],"e-selected"):this.calendarInstance.updateFocus(y,C,a,u,e);this.calendarInstance.values.length<=0&&this.calendarInstance.updateFocus(y,C,a,u,e)}p.getDate()===(new Date).getDate()&&p.getMonth()===(new Date).getMonth()&&p.getFullYear()===(new Date).getFullYear()&&Object(s.v)([u],"e-today"),a=new Date(+n),l.push(this.calendarInstance.renderDayCellArgs.element),this.calendarInstance.addDay(a,1,null,this.calendarInstance.max,this.calendarInstance.min)}return l}islamicIconHandler(){new Date(this.islamicInValue(this.calendarInstance.currentDate)).setDate(1);let e=new Date(this.islamicInValue(this.calendarInstance.currentDate));switch(this.calendarInstance.currentView()){case"Month":let t=this.islamicCompareMonth(e,this.calendarInstance.min)<1,i=this.islamicCompareMonth(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(t),this.calendarInstance.nextIconHandler(i);break;case"Year":let s=this.hijriCompareYear(e,this.calendarInstance.min)<1,r=this.hijriCompareYear(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(s),this.calendarInstance.nextIconHandler(r);break;case"Decade":let n=this.hijriCompareDecade(e,this.calendarInstance.min)<1,l=this.hijriCompareDecade(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(n),this.calendarInstance.nextIconHandler(l)}}islamicNext(){this.calendarInstance.effect="";let e=this.calendarInstance.getViewNumber(this.calendarInstance.currentView()),t=this.getIslamicDate(this.calendarInstance.currentDate);switch(this.calendarInstance.currentView()){case"Year":this.calendarInstance.currentDate=this.toGregorian(t.year+1,t.month,1),this.calendarInstance.switchView(e);break;case"Month":this.calendarInstance.currentDate=this.toGregorian(t.year,t.month+1,1),this.calendarInstance.switchView(e);break;case"Decade":this.calendarInstance.currentDate=this.toGregorian(t.year+10,t.month,1),this.calendarInstance.switchView(e)}}islamicPrevious(){let e=this.calendarInstance.getViewNumber(this.calendarInstance.currentView());this.calendarInstance.effect="";let t=this.getIslamicDate(this.calendarInstance.currentDate);switch(this.calendarInstance.currentView()){case"Month":this.calendarInstance.currentDate=this.toGregorian(t.year,t.month-1,1),this.calendarInstance.switchView(e);break;case"Year":this.calendarInstance.currentDate=this.toGregorian(t.year-1,t.month,1),this.calendarInstance.switchView(e);break;case"Decade":this.calendarInstance.currentDate=this.toGregorian(t.year-10,t.month-1,1),this.calendarInstance.switchView(e)}}islamicRenderYears(e,t){this.calendarInstance.removeTableHeadElement();let i=[],r=Object(s.X)(t),n=new Date(this.islamicInValue(this.calendarInstance.currentDate)),l=this.getIslamicDate(n);n=s.m.toGregorian(l.year,1,1);let a=l.month,o=l.year,h=l.year,d=this.getIslamicDate(this.calendarInstance.min).year,c=this.getIslamicDate(this.calendarInstance.min).month,p=this.getIslamicDate(this.calendarInstance.max).year,u=this.getIslamicDate(this.calendarInstance.max).month;this.islamicTitleUpdate(this.calendarInstance.currentDate,"months");for(let g=1;g<=12;++g){let e=this.getIslamicDate(n);n=s.m.toGregorian(e.year,g,1);let l=this.islamicDayCell(n),m=this.calendarInstance.createElement("span"),b=t&&this.getIslamicDate(t).month===this.getIslamicDate(n).month,f=t&&this.getIslamicDate(t).year===o&&b;m.textContent=this.calendarInstance.globalize.formatDate(n,{type:"dateTime",format:"MMM",calendar:"islamic"}),this.calendarInstance.min&&(h<d||g<c&&h===d)||this.calendarInstance.max&&(h>p||g>u&&h>=p)?Object(s.v)([l],"e-disabled"):!r&&f?Object(s.v)([l],"e-selected"):this.getIslamicDate(n).month===a&&this.getIslamicDate(this.calendarInstance.currentDate).month===a&&Object(s.v)([l],"e-focused-date"),l.classList.contains("e-disabled")||s.l.add(l,"click",this.calendarInstance.clickHandler,this.calendarInstance),l.appendChild(m),i.push(l)}this.islamicRenderTemplate(i,4,"e-year",e,t)}islamicRenderDecade(e,t){this.calendarInstance.removeTableHeadElement();let i=[],r=new Date(this.islamicInValue(this.calendarInstance.currentDate)),n=this.getIslamicDate(r);r=s.m.toGregorian(n.year,1,1);let l=r.getFullYear(),a=new Date(this.islamicInValue(l-l%10)),o=new Date(this.islamicInValue(l-l%10+9)),h=a.getFullYear(),d=o.getFullYear(),c=this.calendarInstance.globalize.formatDate(a,{type:"dateTime",format:"y",calendar:"islamic"}),p=this.calendarInstance.globalize.formatDate(o,{type:"dateTime",format:"y",calendar:"islamic"});this.calendarInstance.headerTitleElement.textContent=c+" - "+p;let u=new Date(l-l%10-2,0,1).getFullYear();for(let g=1;g<=12;++g){let e=u+g;r.setFullYear(e),r.setDate(1),r.setMonth(0);let n=this.getIslamicDate(r);r=s.m.toGregorian(n.year,1,1);let l=this.islamicDayCell(r);Object(s.x)(l,{role:"gridcell"});let a=this.calendarInstance.createElement("span");a.textContent=this.calendarInstance.globalize.formatDate(r,{type:"dateTime",format:"y",calendar:"islamic"}),e<h||e>d?Object(s.v)([l],"e-other-month"):e<new Date(this.islamicInValue(this.calendarInstance.min)).getFullYear()||e>new Date(this.islamicInValue(this.calendarInstance.max)).getFullYear()?Object(s.v)([l],"e-disabled"):Object(s.X)(t)||this.getIslamicDate(r).year!==this.getIslamicDate(t).year?r.getFullYear()!==this.calendarInstance.currentDate.getFullYear()||l.classList.contains("e-disabled")||Object(s.v)([l],"e-focused-date"):Object(s.v)([l],"e-selected"),l.classList.contains("e-disabled")||s.l.add(l,"click",this.calendarInstance.clickHandler,this.calendarInstance),l.appendChild(a),i.push(l)}this.islamicRenderTemplate(i,4,"e-decade",e,t)}islamicDayCell(e){let t={skeleton:"full",type:"dateTime",calendar:"islamic"},i=this.calendarInstance.globalize.formatDate(e,t),r=this.calendarInstance.globalize.parseDate(i,t).valueOf(),n={className:"e-cell",attrs:{id:""+Object(s.U)(""+r),"aria-selected":"false",role:"gridcell"}};return this.calendarInstance.createElement("td",n)}islamicRenderTemplate(e,t,i,r,n){let l,a=this.calendarInstance.getViewNumber(this.calendarInstance.currentView());this.calendarInstance.tableBodyElement=this.calendarInstance.createElement("tbody"),this.calendarInstance.table.appendChild(this.calendarInstance.tableBodyElement),Object(s.ib)([this.calendarInstance.contentElement,this.calendarInstance.headerElement],["e-month","e-decade","e-year"]),Object(s.v)([this.calendarInstance.contentElement,this.calendarInstance.headerElement],[i]);let o=t,h=0;for(let d=0;d<e.length/t;++d){for(l=this.calendarInstance.createElement("tr",{attrs:{role:"row"}}),h=0+h;h<o;h++)e[h].classList.contains("e-week-number")||Object(s.X)(e[h].children[0])||(Object(s.v)([e[h].children[0]],["e-day"]),Object(s.kb)(e[h].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(e[h]),this.calendarInstance.weekNumber&&7===h&&e[7].classList.contains("e-other-month")&&Object(s.v)([l],"e-month-hide"),!this.calendarInstance.weekNumber&&6===h&&e[6].classList.contains("e-other-month")&&Object(s.v)([l],"e-month-hide"),this.calendarInstance.weekNumber?41===h&&e[41].classList.contains("e-other-month")&&Object(s.v)([l],"e-month-hide"):35===h&&e[35].classList.contains("e-other-month")&&Object(s.v)([l],"e-month-hide");o+=t,h+=0,this.calendarInstance.tableBodyElement.appendChild(l)}this.calendarInstance.table.querySelector("tbody").className=this.calendarInstance.effect,this.islamicIconHandler(),(a!==this.calendarInstance.getViewNumber(this.calendarInstance.currentView())||0===a&&a!==this.calendarInstance.getViewNumber(this.calendarInstance.currentView()))&&this.calendarInstance.navigateHandler(r),this.calendarInstance.setAriaActiveDescendant(),this.calendarInstance.changedArgs={value:this.calendarInstance.value,values:this.calendarInstance.values},this.calendarInstance.changeHandler()}islamicCompareMonth(e,t){let i,s=this.getIslamicDate(e),r=this.getIslamicDate(t);return i=s.year>r.year?1:s.year<r.year?-1:s.month===r.month?0:s.month>r.month?1:-1,i}islamicCompare(e,t,i){let s,r,n=this.getIslamicDate(e),l=this.getIslamicDate(t).year;return s=l,r=0,i&&(l-=l%i,s=l-l%i+i-1),n.year>s?r=1:("Decade"===this.calendarInstance.currentView()&&n.year<l&&!(e.getFullYear()>=2060&&e.getFullYear()<=2069)||n.year<l&&"Year"===this.calendarInstance.currentView())&&(r=-1),r}getIslamicDate(e){return s.m.getHijriDate(e)}toGregorian(e,t,i){return s.m.toGregorian(e,t,i)}hijriCompareYear(e,t){return this.islamicCompare(e,t,0)}hijriCompareDecade(e,t){return this.islamicCompare(e,t,10)}destroy(){this.calendarInstance=null}islamicInValue(e){return e instanceof Date?e.toUTCString():""+e}}var y=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};const C="e-datepicker",v=["title","class","style"];let w=(()=>{let e=class extends b{constructor(e,t){super(e,t),this.previousElementValue="",this.isDateIconClicked=!1,this.isAltKeyPressed=!1,this.isInteracted=!0,this.isBlazorServer=!1,this.invalidValueString=null,this.checkPreviousValue=null,this.isAngular=!1,this.preventChange=!1,this.isIconClicked=!1,this.datepickerOptions=e}render(){this.initialize(),this.bindEvents(),this.renderComplete(),this.isBlazorServer||this.setTimeZone(this.serverTimezoneOffset)}setTimeZone(e){if(!Object(s.X)(this.serverTimezoneOffset)&&this.value){let t=e+(new Date).getTimezoneOffset()/60;t=this.isDayLightSaving()?t--:t,this.value=new Date(this.value.getTime()+60*t*60*1e3),this.updateInput()}}isDayLightSaving(){let e=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),t=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(e,t)}setAllowEdit(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(s.x)(this.inputElement,{readonly:""}),this.updateIconState()}updateIconState(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):Object(s.v)([this.inputWrapper.container],["e-non-edit"])}initialize(){if(this.isBlazorServer){let e=this.element.parentElement;this.inputWrapper={container:e,clearButton:e.querySelector(".e-clear-icon"),buttons:[e.querySelector(".e-date-icon")]},n.c.bindInitialEvent({element:this.inputElement,floatLabelType:this.floatLabelType}),this.showClearButton&&this.inputWrapper.clearButton&&n.c.wireClearBtnEvents(this.inputElement,this.inputWrapper.clearButton,this.inputWrapper.container),this.setAllowEdit()}else this.checkInvalidValue(this.value),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.updateInput();this.previousElementValue=this.inputElement.value,this.previousDate=Object(s.X)(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value}createInput(){let e={"aria-live":"assertive","aria-atomic":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if("datepicker"===this.getModuleName()){let e={placeholder:this.placeholder};this.globalize=new s.n(this.locale),this.l10n=new s.p("datepicker",e,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}let t=this.cssClass;Object(s.X)(this.cssClass)||""===this.cssClass||(t=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=n.c.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:t,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:["e-input-group-icon e-date-icon e-icons"]},this.createElement),this.setWidth(this.width),this.inputElement.setAttribute("name",""!==this.inputElement.name?""+this.inputElement.getAttribute("name"):""+this.element.id),Object(s.x)(this.inputElement,e),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),n.c.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),Object(s.v)([this.inputWrapper.container],"e-date-wrapper")}updateInput(){let e;if(this.value&&!this.isCalendar()&&(this.isBlazorServer||this.disabledDates()),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(super.validateDate(),this.minMaxUpdates(),super.minMaxUpdate()),!Object(s.X)(this.value)){let t,i=this.value,r=Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString;if("datetimepicker"===this.getModuleName()?t=this.globalize.formatDate(this.value,"Gregorian"===this.calendarMode?{format:r,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(e="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.value,e)),+i<=+this.max&&+i>=+this.min)this.updateInputValue(t);else{let e=+i>=+this.max||!+this.value||!+this.value||+i<=+this.min;!this.strictMode&&e&&this.updateInputValue(t)}}Object(s.X)(this.value)&&this.strictMode&&this.updateInputValue(""),!this.strictMode&&Object(s.X)(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()}minMaxUpdates(){!Object(s.X)(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!Object(s.X)(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})}checkStringValue(e){let t=null,i=null,r=null;if("datetimepicker"===this.getModuleName()){let e=new s.n(this.locale);"Gregorian"===this.calendarMode?(i={format:this.dateTimeFormat,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"},r={format:e.getDatePattern({skeleton:Object(s.W)()?"d":"yMd"}),type:"dateTime"}):(i={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},r={format:e.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else i="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return t=this.checkDateValue(this.globalize.parseDate(e,i)),Object(s.X)(t)&&"datetimepicker"===this.getModuleName()&&(t=this.checkDateValue(this.globalize.parseDate(e,r))),t}checkInvalidValue(e){if(!(e instanceof Date||Object(s.X)(e))){let t=null,i=e;"number"==typeof e&&(i=e.toString());let r=null,n=null;if("datetimepicker"===this.getModuleName()){let e=new s.n(this.locale);"Gregorian"===this.calendarMode?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"},n={format:e.getDatePattern({skeleton:Object(s.W)()?"d":"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:e.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else r="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};let l=!1;if("string"!=typeof i)i=null,l=!0;else if("string"==typeof i&&(i=i.trim()),t=this.checkStringValue(i),!t){let e=null,s=null;e=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!e.test(i)&&!s.test(i)||/^[a-zA-Z0-9- ]*$/.test(i)||isNaN(+new Date(this.checkValue(i)))?l=!0:t=new Date(i)}l?(this.strictMode||(this.invalidValueString=i),this.setProperties({value:null},!0)):this.setProperties({value:t},!0)}}bindInputEvent(){Object(s.X)(this.formatString)||(-1===this.formatString.indexOf("y")?s.l.add(this.inputElement,"input",this.inputHandler,this):s.l.remove(this.inputElement,"input",this.inputHandler))}bindEvents(){s.l.add(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.dateIconHandler,this),s.l.add(this.inputElement,"focus",this.inputFocusHandler,this),s.l.add(this.inputElement,"blur",this.inputBlurHandler,this),this.bindInputEvent(),s.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&(this.inputWrapper.clearButton||this.isBlazorServer)&&s.l.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&s.l.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new s.o(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}unBindEvents(){s.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.dateIconHandler),s.l.remove(this.inputElement,"focus",this.inputFocusHandler),s.l.remove(this.inputElement,"blur",this.inputBlurHandler),s.l.remove(this.inputElement,"change",this.inputChangeHandler),this.showClearButton&&(this.inputWrapper.clearButton||this.isBlazorServer)&&s.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&s.l.remove(this.formElement,"reset",this.resetFormHandler)}resetFormHandler(){if(this.enabled&&!this.inputElement.disabled){let e=this.inputElement.getAttribute("value");"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(e="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.isBlazorServer||(this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(e),this.errorClass()))}}restoreValue(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=Object(s.X)(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"})}inputChangeHandler(e){this.enabled&&e.stopPropagation()}bindClearEvent(){this.showClearButton&&this.inputWrapper.clearButton&&s.l.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)}resetHandler(e){this.enabled&&(e.preventDefault(),this.clear(e))}clear(e){this.isBlazorServer||this.setProperties({value:null},!0),this.updateInputValue(""),this.trigger("cleared",{event:e}),this.invalidValueString="",this.isBlazorServer||(this.updateInput(),this.popupUpdate(),this.changeEvent(e)),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnValueCleared")}preventEventBubbling(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")}updateInputValue(e){n.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)}dateIconHandler(e){this.enabled&&(this.isIconClicked=!0,s.d.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),this.isBlazorServer||e.preventDefault(),this.readonly||(this.isCalendar()&&!this.isBlazorServer?this.hide(e):(!this.isBlazorServer||this.isBlazorServer&&this.inputWrapper.container.nextElementSibling)&&(this.isDateIconClicked=!0,this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus(),this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"]),Object(s.v)(this.inputWrapper.buttons,"e-active"))),this.isIconClicked=!1)}updateHtmlAttributeToWrapper(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))if(!Object(s.X)(this.htmlAttributes[e])&&v.indexOf(e)>-1)if("class"===e){let t=this.htmlAttributes[e].replace(/\s+/g," ").trim();""!==t&&Object(s.v)([this.inputWrapper.container],t.split(" "))}else if("style"===e){let t=this.inputWrapper.container.getAttribute(e);Object(s.X)(t)?t=this.htmlAttributes[e]:";"===t.charAt(t.length-1)?t+=this.htmlAttributes[e]:t=t+";"+this.htmlAttributes[e],this.inputWrapper.container.setAttribute(e,t)}else this.inputWrapper.container.setAttribute(e,this.htmlAttributes[e])}updateHtmlAttributeToElement(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))v.indexOf(e)<0&&this.inputElement.setAttribute(e,this.htmlAttributes[e])}updateCssClass(e,t){Object(s.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(s.X)(e)||(e=e.replace(/\s+/g," ").trim()),n.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&n.c.setCssClass(e,[this.popupWrapper],t)}CalendarKeyActionHandle(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value==+this.currentDate||this.isCalendar()||this.inputWrapper.container.children[this.index].focus():this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus();break;case"tab":this.hide(e)}}inputFocusHandler(){if(!this.enabled)return;let e={model:Object(s.W)()&&this.isServerRendered?null:this};this.isDateIconClicked=!1,this.trigger("focus",e),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}inputHandler(e){this.isPopupClicked=!1}inputBlurHandler(e){if(this.enabled){if(this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),""===this.inputElement.value&&Object(s.X)(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),"datepicker"===this.getModuleName()){let e={model:Object(s.W)()&&this.isServerRendered?null:this};this.trigger("blur",e)}this.isCalendar()&&(this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new s.o(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}}documentHandler(e){!Object(s.X)(this.popupObj)&&(this.inputWrapper.container.contains(e.target)||this.popupObj.element&&this.popupObj.element.contains(e.target))&&"touchstart"!==e.type&&e.preventDefault();let t=e.target;Object(s.C)(t,".e-datepicker.e-popup-wrapper")||Object(s.C)(t,".e-input-group")===this.inputWrapper.container||t.classList.contains("e-day")?Object(s.C)(t,".e-datepicker.e-popup-wrapper")&&(t.classList.contains("e-day")&&!Object(s.X)(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&Object(s.C)(t,".e-content")&&Object(s.C)(t,".e-content").classList.contains("e-"+this.depth.toLowerCase())||Object(s.C)(t,".e-footer-container")&&t.classList.contains("e-today")&&t.classList.contains("e-btn")&&+new Date(+this.value)==+super.generateTodayVal(this.value)&&!this.isBlazorServer)&&this.hide(e):(this.hide(e),this.focusOut())}inputKeyActionHandle(e){let t=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e)),"datepicker"===this.getModuleName()&&(this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnPopupHide",!0):this.show(null,e));break;case"escape":this.hide(e);break;case"enter":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.isCalendar()||document.activeElement!==this.inputElement||this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break;case"tab":case"shiftTab":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.hide(e);break;default:this.defaultAction(e),"select"===e.action&&t===this.depth&&this.hide(e)}}defaultAction(e){this.previousDate=!Object(s.X)(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(super.keyActionHandle(e),this.isBlazorServer||Object(s.x)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))}popupUpdate(){if((Object(s.X)(this.value)&&!Object(s.X)(this.previousDate)||+this.value!=+this.previousDate)&&(this.popupObj&&this.popupObj.element.querySelectorAll(".e-selected").length>0&&Object(s.ib)(this.popupObj.element.querySelectorAll(".e-selected"),["e-selected"]),!Object(s.X)(this.value)&&!this.isBlazorServer&&+this.value>=+this.min&&+this.value<=+this.max)){let e=new Date(this.checkValue(this.value));super.navigateTo("Month",e)}}strictModeUpdate(){let e,t,i,r;e="datetimepicker"===this.getModuleName()?Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString:Object(s.X)(this.formatString)?this.formatString:this.formatString.replace("dd","d"),Object(s.X)(e)||e.split("M").length-1<3&&(e=e.replace("MM","M")),"datetimepicker"===this.getModuleName()?i="Gregorian"===this.calendarMode?{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(t="Gregorian"===this.calendarMode?{format:e,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=t),"string"==typeof this.inputElement.value&&(this.inputElement.value=this.inputElement.value.trim()),"datetimepicker"===this.getModuleName()?this.checkDateValue(this.globalize.parseDate(this.inputElement.value,i))?r=this.globalize.parseDate(this.inputElement.value,i):(t="Gregorian"===this.calendarMode?{type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{type:"dateTime",skeleton:"yMd",calendar:"islamic"},r=this.globalize.parseDate(this.inputElement.value,t)):(r=this.globalize.parseDate(this.inputElement.value,i),!Object(s.X)(this.formatString)&&""!==this.inputElement.value&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&-1===this.formatString.indexOf("y")&&r.setFullYear(this.value.getFullYear())),"datepicker"===this.getModuleName()&&this.value&&!isNaN(+this.value)&&r&&r.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&r?(this.updateInputValue(this.globalize.formatDate(r,i)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:r},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:r},!0),this.strictMode&&!r&&""===this.inputElement.value&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),Object(s.X)(this.value)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)))}createCalendar(){this.isBlazorServer?(this.popupWrapper=this.inputWrapper.container.nextElementSibling,this.calendarElement=this.popupWrapper.firstElementChild,this.tableBodyElement=Object(s.lb)("tbody",this.calendarElement),this.contentElement=Object(s.lb)(".e-content",this.calendarElement)):(this.popupWrapper=this.createElement("div",{className:C+" e-popup-wrapper"}),Object(s.X)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass)),s.d.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=C+" e-date-modal",document.body.className+=" e-date-overflow",this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new r.c(this.popupWrapper,{content:this.isBlazorServer?null:this.calendarElement,relateTo:s.d.isDevice?document.body:this.inputWrapper.container,position:s.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:4,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:s.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:()=>{"datetimepicker"!==this.getModuleName()&&document.activeElement!==this.inputElement&&(this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs),this.calendarElement.children[1].firstElementChild.focus(),this.calendarKeyboardModules=new s.o(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}),this.calendarKeyboardModules=new s.o(this.inputWrapper.container.children[this.index],{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}))},close:()=>{this.isDateIconClicked&&this.inputWrapper.container.children[this.index].focus(),this.value&&!this.isBlazorServer&&this.disabledDates(),this.popupObj&&this.popupObj.destroy(),Object(s.I)(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.setAriaAttributes()},targetExitViewport:()=>{s.d.isDevice||this.hide()}}),this.isBlazorServer||(this.popupObj.element.className+=" "+this.cssClass),this.setAriaAttributes()}setAriaDisabled(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)}modelHeader(){let e,t=this.createElement("div",{className:"e-model-header"}),i=this.createElement("h1",{className:"e-model-year"}),s=this.createElement("div"),r=this.createElement("span",{className:"e-model-day"}),n=this.createElement("span",{className:"e-model-month"});e="Gregorian"===this.calendarMode?{format:"y",skeleton:"dateTime"}:{format:"y",skeleton:"dateTime",calendar:"islamic"},i.textContent=""+this.globalize.formatDate(this.value||new Date,e),e="Gregorian"===this.calendarMode?{format:"E",skeleton:"dateTime"}:{format:"E",skeleton:"dateTime",calendar:"islamic"},r.textContent=this.globalize.formatDate(this.value||new Date,e)+", ",e="Gregorian"===this.calendarMode?{format:"MMM d",skeleton:"dateTime"}:{format:"MMM d",skeleton:"dateTime",calendar:"islamic"},n.textContent=""+this.globalize.formatDate(this.value||new Date,e),t.appendChild(i),s.appendChild(r),s.appendChild(n),t.appendChild(s),this.calendarElement.insertBefore(t,this.calendarElement.firstElementChild)}changeTrigger(e){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.changedArgs.value=this.value,this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!Object(s.X)(e),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0)}navigatedEvent(){this.trigger("navigated",this.navigatedArgs)}changeEvent(e){(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.selectCalendar(e),this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.hide(e),this.previousElementValue=this.inputElement.value,this.errorClass())}requiredModules(){let e=[];return this&&e.push({args:[this],member:"islamic"}),e}selectCalendar(e){let t,i,r;i="datetimepicker"===this.getModuleName()&&Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,this.value&&("datetimepicker"===this.getModuleName()?(r="Gregorian"===this.calendarMode?{format:i,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:i,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.changedArgs.value,r)):(r="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.changedArgs.value,r))),Object(s.X)(t)||this.updateInputValue(t)}isCalendar(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-popup-wrapper"))}setWidth(e){this.inputWrapper.container.style.width="number"==typeof e?Object(s.L)(this.width):"string"==typeof e?e.match(/px|%|em/)?this.width:Object(s.L)(this.width):"100%"}show(e,t){if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){let e,i=!0;Object(s.X)(this.value)||+this.value>=+this.min&&+this.value<=+this.max?e=this.value||null:(e=new Date(this.checkValue(this.value)),this.isBlazorServer||this.setProperties({value:null},!0)),this.isCalendar()||(this.isBlazorServer||(super.render(),this.setProperties({value:e||null},!0)),this.previousDate=e,this.createCalendar()),s.d.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:()=>{i=!1},popup:Object(s.W)()&&this.isServerRendered?null:this.popupObj,event:t||null,cancel:!1,appendTo:s.d.isDevice?this.mobilePopupWrapper:document.body},this.trigger("open",this.preventArgs,e=>{this.preventArgs=e,i&&!this.preventArgs.cancel?(this.isBlazorServer&&(this.popupWrapper.style.visibility="",this.popupWrapper.style.width="auto",this.popupWrapper.style.height="auto"),Object(s.v)(this.inputWrapper.buttons,"e-active"),this.preventArgs.appendTo.appendChild(this.popupWrapper),this.popupObj.refreshPosition(this.inputElement),this.popupObj.show(new s.b({name:"FadeIn",duration:s.d.isDevice?0:300}),1e3===this.zIndex?this.element:null),this.isBlazorServer||super.setOverlayIndex(this.mobilePopupWrapper,this.popupObj.element,this.modal,s.d.isDevice),this.setAriaAttributes()):(this.popupObj.destroy(),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),this.popupWrapper=this.popupObj=null),Object(s.X)(this.inputElement)||""!==this.inputElement.value||!Object(s.X)(this.tableBodyElement)&&this.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(Object(s.v)([this.tableBodyElement.querySelector("td.e-selected")],"e-focused-date"),Object(s.ib)(this.tableBodyElement.querySelectorAll("td.e-selected"),"e-selected")),s.l.add(document,"mousedown touchstart",this.documentHandler,this)})}}hide(e){if(Object(s.X)(this.popupWrapper))s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{let t=!0;this.preventArgs={preventDefault:()=>{t=!1},popup:Object(s.W)()&&this.isServerRendered?null:this.popupObj,event:e||null,cancel:!1},Object(s.ib)(this.inputWrapper.buttons,"e-active"),Object(s.ib)([document.body],"e-date-overflow");let i=this.preventArgs;this.isCalendar()?this.trigger("close",i,e=>{this.closeEventCallback(t,e)}):this.closeEventCallback(t,i)}}closeEventCallback(e,t){this.preventArgs=t,this.isCalendar()&&e&&!this.preventArgs.cancel&&(this.isBlazorServer?(this.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),this.isAltKeyPressed=!1,this.popupWrapper=this.popupObj=null):(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy()),Object(s.ib)(this.inputWrapper.buttons,"e-active")),this.setAriaAttributes(),s.d.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),s.d.isDevice&&(Object(s.X)(this.mobilePopupWrapper)||(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null)),s.l.remove(document,"mousedown touchstart",this.documentHandler),s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}focusIn(e){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"]))}focusOut(){document.activeElement===this.inputElement&&(Object(s.ib)([this.inputWrapper.container],["e-input-focus"]),this.inputElement.blur())}currentView(){let e;return this.calendarElement&&(e=super.currentView()),e}navigateTo(e,t){this.calendarElement&&super.navigateTo(e,t)}destroy(){this.unBindEvents(),this.isBlazorServer||(super.destroy(),this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains("e-popup")&&super.destroy()),this.inputElement&&(n.c.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-disabled":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},this.inputElement),Object(s.X)(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),s.l.remove(this.inputElement,"blur",this.inputBlurHandler),s.l.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&Object(s.I)(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.isBlazorServer||this.keyboardModule.destroy()),null===this.ngTag&&(this.inputElement&&(this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),Object(s.ib)([this.inputElement],["e-input"])),Object(s.ib)([this.element],[C]),Object(s.I)(this.inputWrapper.container)),this.formElement&&s.l.remove(this.formElement,"reset",this.resetFormHandler)}ensureInputAttribute(){let e=[];for(let t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(let t=0;t<e.length;t++)Object(s.X)(this.inputElementCopy.getAttribute(e[t]))?("value"===e[t].toLowerCase()&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[t])):("value"===e[t].toLowerCase()&&(this.inputElement.value=this.inputElementCopy.getAttribute(e[t])),this.inputElement.setAttribute(e[t],this.inputElementCopy.getAttribute(e[t])))}preRender(){this.inputElementCopy=this.element.cloneNode(!0),Object(s.ib)([this.inputElementCopy],[C,"e-control","e-lib"]),this.inputElement=this.element,this.formElement=Object(s.C)(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.isBlazorServer=!(!Object(s.W)()||!this.isServerRendered||"datepicker"!==this.getModuleName()),this.isBlazorServer||(this.ngTag=null,"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?null!==this.ngTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):"datetimepicker"===this.getModuleName()?(this.element.id=Object(s.U)("ej2-datetimepicker"),null!==this.ngTag&&Object(s.x)(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=Object(s.U)("ej2-datepicker"),null!==this.ngTag&&Object(s.x)(this.inputElement,{id:this.element.id+"_input"})),null!==this.ngTag&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement()),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.isBlazorServer||(this.element.removeAttribute("tabindex"),super.preRender())}getDefaultKeyConfig(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs}validationAttribute(e,t){let i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");let r=["required","aria-required","form"];for(let n=0;n<r.length;n++){if(Object(s.X)(e.getAttribute(r[n])))continue;let i=e.getAttribute(r[n]);t.setAttribute(r[n],i),e.removeAttribute(r[n])}}checkFormat(){let e=new s.n(this.locale);if(this.format)if("string"==typeof this.format)this.formatString=Object(s.W)()?this.format.replace(/tt/,"a"):this.format;else if(""===this.format.skeleton||Object(s.X)(this.format.skeleton))this.formatString="datetimepicker"===this.getModuleName()?this.dateTimeFormat:null;else{let t=this.format.skeleton;this.formatString="datetimepicker"===this.getModuleName()?e.getDatePattern({skeleton:t,type:"dateTime"}):e.getDatePattern({skeleton:t,type:"date"})}else this.formatString=null}checkHtmlAttributes(e){this.globalize=new s.n(this.locale),this.checkFormat(),this.checkView();let t,i=e?Object(s.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"];t="datetimepicker"===this.getModuleName()?"Gregorian"===this.calendarMode?{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:"Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(let r of i)if(!Object(s.X)(this.inputElement.getAttribute(r)))switch(r){case"disabled":if((Object(s.X)(this.datepickerOptions)||void 0===this.datepickerOptions.enabled||e)&&!this.isBlazorServer){let t="disabled"!==this.inputElement.getAttribute(r)&&""!==this.inputElement.getAttribute(r)&&"true"!==this.inputElement.getAttribute(r);this.setProperties({enabled:t},!e)}break;case"readonly":if((Object(s.X)(this.datepickerOptions)||void 0===this.datepickerOptions.readonly||e)&&!this.isBlazorServer){let t="readonly"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({readonly:t},!e)}break;case"placeholder":!Object(s.X)(this.datepickerOptions)&&void 0!==this.datepickerOptions.placeholder&&!e||this.isBlazorServer||(this.inputElement.getAttribute(r),this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e));break;case"style":this.isBlazorServer||this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(r));break;case"name":this.isBlazorServer||this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(r));break;case"value":if((Object(s.X)(this.datepickerOptions)||void 0===this.datepickerOptions.value||e)&&!this.isBlazorServer){let i=this.inputElement.getAttribute(r);this.setProperties(Object(s.qb)(r,this.globalize.parseDate(i,t),{}),!e)}break;case"min":if(+this.min==+new Date(1900,0,1)||e){let t=this.inputElement.getAttribute(r);this.setProperties(Object(s.qb)(r,this.globalize.parseDate(t),{}),!e)}break;case"max":if(+this.max==+new Date(2099,11,31)||e){let t=this.inputElement.getAttribute(r);this.setProperties(Object(s.qb)(r,this.globalize.parseDate(t),{}),!e)}break;case"type":"text"===this.inputElement.getAttribute(r)||this.isBlazorServer||this.inputElement.setAttribute("type","text")}}getModuleName(){return"datepicker"}disabledDates(){let e,t,i;e=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value));let r=this.previousDate;this.minMaxUpdates(),this.isBlazorServer||super.render(),this.previousDate=r;let n,l='*[id^="/id"]'.replace("/id",""+(e&&+e));this.strictMode||("string"==typeof this.value||"object"==typeof this.value&&+this.value!=+e)&&this.setProperties({value:e},!0),Object(s.X)(this.calendarElement.querySelectorAll(l)[0])||this.calendarElement.querySelectorAll(l)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date((new Date).setHours(0,0,0,0)))),"datetimepicker"===this.getModuleName()?(i=this.globalize.formatDate(e,"Gregorian"===this.calendarMode?{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:Object(s.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),n=i):(t="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n=this.globalize.formatDate(e,t)),this.popupObj||this.updateInputValue(n)}setAriaAttributes(){if(this.isBlazorServer)if(this.isCalendar()){let e=this.tableBodyElement.querySelector("tr td.e-focused-date"),t=this.tableBodyElement.querySelector("tr td.e-selected"),i=e||t?(e||t).getAttribute("id"):"null";Object(s.x)(this.inputElement,{"aria-activedescendant":""+i})}else Object(s.x)(this.inputElement,{"aria-activedescendant":"null"});else this.isCalendar()?(n.c.addAttributes({"aria-expanded":"true"},this.inputElement),Object(s.x)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(n.c.addAttributes({"aria-expanded":"false"},this.inputElement),Object(s.x)(this.inputElement,{"aria-activedescendant":"null"}))}errorClass(){let e='*[id^="/id"]'.replace("/id",""+ +this.value),t=this.calendarElement&&this.calendarElement.querySelectorAll(e)[0]&&this.calendarElement.querySelectorAll(e)[0].classList.contains("e-disabled");!Object(s.X)(this.value)&&!(+new Date(+this.value).setMilliseconds(0)>=+this.min&&+new Date(+this.value).setMilliseconds(0)<=+this.max)||!this.strictMode&&""!==this.inputElement.value&&Object(s.X)(this.value)||t?(Object(s.v)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"true"})):(Object(s.ib)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"false"}))}onPropertyChanged(e,t){let i;i="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(let r of Object.keys(e)){switch(r){case"value":this.isInteracted=!1,this.invalidValueString=null,this.isBlazorServer||this.checkInvalidValue(e.value),e.value=this.value,this.previousElementValue=this.inputElement.value,this.isBlazorServer||(Object(s.X)(this.value)&&(this.updateInputValue(""),this.currentDate=new Date((new Date).setHours(0,0,0,0))),this.updateInput(),+this.previousDate!=+this.value&&this.changeTrigger(null)),this.isInteracted=!0;break;case"format":this.checkFormat(),this.bindInputEvent(),this.isBlazorServer||this.updateInput();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":n.c.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":n.c.setReadonly(this.readonly,this.inputElement);break;case"enabled":n.c.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new s.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),n.c.setPlaceholder(this.placeholder,this.inputElement),this.isBlazorServer||this.updateInput();break;case"enableRtl":n.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&!this.isBlazorServer&&super.onPropertyChanged(e,t);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"showClearButton":n.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.isBlazorServer||this.updateInput();break;case"width":this.setWidth(e.width);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,n.c.removeFloating(this.inputWrapper),n.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;default:this.calendarElement&&!this.isBlazorServer&&super.onPropertyChanged(e,t)}this.hide(null)}}};return y([Object(s.s)(null)],e.prototype,"width",void 0),y([Object(s.s)(null)],e.prototype,"value",void 0),y([Object(s.s)(null)],e.prototype,"cssClass",void 0),y([Object(s.s)(!1)],e.prototype,"strictMode",void 0),y([Object(s.s)(null)],e.prototype,"format",void 0),y([Object(s.s)(!0)],e.prototype,"enabled",void 0),y([Object(s.s)({})],e.prototype,"htmlAttributes",void 0),y([Object(s.s)(null)],e.prototype,"values",void 0),y([Object(s.s)(!1)],e.prototype,"isMultiSelection",void 0),y([Object(s.s)(!0)],e.prototype,"showClearButton",void 0),y([Object(s.s)(!0)],e.prototype,"allowEdit",void 0),y([Object(s.s)(null)],e.prototype,"keyConfigs",void 0),y([Object(s.s)(!1)],e.prototype,"enablePersistence",void 0),y([Object(s.s)(1e3)],e.prototype,"zIndex",void 0),y([Object(s.s)(!1)],e.prototype,"readonly",void 0),y([Object(s.s)(null)],e.prototype,"placeholder",void 0),y([Object(s.s)("Never")],e.prototype,"floatLabelType",void 0),y([Object(s.s)(null)],e.prototype,"serverTimezoneOffset",void 0),y([Object(s.s)(!1)],e.prototype,"openOnFocus",void 0),y([Object(s.k)()],e.prototype,"open",void 0),y([Object(s.k)()],e.prototype,"cleared",void 0),y([Object(s.k)()],e.prototype,"close",void 0),y([Object(s.k)()],e.prototype,"blur",void 0),y([Object(s.k)()],e.prototype,"focus",void 0),y([Object(s.k)()],e.prototype,"created",void 0),y([Object(s.k)()],e.prototype,"destroyed",void 0),e=y([s.q],e),e})();var S=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};const O="e-left-calendar",x="e-right-calendar",j="e-daterangepicker",R="e-active",D="e-start-date",E="e-end-date",I="e-range-hover",M="e-disabled",F="e-calendar",T="e-focused-date",k="e-day-span",z="e-date-disabled",A="e-icon-disabled",L="e-overlay",B="e-list-item",P="e-hover",q=["title","class","style"];let V=(()=>{class e extends s.e{}return S([Object(s.s)()],e.prototype,"label",void 0),S([Object(s.s)()],e.prototype,"start",void 0),S([Object(s.s)()],e.prototype,"end",void 0),e})(),H=(()=>{let e=class extends m{constructor(e,t){super(e,t),this.isCustomRange=!1,this.isCustomWindow=!1,this.presetsItem=[],this.liCollections=[],this.previousEleValue="",this.isKeyPopup=!1,this.dateDisabled=!1,this.isRangeIconClicked=!1,this.isMaxDaysClicked=!1,this.disabledDays=[],this.preventBlur=!1,this.preventFocus=!1,this.invalidValueString=null,this.isAngular=!1,this.preventChange=!1,this.dateRangeOptions=e}render(){this.initialize(),this.setProperties({startDate:this.startValue},!0),this.setProperties({endDate:this.endValue},!0),this.setModelValue(),this.setDataAttribute(!1),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),this.renderComplete()}preRender(){if(this.keyInputConfigs={altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",tab:"tab",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow",moveUp:"uparrow",moveDown:"downarrow",spacebar:"space"},this.defaultConstant={placeholder:this.placeholder,startLabel:"Start Date",endLabel:"End Date",customRange:"Custom Range",applyText:"Apply",cancelText:"Cancel",selectedDays:"Selected Days",days:"days"},this.isMobile=window.matchMedia("(max-width:550px)").matches,this.inputElement=this.element,this.angularTag=null,"EJS-DATERANGEPICKER"===this.element.tagName&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.cloneElement=this.element.cloneNode(!0),Object(s.ib)([this.cloneElement],[j,"e-control","e-lib"]),this.updateHtmlAttributeToElement(),this.element.getAttribute("id")?null!==this.angularTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):(this.element.id=Object(s.U)("ej2-datetimepicker"),null!==this.angularTag&&Object(s.x)(this.inputElement,{id:this.element.id+"_input"})),this.checkInvalidRange(this.value),!this.invalidValueString&&"string"==typeof this.value){let e=this.value.split(" "+this.separator+" ");this.value=[new Date(e[0]),new Date(e[1])]}this.initProperty(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),super.preRender(),this.navNextFunction=this.navNextMonth.bind(this),this.navPrevFunction=this.navPrevMonth.bind(this),this.deviceNavNextFunction=this.deviceNavNext.bind(this),this.deviceNavPrevFunction=this.deviceNavPrevious.bind(this),this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue),this.formElement=Object(s.C)(this.element,"form")}updateValue(){Object(s.W)(),this.value&&this.value.length>0?(this.value[0]instanceof Date&&!isNaN(+this.value[0])?(this.setProperties({startDate:this.value[0]},!0),this.startValue=this.value[0]):"string"==typeof this.value[0]?0==+this.value[0]||isNaN(+new Date(this.checkValue(this.value[0])))?(this.startValue=null,this.setValue()):(this.setProperties({startDate:new Date(this.checkValue(this.value[0]))},!0),this.startValue=new Date(this.checkValue(this.value[0]))):(this.startValue=null,this.setValue()),this.value[1]instanceof Date&&!isNaN(+this.value[1])?(this.setProperties({endDate:this.value[1]},!0),this.endValue=this.value[1]):"string"==typeof this.value[1]?0==+this.value[0]||isNaN(+new Date(this.checkValue(this.value[0])))?(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue()):(this.setProperties({endDate:new Date(this.checkValue(this.value[1]))},!0),this.endValue=new Date(this.checkValue(this.value[1])),this.setValue()):(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue())):this.value&&this.value.start?(this.value.start instanceof Date&&!isNaN(+this.value.start)?(this.setProperties({startDate:this.value.start},!0),this.startValue=this.value.start):"string"==typeof this.value.start?(this.setProperties({startDate:new Date(this.checkValue(this.value.start))},!0),this.startValue=new Date(this.checkValue(this.value.start))):(this.startValue=null,this.setValue()),this.value.end instanceof Date&&!isNaN(+this.value.end)?(this.setProperties({endDate:this.value.end},!0),this.endValue=this.value.end):"string"==typeof this.value.end?(this.setProperties({endDate:new Date(this.checkValue(this.value.end))},!0),this.endValue=new Date(this.checkValue(this.value.end)),this.setValue()):(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue())):Object(s.X)(this.value)&&(this.endValue=this.checkDateValue(new Date(this.checkValue(this.endDate))),this.startValue=this.checkDateValue(new Date(this.checkValue(this.startDate))),this.setValue())}initProperty(){this.globalize=new s.n(this.locale),this.checkFormat(),this.checkView(),(Object(s.X)(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.updateValue()}checkFormat(){this.formatString=this.format?"string"==typeof this.format?this.format:""===this.format.skeleton||Object(s.X)(this.format.skeleton)?null:this.globalize.getDatePattern({skeleton:this.format.skeleton,type:"date"}):null}initialize(){null!==this.angularTag&&this.validationAttribute(this.element,this.inputElement),this.checkHtmlAttributes(!1),Object(s.db)(this.defaultKeyConfigs,{shiftTab:"shift+tab"});let e=this.checkDateValue(new Date(this.checkValue(this.startValue)));this.setProperties({startDate:e},!0),this.setProperties({endValue:this.checkDateValue(new Date(this.checkValue(this.endValue)))},!0),this.setValue(),this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.l10n=new s.p("daterangepicker",this.defaultConstant,this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.processPresets(),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setRangeAllowEdit(),this.bindEvents()}setDataAttribute(e){let t={};if(e)t=this.htmlAttributes;else for(let i=0;i<this.element.attributes.length;i++)t[this.element.attributes[i].name]=this.element.getAttribute(this.element.attributes[i].name);for(let i of Object.keys(t))0===i.indexOf("data")&&(this.firstHiddenChild.setAttribute(i,t[i]),this.secondHiddenChild.setAttribute(i,t[i]))}setRangeAllowEdit(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(s.x)(this.inputElement,{readonly:""}),this.updateClearIconState()}updateClearIconState(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):Object(s.v)([this.inputWrapper.container],["e-non-edit"])}validationAttribute(e,t){let i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");let r=["required","aria-required","form"];for(let n=0;n<r.length;n++){if(Object(s.X)(e.getAttribute(r[n])))continue;let i=e.getAttribute(r[n]);t.setAttribute(r[n],i),e.removeAttribute(r[n])}}updateHtmlAttributeToWrapper(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))if(q.indexOf(e)>-1)if("class"===e){let t=this.htmlAttributes[e].replace(/\s+/g," ").trim();""!==t&&Object(s.v)([this.inputWrapper.container],t.split(" "))}else if("style"===e){let t=this.inputWrapper.container.getAttribute(e);t=Object(s.X)(t)?this.htmlAttributes[e]:t+this.htmlAttributes[e],this.inputWrapper.container.setAttribute(e,t)}else this.inputWrapper.container.setAttribute(e,this.htmlAttributes[e])}updateHtmlAttributeToElement(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))q.indexOf(e)<0&&this.inputElement.setAttribute(e,this.htmlAttributes[e])}updateCssClass(e,t){Object(s.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(s.X)(e)||(e=e.replace(/\s+/g," ").trim()),n.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&n.c.setCssClass(e,[this.popupWrapper],t)}processPresets(){this.presetsItem=[];let e=0;if(!Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)){for(let s of this.presets){let t=s.label.replace(/\s+/g,"")+"_"+ ++e;this.presetsItem.push("string"==typeof s.end?{id:t,text:s.label,end:new Date(this.checkValue(s.end)),start:new Date(this.checkValue(s.start))}:{id:t,text:s.label,start:s.start,end:s.end})}let t=Object(s.X)(this.startValue)?null:new Date(+this.startValue),i=Object(s.X)(this.endValue)?null:new Date(+this.endValue);this.presetsItem.push({id:"custom_range",text:this.l10n.getConstant("customRange"),start:t,end:i}),Object(s.X)(this.startValue)||Object(s.X)(this.endValue)||(this.isCustomRange=!0,this.activeIndex=this.presetsItem.length-1)}}bindEvents(){s.l.add(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler,this),s.l.add(this.inputElement,"focus",this.inputFocusHandler,this),s.l.add(this.inputElement,"blur",this.inputBlurHandler,this),s.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&s.l.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this),this.isMobile||(this.keyInputConfigs=Object(s.K)(this.keyInputConfigs,this.keyConfigs),this.inputKeyboardModule=new s.o(this.inputElement,{eventName:"keydown",keyAction:this.inputHandler.bind(this),keyConfigs:this.keyInputConfigs})),this.formElement&&s.l.add(this.formElement,"reset",this.formResetHandler,this),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1}unBindEvents(){s.l.remove(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler),s.l.remove(this.inputElement,"blur",this.inputBlurHandler),s.l.remove(this.inputElement,"focus",this.inputFocusHandler),s.l.remove(this.inputElement,"change",this.inputChangeHandler),this.showClearButton&&this.inputWrapper.clearButton&&s.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.isMobile||Object(s.X)(this.inputKeyboardModule)||this.inputKeyboardModule.destroy(),this.formElement&&s.l.remove(this.formElement,"reset",this.formResetHandler),this.inputElement.tabIndex=-1}updateHiddenInput(){if(this.firstHiddenChild&&this.secondHiddenChild){let e={type:"datetime",skeleton:Object(s.W)()?"d":"yMd"};"string"==typeof this.startDate&&(this.startDate=this.globalize.parseDate(this.startDate,e)),"string"==typeof this.endDate&&(this.endDate=this.globalize.parseDate(this.endDate,e)),this.firstHiddenChild.value=this.startDate&&this.globalize.formatDate(this.startDate,e)||this.inputElement.value,this.secondHiddenChild.value=this.endDate&&this.globalize.formatDate(this.endDate,e)||this.inputElement.value,this.dispatchEvent(this.firstHiddenChild,"focusout"),this.dispatchEvent(this.firstHiddenChild,"change")}}inputChangeHandler(e){this.enabled&&(e.stopPropagation(),this.updateHiddenInput())}bindClearEvent(){this.showClearButton&&this.inputWrapper.clearButton&&s.l.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)}resetHandler(e){if(!this.enabled)return;this.valueType=this.value,e.preventDefault(),this.clear();let t={event:e};this.setProperties({endDate:this.checkDateValue(this.endValue)},!0),this.setProperties({startDate:this.checkDateValue(this.startValue)},!0),this.trigger("cleared",t),this.changeTrigger(e),this.clearRange(),this.hide(e)}restoreValue(){this.previousEleValue=this.inputElement.value,this.previousStartValue=this.startValue,this.previousEndValue=this.endValue,this.valueType=null,this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue),this.setValue(),this.setModelValue()}formResetHandler(e){if(this.enabled&&this.formElement&&e.target===this.formElement&&!this.inputElement.disabled){let e=this.inputElement.getAttribute("value");Object(s.X)(this.startCopy)?(this.setProperties({value:null,startDate:null,endDate:null},!0),this.startValue=this.endValue=null):(Object(s.X)(this.value)||Object(s.X)(this.value.start)?(this.setProperties({value:[this.startCopy,this.endCopy]},!0),this.startValue=this.value[0],this.endValue=this.value[1]):(this.setProperties({value:{start:this.startCopy,end:this.endCopy}},!0),this.startValue=this.value.start,this.endValue=this.value.end),this.setProperties({startDate:this.startValue,endDate:this.endValue},!0)),"EJS-DATERANGEPICKER"===this.element.tagName&&(this.setProperties({value:null,startDate:null,endDate:null},!0),e="",this.startValue=this.endValue=null,this.inputElement.setAttribute("value","")),this.restoreValue(),this.inputElement&&(n.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton),this.errorClass())}}clear(){null!==this.startValue&&(this.startValue=null),null!==this.endValue&&(this.endValue=null),this.value&&this.value.start&&this.setProperties({value:{start:null,end:null}},!0),null!==this.value&&this.value.length>0&&this.setProperties({value:null},!0),n.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),Object(s.X)(this.applyButton)||(this.applyButton.disabled=this.applyButton.element.disabled=!0),this.removeSelection()}rangeIconHandler(e){this.enabled&&(this.isMobile&&this.inputElement.setAttribute("readonly",""),e.preventDefault(),this.targetElement=null,this.isPopupOpen()&&document.body.contains(this.popupObj.element)?this.applyFunction(e):(this.isRangeIconClicked=!0,this.inputWrapper.container.children[0].focus(),this.show(null,e),this.isMobile||Object(s.X)(this.leftCalendar)||(this.isRangeIconClicked=!1,this.calendarFocus(),this.isRangeIconClicked=!0),Object(s.v)([this.inputWrapper.container],["e-input-focus"])))}checkHtmlAttributes(e){this.globalize=new s.n(this.locale);let t=e?Object(s.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["startDate","endDate","minDays","maxDays","min","max","disabled","readonly","style","name","placeholder","type","value"],i={format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"};for(let r of t)if(!Object(s.X)(this.inputElement.getAttribute(r)))switch(r){case"disabled":if(Object(s.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.enabled||e){let t="disabled"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({enabled:!t},!e)}break;case"readonly":if(Object(s.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.readonly||e){let t="readonly"===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r);this.setProperties({readonly:t},!e)}break;case"placeholder":(Object(s.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e);break;case"value":if(Object(s.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.value||e){let t=this.inputElement.getAttribute(r);this.setProperties(Object(s.qb)(r,t,{}),!e)}break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(r));break;case"min":if(Object(s.X)(this.min)||+this.min==+new Date(1900,0,1)||e){let t=this.globalize.parseDate(this.inputElement.getAttribute(r),i);this.setProperties(Object(s.qb)(r,t,{}),!e)}break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(r));break;case"max":if(Object(s.X)(this.max)||+this.max==+new Date(2099,11,31)||e){let t=this.globalize.parseDate(this.inputElement.getAttribute(r),i);this.setProperties(Object(s.qb)(r,t,{}),!e)}break;case"startDate":if(Object(s.X)(this.startDate)){let e=this.globalize.parseDate(this.inputElement.getAttribute(r),i);this.startValue=e,this.setValue()}break;case"endDate":if(Object(s.X)(this.endDate)){let e=this.globalize.parseDate(this.inputElement.getAttribute(r),i);this.endValue=e,this.setValue()}break;case"minDays":Object(s.X)(this.minDays)&&this.setProperties(Object(s.qb)(r,parseInt(this.inputElement.getAttribute(r),10),{}),!0);break;case"maxDays":Object(s.X)(this.maxDays)&&this.setProperties(Object(s.qb)(r,parseInt(this.inputElement.getAttribute(r),10),{}),!0);break;case"type":"text"!==this.inputElement.getAttribute(r)&&this.inputElement.setAttribute("type","text")}}createPopup(){for(let t=0;t<this.presetsItem.length;t++)t!==this.presetsItem.length-1&&"custom_range"===this.presetsItem[t].id&&this.presetsItem.splice(t,1);this.activeIndex=this.presetsItem.length-1,this.isCustomRange=!0;for(let t=0;t<=this.presetsItem.length-2;t++){let e=this.presetsItem[t].start,i=this.presetsItem[t].end;this.startValue&&this.endValue&&+e.setMilliseconds(0)==+this.startValue.setMilliseconds(0)&&+i.setMilliseconds(0)==+this.endValue.setMilliseconds(0)&&(this.activeIndex=t,this.isCustomRange=!1)}this.popupWrapper=Object(s.F)("div",{id:this.element.id+"_popup",className:j+" e-popup"}),this.adjustLongHeaderWidth();let e=!this.isCustomRange||this.isMobile;!Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)&&e?(this.isCustomWindow=!1,this.createPresets(),this.listRippleEffect(),this.renderPopup()):(this.isCustomWindow=!0,this.renderControl())}renderControl(){this.createControl(),this.bindCalendarEvents(),this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar]),Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||this.disabledDateRender(),this.updateHeader()}clearCalendarEvents(){s.l.clearEvents(this.leftCalPrevIcon),s.l.clearEvents(this.leftCalNextIcon),s.l.clearEvents(this.rightCalPrevIcon),s.l.clearEvents(this.rightCalNextIcon)}updateNavIcons(){super.iconHandler()}calendarIconEvent(){this.clearCalendarEvents(),this.leftCalPrevIcon&&!this.leftCalPrevIcon.classList.contains(M)&&s.l.add(this.leftCalPrevIcon,"mousedown",this.navPrevFunction),this.leftCalNextIcon&&!this.leftCalNextIcon.classList.contains(M)&&s.l.add(this.leftCalNextIcon,"mousedown",this.navNextFunction),this.rightCalPrevIcon&&!this.rightCalPrevIcon.classList.contains(M)&&s.l.add(this.rightCalPrevIcon,"mousedown",this.navPrevFunction),this.rightCalNextIcon&&!this.rightCalNextIcon.classList.contains(M)&&s.l.add(this.rightCalNextIcon,"mousedown",this.navNextFunction)}bindCalendarEvents(){this.isMobile?(this.deviceCalendarEvent(),s.l.add(this.startButton.element,"click",this.deviceHeaderClick,this),s.l.add(this.endButton.element,"click",this.deviceHeaderClick,this)):(this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.headerTitleElement=this.popupObj.element.querySelector(".e-right-calendar .e-header .e-title"),this.headerTitleElement=this.popupObj.element.querySelector(".e-left-calendar .e-header .e-title"),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs),this.leftKeyboardModule=new s.o(this.leftCalendar,{eventName:"keydown",keyAction:this.keyInputHandler.bind(this),keyConfigs:this.defaultKeyConfigs}),this.rightKeyboardModule=new s.o(this.rightCalendar,{eventName:"keydown",keyAction:this.keyInputHandler.bind(this),keyConfigs:this.defaultKeyConfigs})),this.start===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate()}calendarIconRipple(){Object(s.kb)(this.leftCalPrevIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(s.kb)(this.leftCalNextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),Object(s.kb)(this.rightCalPrevIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(s.kb)(this.rightCalNextIcon,{selector:".e-next",duration:400,isCenterRipple:!0})}deviceCalendarEvent(){s.l.clearEvents(this.nextIcon),s.l.clearEvents(this.previousIcon),Object(s.kb)(this.nextIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(s.kb)(this.previousIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.nextIcon&&!this.nextIcon.classList.contains(M)&&s.l.add(this.nextIcon,"mousedown",this.deviceNavNextFunction),this.previousIcon&&!this.previousIcon.classList.contains(M)&&s.l.add(this.previousIcon,"mousedown",this.deviceNavPrevFunction)}deviceNavNext(e){let t=Object(s.C)(e.target,"."+F);this.updateDeviceCalendar(t),this.navigateNext(e),this.deviceNavigation()}deviceNavPrevious(e){let t=Object(s.C)(e.target,"."+F);this.updateDeviceCalendar(t),this.navigatePrevious(e),this.deviceNavigation()}updateDeviceCalendar(e){e&&(this.previousIcon=e.querySelector(".e-prev"),this.nextIcon=e.querySelector(".e-next"),this.calendarElement=e,this.deviceCalendar=e,this.contentElement=e.querySelector(".e-content"),this.tableBodyElement=Object(s.lb)(".e-content tbody",e),this.table=e.querySelector(".e-content").getElementsByTagName("table")[0],this.headerTitleElement=e.querySelector(".e-header .e-title"),this.headerElement=e.querySelector(".e-header"))}deviceHeaderClick(e){if(e.currentTarget.classList.contains("e-start-btn")&&!Object(s.X)(this.startValue)){this.endButton.element.classList.remove(R),this.startButton.element.classList.add(R);let e=this.popupObj.element.querySelector("."+F);this.updateDeviceCalendar(e),Object(s.X)(this.calendarElement.querySelector(".e-start-date:not(.e-other-month)"))&&(this.currentDate=new Date(+this.startValue),Object(s.hb)(this.tableBodyElement),this.createContentBody(),this.deviceNavigation()),this.removeClassDisabled()}else if(!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)){this.startButton.element.classList.remove(R),this.endButton.element.classList.add(R);let e=this.popupObj.element.querySelector("."+F);this.updateDeviceCalendar(e),Object(s.X)(this.calendarElement.querySelector(".e-end-date:not(.e-other-month)"))&&(this.currentDate=new Date(+this.endValue),Object(s.hb)(this.tableBodyElement),this.createContentBody(),this.deviceNavigation()),this.updateMinMaxDays(this.popupObj.element.querySelector("."+F)),this.selectableDates()}}inputFocusHandler(){if(!this.enabled)return;this.preventBlur=!1;let e={model:Object(s.W)()&&this.isServerRendered?null:this};this.preventFocus||(this.preventFocus=!0,this.trigger("focus",e)),this.updateClearIconState(),this.updateHiddenInput(),this.openOnFocus&&this.show()}inputBlurHandler(e){if(this.enabled){if(!this.preventBlur){let t=this.inputElement.value;if(Object(s.X)(this.presetsItem)||this.presetsItem.length>0&&this.previousEleValue!==this.inputElement.value&&(this.activeIndex=this.presetsItem.length-1,this.isCustomRange=!0),!Object(s.X)(t)&&""!==t.trim()){let i=t.split(" "+this.separator+" ");if(i.length>1){this.invalidValueString=null;let r={format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"},n=this.globalize.parseDate(i[0].trim(),r),l=this.globalize.parseDate(i[1].trim(),r);if(!(Object(s.X)(n)||isNaN(+n)||Object(s.X)(l)||isNaN(+l))){let i=this.startValue;this.startValue=n;let r=this.endValue;if(this.endValue=l,this.setValue(),this.refreshControl(),t!==this.previousEleValue&&this.changeTrigger(e),!this.preventBlur&&document.activeElement!==this.inputElement){this.preventFocus=!1;let e={model:Object(s.W)()&&this.isServerRendered?null:this};this.trigger("blur",e)}return this.updateHiddenInput(),void(this.isMobile&&this.isPopupOpen()&&(this.startValue=i,this.endValue=r))}this.strictMode||(this.startValue=null,this.endValue=null,this.setValue())}else this.strictMode||(this.startValue=null,this.endValue=null,this.setValue())}if(this.strictMode?(Object(s.X)(t)||""!==t.trim()||(this.startValue=null,this.endValue=null),n.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.updateInput()):(Object(s.X)(this.popupObj)&&(this.currentDate=null),this.previousStartValue=this.previousEndValue=null,this.startValue=null,this.endValue=null,this.setValue()),this.errorClass(),this.changeTrigger(e),!this.preventBlur&&document.activeElement!==this.inputElement){this.preventFocus=!1;let e={model:Object(s.W)()&&this.isServerRendered?null:this};this.trigger("blur",e)}}this.updateHiddenInput()}}clearRange(){this.previousStartValue=this.previousEndValue=null,this.currentDate=null}errorClass(){let e=this.inputElement.value.trim();(Object(s.X)(this.endValue)&&Object(s.X)(this.startValue)&&""!==e||!Object(s.X)(this.startValue)&&+this.startValue<+this.min||!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(s.X)(this.endValue)&&+this.endValue>+this.max||this.startValue&&this.isDateDisabled(this.startValue)||this.endValue&&this.isDateDisabled(this.endValue))&&""!==e?(Object(s.v)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"true"})):this.inputWrapper&&(Object(s.ib)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"false"}))}keyCalendarUpdate(e,t){return this.removeFocusedDate(),e?(this.leftCalCurrentDate=new Date(+this.currentDate),t=this.leftCalendar):(this.rightCalCurrentDate=new Date(+this.currentDate),t=this.rightCalendar),this.updateCalendarElement(t),this.table.focus(),t}navInCalendar(e,t,i,r,n){let l,a,o=this.getViewNumber(this.currentView()),h=this.min;switch(a=Object(s.X)(this.maxDays)||!this.isMaxDaysClicked||Object(s.X)(this.startValue)?this.max:new Date(new Date(+this.startValue).setDate(this.startValue.getDate()+(this.maxDays-1))),e.action){case"moveRight":l=new Date(+this.currentDate),this.addDay(l,1,e,a,h),t&&+l==+r&&(n=this.keyCalendarUpdate(!1,n)),this.KeyboardNavigate(1,o,e,a,h),this.keyNavigation(n,e);break;case"moveLeft":l=new Date(+this.currentDate),this.addDay(l,-1,e,a,h),t||+l==+i&&(n=this.keyCalendarUpdate(!0,n)),this.KeyboardNavigate(-1,o,e,a,h),this.keyNavigation(n,e);break;case"moveUp":0===o?(l=new Date(+this.currentDate),this.addDay(l,-7,e,a,h),+l<=+i&&!t&&(n=this.keyCalendarUpdate(!0,n)),this.KeyboardNavigate(-7,o,e,a,h)):this.KeyboardNavigate(-4,o,e,this.max,this.min),this.keyNavigation(n,e);break;case"moveDown":0===o?(l=new Date(+this.currentDate),this.addDay(l,7,e,a,h),t&&+l>=+r&&(n=this.keyCalendarUpdate(!1,n)),this.KeyboardNavigate(7,o,e,a,h)):this.KeyboardNavigate(4,o,e,this.max,this.min),this.keyNavigation(n,e);break;case"home":this.currentDate=this.firstDay(this.currentDate),Object(s.hb)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),this.keyNavigation(n,e);break;case"end":this.currentDate=this.lastDay(this.currentDate,o),Object(s.hb)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),this.keyNavigation(n,e)}}keyInputHandler(e,t){let i,r=this.getViewNumber(this.currentView()),n=new Date(this.rightCalCurrentDate.getFullYear(),this.rightCalCurrentDate.getMonth(),1),l=new Date(this.leftCalCurrentDate.getFullYear(),this.leftCalCurrentDate.getMonth()+1,0),a=Object(s.C)(e.target,"."+x);a=Object(s.X)(a)?this.leftCalendar:a;let o=a.classList.contains(O);this.updateCalendarElement(a);let h=this.tableBodyElement.querySelector("tr td.e-selected"),d=a.querySelector("tr td."+T),c=a.querySelector("tr td."+D),p=a.querySelector("tr td."+E),u=this.getViewNumber(this.depth),g=r===u&&this.getViewNumber(this.start)>=u,m=Object(s.C)(e.target,"."+O),b=Object(s.C)(e.target,"."+x),f=Object(s.C)(e.target,".e-presets");switch(Object(s.X)(d)?Object(s.X)(p)||this.dateDisabled?Object(s.X)(c)||this.dateDisabled?this.dateDisabled||this.currentDate.setDate(1):this.currentDate=new Date(+this.startValue):this.currentDate=new Date(+this.endValue):this.currentDate=this.currentDate,this.effect="",e.action){case"altUpArrow":this.isPopupOpen()&&(this.hide(e),this.preventFocus=!0,this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"]));break;case"select":if(g){let e=Object(s.X)(d)?c:d;Object(s.X)(e)||e.classList.contains(M)||this.selectRange(null,e)}else(Object(s.X)(h)||g)&&Object(s.X)(d)||(Object(s.X)(this.value)||(t=this.calendarElement.classList.contains(O)?this.startDate:this.endDate),this.controlDown=e,this.contentClick(null,--r,d||h,t));e.preventDefault();break;case"controlHome":let p=new Date(this.currentDate.getFullYear(),0,1);!o&&+p<+l&&(a=this.keyCalendarUpdate(!0,a)),super.navigateTo.call(this,"Month",new Date(this.currentDate.getFullYear(),0,1)),this.keyNavigation(a,e);break;case"altRightArrow":Object(s.X)(m)?Object(s.X)(b)?Object(s.X)(f)||this.cancelButton.element.focus():Object(s.X)(this.presetElement)?this.cancelButton.element.focus():(this.presetElement.focus(),this.removeFocusedDate()):this.rightCalendar.children[1].firstElementChild.focus(),e.preventDefault();break;case"altLeftArrow":Object(s.X)(m)?Object(s.X)(b)||this.leftCalendar.children[1].firstElementChild.focus():!0!==this.applyButton.element.disabled?this.applyButton.element.focus():this.cancelButton.element.focus(),e.preventDefault();break;case"controlUp":this.calendarElement.classList.contains(O),this.calendarNavigation(e,this.calendarElement),e.preventDefault();break;case"controlDown":Object(s.X)(h)&&Object(s.X)(d)||g||(Object(s.X)(this.value)||(t=this.calendarElement.classList.contains(O)?this.startDate:this.endDate),this.controlDown=e,this.contentClick(null,--r,h||d,t)),e.preventDefault();break;case"controlEnd":p=new Date(this.currentDate.getFullYear(),11,31),o&&+p>+n&&(a=this.keyCalendarUpdate(!1,a)),super.navigateTo.call(this,"Month",new Date(this.currentDate.getFullYear(),11,31)),this.keyNavigation(a,e);break;case"pageUp":i=new Date(+this.currentDate),this.addMonths(i,-1),!o&&+i<=+l&&(a=this.keyCalendarUpdate(!0,a)),this.addMonths(this.currentDate,-1),super.navigateTo.call(this,"Month",this.currentDate),this.keyNavigation(a,e);break;case"pageDown":i=new Date(+this.currentDate),this.addMonths(i,1),o&&+i>=+n&&(a=this.keyCalendarUpdate(!1,a)),this.addMonths(this.currentDate,1),super.navigateTo.call(this,"Month",this.currentDate),this.keyNavigation(a,e);break;case"shiftPageUp":i=new Date(+this.currentDate),this.addYears(i,-1),!o&&+i<=+l&&(a=this.keyCalendarUpdate(!0,a)),this.addYears(this.currentDate,-1),super.navigateTo.call(this,"Month",this.currentDate),this.keyNavigation(a,e);break;case"shiftPageDown":i=new Date(+this.currentDate),this.addYears(i,1),o&&+i>=+n&&(a=this.keyCalendarUpdate(!1,a)),this.addYears(this.currentDate,1),super.navigateTo.call(this,"Month",this.currentDate),this.keyNavigation(a,e);break;case"shiftTab":Object(s.X)(this.presetElement)||(this.presetElement.setAttribute("tabindex","0"),this.presetElement.focus(),this.removeFocusedDate()),e.preventDefault();break;case"spacebar":this.applyButton&&!this.applyButton.disabled&&this.applyFunction(e);break;default:this.navInCalendar(e,o,l,n,a),this.checkMinMaxDays()}this.presetHeight()}keyNavigation(e,t){this.bindCalendarCellEvents(e),e.classList.contains(O)?this.leftCalCurrentDate=new Date(+this.currentDate):this.rightCalCurrentDate=new Date(+this.currentDate),this.updateNavIcons(),this.calendarIconEvent(),this.updateRange([e]),this.dateDisabled=this.isDateDisabled(this.currentDate),t.preventDefault()}inputHandler(e){switch(e.action){case"altDownArrow":this.isPopupOpen()||(""===this.inputElement.value&&(this.clear(),this.changeTrigger(e),this.clearRange()),this.show(null,e),this.isRangeIconClicked=!1,this.isMobile||Object(s.X)(this.leftCalendar)||this.calendarFocus(),this.isKeyPopup=!0);break;case"escape":this.isPopupOpen()&&this.hide(e);break;case"enter":document.activeElement===this.inputElement&&(this.inputBlurHandler(e),this.hide(e));break;case"tab":document.activeElement===this.inputElement&&this.isPopupOpen()&&(this.hide(e),e.preventDefault())}}bindCalendarCellEvents(e){let t;t=e?e.querySelectorAll(".e-calendar td"):this.popupObj.element.querySelectorAll(".e-calendar td");for(let i of t){let e;s.l.clearEvents(i),e=i.classList.contains(M)||i.classList.contains(z),e||i.classList.contains("e-week-number")||(this.isMobile||s.l.add(i,"mouseover",this.hoverSelection,this),s.l.add(i,"mousedown",this.selectRange,this))}}removeFocusedDate(){let e,t=!Object(s.X)(this.startValue)||!Object(s.X)(this.endValue);e=this.popupObj.element.querySelectorAll(".e-calendar ."+T);for(let i of e){let e=new Date,s=this.getIdValue(null,i);("Month"===this.depth&&"Month"===this.currentView()&&(!i.classList.contains("e-today")||i.classList.contains("e-today")&&t)||"Year"===this.depth&&"Year"===this.currentView()&&(!this.isSameMonth(e,s)&&!this.isSameYear(e,s)||t)||"Decade"===this.depth&&"Decade"===this.currentView()&&(!this.isSameYear(e,s)||t))&&(i.classList.remove(T),i.classList.contains(D)||i.classList.contains(E)||i.removeAttribute("aria-label"))}}hoverSelection(e,t){let i=this.getIdValue(null,t||e.currentTarget);if(!Object(s.X)(this.startValue)&&+this.startValue>=+this.min&&+this.startValue<=+this.max&&(!this.isDateDisabled(this.endValue)&&!this.isDateDisabled(this.startValue)&&Object(s.X)(this.endValue)&&Object(s.X)(this.startValue)||!Object(s.X)(this.startValue)&&Object(s.X)(this.endValue))){let e;e=this.popupObj.element.querySelectorAll(".e-calendar td");for(let t of e){let e=!t.classList.contains(M)||t.classList.contains(z);if(!t.classList.contains("e-week-number")&&e){let e=this.getIdValue(null,t),r=new Date(+this.startValue);new Date(+e).setHours(0,0,0,0)>=r.setHours(0,0,0,0)&&+e<=+i?Object(s.v)([t],I):Object(s.ib)([t],[I])}}}}isSameStartEnd(e,t){let i=!1;return"Month"===this.depth?e.setHours(0,0,0,0)===t.setHours(0,0,0,0)&&(i=!0):"Year"===this.depth?e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&(i=!0):"Decade"===this.depth&&e.getFullYear()===t.getFullYear()&&(i=!0),i}updateRange(e){if(!Object(s.X)(this.startValue))for(let t of e){let e=t.querySelectorAll(".e-calendar td");for(let t of e)if(!t.classList.contains("e-week-number")&&!t.classList.contains(M)){let e=this.getIdValue(null,t),i=this.getIdValue(null,t);if(Object(s.X)(this.endValue)?Object(s.ib)([t],[I]):this.currentView()===this.depth&&+i.setHours(0,0,0,0)>=+new Date(+this.startValue).setHours(0,0,0,0)&&+i.setHours(0,0,0,0)<=+new Date(+this.endValue).setHours(0,0,0,0)&&!this.isSameStartEnd(new Date(+this.startValue),new Date(+this.endValue))&&+new Date(+this.startValue).setHours(0,0,0,0)>=+this.min&&+new Date(+this.endValue).setHours(0,0,0,0)<=+this.max&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&Object(s.v)([t],I),t.classList.contains("e-selected")&&t.classList.contains(E)&&+i!=+this.endValue&&(Object(s.ib)([t],["e-selected"]),Object(s.ib)([t],[E])),t.classList.contains(I)&&+i>+this.endValue&&Object(s.ib)([t],[I]),!t.classList.contains("e-other-month")){let i=new Date(+this.startValue),r=new Date(+e);this.currentView()===this.depth&&+r.setHours(0,0,0,0)==+i.setHours(0,0,0,0)&&+r.setHours(0,0,0,0)>=+i.setHours(0,0,0,0)&&+this.startValue>=+this.min&&!this.inputWrapper.container.classList.contains("e-error")&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&(Object(s.v)([t],[D,"e-selected"]),this.addSelectedAttributes(t,this.startValue,!0));let n=new Date(+this.endValue);"Year"===this.currentView()?r=new Date(r.getFullYear(),r.getMonth()+1,0):"Decade"===this.currentView()&&(r=new Date(r.getFullYear(),11,31)),this.currentView()===this.depth&&!Object(s.X)(this.endValue)&&+r.setHours(0,0,0,0)==+n.setHours(0,0,0,0)&&+r.setHours(0,0,0,0)<=+n.setHours(0,0,0,0)&&+this.startValue>=+this.min&&!this.inputWrapper.container.classList.contains("e-error")&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&(Object(s.v)([t],[E,"e-selected"]),this.addSelectedAttributes(t,this.startValue,!1)),+e!=+this.startValue||Object(s.X)(this.endValue)||+e!=+this.endValue||this.addSelectedAttributes(t,this.endValue,!1,!0)}}}}checkMinMaxDays(){(!Object(s.X)(this.minDays)&&this.minDays>0||!Object(s.X)(this.maxDays)&&this.maxDays>0)&&(this.isMobile?this.updateMinMaxDays(this.popupObj.element.querySelector("."+F)):(this.updateMinMaxDays(this.popupObj.element.querySelector("."+O)),this.updateMinMaxDays(this.popupObj.element.querySelector("."+x))))}rangeArgs(e){let t,i,r=Object(s.X)(this.startValue)?null:this.globalize.formatDate(this.startValue,{format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"}),n=Object(s.X)(this.endValue)?null:this.globalize.formatDate(this.endValue,{format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"});return Object(s.X)(this.endValue)||Object(s.X)(this.startValue)?(t="",i=0):(t=r+" "+this.separator+" "+n,i=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1),{value:this.value,startDate:this.startValue,endDate:this.endValue,daySpan:i,event:e||null,element:this.element,isInteracted:!Object(s.X)(e),text:t}}otherMonthSelect(e,t,i){let r=+this.getIdValue(null,e),n='*[id^="/id"]:not(.e-other-month)'.replace("/id",""+r),l=this.popupObj&&this.popupObj.element.querySelector(n);Object(s.X)(l)||(t?(Object(s.v)([l],[D,"e-selected"]),this.addSelectedAttributes(l,this.startValue,!0)):(Object(s.v)([l],[E,"e-selected"]),this.addSelectedAttributes(l,this.endValue,!0)),i&&this.addSelectedAttributes(e,this.endValue,!1,!0))}selectRange(e,t){let i,r,n;e&&e.preventDefault(),n=Object(s.X)(e)?this.getIdValue(null,t):this.getIdValue(e,null);let l=n.getFullYear(),a=n.getMonth(),o=new Date(l,a,1),h=new Date(l,a+1,0),d=new Date(l,0,1),c=new Date(l,11,31);Object(s.X)(this.endValue)||Object(s.X)(this.startValue)?this.isMobile&&this.startButton.element.classList.contains(R)&&this.removeSelection():(!this.isMobile||this.isMobile&&!this.endButton.element.classList.contains(R))&&this.removeSelection();let p=t||e.currentTarget;if(Object(s.X)(this.startValue))Object(s.X)(this.previousStartValue)||(n.setHours(this.previousStartValue.getHours()),n.setMinutes(this.previousStartValue.getMinutes()),n.setSeconds(this.previousStartValue.getSeconds())),this.startValue="Month"===this.depth?new Date(this.checkValue(n)):"Year"===this.depth?o:d,this.endValue=null,this.setValue(),Object(s.v)([p],D),this.addSelectedAttributes(p,this.startValue,!0),p.classList.contains("e-other-month")&&this.otherMonthSelect(p,!0),this.checkMinMaxDays(),this.applyButton.disabled=!0,this.applyButton.element.disabled=!0,this.isMobile&&(this.endButton.element.classList.add(R),this.startButton.element.classList.remove(R),this.endButton.element.removeAttribute("disabled"),this.selectableDates()),this.trigger("select",this.rangeArgs(e));else if(+n==+this.startValue||+n>+this.startValue){if(+n==+this.startValue&&!Object(s.X)(this.minDays)&&this.minDays>1)return;this.endValue=null,this.setValue(),(this.isMobile||t)&&this.hoverSelection(e,t),Object(s.X)(this.previousEndValue)||(n.setHours(this.previousEndValue.getHours()),n.setMinutes(this.previousEndValue.getMinutes()),n.setSeconds(this.previousEndValue.getSeconds())),this.endValue="Month"===this.depth?new Date(this.checkValue(n)):"Year"===this.depth?h:c,this.setValue();let i=this.popupObj.element.querySelectorAll("."+E);if(this.isMobile){this.startButton.element.classList.remove(R),this.endButton.element.classList.add(R);for(let e of i)e.removeAttribute("aria-label"),e.classList.contains(D)?(this.addSelectedAttributes(e,this.startValue,!0),Object(s.ib)([e],[E])):(e.setAttribute("aria-selected","false"),Object(s.ib)([e],[E,"e-selected"]))}Object(s.v)([p],E),+this.endValue==+this.startValue?this.addSelectedAttributes(p,this.endValue,!1,!0):this.addSelectedAttributes(p,this.endValue,!1),p.classList.contains("e-other-month")&&(+this.endValue==+this.startValue?this.otherMonthSelect(p,!1,!0):this.otherMonthSelect(p,!1)),i=this.popupObj.element.querySelectorAll("."+E);for(let e of i)e.classList.contains(D)&&Object(s.ib)([e],[I]);this.applyButton.disabled=!1,this.applyButton.element.disabled=!1,this.isMobile||this.removeClassDisabled(),this.disabledDateRender(),this.trigger("select",this.rangeArgs(e))}else+n<+this.startValue&&(this.removeClassDisabled(),this.startValue="Month"===this.depth?new Date(this.checkValue(n)):"Year"===this.depth?o:d,this.setValue(),this.removeSelectedAttributes(),Object(s.ib)(this.popupObj.element.querySelectorAll("."+D),[D,"e-selected"]),Object(s.v)([p],D),this.addSelectedAttributes(p,this.startValue,!0),p.classList.contains("e-other-month")&&this.otherMonthSelect(p,!0),this.checkMinMaxDays());e&&(i=Object(s.C)(e.target,"."+O)),Object(s.X)(i)?(e&&(r=e&&Object(s.C)(e.target,"."+x)),Object(s.X)(r)||this.rightCalendar.children[1].firstElementChild.focus()):this.leftCalendar.children[1].firstElementChild.focus(),Object(s.v)([p],"e-selected"),this.updateHeader(),this.removeFocusedDate()}selectableDates(){if(!Object(s.X)(this.startValue)){let e=this.calendarElement.querySelectorAll(".e-calendar td"),t=!1;if(this.currentView()===this.depth){for(let i of e){if(!i.classList.contains(D)&&!i.classList.contains("e-week-number")&&!i.classList.contains(M)){if(+this.getIdValue(null,i)<+this.startValue){Object(s.v)([i],[z,M,L]),s.l.clearEvents(i);continue}break}if(i.classList.contains(D)&&!i.classList.contains("e-other-month")){t=!0;break}}t&&(this.previousIcon.classList.contains(M)||Object(s.v)([this.previousIcon],[A,M,L]))}else{for(let t of e){let e=this.startValue.getMonth(),i=this.startValue.getFullYear(),r=this.getIdValue(null,t);if(this.startButton.element.classList.contains(R)||!("Year"===this.currentView()&&r.getMonth()<e&&r.getFullYear()<=i||"Decade"===this.currentView()&&r.getMonth()<=e&&r.getFullYear()<i))break;Object(s.v)([t],[M])}e[0].classList.contains(M)?this.previousIconHandler(!0):e[e.length-1].classList.contains(M)&&this.nextIconHandler(!0)}}}updateMinMaxDays(e){if(!Object(s.X)(this.startValue)&&Object(s.X)(this.endValue)||this.isMobile&&this.endButton.element.classList.contains(R)){if(!Object(s.X)(this.minDays)&&this.minDays>0||!Object(s.X)(this.maxDays)&&this.maxDays>0){let t=this.removeTimeValueFromDate(this.startValue),i=new Date(new Date(+t).setDate(t.getDate()+(this.minDays-1))),r=new Date(new Date(+t).setDate(t.getDate()+(this.maxDays-1)));i=!Object(s.X)(this.minDays)&&this.minDays>0?i:null,r=!Object(s.X)(this.maxDays)&&this.maxDays>0?r:null,"Year"===this.currentView()?(i=Object(s.X)(i)?null:new Date(i.getFullYear(),i.getMonth(),0),r=Object(s.X)(r)?null:new Date(r.getFullYear(),r.getMonth(),1)):"Decade"===this.currentView()&&(i=Object(s.X)(i)?null:new Date(i.getFullYear()-1,11,1),r=Object(s.X)(r)?null:new Date(r.getFullYear(),0,1));let n,l=e.querySelectorAll(".e-calendar td");for(let e of l)if(!e.classList.contains(D)&&!e.classList.contains("e-week-number")){let l=this.getIdValue(null,e);if(l=this.removeTimeValueFromDate(l),!Object(s.X)(i)&&+l==+i&&e.classList.contains(M)&&i.setDate(i.getDate()+1),!e.classList.contains(M)){if(+l<=+t)continue;!Object(s.X)(i)&&+l<+i&&(Object(s.v)([e],[z,M,L]),s.l.clearEvents(e)),!Object(s.X)(r)&&+l>+r&&(Object(s.v)([e],[z,M,L]),this.isMaxDaysClicked=!0,s.l.clearEvents(e),Object(s.X)(n)&&!e.classList.contains("e-other-month")&&(n=e))}}if(!Object(s.X)(n))if(this.isMobile)this.nextIcon.classList.contains(M)||Object(s.v)([this.nextIcon],[A,M,L]);else{let e=Object(s.C)(n,"."+x);e=Object(s.X)(e)?this.leftCalendar:e,e.classList.contains(O)?(this.rightCalNextIcon.classList.contains(M)||Object(s.v)([this.rightCalNextIcon],[A,M,L]),this.leftCalNextIcon.classList.contains(M)||Object(s.v)([this.leftCalNextIcon],[A,M,L]),this.rightCalPrevIcon.classList.contains(M)||Object(s.v)([this.rightCalPrevIcon],[A,M,L])):this.rightCalNextIcon.classList.contains(M)||Object(s.v)([this.rightCalNextIcon],[A,M,L])}}}else this.isMaxDaysClicked=!1}removeTimeValueFromDate(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}removeClassDisabled(){let e;e=this.popupObj.element.querySelectorAll(".e-calendar td."+z);for(let t of e)t.classList.contains(z)&&(Object(s.ib)([t],[z,M,L]),s.l.add(t,"click",this.selectRange,this),this.isMobile||s.l.add(t,"mouseover",this.hoverSelection,this));this.isMobile?(this.nextIcon.classList.contains(A)&&Object(s.ib)([this.nextIcon],[A,M,L]),this.previousIcon.classList.contains(A)&&Object(s.ib)([this.previousIcon],[A,M,L])):(this.rightCalNextIcon.classList.contains(A)&&Object(s.ib)([this.rightCalNextIcon],[A,M,L]),this.rightCalPrevIcon.classList.contains(A)&&Object(s.ib)([this.rightCalPrevIcon],[A,M,L]),this.leftCalNextIcon.classList.contains(A)&&Object(s.ib)([this.leftCalNextIcon],[A,M,L]))}updateHeader(){let e={type:"date",skeleton:Object(s.W)()?"D":"yMMMd"};if(Object(s.X)(this.endValue)||Object(s.X)(this.startValue))this.popupObj.element.querySelector("."+k).textContent=this.l10n.getConstant("selectedDays");else{let e=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1;Object(s.X)(this.disabledDayCnt)||(e-=this.disabledDayCnt,this.disabledDayCnt=null),this.popupObj.element.querySelector("."+k).textContent=e.toString()+" "+this.l10n.getConstant("days")}this.isMobile?(this.startButton.element.textContent=Object(s.X)(this.startValue)?this.l10n.getConstant("startLabel"):this.globalize.formatDate(this.startValue,e),this.endButton.element.textContent=Object(s.X)(this.endValue)||Object(s.X)(this.startValue)?this.l10n.getConstant("endLabel"):this.globalize.formatDate(this.endValue,e)):(Object(s.X)(this.endValue)||Object(s.X)(this.startValue)?this.popupObj.element.querySelector(".e-end-label").textContent=this.l10n.getConstant("endLabel"):this.popupObj.element.querySelector(".e-end-label").textContent=this.globalize.formatDate(this.endValue,e),Object(s.X)(this.startValue)?this.popupObj.element.querySelector(".e-start-label").textContent=this.l10n.getConstant("startLabel"):this.popupObj.element.querySelector(".e-start-label").textContent=this.globalize.formatDate(this.startValue,e)),(this.isDateDisabled(this.startValue)||this.isDateDisabled(this.endValue)||!Object(s.X)(this.startValue)&&+this.startValue<+this.min||!Object(s.X)(this.endValue)&&+this.endValue>+this.max||!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue)&&(this.isMobile?(this.startButton.element.textContent=this.l10n.getConstant("startLabel"),this.endButton.element.textContent=this.l10n.getConstant("endLabel"),this.popupObj.element.querySelector("."+k).textContent=this.l10n.getConstant("selectedDays")):(this.popupObj.element.querySelector("."+k).textContent=this.l10n.getConstant("selectedDays"),this.popupObj.element.querySelector(".e-start-label").textContent=this.l10n.getConstant("startLabel"),this.popupObj.element.querySelector(".e-end-label").textContent=this.l10n.getConstant("endLabel"))),this.popupObj.element.querySelector("#custom_range")&&(this.popupObj.element.querySelector("#custom_range").textContent=""!==this.l10n.getConstant("customRange")?this.l10n.getConstant("customRange"):"Custom Range")}removeSelection(){this.startValue=null,this.endValue=null,this.setValue(),this.removeSelectedAttributes(),this.popupObj&&(this.popupObj.element.querySelectorAll(".e-selected").length>0&&Object(s.ib)(this.popupObj.element.querySelectorAll(".e-selected"),[D,E,"e-selected"]),this.popupObj.element.querySelectorAll("."+T).length>0&&Object(s.ib)(this.popupObj.element.querySelectorAll("."+T),T),this.popupObj.element.querySelectorAll("."+I).length>0&&Object(s.ib)(this.popupObj.element.querySelectorAll("."+I),[I]))}addSelectedAttributes(e,t,i,r){if(e){let n=this.globalize.formatDate(t,{type:"date",skeleton:Object(s.W)()?"D":"full"});!Object(s.X)(r)&&r?e.setAttribute("aria-label","The current start and end date is "+n):e.setAttribute("aria-label","The current "+(i?"start":"end")+" date is "+n),e.setAttribute("aria-selected","true")}}removeSelectedAttributes(){if(this.popupObj){let e=this.popupObj.element.querySelectorAll("."+D);for(let i of e)i.setAttribute("aria-selected","false"),i.removeAttribute("aria-label");let t=this.popupObj.element.querySelectorAll("."+E);for(let i of t)i.setAttribute("aria-selected","false"),i.removeAttribute("aria-label")}}updateCalendarElement(e){e.classList.contains(O)?(this.calendarElement=this.leftCalendar,this.currentDate=this.leftCalCurrentDate,this.previousIcon=this.leftCalPrevIcon,this.nextIcon=this.leftCalNextIcon):(this.calendarElement=this.rightCalendar,this.currentDate=this.rightCalCurrentDate,this.previousIcon=this.rightCalPrevIcon,this.nextIcon=this.rightCalNextIcon),this.contentElement=e.querySelector(".e-content"),this.tableBodyElement=Object(s.lb)(".e-content tbody",e),this.table=e.querySelector(".e-content").getElementsByTagName("table")[0],this.headerTitleElement=e.querySelector(".e-header .e-title"),this.headerElement=e.querySelector(".e-header")}navPrevMonth(e){e.preventDefault();let t=Object(s.C)(e.target,"."+O);t=Object(s.X)(t)?Object(s.C)(e.target,"."+x):t,this.updateCalendarElement(t),this.navigatePrevious(e),!Object(s.X)(this.startValue)&&Object(s.X)(this.endValue)&&this.updateMinMaxDays(t),this.updateControl(t)}deviceNavigation(e){this.deviceCalendarEvent(),this.updateRange([this.popupObj.element.querySelector("."+F)]),this.endButton.element.classList.contains(R)&&this.updateMinMaxDays(this.popupObj.element.querySelector("."+F)),this.endButton.element.classList.contains(R)&&this.selectableDates(),this.currentView()===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate()}updateControl(e){e.classList.contains(x)?this.rightCalCurrentDate=new Date(+this.currentDate):this.leftCalCurrentDate=new Date(+this.currentDate),this.calendarIconEvent(),("Month"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-month")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-month")||"Year"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-year")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-year")||"Decade"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-decade")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-decade")||this.isMobile)&&this.bindCalendarCellEvents(),this.removeFocusedDate(),this.updateRange([e])}navNextMonth(e){e.preventDefault();let t=Object(s.C)(e.target,"."+O);t=Object(s.X)(t)?Object(s.C)(e.target,"."+x):t,this.updateCalendarElement(t),this.navigateNext(e),!Object(s.X)(this.startValue)&&Object(s.X)(this.endValue)&&this.updateMinMaxDays(t),this.updateControl(t)}isPopupOpen(){return!(Object(s.X)(this.popupObj)||!this.popupObj.element.classList.contains("e-popup"))}createRangeHeader(){let e=this.createElement("div",{className:"e-start-end"});if(this.isMobile){let t=this.createElement("button",{className:"e-end-btn"}),i=this.createElement("button",{className:"e-start-btn"});this.startButton=new l.a({content:this.l10n.getConstant("startLabel")},i),this.endButton=new l.a({content:this.l10n.getConstant("endLabel")},t),e.appendChild(i),e.appendChild(t)}else{let t=this.createElement("a",{className:"e-start-label"}),i=this.createElement("a",{className:"e-end-label"}),r=this.createElement("span",{className:"e-change-icon e-icons"});Object(s.x)(t,{"aria-atomic":"true","aria-live":"assertive","aria-label":"Start Date",role:"button"}),Object(s.x)(i,{"aria-atomic":"true","aria-live":"assertive","aria-label":"End Date",role:"button"}),e.appendChild(t),e.appendChild(r),e.appendChild(i),t.textContent=this.l10n.getConstant("startLabel"),i.textContent=this.l10n.getConstant("endLabel")}return e}disableInput(){this.strictMode?Object(s.X)(this.previousStartValue)||Object(s.X)(this.previousEndValue)||(this.startValue=this.previousStartValue,this.endValue=this.previousEndValue,this.setValue(),this.updateInput()):(this.updateInput(),this.clearRange(),this.setProperties({startDate:null},!0),this.setProperties({endDate:null},!0),this.startValue=null,this.endValue=null,this.setValue(),this.errorClass()),this.setProperties({enabled:!1},!0),n.c.setEnabled(this.enabled,this.inputElement),this.bindEvents()}validateMinMax(){this.min=Object(s.X)(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=Object(s.X)(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,this.min<=this.max?(Object(s.X)(this.minDays)||Object(s.X)(this.maxDays)||this.maxDays>0&&this.minDays>0&&this.minDays>this.maxDays&&(this.maxDays=null),!Object(s.X)(this.minDays)&&this.minDays<0&&(this.minDays=null),!Object(s.X)(this.maxDays)&&this.maxDays<0&&(this.maxDays=null)):this.disableInput()}validateRangeStrict(){Object(s.X)(this.startValue)||(+this.startValue<=+this.min?(this.startValue=this.min,this.setValue()):+this.startValue>=+this.min&&+this.startValue>=+this.max&&(this.startValue=this.max)),Object(s.X)(this.endValue)||(+this.endValue>+this.max?(this.endValue=this.max,this.setValue()):+this.endValue<+this.min&&(this.endValue=this.min,this.setValue())),this.validateMinMaxDays()}validateRange(){this.validateMinMaxDays()}validateMinMaxDays(){if(!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)){let e=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1;if(!Object(s.X)(this.minDays)&&this.minDays>0&&!(e>=this.minDays))if(this.strictMode){let e=new Date(+this.startValue);e.setDate(e.getDate()+(this.minDays-1)),+e>+this.max?(this.endValue=this.max,this.setValue()):(this.endValue=e,this.setValue())}else this.startValue=null,this.endValue=null,this.setValue();Object(s.X)(this.maxDays)||!(this.maxDays>0)||e<=this.maxDays||(this.strictMode?(this.endValue=new Date(+this.startValue),this.endValue.setDate(this.endValue.getDate()+(this.maxDays-1)),this.setValue()):(this.startValue=null,this.endValue=null,this.setValue()))}}renderCalendar(){this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(F),this.enableRtl&&this.calendarElement.classList.add("e-rtl"),Object(s.x)(this.calendarElement,{role:"calendar"}),super.createHeader(),super.createContent()}isSameMonth(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}isSameYear(e,t){return e.getFullYear()===t.getFullYear()}isSameDecade(e,t){let i=e.getFullYear(),s=t.getFullYear();return i-i%10==s-s%10}startMonthCurrentDate(){this.isSameMonth(this.min,this.max)||+this.currentDate>+this.max||this.isSameMonth(this.currentDate,this.max)?(this.currentDate=new Date(+this.max),this.currentDate.setDate(1),this.currentDate.setMonth(this.currentDate.getMonth()-1)):this.currentDate<this.min&&(this.currentDate=new Date(this.checkValue(this.min)))}selectNextMonth(){if(Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||this.isSameMonth(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue))return this.currentDate.setDate(1),void this.currentDate.setMonth(this.currentDate.getMonth()+1);if(this.currentDate=new Date(+this.endValue),!Object(s.X)(this.startValue)&&+this.startValue<+this.min||!Object(s.X)(this.endValue)&&+this.endValue>+this.max||!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue){this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setDate(1);let e=this.currentDate.getMonth()+1;this.currentDate.setMonth(e)}}selectNextYear(){if(Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||this.isSameYear(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue)){this.currentDate.setMonth(0);let e=this.currentDate.getFullYear()+1;this.currentDate.setFullYear(e)}else this.currentDate=new Date(+this.endValue),(!Object(s.X)(this.endValue)&&+this.endValue>+this.max||!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(s.X)(this.startValue)&&+this.startValue<+this.min)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setMonth(0),this.currentDate.setFullYear(this.currentDate.getFullYear()+1))}selectNextDecade(){if(Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||this.isSameDecade(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue)){let e=this.currentDate.getFullYear()+10;this.currentDate.setFullYear(e)}else this.currentDate=new Date(+this.endValue),(!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(s.X)(this.endValue)&&+this.endValue>+this.max||!Object(s.X)(this.startValue)&&+this.startValue<+this.min)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setFullYear(this.currentDate.getFullYear()+10))}selectStartMonth(){Object(s.X)(this.startValue)?(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.startMonthCurrentDate()):!Object(s.X)(this.max)&&this.isSameMonth(this.startValue,this.max)?(this.currentDate=new Date(+this.max),this.currentDate.setDate(1),this.currentDate.setMonth(this.currentDate.getMonth()-1)):this.currentDate=this.startValue>=this.min&&this.startValue<=this.max&&!this.isDateDisabled(this.startValue)?new Date(+this.startValue):new Date((new Date).setHours(0,0,0,0)),(!Object(s.X)(this.endValue)&&+this.endValue>+this.max||!Object(s.X)(this.startValue)&&+this.startValue<+this.min||!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue)&&+this.startValue>+this.endValue)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0))),this.startMonthCurrentDate()}createCalendar(){let e=this.createElement("div",{className:"e-calendar-container"});if(this.isMobile){Object(s.X)(this.startValue)||(this.currentDate=new Date(+this.startValue)),super.validateDate(),super.minMaxUpdate(),super.render();let t=this.calendarElement.querySelector(".e-calendar .e-prev"),i=this.calendarElement.querySelector(".e-calendar .e-next");Object(s.hb)(this.calendarElement.querySelector(".e-calendar .e-icon-container")),this.calendarElement.querySelector(".e-calendar .e-header").appendChild(i),this.calendarElement.querySelector(".e-calendar .e-header").appendChild(t),Object(s.fb)([t],this.calendarElement.querySelector(".e-calendar .e-header")),this.deviceCalendar=this.calendarElement,e.appendChild(this.calendarElement),this.headerTitleElement=this.calendarElement.querySelector(".e-calendar .e-header .e-title")}else{this.selectStartMonth(),this.renderCalendar(),this.leftCalCurrentDate=new Date(+this.currentDate),this.calendarElement.classList.add(O),this.leftCalPrevIcon=this.calendarElement.querySelector(".e-left-calendar .e-prev"),this.leftCalNextIcon=this.calendarElement.querySelector(".e-left-calendar .e-next"),this.leftTitle=this.calendarElement.querySelector(".e-left-calendar .e-title"),Object(s.hb)(this.calendarElement.querySelector(".e-left-calendar .e-icon-container")),this.calendarElement.querySelector(".e-left-calendar .e-header").appendChild(this.leftCalNextIcon),this.calendarElement.querySelector(".e-left-calendar .e-header").appendChild(this.leftCalPrevIcon),Object(s.fb)([this.leftCalPrevIcon],this.calendarElement.querySelector(".e-left-calendar .e-header")),this.leftCalendar=this.calendarElement;let t=this.createElement("div",{className:"e-left-container"}),i=this.createElement("div",{className:"e-right-container"});t.appendChild(this.leftCalendar),e.appendChild(t),this.isMobile||s.l.add(this.leftTitle,"click",this.leftNavTitle,this),"Month"===this.start&&this.selectNextMonth(),"Year"===this.start&&this.selectNextYear(),"Decade"===this.start&&this.selectNextDecade(),this.renderCalendar(),this.rightCalCurrentDate=new Date(+this.currentDate),Object(s.v)([this.calendarElement],x),this.rightCalendar=this.calendarElement,Object(s.ib)([this.leftCalendar&&this.leftCalendar.querySelector(".e-content tbody")],"e-zoomin"),Object(s.ib)([this.rightCalendar&&this.rightCalendar.querySelector(".e-content tbody")],"e-zoomin"),this.rightCalPrevIcon=this.calendarElement.querySelector(".e-right-calendar .e-prev"),this.rightCalNextIcon=this.calendarElement.querySelector(".e-right-calendar .e-next"),this.rightTitle=this.calendarElement.querySelector(".e-right-calendar .e-title"),Object(s.hb)(this.calendarElement.querySelector(".e-right-calendar .e-icon-container")),this.calendarElement.querySelector("table").setAttribute("tabindex","-1"),this.calendarElement.querySelector(".e-right-calendar .e-header").appendChild(this.rightCalNextIcon),this.calendarElement.querySelector(".e-right-calendar .e-header").appendChild(this.rightCalPrevIcon),Object(s.fb)([this.rightCalPrevIcon],this.calendarElement.querySelector(".e-right-calendar .e-header")),i.appendChild(this.rightCalendar),e.appendChild(i),this.isMobile||s.l.add(this.rightTitle,"click",this.rightNavTitle,this)}return e}leftNavTitle(e){this.isPopupOpen()&&(this.calendarElement=this.leftCalendar,this.calendarNavigation(e,this.calendarElement))}calendarNavigation(e,t){this.table=t.querySelector("table"),this.headerTitleElement=t.querySelector(".e-title"),this.tableBodyElement=t.querySelector("tbody"),this.tableHeadElement=t.querySelector("thead"),this.contentElement=t.querySelector(".e-content"),this.updateCalendarElement(t),super.navigateTitle(e),this.updateNavIcons()}rightNavTitle(e){this.isPopupOpen()&&(this.calendarElement=this.rightCalendar,this.calendarNavigation(e,this.calendarElement))}clickEventEmitter(e){this.isMobile||(Object(s.C)(e.target,".e-calendar.e-left-calendar")?(this.calendarElement=this.leftCalendar,this.updateCalendarElement(this.leftCalendar)):(this.calendarElement=this.rightCalendar,this.updateCalendarElement(this.rightCalendar)))}currentView(){return super.currentView()}getCalendarView(e){return"Year"===e?"Year":"Decade"===e?"Decade":"Month"}navigatedEvent(e){if(this.trigger("navigated",this.navigatedArgs),!Object(s.X)(this.popupObj)){let t,i=this.getCalendarView(this.currentView());this.isMobile?i===this.depth?(this.bindCalendarCellEvents(),this.deviceNavigation(),this.removeFocusedDate(),this.checkMinMaxDays()):this.selectableDates():this.isMobile||i!==this.depth?(this.updateNavIcons(),this.calendarIconEvent()):(t=this.calendarElement.classList.contains("e-left-calendar")?this.leftCalendar:this.rightCalendar,t!==this.leftCalendar||(!e||e.currentTarget.children[0].classList.contains("e-icons"))&&Object(s.X)(this.controlDown)?(e&&!e.currentTarget.children[0].classList.contains("e-icons")||!Object(s.X)(this.controlDown))&&(this.rightCalCurrentDate=new Date(+this.currentDate),this.effect="",this.currentDate=this.rightCalCurrentDate,this.updateCalendarElement(this.rightCalendar),this.updateControl(this.rightCalendar),this.updateCalendarElement(this.leftCalendar),this.startValue&&Object(s.X)(this.endValue)&&("Month"===i&&this.startValue.getMonth()<this.rightCalCurrentDate.getMonth()&&this.startValue.getFullYear()<=this.rightCalCurrentDate.getFullYear()||"Year"===i&&this.startValue.getFullYear()<this.rightCalCurrentDate.getFullYear())?super.navigateTo.call(this,i,new Date(+this.startValue)):super.navigateTo.call(this,i,this.leftCalCurrentDate),this.updateControl(this.leftCalendar),this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.controlDown=null):(this.leftCalCurrentDate=new Date(+this.currentDate),this.effect="",this.currentDate=this.leftCalCurrentDate,this.updateCalendarElement(this.leftCalendar),this.updateControl(this.leftCalendar),this.updateCalendarElement(this.rightCalendar),super.navigateTo.call(this,i,this.rightCalCurrentDate),this.updateControl(this.rightCalendar),this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.controlDown=null),this.checkMinMaxDays())}}createControl(){let e=this.createElement("div",{className:"e-date-range-container"}),t=this.createElement("div",{className:"e-range-header"}),i=this.createRangeHeader();t.appendChild(i);let r=this.createElement("div",{className:k});Object(s.x)(r,{"aria-label":"Selected Days"}),r.textContent=this.l10n.getConstant("selectedDays"),t.appendChild(r);let n=this.createElement("div",{className:"e-separator"}),a=this.createCalendar();e.appendChild(t),e.appendChild(n),e.appendChild(a);let o=this.createElement("div",{className:"e-footer"}),h=this.createElement("button",{className:"e-cancel e-flat e-css"}),d=this.createElement("button");Object(s.v)([d],["e-apply","e-flat","e-primary","e-css"]),o.appendChild(d),o.appendChild(h);let c=!Object(s.X)(this.startValue)&&!Object(s.X)(this.endValue);this.cancelButton=new l.a({content:this.l10n.getConstant("cancelText")},h),this.applyButton=new l.a({content:this.l10n.getConstant("applyText"),disabled:!c},d),s.l.add(d,"click",this.applyFunction,this),s.l.add(h,"click",this.cancelFunction,this),this.popupWrapper.appendChild(e),this.isMobile||Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||(this.createPresets(),this.listRippleEffect(),Object(s.v)([e],"e-range-border"),Object(s.v)([this.popupWrapper],"e-preset-wrapper"),this.popupWrapper.querySelector(".e-presets").style.height=this.popupWrapper.querySelector(".e-date-range-container").getBoundingClientRect().height+"px"),this.popupWrapper.appendChild(o),this.isMobile&&this.deviceHeaderUpdate(),this.renderPopup()}cancelFunction(e){document.activeElement!==this.inputElement&&(this.preventFocus=!0,this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"])),e.preventDefault(),this.isKeyPopup&&(this.inputElement.focus(),this.isKeyPopup=!1),this.startValue=null,this.endValue=null,this.removeSelection(),this.hide(e)}deviceHeaderUpdate(){Object(s.X)(this.startValue)&&Object(s.X)(this.endValue)?(this.endButton.element.setAttribute("disabled",""),this.startButton.element.classList.add(R)):Object(s.X)(this.startValue)||this.startButton.element.classList.add(R)}applyFunction(e){let t=!1;"touchstart"!==e.type&&e.preventDefault(),this.closeEventArgs&&this.closeEventArgs.cancel&&(this.startValue=this.popupWrapper.querySelector(".e-start-date")&&this.getIdValue(null,this.popupWrapper.querySelector(".e-start-date")),this.endValue=this.popupWrapper.querySelector(".e-end-date")&&this.getIdValue(null,this.popupWrapper.querySelector(".e-end-date")),this.setValue()),document.activeElement!==this.inputElement&&(this.preventFocus=!0,this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"])),"touchstart"!==e.type&&this.closeEventArgs&&!this.closeEventArgs.cancel&&e.preventDefault(),Object(s.X)(this.startValue)||Object(s.X)(this.endValue)?this.hide(e||null):(this.previousStartValue=new Date(+this.startValue),this.previousEndValue=new Date(+this.endValue),this.previousEleValue=this.inputElement.value,n.c.setValue(this.rangeArgs(e).text,this.inputElement,this.floatLabelType,this.showClearButton),+this.initStartDate==+this.startValue&&+this.initEndDate==+this.endValue||(t=!0),this.changeTrigger(e),this.hide(e||null),this.errorClass(),t=!0),Object(s.C)(e.target,".e-input-group")||t||this.focusOut(),this.isMobile||(this.isKeyPopup=!1,this.isRangeIconClicked&&(this.inputWrapper.container.children[1].focus(),this.keyInputConfigs=Object(s.K)(this.keyInputConfigs,this.keyConfigs),this.popupKeyboardModule=new s.o(this.inputWrapper.container.children[1],{eventName:"keydown",keyConfigs:this.keyInputConfigs,keyAction:this.popupKeyActionHandle.bind(this)})))}onMouseClick(e,t){if("touchstart"===e.type)return;let i=t||e.target,r=Object(s.C)(i,"."+B),n=r&&r.classList.contains(R);r&&r.classList.contains(B)&&this.setListSelection(r,e),this.inputElement.focus(),this.isMobile||(this.preventFocus=!0,r&&r.classList.contains(B)&&"custom_range"===r.getAttribute("id")?this.leftCalendar.children[1].firstElementChild.focus():n||"keydown"!==e.type||this.inputElement.focus())}onMouseOver(e){let t=Object(s.C)(e.target,"."+B);t&&t.classList.contains(B)&&!t.classList.contains(P)&&Object(s.v)([t],P)}onMouseLeave(e){let t=Object(s.C)(e.target,"."+P);Object(s.X)(t)||Object(s.ib)([t],P)}setListSelection(e,t){if(e&&(!e.classList.contains(R)||this.isMobile&&e.classList.contains(R))){if(this.isMobile&&e.classList.contains(R))return this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),"custom_range"===this.presetsItem[this.activeIndex].id?void this.renderCustomPopup():void 0;this.removeListSelection(),this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),Object(s.v)([e],R),e.setAttribute("aria-selected","true");let i=this.presetsItem[this.activeIndex];"custom_range"===i.id?this.renderCustomPopup():this.applyPresetRange(i,t)}}removeListSelection(){let e=this.presetElement.querySelector(".e-active");Object(s.X)(e)||(Object(s.ib)([e],R),e.removeAttribute("aria-selected"))}setValue(){this.modelValue=[this.startValue,this.endValue]}applyPresetRange(e,t){this.hide(null),this.presetsItem[this.presetsItem.length-1].start=null,this.presetsItem[this.presetsItem.length-1].end=null,this.startValue=e.start,this.endValue=e.end,this.setValue(),this.refreshControl(),this.trigger("select",this.rangeArgs(t)),this.changeTrigger(t),this.previousEleValue=this.inputElement.value,this.isCustomRange=!1,this.leftCalendar=this.rightCalendar=null,this.isKeyPopup&&(this.isRangeIconClicked=!1,this.inputElement.focus())}showPopup(e,t){this.presetHeight(),this.popupObj.show(null,1e3===this.zIndex?this.element:null),this.isMobile&&this.popupObj.refreshPosition()}renderCustomPopup(){this.isCustomWindow=!0,this.popupObj.hide(),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:j+" e-popup"}),this.renderControl(),this.openEventArgs.appendTo.appendChild(this.popupWrapper),this.showPopup(),this.isCustomRange=!0,this.isMobile||this.calendarFocus()}listRippleEffect(){for(let e of this.liCollections)Object(s.kb)(e)}createPresets(){if(!Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)){this.presetElement=this.createElement("div",{className:"e-presets",attrs:{tabindex:"0"}});let e=a.a.createList(this.createElement,this.presetsItem,null,!0);Object(s.x)(e,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),this.presetElement.appendChild(e),this.popupWrapper.appendChild(this.presetElement);let t=this.presetElement.querySelector("#custom_range");Object(s.X)(t)||(t.textContent=""!==this.l10n.getConstant("customRange")?this.l10n.getConstant("customRange"):"Custom Range"),this.liCollections=this.presetElement.querySelectorAll("."+B),this.wireListEvents(),this.isMobile&&(this.presetElement.style.width=this.inputWrapper.container.getBoundingClientRect().width+"px"),!Object(s.X)(this.activeIndex)&&this.activeIndex>-1&&Object(s.v)([this.liCollections[this.activeIndex]],R)}}wireListEvents(){s.l.add(this.presetElement,"click",this.onMouseClick,this),this.isMobile||(s.l.add(this.presetElement,"mouseover",this.onMouseOver,this),s.l.add(this.presetElement,"mouseout",this.onMouseLeave,this))}unWireListEvents(){Object(s.X)(this.presetElement)||(s.l.remove(this.presetElement,"click touchstart",this.onMouseClick),this.isMobile||(s.l.remove(this.presetElement,"mouseover",this.onMouseOver),s.l.remove(this.presetElement,"mouseout",this.onMouseLeave)))}renderPopup(){this.popupWrapper.classList.add("e-control");let e=this.popupWrapper.getBoundingClientRect().width;Object(s.X)(this.cssClass)||""===this.cssClass.trim()||(this.popupWrapper.className+=" "+this.cssClass),this.isMobile&&this.isCustomWindow&&(this.modal=this.createElement("div"),document.body.appendChild(this.modal)),this.popupObj=new r.c(this.popupWrapper,{relateTo:this.isMobile&&this.isCustomWindow?document.body:Object(s.X)(this.targetElement)?this.inputWrapper.container:this.targetElement,position:this.isMobile?Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||this.isCustomWindow?{X:"center",Y:"center"}:{X:"left",Y:"bottom"}:this.enableRtl?{X:"left",Y:"bottom"}:{X:"right",Y:"bottom"},offsetX:this.isMobile||this.enableRtl?0:-e,offsetY:4,collision:this.isMobile?Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||this.isCustomWindow?{X:"fit",Y:"fit"}:{X:"fit"}:{X:"fit",Y:"flip"},targetType:this.isMobile&&this.isCustomWindow?"container":"relative",enableRtl:this.enableRtl,zIndex:this.zIndex,open:()=>{Object(s.x)(this.inputElement,{"aria-expanded":"true"}),Object(s.v)([this.inputWrapper.buttons[0]],R),this.isMobile||(this.cancelButton&&(this.btnKeyboardModule=new s.o(this.cancelButton.element,{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:{tab:"tab",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}}),this.btnKeyboardModule=new s.o(this.applyButton.element,{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:{altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}})),Object(s.X)(this.leftCalendar)||this.isRangeIconClicked||this.calendarFocus(),Object(s.X)(this.presetElement)||(this.keyInputConfigs=Object(s.K)(this.keyInputConfigs,this.keyConfigs),this.presetKeyboardModule=new s.o(this.presetElement,{eventName:"keydown",keyAction:this.presetKeyActionHandler.bind(this),keyConfigs:this.keyInputConfigs}),this.presetKeyboardModule=new s.o(this.presetElement,{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:{altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}}),Object(s.X)(this.leftCalendar)?(this.preventBlur=!0,this.presetElement.focus()):this.presetElement.setAttribute("tabindex","-1")),this.popupKeyBoardHandler()),this.isMobile&&!s.d.isDevice&&s.l.add(document,"keydown",this.popupCloseHandler,this)},close:()=>{Object(s.x)(this.inputElement,{"aria-expanded":"false"}),Object(s.ib)([this.inputWrapper.buttons[0]],R),this.isRangeIconClicked&&this.inputWrapper.container.children[1].focus(),Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||this.unWireListEvents(),Object(s.X)(this.popupObj)||(Object(s.X)(this.popupObj.element.parentElement)||Object(s.I)(this.popupObj.element),this.popupObj.destroy(),this.popupObj=null),this.isMobile&&!s.d.isDevice&&s.l.remove(document,"keydown",this.popupCloseHandler)},targetExitViewport:()=>{s.d.isDevice||this.hide()}}),this.isMobile&&(this.popupObj.element.classList.add("e-device"),this.isMobile||this.popupObj.element.classList.add("e-bigger")),this.isMobile&&this.isCustomWindow&&(Object(s.v)([this.modal],["e-device",j,"e-range-modal"]),document.body.className+=" e-range-overflow",this.modal.style.display="block"),s.l.add(document,"mousedown touchstart",this.documentHandler,this)}popupCloseHandler(e){switch(e.keyCode){case 27:this.hide(e)}}calendarFocus(){let e=this.popupObj&&this.popupObj.element.querySelector("."+D);if(e){let t=Object(s.C)(e,"."+x);t=Object(s.X)(t)?this.leftCalendar:t,this.isRangeIconClicked?this.inputWrapper.container.focus():(this.preventBlur=!0,t.children[1].firstElementChild.focus()),Object(s.v)([e],T)}else this.isRangeIconClicked?this.inputWrapper.container.focus():(this.preventBlur=!0,this.leftCalendar.children[1].firstElementChild.focus())}presetHeight(){let e=this.popupObj&&this.popupObj.element.querySelector(".e-presets"),t=this.popupObj&&this.popupObj.element.querySelector(".e-date-range-container");Object(s.X)(e)||Object(s.X)(t)||(e.style.height=t.getBoundingClientRect().height+"px")}presetKeyActionHandler(e){switch(e.action){case"moveDown":this.listMoveDown(e),this.setScrollPosition(),e.preventDefault();break;case"moveUp":this.listMoveUp(e),this.setScrollPosition(),e.preventDefault();break;case"enter":let t=this.getHoverLI(),i=this.getActiveLI();if(!Object(s.X)(this.leftCalendar)&&!Object(s.X)(i)&&(Object(s.X)(t)||!Object(s.X)(i)&&i===t)&&(this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(i),"custom_range"===this.presetsItem[this.activeIndex].id))return this.calendarFocus(),i.classList.remove(P),void e.preventDefault();Object(s.X)(t)&&Object(s.X)(i)||this.onMouseClick(e,t||i),e.preventDefault();break;case"tab":if(this.leftCalendar){let e=this.getHoverLI();Object(s.X)(e)||e.classList.remove(P)}else this.hide(e),e.preventDefault()}}listMoveDown(e){let t=this.getHoverLI(),i=this.getActiveLI();if(Object(s.X)(t))if(Object(s.X)(i))Object(s.v)([this.liCollections[0]],P);else{let e=i.nextElementSibling;!Object(s.X)(e)&&e.classList.contains(B)&&Object(s.v)([e],P)}else{let e=t.nextElementSibling;!Object(s.X)(e)&&e.classList.contains(B)&&(Object(s.ib)([t],P),Object(s.v)([e],P))}}listMoveUp(e){let t=this.getHoverLI(),i=this.getActiveLI();if(Object(s.X)(t)){if(!Object(s.X)(i)){let e=i.previousElementSibling;!Object(s.X)(e)&&e.classList.contains(B)&&Object(s.v)([e],P)}}else{let e=t.previousElementSibling;!Object(s.X)(e)&&e.classList.contains(B)&&(Object(s.ib)([t],P),Object(s.v)([e],P))}}getHoverLI(){return this.presetElement.querySelector("."+P)}getActiveLI(){return this.presetElement.querySelector(".e-active")}popupKeyBoardHandler(){this.popupKeyboardModule=new s.o(this.popupWrapper,{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:{escape:"escape"}}),this.keyInputConfigs=Object(s.K)(this.keyInputConfigs,this.keyConfigs),this.popupKeyboardModule=new s.o(this.inputWrapper.container.children[1],{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:this.keyInputConfigs})}setScrollPosition(){let e=this.presetElement.getBoundingClientRect().height,t=this.presetElement.querySelector("."+P),i=this.presetElement.querySelector(".e-active"),r=Object(s.X)(t)?i:t;if(!Object(s.X)(r)){let t=r.nextElementSibling,i=t?t.offsetTop:r.offsetTop,s=r.getBoundingClientRect().height;this.presetElement.scrollTop=i+r.offsetTop>e?t?i-(e/2+s/2):i:0}}popupKeyActionHandle(e){let t=Object(s.C)(e.target,".e-presets");switch(e.action){case"escape":this.isPopupOpen()?(this.isKeyPopup&&(this.inputElement.focus(),this.isKeyPopup=!1),this.hide(e)):this.inputWrapper.container.children[1].blur();break;case"enter":this.isPopupOpen()?this.inputWrapper.container.children[1].focus():this.show(null,e);break;case"tab":this.hide(e);break;case"altRightArrow":Object(s.X)(t)?document.activeElement===this.cancelButton.element&&!0!==this.applyButton.element.disabled?this.applyButton.element.focus():this.leftCalendar.children[1].firstElementChild.focus():this.cancelButton.element.focus(),e.preventDefault();break;case"altLeftArrow":Object(s.X)(t)?document.activeElement===this.applyButton.element&&!0!==this.applyButton.element.disabled?this.cancelButton.element.focus():Object(s.X)(this.presetElement)||document.activeElement!==this.cancelButton.element?this.rightCalendar.children[1].firstElementChild.focus():this.presetElement.focus():this.rightCalendar.children[1].firstElementChild.focus(),e.preventDefault()}}documentHandler(e){if(Object(s.X)(this.popupObj))return;let t=e.target;this.inputWrapper.container.contains(t)&&(Object(s.X)(this.popupObj)||Object(s.C)(t,'[id="'+this.popupWrapper.id+'"]'))||"touchstart"!==e.type&&("mousedown"===e.type||this.closeEventArgs&&!this.closeEventArgs.cancel)&&e.preventDefault(),!Object(s.X)(this.targetElement)&&(Object(s.X)(this.targetElement)||t===this.targetElement)||Object(s.C)(t,'[id="'+this.popupWrapper.id+'"]')||Object(s.C)(t,".e-input-group")===this.inputWrapper.container||Object(s.C)(t,".e-daterangepicker.e-popup")&&!t.classList.contains("e-day")||(this.preventBlur=!1,this.isPopupOpen()&&document.body.contains(this.popupObj.element)&&(this.applyFunction(e),this.isMobile||(this.isRangeIconClicked=!1)))}createInput(){let e=this.cssClass;Object(s.X)(this.cssClass)||""===this.cssClass||(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=n.c.createInput({floatLabelType:this.floatLabelType,element:this.inputElement,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:["e-input-group-icon e-range-icon e-icons"]},this.createElement),Object(s.x)(this.inputElement,{"aria-readonly":this.readonly?"true":"false",tabindex:"0","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_popup","aria-expanded":"false",role:"combobox",autocomplete:"off","aria-disabled":this.enabled?"false":"true",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),n.c.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),Object(s.X)(this.placeholder)||""===this.placeholder.trim()||n.c.addAttributes({"aria-placeholder":this.placeholder},this.inputElement),this.setEleWidth(this.width),Object(s.v)([this.inputWrapper.container],"e-date-range-wrapper"),Object(s.X)(this.inputElement.getAttribute("name"))&&Object(s.x)(this.inputElement,{name:this.element.id}),"hidden"===this.inputElement.type&&(this.inputWrapper.container.style.display="none"),this.refreshControl(),this.previousEleValue=this.inputElement.value,this.inputElement.setAttribute("value",this.inputElement.value),this.startCopy=this.startDate,this.endCopy=this.endDate}setEleWidth(e){this.inputWrapper.container.style.width="string"==typeof e?this.width:"number"==typeof e?Object(s.L)(this.width):"100%"}adjustLongHeaderWidth(){"Wide"===this.dayHeaderFormat&&Object(s.v)([this.popupWrapper],"e-daterange-day-header-lg")}refreshControl(){this.validateMinMax(),this.strictMode&&this.validateRangeStrict();let e=this.disabledDates();this.strictMode&&e&&(this.startValue=this.previousStartValue,this.setProperties({startDate:this.startValue},!0),this.endValue=this.previousEndValue,this.setProperties({endDate:this.endValue},!0),this.setValue()),this.updateInput(),this.strictMode||this.validateRange(),!this.strictMode&&e&&this.clearRange(),Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||e||this.disabledDateRender(),this.errorClass(),this.previousStartValue=Object(s.X)(this.startValue)||isNaN(+this.startValue)?null:new Date(+this.startValue),this.previousEndValue=Object(s.X)(this.endValue)||isNaN(+this.endValue)?null:new Date(+this.endValue)}updateInput(){if(!Object(s.X)(this.endValue)&&!Object(s.X)(this.startValue)){let e={format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"},t=this.globalize.formatDate(this.startValue,e),i=this.globalize.formatDate(this.endValue,e);n.c.setValue(t+" "+this.separator+" "+i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousStartValue=new Date(+this.startValue),this.previousEndValue=new Date(+this.endValue)}!this.strictMode&&Object(s.X)(this.value)&&this.invalidValueString&&n.c.setValue(this.invalidValueString,this.inputElement,this.floatLabelType,this.showClearButton)}checkInvalidRange(e){if(!Object(s.X)(e)){let t,i,r=!1,n=null,l=null,a=null,o=!1,h=!1,d=!1;if("string"==typeof e){let t=e.split(" "+this.separator+" ");2===t.length?(n=t[0],l=t[1]):(r=!0,a=e)}else e.length>0?(t=e[0],i=e[1]):(t=e.start,i=e.end),t instanceof Date||"object"==typeof t?t instanceof Date?o=!0:Object(s.X)(t)||(d=!0):n=this.getstringvalue(t),i instanceof Date||"object"==typeof i?i instanceof Date?h=!0:Object(s.X)(i)||(d=!0):l=this.getstringvalue(i);(Object(s.X)(n)&&!o&&!Object(s.X)(l)||!Object(s.X)(n)&&!h&&Object(s.X)(l))&&(r=!0),d&&(n=l=a=null,r=!0),n&&(r=r||this.checkInvalidValue(n)),l&&(r=r||this.checkInvalidValue(l)),r&&(o&&!d&&(n=t.toLocaleDateString()),h&&!d&&(l=i.toLocaleDateString()),Object(s.X)(n)||Object(s.X)(l)?Object(s.X)(n)?Object(s.X)(l)||(a=l):a=n:a=n+" "+this.separator+" "+l,this.invalidValueString=a,this.setProperties({value:null},!0),this.setProperties({startValue:null},!0),this.setProperties({endValue:null},!0),this.startDate=null,this.endDate=null)}}getstringvalue(e){let t=null;return Object(s.X)(e)||"number"!=typeof e?Object(s.X)(e)||"string"!=typeof e||(t=""+e):t=e.toString(),t}checkInvalidValue(e){let t=e,i=!1,r=null;if(r={format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"},"string"!=typeof t)i=!0;else{let e=new s.n(this.locale);if(!this.checkDateValue(e.parseDate(t,r))){let e=null,s=null;e=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,(!e.test(t)&&!s.test(t)||/^[a-zA-Z0-9- ]*$/.test(t)||isNaN(+new Date(this.checkValue(t))))&&(i=!0)}}return i}isDateDisabled(e){if(Object(s.X)(e))return!1;let t=new Date(+e);if(+t<+this.min||+t>+this.max)return!0;this.virtualRenderCellArgs={date:t,isDisabled:!1};let i=this.virtualRenderCellArgs;return this.virtualRenderCellEvent(i),!!i.isDisabled}disabledDateRender(){this.disabledDays=[],this.disabledDayCnt=null;let e=new Date(+this.startValue),t=0;for(;+e<=+this.endValue;){this.virtualRenderCellArgs={date:e,isDisabled:!1};let i=this.virtualRenderCellArgs;this.virtualRenderCellEvent(i),i.isDisabled&&(this.disabledDays.push(new Date(+i.date)),+e>+this.startValue&&+e<+this.endValue&&t++),this.addDay(e,1,null,this.max,this.min)}this.disabledDayCnt=t}virtualRenderCellEvent(e){Object(s.K)(this.virtualRenderCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)}disabledDates(){let e=!1,t=!1;return Object(s.X)(this.endValue)||Object(s.X)(this.startValue)||(e=this.isDateDisabled(this.startValue),t=this.isDateDisabled(this.endValue),this.isPopupOpen()||(this.currentDate=null),this.setValue()),e||t}setModelValue(){this.value||null!==this.startDate||null!==this.endDate?null===this.value||null===this.value.start?null===this.value?this.setProperties({value:[this.startDate,this.endDate]},!0):null===this.value.start&&this.setProperties({value:{start:this.startDate,end:this.endDate}},!0):this.value&&this.value.length>0||this.valueType&&this.valueType.length>0?(+this.startDate==+this.value[0]&&+this.endDate==+this.value[1]||this.setProperties({value:[this.startDate,this.endDate]},!0),this.value&&null==this.value[0]&&null==this.value[1]&&this.setProperties({value:null},!0)):this.value&&this.value.start&&this.setProperties({value:{start:this.startDate,end:this.endDate}},!0):this.setProperties({value:null},!0),this.createHiddenInput()}dispatchEvent(e,t){let i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0),e.dispatchEvent(i),this.firstHiddenChild.dispatchEvent(i)}changeTrigger(e){+this.initStartDate==+this.startValue&&+this.initEndDate==+this.endValue||(this.setProperties({endDate:this.checkDateValue(this.endValue)},!0),this.setProperties({startDate:this.checkDateValue(this.startValue)},!0),this.setModelValue(),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.rangeArgs(e))),this.previousEleValue=this.inputElement.value,this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue)}navigateTo(e,t){if(this.isPopupOpen()){if("month"===e.toLowerCase())e="Month";else if("year"===e.toLowerCase())e="Year";else{if("decade"!==e.toLowerCase())return;e="Decade"}this.getViewNumber(e)<this.getViewNumber(this.depth)&&(e=this.depth),this.isMobile?super.navigateTo.call(this,e,t):(t<this.min?t=new Date(+this.min):t>=this.max&&(t=new Date(+this.max)),"Month"===e&&this.isSameMonth(t,this.max)?t=new Date(this.max.getFullYear(),this.max.getMonth()-1,this.min.getDate()):"Year"===e&&this.isSameYear(t,this.max)?t=new Date(this.max.getFullYear()-1,this.max.getMonth(),this.max.getDate()):"Decade"===e&&this.isSameDecade(t,this.max)&&(t=new Date(this.max.getFullYear()-10,this.max.getMonth(),this.max.getDate())),this.leftCalCurrentDate=t,this.navigate(this.leftCalendar,this.leftCalCurrentDate,e),t="Month"===e?new Date(this.currentDate.setMonth(this.currentDate.getMonth()+1)):"Year"===e?new Date(this.currentDate.setFullYear(this.currentDate.getFullYear()+1)):new Date(this.currentDate.setFullYear(this.currentDate.getFullYear()+10)),this.rightCalCurrentDate=t,this.navigate(this.rightCalendar,this.rightCalCurrentDate,e),this.leftKeyboardModule=this.rightKeyboardModule=null,this.updateNavIcons()),this.currentView()===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate(),this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar])}}navigate(e,t,i){this.calendarElement=e,this.table=e.querySelector("table"),this.tableBodyElement=e.querySelector("tbody"),this.headerTitleElement=e.querySelector(".e-title"),this.tableHeadElement=e.querySelector("thead"),this.contentElement=e.querySelector(".e-content"),this.previousIcon=e.querySelector(".e-prev"),this.nextIcon=e.querySelector(".e-next"),this.effect="e-zoomin",super.navigateTo.call(this,i,t)}focusIn(){document.activeElement!==this.inputElement&&this.enabled&&(Object(s.v)([this.inputWrapper.container],["e-input-focus"]),this.inputElement.focus())}focusOut(){let e=this.preventBlur;document.activeElement===this.inputElement&&(Object(s.ib)([this.inputWrapper.container],["e-input-focus"]),this.preventBlur=!1,this.inputElement.blur(),this.preventBlur=e)}destroy(){this.unBindEvents(),this.hide(null);let e={"aria-readonly":this.readonly?"true":"false",tabindex:"0","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_popup","aria-expanded":"false",role:"combobox",autocomplete:"off","aria-disabled":this.enabled?"false":"true",autocorrect:"off",autocapitalize:"off","aria-invalid":"false",spellcheck:"false"};this.inputElement&&(Object(s.ib)([this.inputElement],[j]),s.l.remove(this.inputElement,"blur",this.inputBlurHandler),n.c.removeAttributes(e,this.inputElement),Object(s.X)(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.inputElement.classList.remove("e-input"),Object(s.X)(this.inputWrapper)||(s.l.remove(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler),null===this.angularTag&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),Object(s.I)(this.inputWrapper.container))),Object(s.X)(this.inputKeyboardModule)||this.isMobile||this.inputKeyboardModule.destroy(),this.popupObj&&(this.isMobile||this.clearCalendarEvents()),super.destroy(),this.inputWrapper=this.popupWrapper=this.popupObj=this.cloneElement=this.presetElement=null,this.formElement&&s.l.remove(this.formElement,"reset",this.formResetHandler),Object(s.X)(this.firstHiddenChild)||Object(s.X)(this.secondHiddenChild)||(Object(s.I)(this.firstHiddenChild),Object(s.I)(this.secondHiddenChild),this.firstHiddenChild=this.secondHiddenChild=null,this.inputElement.setAttribute("name",this.element.getAttribute("data-name")),this.inputElement.removeAttribute("data-name"))}ensureInputAttribute(){let e=[];for(let t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(let t=0;t<e.length;t++)Object(s.X)(this.cloneElement.getAttribute(e[t]))?("value"===e[t].toLowerCase()&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[t])):("value"===e[t].toLowerCase()&&(this.inputElement.value=this.cloneElement.getAttribute(e[t])),this.inputElement.setAttribute(e[t],this.cloneElement.getAttribute(e[t])))}getModuleName(){return"daterangepicker"}getPersistData(){return this.addOnPersist(["startDate","endDate","value"])}getSelectedRange(){let e;return Object(s.X)(this.startValue)||Object(s.X)(this.endValue)?e=0:(e=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1,this.disabledDateRender(),Object(s.X)(this.disabledDayCnt)||(e-=this.disabledDayCnt,this.disabledDayCnt=null)),{startDate:this.startValue,endDate:this.endValue,daySpan:e}}show(e,t){this.isMobile&&this.popupObj&&this.popupObj.refreshPosition(),this.enabled&&this.readonly||!this.enabled||this.popupObj||this.isPopupOpen()||(e&&(this.targetElement=e),this.createPopup(),(this.isMobile||s.d.isDevice)&&(this.mobileRangePopupWrap=this.createElement("div",{className:"e-daterangepick-mob-popup-wrap"}),document.body.appendChild(this.mobileRangePopupWrap)),this.openEventArgs={popup:Object(s.W)()&&this.isServerRendered?null:this.popupObj||null,cancel:!1,date:this.inputElement.value,model:Object(s.W)()&&this.isServerRendered?null:this,event:t||null,appendTo:this.isMobile||s.d.isDevice?this.mobileRangePopupWrap:document.body},this.trigger("open",this.openEventArgs,i=>{if(this.openEventArgs=i,!this.openEventArgs.cancel){this.openEventArgs.appendTo.appendChild(this.popupWrapper),this.showPopup(e,t);let i=!this.isCustomRange||this.isMobile&&this.isCustomRange;!Object(s.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)&&i&&this.setScrollPosition(),this.checkMinMaxDays(),this.isMobile&&!Object(s.X)(this.startDate)&&Object(s.X)(this.endDate)&&(this.endButton.element.classList.add(R),this.startButton.element.classList.remove(R),this.endButton.element.removeAttribute("disabled"),this.selectableDates()),super.setOverlayIndex(this.mobileRangePopupWrap,this.popupObj.element,this.modal,this.isMobile||s.d.isDevice)}}))}hide(e){this.popupObj?(Object(s.X)(this.previousEndValue)&&Object(s.X)(this.previousStartValue)?this.clearRange():(Object(s.X)(this.previousStartValue)?(this.startValue=null,this.setValue()):(this.startValue=new Date(this.checkValue(this.previousStartValue)),this.setValue(),this.currentDate=new Date(this.checkValue(this.startValue))),Object(s.X)(this.previousEndValue)?(this.endValue=null,this.setValue()):(this.endValue=new Date(this.checkValue(this.previousEndValue)),this.setValue())),this.isPopupOpen()&&(this.closeEventArgs={cancel:!1,popup:Object(s.W)()&&this.isServerRendered?null:this.popupObj,date:this.inputElement.value,model:Object(s.W)()&&this.isServerRendered?null:this,event:e||null},this.trigger("close",this.closeEventArgs,e=>{this.closeEventArgs=e,this.closeEventArgs.cancel?Object(s.ib)([this.inputWrapper.buttons[0]],R):(this.isMobile&&(Object(s.X)(this.startButton)||Object(s.X)(this.endButton)||(s.l.remove(this.startButton.element,"click touchstart",this.deviceHeaderClick),s.l.remove(this.endButton.element,"click touchstart",this.deviceHeaderClick))),this.popupObj&&(this.popupObj.hide(),this.preventBlur&&(this.inputElement.focus(),Object(s.v)([this.inputWrapper.container],["e-input-focus"]))),this.isMobile||(Object(s.X)(this.leftKeyboardModule)||Object(s.X)(this.rightKeyboardModule)||(this.leftKeyboardModule.destroy(),this.rightKeyboardModule.destroy()),Object(s.X)(this.presetElement)||this.presetKeyboardModule.destroy(),Object(s.X)(this.cancelButton)||this.btnKeyboardModule.destroy()),this.targetElement=null,Object(s.ib)([document.body],"e-range-overflow"),s.l.remove(document,"mousedown touchstart",this.documentHandler),this.isMobile&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),(this.isMobile||s.d.isDevice)&&(Object(s.X)(this.mobileRangePopupWrap)||(this.mobileRangePopupWrap.remove(),this.mobileRangePopupWrap=null)),this.isKeyPopup=this.dateDisabled=!1),this.updateClearIconState(),this.updateHiddenInput(),this.isMobile&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")}))):(this.updateClearIconState(),this.updateHiddenInput(),this.isMobile&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"))}setLocale(){this.globalize=new s.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),n.c.setPlaceholder(this.placeholder,this.inputElement),this.updateInput(),this.updateHiddenInput(),this.changeTrigger()}refreshChange(){this.checkView(),this.refreshControl(),this.changeTrigger()}setDate(){n.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.refreshChange()}enableInput(){+this.min<=+this.max&&(this.setProperties({enabled:!0},!0),n.c.setEnabled(this.enabled,this.inputElement),this.element.hasAttribute("disabled")&&this.bindEvents())}clearModelvalue(e,t){this.setProperties({startDate:null},!0),this.setProperties({endDate:null},!0),t.value&&t.value.length>0?this.setProperties({value:null},!0):(t.value&&t.value.start||t.value&&!t.value.start)&&this.setProperties({value:{start:null,end:null}},!0),this.updateValue(),this.setDate()}createHiddenInput(){Object(s.X)(this.firstHiddenChild)&&Object(s.X)(this.secondHiddenChild)&&(this.firstHiddenChild=this.createElement("input"),this.secondHiddenChild=this.createElement("input")),Object(s.X)(this.inputElement.getAttribute("name"))||(this.inputElement.setAttribute("data-name",this.inputElement.getAttribute("name")),this.inputElement.removeAttribute("name")),Object(s.x)(this.firstHiddenChild,{type:"text",name:this.inputElement.getAttribute("data-name"),class:"e-daterange-hidden"}),Object(s.x)(this.secondHiddenChild,{type:"text",name:this.inputElement.getAttribute("data-name"),class:"e-daterange-hidden"});let e={type:"datetime",skeleton:Object(s.W)()?"d":"yMd"};this.firstHiddenChild.value=this.startDate&&this.globalize.formatDate(this.startDate,e),this.secondHiddenChild.value=this.endDate&&this.globalize.formatDate(this.endDate,e),this.inputElement.parentElement.appendChild(this.firstHiddenChild),this.inputElement.parentElement.appendChild(this.secondHiddenChild)}setMinMaxDays(){this.isPopupOpen()&&(this.removeClassDisabled(),this.checkMinMaxDays(),this.isMobile&&this.selectableDates(),!this.strictMode&&Object(s.X)(this.startValue)&&Object(s.X)(this.endValue)?this.removeSelection():this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar]),this.updateHeader())}onPropertyChanged(e,t){let i={format:this.formatString,type:"date",skeleton:Object(s.W)()?"d":"yMd"};for(let r of Object.keys(e))switch(["maxDays","minDays"].indexOf(r)<0&&this.hide(null),r){case"width":this.setEleWidth(this.width);break;case"separator":this.previousEleValue=this.inputElement.value,this.setProperties({separator:e.separator},!0),this.updateInput(),this.changeTrigger();break;case"placeholder":n.c.setPlaceholder(e.placeholder,this.inputElement),this.setProperties({placeholder:e.placeholder},!0);break;case"readonly":n.c.setReadonly(this.readonly,this.inputElement),this.inputElement.setAttribute("aria-readonly",""+this.readonly),this.setRangeAllowEdit();break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"enabled":this.setProperties({enabled:e.enabled},!0),n.c.setEnabled(this.enabled,this.inputElement),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1;break;case"allowEdit":this.setRangeAllowEdit();break;case"enableRtl":this.setProperties({enableRtl:e.enableRtl},!0),n.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.updateInput(),this.changeTrigger();break;case"locale":this.globalize=new s.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),n.c.setPlaceholder(this.placeholder,this.inputElement),this.setLocale();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.setDataAttribute(!0),this.checkHtmlAttributes(!0);break;case"showClearButton":n.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"startDate":"string"==typeof e.startDate&&(e.startDate=this.globalize.parseDate(e.startDate,i)),+this.initStartDate!=+e.startDate&&(this.startValue=this.checkDateValue(new Date(this.checkValue(e.startDate))),this.setDate(),this.setValue());break;case"endDate":"string"==typeof e.endDate&&(e.endDate=this.globalize.parseDate(e.endDate,i)),+this.initEndDate!=+e.endDate&&(this.endValue=this.checkDateValue(new Date(this.checkValue(e.endDate))),this.setDate(),this.setValue());break;case"value":if(this.invalidValueString=null,this.checkInvalidRange(e.value),"string"==typeof e.value)if(this.invalidValueString)this.clearModelvalue(e,t);else{let t=e.value.split(" "+this.separator+" ");this.value=[new Date(t[0]),new Date(t[1])],this.updateValue(),this.setDate()}else!Object(s.X)(e.value)&&e.value.length>0||!Object(s.X)(e.value)&&e.value.start?(this.valueType=e.value,null===e.value[0]||null===e.value.start?1===e.value.length||e.value.start?this.clearModelvalue(e,t):null!==e.value[1]&&null!==e.value.start||this.clearModelvalue(e,t):+this.initStartDate==+e.value[0]&&+this.initEndDate==+e.value[1]&&+this.initStartDate==+(e.value.start||+this.initEndDate!=+e.value.start)||((1===e.value.length||e.value.start)&&(this.modelValue=e.value),this.updateValue(),this.setDate())):(Object(s.X)(this.value)||null==e.value.start)&&(this.valueType=e.value,this.startValue=null,this.endValue=null,this.clearModelvalue(e,t));break;case"minDays":this.setProperties({minDays:e.minDays},!0),this.refreshChange(),this.setMinMaxDays();break;case"maxDays":this.setProperties({maxDays:e.maxDays},!0),this.refreshChange(),this.setMinMaxDays();break;case"min":this.setProperties({min:this.checkDateValue(new Date(this.checkValue(e.min)))},!0),this.previousEleValue=this.inputElement.value,this.enableInput(),this.refreshChange();break;case"max":this.setProperties({max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.enableInput(),this.refreshChange();break;case"strictMode":this.invalidValueString=null,this.setProperties({strictMode:e.strictMode},!0),this.refreshChange();break;case"presets":this.setProperties({presets:e.presets},!0),this.processPresets();break;case"floatLabelType":this.floatLabelType=e.floatLabelType,n.c.removeFloating(this.inputWrapper),n.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"start":this.setProperties({start:e.start},!0),this.refreshChange();break;case"depth":this.setProperties({depth:e.depth},!0),this.refreshChange()}}};return S([Object(s.s)(null)],e.prototype,"value",void 0),S([Object(s.s)(!1)],e.prototype,"enablePersistence",void 0),S([Object(s.s)(new Date(1900,0,1))],e.prototype,"min",void 0),S([Object(s.s)(new Date(2099,11,31))],e.prototype,"max",void 0),S([Object(s.s)(null)],e.prototype,"locale",void 0),S([Object(s.s)(null)],e.prototype,"firstDayOfWeek",void 0),S([Object(s.s)(!1)],e.prototype,"weekNumber",void 0),S([Object(s.s)("Gregorian")],e.prototype,"calendarMode",void 0),S([Object(s.s)(!1)],e.prototype,"openOnFocus",void 0),S([Object(s.k)()],e.prototype,"created",void 0),S([Object(s.k)()],e.prototype,"destroyed",void 0),S([Object(s.k)()],e.prototype,"change",void 0),S([Object(s.k)()],e.prototype,"cleared",void 0),S([Object(s.k)()],e.prototype,"navigated",void 0),S([Object(s.k)()],e.prototype,"renderDayCell",void 0),S([Object(s.s)(null)],e.prototype,"startDate",void 0),S([Object(s.s)(null)],e.prototype,"endDate",void 0),S([Object(s.f)([{}],V)],e.prototype,"presets",void 0),S([Object(s.s)("")],e.prototype,"width",void 0),S([Object(s.s)(1e3)],e.prototype,"zIndex",void 0),S([Object(s.s)(!0)],e.prototype,"showClearButton",void 0),S([Object(s.s)(!0)],e.prototype,"showTodayButton",void 0),S([Object(s.s)("Month")],e.prototype,"start",void 0),S([Object(s.s)("Month")],e.prototype,"depth",void 0),S([Object(s.s)("")],e.prototype,"cssClass",void 0),S([Object(s.s)("-")],e.prototype,"separator",void 0),S([Object(s.s)(null)],e.prototype,"minDays",void 0),S([Object(s.s)(null)],e.prototype,"maxDays",void 0),S([Object(s.s)(!1)],e.prototype,"strictMode",void 0),S([Object(s.s)(null)],e.prototype,"keyConfigs",void 0),S([Object(s.s)(null)],e.prototype,"format",void 0),S([Object(s.s)(!0)],e.prototype,"enabled",void 0),S([Object(s.s)(!1)],e.prototype,"readonly",void 0),S([Object(s.s)(!0)],e.prototype,"allowEdit",void 0),S([Object(s.s)("Never")],e.prototype,"floatLabelType",void 0),S([Object(s.s)(null)],e.prototype,"placeholder",void 0),S([Object(s.s)({})],e.prototype,"htmlAttributes",void 0),S([Object(s.k)()],e.prototype,"open",void 0),S([Object(s.k)()],e.prototype,"close",void 0),S([Object(s.k)()],e.prototype,"select",void 0),S([Object(s.k)()],e.prototype,"focus",void 0),S([Object(s.k)()],e.prototype,"blur",void 0),e=S([s.q],e),e})();var N=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};const W=(new Date).getDate(),X=(new Date).getMonth(),G=(new Date).getFullYear(),K="e-timepicker",U="e-input-focus",Y=["title","class","style"];var _;!function(e){e.createListItems=function(e,t,i,s,r,n){let l,o,h=6e4*n,d=[],c=[];for(l=+t.setMilliseconds(0),o=+i.setMilliseconds(0);o>=l;)c.push(l),d.push(s.formatDate(new Date(l),{format:r,type:"time"})),l+=h;return{collection:c,list:a.a.createList(e,d,null,!0)}}}(_||(_={}));let Q=(()=>{let e=class extends s.h{constructor(e,t){super(e,t),this.liCollections=[],this.timeCollections=[],this.blazorTimeCollections=[],this.disableItemCollection=[],this.invalidValueString=null,this.isBlazorServer=!1,this.isAngular=!1,this.preventChange=!1,this.timeOptions=e}preRender(){this.keyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.cloneElement=this.element.cloneNode(!0),Object(s.ib)([this.cloneElement],[K,"e-control","e-lib"]),this.inputElement=this.element,this.angularTag=null,this.formElement=Object(s.C)(this.element,"form"),this.isBlazorServer=!(!Object(s.W)()||!this.isServerRendered||"timepicker"!==this.getModuleName()),this.isBlazorServer||("EJS-TIMEPICKER"===this.element.tagName&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.openPopupEventArgs={appendTo:document.body})}render(){if(this.isBlazorServer){this.globalize=new s.n(this.locale),this.defaultCulture=new s.n("en"),this.checkTimeFormat();let e=this.element.parentElement;this.inputWrapper={container:e,clearButton:e.querySelector(".e-clear-icon"),buttons:[e.querySelector(".e-time-icon")]},n.c.bindInitialEvent({element:this.inputElement,floatLabelType:this.floatLabelType}),this.showClearButton&&this.inputWrapper.clearButton&&n.c.wireClearBtnEvents(this.inputElement,this.inputWrapper.clearButton,this.inputWrapper.container)}else this.initialize(),this.createInputElement(),this.updateHtmlAttributeToWrapper(),this.setTimeAllowEdit(),this.setEnable(),this.validateInterval();this.bindEvents(),this.isBlazorServer||(this.validateDisable(),this.setValue(this.getFormattedValue(this.value))),this.anchor=this.inputElement,this.inputElement.setAttribute("value",this.inputElement.value),this.isBlazorServer||(this.inputEleValue=this.getDateObject(this.inputElement.value)),this.renderComplete()}setTimeAllowEdit(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(s.x)(this.inputElement,{readonly:""}),this.clearIconState()}clearIconState(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(s.ib)([this.inputWrapper.container],["e-non-edit"]):Object(s.v)([this.inputWrapper.container],["e-non-edit"])}validateDisable(){this.setMinMax(this.initMin,this.initMax),this.popupCreation(),this.popupObj.destroy(),this.popupWrapper=this.popupObj=null,isNaN(+this.value)||null===this.value||this.valueIsDisable(this.value)||(this.strictMode&&this.resetState(),this.initValue=null,this.initMax=this.getDateObject(this.initMax),this.initMin=this.getDateObject(this.initMin),this.timeCollections=this.liCollections=[],this.setMinMax(this.initMin,this.initMax))}validationAttribute(e,t){let i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");let r=["required","aria-required","form"];for(let n=0;n<r.length;n++){if(Object(s.X)(e.getAttribute(r[n])))continue;let i=e.getAttribute(r[n]);t.setAttribute(r[n],i),e.removeAttribute(r[n])}}initialize(){this.globalize=new s.n(this.locale),this.defaultCulture=new s.n("en"),this.checkTimeFormat(),this.checkInvalidValue(this.value),this.setProperties({value:this.checkDateValue(new Date(this.checkInValue(this.value)))},!0),this.setProperties({min:this.checkDateValue(new Date(this.checkInValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkInValue(this.max)))},!0),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(this.scrollTo)))},!0),null!==this.angularTag&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.checkAttributes(!1),this.l10n=new s.p("timepicker",{placeholder:this.placeholder},this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.initValue=this.checkDateValue(this.value),this.initMin=this.checkDateValue(this.min),this.initMax=this.checkDateValue(this.max),this.isNavigate=this.isPreventBlur=this.isTextSelected=!1,this.activeIndex=this.valueWithMinutes=this.prevDate=null,Object(s.X)(this.element.getAttribute("id"))?(this.element.id=Object(s.U)("ej2_timepicker"),null!==this.angularTag&&Object(s.x)(this.inputElement,{id:this.element.id+"_input"})):null!==this.angularTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"),Object(s.X)(this.inputElement.getAttribute("name"))&&Object(s.x)(this.inputElement,{name:this.element.id})}checkTimeFormat(){this.formatString=this.format?"string"==typeof this.format?this.format:Object(s.X)(this.format.skeleton)||""===this.format.skeleton?this.globalize.getDatePattern({type:"time",skeleton:"short"}):this.globalize.getDatePattern({type:"time",skeleton:this.format.skeleton}):null}checkDateValue(e){return!Object(s.X)(e)&&e instanceof Date&&!isNaN(+e)?e:null}createInputElement(){let e=this.cssClass;Object(s.X)(this.cssClass)||""===this.cssClass||(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=n.c.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[" e-input-group-icon e-time-icon e-icons"]},this.createElement),this.inputWrapper.container.style.width=this.setWidth(this.width),Object(s.x)(this.inputElement,{"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"false","aria-invalid":"false"}),this.isNullOrEmpty(this.inputStyle)||n.c.addAttributes({style:this.inputStyle},this.inputElement),Object(s.v)([this.inputWrapper.container],"e-time-wrapper")}getCldrDateTimeFormat(){let e,t=new s.n(this.locale).getDatePattern({skeleton:Object(s.W)()?"d":"yMd"});return e=this.isNullOrEmpty(this.formatString)?t+" "+this.CldrFormat("time"):this.formatString,e}checkInvalidValue(e){let t=!1;if("object"!=typeof e&&!Object(s.X)(e)){let i=e;"string"==typeof i&&(i=i.trim());let r=null,n=null;if("number"==typeof e?i=e.toString():"string"==typeof e&&(/^[a-zA-Z0-9- ]*$/.test(e)||(r=this.setCurrentDate(this.getDateObject(e)),Object(s.X)(r)&&(r=this.checkDateValue(this.globalize.parseDate(i,{format:this.getCldrDateTimeFormat(),type:"datetime"})),Object(s.X)(r)&&(r=this.checkDateValue(this.globalize.parseDate(i,{format:this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"})))))),n=this.globalize.parseDate(i,{format:this.getCldrDateTimeFormat(),type:"datetime"}),r=!Object(s.X)(n)&&n instanceof Date&&!isNaN(+n)?n:null,Object(s.X)(r)&&i.replace(/\s/g,"").length){let s=null,n=null;s=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,n=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!s.test(i)&&!n.test(i)||/^[a-zA-Z0-9- ]*$/.test(e)||isNaN(+new Date(""+i))?t=!0:r=new Date(""+i)}t?(this.strictMode||(this.invalidValueString=i),this.setProperties({value:null},!0),this.initValue=null):(this.setProperties({value:r},!0),this.initValue=this.value)}}CldrFormat(e){let t;return t="en"===this.locale||"en-US"===this.locale?Object(s.W)()?this.getBlazorCultureFormat("t"):Object(s.V)("timeFormats.short",Object(s.N)()):this.getCultureTimeObject(s.B,""+this.locale),t}destroy(){if(this.isBlazorServer)this.unBindEvents();else{this.hide(),this.unBindEvents();let e={"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"true","aria-invalid":"false"};this.inputElement&&(n.c.removeAttributes(e,this.inputElement),null===this.angularTag&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),Object(s.X)(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.enableElement([this.inputElement]),this.inputElement.classList.remove("e-input"),Object(s.X)(this.cloneElement.getAttribute("disabled"))&&n.c.setEnabled(!0,this.inputElement,this.floatLabelType)),this.inputWrapper.container&&Object(s.I)(this.inputWrapper.container),this.inputWrapper=this.popupWrapper=this.cloneElement=void 0,this.liCollections=this.timeCollections=this.disableItemCollection=[],Object(s.X)(this.rippleFn)||this.rippleFn(),super.destroy(),this.formElement&&s.l.remove(this.formElement,"reset",this.formResetHandler)}}ensureInputAttribute(){let e=[];for(let t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(let t=0;t<e.length;t++)Object(s.X)(this.cloneElement.getAttribute(e[t]))?(this.inputElement.removeAttribute(e[t]),"value"===e[t].toLowerCase()&&(this.inputElement.value="")):(this.inputElement.setAttribute(e[t],this.cloneElement.getAttribute(e[t])),"value"===e[t].toLowerCase()&&(this.inputElement.value=this.cloneElement.getAttribute(e[t])))}popupCreation(){this.isBlazorServer?(this.popupWrapper=this.inputWrapper.container.nextElementSibling,this.generateList()):(this.popupWrapper=this.createElement("div",{className:K+" e-popup",attrs:{id:this.element.id+"_popup",style:"visibility:hidden"}}),Object(s.X)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),!Object(s.X)(this.step)&&this.step>0&&(this.generateList(),Object(s.w)([this.listWrapper],this.popupWrapper)),this.openPopupEventArgs.appendTo.appendChild(this.popupWrapper)),this.addSelection(),this.renderPopup(),Object(s.I)(this.popupWrapper)}getPopupHeight(){let e=parseInt("240px",10),t=this.popupWrapper.getBoundingClientRect().height;return t>e?e:t}generateList(){if(this.isBlazorServer?this.listWrapper=this.popupWrapper.querySelector(".e-content"):this.createListItems(),this.wireListEvents(),this.rippleFn=Object(s.kb)(this.listWrapper,{duration:300,selector:".e-list-item"}),this.liCollections=this.listWrapper.querySelectorAll(".e-list-item"),this.isBlazorServer){this.blazorTimeCollections=[];for(let e=0;e<this.liCollections.length;e++)this.blazorTimeCollections.push(this.liCollections[e].getAttribute("data-value"))}}renderPopup(){this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),this.popupObj=new r.c(this.popupWrapper,{width:this.setPopupWidth(this.width),zIndex:this.zIndex,targetType:"relative",position:s.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},collision:s.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},enableRtl:this.enableRtl,relateTo:s.d.isDevice?document.body:this.inputWrapper.container,offsetY:4,open:()=>{this.popupWrapper.style.visibility="visible",Object(s.v)([this.inputWrapper.buttons[0]],"e-active")},close:()=>{Object(s.ib)([this.inputWrapper.buttons[0]],"e-active"),this.unWireListEvents(),this.inputElement.setAttribute("aria-activedescendant","null"),this.isBlazorServer||(Object(s.hb)(this.popupObj.element),this.popupObj.destroy(),this.popupWrapper.innerHTML=""),this.listWrapper=this.popupWrapper=this.listTag=void 0},targetExitViewport:()=>{s.d.isDevice||this.hide()}}),s.d.isDevice||(this.popupObj.collision={X:"none",Y:"flip"}),this.popupObj.element.style.maxHeight="240px"}getFormattedValue(e){return Object(s.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{skeleton:Object(s.W)()?"t":"medium",type:"time"})}getDateObject(e){if(!this.isNullOrEmpty(e)){let t=this.createDateObj(e),i=!this.isNullOrEmpty(this.initValue);if(this.checkDateValue(t)){let e=i?this.initValue.getDate():W,s=i?this.initValue.getMonth():X,r=i?this.initValue.getFullYear():G;return new Date(r,s,e,t.getHours(),t.getMinutes(),t.getSeconds())}}return null}updateHtmlAttributeToWrapper(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))if(Y.indexOf(e)>-1)if("class"===e){let t=this.htmlAttributes[e].replace(/\s+/g," ").trim();""!==t&&Object(s.v)([this.inputWrapper.container],t.split(" "))}else if("style"===e){let t=this.inputWrapper.container.getAttribute(e);t=Object(s.X)(t)?this.htmlAttributes[e]:t+this.htmlAttributes[e],this.inputWrapper.container.setAttribute(e,t)}else this.inputWrapper.container.setAttribute(e,this.htmlAttributes[e])}updateHtmlAttributeToElement(){if(!Object(s.X)(this.htmlAttributes))for(let e of Object.keys(this.htmlAttributes))Y.indexOf(e)<0&&this.inputElement.setAttribute(e,this.htmlAttributes[e])}updateCssClass(e,t){Object(s.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(s.X)(e)||(e=e.replace(/\s+/g," ").trim()),n.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&n.c.setCssClass(e,[this.popupWrapper],t)}removeErrorClass(){Object(s.ib)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"false"})}checkErrorState(e){let t=this.getDateObject(e);this.validateState(t)&&!this.invalidValueString?this.removeErrorClass():(Object(s.v)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":"true"}))}validateInterval(){!Object(s.X)(this.step)&&this.step>0?this.enableElement([this.inputWrapper.buttons[0]]):this.disableTimeIcon()}disableTimeIcon(){this.disableElement([this.inputWrapper.buttons[0]]),this.hide()}disableElement(e){Object(s.v)(e,"e-disabled")}enableElement(e){Object(s.ib)(e,"e-disabled")}selectInputText(){this.inputElement.setSelectionRange(0,this.inputElement.value.length)}setCursorToEnd(){this.inputElement.setSelectionRange(this.inputElement.value.length,this.inputElement.value.length)}getMeridianText(){let e;if("en"===this.locale||"en-US"===this.locale)e=Object(s.V)(Object(s.W)()?"dayPeriods.wide":"dayPeriods.format.wide",Object(s.N)());else{let t=Object(s.W)()?".dates.dayPeriods.abbreviated":".dates.calendars.gregorian.dayPeriods.format.abbreviated",i=Object(s.W)()?"":"main.";e=Object(s.V)(i+""+this.locale+t,s.B)}return e}getCursorSelection(){let e=this.inputElement,t=0,i=0;return isNaN(e.selectionStart)||(t=e.selectionStart,i=e.selectionEnd),{start:Math.abs(t),end:Math.abs(i)}}getActiveElement(){return Object(s.X)(this.popupWrapper)?null:this.popupWrapper.querySelectorAll(".e-active")}isNullOrEmpty(e){return!!(Object(s.X)(e)||"string"==typeof e&&""===e.trim())}setWidth(e){return"number"==typeof e?Object(s.L)(e):"string"==typeof e?e.match(/px|%|em/)?e:Object(s.L)(e):"100%"}setPopupWidth(e){return(e=this.setWidth(e)).indexOf("%")>-1&&(e=(this.containerStyle.width*parseFloat(e)/100).toString()+"px"),e}setScrollPosition(){let e;this.getPopupHeight(),e=this.selectedElement,Object(s.X)(e)?this.popupWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)}findScrollTop(e){let t=this.getPopupHeight(),i=e.nextElementSibling,s=i?i.offsetTop:e.offsetTop,r=e.getBoundingClientRect().height;this.popupWrapper.scrollTop=s+e.offsetTop>t?i?s-(t/2+r/2):s:0}setScrollTo(){let e;if(Object(s.X)(this.popupWrapper))this.popupWrapper.scrollTop=0;else{let t=this.popupWrapper.querySelectorAll(".e-list-item");if(t.length){let i=this.isBlazorServer?new Date((new Date).toDateString()+" "+this.blazorTimeCollections[0]).setMilliseconds(0):this.timeCollections[0],s=this.isBlazorServer?new Date((new Date).toDateString()+" "+this.scrollTo.toLocaleTimeString()).setMilliseconds(0):this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=t[Math.round((s-i)/(6e4*this.step))]}}Object(s.X)(e)?this.popupWrapper.scrollTop=0:this.findScrollTop(e)}getText(){return Object(s.X)(this.checkDateValue(this.value))?"":this.getValue(this.value)}getValue(e){return Object(s.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})}cldrDateFormat(){let e;return e="en"===this.locale||"en-US"===this.locale?Object(s.W)()?Object(s.V)("d",Object(s.V)(this.locale,s.y)):Object(s.V)("dateFormats.short",Object(s.N)()):this.getCultureDateObject(s.B,""+this.locale),e}getBlazorCultureFormat(e){return Object(s.V)(e,Object(s.V)(this.locale,s.y)).replace(/tt/,"a")}cldrTimeFormat(){let e;return e=this.isNullOrEmpty(this.formatString)?"en"===this.locale||"en-US"===this.locale?Object(s.W)()?this.getBlazorCultureFormat("t"):Object(s.V)("timeFormats.short",Object(s.N)()):this.getCultureTimeObject(s.B,""+this.locale):this.formatString,e}dateToNumeric(){let e;return e="en"===this.locale||"en-US"===this.locale?Object(s.W)()?this.getBlazorCultureFormat("T"):Object(s.V)("timeFormats.medium",Object(s.N)()):Object(s.W)()?this.getBlazorCultureFormat("T"):Object(s.V)("main."+this.locale+".dates.calendars.gregorian.timeFormats.medium",s.B),e}getExactDateTime(e){return Object(s.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.dateToNumeric(),type:"time"})}setValue(e){let t=this.checkValue(e);this.strictMode||this.validateState(t)?this.isNullOrEmpty(t)?(this.initValue=null,this.validateMinMax(this.value,this.min,this.max)):this.initValue=this.compareFormatChange(t):(null===this.checkDateValue(this.valueWithMinutes)&&(this.initValue=this.valueWithMinutes=null),this.validateMinMax(this.value,this.min,this.max)),this.updateInput(!0,this.initValue)}compareFormatChange(e){return Object(s.X)(e)?null:e!==this.getText()?this.getDateObject(e):this.getDateObject(this.value)}updatePlaceHolder(){n.c.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)}updateInputValue(e){n.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)}preventEventBubbling(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnTimeIconClick")}updateBlazorTimeCollections(e){this.blazorTimeCollections=e}popupHandler(e){this.enabled&&(s.d.isDevice&&this.inputElement.setAttribute("readonly",""),this.isBlazorServer||e.preventDefault(),this.isPopupOpen()&&!this.isBlazorServer?this.closePopup(0,e):(this.inputElement.focus(),this.show(e)))}mouseDownHandler(){this.enabled&&!this.readonly&&(this.getCursorSelection(),this.inputElement.setSelectionRange(0,0),s.l.add(this.inputElement,"mouseup",this.mouseUpHandler,this))}mouseUpHandler(e){if(!this.readonly){e.preventDefault(),s.l.remove(this.inputElement,"mouseup",this.mouseUpHandler);let t=this.getCursorSelection();0===t.start&&t.end===this.inputElement.value.length||(this.inputElement.value.length>0&&(this.cursorDetails=this.focusSelection()),this.inputElement.setSelectionRange(this.cursorDetails.start,this.cursorDetails.end))}}focusSelection(){let e=new RegExp("^[a-zA-Z0-9]+$"),t=this.inputElement.value.split("");t.push(" ");let i=this.getCursorSelection(),s=0,r=0,n=!1;if(this.isTextSelected)s=i.start,r=i.end,this.isTextSelected=!1;else for(let l=0;l<t.length;l++)if(e.test(t[l])||(r=l,n=!0),n){if(i.start>=s&&i.end<=r){r=r,this.isTextSelected=!0;break}s=l+1,n=!1}return{start:s,end:r}}inputHandler(e){if(!this.readonly&&this.enabled)switch("right"!==e.action&&"left"!==e.action&&"tab"!==e.action&&e.preventDefault(),e.action){case"home":case"end":case"up":case"down":this.keyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):(this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.updateValue(this.valueWithMinutes,e))):this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictMode",this.inputElement.value):this.updateValue(this.inputElement.value,e),this.hide(),this.isNavigate=!1,this.isPopupOpen()&&e.stopPropagation();break;case"open":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnPopupHide",!0):this.show(e);break;case"escape":this.isBlazorServer||(this.updateInputValue(this.objToString(this.value)),this.previousState(this.value)),this.hide();break;case"close":this.hide();break;default:this.isNavigate=!1}}onMouseClick(e){let t=e.target,i=this.selectedElement=Object(s.C)(t,".e-list-item");this.setSelection(i,e),i&&i.classList.contains("e-list-item")&&this.hide()}closePopup(e,t){if(this.isPopupOpen()&&this.popupWrapper){let i={popup:this.isBlazorServer?null:this.popupObj,event:t||null,cancel:!1,name:"open"};Object(s.ib)([document.body],"e-time-overflow"),this.trigger("close",i,t=>{t.cancel||(this.popupObj.hide(new s.b({name:"FadeOut",duration:50,delay:e||0})),Object(s.ib)([this.inputWrapper.container],["e-icon-anim"]),Object(s.x)(this.inputElement,{"aria-expanded":"false"}),s.l.remove(document,"mousedown touchstart",this.documentClickHandler),this.isBlazorServer&&(this.disposeServerPopup(),this.inputWrapper.container.parentElement.insertBefore(this.popupWrapper,this.inputWrapper.container.nextElementSibling),this.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),this.popupWrapper=this.popupObj=null)),s.d.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),s.d.isDevice&&(Object(s.X)(this.mobileTimePopupWrap)||(this.mobileTimePopupWrap.remove(),this.mobileTimePopupWrap=null)),s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")})}else s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")}disposeServerPopup(){this.popupWrapper&&(this.popupWrapper.style.visibility="hidden",this.popupWrapper.style.top="-9999px",this.popupWrapper.style.left="-9999px",this.popupWrapper.style.width="0px",this.popupWrapper.style.height="0px")}checkValueChange(e,t){if(this.strictMode||this.validateState(this.valueWithMinutes))if(t){let t=this.getDateObject(new Date(this.timeCollections[this.activeIndex]));+this.prevDate!=+t&&this.valueProcess(e,t)}else(this.prevValue!==this.inputElement.value||Object(s.X)(this.checkDateValue(this.value)))&&this.valueProcess(e,this.compareFormatChange(this.inputElement.value));else null===this.checkDateValue(this.valueWithMinutes)&&(this.initValue=this.valueWithMinutes=null),this.setProperties({value:this.compareFormatChange(this.inputElement.value)},!0),this.initValue=this.valueWithMinutes=this.compareFormatChange(this.inputElement.value),this.prevValue=this.inputElement.value,+this.prevDate!=+this.value&&this.changeEvent(e)}onMouseOver(e){let t=Object(s.C)(e.target,".e-list-item");this.setHover(t,"e-hover")}setHover(e,t){this.enabled&&this.isValidLI(e)&&!e.classList.contains(t)&&(this.removeHover(t),Object(s.v)([e],t),"e-navigation"===t&&e.setAttribute("aria-selected","true"))}setSelection(e,t){this.isValidLI(e)&&!e.classList.contains("e-active")&&(this.isBlazorServer?(this.selectedElement=e,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),Object(s.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.inputElement.setAttribute("value",e.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!1),this.addSelection()):(this.checkValue(e.getAttribute("data-value")),this.selectedElement=e,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Object(s.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.checkValueChange(t,!0)))}onMouseLeave(){this.removeHover("e-hover")}scrollHandler(){"timepicker"===this.getModuleName()&&s.d.isDevice||this.hide()}setMinMax(e,t){Object(s.X)(this.checkDateValue(e))&&(this.initMin=this.getDateObject("12:00:00 AM")),Object(s.X)(this.checkDateValue(t))&&(this.initMax=this.getDateObject("11:59:59 PM"))}validateMinMax(e,t,i){let r=e instanceof Date?e:this.getDateObject(e);return Object(s.X)(this.checkDateValue(r))?+this.createDateObj(this.getFormattedValue(this.initMin))>+this.createDateObj(this.getFormattedValue(this.initMax))&&this.disableTimeIcon():e=this.strictOperation(this.initMin,this.initMax,e,r),this.strictMode&&(e=this.valueIsDisable(e)?e:null),this.checkErrorState(e),e}valueIsDisable(e){if(this.disableItemCollection.length>0){if(this.disableItemCollection.length===this.timeCollections.length)return!1;let t=e instanceof Date?this.objToString(e):e;for(let e=0;e<this.disableItemCollection.length;e++)if(t===this.disableItemCollection[e])return!1}return!0}validateState(e){if(!this.strictMode){if(!this.valueIsDisable(e))return!1;{let t=this.setCurrentDate(this.getDateObject(e)),i=this.setCurrentDate(this.getDateObject(this.initMax)),r=this.setCurrentDate(this.getDateObject(this.initMin));if(Object(s.X)(this.checkDateValue(t))){if(+i<+r||""!==this.inputElement.value)return!1}else if(+t>+i||+t<+r)return!1}}return!0}strictOperation(e,t,i,s){let r=this.createDateObj(this.getFormattedValue(t)),n=this.createDateObj(this.getFormattedValue(e)),l=this.createDateObj(this.getFormattedValue(s));if(this.strictMode){if(+n>+r)return this.disableTimeIcon(),this.initValue=this.getDateObject(r),this.updateInputValue(this.getValue(this.initValue)),this.inputElement.value;if(+n>=+l)return this.getDateObject(n);if(+l>=+r||+n==+r)return this.getDateObject(r)}else if(+n>+r&&(this.disableTimeIcon(),!isNaN(+this.createDateObj(i))))return i;return i}bindEvents(){s.l.add(this.inputWrapper.buttons[0],"mousedown",this.isBlazorServer?this.preventEventBubbling:this.popupHandler,this),s.l.add(this.inputElement,"blur",this.inputBlurHandler,this),s.l.add(this.inputElement,"focus",this.inputFocusHandler,this),s.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&s.l.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this),this.formElement&&s.l.add(this.formElement,"reset",this.formResetHandler,this),s.d.isDevice||(this.keyConfigure=Object(s.K)(this.keyConfigure,this.keyConfigs),this.inputEvent=new s.o(this.inputWrapper.container,{keyAction:this.inputHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.showClearButton&&this.inputElement&&s.l.add(this.inputElement,"mousedown",this.mouseDownHandler,this))}formResetHandler(){if(this.enabled&&!this.inputElement.disabled){let e=this.inputElement.getAttribute("value"),t=this.isBlazorServer?this.inputEleValue:this.checkDateValue(this.inputEleValue);"EJS-TIMEPICKER"===this.element.tagName&&(t=null,e="",this.inputElement.setAttribute("value","")),this.isBlazorServer||(this.setProperties({value:t},!0),this.prevDate=this.value,this.valueWithMinutes=this.value,this.initValue=this.value),this.inputElement&&(this.updateInputValue(e),this.isBlazorServer||this.checkErrorState(e),this.prevValue=this.inputElement.value)}}inputChangeHandler(e){this.enabled&&e.stopPropagation()}unBindEvents(){this.inputWrapper&&s.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.popupHandler),s.l.remove(this.inputElement,"blur",this.inputBlurHandler),s.l.remove(this.inputElement,"focus",this.inputFocusHandler),s.l.remove(this.inputElement,"change",this.inputChangeHandler),this.inputEvent&&this.inputEvent.destroy(),s.l.remove(this.inputElement,"mousedown touchstart",this.mouseDownHandler),this.showClearButton&&!Object(s.X)(this.inputWrapper.clearButton)&&s.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.clearHandler),this.formElement&&s.l.remove(this.formElement,"reset",this.formResetHandler)}bindClearEvent(){this.showClearButton&&this.inputWrapper.clearButton&&s.l.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this)}raiseClearedEvent(e){this.trigger("cleared",{event:e})}clearHandler(e){this.enabled&&(e.preventDefault(),Object(s.X)(this.value)?(this.resetState(),this.raiseClearedEvent(e)):this.clear(e),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnValueCleared"),this.popupWrapper&&(this.popupWrapper.scrollTop=0))}clear(e){this.isBlazorServer||this.setProperties({value:null},!0),this.initValue=null,this.resetState(),this.raiseClearedEvent(e),this.isBlazorServer||this.changeEvent(e)}setZIndex(){this.popupObj&&(this.popupObj.zIndex=this.zIndex,this.popupObj.dataBind())}checkAttributes(e){let t,i=e?Object(s.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["step","disabled","readonly","style","name","value","min","max","placeholder"];for(let r of i)if(!Object(s.X)(this.inputElement.getAttribute(r)))switch(r){case"disabled":if(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.enabled||e){let t="disabled"!==this.inputElement.getAttribute(r)&&""!==this.inputElement.getAttribute(r)&&"true"!==this.inputElement.getAttribute(r);this.setProperties({enabled:t},!e)}break;case"style":this.inputStyle=this.inputElement.getAttribute(r);break;case"readonly":if(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.readonly||e){let t="readonly"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({readonly:t},!e)}break;case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(r));break;case"step":this.step=parseInt(this.inputElement.getAttribute(r),10);break;case"placeholder":(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e);break;case"min":this.isBlazorServer||(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.min||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(s.X)(this.checkDateValue(t))||this.setProperties({min:t},!e));break;case"max":this.isBlazorServer||(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.max||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(s.X)(this.checkDateValue(t))||this.setProperties({max:t},!e));break;case"value":this.isBlazorServer||(Object(s.X)(this.timeOptions)||void 0===this.timeOptions.value||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(s.X)(this.checkDateValue(t))||(this.initValue=t,this.updateInput(!1,this.initValue),this.setProperties({value:t},!e)))}}setCurrentDate(e){return Object(s.X)(this.checkDateValue(e))?null:new Date(G,X,W,e.getHours(),e.getMinutes(),e.getSeconds())}getTextFormat(){let e=0;if("a"===this.cldrTimeFormat().split(" ")[0]||0===this.cldrTimeFormat().indexOf("a"))e=1;else if(this.cldrTimeFormat().indexOf("a")<0){let t=this.cldrTimeFormat().split(" ");for(let i=0;i<t.length;i++)if(t[i].toLowerCase().indexOf("h")>=0){e=i;break}}return e}updateValue(e,t){let i;if(this.isNullOrEmpty(e))this.resetState();else if(i=this.checkValue(e),this.strictMode){let t=null===i&&e.trim().length>0?this.previousState(this.prevDate):this.inputElement.value;this.updateInputValue(t)}this.checkValueChange(t,"string"!=typeof e)}previousState(e){let t=this.getDateObject(e);for(let i=0;i<this.timeCollections.length;i++)if(+t===this.timeCollections[i]){this.activeIndex=i,this.selectedElement=this.liCollections[i],this.valueWithMinutes=new Date(this.timeCollections[i]);break}return this.prevValue}resetState(){this.removeSelection(),n.c.setValue("",this.inputElement,this.floatLabelType,!1),this.valueWithMinutes=this.activeIndex=null,this.strictMode||this.isBlazorServer||this.checkErrorState(null)}objToString(e){return Object(s.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})}checkValue(e){if(!this.isNullOrEmpty(e)){let t=e instanceof Date?e:this.getDateObject(e);return this.validateValue(t,e)}return this.resetState(),this.valueWithMinutes=null}validateValue(e,t){let i,r=this.validateMinMax(t,this.min,this.max),n=this.createDateObj(r);if(this.getFormattedValue(n)!==this.getFormattedValue(this.value)?(this.valueWithMinutes=Object(s.X)(n)?null:n,i=this.objToString(this.valueWithMinutes)):(this.strictMode&&(e=n),this.valueWithMinutes=this.checkDateValue(e),i=this.objToString(this.valueWithMinutes)),!this.strictMode&&Object(s.X)(i)){let e=r.trim().length>0?r:"";this.updateInputValue(e)}else this.updateInputValue(i);return i}findNextElement(e){let t=this.inputElement.value,i=Object(s.X)(this.valueWithMinutes)||this.isBlazorServer?this.createDateObj(t):this.getDateObject(this.valueWithMinutes),r=null,n=this.liCollections.length,l=this.isBlazorServer?Object(s.X)(this.blazorTimeCollections)?[]:this.blazorTimeCollections:this.timeCollections;if(Object(s.X)(this.checkDateValue(i))&&Object(s.X)(this.activeIndex))this.selectNextItem(e);else{if("home"===e.action){let e=this.validLiElement(0);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[e]))),this.activeIndex=e}else if("end"===e.action){let e=this.validLiElement(l.length-1,!0);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[e]))),this.activeIndex=e}else if("down"===e.action)for(let e=0;e<n;e++){if(this.isBlazorServer?+i<+this.createDateObj(this.blazorTimeCollections[e]):+i<this.timeCollections[e]){let t=this.validLiElement(e);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[t]))),this.activeIndex=t;break}if(e===n-1){let e=this.validLiElement(0);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[e]))),this.activeIndex=e;break}}else for(let e=n-1;e>=0;e--){if(this.isBlazorServer?+i>+this.createDateObj(this.blazorTimeCollections[e]):+i>this.timeCollections[e]){let t=this.validLiElement(e,!0);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[t]))),this.activeIndex=t;break}if(0===e){let e=this.validLiElement(n-1);this.isBlazorServer||(r=+this.createDateObj(new Date(this.timeCollections[e]))),this.activeIndex=e;break}}this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):this.elementValue(Object(s.X)(r)?null:new Date(r))}}selectNextItem(e){let t=this.validLiElement(0,"down"!==e.action);this.activeIndex=t,this.selectedElement=this.liCollections[t],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",t,!0)):this.elementValue(new Date(this.timeCollections[t]))}findNextInBlazor(e){let t=Object(s.X)(this.blazorTimeCollections)?0:this.blazorTimeCollections.length,i=0,r=this.createDateObj(this.inputElement.value);switch(e.action){case"home":this.activeIndex=i;break;case"end":i=t-1,this.activeIndex=i;break;case"down":for(let e=0;e<t;e++){if(this.isBlazorServer?+r<+this.createDateObj(this.blazorTimeCollections[e]):+r<this.timeCollections[e]){let t=this.validLiElement(e);this.activeIndex=t;break}if(e===t-1){let e=this.validLiElement(0);this.activeIndex=e;break}}break;case"up":for(let e=t-1;e>=0;e--){if(this.isBlazorServer?+r>+this.createDateObj(this.blazorTimeCollections[e]):+r>this.timeCollections[e]){let t=this.validLiElement(e,!0);this.activeIndex=t;break}if(0===e){let e=this.validLiElement(t-1);this.activeIndex=e;break}}}this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)}elementValue(e){Object(s.X)(this.checkDateValue(e))||this.checkValue(e)}validLiElement(e,t){let i=null;if(this.isBlazorServer&&Object(s.X)(this.popupWrapper)){let s=this.blazorTimeCollections;if(s.length)if(t)for(let t=e;t>=0;t--){i=t;break}else for(let t=e;t<=s.length-1;t++){i=t;break}}else{let r=Object(s.X)(this.popupWrapper)?this.liCollections:this.popupWrapper.querySelectorAll(".e-list-item"),n=!0;if(r.length)if(t)for(let t=e;t>=0;t--){if(!r[t].classList.contains("e-disabled")){i=t;break}0===t&&n&&(e=t=r.length,n=!1)}else for(let t=e;t<=r.length-1;t++){if(!r[t].classList.contains("e-disabled")){i=t;break}t===r.length-1&&n&&(e=t=-1,n=!1)}}return i}keyHandler(e){if(Object(s.X)(this.step)||this.step<=0||this.inputWrapper.buttons[0].classList.contains("e-disabled"))return;let t=this.isBlazorServer?Object(s.X)(this.blazorTimeCollections)?0:this.blazorTimeCollections.length:this.timeCollections.length;if(Object(s.X)(this.getActiveElement())||0===this.getActiveElement().length)if(Object(s.X)(this.popupObj)&&this.isBlazorServer)if(Object(s.X)(this.activeIndex)){let t=this.validLiElement(0,"down"!==e.action);this.activeIndex=t,this.interopAdaptor.invokeMethodAsync("OnListItemClick",t,!0)}else this.findNextInBlazor(e);else this.liCollections.length>0&&(this.isBlazorServer||Object(s.X)(this.value))&&Object(s.X)(this.activeIndex)?this.selectNextItem(e):this.findNextElement(e);else{let i;if(e.keyCode>=37&&e.keyCode<=40){let r=40===e.keyCode||39===e.keyCode?++this.activeIndex:--this.activeIndex;this.activeIndex=r=this.activeIndex===t?0:this.activeIndex,this.activeIndex=r=this.activeIndex<0?t-1:this.activeIndex,this.activeIndex=r=this.validLiElement(this.activeIndex,40!==e.keyCode&&39!==e.keyCode),this.isBlazorServer||(i=Object(s.X)(this.timeCollections[r])?this.timeCollections[0]:this.timeCollections[r])}else if("home"===e.action){let e=this.validLiElement(0);this.activeIndex=e,this.isBlazorServer||(i=this.timeCollections[e])}else if("end"===e.action){let e=this.validLiElement(t-1,!0);this.activeIndex=e,this.isBlazorServer||(i=this.timeCollections[e])}this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):this.elementValue(new Date(i))}this.isNavigate=!0,this.setHover(this.selectedElement,"e-navigation"),this.setActiveDescendant(),this.isBlazorServer||this.selectInputText(),!this.isPopupOpen()||null===this.selectedElement||e&&"click"===e.type||this.setScrollPosition()}getCultureTimeObject(e,t){return Object(s.W)()?Object(s.V)("t",Object(s.V)(t,s.y)).replace(/tt/,"a"):Object(s.V)("main."+t+".dates.calendars.gregorian.timeFormats.short",e)}getCultureDateObject(e,t){return Object(s.W)()?Object(s.V)("d",Object(s.V)(t,s.y)):Object(s.V)("main."+t+".dates.calendars.gregorian.dateFormats.short",e)}wireListEvents(){s.l.add(this.listWrapper,"click",this.onMouseClick,this),s.d.isDevice||(s.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),s.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this))}unWireListEvents(){this.listWrapper&&(s.l.remove(this.listWrapper,"click",this.onMouseClick),s.d.isDevice||(s.l.remove(this.listWrapper,"mouseover",this.onMouseOver),s.l.remove(this.listWrapper,"mouseout",this.onMouseLeave)))}valueProcess(e,t){let i=Object(s.X)(this.checkDateValue(t))?null:t;+this.prevDate!=+i&&(this.initValue=i,this.changeEvent(e))}changeEvent(e){this.addSelection(),this.updateInput(!0,this.initValue);let t={event:e||null,value:this.value,text:this.inputElement.value,isInteracted:!Object(s.X)(e),element:this.element};t.value=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.prevDate=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",t),this.invalidValueString=null,this.checkErrorState(this.value)}updateInput(e,t){e&&(this.prevValue=this.getValue(t)),this.prevDate=this.valueWithMinutes=t,"number"==typeof t&&(this.value&&+new Date(+this.value).setMilliseconds(0))===+t||this.setProperties({value:t},!0),!this.strictMode&&Object(s.X)(this.value)&&this.invalidValueString&&(this.checkErrorState(this.invalidValueString),this.updateInputValue(this.invalidValueString)),this.clearIconState()}setActiveDescendant(){Object(s.X)(this.selectedElement)?Object(s.x)(this.inputElement,{"aria-activedescendant":"null"}):Object(s.x)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})}removeSelection(){if(this.removeHover("e-hover"),!Object(s.X)(this.popupWrapper)){let e=this.popupWrapper.querySelectorAll(".e-active");e.length&&(Object(s.ib)(e,"e-active"),e[0].removeAttribute("aria-selected"))}}removeHover(e){let t=this.getHoverItem(e);t&&t.length&&(Object(s.ib)(t,e),"e-navigation"===e&&t[0].removeAttribute("aria-selected"))}getHoverItem(e){let t;return Object(s.X)(this.popupWrapper)||(t=this.popupWrapper.querySelectorAll("."+e)),t}setActiveClass(){if(!Object(s.X)(this.popupWrapper)){let e=this.popupWrapper.querySelectorAll(".e-list-item");if(e.length)for(let t=0;t<e.length;t++)if(!this.isBlazorServer&&this.timeCollections[t]===+this.getDateObject(this.valueWithMinutes)||this.isBlazorServer&&this.blazorTimeCollections[t]===this.blazorTimeCollections[this.activeIndex]){e[t].setAttribute("aria-selected","true"),this.selectedElement=e[t],this.activeIndex=t;break}}}addSelection(){this.selectedElement=null,this.removeSelection(),this.setActiveClass(),Object(s.X)(this.selectedElement)||(Object(s.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"))}isValidLI(e){return e&&e.classList.contains("e-list-item")&&!e.classList.contains("e-disabled")}createDateObj(e){let t=Object(s.W)()?"M"+Object(s.N)().dateSeperator+"d"+Object(s.N)().dateSeperator+"yy":null,i=this.globalize.formatDate(new Date,{format:t,skeleton:"short",type:"date"}),r=null;return"string"==typeof e?e.toUpperCase().indexOf("AM")>-1||e.toUpperCase().indexOf("PM")>-1?(i=this.defaultCulture.formatDate(new Date,{format:t,skeleton:"short",type:"date"}),r=isNaN(+new Date(i+" "+e))?null:new Date(new Date(i+" "+e).setMilliseconds(0)),Object(s.X)(r)&&(r=this.TimeParse(i,e))):r=this.TimeParse(i,e):e instanceof Date&&(r=e),r}TimeParse(e,t){let i;return i=this.globalize.parseDate(e+" "+t,{format:this.cldrDateFormat()+" "+this.cldrTimeFormat(),type:"datetime"}),i=Object(s.X)(i)?this.globalize.parseDate(e+" "+t,{format:this.cldrDateFormat()+" "+this.dateToNumeric(),type:"datetime"}):i,i=Object(s.X)(i)?i:new Date(i.setMilliseconds(0)),i}createListItems(){let e,t;this.listWrapper=this.createElement("div",{className:"e-content",attrs:{tabindex:"0"}});let i=6e4*this.step,r=[];for(this.timeCollections=[],this.disableItemCollection=[],e=+this.getDateObject(this.initMin).setMilliseconds(0),t=+this.getDateObject(this.initMax).setMilliseconds(0);t>=e;)this.timeCollections.push(e),r.push(this.globalize.formatDate(new Date(e),{format:this.cldrTimeFormat(),type:"time"})),e+=i;this.listTag=a.a.createList(this.createElement,r,{itemCreated:e=>{let t={element:e.item,text:e.text,value:this.getDateObject(e.text),isDisabled:!1};this.trigger("itemRender",t,e=>{e.isDisabled&&e.element.classList.add("e-disabled"),e.element.classList.contains("e-disabled")&&this.disableItemCollection.push(e.element.getAttribute("data-value"))})}},!0),Object(s.x)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),Object(s.w)([this.listTag],this.listWrapper)}documentClickHandler(e){let t=e.target;!Object(s.X)(this.popupObj)&&(this.inputWrapper.container.contains(t)||this.popupObj.element&&this.popupObj.element.contains(t))&&"touchstart"!==e.type&&e.preventDefault(),Object(s.C)(t,'[id="'+this.popupObj.element.id+'"]')||t===this.inputElement||t===(this.inputWrapper&&this.inputWrapper.buttons[0])||t===(this.inputWrapper&&this.inputWrapper.clearButton)||t===(this.inputWrapper&&this.inputWrapper.container)?t!==this.inputElement&&(s.d.isDevice||(this.isPreventBlur=(s.d.isIE||"edge"===s.d.info.name)&&document.activeElement===this.inputElement&&t===this.popupWrapper)):this.isPopupOpen()&&(this.hide(),this.focusOut())}setEnableRtl(){n.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())}setEnable(){n.c.setEnabled(this.enabled,this.inputElement,this.floatLabelType),this.enabled?(Object(s.ib)([this.inputWrapper.container],"e-disabled"),Object(s.x)(this.inputElement,{"aria-disabled":"false"}),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.hide(),Object(s.v)([this.inputWrapper.container],"e-disabled"),Object(s.x)(this.inputElement,{"aria-disabled":"true"}),this.inputElement.tabIndex=-1)}getProperty(e,t){"min"===t?(this.initMin=this.checkDateValue(new Date(this.checkInValue(e.min))),this.setProperties({min:this.initMin},!0)):(this.initMax=this.checkDateValue(new Date(this.checkInValue(e.max))),this.setProperties({max:this.initMax},!0)),""===this.inputElement.value?this.validateMinMax(this.value,this.min,this.max):this.checkValue(this.inputElement.value),this.checkValueChange(null,!1)}inputBlurHandler(e){this.enabled&&(this.isPreventBlur&&this.isPopupOpen()?this.inputElement.focus():(this.closePopup(0,e),Object(s.ib)([this.inputWrapper.container],[U]),this.trigger("blur",{model:this.isBlazorServer?null:this}),this.isBlazorServer||this.getText()===this.inputElement.value?0===this.inputElement.value.trim().length&&this.resetState():this.updateValue(this.inputElement.value,e),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnStrictMode",this.inputElement.value),this.cursorDetails=null,this.isNavigate=!1,""===this.inputElement.value&&(this.invalidValueString=null)))}focusOut(){document.activeElement===this.inputElement&&(this.inputElement.blur(),Object(s.ib)([this.inputWrapper.container],[U]),this.trigger("blur",{model:this.isBlazorServer?null:this}))}isPopupOpen(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains(""+K))}inputFocusHandler(){if(!this.enabled)return;let e={model:this.isBlazorServer?null:this};this.readonly||s.d.isDevice||this.selectInputText(),this.trigger("focus",e),this.clearIconState(),this.openOnFocus&&this.show()}focusIn(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()}hide(){this.closePopup(100,null),this.clearIconState()}show(e){this.enabled&&this.readonly||!this.enabled||this.popupWrapper||(this.popupCreation(),s.d.isDevice&&this.listWrapper&&(this.modal=this.createElement("div"),this.modal.className=K+" e-time-modal",document.body.className+=" e-time-overflow",document.body.appendChild(this.modal)),s.d.isDevice&&(this.mobileTimePopupWrap=this.createElement("div",{className:"e-timepicker-mob-popup-wrap"}),document.body.appendChild(this.mobileTimePopupWrap)),this.openPopupEventArgs={popup:this.isBlazorServer?null:this.popupObj||null,cancel:!1,event:e||null,name:"open",appendTo:s.d.isDevice?this.mobileTimePopupWrap:document.body},this.trigger("open",this.openPopupEventArgs,e=>{if(Object(s.W)()&&this.isServerRendered&&(e.popup=this.popupObj||null),this.openPopupEventArgs=e,this.openPopupEventArgs.cancel||this.inputWrapper.buttons[0].classList.contains("e-disabled"))this.popupObj.destroy(),this.isBlazorServer&&(this.disposeServerPopup(),this.inputWrapper.container.parentElement.insertBefore(this.popupWrapper,this.inputWrapper.container.nextElementSibling),this.interopAdaptor.invokeMethodAsync("OnPopupHide",!1)),this.popupWrapper=this.listTag=void 0,this.liCollections=this.timeCollections=this.disableItemCollection=[],this.popupObj=null;else{this.isBlazorServer&&(this.popupWrapper.style.visibility="",this.popupWrapper.style.width=this.inputWrapper.container.offsetWidth+"px",this.popupWrapper.style.height="auto"),this.isBlazorServer&&(this.openPopupEventArgs.popup=this.popupObj),this.openPopupEventArgs.appendTo.appendChild(this.popupWrapper),this.popupAlignment(this.openPopupEventArgs),this.setScrollPosition(),s.d.isDevice||this.inputElement.focus();let e={name:"FadeIn",duration:50};this.popupObj.refreshPosition(this.anchor),this.popupObj.show(new s.b(e),1e3===this.zIndex?this.element:null),this.setActiveDescendant(),Object(s.x)(this.inputElement,{"aria-expanded":"true"}),Object(s.v)([this.inputWrapper.container],U),s.l.add(document,"mousedown touchstart",this.documentClickHandler,this),this.setOverlayIndex(this.mobileTimePopupWrap,this.popupObj.element,this.modal,s.d.isDevice)}}))}setOverlayIndex(e,t,i,r){if(r&&!Object(s.X)(t)&&!Object(s.X)(i)&&!Object(s.X)(e)){let s=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(s-1).toString(),e.style.zIndex=s.toString()}}formatValues(e){let t;return"number"==typeof e?t=Object(s.L)(e):"string"==typeof e&&(t=e.match(/px|%|em/)||isNaN(parseInt(e,10))?e:Object(s.L)(e)),t}popupAlignment(e){if(e.popup.position.X=this.formatValues(e.popup.position.X),e.popup.position.Y=this.formatValues(e.popup.position.Y),isNaN(parseFloat(e.popup.position.X))&&isNaN(parseFloat(e.popup.position.Y))||(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.targetType="container"),isNaN(parseFloat(e.popup.position.X))||(this.popupObj.offsetX=parseFloat(e.popup.position.X)),isNaN(parseFloat(e.popup.position.Y))||(this.popupObj.offsetY=parseFloat(e.popup.position.Y)),s.d.isDevice)"center"===e.popup.position.X&&"center"===e.popup.position.Y&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.offsetY=0,this.popupObj.targetType="container",this.popupObj.collision={X:"fit",Y:"fit"});else{switch(e.popup.position.X){case"left":break;case"right":e.popup.offsetX=this.containerStyle.width;break;case"center":e.popup.offsetX=-this.containerStyle.width/2}switch(e.popup.position.Y){case"top":case"bottom":break;case"center":e.popup.offsetY=-this.containerStyle.height/2}"center"===e.popup.position.X&&"center"===e.popup.position.Y&&(this.popupObj.relateTo=this.inputWrapper.container,this.anchor=this.inputElement,this.popupObj.targetType="relative")}}getPersistData(){return this.addOnPersist(["value"])}getModuleName(){return"timepicker"}onPropertyChanged(e,t){for(let i of Object.keys(e))switch(i){case"placeholder":n.c.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"readonly":n.c.setReadonly(this.readonly,this.inputElement,this.floatLabelType),this.readonly&&this.hide(),this.setTimeAllowEdit();break;case"enabled":this.setProperties({enabled:e.enabled},!0),this.setEnable();break;case"allowEdit":this.setTimeAllowEdit();break;case"enableRtl":this.isBlazorServer||(this.setProperties({enableRtl:e.enableRtl},!0),this.setEnableRtl());break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"min":case"max":this.isBlazorServer||this.getProperty(e,i);break;case"showClearButton":n.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"locale":this.setProperties({locale:e.locale},!0),this.globalize=new s.n(this.locale),this.l10n.setLocale(this.locale),this.updatePlaceHolder(),this.isBlazorServer||this.setValue(this.value);break;case"width":Object(s.ob)(this.inputWrapper.container,{width:this.setWidth(e.width)}),this.containerStyle=this.inputWrapper.container.getBoundingClientRect();break;case"format":this.setProperties({format:e.format},!0),this.checkTimeFormat(),this.isBlazorServer||this.setValue(this.value);break;case"value":this.isBlazorServer||(this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.invalidValueString?(this.updateInputValue(this.invalidValueString),this.checkErrorState(this.invalidValueString)):("string"==typeof e.value?(this.setProperties({value:this.checkDateValue(new Date(e.value))},!0),e.value=this.value):(e.value&&+new Date(+e.value).setMilliseconds(0))!==+this.value&&(e.value=this.checkDateValue(new Date(""+e.value))),this.initValue=e.value,e.value=this.compareFormatChange(this.checkValue(e.value))),this.checkValueChange(null,!1),this.isAngular&&this.preventChange&&(this.preventChange=!1));break;case"floatLabelType":this.floatLabelType=e.floatLabelType,n.c.removeFloating(this.inputWrapper),n.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"strictMode":this.isBlazorServer||(this.invalidValueString=null,e.strictMode&&this.checkErrorState(null),this.setProperties({strictMode:e.strictMode},!0),this.checkValue(this.inputElement.value),this.checkValueChange(null,!1));break;case"scrollTo":this.isBlazorServer?this.popupWrapper&&this.setScrollTo():this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))?(this.popupWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0)}}checkInValue(e){return e instanceof Date?e.toUTCString():""+e}};return N([Object(s.s)(null)],e.prototype,"width",void 0),N([Object(s.s)(null)],e.prototype,"cssClass",void 0),N([Object(s.s)(!1)],e.prototype,"strictMode",void 0),N([Object(s.s)(null)],e.prototype,"keyConfigs",void 0),N([Object(s.s)(null)],e.prototype,"format",void 0),N([Object(s.s)(!0)],e.prototype,"enabled",void 0),N([Object(s.s)(!1)],e.prototype,"readonly",void 0),N([Object(s.s)({})],e.prototype,"htmlAttributes",void 0),N([Object(s.s)("Never")],e.prototype,"floatLabelType",void 0),N([Object(s.s)(null)],e.prototype,"placeholder",void 0),N([Object(s.s)(1e3)],e.prototype,"zIndex",void 0),N([Object(s.s)(!1)],e.prototype,"enablePersistence",void 0),N([Object(s.s)(!0)],e.prototype,"showClearButton",void 0),N([Object(s.s)(30)],e.prototype,"step",void 0),N([Object(s.s)(null)],e.prototype,"scrollTo",void 0),N([Object(s.s)(null)],e.prototype,"value",void 0),N([Object(s.s)(null)],e.prototype,"min",void 0),N([Object(s.s)(null)],e.prototype,"max",void 0),N([Object(s.s)(!0)],e.prototype,"allowEdit",void 0),N([Object(s.s)(!1)],e.prototype,"openOnFocus",void 0),N([Object(s.k)()],e.prototype,"change",void 0),N([Object(s.k)()],e.prototype,"created",void 0),N([Object(s.k)()],e.prototype,"destroyed",void 0),N([Object(s.k)()],e.prototype,"open",void 0),N([Object(s.k)()],e.prototype,"itemRender",void 0),N([Object(s.k)()],e.prototype,"close",void 0),N([Object(s.k)()],e.prototype,"cleared",void 0),N([Object(s.k)()],e.prototype,"blur",void 0),N([Object(s.k)()],e.prototype,"focus",void 0),e=N([s.q],e),e})();var J=function(e,t,i,s){var r,n=arguments.length,l=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(n<3?r(l):n>3?r(t,i,l):r(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};const $=(new Date).getDate(),Z=(new Date).getMonth(),ee=(new Date).getFullYear(),te=(new Date).getHours(),ie=(new Date).getMinutes(),se=(new Date).getSeconds(),re=(new Date).getMilliseconds(),ne="e-datetimepicker";let le=(()=>{let e=class extends w{constructor(e,t){super(e,t),this.valueWithMinutes=null,this.scrollInvoked=!1,this.dateTimeOptions=e}focusHandler(){this.enabled&&Object(s.v)([this.inputWrapper.container],"e-input-focus")}focusIn(){super.focusIn()}focusOut(){document.activeElement===this.inputElement&&(this.inputElement.blur(),Object(s.ib)([this.inputWrapper.container],["e-input-focus"]))}blurHandler(e){if(!this.enabled)return;if(this.isTimePopupOpen()&&this.isPreventBlur)return void this.inputElement.focus();Object(s.ib)([this.inputWrapper.container],"e-input-focus");let t={model:Object(s.W)()&&this.isServerRendered?null:this};this.isTimePopupOpen()&&this.hide(e),this.trigger("blur",t)}destroy(){this.popupObject&&this.popupObject.element.classList.contains("e-popup")&&(this.popupObject.destroy(),Object(s.I)(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],Object(s.X)(this.rippleFn)||this.rippleFn()),this.inputElement&&(n.c.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false","aria-haspopup":"true","aria-activedescendant":"null",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off"},this.inputElement),this.inputElement.removeAttribute("aria-placeholder")),this.isCalendar()&&(this.popupWrapper&&Object(s.I)(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),super.destroy()}render(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,super.updateHtmlAttributeToElement(),this.checkAttributes(!1),this.l10n=new s.p("datetimepicker",{placeholder:this.placeholder},this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),super.render(),this.createInputElement(),super.updateHtmlAttributeToWrapper(),this.bindInputEvents(),this.setValue(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),"EJS-DATETIMEPICKER"===this.element.tagName&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.renderComplete()}setValue(){if(this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){let e=this.validateMinMaxRange(this.initValue);n.c.setValue(this.getFormattedValue(e),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:e},!0)}else Object(s.X)(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,super.updateInput()}validateMinMaxRange(e){let t=e;return this.isDateObject(e)?t=this.validateValue(e):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(t),t}checkValidState(e){this.isValidState=!0,this.strictMode||(+e>+this.max||+e<+this.min)&&(this.isValidState=!1),this.checkErrorState()}checkErrorState(){this.isValidState?Object(s.ib)([this.inputWrapper.container],"e-error"):Object(s.v)([this.inputWrapper.container],"e-error"),Object(s.x)(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})}validateValue(e){let t=e;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),t=this.max):+e<+this.min?t=this.min:+e>+this.max&&(t=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),t=e),t}disablePopupButton(e){e?(Object(s.v)([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled"),this.hide()):Object(s.ib)([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled")}getFormattedValue(e){let t;return Object(s.X)(e)?null:(t="Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(e,t))}isDateObject(e){return!Object(s.X)(e)&&!isNaN(+e)}createInputElement(){Object(s.ib)([this.inputElement],"e-datepicker"),Object(s.ib)([this.inputWrapper.container],"e-date-wrapper"),Object(s.v)([this.inputWrapper.container],"e-datetime-wrapper"),Object(s.v)([this.inputElement],ne),this.renderTimeIcon()}renderTimeIcon(){this.timeIcon=n.c.appendSpan("e-input-group-icon e-time-icon e-icons",this.inputWrapper.container)}bindInputEvents(){s.l.add(this.timeIcon,"mousedown",this.timeHandler,this),s.l.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),s.l.add(this.inputElement,"blur",this.blurHandler,this),s.l.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=Object(s.K)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new s.o(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})}unBindInputEvents(){s.l.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),s.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(s.l.remove(this.inputElement,"blur",this.blurHandler),s.l.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()}cldrTimeFormat(){let e;return e=this.isNullOrEmpty(this.timeFormat)?"en"===this.locale||"en-US"===this.locale?Object(s.W)()?Object(s.V)("t",Object(s.V)(this.locale,s.y)).replace(/tt/,"a"):Object(s.V)("timeFormats.short",Object(s.N)()):this.getCultureTimeObject(s.B,""+this.locale):this.timeFormat,e}cldrDateTimeFormat(){let e,t=new s.n(this.locale).getDatePattern({skeleton:Object(s.W)()?"d":"yMd"});return e=this.isNullOrEmpty(this.formatString)?t+" "+this.getCldrFormat("time"):this.formatString,e}getCldrFormat(e){let t;return t="en"===this.locale||"en-US"===this.locale?Object(s.W)()?Object(s.V)("t",Object(s.V)(this.locale,s.y)).replace(/tt/,"a"):Object(s.V)("timeFormats.short",Object(s.N)()):this.getCultureTimeObject(s.B,""+this.locale),t}isNullOrEmpty(e){return!!(Object(s.X)(e)||"string"==typeof e&&""===e.trim())}getCultureTimeObject(e,t){return"Gregorian"===this.calendarMode?Object(s.W)()?Object(s.V)("t",Object(s.V)(this.locale,s.y)).replace(/tt/,"a"):Object(s.V)("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",e):Object(s.V)("main."+this.locale+".dates.calendars.islamic.timeFormats.short",e)}timeHandler(e){this.enabled&&(this.isIconClicked=!0,s.d.isDevice&&this.inputElement.setAttribute("readonly",""),e.currentTarget===this.timeIcon&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&super.hide(e),this.isTimePopupOpen()?this.closePopup(e):(this.inputElement.focus(),this.popupCreation("time",e),Object(s.v)([this.inputWrapper.container],["e-input-focus"]))),this.isIconClicked=!1)}dateHandler(e){this.enabled&&(e.currentTarget===this.inputWrapper.buttons[0]&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(e),Object(s.X)(this.popupWrapper)||this.popupCreation("date",e)))}show(e,t){this.enabled&&this.readonly||!this.enabled||("time"!==e||this.dateTimeWrapper?this.popupObj||(this.isTimePopupOpen()&&this.hide(t),super.show(),this.popupCreation("date",t)):(this.isDatePopupOpen()&&this.hide(t),this.popupCreation("time",t)))}toggle(e){this.isDatePopupOpen()?(super.hide(e),this.show("time",null)):this.isTimePopupOpen()?(this.hide(e),super.show(null,e),this.popupCreation("date",null)):this.show(null,e)}listCreation(){let e;e=this.globalize.parseDate(this.inputElement.value,"Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"datetime"}:{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});let t=Object(s.X)(this.value)?""!==this.inputElement.value?e:new Date:this.value;this.valueWithMinutes=t,this.listWrapper=Object(s.F)("div",{className:"e-content",attrs:{tabindex:"0"}});let i=this.startTime(t),r=this.endTime(t),n=_.createListItems(this.createElement,i,r,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=n.collection,this.listTag=n.list,Object(s.x)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),Object(s.w)([n.list],this.listWrapper),this.wireTimeListEvents(),this.rippleFn=Object(s.kb)(this.listWrapper,{duration:300,selector:".e-list-item"}),this.liCollections=this.listWrapper.querySelectorAll(".e-list-item")}popupCreation(e,t){s.d.isDevice&&this.element.setAttribute("readonly","readonly"),"date"===e?!this.readonly&&this.popupWrapper&&(Object(s.v)([this.popupWrapper],"e-datetimepopup-wrapper"),Object(s.x)(this.popupWrapper,{id:this.element.id+"_datepopup"})):this.readonly||(this.dateTimeWrapper=Object(s.F)("div",{className:ne+" e-popup",attrs:{id:this.element.id+"_timepopup",style:"visibility:hidden ; display:block"}}),Object(s.X)(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!Object(s.X)(this.step)&&this.step>0&&(this.listCreation(),Object(s.w)([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(t),this.popupObject.refreshPosition(this.inputElement))}openPopup(e){this.preventArgs={cancel:!1,popup:Object(s.W)()&&this.isServerRendered?null:this.popupObject,event:e||null},this.trigger("open",this.preventArgs,e=>{this.preventArgs=e,this.preventArgs.cancel||this.readonly||(this.popupObject.show(new s.b({name:"FadeIn",duration:100}),1e3===this.zIndex?this.element:null),Object(s.v)([this.inputWrapper.container],["e-icon-anim"]),Object(s.x)(this.inputElement,{"aria-expanded":"true"}),s.l.add(document,"mousedown touchstart",this.documentClickHandler,this))})}documentClickHandler(e){let t=e.target;!Object(s.X)(this.popupObject)&&(this.inputWrapper.container.contains(t)||this.popupObject.element&&this.popupObject.element.contains(t))&&"touchstart"!==e.type&&e.preventDefault(),Object(s.C)(t,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))||t===this.inputElement||t===this.timeIcon||t===this.inputWrapper.container?t!==this.inputElement&&(s.d.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(s.d.isIE||"edge"===s.d.info.name)&&t===this.popupObject.element)):this.isTimePopupOpen()&&(this.hide(e),this.focusOut())}isTimePopupOpen(){return!(!this.dateTimeWrapper||!this.dateTimeWrapper.classList.contains(""+ne))}isDatePopupOpen(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-datetimepopup-wrapper"))}renderPopup(){this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),s.d.isDevice&&(this.timeModal=Object(s.F)("div"),this.timeModal.className=ne+" e-time-modal",document.body.className+=" e-time-overflow",this.timeModal.style.display="block",document.body.appendChild(this.timeModal)),this.popupObject=new r.c(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:s.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:s.d.isDevice?document.body:this.inputWrapper.container,position:s.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:4,open:()=>{this.dateTimeWrapper.style.visibility="visible",Object(s.v)([this.timeIcon],"e-active"),s.d.isDevice||(this.timekeyConfigure=Object(s.K)(this.timekeyConfigure,this.keyConfigs),this.inputEvent=new s.o(this.inputWrapper.container,{keyAction:this.TimeKeyActionHandle.bind(this),keyConfigs:this.timekeyConfigure,eventName:"keydown"}))},close:()=>{Object(s.ib)([this.timeIcon],"e-active"),this.unWireTimeListEvents(),this.inputElement.setAttribute("aria-activedescendant","null"),Object(s.hb)(this.popupObject.element),this.popupObject.destroy(),this.dateTimeWrapper.innerHTML="",this.listWrapper=this.dateTimeWrapper=void 0,this.inputEvent&&this.inputEvent.destroy()},targetExitViewport:()=>{s.d.isDevice||this.hide()}}),this.popupObject.element.style.maxHeight="250px"}setDimension(e){return"number"==typeof e?Object(s.L)(e):"string"==typeof e?e:"100%"}setPopupWidth(){let e=this.setDimension(this.width);return e.indexOf("%")>-1&&(e=(this.containerStyle.width*parseFloat(e)/100).toString()+"px"),e}wireTimeListEvents(){s.l.add(this.listWrapper,"click",this.onMouseClick,this),s.d.isDevice||(s.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),s.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this))}unWireTimeListEvents(){this.listWrapper&&(s.l.remove(this.listWrapper,"click",this.onMouseClick),s.l.remove(document,"mousedown touchstart",this.documentClickHandler),s.d.isDevice||(s.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),s.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))}onMouseOver(e){let t=Object(s.C)(e.target,".e-list-item");this.setTimeHover(t,"e-hover")}onMouseLeave(){this.removeTimeHover("e-hover")}setTimeHover(e,t){this.enabled&&this.isValidLI(e)&&!e.classList.contains(t)&&(this.removeTimeHover(t),Object(s.v)([e],t))}getPopupHeight(){let e=parseInt("250px",10),t=this.dateTimeWrapper.getBoundingClientRect().height;return t>e?e:t}changeEvent(e){(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(super.changeEvent(e),this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))}updateValue(e){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:e||null,isInteracted:!Object(s.X)(e),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.value)}setTimeScrollPosition(){let e;e=this.selectedElement,Object(s.X)(e)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)}findScrollTop(e){let t=this.getPopupHeight(),i=e.nextElementSibling,s=i?i.offsetTop:e.offsetTop,r=e.getBoundingClientRect().height;this.dateTimeWrapper.scrollTop=s+e.offsetTop>t?i?s-(t/2+r/2):s:0}setScrollTo(){let e,t=this.dateTimeWrapper.querySelectorAll(".e-list-item");if(t.length>=0){this.scrollInvoked=!0;let i=this.timeCollections[0],s=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=t[Math.round((s-i)/(6e4*this.step))]}else this.dateTimeWrapper.scrollTop=0;Object(s.X)(e)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(e)}setInputValue(e){if("date"===e)this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{let e=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));n.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0)}this.updateIconState()}getFullDateTime(){let e=null;return e=this.isDateObject(this.valueWithMinutes)?this.combineDateTime(this.valueWithMinutes):this.previousDate,this.validateMinMaxRange(e)}combineDateTime(e){if(this.isDateObject(e)){let t=this.previousDate.getDate(),i=this.previousDate.getMonth(),s=this.previousDate.getFullYear(),r=e.getHours(),n=e.getMinutes(),l=e.getSeconds();return new Date(s,i,t,r,n,l)}return this.previousDate}onMouseClick(e){let t=e.target,i=this.selectedElement=Object(s.C)(t,".e-list-item");i&&i.classList.contains("e-list-item")&&(this.timeValue=i.getAttribute("data-value"),this.hide(e)),this.setSelection(i,e)}setSelection(e,t){if(this.isValidLI(e)&&!e.classList.contains("e-active")){e.getAttribute("data-value"),this.selectedElement=e;let i=Array.prototype.slice.call(this.liCollections).indexOf(e);this.activeIndex=i,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Object(s.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(t)}}setTimeActiveClass(){let e=Object(s.X)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!Object(s.X)(e)){let t=e.querySelectorAll(".e-list-item");if(t.length)for(let e=0;e<t.length;e++)if(this.timeCollections[e]===+this.valueWithMinutes){t[e].setAttribute("aria-selected","true"),this.selectedElement=t[e],this.activeIndex=e,this.setTimeActiveDescendant();break}}}setTimeActiveDescendant(){Object(s.X)(this.selectedElement)?Object(s.x)(this.inputElement,{"aria-activedescendant":"null"}):Object(s.x)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})}addTimeSelection(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),Object(s.X)(this.selectedElement)||(Object(s.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"))}removeTimeSelection(){if(this.removeTimeHover("e-hover"),!Object(s.X)(this.dateTimeWrapper)){let e=this.dateTimeWrapper.querySelectorAll(".e-active");e.length&&(Object(s.ib)(e,"e-active"),e[0].removeAttribute("aria-selected"))}}removeTimeHover(e){let t=this.getTimeHoverItem(e);t&&t.length&&Object(s.ib)(t,e)}getTimeHoverItem(e){let t,i=Object(s.X)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;return Object(s.X)(i)||(t=i.querySelectorAll("."+e)),t}isValidLI(e){return e&&e.classList.contains("e-list-item")&&!e.classList.contains("e-disabled")}calculateStartEnd(e,t,i){let s=e.getDate(),r=e.getMonth(),n=e.getFullYear(),l=e.getHours(),a=e.getMinutes(),o=e.getSeconds(),h=e.getMilliseconds();return t?"starttime"===i?new Date(n,r,s,0,0,0):new Date(n,r,s,23,59,59):new Date(n,r,s,l,a,o,h)}startTime(e){let t,i,s,r=this.min;return s=null===e?new Date:e,+s.getDate()==+r.getDate()&&+s.getMonth()==+r.getMonth()&&+s.getFullYear()==+r.getFullYear()||+new Date(s.getFullYear(),s.getMonth(),s.getDate())<=+new Date(r.getFullYear(),r.getMonth(),r.getDate())?(i=!1,t=this.min):+s<+this.max&&+s>+this.min?(i=!0,t=s):+s>=+this.max&&(i=!0,t=this.max),this.calculateStartEnd(t,i,"starttime")}endTime(e){let t,i,s,r=this.max;return s=null===e?new Date:e,+s.getDate()==+r.getDate()&&+s.getMonth()==+r.getMonth()&&+s.getFullYear()==+r.getFullYear()||+new Date(s.getUTCFullYear(),s.getMonth(),s.getDate())>=+new Date(r.getFullYear(),r.getMonth(),r.getDate())?(i=!1,t=this.max):+s<+this.max&&+s>+this.min?(i=!0,t=s):+s<=+this.min&&(i=!0,t=this.min),this.calculateStartEnd(t,i,"endtime")}hide(e){if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:Object(s.W)()&&this.isServerRendered?null:this.popupObj||this.popupObject,event:e||null};let t=this.preventArgs;Object(s.X)(this.popupObj)?this.trigger("close",t,t=>{this.dateTimeCloseEventCallback(e,t)}):this.dateTimeCloseEventCallback(e,t)}else s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}dateTimeCloseEventCallback(e,t){this.preventArgs=t,this.preventArgs.cancel||(this.isDatePopupOpen()?super.hide(e):this.isTimePopupOpen()&&(this.closePopup(e),Object(s.ib)([document.body],"e-time-overflow"),s.d.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),s.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}closePopup(e){this.isTimePopupOpen()&&this.popupObject&&(this.popupObject.hide(new s.b({name:"FadeOut",duration:100,delay:0})),this.inputWrapper.container.classList.remove("e-icon-anim"),Object(s.x)(this.inputElement,{"aria-expanded":"false"}),s.l.remove(document,"mousedown touchstart",this.documentClickHandler))}preRender(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),super.preRender(),Object(s.ib)([this.inputElementCopy],[ne])}getProperty(e,t){this.setProperties("min"===t?{min:this.validateValue(e.min)}:{max:this.validateValue(e.max)},!0)}checkAttributes(e){let t,i=e?Object(s.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"];for(let r of i)if(!Object(s.X)(this.inputElement.getAttribute(r)))switch(r){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(r));break;case"step":this.step=parseInt(this.inputElement.getAttribute(r),10);break;case"readonly":if(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.readonly||e){let t="disabled"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({readonly:t},!e)}break;case"placeholder":(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e);break;case"min":(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.min||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({min:t},!e));break;case"disabled":if(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.enabled||e){let t="disabled"!==this.inputElement.getAttribute(r)&&"true"!==this.inputElement.getAttribute(r)&&""!==this.inputElement.getAttribute(r);this.setProperties({enabled:t},!e)}break;case"value":(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.value||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({value:t},!e));break;case"max":(Object(s.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.max||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({max:t},!e))}}requiredModules(){let e=[];return this&&e.push({args:[this],member:"islamic"}),e}getTimeActiveElement(){return Object(s.X)(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll(".e-active")}createDateObj(e){return e instanceof Date?e:null}getDateObject(e){if(!this.isNullOrEmpty(e)){let t=this.createDateObj(e),i=this.valueWithMinutes,r=!Object(s.X)(i);if(this.checkDateValue(t)){let e=r?i.getDate():$,s=r?i.getMonth():Z,n=r?i.getFullYear():ee,l=r?i.getHours():te,a=r?i.getMinutes():ie,o=r?i.getSeconds():se,h=r?i.getMilliseconds():re;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(n,s,e,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())):new Date(n,s,e,l,a,o,h)}}return null}findNextTimeElement(e){let t=this.inputElement.value,i=Object(s.X)(this.valueWithMinutes)?this.createDateObj(t):this.getDateObject(this.valueWithMinutes),r=null,n=this.liCollections.length;if(!Object(s.X)(this.activeIndex)||!Object(s.X)(this.checkDateValue(i))){if("home"===e.action)r=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if("end"===e.action)r=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if("down"===e.action){for(let e=0;e<n;e++)if(+i<this.timeCollections[e]){r=+this.createDateObj(new Date(this.timeCollections[e])),this.activeIndex=e;break}}else for(let e=n-1;e>=0;e--)if(+i>this.timeCollections[e]){r=+this.createDateObj(new Date(this.timeCollections[e])),this.activeIndex=e;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(Object(s.X)(r)?null:new Date(r))}}setTimeValue(e,t){let i,r,l=this.validateMinMaxRange(t),a=this.createDateObj(l);return this.getFormattedValue(a)!==(Object(s.X)(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=Object(s.X)(a)?null:a,r=new Date(+this.valueWithMinutes)):(this.strictMode&&(e=a),this.valueWithMinutes=this.checkDateValue(e),r=new Date(+this.valueWithMinutes)),i=this.globalize.formatDate(r,"Gregorian"===this.calendarMode?{format:Object(s.X)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:Object(s.W)()?"d":"yMd"}:{format:Object(s.X)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&Object(s.X)(r),n.c.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),r}timeElementValue(e){if(!Object(s.X)(this.checkDateValue(e))&&!this.isNullOrEmpty(e)){let t=e instanceof Date?e:this.getDateObject(e);return this.setTimeValue(t,e)}return null}timeKeyHandler(e){if(Object(s.X)(this.step)||this.step<=0)return;let t=this.timeCollections.length;if(Object(s.X)(this.getTimeActiveElement())||0===this.getTimeActiveElement().length)this.liCollections.length>0&&(Object(s.X)(this.value)&&Object(s.X)(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(e));else{let i;if(e.keyCode>=37&&e.keyCode<=40){let r=40===e.keyCode||39===e.keyCode?++this.activeIndex:--this.activeIndex;this.activeIndex=r=this.activeIndex===t?0:this.activeIndex,this.activeIndex=r=this.activeIndex<0?t-1:this.activeIndex,i=Object(s.X)(this.timeCollections[r])?this.timeCollections[0]:this.timeCollections[r]}else"home"===e.action?(this.activeIndex=0,i=this.timeCollections[0]):"end"===e.action&&(this.activeIndex=t-1,i=this.timeCollections[t-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(i))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,"e-navigation"),this.setTimeActiveDescendant(),!this.isTimePopupOpen()||null===this.selectedElement||e&&"click"===e.type||this.setTimeScrollPosition()}TimeKeyActionHandle(e){if(this.enabled)switch("right"!==e.action&&"left"!==e.action&&"tab"!==e.action&&e.preventDefault(),e.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(e),this.hide(e),Object(s.v)([this.inputWrapper.container],"e-input-focus"),this.isNavigate=!1,e.stopPropagation();break;case"escape":this.hide(e);break;default:this.isNavigate=!1}}inputKeyAction(e){switch(e.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(e)}}onPropertyChanged(e,t){for(let i of Object.keys(e)){switch(i){case"value":this.cldrDateTimeFormat(),Object(s.W)(),this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,e.value=this.validateValue(e.value),n.c.setValue(this.getFormattedValue(e.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=e.value,this.setProperties({value:e.value},!0),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null);break;case"min":case"max":this.getProperty(e,i),this.updateInput();break;case"enableRtl":n.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":Object(s.X)(t.cssClass)||(t.cssClass=t.cssClass.replace(/\s+/g," ").trim()),Object(s.X)(e.cssClass)||(e.cssClass=e.cssClass.replace(/\s+/g," ").trim()),n.c.setCssClass(e.cssClass,[this.inputWrapper.container],t.cssClass),this.dateTimeWrapper&&n.c.setCssClass(e.cssClass,[this.dateTimeWrapper],t.cssClass);break;case"locale":this.globalize=new s.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),n.c.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement),this.dateTimeFormat=this.cldrDateTimeFormat(),super.updateInput();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue();break;case"placeholder":n.c.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"enabled":n.c.setEnabled(this.enabled,this.inputElement),this.enabled||(this.inputElement.tabIndex=-1);break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width);break;case"readonly":n.c.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,n.c.removeFloating(this.inputWrapper),n.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(e.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;default:super.onPropertyChanged(e,t)}this.hide(null)}}getModuleName(){return"datetimepicker"}restoreValue(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=Object(s.X)(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)}};return J([Object(s.s)(null)],e.prototype,"timeFormat",void 0),J([Object(s.s)(30)],e.prototype,"step",void 0),J([Object(s.s)(null)],e.prototype,"scrollTo",void 0),J([Object(s.s)(1e3)],e.prototype,"zIndex",void 0),J([Object(s.s)(null)],e.prototype,"value",void 0),J([Object(s.s)(null)],e.prototype,"keyConfigs",void 0),J([Object(s.s)({})],e.prototype,"htmlAttributes",void 0),J([Object(s.s)(!1)],e.prototype,"enablePersistence",void 0),J([Object(s.s)(!0)],e.prototype,"allowEdit",void 0),J([Object(s.s)(!1)],e.prototype,"isMultiSelection",void 0),J([Object(s.s)(null)],e.prototype,"values",void 0),J([Object(s.s)(!0)],e.prototype,"showClearButton",void 0),J([Object(s.s)(null)],e.prototype,"placeholder",void 0),J([Object(s.s)(!1)],e.prototype,"strictMode",void 0),J([Object(s.s)(null)],e.prototype,"serverTimezoneOffset",void 0),J([Object(s.s)(new Date(1900,0,1))],e.prototype,"min",void 0),J([Object(s.s)(new Date(2099,11,31))],e.prototype,"max",void 0),J([Object(s.s)(null)],e.prototype,"firstDayOfWeek",void 0),J([Object(s.s)("Gregorian")],e.prototype,"calendarMode",void 0),J([Object(s.s)("Month")],e.prototype,"start",void 0),J([Object(s.s)("Month")],e.prototype,"depth",void 0),J([Object(s.s)(!1)],e.prototype,"weekNumber",void 0),J([Object(s.s)(!0)],e.prototype,"showTodayButton",void 0),J([Object(s.s)("Short")],e.prototype,"dayHeaderFormat",void 0),J([Object(s.s)(!1)],e.prototype,"openOnFocus",void 0),J([Object(s.k)()],e.prototype,"open",void 0),J([Object(s.k)()],e.prototype,"close",void 0),J([Object(s.k)()],e.prototype,"cleared",void 0),J([Object(s.k)()],e.prototype,"blur",void 0),J([Object(s.k)()],e.prototype,"focus",void 0),J([Object(s.k)()],e.prototype,"created",void 0),J([Object(s.k)()],e.prototype,"destroyed",void 0),e=J([s.q],e),e})()}}]);