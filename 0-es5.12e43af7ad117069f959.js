!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var i=[],n=!0,r=!1,s=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(o){r=!0,s=o}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return i}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,n||e)}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=o(e);if(t){var r=o(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=u(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==i.return||i.return()}finally{if(l)throw s}}}}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&g(e.prototype,t),i&&g(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"GJ+o":function(r,a,u){"use strict";u.d(a,"d",(function(){return ns})),u.d(a,"e",(function(){return rs})),u.d(a,"a",(function(){return hs})),u.d(a,"b",(function(){return cs})),u.d(a,"k",(function(){return ys})),u.d(a,"j",(function(){return Ks})),u.d(a,"h",(function(){return ws})),u.d(a,"l",(function(){return ks})),u.d(a,"r",(function(){return Ss})),u.d(a,"s",(function(){return Os})),u.d(a,"p",(function(){return Rs})),u.d(a,"t",(function(){return Es})),u.d(a,"q",(function(){return Ms})),u.d(a,"f",(function(){return Ts})),u.d(a,"o",(function(){return As})),u.d(a,"g",(function(){return zs})),u.d(a,"i",(function(){return qs})),u.d(a,"c",(function(){return Hs})),u.d(a,"n",(function(){return Js})),u.d(a,"m",(function(){return $s}));var d=u("fXoL"),g=u("k5hD"),m=u("4SUy"),v=u("H552"),b=u("Naoh"),y=u("TF3C"),C=u("ngVE"),w=u("OyPL"),k=u("gnsf"),S=u("5YkT"),O=u("4jY0"),x=u("eNK/"),j=function(){function e(t){p(this,e),this.intl=new m.n,Object(m.X)(t)||(this.intl.culture=t)}return f(e,[{key:"getFormatFunction",value:function(e){return e.type?(Object(m.W)()&&(e.isServerRendered=!0),this.intl.getDateFormat(e)):this.intl.getNumberFormat(e)}},{key:"getParserFunction",value:function(e){return e.type?(Object(m.W)()&&(e.isServerRendered=!0),this.intl.getDateParser(e)):this.intl.getNumberParser(e)}},{key:"fromView",value:function(e,t,i){return"date"!==i&&"datetime"!==i&&"number"!==i||Object(m.X)(t)?e:t(e)}},{key:"toView",value:function(e,t){var i=e;return Object(m.X)(t)||Object(m.X)(e)||(i=t(e)),i}},{key:"setCulture",value:function(e){Object(m.X)(e)||Object(m.nb)(e)}}]),e}(),R=function(){function e(t,i){var n=this;p(this,e),this.disableHtmlEncode=!0,this.allowSorting=!0,this.allowResizing=!0,this.allowFiltering=!0,this.allowGrouping=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.enableGroupByFormat=!1,this.allowEditing=!0,this.filter={},this.showInColumnChooser=!0,this.edit={},this.allowSearching=!0,this.autoFit=!1,this.sortDirection="Descending",this.getEditTemplate=function(){return n.editTemplateFn},this.getFilterTemplate=function(){return n.filterTemplateFn},Object(m.db)(this,t),this.parent=i,"none"===this.type?this.type=Object(m.W)()&&!Object(m.X)(this.template)&&Object(m.X)(this.field)?"none":null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0),this.editType&&(this.editType=this.editType.toLowerCase()),Object(m.X)(this.uid)&&(this.uid=Qt("grid-column"));var r=new j;if(t.format&&(t.format.skeleton||t.format.format)&&(this.setFormatter(r.getFormatFunction(Object(m.K)({},t.format))),this.setParser(r.getParserFunction(t.format))),this.toJSON=function(){for(var e={},t=["filter","dataSource",Object(m.W)()?" ":"headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],i=Object.keys(n),r=0;r<i.length;r++)if("columns"===i[r]){e[i[r]]=[];for(var s=0;s<n[i[r]].length;s++)e[i[r]].push(n[i[r]][s].toJSON())}else t.indexOf(i[r])<0&&(e[i[r]]=n[i[r]]);return e},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some((function(e){return e.allowResizing})))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=Lt(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=Lt(this.headerTemplate)),!Object(m.X)(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=Lt(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=Lt(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=Lt(this.filterTemplate)),this.isForeignColumn()&&(Object(m.X)(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params=Object(m.K)({dataSource:this.dataSource,query:new v.g,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer){var s=this.sortComparer;this.sortComparer=function(e,t,i,n){if("string"==typeof s&&(s=Oi(s,window)),"Descending"===this.sortDirection){var r=e;e=t,t=r;var a=i;i=n,n=a}return s(e,t,i,n)}}!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=function(e,t){return e=Oi(n.foreignKeyValue,yi(n,{},e)[0]),t=Oi(n.foreignKeyValue,yi(n,{},t)[0]),"Descending"===n.sortDirection?v.b.fnDescending(e,t):v.b.fnAscending(e,t)})}return f(e,[{key:"getSortDirection",value:function(){return this.sortDirection}},{key:"setSortDirection",value:function(e){this.sortDirection=e}},{key:"getFreezeTableName",value:function(){return this.freezeTable}},{key:"setProperties",value:function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)this[t[i]]=e[t[i]],this.parent&&this.parent.isReact&&"template"===t[i]&&this.parent.refreshReactColumnTemplateByUid(this.uid)}},{key:"isForeignColumn",value:function(){return!(!this.dataSource||!this.foreignKeyValue)}},{key:"getFormatter",value:function(){return this.formatFn}},{key:"setFormatter",value:function(e){this.formatFn=e}},{key:"getParser",value:function(){return this.parserFn}},{key:"setParser",value:function(e){this.parserFn=e}},{key:"getColumnTemplate",value:function(){return this.templateFn}},{key:"getHeaderTemplate",value:function(){return this.headerTemplateFn}},{key:"getFilterItemTemplate",value:function(){return this.fltrTemplateFn}},{key:"getDomSetter",value:function(){return this.disableHtmlEncode?"textContent":"innerHTML"}}]),e}(),D="actionBegin",E="actionComplete",I="dataBound",M="initial-load",F="initial-end",T="data-ready",A="content-ready",z="ui-update",L="on-empty",B="inbound-model-changed",P="model-changed",q="header-refreshed",V="key-pressed",H="click",N="destroy",W="toolbar-refresh",X="auto-col",G="prevent-batch",K=function(e){return e[e.Data=0]="Data",e[e.Header=1]="Header",e[e.Summary=2]="Summary",e[e.GroupSummary=3]="GroupSummary",e[e.CaptionSummary=4]="CaptionSummary",e[e.Filter=5]="Filter",e[e.Indent=6]="Indent",e[e.GroupCaption=7]="GroupCaption",e[e.GroupCaptionEmpty=8]="GroupCaptionEmpty",e[e.Expand=9]="Expand",e[e.HeaderIndent=10]="HeaderIndent",e[e.StackedHeader=11]="StackedHeader",e[e.DetailHeader=12]="DetailHeader",e[e.DetailExpand=13]="DetailExpand",e[e.CommandColumn=14]="CommandColumn",e[e.DetailFooterIntent=15]="DetailFooterIntent",e[e.RowDragIcon=16]="RowDragIcon",e[e.RowDragHIcon=17]="RowDragHIcon",e}({}),U=function(e){return e[e.Header=0]="Header",e[e.Content=1]="Content",e[e.Summary=2]="Summary",e}({}),Y=function(){function e(t,i){p(this,e),this.dataState={isPending:!1,resolver:null,group:[]},this.foreignKeyDataState={isPending:!1,resolver:null},this.parent=t,this.serviceLocator=i,this.initDataManager(),this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on("rows-added",this.addRows,this),this.parent.on("row-position-changed",this.reorderRows,this),this.parent.on("rows-removed",this.removeRows,this),this.parent.on("datasource-modified",this.initDataManager,this),this.parent.on(N,this.destroy,this),this.parent.on("update-data",this.crudActions,this),this.parent.on("add-delete-Action",this.getData,this),this.parent.on(X,this.refreshFilteredCols,this),this.parent.on("columns-prepared",this.refreshFilteredCols,this))}return f(e,[{key:"reorderRows",value:function(e){this.dataManager.dataSource.json.splice(e.toIndex,0,this.dataManager.dataSource.json.splice(e.fromIndex,1)[0])}},{key:"getModuleName",value:function(){return"data"}},{key:"initDataManager",value:function(){var e=this.parent;this.dataManager=e.dataSource instanceof v.a?e.dataSource:Object(m.X)(e.dataSource)?new v.a:new v.a(e.dataSource),!e.isAngular||e.query instanceof v.g?(this.isQueryInvokedFromData=!0,e.query=e.query instanceof v.g?e.query:new v.g):e.setProperties({query:new v.g},!0)}},{key:"generateQuery",value:function(e){var t=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)t.select(this.parent.getColumns().filter((function(e){return!(!0!==e.isPrimaryKey&&!1===e.visible||void 0===e.field)})).map((function(e){return e.field})));else if("Schema"===this.parent.columnQueryMode){for(var i=[],n=this.parent.columns,r=0;r<n.length;r++)i.push(n[r].field);t.select(i)}return this.filterQuery(t),this.searchQuery(t),this.aggregateQuery(t),this.sortQuery(t),Si(this.parent)?this.virtualGroupPageQuery(t):this.pageQuery(t,e),this.groupQuery(t),t}},{key:"aggregateQuery",value:function(e,t){for(var i=this.parent.aggregates,n=0;n<i.length;n++)for(var r=i[n],s=0;s<r.columns.length;s++)for(var a=r.columns[s],l=a.type instanceof Array?a.type:[a.type],o=0;o<l.length;o++)e.aggregate(l[o].toLowerCase(),a.field);return e}},{key:"virtualGroupPageQuery",value:function(e){if(e.queries.length)for(var t=0;t<e.queries.length;t++)"onPage"===e.queries[t].fn&&e.queries.splice(t,1);return e}},{key:"pageQuery",value:function(e,t){var i=this.parent;if((i.allowPaging||i.enableVirtualization||i.enableInfiniteScrolling)&&!0!==t){if(i.pageSettings.currentPage=Math.max(1,i.pageSettings.currentPage),i.pageSettings.pageCount<=0&&(i.pageSettings.pageCount=8),i.pageSettings.pageSize<=0&&(i.pageSettings.pageSize=12),e.queries.length)for(var n=0;n<e.queries.length;n++)"onPage"===e.queries[n].fn&&e.queries.splice(n,1);!Object(m.X)(i.infiniteScrollModule)&&i.enableInfiniteScrolling?this.parent.notify("infinite-page-query",e):e.page(i.pageSettings.currentPage,i.pageSettings.pageSize)}return e}},{key:"groupQuery",value:function(e){var t=this.parent;if(t.allowGrouping&&t.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&e.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});for(var i=t.groupSettings.columns,n=0,r=i.length;n<r;n++){var s=this.getColumnByField(i[n]);s||this.parent.log("initial_action",{moduleName:"group",columnName:i[n]});var a=s.format;s.enableGroupByFormat?e.group(i[n],this.formatGroupColumn.bind(this),a):e.group(i[n],null)}}return e}},{key:"sortQuery",value:function(e){var t=this.parent;if((t.allowSorting||t.allowGrouping)&&t.sortSettings.columns.length){for(var i=t.sortSettings.columns,n=[],r=i.length-1;r>-1;r--){var s=this.getColumnByField(i[r].field);if(!s)return this.parent.log("initial_action",{moduleName:"sort",columnName:i[r].field}),e;s.setSortDirection(i[r].direction);var a=i[r].direction;s.sortComparer&&(this.parent.log("grid_sort_comparer"),a=this.isRemote()?i[r].direction:s.sortComparer.bind(s)),-1===t.groupSettings.columns.indexOf(i[r].field)?s.isForeignColumn()||s.sortComparer?e.sortByForeignKey(s.field,a,void 0,i[r].direction.toLowerCase()):e.sortBy(s.field,a):n.push({direction:a,field:s.field})}for(var l=0,o=n.length;l<o;l++)if("string"==typeof n[l].direction)e.sortBy(n[l].field,n[l].direction);else{var h=this.getColumnByField(n[l].field);e.sortByForeignKey(n[l].field,n[l].direction,void 0,h.getSortDirection().toLowerCase())}}return e}},{key:"searchQuery",value:function(e,t,i){var n=this.parent.searchSettings,r=n.fields.length?n.fields:this.getSearchColumnFieldNames(),s=[],a=!1;if(this.parent.searchSettings.key.length){a=this.parent.getForeignKeyColumns().some((function(e){return r.indexOf(e.field)>-1}));var l=i?t.dataSource.adaptor:this.dataManager.adaptor;if(a||l.getModuleName&&"ODataV4Adaptor"===l.getModuleName()){r=i?[t.foreignKeyValue]:r;for(var o=0;o<r.length;o++){var h=i?t:this.getColumnByField(r[o]);h.isForeignColumn()&&!i?s=this.fGeneratePredicate(h,s):s.push(new v.f(r[o],n.operator,n.key,n.ignoreCase,n.ignoreAccent))}var c=v.f.or(s);c.key=n.key,e.where(c)}else e.search(n.key,r,n.operator,n.ignoreCase,n.ignoreAccent)}return e}},{key:"filterQuery",value:function(e,t,i){var n,r=this.parent,s=[],a=[],l=this.parent.getForeignKeyColumns();if(r.allowFiltering&&r.filterSettings.columns.length){var o,h=t||r.filterSettings.columns,u={},d=c(r.getColumns());try{for(d.s();!(o=d.n()).done;){var p=o.value;u[p.field]=p.filter.type?p.filter.type:r.filterSettings.type}}catch(L){d.e(L)}finally{d.f()}var g,f=[],b=[],y=c(h);try{for(y.s();!(g=y.n()).done;){var C=g.value,w=r.getColumnByField(C.field);Object(m.X)(C.type)&&w&&("date"===w.type||"datetime"===w.type)&&(C.type=r.getColumnByField(C.field).type),C.isForeignKey?f.push(C):b.push(C)}}catch(L){y.e(L)}finally{y.f()}if(b.length){if("FilterBar"===r.filterSettings.type||"Menu"===r.filterSettings.type)for(var k=0,S=b.length;k<S;k++)b[k].uid=b[k].uid||this.parent.grabColumnByFieldFromAllCols(b[k].field).uid;for(var O=nn.getPredicate(b),x=0,j=Object.keys(O);x<j.length;x++){var R=j[x];s.push(O[R])}}if(f.length){var D,E=c(f);try{for(E.s();!(D=E.n()).done;){var I=D.value;I.uid=I.uid||this.parent.grabColumnByFieldFromAllCols(I.field).uid;var M=this.parent.grabColumnByUidFromAllCols(I.uid);if(M||this.parent.log("initial_action",{moduleName:"filter",columnName:I.field}),M.isForeignColumn()&&Ci(I.field,l)&&!i)a.push(I),M.columnData.length||(n=!0),s=this.fGeneratePredicate(M,s);else for(var F=nn.getPredicate(h),T=0,A=Object.keys(F);T<A.length;T++){var z=A[T];s.push(F[z])}}}catch(L){E.e(L)}finally{E.f()}}s.length&&!n?e.where(v.f.and(s)):this.parent.notify("showEmptyGrid",{})}return e}},{key:"fGeneratePredicate",value:function(e,t){var i={};return e&&(this.parent.notify("generateQuery",{predicate:i,column:e}),i.predicate.predicates.length&&t.push(i.predicate)),t}},{key:"getData",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requestType:""},n=arguments.length>1?arguments[1]:void 0,r=this.getKey(i.foreignKeyData&&Object.keys(i.foreignKeyData).length?i.foreignKeyData:this.parent.getPrimaryKeyFieldNames());if(this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(i,n,r).promise;switch(i.requestType){case"delete":if(n=n||this.generateQuery(),1===Object.keys(i.data).length)e=this.dataManager.remove(r,i.data[0],n.fromTable,n);else{var s={addedRecords:[],deletedRecords:[],changedRecords:[]};s.deletedRecords=i.data,e=this.dataManager.saveChanges(s,r,n.fromTable,n.requiresCount())}break;case"save":Object(m.W)()&&this.parent.isServerRendered&&this.parent.notify("offset",i),n=n||this.generateQuery(),i.index=Object(m.X)(i.index)?0:i.index,e=this.dataManager.insert(i.data,n.fromTable,n,i.index)}return i.promise=e,!e||Array.isArray(e)||e.hasOwnProperty("deletedRecords")?this.insert(n,i):Object(m.W)()?e.then((function(e){return t.insert(n,i)})).catch((function(e){return null})):e.then((function(e){return t.insert(n,i)}))}},{key:"insert",value:function(e,t){return"save"===t.requestType&&this.parent.notify("recordAdded",t),this.executeQuery(e)}},{key:"executeQuery",value:function(e){var t=this;if(this.dataManager.ready){var i=new v.c;return this.dataManager.ready.then((function(n){t.dataManager.executeQuery(e).then((function(e){i.resolve(e)}))})).catch((function(e){i.reject(e)})),i.promise}return this.dataManager.executeQuery(e)}},{key:"formatGroupColumn",value:function(e,t){var i=this.serviceLocator,n=this.getColumnByField(t),r=e;return n.type||(n.type=r.getDay?r.getHours()>0||r.getMinutes()>0||r.getSeconds()>0||r.getMilliseconds()>0?"datetime":"date":typeof e),Object(m.X)(n.getFormatter())&&ci(i,n),j.prototype.toView(e,n.getFormatter())}},{key:"crudActions",value:function(e){var t=this.generateQuery(),i=null,n="promise",r=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(e,t,r),e.requestType){case"save":Object(m.W)()&&this.parent.isServerRendered&&this.parent.notify("offset",e),i=this.dataManager.update(r,e.data,t.fromTable,t,e.previousData)}e[n]=i||e[n],this.parent.notify("crud-Action",e)}},{key:"saveChanges",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.generateQuery();if(n.requiresCount(),"result"in this.parent.dataSource){this.getStateEventArgument(n);var r=new v.c,s={requestType:"batchsave",changes:e,key:t,query:n,endEdit:r.resolve};return this.setState({isPending:!0,resolver:r.resolve}),this.parent.trigger("dataSourceChanged",s),r.promise}var a="changedRecords",l="addedRecords",o="data";if(Object(m.W)()&&this.parent.isServerRendered){for(var h=0;h<e[a].length;h++){var c={data:e[a][h]};this.parent.notify("offset",c),e[a][h]=c[o]}for(var u=0;u<e[l].length;u++){var d={data:e[l][u]};this.parent.notify("offset",d),e[l][u]=d[o]}}return this.dataManager.saveChanges(e,t,n.fromTable,n,i)}},{key:"getKey",value:function(e){if(e&&e.length)return e[0]}},{key:"isRemote",value:function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url}},{key:"addRows",value:function(e){for(var t=e.records.length;t>0;t--)this.dataManager.dataSource.json.splice(e.toIndex,0,e.records[t-1])}},{key:"removeRows",value:function(e){this.dataManager.dataSource.json=this.dataManager.dataSource.json.filter((function(t,i){return-1===e.records.indexOf(t)}))}},{key:"getColumnByField",value:function(e){var t;return this.parent.columnModel.some((function(i){return t=i,i.field===e}))&&t}},{key:"destroy",value:function(){this.parent.isDestroyed||(this.parent.off("rows-added",this.addRows),this.parent.off("rows-removed",this.removeRows),this.parent.off("datasource-modified",this.initDataManager),this.parent.off(N,this.destroy),this.parent.off("update-data",this.crudActions),this.parent.off("add-delete-Action",this.getData),this.parent.off(X,this.refreshFilteredCols),this.parent.off("columns-prepared",this.refreshFilteredCols))}},{key:"getState",value:function(){return this.dataState}},{key:"setState",value:function(e){return this.dataState=e}},{key:"getForeignKeyDataState",value:function(){return this.foreignKeyDataState}},{key:"setForeignKeyDataState",value:function(e){this.foreignKeyDataState=e}},{key:"getStateEventArgument",value:function(e){var t=new v.h,i=new v.a({url:"",adaptor:new v.h}),n=t.processQuery(i,e),r=JSON.parse(n.data);return Object(m.K)(r,n.pvtData)}},{key:"eventPromise",value:function(e,t,i){var n,r=this,s=e;n=this.getStateEventArgument(t);var a=new v.c,l=new v.c;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(n.action=e,"save"===e.requestType||"delete"===e.requestType){var o=e;o.key=i,o.promise=l.promise,o.state=n,this.setState({isPending:!0,resolver:l.resolve}),s.endEdit=l.resolve,s.cancelEdit=l.reject,this.parent.trigger("dataSourceChanged",o),l.promise.then((function(e){r.setState({isPending:!0,resolver:a.resolve,group:n.group,aggregates:n.aggregates}),"save"===o.requestType&&r.parent.notify("recordAdded",o),r.parent.trigger("dataStateChange",n)})).catch((function(){}))}else this.setState({isPending:!0,resolver:a.resolve,group:n.group,aggregates:n.aggregates}),this.parent.trigger("dataStateChange",n);else this.setState({}),a.resolve(this.parent.dataSource);return a}},{key:"getSearchColumnFieldNames",value:function(){var e,t=[],i=c(this.parent.getColumns());try{for(i.s();!(e=i.n()).done;){var n=e.value;n.allowSearching&&!Object(m.X)(n.field)&&t.push(n.field)}}catch(r){i.e(r)}finally{i.f()}return t}},{key:"refreshFilteredCols",value:function(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&function(e,t){for(var i=0;i<t.length;i++)t[i].uid=t[i].isForeignKey?Ci(t[i].field,e.getForeignKeyColumns()).uid:e.getColumnByField(t[i].field).uid}(this.parent,this.parent.filterSettings.columns)}}]),e}(),_=function(){function e(t,i){p(this,e),Object(m.db)(this,t),this.parent=i}return f(e,[{key:"clone",value:function(){var t=new e({});return Object(m.db)(t,this),t.cells=this.cells.map((function(e){return e.clone()})),t}},{key:"setRowValue",value:function(e){if(this.parent){var t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,e)}}},{key:"setCellValue",value:function(e,t){if(this.parent&&this.data[e].toString()!==t.toString()){var i=this.parent.getPrimaryKeyFieldNames()[0];this.parent.setCellValue(this.data[i],e,t),this.makechanges(i,this.data)}}},{key:"makechanges",value:function(e,t){this.parent&&this.parent.getDataModule().dataManager.update(e,t)}}]),e}(),Q=function(){function e(t){p(this,e),this.isSpanned=!1,this.isRowSpanned=!1,Object(m.db)(this,t)}return f(e,[{key:"clone",value:function(){var t=new e({});return Object(m.db)(t,this),t}}]),e}(),J=function(){function e(t,i){p(this,e),this.serviceLocator=t,this.parent=i}return f(e,[{key:"render",value:function(e,t,i,n){var r,s=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(t.cells[i].cellType||K.Data),a=t.cells[i].cellSpan?t.cells[i].cellSpan:e.colSpan+i<=t.cells.length?e.colSpan:t.cells.length-i,l=e.rowSpan,o=0;if(t.index>0){var h=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[t.index-1].isDataRow?this.parent.getRowsObject()[t.index].cells:this.parent.getRowsObject()[t.index-1].cells,c=t.cells[i];r=h.filter((function(e){return e.column.uid===c.column.uid}))[0]}for(var u=r&&r.colSpanRange>1&&r.rowSpanRange>1?r.colSpanRange:a,d=i+1;d<i+u&&d<t.cells.length;d++)!1===t.cells[d].visible?o++:t.cells[d].isSpanned=!0;if(o>0){for(var p=i+a;p<i+a+o&&p<t.cells.length;p++)t.cells[p].isSpanned=!0;i+a+o>=t.cells.length&&(a-=i+a+o-t.cells.length)}return t.cells[i].cellSpan&&(t.data[e.column.field]=t.cells[i].spanText,n=s.render(t.cells[i],t.data,{index:Object(m.X)(t.index)?"":t.index.toString()})),a>1&&Object(m.x)(n,{colSpan:a.toString(),"aria-colSpan":a.toString()}),l>1&&(Object(m.x)(n,{rowspan:l.toString(),"aria-rowspan":l.toString()}),t.cells[i].isRowSpanned=!0,t.cells[i].rowSpanRange=Number(l),a>1&&(t.cells[i].colSpanRange=Number(a))),t.index>0&&r.rowSpanRange>1&&(t.cells[i].isSpanned=!0,t.cells[i].rowSpanRange=Number(r.rowSpanRange-1),t.cells[i].colSpanRange=r.rowSpanRange>0?r.colSpanRange:1),!this.parent.enableColumnVirtualization||t.cells[i].cellSpan||this.containsKey(e.column.field,e.data[e.column.field])||this.backupMergeCells(e.column.field,e.data[e.column.field],e.colSpan),n}},{key:"backupMergeCells",value:function(e,t,i){this.setMergeCells(this.generteKey(e,t),i)}},{key:"generteKey",value:function(e,t){return e+"__"+t.toString()}},{key:"splitKey",value:function(e){return e.split("__")}},{key:"containsKey",value:function(e,t){return this.getMergeCells().hasOwnProperty(this.generteKey(e,t))}},{key:"getMergeCells",value:function(){return this.parent.mergeCells}},{key:"setMergeCells",value:function(e,t){this.parent.mergeCells[e]=t}},{key:"updateVirtualCells",value:function(e){for(var t=this.getMergeCells(),i=0,n=Object.keys(t);i<n.length;i++){var r=n[i],s=t[r],a=this.splitKey(r),l=this.getIndexFromAllColumns(a[0]),o=this.parent.getColumnIndexesInView(),h=s-(o[0]-l);if(l<o[0]&&h>1){var u,d=c(e);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(p.data[a[0]].toString()===a[1].toString()){p.cells[0].cellSpan=h,p.cells[0].spanText=a[1];break}}}catch(g){d.e(g)}finally{d.f()}}}return e}},{key:"getIndexFromAllColumns",value:function(e){return At(this.parent.getVisibleColumns(),(function(t,i){if(t.field===e)return i}))[0]}}]),e}(),Z=function(){function e(t,i,n){p(this,e),this.isSpan=!1,this.cellType=i,this.serviceLocator=t,this.parent=n,this.element=this.parent.createElement("tr",{attrs:{role:"row"}})}return f(e,[{key:"render",value:function(e,t,i,n,r){return this.refreshRow(e,t,i,n,r)}},{key:"refresh",value:function(e,t,i,n,r){i&&(e.data=Ri({},e.changes),this.refreshMergeCells(e));var s=this.parent.element.querySelector("[data-uid="+e.uid+"]"),a=this.refreshRow(e,t,n,r,null,i),l=[].slice.call(a.cells);s.innerHTML="";var o,h=c(l);try{for(h.s();!(o=h.n()).done;){var u=o.value;s.appendChild(u)}}catch(d){h.e(d)}finally{h.f()}}},{key:"refreshRow",value:function(e,t,i,n,r,s){var a=this,l=Object(m.X)(r)?this.element.cloneNode():r,o={data:e.data},h={data:e.data},c=Object(m.K)({},i,{}),u=this.parent.getColumns().filter((function(e){return"checkbox"===e.type&&e.field}))[0],d=!1;u&&(d=Oi(u.field,o.data)),e.isDataRow&&(e.isSelected=this.parent.getSelectedRowIndexes().indexOf(e.index)>-1||d),e.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0,-1===this.parent.getSelectedRowIndexes().indexOf(e.index)&&this.parent.getSelectedRowIndexes().push(e.index)),this.buildAttributeFromRow(l,e),Object(m.x)(l,c),Bt(l,e.attributes);for(var p=this.serviceLocator.getService("cellRendererFactory"),g=function(t,i){var n=e.cells[t];n.isSelected=e.isSelected,n.isColumnSelected=n.column.isSelected;var r=p.getCellRenderer(e.cells[t].cellType||K.Data),o={index:Object(m.X)(e.index)?"":e.index.toString()};e.isExpand&&e.cells[t].cellType===K.DetailExpand&&(o.class=a.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");var c=r.render(e.cells[t],e.data,o,e.isExpand,s);if(e.cells[t].cellType!==K.Filter){if(e.cells[t].cellType===K.Data||e.cells[t].cellType===K.CommandColumn){a.parent.trigger("queryCellInfo",Object(m.K)(h,{cell:c,column:n.column,colSpan:1,rowSpan:1,foreignKeyData:e.cells[t].foreignKeyData,requestType:a.parent.requestTypeAction}));var u=!1;if(e.index>0&&a.isSpan){var d=a.parent.groupSettings.columns.length>0&&!a.parent.getRowsObject()[e.index-1].isDataRow?a.parent.getRowsObject()[e.index].cells:a.parent.getRowsObject()[e.index-1].cells,g=d.filter((function(i){return i.column.uid===e.cells[t].column.uid}))[0];u=g.isRowSpanned?g.isRowSpanned:g.rowSpanRange>1}(h.colSpan>1||e.cells[t].cellSpan>1||h.rowSpan>1||u)&&(a.isSpan=!0,c=new J(a.serviceLocator,a.parent).render(h,e,t,c))}e.cells[t].isSpanned||l.appendChild(c)}},f=0,v=e.cells.length;f<v;f++)g(f);var b={row:l,rowHeight:this.parent.rowHeight};if(e.isDataRow&&(this.parent.trigger("rowDataBound",Object(m.K)(o,b)),this.parent.childGrid||this.parent.isRowDragable()||this.parent.detailTemplate)){var y=l.querySelectorAll(".e-rowcell:not(.e-hide)")[0];y&&y.classList.add("e-detailrowvisible")}if(this.parent.enableVirtualization&&(o.rowHeight=this.parent.rowHeight),o.rowHeight?l.style.height=o.rowHeight+"px":this.parent.rowHeight&&(l.querySelector(".e-headercell")||l.querySelector(".e-groupcaption"))&&(l.style.height=this.parent.rowHeight+"px"),e.cssClass&&l.classList.add(e.cssClass),e.lazyLoadCssClass&&l.classList.add(e.lazyLoadCssClass),(!this.parent.enableColumnVirtualization||0===this.parent.frozenColumns)&&this.parent.element.scrollHeight>this.parent.height&&this.parent.aggregates.length)for(var C=0;C<this.parent.aggregates.length;C++)if(this.parent.aggregates[C].properties.columns[0].footerTemplate){var w=l.querySelectorAll(".e-summarycell");if(w.length){var k=w[w.length-1];Object(m.v)([k],["e-lastsummarycell"]);var S=w[0];Object(m.v)([S],["e-firstsummarycell"])}}return l}},{key:"refreshMergeCells",value:function(e){var t,i=c(e.cells);try{for(i.s();!(t=i.n()).done;){t.value.isSpanned=!1}}catch(n){i.e(n)}finally{i.f()}return e}},{key:"buildAttributeFromRow",value:function(e,t){var i={},n=[];t.isDataRow&&n.push("e-row"),t.isAltRow&&n.push("e-altrow"),Object(m.X)(t.index)||(i["aria-rowindex"]=t.index),t.rowSpan&&(i.rowSpan=t.rowSpan),t.uid&&(i["data-uid"]=t.uid),t.isSelected&&(i["aria-selected"]=!0),!1===t.visible&&n.push("e-hide"),i.class=n,Bt(e,i)}}]),e}(),$=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"generateRows",value:function(e,t){var i=[],n=this.parent.enableVirtualization&&t?t.startIndex:0;n=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):n;for(var r=0,s=Object.keys(e).length;r<s;r++,n++)i[r]=this.generateRow(e[r],n);return i}},{key:"ensureColumns",value:function(){var e=[];if(this.parent.detailTemplate||this.parent.childGrid){var t={};this.parent.notify("detail-indentcell-info",t),e.push(this.generateCell(t,null,K.DetailExpand))}return this.parent.isRowDragable()&&e.push(this.generateCell({},null,K.RowDragIcon)),e}},{key:"generateRow",value:function(e,t,i,n,r,s,a){var l={foreignKeyData:{}};l.uid=Object(m.W)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):Qt("grid-row"),l.data=e,l.index=t,l.indent=n,l.tIndex=s,l.isDataRow=!0,l.parentGid=r,l.parentUid=a,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?l.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[t]&&(l.isExpand=this.parent.expandedRows[t].isExpand)),l.cssClass=i,l.isAltRow=!!this.parent.enableAltRow&&t%2!=0,l.isAltRow=!!this.parent.enableAltRow&&t%2!=0,Object(m.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.selectionModule.checkBoxState?(l.isSelected=this.parent.selectionModule.checkBoxState,l.isSelected&&-1===this.parent.selectionModule.selectedRowIndexes.indexOf(t)&&this.parent.selectionModule.selectedRowIndexes.push(t)):l.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(l);var o=this.ensureColumns(),h=Object(m.W)()?new _(l):new _(l,this.parent);return h.cells="Right"===this.parent.getFrozenMode()?this.generateCells(l).concat(o):o.concat(this.generateCells(l)),h}},{key:"refreshForeignKeyRow",value:function(e){for(var t=this.parent.getForeignKeyColumns(),i=0;i<t.length;i++)Object(m.qb)(t[i].field,yi(t[i],e.data),e.foreignKeyData)}},{key:"generateCells",value:function(e){for(var t=this.parent.getColumns(),i=[],n=0;n<t.length;n++)i.push(this.generateCell(t[n],e.uid,Object(m.X)(t[n].commands)?void 0:K.CommandColumn,null,n,e.foreignKeyData));return i}},{key:"generateCell",value:function(e,t,i,n,r,s){var a={visible:e.visible,isDataCell:!Object(m.X)(e.field||e.template),isTemplate:!Object(m.X)(e.template),rowID:t,column:e,cellType:Object(m.X)(i)?K.Data:i,colSpan:n,commands:e.commands,isForeignKey:e.isForeignColumn&&e.isForeignColumn(),foreignKeyData:e.isForeignColumn&&e.isForeignColumn()&&Object(m.V)(e.field,s)};return(a.isDataCell||"checkbox"===a.column.type||a.commands)&&(a.index=r),new Q(a)}},{key:"refreshRows",value:function(e){for(var t=0;t<e.length;t++)this.refreshForeignKeyRow(e[t]),e[t].cells=this.generateCells(e[t]);return e}},{key:"getInfiniteIndex",value:function(e){return"infiniteScroll"===e.requestType||"delete"===e.requestType||"add"===e.action?e.startIndex:0}}]),e}(),ee=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"getData",value:function(){for(var e=this,t=[],i=this.parent.aggregates.slice(),n=0;n<i.length;n++){var r=i[n].columns.filter((function(t){return!(t.footerTemplate||t.groupFooterTemplate||t.groupCaptionTemplate)||e.columnSelector(t)}));r.length&&t.push({columns:r})}return t}},{key:"columnSelector",value:function(e){return void 0!==e.footerTemplate}},{key:"getColumns",value:function(e,t){var i=[];if(this.parent.allowGrouping)for(var n=0;n<this.parent.groupSettings.columns.length;n++)i.push(new R({}));return(this.parent.detailTemplate||!Object(m.X)(this.parent.childGrid)||this.parent.isRowDragable()&&!e)&&i.push(new R({})),i.push.apply(i,h(this.parent.getColumns())),t=t?t+this.parent.getIndentCount():t,Object(m.X)(e)?i:i.slice(e,t)}},{key:"generateRows",value:function(e,t,i,n,r){if(0===e.length&&(void 0===t||!t.count))return[];for(var s=this.buildSummaryData(e,t),a=[],l=this.getData(),o=0;o<l.length;o++)a.push(this.getGeneratedRow(l[o],s[o],t?t.level:void 0,i,n,t?t.parentUid:void 0,r));return a}},{key:"getGeneratedRow",value:function(e,t,i,n,r,s,a){var l=[],o=this.getIndentByLevel(i),h=!Object(m.X)(this.parent.childGrid),c=this.parent.getIndentCount();this.parent.isRowDragable()&&(o=["e-indentcelltop"]);for(var u=a||this.getColumns(n,r),d=0;d<u.length;d++)l.push(this.getGeneratedCell(u[d],e,d>=c?this.getCellType():d<this.parent.groupSettings.columns.length?K.Indent:K.DetailFooterIntent,o[d],h));var p=new _({data:t,attributes:{class:"e-summaryrow"}});return p.cells=l,p.uid=Object(m.W)()&&this.parent.isServerRendered&&!Object(m.X)(s)?this.parent.getRowUid("grid-row"):Qt("grid-row"),p.parentUid=s,p.visible=l.some((function(e){return e.isDataCell&&e.visible})),p}},{key:"getGeneratedCell",value:function(e,t,i,n,r){var s=t.columns.filter((function(t){return t.columnName===e.field}))[0],a={style:{textAlign:e.textAlign},"e-mappinguid":e.uid,index:e.index};n&&(a.class=n),Object(m.X)(n)&&r&&(a.class="e-detailindentcelltop");var l={visible:e.visible,isDataCell:!Object(m.X)(s),isTemplate:s&&!Object(m.X)(s.footerTemplate||s.groupFooterTemplate||s.groupCaptionTemplate),column:s||{},attributes:a,cellType:i};return l.column.headerText=e.headerText,new Q(l)}},{key:"buildSummaryData",value:function(e,t){for(var i=[],n=this.getData(),r={},s=0;s<n.length;s++){r={};for(var a=n[s].columns,l=0;l<a.length;l++)r=this.setTemplate(a[l],t&&t.aggregates?t:e,r);i.push(r)}return i}},{key:"getIndentByLevel",value:function(e){return this.parent.groupSettings.columns.map((function(){return"e-indentcelltop"}))}},{key:"setTemplate",value:function(e,t,i){var n=e.type,r={},s=e.getFormatter()||function(e){return e},a=t;n instanceof Array||(n=[e.type]);for(var l=0;l<n.length;l++){var o=e.field+" - "+n[l].toLowerCase(),h=e.columnName,c="Custom"!==n[l]&&a.aggregates&&o in a.aggregates?a.aggregates[o]:$t(n[l],a.aggregates?a:t,e,this.parent);i[h]=i[h]||{},i[h][o]=c,i[h][n[l]]=Object(m.X)(c)?" ":s(c),a.field&&(i[h].field=a.field,i[h].key=a.key)}return r.format=e.getFormatter(),e.setTemplate(r),i}},{key:"getCellType",value:function(){return K.Summary}}]),e}(),te=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"columnSelector",value:function(e){return void 0!==e.groupFooterTemplate}},{key:"getIndentByLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent.groupSettings.columns.length;return this.parent.groupSettings.columns.map((function(t,i){return i<=e-1?"":"e-indentcelltop"}))}},{key:"getCellType",value:function(){return K.GroupSummary}}]),i}(ee),ie=function(e){n(r,e);var t=s(r);function r(){return p(this,r),t.apply(this,arguments)}return f(r,[{key:"columnSelector",value:function(e){return void 0!==e.groupCaptionTemplate}},{key:"getData",value:function(){return[i(o(r.prototype),"getData",this).call(this).reduce((function(e,t){return e.columns=[].concat(h(e.columns),h(t.columns)),e}),{columns:[]})]}},{key:"isEmpty",value:function(){return 0===(this.getData()[0].columns||[]).length}},{key:"getCellType",value:function(){return K.CaptionSummary}}]),r}(ee),ne=function(e){n(r,e);var t=s(r);function r(e){var i;return p(this,r),(i=t.call(this,e)).rows=[],i.index=0,i.parent=e,i.summaryModelGen=new te(e),i.captionModelGen=new ie(e),i}return f(r,[{key:"generateRows",value:function(e,t){if(0===this.parent.groupSettings.columns.length)return i(o(r.prototype),"generateRows",this).call(this,e,t);this.isInfiniteScroll="infiniteScroll"===t.requestType,this.rows=[],this.index=this.parent.enableVirtualization||this.isInfiniteScroll?t.startIndex:0;for(var n=0,s=e.length;n<s;n++)this.getGroupedRecords(0,e[n],e.level,n,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows}},{key:"getGroupedRecords",value:function(e,t,i,n,r,s,a){var l=this.isInfiniteScroll&&this.prevKey===t.key,o=i;if(Object(m.X)(t.items))if(Object(m.X)(t.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(t,e,n,this.rows.length,a));else for(var c=0,u=t.length;c<u;c++)this.getGroupedRecords(e,t[c],t.level,n,e,this.rows.length,a);else{var d=this.generateCaptionRow(t,e,n,r,s,a);if(l||(this.rows=this.rows.concat(d)),t.items&&t.items.length&&this.getGroupedRecords(e+1,t.items,t.items.level,n,e+1,this.rows.length,d.uid),this.parent.aggregates.length){var p,g=this.rows.length;(p=this.rows).push.apply(p,h(this.summaryModelGen.generateRows(t,{level:o,parentUid:d.uid})));for(var f=g-1;f>=0;f--)if(this.rows[f].isCaptionRow)this.rows[f].aggregatesCount=this.rows.length-g;else if(!this.rows[f].isCaptionRow&&!this.rows[f].isDataRow)break}}this.prevKey=t.key}},{key:"getCaptionRowCells",value:function(e,t,i){var n=[],r=[],s=this.parent.getColumnByField(e),a=this.parent.getColumnIndexesInView();this.parent.enableColumnVirtualization&&(s=this.parent.columns.filter((function(t){return t.field===e}))[0]);var l=this.parent.groupSettings.columns.length,o=this.parent;if(!this.parent.enableColumnVirtualization||-1!==a.indexOf(t)){for(var c=0;c<t;c++)n.push(this.generateIndentCell());n.push(this.generateCell({},null,K.Expand))}if(t=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+l+(o.detailTemplate||o.childGrid?1:0)-t+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty()){var u=this.captionModelGen.generateRows(i)[0];Object(m.K)(i,u.data);var d=0;u.cells.some((function(e,t){return d=t,e.visible&&e.isDataCell})),r=u.cells.slice(d).filter((function(e){return e.visible})),u.visible&&r[0].column.field===this.parent.getVisibleColumns()[0].field&&(r=r.slice(1)),1===this.parent.getVisibleColumns().length&&(r=[]),t-=r.length}for(var p=this.parent.enableColumnVirtualization?this.parent.getColumns():[s],g=!0,f=0;f<p.length;f++){var v=g&&-1!==a.indexOf(t);v&&(g=!1);var b=!this.parent.enableColumnVirtualization||v?K.GroupCaption:K.GroupCaptionEmpty;t=this.parent.enableColumnVirtualization&&b===K.GroupCaption?t+l:t,o.isRowDragable()&&t++,n.push(this.generateCell(s,null,b,t))}return n.push.apply(n,h(r)),n}},{key:"generateCaptionRow",value:function(e,t,i,n,r,s){var a={},l=this.parent.getColumnByField(e.field);a.data=Object(m.K)({},e),l&&(a.data.field=e.field),a.isDataRow=!1,a.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),a.parentGid=i,a.childGid=n,a.tIndex=r,a.isCaptionRow=!0,a.parentUid=s,a.gSummary=Object(m.X)(e.items.records)?e.items.length:e.items.records.length,a.uid=Object(m.W)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):Qt("grid-row");var o=new _(a);return o.indent=t,this.getForeignKeyData(o),o.cells=this.getCaptionRowCells(e.field,t,o.data),o}},{key:"getForeignKeyData",value:function(e){var t=e.data,i=this.parent.getColumnByField(t.field);if(i&&i.isForeignColumn&&i.isForeignColumn()){var n=Object(m.X)(t.key)?"":i.valueAccessor(i.foreignKeyValue,yi(i,{},t.key)[0],i);Object(m.qb)("foreignKey",n,e.data)}}},{key:"generateDataRows",value:function(e,t,i,n,r){for(var s=[],a=this.parent.getColumnIndexesInView(),l=0,o=e.length;l<o;l++,n++){s[l]=this.generateRow(e[l],this.index,l?void 0:"e-firstchildrow",t,i,n,r);for(var h=0;h<t;h++)this.parent.enableColumnVirtualization&&-1===a.indexOf(t)||s[l].cells.unshift(this.generateIndentCell());this.index++}return s}},{key:"generateIndentCell",value:function(){return this.generateCell({},null,K.Indent)}},{key:"refreshRows",value:function(e){for(var t=this.parent.getColumnIndexesInView(),i=0;i<e.length;i++)if(e[i].isDataRow){e[i].cells=this.generateCells(e[i]);for(var n=0;n<e[i].indent;n++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e[i].indent)||e[i].cells.unshift(this.generateIndentCell())}else{var r=this.generateCaptionRow(e[i].data,e[i].indent);e[i].cells=r.cells}return e}},{key:"ensureRowVisibility",value:function(){for(var e=0;e<this.rows.length;e++){var t=this.rows[e];if(t.isCaptionRow)for(var i=e+1;i<this.rows.length;i++)t.uid===this.rows[i].parentUid&&(this.rows[i].visible=t.isExpand)}}}]),r}($),re=function(){function e(t,i){var n=this;p(this,e),this.rows=[],this.freezeRows=[],this.movableRows=[],this.freezeRowElements=[],this.currentInfo={},this.prevCurrentView=[],this.isLoaded=!0,this.viewColIndexes=[],this.drop=function(e){(Wt(e.target,"e-row")||Wt(e.target,"e-emptyrow"))&&(n.parent.notify("columnDrop",{target:e.target,droppedElement:e.droppedElement}),Object(m.hb)(e.droppedElement))},this.infiniteCache={},this.isRemove=!1,this.visibleRows=[],this.visibleFrozenRows=[],this.rightFreezeRows=[],this.isAddRows=!1,this.isInfiniteFreeze=!1,this.useGroupCache=!1,this.mutableData=!1,this.rafCallback=function(e){var t=e;return function(){if(n.parent.isFrozenGrid()&&n.parent.enableVirtualization){var i=[].slice.call(n.parent.getMovableVirtualContent().querySelectorAll(".e-row")),r=[].slice.call(n.parent.getFrozenVirtualContent().querySelectorAll(".e-row"));if(n.isLoaded=!!i&&i.length===r.length,n.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&n.isLoaded){var s=[].slice.call(n.parent.getMovableVirtualHeader().querySelectorAll(".e-row")),a=[].slice.call(n.parent.getFrozenVirtualHeader().querySelectorAll(".e-row"));n.isLoaded=s.length===a.length}}if(n.ariaService.setBusy(n.getPanel().querySelector(".e-content"),!1),!n.parent.isDestroyed){var l=n.rows.slice(0);if(n.parent.isFrozenGrid()&&(l=e.isFrozen?n.freezeRows:e.renderFrozenRightContent?n.parent.getFrozenRightRowsObject():n.movableRows),n.parent.notify(A,{rows:l,args:t}),n.isLoaded&&n.parent.trigger(I,{},(function(){n.parent.allowTextWrap&&n.parent.notify("freezerender",{case:"textwrap"})})),t){var o=(t.requestType||"").toLowerCase()+"-complete";n.parent.notify(o,t),"batchsave"===e.requestType&&(e.cancel=!1,n.parent.trigger(E,e))}n.isLoaded&&n.parent.hideSpinner()}}},this.parent=t,this.serviceLocator=i,this.ariaService=this.serviceLocator.getService("ariaService"),this.mutableData=this.parent.getDataModule().isRemote(),this.generator=this.getModelGenerator(),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("colgroup-refresh",this.colGroupRefresh,this),this.parent.on(z,this.enableAfterRender,this),this.parent.on("refresh-infinite-mode-blocks",this.refreshContentRows,this),this.parent.on("beforecellfocused",this.beforeCellFocused,this),this.parent.on(N,this.droppableDestroy,this))}return f(e,[{key:"beforeCellFocused",value:function(e){this.pressedKey=!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action?void 0:e.keyArgs.action}},{key:"renderPanel",value:function(){var e=this.parent,t=this.parent.element.querySelector(".e-gridcontent");if(t)return this.ariaService.setOptions(this.parent.element.querySelector(".e-content"),{busy:!1}),void this.setPanel(t);t=this.parent.createElement("div",{className:"e-gridcontent"});var i=this.parent.createElement("div",{className:"e-content"});this.ariaService.setOptions(i,{busy:!1}),t.appendChild(i),this.setPanel(t),e.element.appendChild(t)}},{key:"renderTable",value:function(){var e=this.getPanel(),t=e.querySelector(".e-virtualtable"),i=e.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||Object(m.X)(t)||Object(m.X)(i)||Object(m.W)()&&(!Object(m.W)()||this.parent.isServerRendered)||(Object(m.hb)(t),Object(m.hb)(i)),e.appendChild(this.createContentTable("_content_table")),this.setTable(e.querySelector(".e-table")),this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type}),this.initializeContentDrop(),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")}},{key:"createContentTable",value:function(e){var t=this.getPanel().firstElementChild;Object(m.W)()||this.getTable()&&Object(m.hb)(this.getTable());var i=t.querySelector(".e-table")?t.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+e}});return this.setColGroup(this.parent.getHeaderTable().querySelector("colgroup").cloneNode(!0)),i.appendChild(this.getColGroup()),i.appendChild(this.parent.createElement("tbody")),t.appendChild(i),t}},{key:"refreshContentRows",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.parent;if(0!==i.currentViewData.length){var n=this.currentMovableRows||i.currentViewData,r=this.parent.contentModule,s=i.isReact&&!Object(m.X)(i.rowTemplate),a=s?i.createElement("tbody"):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=Object(m.K)([],n));var l,o,h,c=s?i.createElement("tbody"):document.createDocumentFragment(),u=i.getColumns(),d=i.getFrozenColumns(),p=this.parent.isFrozenGrid(),g=new Z(this.serviceLocator,null,this.parent),f=this.parent.enableInfiniteScrolling&&"infiniteScroll"===t.requestType;this.rowElements=[],this.rows=[];var v,b,y,C=this.getPanel().querySelector(".e-frozencontent"),w=this.getPanel().querySelector(".e-movablecontent"),k=this.getPanel().querySelector(".e-content");if(Si(i)&&["sorting","filtering","searching","grouping","ungrouping","reorder"].some((function(e){return t.requestType===e}))&&this.emptyVcRows(),Object(m.W)()&&this.parent.isServerRendered){y=this.generator.generateRows(n,t),this.parent.enableVirtualization&&(this.prevInfo=this.prevInfo?this.prevInfo:t.virtualInfo,this.prevInfo=t.virtualInfo.sentinelInfo&&"Y"===t.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==t.virtualInfo.page?this.currentInfo:t.virtualInfo),this.rows=y,this.freezeRows=y,this.rowElements=[].slice.call(this.getTable().querySelectorAll("tr.e-row[data-uid]")),d&&(this.movableRows=y.map((function(e){var t=new _(e);return t.cells=e.cells.slice(d,e.cells.length),e.cells=e.cells.slice(0,d),t})),this.freezeRowElements=this.rowElements),this.isLoaded=!0,this.parent.hideSpinner(),t.isFrozen=0!==this.parent.getFrozenColumns()&&!t.isFrozen;var S=Object(m.K)({rows:this.rows},t);if(this.getTable().querySelector(".e-emptyrow")&&(Object(m.hb)(this.getTable().querySelector(".e-emptyrow")),Object(m.X)(this.getTable().querySelectorAll(".e-table > tbody")[1])||Object(m.hb)(this.getTable().querySelectorAll(".e-table > tbody")[1])),this.parent.notify("contentcolgroup",{}),this.rafCallback(S)(),d&&(k.style.overflowY="hidden",C.style.height=w.offsetHeight-ni()+"px",w.style.overflowY="auto"!==this.parent.height?"scroll":"auto",C.style.borderRightWidth="1px",this.parent.notify(A,{rows:this.movableRows,args:Object(m.K)({},S,{isFrozen:!1})})),!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.enableVirtualization){var O="editRowIndex";"Normal"!==this.parent.editSettings.mode||Object(m.X)(t[O])||this.parent.selectRow(t[O])}if(this.parent.enableVirtualization&&!this.parent.getHeaderContent().querySelectorAll(".e-check").length){for(var x=this.parent.getRows().filter((function(e){return e.getAttribute("aria-selected")})).map((function(e){return e.getAttribute("data-uid")})),j=this.parent.getRows().filter((function(e){return null===e.getAttribute("aria-selected")})).map((function(e){return e.getAttribute("data-uid")})),R=0;R<x.length;R++)if(!Object(m.X)(this.parent.getRowObjectFromUID(x[R]))&&!this.parent.getRowObjectFromUID(x[R]).isSelected){this.parent.getRowElementByUID(x[R]).removeAttribute("aria-selected"),Object(m.X)(this.parent.getRowElementByUID(x[R]).querySelector(".e-check"))||Object(m.ib)([this.parent.getRowElementByUID(x[R]).querySelector(".e-check")],["e-check"]);for(var D=0;D<this.parent.getRowElementByUID(x[R]).children.length;D++)this.parent.getRowElementByUID(x[R]).children[D].classList.remove("e-selectionbackground","e-active")}for(var E=0;E<j.length;E++)if(!Object(m.X)(this.parent.getRowObjectFromUID(j[E]))&&this.parent.getRowObjectFromUID(j[E]).isSelected){this.parent.getRowElementByUID(j[E]).setAttribute("aria-selected","true"),Object(m.X)(this.parent.getRowElementByUID(j[E]).querySelector(".e-frame"))||Object(m.v)([this.parent.getRowElementByUID(j[E]).querySelector(".e-frame")],["e-check"]);for(var I=0;I<this.parent.getRowElementByUID(j[E]).children.length;I++)this.parent.getRowElementByUID(j[E]).children[I].classList.add("e-selectionbackground","e-active")}}}else{this.parent.enableVirtualization&&this.parent.isFrozenGrid()?(this.parent.enableColumnVirtualization&&"virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&(y=this.parent.contentModule.generateRows(n,t),t.renderMovableContent=!0),y=this.parent.contentModule.generateRows(n,t)):(y=this.checkCache(y,t),this.isAddRows||this.useGroupCache||(y=this.generator.generateRows(n,t))),this.setGroupCache(y,t),this.parent.notify("set-infinite-cache",{isInfiniteScroll:f,modelData:y,args:t});var M=y[0].cells[0].index;if(p&&(b=r.setTbody(y,t),v=r.getTbody(b)),"infiniteScroll"!==t.requestType&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!t.isFrozen){for(var F=[],T=0;T<this.parent.registeredTemplate.template.length;T++)for(var z=0;z<this.parent.registeredTemplate.template[T].rootNodes.length;z++)Object(m.X)(this.parent.registeredTemplate.template[T].rootNodes[z].parentNode)&&F.push(this.parent.registeredTemplate.template[T]);this.parent.destroyTemplate(["template"],F)}this.parent.isReact&&"infiniteScroll"!==t.requestType&&!t.isFrozen&&(this.parent.destroyTemplate(["columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate"]),this.parent.renderTemplates()),this.parent.enableColumnVirtualization&&new J(this.serviceLocator,this.parent).updateVirtualCells(y),p||(this.tbody=this.getTable().querySelector("tbody"));var L=0,B=!0;if(Si(i)&&i.vcRows.length){var P="top",q=Object(m.X)(t.virtualInfo.offsets)?Object(m.X)(t.scrollTop)?0:t.scrollTop[P]:t.virtualInfo.offsets.top;if(0!==q){for(var V=i.vGroupOffsets,H=i.pageSettings.pageSize/2,N=Object.keys(V).map((function(e){return V[e]})),W=0;W<N.length;W++)if(q<N[W]){if(Object(m.X)(t.virtualInfo)||"up"!==t.virtualInfo.direction){t.virtualInfo.blockIndexes=0===W||1===W?[1,2]:[W,W+1],L=0===W||1===W?0:W*H;break}t.virtualInfo.blockIndexes=0===W||1===W?[1,2]:[W,W+1],L=0===W||1===W?0:W*H;break}q+this.contentPanel.firstElementChild.offsetHeight!==this.contentPanel.firstElementChild.scrollHeight||t.rowObject||(B=!1)}}var X=i.frozenRows&&!i.isFrozenGrid()&&this.parent.enableVirtualization&&"reorder"===t.requestType;if(i.frozenRows&&"virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis||X){var G=t.virtualInfo.blockIndexes,K=t.virtualInfo.page;t.virtualInfo.blockIndexes=[1,2],X&&(t.virtualInfo.page=1);var U=this.vgenerator.generateRows(X?this.initialPageRecords:n,t);U.splice(this.parent.frozenRows);for(var Y=0;Y<this.parent.frozenRows;Y++)U[Y].cells.splice(0,this.parent.getFrozenColumns()),l=g.render(U[Y],u),c.appendChild(l);t.virtualInfo.blockIndexes=G,t.virtualInfo.page=K,X&&1===t.virtualInfo.page&&y.splice(0,this.parent.frozenRows)}this.virtualFrozenHdrRefresh(c,y,g,t,n,u);for(var Q=L,$=y.length;Q<$;Q++)if(this.rows.push(y[Q]),!this.parent.groupSettings.enableLazyLoading||this.useGroupCache||!this.parent.groupSettings.columns.length||(this.setRowsInLazyGroup(y[Q],Q),!Object(m.X)(y[Q].indent))){if(this.setInfiniteVisibleRows(t,y[Q],b),Si(i)&&this.rows.length>=i.pageSettings.pageSize&&B)break;if(i.rowTemplate){var ee=void 0,te=i.element.id+"rowTemplate";if(i.isReact){var ie=i.frozenRows&&Q<i.frozenRows,ne=Object(m.K)({index:Q},n[Q]);i.getRowTemplate()(ne,i,"rowTemplate",te,null,null,ie?c:a),i.renderTemplates()}else ee=i.getRowTemplate()(Object(m.K)({index:Q},n[Q]),i,"rowTemplate",te);if(i.isReact||"TBODY"!==ee[0].tagName)i.frozenRows&&Q<i.frozenRows?l=i.isReact?c.lastElementChild:Jt(c,ee):(i.isReact||(l=Jt(a,ee)),h=i.isReact?a.lastElementChild:l.lastElementChild);else{for(var re=0;re<ee.length;re++){var se="tr"===ee[re].nodeName.toLowerCase();(se||ee[re].querySelectorAll&&ee[re].querySelectorAll("tr").length)&&(l=se?ee[re]:ee[re].querySelector("tr"))}i.frozenRows&&Q<i.frozenRows?c.appendChild(l):a.appendChild(l)}this.parent.trigger("rowDataBound",{data:y[Q].data,row:h||l})}else{l=g.render(y[Q],u);var ae=this.ensureFrozenHeaderRender(t);i.frozenRows&&Q<i.frozenRows&&!f&&"virtualscroll"!==t.requestType&&ae&&this.ensureVirtualFrozenHeaderRender(t)?c.appendChild(l):a.appendChild(l),y[Q].isExpand&&i.notify("expandchildgrid",l.cells[i.groupSettings.columns.length])}y[Q].isDataRow&&this.rowElements.push(l),this.ariaService.setOptions(this.getTable(),{colcount:i.getColumns().length.toString()})}if(p&&r.splitRows(b),i.frozenRows&&"virtualscroll"!==t.requestType&&!f&&this.ensureVirtualFrozenHeaderRender(t)||"virtualscroll"===t.requestType&&t.virtualInfo.sentinelInfo&&"X"===t.virtualInfo.sentinelInfo.axis)if(o=p?r.getFrozenHeader(b):i.getHeaderTable().querySelector("tbody"),s){var le=o.parentElement;Object(m.hb)(o),le.appendChild(c)}else o.innerHTML="",o.appendChild(c);!i.enableVirtualization&&i.frozenRows&&0===M&&k.offsetHeight===Number(i.height)&&(k.style.height=k.offsetHeight-o.offsetHeight+"px"),Object(m.W)()&&!this.parent.isJsComponent||(t.rows=this.rows.slice(0)),p&&r.setIsFrozen(t,b),this.index=M,Dt((function(){e.parent.notify("beforeFragAppend",t);var n=e.parent.enableVirtualization&&e.parent.isFrozenGrid();if(e.parent.enableVirtualization||f||(e.parent.isFrozenGrid()?(Object(m.hb)(v),v=e.parent.createElement("tbody")):(Object(m.hb)(e.tbody),e.tbody=e.parent.createElement("tbody"))),!p||n||e.parent.enableInfiniteScrolling)if(i.rowTemplate&&Object(m.sb)(i.element.id+"rowTemplate","RowTemplate",i),n){if(t.renderFrozenRightContent){var s=i.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");e.appendContent(s,a,t)}else t.renderMovableContent?(e.appendContent(w.querySelector("tbody"),a,t),t.renderMovableContent=!1):e.appendContent(C.querySelector("tbody"),a,t);e.parent.getFrozenColumns()||r.renderNextFrozentPart(t,b)}else if(!Object(m.X)(e.parent.infiniteScrollModule)&&e.parent.enableInfiniteScrolling){if(e.isAddRows=!1,e.parent.notify("remove-infinite-rows",{args:t}),e.parent.notify("append-infinite-content",{tbody:v||e.tbody,frag:a,args:t,rows:e.rows,rowElements:e.rowElements,visibleRows:e.visibleRows,tableName:b}),!d&&p){var l=e.parent.getTablesCount();(2!==l||"frozen-left"!==b&&"frozen-right"!==b)&&(3!==l||"frozen-left"!==b&&"movable"!==b)||e.refreshContentRows(Object(m.K)({},t))}}else e.useGroupCache=!1,e.appendContent(e.tbody,a,t);else e.appendContent(v,a,t,b);d&&r.renderNextFrozentPart(t,b),a=null}),this.rafCallback(Object(m.K)({},t)))}}}},{key:"emptyVcRows",value:function(){this.parent.vcRows=[],this.parent.vRows=[]}},{key:"appendContent",value:function(e,t,i,n){this.parent.isReact&&!Object(m.X)(this.parent.rowTemplate)?this.getTable().appendChild(t):(e.appendChild(t),this.getTable().appendChild(e))}},{key:"setRowsInLazyGroup",value:function(e,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.contentModule.maintainRows(e,t)}},{key:"setGroupCache",value:function(e,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify("group-cache",{args:t,data:e})}},{key:"ensureFrozenHeaderRender",value:function(e){return!(this.parent.enableVirtualization&&("reorder"===e.requestType||"refresh"===e.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)}},{key:"ensureVirtualFrozenHeaderRender",value:function(e){return!(this.parent.enableVirtualization&&"delete"===e.requestType)}},{key:"checkCache",value:function(e,t){if(this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===t.requestType){var i=t.isFrozen?1:0,n=this.parent.isFrozenGrid();if(this.isAddRows=!Object(m.X)(this.infiniteCache[this.parent.pageSettings.currentPage]),n&&!Object(m.X)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][i].length),this.isAddRows){var r=n?this.infiniteCache[this.parent.pageSettings.currentPage][i]:this.infiniteCache[this.parent.pageSettings.currentPage];e=1===this.parent.pageSettings.currentPage?r.slice(this.parent.frozenRows):r}return e}return this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===t.requestType||"columnstate"===t.requestType||"reorder"===t.requestType)&&this.parent.contentModule.getGroupCache()[this.parent.pageSettings.currentPage]?(this.useGroupCache=!0,this.parent.contentModule.initialGroupRows("reorder"===t.requestType)):null}},{key:"setInfiniteVisibleRows",value:function(e,t,i){var n=this.parent.isFrozenGrid();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(n?"frozen-left"===i||"Right"===this.parent.getFrozenMode()&&"frozen-right"===i?this.visibleFrozenRows.push(t):"movable"===i?this.visibleRows.push(t):this.rightFreezeRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))}},{key:"getCurrentBlockInfiniteRecords",value:function(e){var t=[];if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];var i=this.parent.isFrozenGrid(),n=this.parent.getRows(),r=parseInt(n[this.parent.frozenRows].getAttribute("aria-rowindex"),10),s=Math.ceil((r+1)/this.parent.pageSettings.pageSize);r=parseInt(n[n.length-1].getAttribute("aria-rowindex"),10);var a=Math.ceil(r/this.parent.pageSettings.pageSize);if(i){for(var l=e?0:1,o=s;o<=a;o++)t=t.length?t.concat(this.infiniteCache[o][l]):this.infiniteCache[o][l];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][l].slice(0,this.parent.frozenRows).concat(t))}else{for(var h=s;h<=a;h++)t=t.length?t.concat(this.infiniteCache[h]):this.infiniteCache[h];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t}},{key:"getReorderedVFRows",value:function(e){return this.parent.contentModule.getReorderedFrozenRows(e)}},{key:"virtualFrozenHdrRefresh",value:function(e,t,i,n,r,s){if(this.parent.frozenRows&&this.parent.isFrozenGrid()&&this.parent.enableVirtualization&&("reorder"===n.requestType||"refresh"===n.requestType)){var a;this.currentMovableRows=r;for(var l=this.getReorderedVFRows(n),o=0;o<l.length;o++)a=i.render(l[o],s),e.appendChild(a);1===n.virtualInfo.page&&t.splice(0,this.parent.frozenRows),n.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}}},{key:"getInfiniteRows",value:function(){var e=[],t=this.parent.isFrozenGrid();if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache)for(var i=Object.keys(this.infiniteCache),n=0;n<i.length;n++)e=[].concat(h(e),h(t?this.infiniteCache[i[n]][0]:this.infiniteCache[i[n]]));else e=t?this.visibleFrozenRows:this.visibleRows;return e}},{key:"getInfiniteMovableRows",value:function(){var e=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?e.length?e:this.visibleRows:[]}},{key:"getPanel",value:function(){return this.contentPanel}},{key:"setPanel",value:function(e){this.contentPanel=e}},{key:"getTable",value:function(){return this.contentTable}},{key:"setTable",value:function(e){this.contentTable=e}},{key:"getRows",value:function(){var e=this.getInfiniteRows();return e.length?e:this.parent.getFrozenColumns()?this.freezeRows:this.rows}},{key:"getMovableRows",value:function(){var e=this.getInfiniteMovableRows();return e.length?e:this.movableRows}},{key:"getRowElements",value:function(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements}},{key:"getMovableRowElements",value:function(){return this.rowElements}},{key:"setRowElements",value:function(e){this.rowElements=e}},{key:"getColGroup",value:function(){return this.colgroup}},{key:"setColGroup",value:function(e){return Object(m.X)(e)||(e.id="content-"+e.id),this.colgroup=e}},{key:"setVisible",value:function(e){var t=this.parent;Object(m.W)()&&t.isServerRendered&&this.parent.notify("setvisibility",e);var i,n=this.parent.isFrozenGrid(),r=t.getFrozenColumns(),s=[];if(n){var a,l=this.freezeRows,o=this.movableRows,h=l.length,c=[];3===t.getTablesCount()&&(c=t.getFrozenRightRowsObject());for(var u,d=0;d<h;d++){a=o[d].cells.length;var p=c.length?c[d].cells.length:0;u=l[d].clone();for(var g=0;g<a;g++)u.cells.push(o[d].cells[g]);for(var f=0;f<p;f++)u.cells.push(c[d].cells[f]);s.push(u)}}else s=this.getRows();s.some((function(e){return e.isDataRow&&(i=e),e.isDataRow}));var v=!0;!t.groupSettings.columns.length&&i&&(v=!1);for(var b=t.getDataRows(),y=this.infiniteRowVisibility()||this.rows.filter((function(e){return!e.isDetailRow})),C=0,w=e.length;C<w;C++){var k=e[C],S=this.parent.getNormalizedColumnIndex(k.uid),O=this.parent.getColumnIndexByUid(k.uid),x=!0===k.visible?"":"none";if(-1!==S&&i&&S<i.cells.length)if(n)if("movable"!==k.getFreezeTableName())if("frozen-right"===k.getFreezeTableName()){O=S-=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount();var j=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("colgroup");Object(m.ob)(j.childNodes[S],{display:x}),y=t.getFrozenRightRowsObject(),b=t.getFrozenRightDataRows()}else Object(m.ob)(this.getColGroup().childNodes[S],{display:x}),y=this.infiniteRowVisibility(!0)||this.freezeRows,b=t.getDataRows();else{var R=t.getContent().querySelector(".e-movablecontent").querySelector("colgroup");O=S=S-r-this.parent.getFrozenLeftColumnsCount(),Object(m.ob)(R.childNodes[S],{display:x}),b=t.getMovableDataRows(),y=this.infiniteRowVisibility()||this.movableRows}else Object(m.ob)(this.getColGroup().childNodes[S],{display:x});v||this.setDisplayNone(b,O,x,y),!this.parent.invokedFromMedia&&k.hideAtMedia&&this.parent.updateMediaColumns(k),this.parent.invokedFromMedia=!1}v?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify("partial-refresh",{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify("partial-refresh",{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify("partial-refresh",{rows:y,args:{}})}},{key:"setDisplayNone",value:function(e,t,i,n){for(var r=Object.keys(e),s=0;s<r.length;s++){var a=e[r[s]].querySelectorAll("td.e-rowcell")[t];if(e[r[s]].querySelectorAll("td.e-rowcell").length&&a)if(Object(m.ob)(e[r[s]].querySelectorAll("td.e-rowcell")[t],{display:i}),e[r[s]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(m.ib)([e[r[s]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),this.parent.isRowDragable()){var l=this.parent.getFrozenColumns()?t:t+1;n[r[s]].cells[l].visible=""===i}else n[r[s]].cells[t].visible=""===i}this.parent.notify("infinite-show-hide",{visible:i,index:t,isFreeze:this.isInfiniteFreeze})}},{key:"infiniteRowVisibility",value:function(e){var t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=e,t=this.parent.infiniteScrollSettings.enableCache?e?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():e?this.visibleFrozenRows:this.visibleRows),t}},{key:"colGroupRefresh",value:function(){var e;this.getColGroup()&&(e=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):this.getHeaderColGroup(),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e))}},{key:"getHeaderColGroup",value:function(){return Object(m.W)()?this.parent.getHeaderTable().querySelector("colgroup").cloneNode(!0):this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)}},{key:"initializeContentDrop",value:function(){this.droppable=new m.j(this.parent.element,{accept:".e-dragclone",drop:this.drop})}},{key:"droppableDestroy",value:function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()}},{key:"canSkip",value:function(e,t,i){return Object(m.X)(t)||Object(m.X)(e.visible)||t.cells[i].visible===e.visible}},{key:"getModelGenerator",value:function(){return this.generator=this.parent.allowGrouping?new ne(this.parent):new $(this.parent)}},{key:"renderEmpty",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&this.parent.frozenRows||(this.getTable().appendChild(e),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("tbody").innerHTML=""))}},{key:"setSelection",value:function(e,t,i){this.parent.notify("set-freeze-selection",{uid:e,set:t,clearAll:i});var n=this.parent.isFrozenGrid();if(!n||!this.parent.enableVirtualization){if(n)for(var r=this.getMovableRows().filter((function(t){return i||e===t.uid})),s=0;s<r.length;s++)r[s].isSelected=t;for(var a=this.getRows().filter((function(t){return i||e===t.uid})),l=0;l<a.length;l++){a[l].isSelected=t;for(var o=a[l].cells,h=0;h<o.length;h++)o[h].isSelected=t}}}},{key:"getRowByIndex",value:function(e){return e=this.getInfiniteRowIndex(e),this.parent.getDataRows()[e]}},{key:"getInfiniteRowIndex",value:function(e){if(this.parent.infiniteScrollSettings.enableCache){var t=this.parent.frozenRows,i=t>e?0:t,n=parseInt(this.parent.getRows()[i].getAttribute("aria-rowindex"),10);e=t>e?e:e-n+t}return e}},{key:"getVirtualRowIndex",value:function(e){return e}},{key:"getMovableRowByIndex",value:function(e){return e=this.getInfiniteRowIndex(e),this.parent.getMovableDataRows()[e]}},{key:"enableAfterRender",value:function(e){"group"===e.module&&e.enable&&(this.generator=this.getModelGenerator())}},{key:"setRowObjects",value:function(e){this.rows=e}},{key:"immutableModeRendering",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.parent;i.hideSpinner();var n=i.getPrimaryKeyFieldNames()[0],r={},s={},a=[],l={},o=i.getRowsObject().slice(),h=this.getBatchEditedRecords(n,o),c={},u=0!==Object.keys(h).length;if(i.getContent().querySelector(".e-emptyrow")||"reorder"===t.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(t);else{if(0===i.currentViewData.length)return;var d={},p=i.createElement("tbody"),g=i.currentViewData,f=[].slice.call(this.getTable().querySelector("tbody").children);if(this.prevCurrentView.length){var v=this.prevCurrentView.length,b=g.length;if(v===b)for(var y=0;y<b;y++)"Batch"===this.parent.editSettings.mode&&f[y].classList.contains("e-insertedrow")?(f.splice(y,1),--y):(s[g[y][n]]=r[this.prevCurrentView[y][n]]=y,c[y]=g[y][n],d[o[y].uid]=f[y],l[y]=this.prevCurrentView[y][n]);else{for(var C=0;C<b;C++)s[g[C][n]]=C,c[C]=g[C][n];for(var w=0;w<v;w++)"Batch"===this.parent.editSettings.mode&&f[w].classList.contains("e-insertedrow")?(f.splice(w,1),--w):(d[o[w].uid]=f[w],r[this.prevCurrentView[w][n]]=w,l[w]=this.prevCurrentView[w][n])}}for(var k=0;k<g.length;k++){var S=r[g[k][n]];if(Object(m.X)(S)){var O=new Z(this.serviceLocator,null,i),x=this.generator.generateRows([g[k]]);a.push(x[0]);var j=O.render(x[0],i.getColumns());p.appendChild(j),this.refreshImmutableContent(k,j,a[k])}else{var R=!1;this.mutableData&&(R=this.objectEqualityChecker(this.prevCurrentView[k],g[k]));var D=d[o[S].uid];if(a.push(o[S]),this.rowElements[k]&&this.rowElements[k].getAttribute("data-uid")===a[k].uid&&(u&&Object(m.X)(h[c[k]])||!u&&(R||this.prevCurrentView[k]===g[k]))){S!==k&&this.refreshImmutableContent(k,D,a[k]),p.appendChild(D);continue}(u&&!Object(m.X)(h[c[k]])||!this.mutableData&&g[k]!==this.prevCurrentView[S]||this.mutableData&&!R)&&o[S].setRowValue(g[k]),p.appendChild(D),this.refreshImmutableContent(k,D,a[k])}}if(this.rows=a,this.rowElements=[].slice.call(p.children),Object(m.hb)(this.getTable().querySelector("tbody")),this.getTable().appendChild(p),this.parent.trigger(I,{},(function(){e.parent.allowTextWrap&&e.parent.notify("freezerender",{case:"textwrap"})})),t){var E=(t.requestType||"").toLowerCase()+"-complete";this.parent.notify(E,t)}}}},{key:"objectEqualityChecker",value:function(e,t){for(var i=Object.keys(e),n=!0,r=0;r<i.length;r++)if(e[i[r]]!==t[i[r]]){n=!1;break}return n}},{key:"getBatchEditedRecords",value:function(e,t){var i={},n=this.parent.getBatchChanges(),r=[],s=[];Object.keys(n).length&&(r=n.changedRecords,s=n.addedRecords);var a={cancel:!1};this.parent.notify("immutable-batch-cancel",{rows:t,args:a}),s.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,s.length):a.cancel||t.splice(0,s.length));for(var l=0;l<r.length;l++)i[r[l][e]]=l;return i}},{key:"refreshImmutableContent",value:function(e,t,i){i.isAltRow=!!this.parent.enableAltRow&&e%2!=0,i.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow"),i.index=e,i.edit=void 0,i.isDirty=!1,t.setAttribute("aria-rowindex",e.toString()),this.updateCellIndex(t,e)}},{key:"updateCellIndex",value:function(e,t){for(var i=0;i<e.cells.length;i++)e.cells[i].setAttribute("index",t.toString())}}]),e}(),se=function(){function e(t,i){var n=this;p(this,e),this.frzIdx=0,this.notfrzIdx=0,this.isFirstCol=!1,this.isReplaceDragEle=!0,this.helper=function(e){var t=n.parent,i=n.draggable.currentStateTarget,r=Wt(i,"e-headercell");if(!t.allowReordering&&!t.allowGrouping||!Object(m.X)(r)&&r.querySelectorAll(".e-checkselectall").length>0)return!1;var s=n.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),a=i.classList.contains("e-headercell")?i:r;if(!a||!t.allowReordering&&a.classList.contains("e-stackedheadercell"))return!1;var l,o=a.offsetHeight,h=a.querySelector(".e-headercelldiv")||a.querySelector(".e-stackedheadercelldiv");if(h){if(l=a.querySelector(".e-stackedheadercelldiv")?t.getStackedHeaderColumnByHeaderText(h.innerText.trim(),t.columns):t.getColumnByUid(h.getAttribute("e-mappinguid")),n.column=l,n.column.lockColumn)return!1;s.setAttribute("e-mappinguid",n.column.uid)}if(l&&!Object(m.X)(l.headerTemplate))if(Object(m.X)(l.headerTemplate))s.innerHTML=l.headerTemplate;else{var c=t.getColumnIndexByField(l.field);Jt(s,l.getHeaderTemplate()(Object(m.K)({index:c},l),t,"headerTemplate"))}else s.innerHTML=h?l.headerText:a.firstElementChild.innerHTML;return s.style.width=a.offsetWidth+"px",s.style.height=a.offsetHeight+"px",s.style.lineHeight=(o-6).toString()+"px",t.element.appendChild(s),s},this.dragStart=function(e){var t=n.parent;t.element.querySelector(".e-gridpopup").style.display="none",t.notify("columnDragStart",{target:n.draggable.currentStateTarget,column:n.column,event:e.event}),Object(m.W)()&&e.bindEvents(e.dragElement)},this.drag=function(e){var t=n.parent,i=e.target;if(i){var r=Object(m.C)(i,".e-grid"),s=n.parent.element.querySelector(".e-cloneproperties");if(!(r&&r.getAttribute("id")===t.element.getAttribute("id")||(Object(m.A)(s,["e-notallowedcur"],["e-defaultcur"]),t.allowReordering&&(t.element.querySelector(".e-reorderuparrow").style.display="none",t.element.querySelector(".e-reorderdownarrow").style.display="none"),t.groupSettings.allowReordering)))return;t.notify("columnDrag",{target:e.target,column:n.column,event:e.event})}},this.dragStop=function(e){var t,i=n.parent;i.element.querySelector(".e-gridpopup").style.display="none",(!Wt(e.target,"e-headercell")&&!Wt(e.target,"e-groupdroparea")||!i.allowReordering&&Wt(e.target,"e-headercell")||!e.helper.getAttribute("e-mappinguid")&&Wt(e.target,"e-groupdroparea"))&&(Object(m.hb)(e.helper),t=!0),i.notify("column-drag-stop",{target:e.target,event:e.event,column:n.column,cancel:t})},this.drop=function(e){var t=n.parent,i=e.droppedElement.getAttribute("e-mappinguid"),r=Object(m.C)(e.target,".e-grid");Object(m.hb)(e.droppedElement),r&&r.getAttribute("id")!==t.element.getAttribute("id")||!t.allowReordering&&!t.allowGrouping||t.notify("header-drop",{target:e.target,uid:i,droppedElement:e.droppedElement})},this.parent=t,this.serviceLocator=i,this.ariaService=this.serviceLocator.getService("ariaService"),this.widthService=this.serviceLocator.getService("widthService"),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount()||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("column-position-changed",this.colPosRefresh,this))}return f(e,[{key:"renderPanel",value:function(){var e=this.parent.element.querySelector(".e-gridheader"),t=null!=e;e=t?e:this.parent.createElement("div",{className:"e-gridheader"});var i=t?e.querySelector(".e-headercontent"):this.parent.createElement("div",{className:"e-headercontent"});this.toggleStackClass(e),e.appendChild(i),this.setPanel(e),t||this.parent.element.appendChild(e)}},{key:"renderTable",value:function(){var e=this.getPanel();e.appendChild(this.createHeaderTable()),this.setTable(e.querySelector(".e-table")),this.parent.getFrozenColumns()||this.parent.getFrozenRightColumnsCount()||this.parent.getFrozenLeftColumnsCount()||(this.initializeHeaderDrag(),this.initializeHeaderDrop()),this.parent.notify(q,{rows:this.rows,args:{isFrozen:this.parent.isFrozenGrid()}})}},{key:"getPanel",value:function(){return this.headerPanel}},{key:"setPanel",value:function(e){this.headerPanel=e}},{key:"getTable",value:function(){return this.headerTable}},{key:"setTable",value:function(e){this.headerTable=e}},{key:"getColGroup",value:function(){return this.colgroup}},{key:"setColGroup",value:function(e){return this.colgroup=e}},{key:"getRows",value:function(){return this.getTable().tHead.rows}},{key:"createHeaderTable",value:function(){var e=Object(m.W)()&&0!==this.parent.frozenRows,t=this.createTable(),i=this.getPanel().querySelector(".e-headercontent");return e||i.appendChild(t),i}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(m.W)()&&0!==this.parent.frozenRows,i=this.parent,n=i.isFrozenGrid();Object(m.W)()&&!i.isJsComponent||!this.getTable()||n||Object(m.hb)(this.getTable()),i.getColumns();var r=this.getPanel().querySelector(".e-headercontent"),s=t?e||r.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid"}}),a=this.createHeaderContent(),l=a.thead,o=this.parent.createElement("tbody",{className:this.parent.frozenRows?"":"e-hide"});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});var h,c=this.parent.createElement("colgroup"),u=this.parent.createElement("tr"),d=this.rows=a.rows;new Z(this.serviceLocator,K.Header,this.parent);for(var p=0,g=d.length;p<g;p++)for(var f=0,v=d[p].cells.length;f<v;f++)h=this.parent.createElement("td"),u.appendChild(h);return(i.allowFiltering||i.allowSorting||i.allowGrouping)&&s.classList.add("e-sortfilter"),this.updateColGroup(c),t||o.appendChild(u),s.appendChild(this.setColGroup(c)),s.appendChild(l),t||s.appendChild(o),s.appendChild(this.caption),this.ariaService.setOptions(s,{colcount:i.getColumns().length.toString()}),s}},{key:"createHeaderContent",value:function(){var e=this.parent,t=1,i=e.getFrozenMode(),n=e.getColumns(),r=this.parent.createElement("thead"),s=this.parent.createElement("tr",{className:"e-columnheader"}),a=new Z(this.serviceLocator,K.Header,e);a.element=s;var l,o=[];this.colDepth=Ei(e.columns);for(var h=0,c=this.colDepth;h<c;h++)o[h]=this.generateRow(h),o[h].cells=[];"Right"!==i&&(o=this.ensureColumns(o)),o=this.getHeaderCells(o),"Right"===i&&(t=0,o=this.ensureColumns(o));var u=this.parent.getFrozenColumns();if(this.parent.isRowDragable()&&this.parent.isFrozenGrid()&&o[0].cells[t]){var d=o[0].cells[t].column.getFreezeTableName();"movable"===d||"Left-Right"===i&&"frozen-right"===d?"Right"===i?o[0].cells.pop():o[0].cells.shift():u||"frozen-left"!==d?"Right"===i&&"frozen-right"===d&&(o[0].cells[o[0].cells.length-1].column.freeze="Right"):o[0].cells[0].column.freeze="frozen-left"===d?"Left":"Right"}for(var p=0,g=this.colDepth;p<g;p++)l=a.render(o[p],n),this.parent.rowHeight&&l.querySelector(".e-headercell")&&(l.style.height=this.parent.rowHeight+"px"),r.appendChild(l);return{thead:r,rows:o}}},{key:"updateColGroup",value:function(e){var t,i=this.parent.getColumns(),n=this.parent.getColumnIndexesInView();if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(i=Object(m.K)([],this.parent.getColumns())).splice(0,this.parent.getFrozenColumns()),e.id=this.parent.element.id+"colGroup",this.parent.allowGrouping)for(var r=0,s=this.parent.groupSettings.columns.length;r<s;r++)this.parent.enableColumnVirtualization&&-1===n.indexOf(r)||(t=this.parent.createElement("col",{className:"e-group-intent"}),e.appendChild(t));(this.parent.detailTemplate||this.parent.childGrid)&&(t=this.parent.createElement("col",{className:"e-detail-intent"}),e.appendChild(t)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t));for(var a=0,l=i.length;a<l;a++)t=this.parent.createElement("col"),!1===i[a].visible&&Object(m.ob)(t,{display:"none"}),e.appendChild(t);return this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t)),e}},{key:"ensureColumns",value:function(e){for(var t=this.parent,i=this.parent.getColumnIndexesInView(),n=0,r=e.length;n<r;n++){if(t.allowGrouping)for(var s=0,a=t.groupSettings.columns.length;s<a;s++)this.parent.enableColumnVirtualization&&-1===i.indexOf(s)||e[n].cells.push(this.generateCell({},K.HeaderIndent));if(t.detailTemplate||t.childGrid){var l={};this.parent.notify("detail-indentcell-info",l),e[n].cells.push(this.generateCell(l,K.DetailHeader))}t.isRowDragable()&&e[n].cells.push(this.generateCell({},K.RowDragHIcon))}return e}},{key:"getHeaderCells",value:function(e){var t,i=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),n=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns;if(t=this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&this.parent.contentModule.isXaxis()?"movable":Ni(this.parent),this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(var r=0;r<n.length;r++)this.lockColsRendered=!1,e=this.appendCells(n[r],e,0,0===r,!1,r===n.length-1,i,t);for(var s=0,a=n.length;s<a;s++)this.notfrzIdx=0,this.lockColsRendered=!0,e=this.appendCells(n[s],e,0,0===s,!1,s===a-1,i,t);return e}},{key:"appendCells",value:function(e,t,i,n,r,s,a,l){var o,h=s?"e-lastcell":"",c=this.parent.isFrozenGrid(),u=!this.parent.lockcolPositionCount||e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered,d=!this.parent.lockcolPositionCount||e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered,p=this.parent.getContent().querySelector(".e-movablescrollbar");if(c&&p&&this.parent.enableColumnVirtualization&&(o=p.scrollLeft),e.columns){this.isFirstCol=!1;var g=this.getCellCnt(e,0);if(g){var f=this.getStackedLockColsCount(e,0),m=0===this.parent.lockcolPositionCount||!this.lockColsRendered&&0!==f||this.lockColsRendered&&g-f!=0,v=c&&this.ensureStackedFrozen(e.columns,l,!1);(!c&&m||v)&&t[i].cells.push(new Q({cellType:K.StackedHeader,column:e,colSpan:this.getColSpan(g,f,e.columns,l,c)}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(var b=0;b<e.columns.length;b++)t=this.appendCells(e.columns[b],t,i+1,n,0===b,b===e.columns.length-1&&s,a,l);if(this.lockColsRendered)for(var y=0,C=e.columns.length;y<C;y++){var w=this.isFirstCol=e.columns[y].visible&&!this.isFirstCol&&1!==C;t=this.appendCells(e.columns[y],t,i+1,n,w,y===C-1&&s,a,l)}}else(o&&o>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&"movable"===e.getFreezeTableName()||!c&&u||c&&e.getFreezeTableName()===l&&d)&&t[i].cells.push(this.generateCell(e,K.Header,this.colDepth-i,(n?"":r?"e-firstcell":"")+h,i,this.parent.getColumnIndexByUid(e.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(e.lockColumn&&!this.lockColsRendered||!e.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return t}},{key:"ensureStackedFrozen",value:function(e,t,i){for(var n=e.length,r=0;r<n;r++)if(e[r].columns)i=this.ensureStackedFrozen(e[r].columns,t,i);else if(e[r].getFreezeTableName()===t){i=!0;break}return i}},{key:"getStackedLockColsCount",value:function(e,t){if(e.columns)for(var i=0;i<e.columns.length;i++)t=this.getStackedLockColsCount(e.columns[i],t);else e.lockColumn&&t++;return t}},{key:"getColSpan",value:function(e,t,i,n,r){return r?e=this.getFrozenColSpan(i,n,0):this.parent.lockcolPositionCount&&(e=this.lockColsRendered?e-t:t),e}},{key:"getFrozenColSpan",value:function(e,t,i){for(var n=e.length,r=0;r<n;r++)e[r].columns?i=this.getFrozenColSpan(e[r].columns,t,i):e[r].getFreezeTableName()===t&&i++;return i}},{key:"generateRow",value:function(e){return new _({})}},{key:"generateCell",value:function(e,t,i,n,r,s){var a={visible:e.visible,isDataCell:!1,isTemplate:!Object(m.X)(e.headerTemplate),rowID:"",column:e,cellType:t,rowSpan:i,className:n,index:r,colIndex:s};return(!a.rowSpan||a.rowSpan<2)&&delete a.rowSpan,new Q(a)}},{key:"setVisible",value:function(e){for(var t,i,n=this.parent,r=([].slice.call(this.getRows()),n.getFrozenColumns()),s=0,a=e.length;s<a;s++){var l=e[s];if(i=n.getNormalizedColumnIndex(l.uid),t=l.visible?"":"none",r){var o=this.parent.isRowDragable()?r+1:r;if(i<o)Object(m.W)()&&n.isServerRendered?(Object(m.ob)(this.getTable().querySelector("colgroup").children[i],{display:t}),Object(m.ob)(this.getTable().querySelectorAll("th")[i],{display:t})):Object(m.ob)(this.getColGroup().children[i],{display:t});else{var h=n.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup"),c=n.getHeaderContent().querySelector(".e-movableheader").querySelector("table");Object(m.ob)(h.children[i-o],{display:t}),Object(m.W)()&&n.isServerRendered&&Object(m.ob)(c.querySelectorAll("th")[i-r],{display:t})}}else Object(m.ob)(this.getColGroup().children[i],{display:t})}this.refreshUI()}},{key:"colPosRefresh",value:function(){Object(m.W)()&&this.parent.isServerRendered&&this.parent.frozenRows&&this.parent.getFrozenColumns()&&(this.freezeReorder=!0),this.refreshUI()}},{key:"refreshUI",value:function(){var e=this.parent.isFrozenGrid(),t=this.parent.enableColumnVirtualization&&e,i=Object(m.W)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows&&e,n=this.getPanel();this.toggleStackClass(n);var r=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.getTable();if(t&&(r=this.parent.contentModule.getVirtualFreezeHeader()),i&&!t&&(r=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.headerPanel.querySelector(".e-frozenheader").querySelector(".e-table")),r){Object(m.W)()&&this.parent.isServerRendered?(r.removeChild(r.querySelector("colgroup")),r.removeChild(r.querySelector("thead"))):(Object(m.hb)(r),r.removeChild(r.firstChild),r.removeChild(r.childNodes[0]));var s=this.parent.createElement("colgroup"),a=this.createHeaderContent();this.rows=a.rows,r.insertBefore(a.thead,r.firstChild),this.updateColGroup(s),r.insertBefore(this.setColGroup(s),r.firstChild),t||i||this.setTable(r),Object(m.W)()&&this.parent.isServerRendered||this.appendContent(r),this.parent.notify("colgroup-refresh",{}),this.widthService.setWidthToColumns(),this.parent.updateDefaultCursor(),(!e||this.parent.enableColumnVirtualization&&e)&&this.initializeHeaderDrag();var l,o=[].slice.call(n.querySelectorAll("tr.e-columnheader")),h=c(o);try{for(h.s();!(l=h.n()).done;){var u=l.value,d=[].slice.call(u.querySelectorAll(".e-grouptopleftcell"));d.length&&d[d.length-1].classList.add("e-lastgrouptopleftcell")}}catch(p){h.e(p)}finally{h.f()}e||this.parent.notify(q,{rows:this.rows,args:{isFrozen:e}}),this.parent.enableColumnVirtualization&&Wt(r,"e-movableheader")&&this.parent.notify(q,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&hi(o,!0)}}},{key:"toggleStackClass",value:function(e){this.parent.columns.some((function(e){return!Object(m.X)(e.columns)}))?e.classList.add("e-stackedheader"):e.classList.remove("e-stackedheader")}},{key:"appendContent",value:function(e){this.getPanel().querySelector(".e-headercontent").appendChild(e)}},{key:"getCellCnt",value:function(e,t){if(e.columns)for(var i=0,n=e.columns.length;i<n;i++)t=this.getCellCnt(e.columns[i],t);else e.visible&&t++;return t}},{key:"initializeHeaderDrag",value:function(){(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new m.i(this.parent.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}))}},{key:"initializeHeaderDrop",value:function(){new m.j(this.parent.getHeaderContent(),{accept:".e-dragclone",drop:this.drop})}}]),e}(),ae=function(){function e(t,i){p(this,e),this.localizer=i.getService("localization"),this.formatter=i.getService("valueFormatter"),this.parent=t,this.element=this.parent.createElement("TD",{className:"e-rowcell",attrs:{role:"gridcell",tabindex:"-1"}}),this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox"}})}return f(e,[{key:"getGui",value:function(){return""}},{key:"format",value:function(e,t,i){return Object(m.X)(e.format)||("number"===e.type&&isNaN(parseInt(t,10))&&(t=null),t=this.formatter.toView(t,e.getFormatter())),Object(m.X)(t)?"":t.toString()}},{key:"evaluate",value:function(e,t,i,n,r,s){var a;if(t.column.template){var l=this.parent.isReact&&"string"!=typeof t.column.template,o=["index"],h=Ri({},i,{foreignKeyData:r,column:t.column}),c=this.parent.element.id+t.column.uid,u="isStringTemplate";if(Object(m.W)()&&s){var d="Batch"!==this.parent.editSettings.mode?parseInt(n.index,10):null;a=t.column.getColumnTemplate()(Object(m.K)({index:n[o[0]]},h),this.parent,"template",c,this.parent[u],d),window[c]=null,"Batch"!==this.parent.editSettings.mode&&Object(m.sb)(c,"Template",t.column,!1)}else if(l){var p={index:n[o[0]]};t.column.getColumnTemplate()(Object(m.K)(p,h),this.parent,"columnTemplate",c,this.parent[u],null,e),this.parent.renderTemplates()}else a=t.column.getColumnTemplate()(Object(m.K)({index:n[o[0]]},h),this.parent,"template",c,this.parent[u]);return l||Jt(e,a),this.parent.notify("template-result",{template:a}),a=null,e.setAttribute("aria-label",e.innerText+" is template cell column header "+t.column.headerText),!1}return!0}},{key:"invokeFormatter",value:function(e,t,i){var n;return Object(m.X)(e.formatter)||(t=(n=e.formatter).prototype&&"getValue"in n.prototype?(new(0,e.formatter)).getValue(e,i):"function"==typeof e.formatter?e.formatter(e,i):e.formatter.getValue(e,i)),t}},{key:"render",value:function(e,t,i,n,r){return this.refreshCell(e,t,i,r)}},{key:"refreshTD",value:function(e,t,i,n){var r="Batch"===this.parent.editSettings.mode&&e.classList.contains("e-editedbatchcell");if(this.parent.isReact){e.innerHTML="";var s=e.cellIndex,a=e.parentElement;Object(m.hb)(e);var l=this.refreshCell(t,i,n,r);this.cloneAttributes(l,e),a.cells.length!==s-1?a.insertBefore(l,a.cells[s]):a.appendChild(l)}else{var o=this.refreshCell(t,i,n,r);e.innerHTML="",e.setAttribute("aria-label",o.getAttribute("aria-label"));var h,u=c([].slice.call(o.childNodes));try{for(u.s();!(h=u.n()).done;){var d=h.value;e.appendChild(d)}}catch(p){u.e(p)}finally{u.f()}}}},{key:"cloneAttributes",value:function(e,t){for(var i,n=t.attributes,r=n.length;r--;)i=n[r],e.setAttribute(i.name,i.value)}},{key:"refreshCell",value:function(e,i,n,r){var s,a=this.element.cloneNode(),l=e.column;e.isForeignKey&&(s=e.foreignKeyData[0]||t({},l.foreignKeyValue,l.format?null:""));var o=this.getGui(),h=e.isForeignKey?this.getValue(l.foreignKeyValue,s,l):this.getValue(l.field,i,l);if("date"!==l.type&&"datetime"!==l.type||Object(m.X)(h)||(h=new Date(h)),o=(h=this.format(l,h,i)).toString(),"boolean"===l.type&&!l.displayAsCheckBox){var c="true"!==h&&"false"!==h?null:"true"===h?"True":"False";o=c?this.localizer.getConstant(c):o}var u=this.invokeFormatter(l,h,i);if(o=Object(m.X)(l.formatter)?o:Object(m.X)(u)?"":u.toString(),a.setAttribute("aria-label",o+" column header "+e.column.headerText),this.evaluate(a,e,i,n,s,r)&&"checkbox"!==l.type)this.appendHtml(a,o,l.getDomSetter?l.getDomSetter():"innerHTML");else if("checkbox"===l.type){a.classList.add("e-gridchkbox"),a.setAttribute("aria-label","checkbox"),h=!!this.parent.selectionSettings.persistSelection&&"true"===h;var d=Object(y.f)(this.parent.createElement,!1,{checked:h,label:" "});d.insertBefore(this.rowChkBox.cloneNode(),d.firstChild),a.appendChild(d)}if("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0),this.setAttributes(a,e,n),"boolean"===l.type&&l.displayAsCheckBox){var p=isNaN(parseInt(h.toString(),10))?"true"===h:parseInt(h.toString(),10)>0,g=Object(y.f)(this.parent.createElement,!1,{checked:p,label:" "});a.innerHTML="",g.classList.add("e-checkbox-disabled"),a.appendChild(g),a.setAttribute("aria-label",p+" column header "+e.column.headerText)}return a}},{key:"appendHtml",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"innerHTML";return e[i]=t,e}},{key:"setAttributes",value:function(e,t,i){var n=t.column;this.buildAttributeFromCell(e,t,"checkbox"===n.type),Bt(e,i),Bt(e,t.attributes),n.customAttributes&&Bt(e,n.customAttributes),n.textAlign&&(e.style.textAlign=n.textAlign),"Clip"===n.clipMode||!n.clipMode&&"Clip"===this.parent.clipMode?e.classList.add("e-gridclip"):("EllipsisWithTooltip"===n.clipMode||!n.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==n.type&&e.classList.add("e-ellipsistooltip")}},{key:"buildAttributeFromCell",value:function(e,t,i){var n={},r=[];t.colSpan&&(n.colSpan=t.colSpan),t.rowSpan&&(n.rowSpan=t.rowSpan),t.isTemplate&&r.push("e-templatecell"),t.isSelected&&(r.push("e-selectionbackground","e-active"),i&&e.querySelector(".e-frame").classList.add("e-check")),t.isColumnSelected&&r.push("e-columnselection"),Object(m.X)(t.index)||(n["aria-colindex"]=t.index),t.visible||r.push("e-hide"),n.class=r,Bt(e,n)}},{key:"getValue",value:function(e,t,i){return i.valueAccessor(e,t,i)}}]),e}(),le=function(){function e(){p(this,e)}return f(e,[{key:"setOptions",value:function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)oe(e,Re[i[n]],t[i[n]])}},{key:"setExpand",value:function(e,t){oe(e,Re.expand,t)}},{key:"setSort",value:function(e,t){oe(e,Re.sort,t,"boolean"==typeof t)}},{key:"setBusy",value:function(e,t){oe(e,Re.busy,t),oe(e,Re.invalid,null,!0)}},{key:"setGrabbed",value:function(e,t,i){oe(e,Re.grabbed,t,i)}},{key:"setDropTarget",value:function(e,t){oe(e,Re.dropeffect,"copy",!t)}}]),e}();function oe(e,t,i,n){n&&e?e.removeAttribute(t):e&&e.setAttribute(t,i)}var he,ce,ue,de,pe,ge,fe,me,ve,be,ye,Ce,we,ke,Se,Oe,xe,je,Re={expand:"aria-expanded",role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"},De=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-headercell",attrs:{role:"columnheader",tabindex:"-1"}}),e.ariaService=new le,e.hTxtEle=e.parent.createElement("span",{className:"e-headertext"}),e.sortEle=e.parent.createElement("div",{className:"e-sortfilterdiv e-icons"}),e.gui=e.parent.createElement("div"),e.chkAllBox=e.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox"}}),e}return f(i,[{key:"getGui",value:function(){return this.gui.cloneNode()}},{key:"render",value:function(e,t,i){var n=this.element.cloneNode(),r=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,n,r)}},{key:"refresh",value:function(e,t){this.clean(t);var i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,t,i)}},{key:"clean",value:function(e){e.innerHTML=""}},{key:"prepareHeader",value:function(e,t,i){var n,r,s=e.column,a={},l=this.getGui();if(Object(m.x)(l,{"e-mappinguid":s.uid,class:"e-headercelldiv"}),Object(m.X)(s.headerValueAccessor)||(n=this.getValue(s.headerText,s)),"checkbox"!==s.type){var o=s.headerText;Object(m.X)(n)||(o=n);var h=this.hTxtEle.cloneNode();h[s.getDomSetter()]=o,l.appendChild(h)}else{s.editType="booleanedit";var c=Object(y.f)(this.parent.createElement,!1,{checked:!1,label:" "});c.insertBefore(this.chkAllBox.cloneNode(),c.firstChild),l.appendChild(c),l.classList.add("e-headerchkcelldiv")}if(this.buildAttributeFromCell(t,e),this.appendHtml(t,l),t.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&s.allowFiltering&&!Object(m.X)(s.field)&&(!this.parent.showColumnMenu||!s.showColumnMenu)){Object(m.x)(i,{"e-mappinguid":"e-flmenu-"+s.uid}),t.classList.add("e-fltr-icon");var u=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==u.length)for(var d=0;d<this.parent.columns.length;d++)for(var p=0;p<this.parent.filterSettings.columns.length;p++)if(this.parent.filterSettings.columns[p].field===s.field){i.classList.add("e-filtered"),u.push(s.field);break}t.appendChild(i.cloneNode())}e.className&&t.classList.add(e.className),s.customAttributes&&Bt(t,s.customAttributes),s.allowSorting&&(a.sort="none"),s.allowGrouping&&(a.grabbed=!1),t=this.extendPrepareHeader(s,t);var g=this.parent,f=g.getColumnIndexByField(s.field);if(!Object(m.X)(s.headerTemplate)){var v=g.element.id+s.uid+"headerTemplate",b="isStringTemplate",C=Object(m.W)()?s.toJSON():s;if(this.parent.isReact&&"string"!=typeof s.headerTemplate){var w={index:f};t.firstElementChild.innerHTML="",s.getHeaderTemplate()(Object(m.K)(w,C),g,"headerTemplate",v,this.parent[b],null,t.firstElementChild),this.parent.renderTemplates()}else r=s.getHeaderTemplate()(Object(m.K)({index:f},C),g,"headerTemplate",v,this.parent[b]),t.firstElementChild.innerHTML="",Jt(t.firstElementChild,r)}if(this.ariaService.setOptions(t,a),!Object(m.X)(s.headerTextAlign)||!Object(m.X)(s.textAlign)){var k=s.headerTextAlign||s.textAlign;l.style.textAlign=k,"Right"===k||"Left"===k?t.classList.add("Right"===k?"e-rightalign":"e-leftalign"):"Center"===k&&t.classList.add("e-centeralign")}return"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?t.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==s.type&&t.classList.add("e-ellipsistooltip"),t.setAttribute("aria-rowspan",(Object(m.X)(e.rowSpan)?1:e.rowSpan).toString()),t.setAttribute("aria-colspan","1"),this.parent.trigger("headerCellInfo",{cell:e,node:t}),t}},{key:"getValue",value:function(e,t){return t.headerValueAccessor(e,t)}},{key:"extendPrepareHeader",value:function(e,t){if(this.parent.showColumnMenu&&e.showColumnMenu&&!Object(m.X)(e.field)){var i=this.parent.createElement("div",{className:"e-icons e-columnmenu"}),n=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==n.length)for(var r=0;r<this.parent.columns.length;r++)for(var s=0;s<this.parent.filterSettings.columns.length;s++)if(this.parent.filterSettings.columns[s].field===e.field){i.classList.add("e-filtered"),n.push(e.field);break}t.classList.add("e-fltr-icon"),t.appendChild(i)}if(this.parent.allowResizing){var a=this.parent.createElement("div");a.className=e.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",t.appendChild(a)}return t}},{key:"appendHtml",value:function(e,t){return e.appendChild(t),e}}]),i}(ae),Ee=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{role:"columnheader",tabindex:"-1"}}),e}return f(i,[{key:"render",value:function(e,t,i){var n=this.element.cloneNode(),r=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":e.column.uid}}),s=e.column;if(n.appendChild(r),Object(m.X)(s.headerTemplate)?this.appendHtml(r,s.headerText,s.getDomSetter()):Jt(r,s.getHeaderTemplate()(s,this.parent,"headerTemplate")),e.column.toolTip&&n.setAttribute("title",e.column.toolTip),"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?n.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&n.classList.add("e-ellipsistooltip"),Object(m.X)(e.column.textAlign)||(r.style.textAlign=e.column.textAlign),e.column.customAttributes&&Bt(n,e.column.customAttributes),n.setAttribute("colspan",e.colSpan.toString()),n.setAttribute("aria-colspan",e.colSpan.toString()),n.setAttribute("aria-rowspan","1"),this.parent.allowResizing){var a=this.parent.createElement("div");a.className=e.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",n.appendChild(a)}return this.parent.trigger("headerCellInfo",{cell:e,node:n}),n}}]),i}(ae),Ie=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-indentcell"}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return Bt(i,e.attributes),i}}]),i}(ae),Me=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:e.parent.element.id+"captioncell",role:"gridcell",tabindex:"-1"}}),e}return f(i,[{key:"render",value:function(e,t){var i,n,r=this.element.cloneNode(),s=this.parent;t.headerText=e.column.headerText,e.isForeignKey&&(n=this.format(e.column,e.column.valueAccessor("foreignKey",t,e.column)));var a=e.isForeignKey?n:e.column.enableGroupByFormat?t.key:this.format(e.column,e.column.valueAccessor("key",t,e.column));if(Object(m.X)(s.groupSettings.captionTemplate))r.innerHTML=s.groupSettings.enableLazyLoading?e.column.headerText+": "+a:e.column.headerText+": "+a+" - "+t.count+" "+this.localizer.getConstant(t.count<2?"Item":"Items");else{var l=this.parent.isReact&&"string"!=typeof s.groupSettings.captionTemplate;if(Object(m.W)()){var o=s.element.id+"captionTemplate";i=Lt(s.groupSettings.captionTemplate)(t,null,null,o)}else if(l){var h=s.element.id+"captionTemplate";Lt(s.groupSettings.captionTemplate)(t,this.parent,"captionTemplate",h,null,null,r),this.parent.renderTemplates()}else i=this.parent.isVue?Lt(s.groupSettings.captionTemplate)(t,this.parent):Lt(s.groupSettings.captionTemplate)(t);l||Jt(r,i)}return r.setAttribute("colspan",e.colSpan.toString()),r.setAttribute("aria-label",r.innerHTML+" is groupcaption cell"),r.setAttribute("title",r.innerHTML),r}}]),i}(ae),Fe=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-groupcaption"}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return i.innerHTML="&nbsp;",i.setAttribute("colspan",e.colSpan.toString()),i}}]),i}(ae),Te=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"render",value:function(e,t,i,n){var r=this.element.cloneNode();return r.className=n?"e-recordplusexpand":"e-recordpluscollapse",r.setAttribute("ej-mappingname",t.field),r.setAttribute("ej-mappingvalue",t.key),r.setAttribute("aria-expanded",n?"true":"false"),r.setAttribute("tabindex","-1"),r.appendChild(this.parent.createElement("div",{className:n?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"})),r}}]),i}(Ie),Ae=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-grouptopleftcell"}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),i}}]),i}(ae),ze=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-detailheadercell"}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),i}}]),i}(ae),Le=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",role:"gridcell",tabindex:"-1"}}),e}return f(i,[{key:"render",value:function(e,t,i){var n=this.element.cloneNode();return i&&!Object(m.X)(i.class)?(n.className="",n.className=i.class,n.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow"}))):n.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonalright e-icon-grightarrow"})),n}}]),i}(ae),Be=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-rowdragdrop",attrs:{role:"gridcell",tabindex:"-1"}}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon"})),e.isSelected&&(i.classList.add("e-selectionbackground"),i.classList.add("e-active")),i}}]),i}(ae),Pe=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-rowdragheader"}),e}return f(i,[{key:"render",value:function(e,t){var i=this.element.cloneNode();return i.appendChild(Object(m.F)("div",{className:"e-emptycell"})),i}}]),i}(ae),qe=function(){function e(t,i){p(this,e),this.emptyGrid=!1,this.counter=0,this.parent=t,this.locator=i,this.data=new Y(t,i),this.l10n=i.getService("localization"),this.ariaService=this.locator.getService("ariaService"),this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return f(e,[{key:"render",value:function(){var e=this.parent;this.headerRenderer=this.renderer.getRenderer(U.Header),this.contentRenderer=this.renderer.getRenderer(U.Content),this.headerRenderer.renderPanel(),this.contentRenderer.renderPanel(),e.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1)),this.parent.scrollModule.setWidth(),this.parent.scrollModule.setHeight(),"auto"!==this.parent.height&&this.parent.scrollModule.setPadding(),Object(m.W)()&&this.parent.isServerRendered||this.refreshDataManager()}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requestType:"refresh"},i=this.parent;if(i.notify(t.requestType+"-begin",t),Object(m.W)()&&this.resetTemplates(),Object(m.W)()&&i.isServerRendered){var n="bulkChanges";i[n].dataSource&&delete i[n].dataSource,i.notify("blazor-action-begin",t),"filtering"===t.requestType&&(t.columns=null),"sorting"===t.requestType&&(t.target=null),"Batch"!==i.editSettings.mode||i.isEdit||i.notify("closebatch",{})}var r=this.parent.preventUpdate;i.trigger(D,t,(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requestType:"refresh"};if("delete"===n.requestType&&Object(m.W)()&&!i.isJsComponent){var s="data";if(Object(m.X)(i.commandDelIndex))n[s]=i.getSelectedRecords();else{var a=n[s];n[s]={},n[s][0]=a}}if(n.cancel)i.notify("cancel-Begin",n);else{if(Object(m.W)()&&"Normal"===i.editSettings.mode&&i.isEdit&&"infiniteScroll"!==t.requestType&&i.notify("closeinline",{}),"delete"===n.requestType&&i.allowPaging){var l=n.data.length,o=i.pageSettings.totalRecordsCount-l,h=i.getCurrentViewRecords().length;h-l||!o||h===l||(i.prevPageMoving=!0,i.setProperties({pageSettings:{totalRecordsCount:o,currentPage:Math.ceil(o/i.pageSettings.pageSize)}},!0),i.pagerModule.pagerObj.totalRecordsCount=o)}if(Object(m.W)()&&e.parent.isServerRendered){if(r)return void(i.bulkChanges={});"refresh"===t.requestType&&e.parent.notify("updateaction",n),"virtualscroll"!==n.requestType&&e.parent.showSpinner(),"delete"===n.requestType||"save"===n.requestType?(e.parent.notify("add-delete-Action",n),e.parent.notify("add-delete-success",n)):(e.parent.allowServerDataBinding=!0,e.parent.serverDataBind(),e.parent.allowServerDataBinding=!1)}else"reorder"===n.requestType&&e.parent.dataSource&&"result"in e.parent.dataSource||("paging"===n.requestType||"columnstate"===n.requestType||"reorder"===n.requestType)&&e.parent.groupSettings.enableLazyLoading&&e.parent.groupSettings.columns.length&&e.parent.contentModule.getGroupCache()[e.parent.pageSettings.currentPage]?e.contentRenderer.refreshContentRows(n):e.refreshDataManager(n)}}))}},{key:"resetTemplates",value:function(){var e=this.parent,t=e.getColumns();if(e.detailTemplate){var i=e.element.id+"detailTemplate";m.z[i]=[],Object(m.jb)(i,"DetailTemplate")}e.groupSettings.captionTemplate&&Object(m.jb)(e.element.id+"captionTemplate","CaptionTemplate"),e.rowTemplate&&Object(m.jb)(e.element.id+"rowTemplate","RowTemplate"),e.toolbarTemplate&&Object(m.jb)(e.element.id+"toolbarTemplate","ToolbarTemplate"),e.pageSettings.template&&Object(m.jb)(e.element.id+"_template","pageSettings");for(var n=0;n<t.length;n++)t[n].template&&(m.z[e.element.id+t[n].uid]=[],Object(m.jb)(e.element.id+t[n].uid,"Template")),t[n].headerTemplate&&Object(m.jb)(e.element.id+t[n].uid+"headerTemplate","HeaderTemplate"),t[n].filterTemplate&&Object(m.jb)(e.element.id+t[n].uid+"filterTemplate","FilterTemplate");for(var r=0;r<e.aggregates.length;r++)for(var s=0;s<e.aggregates[r].columns.length;s++){if(e.aggregates[r].columns[s].footerTemplate){var a=e.element.id+e.aggregates[r].columns[s].guid+"footerTemplate";Object(m.jb)(a,"FooterTemplate")}if(e.aggregates[r].columns[s].groupFooterTemplate){var l=e.element.id+e.aggregates[r].columns[s].guid+"groupFooterTemplate";Object(m.jb)(l,"GroupFooterTemplate")}if(e.aggregates[r].columns[s].groupCaptionTemplate){var o=e.element.id+e.aggregates[r].columns[s].guid+"groupCaptionTemplate";Object(m.jb)(o,"GroupCaptionTemplate")}}}},{key:"refreshComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(E,e)}},{key:"refreshDataManager",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"virtualscroll"!==i.requestType&&this.parent.showSpinner(),this.parent.notify("reset-infinite-blocks",i),this.emptyGrid=!1;var n=this.isNeedForeignAction();if(this.ariaService.setBusy(this.parent.getContent().querySelector(".e-content"),!0),n){var r=new v.c;e=this.getFData(r,i)}if(e=e?e.then((function(e){var n=t.data.generateQuery().requiresCount();if(t.emptyGrid){var r=new v.c;return r.resolve({result:[],count:0}),r.promise}return t.data.getData(i,n)})):this.data.getData(i,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!n||this.parent.searchSettings.key.length)){var s=new v.c;e=e.then((function(n){return t.parent.notify("getForeignKeyData",{dataManager:e,result:n,promise:s,action:i}),s.promise}))}this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(e=e.then((function(e){return t.validateGroupRecords(e)}))),e.then((function(e){return t.dataManagerSuccess(e,i)})).catch((function(e){return t.dataManagerFailure(e,i)}))}},{key:"getFData",value:function(e,t){return this.parent.notify("getForeignKeyData",{isComplex:!0,promise:e,action:t}),e.promise}},{key:"isNeedForeignAction",value:function(){var e=this.parent;return!!(e.allowFiltering&&e.filterSettings.columns.length||e.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())}},{key:"foreignKey",value:function(e){var t=this;return e.some((function(e){return!(!t.parent.filterSettings.columns.some((function(t){return e.uid===t.uid}))&&!t.parent.searchSettings.key.length)}))}},{key:"sendBulkRequest",value:function(e){var t=this;e.requestType="batchsave";var i=this.data.saveChanges(e.changes,this.parent.getPrimaryKeyFieldNames()[0],e.original);if(Object(m.W)()&&!this.parent.isJsComponent)i.then((function(i){t.parent.notify("editsuccess",e)})).catch((function(e){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message),t.parent.trigger("actionFailure",e)}));else{var n=this.data.generateQuery().requiresCount();if(this.data.dataManager.dataSource.offline)return void this.refreshDataManager({requestType:"batchsave"});i.then((function(i){t.data.getData(e,n).then((function(i){return t.dmSuccess(i,e)})).catch((function(i){return t.dmFailure(i,e)}))})).catch((function(i){return t.dmFailure(i,e)}))}}},{key:"dmSuccess",value:function(e,t){this.dataManagerSuccess(e,t)}},{key:"dmFailure",value:function(e,t){this.dataManagerFailure(e,t)}},{key:"renderEmptyRow",value:function(){this.emptyRow(!0)}},{key:"emptyRow",value:function(e){var t,i=this.parent,n=this.contentRenderer.getTable().querySelector("tbody");Object(m.X)(n)||Object(m.hb)(n),n=this.parent.createElement("tbody");var r=0;(i.detailTemplate||i.childGrid)&&++r,(t=this.parent.createElement("tr",{className:"e-emptyrow"})).appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(i.getColumns().length+r).toString()}})),n.appendChild(t),this.contentRenderer.renderEmpty(n),e&&(this.parent.trigger(I,{}),this.parent.notify(L,{rows:[new _({isDataRow:!0,cells:[new Q({isDataCell:!0,visible:!0})]})]}))}},{key:"dynamicColumnChange",value:function(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])}},{key:"updateColumnType",value:function(e){for(var t,i=this.parent.getColumns(),n=e&&e.items?e.items[0]:e,r=this.locator.getService("valueFormatter"),s=0,a=i.length;s<a;s++){t=Oi(i[s].field||"",n),Object(m.X)(i[s].customFormat)||(i[s].format=i[s].customFormat),Object(m.X)(i[s].validationRules)||Object(m.X)(i[s].validationRules.equalTo)||(i[s].validationRules.equalTo[0]=this.parent.element.id+i[s].validationRules.equalTo[0]),i[s].isForeignColumn()&&i[s].columnData&&(t=Oi(i[s].foreignKeyValue||"",i[s].columnData[0])),Object(m.X)(t)?i[s].type=i[s].type||(Object(m.W)()&&this.parent.isServerRendered?"none":null):(this.isColTypeDef=!0,(!i[s].type||Object(m.W)()&&this.parent.isServerRendered&&"none"===i[s].type)&&(i[s].type=t.getDay?t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0?"datetime":"date":typeof t));var l=new j;if(i[s].format&&(i[s].format.skeleton||i[s].format.format)&&(i[s].setFormatter(l.getFormatFunction(Object(m.K)({},i[s].format))),i[s].setParser(l.getParserFunction(i[s].format))),"string"==typeof i[s].format){var o=this.parent.isServerRendered||this.parent.printModule.isPrintGrid();ci(this.locator,i[s],o)}else i[s].format||"number"!==i[s].type||i[s].setParser(r.getParserFunction({format:"n2"}))}}},{key:"dataManagerSuccess",value:function(e,t){var i=this,n=this.parent;this.contentRenderer=this.renderer.getRenderer(U.Content),this.headerRenderer=this.renderer.getRenderer(U.Header),e.actionArgs=t;var r=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&("delete"===t.requestType||"save"===t.requestType&&"add"===this.parent.infiniteScrollModule.requestType);n.trigger("beforeDataBound",e,(function(s){if(!s.cancel){s.result=Object(m.X)(s.result)?[]:s.result;var a=Object.keys(s.result).length;if(!i.parent.isDestroyed)if(n.getColumns().length||a||n.columns.length&&n.columns[0]instanceof R)if(!i.isInfiniteEnd(t)||a){if(i.parent.isEdit=!1,i.parent.notify("edit-reset",{}),i.parent.notify("tooltip-destroy",{}),i.contentRenderer.prevCurrentView=i.parent.currentViewData.slice(),n.currentViewData=s.result,n.notify("refresh-infinite-current-view-data",{args:t,data:s.result}),Object(m.W)()&&"FilterBar"===n.filterSettings.type&&(Object(m.X)(n.currentViewData)||!Object(m.X)(n.currentViewData)&&!n.currentViewData.length))for(var l=n.getColumns(),o=0;o<l.length;o++)if(l[o].filterTemplate){var h=n.element.id+l[o].uid+"filterTemplate";Object(m.jb)(h,"FilterTemplate");for(var c=l[o].field,u=n.filterSettings.columns,d=0;d<u.length;d++)c===u[d].field&&(m.z[h][0][c]=u[d].value);Object(m.sb)(h,"FilterTemplate",l[o],!1)}if(!a&&s.count&&n.allowPaging&&t&&"delete"!==t.requestType)return!i.parent.groupSettings.enableLazyLoading||"grouping"!==t.requestType&&"ungrouping"!==t.requestType||i.parent.notify("grouping-complete",t),n.prevPageMoving=!0,n.pageSettings.totalRecordsCount=s.count,"paging"!==t.requestType&&(n.pageSettings.currentPage=Math.ceil(s.count/n.pageSettings.pageSize)),void n.dataBind();if((n.getColumns().length||!a)&&i.isLayoutRendered||Si(n)||i.updatesOnInitialRender(s),!i.isColTypeDef&&n.getCurrentViewRecords()&&i.updateColumnType(i.data.dataManager.dataSource.offline&&n.dataSource.length?n.dataSource[0]:n.getCurrentViewRecords()[0]),i.parent.isInitialLoad||!i.parent.groupSettings.disablePageWiseAggregates||i.parent.groupSettings.columns.length||(s.result=i.parent.dataSource instanceof Array?i.parent.dataSource:i.parent.currentViewData),i.parent.notify(T,Object(m.K)({count:s.count,result:s.result,aggregates:s.aggregates},t)),(n.groupSettings.columns.length||t&&"ungrouping"===t.requestType)&&t&&"filtering"!==t.requestType&&i.headerRenderer.refreshUI(),a)Si(n)&&(t.scrollTop={top:i.contentRenderer.content.scrollTop}),r?i.parent.notify("infinite-edit-handler",{e:t,result:e.result,count:e.count,agg:e.aggregates}):i.parent.enableImmutableMode?i.contentRenderer.immutableModeRendering(t):i.contentRenderer.refreshContentRows(t);else{if(!n.getColumns().length)return n.element.innerHTML="",void alert(i.l10n.getConstant("EmptyDataSourceError"));if(i.contentRenderer.setRowElements([]),i.contentRenderer.setRowObjects([]),i.ariaService.setBusy(i.parent.getContent().querySelector(".e-content"),!1),i.renderEmptyRow(),t){var p=(t.requestType||"").toLowerCase()+"-complete";i.parent.notify(p,t),"batchsave"===t.requestType&&(t.cancel=!1,t.rows=[],t.isFrozen=0!==i.parent.getFrozenColumns()&&!t.isFrozen,i.parent.trigger(E,t))}i.parent.hideSpinner()}i.parent.notify(W,{}),i.setRowCount(i.parent.getCurrentViewRecords().length),i.parent.getDataModule().isQueryInvokedFromData=!1}else i.parent.notify("infinite-edit-handler",{e:t,result:e.result,count:e.count,agg:e.aggregates});else n.hideSpinner()}}))}},{key:"dataManagerFailure",value:function(e,t){this.ariaService.setOptions(this.parent.getContent().querySelector(".e-content"),{busy:!1,invalid:!0}),this.setRowCount(1),this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.log("actionfailure",{error:e}))}},{key:"setRowCount",value:function(e){this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:e?e.toString():"1"})}},{key:"isInfiniteEnd",value:function(e){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===e.requestType}},{key:"updatesOnInitialRender",value:function(e){this.isLayoutRendered=!0,this.parent.columns.length<1&&this.buildColumns(e.result[0]),Vt(this.parent.columns,null,this.parent),this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.parent.isAutoGen=!0,this.parent.notify(X,{})}},{key:"iterateComplexColumns",value:function(e,t,i){for(var n=Object.keys(e),r=0;r<n.length;r++)("object"!=typeof e[n[r]]||!e[n[r]]||e[n[r]]instanceof Date?[]:Object.keys(e[n[r]])).length?this.iterateComplexColumns(e[n[r]],t+(n[r]+"."),i):(i[this.counter]=t+n[r],this.counter++)}},{key:"buildColumns",value:function(e){var t=[],i={};this.iterateComplexColumns(e,"",i);for(var n=Object.keys(i).filter((function(e){return"BlazId"!==i[e]})).map((function(e){return i[e]})),r=0,s=n.length;r<s;r++)t[r]={field:n[r]},this.parent.enableColumnVirtualization&&(t[r].width=Object(m.X)(t[r].width)?200:t[r].width);this.parent.setProperties({columns:t},!0)}},{key:"instantiateRenderer",value:function(){this.renderer.addRenderer(U.Header,new se(this.parent,this.locator)),this.renderer.addRenderer(U.Content,new re(this.parent,this.locator));var e=this.locator.getService("cellRendererFactory");e.addCellRenderer(K.Header,new De(this.parent,this.locator)),e.addCellRenderer(K.Data,new ae(this.parent,this.locator)),e.addCellRenderer(K.StackedHeader,new Ee(this.parent,this.locator)),e.addCellRenderer(K.Indent,new Ie(this.parent,this.locator)),e.addCellRenderer(K.GroupCaption,new Me(this.parent,this.locator)),e.addCellRenderer(K.GroupCaptionEmpty,new Fe(this.parent,this.locator)),e.addCellRenderer(K.Expand,new Te(this.parent,this.locator)),e.addCellRenderer(K.HeaderIndent,new Ae(this.parent,this.locator)),e.addCellRenderer(K.StackedHeader,new Ee(this.parent,this.locator)),e.addCellRenderer(K.DetailHeader,new ze(this.parent,this.locator)),e.addCellRenderer(K.RowDragHIcon,new Pe(this.parent,this.locator)),e.addCellRenderer(K.DetailExpand,new Le(this.parent,this.locator)),e.addCellRenderer(K.DetailFooterIntent,new Ie(this.parent,this.locator)),e.addCellRenderer(K.RowDragIcon,new Be(this.parent,this.locator))}},{key:"addEventListener",value:function(){var e=this;this.parent.isDestroyed||(this.parent.on(M,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(P,this.refresh,this),this.parent.on("refresh-complete",this.refreshComplete,this),this.parent.on("bulk-save",this.sendBulkRequest,this),this.parent.on("showEmptyGrid",(function(){e.emptyGrid=!0}),this),this.parent.on(X,this.dynamicColumnChange,this))}},{key:"validateGroupRecords",value:function(e){var t=this,i=e.result.length-1;if(i<0)return Promise.resolve(e);var n=e.result[0],r=e.result[i],s=[],a=function(e){for(var i=[n,r],a=0;a<i.length;a++)s.push(new v.f("field","==",i[a].field).and(t.getPredicate("key","equal",i[a].key)));e.where(v.f.or(s))},l=new v.g;a(l);var o=new v.a(e.result).executeLocal(l),h=this.data.generateQuery(!0),c=[];if(this.data.isRemote()||Object(m.W)()){for(var u=[n,r],d=0;d<u.length;d++)c.push(this.getPredicate(u[d].field,"equal",u[d].key));h.where(v.f.or(c))}else a(h);var p=new v.c;return this.data.getData({},h).then((function(i){t.updateGroupInfo(o,i.result),p.resolve(e)})).catch((function(e){return p.reject(e)})),p.promise}},{key:"getPredicate",value:function(e,t,i){return i instanceof Date?wi({field:e,operator:t,value:i}):new v.f(e,t,i)}},{key:"updateGroupInfo",value:function(e,t){for(var i=new v.a(t),n=e,r=0;r<n.length;r++){var s=i.executeLocal((new v.g).where(new v.f("field","==",n[r].field).and(this.getPredicate("key","equal",n[r].key))))[0];n[r].count=s.count;var a=n[r].items,l=s.items;a.GroupGuid&&(n[r].items=this.updateGroupInfo(n[r].items,s.items));for(var o=this.parent.aggregates,h=0;h<o.length;h++)for(var c=o[h],u=0;u<c.columns.length;u++)for(var d=c.columns[u].type instanceof Array?c.columns[u].type:[c.columns[u].type],p=0;p<d.length;p++){var g=c.columns[u].field+" - "+d[p].toLowerCase(),f=a.level?l.records:s.items,m=this.parent;if("Custom"===d[p]){var b=a.level?l:s;n[r].aggregates[g]=c.columns[u].customAggregate?c.columns[u].customAggregate.call(m,b,c.columns[u]):""}else n[r].aggregates[g]=v.b.aggregates[d[p].toLowerCase()](f,c.columns[u].field)}}return e}}]),e}(),Ve=function(){function e(){p(this,e),this.cellRenderMap={}}return f(e,[{key:"addCellRenderer",value:function(e,t){e="string"==typeof e?e:Object(m.P)(K,e),Object(m.X)(this.cellRenderMap[e])&&(this.cellRenderMap[e]=t)}},{key:"getCellRenderer",value:function(e){if(e="string"==typeof e?e:Object(m.P)(K,e),Object(m.X)(this.cellRenderMap[e]))throw"The cellRenderer ".concat(e," is not found");return this.cellRenderMap[e]}}]),e}(),He=function(){function e(){p(this,e),this.services={}}return f(e,[{key:"register",value:function(e,t){Object(m.X)(this.services[e])&&(this.services[e]=t)}},{key:"getService",value:function(e){if(Object(m.X)(this.services[e]))throw"The service ".concat(e," is not registered");return this.services[e]}}]),e}(),Ne=function(){function e(){p(this,e),this.rendererMap={}}return f(e,[{key:"addRenderer",value:function(e,t){var i=Object(m.P)(U,e);Object(m.X)(this.rendererMap[i])&&(this.rendererMap[i]=t)}},{key:"getRenderer",value:function(e){var t=Object(m.P)(U,e);if(Object(m.X)(this.rendererMap[t]))throw"The renderer ".concat(t," is not found");return this.rendererMap[t]}}]),e}(),We=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"setWidthToColumns",value:function(){var e,t=0,i=this.parent.getColumnIndexesInView(),n=!0;if(this.parent.allowGrouping)for(var r=this.parent.groupSettings.columns.length;t<r;t++)this.parent.enableColumnVirtualization&&-1===i.indexOf(t)?n=!1:this.setColumnWidth(new R({width:"30px"}),t);(this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new R({width:"30px"}),t),t++),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(this.setColumnWidth(new R({width:"30px"}),t),t++);for(var s=this.parent.getColumns(),a=0;a<s.length;a++)this.setColumnWidth(s[a],n&&this.parent.enableColumnVirtualization?void 0:a+t);this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&this.setColumnWidth(new R({width:"30px"}),s.length),e=this.getTableWidth(this.parent.getColumns()),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(e)}},{key:"setMinwidthBycalculation",value:function(e){var t=0,i=this.parent.getColumns().filter((function(e){return Object(m.X)(e.width)||"auto"===e.width}));if(i.length){t=Object(m.X)(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-e:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-e;var n,r=0,s=c(i);try{for(s.s();!(n=s.n()).done;){var a=n.value;r+=Object(m.X)(a.minWidth)?0:"string"==typeof a.minWidth?parseInt(a.minWidth,10):a.minWidth}}catch(o){s.e(o)}finally{s.f()}for(var l=0;l<i.length;l++)0===e&&this.parent.allowResizing&&this.isWidthUndefined()&&l!==i.length-1&&this.setUndefinedColumnWidth(i),0!==e&&t<r?this.setWidth(i[l].minWidth,this.parent.getColumnIndexByField(i[l].field)):0!==e&&t>r&&this.setWidth("",this.parent.getColumnIndexByField(i[l].field)+this.parent.getIndentCount(),!0)}}},{key:"setUndefinedColumnWidth",value:function(e){for(var t=0;t<e.length;t++)t!==e.length-1&&(e[t].width=200,this.setWidth(200,this.parent.getColumnIndexByField(e[t].field)))}},{key:"setColumnWidth",value:function(e,t,i){if(!(this.parent.getColumns().length<1)){var n=Object(m.X)(t)?this.parent.getNormalizedColumnIndex(e.uid):t,r=this.getWidth(e),s=this.getTableWidth(this.parent.getColumns());null!==r&&(this.setWidth(r,n),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(s),(this.parent.allowResizing&&"resize"===i||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify("column-width-changed",{index:n,width:r,column:e,module:i}))}}},{key:"setWidth",value:function(e,t,i){this.parent.groupSettings.columns.length>t&&Bi(this.parent)&&(e=(30/this.parent.element.offsetWidth*100).toFixed(1)+"%");var n,r=this.parent.getHeaderTable(),s=this.parent.getContentTable(),a=Object(m.L)(e),l=this.parent.getFrozenColumns(),o=this.parent.isRowDragable();l=l&&o?l+1:l;var h,c=this.parent.getHeaderContent().querySelector(".e-movableheader"),u=this.parent.getContent().querySelector(".e-movablecontent"),d=this.parent.getFrozenLeftColumnsCount(),p=this.parent.getFrozenRightColumnsCount(),g=this.parent.getMovableColumnsCount(),f=0!==d||0!==p;if(l&&t>=l&&c&&c.querySelector("colgroup"))n=c.querySelector("colgroup").children[t-l];else if(this.parent.enableColumnVirtualization&&l&&this.parent.contentModule.isXaxis()&&c.scrollLeft>0){var v=c.querySelector("colgroup");n=v.children[v.children.length-1-t]}else if(f){var b;if(d&&!p)b=(t=o?t-1:t)<d?r:c;else if(!d&&p)b=t>=g?r:c;else if(d&&p){t=o?t-1:t;var y=this.parent.getFrozenRightHeader();b=t<d?r:t<d+g?c:y}if(!(n=this.getColumnLevelFrozenColgroup(t,d,g,b)))return}else n=r.querySelector("colgroup").children[t];if(n&&!i?n.style.width=a:n&&i&&(n.style.width=""),l&&t>=l)h=this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup").children[t-l];else if(this.parent.enableColumnVirtualization&&l&&this.parent.contentModule.isXaxis()&&u.scrollLeft>0){var C=this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup");h=C.children[C.children.length-1-t]}else if(f){var w;if(d&&!p&&(w=t<d?s:u),!d&&p&&(w=t>=g?s:u),d&&p){var k=this.parent.getContent().querySelector(".e-frozen-right-content");w=t<d?s:t<d+g?u:k}h=this.getColumnLevelFrozenColgroup(t,d,g,w)}else h=s.querySelector("colgroup").children[t];h&&!i?h.style.width=a:h&&i&&(h.style.width="");for(var S=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),O=[],x=0;x<S.length;x++)if(Wt(S[x],"e-grid").id===this.parent.element.id)for(var j=0;j<S[x].querySelector("colgroup").children.length;j++)O.push(S[x].querySelector("colgroup").children[j]);S.length&&O.length&&(O[t].style.width=a),this.parent.isFrozenGrid()&&this.refreshFrozenScrollbar()}},{key:"getColumnLevelFrozenColgroup",value:function(e,t,i,n){if(!n||!n.querySelector("colgroup"))return null;var r=this.parent.getColumns(),s=this.parent.isRowDragable(),a=this.parent.getFrozenMode(),l=[].slice.call(n.querySelector("colgroup").children);return"Right"===a&&s&&e===i+this.parent.getFrozenRightColumnsCount()?l[l.length-1]:s&&-1===e?l[0]:"Left"===r[e].freeze?l[s?e+1:e]:"Right"===r[e].freeze?l[e-(t+i)]:l[e-t]}},{key:"refreshFrozenScrollbar",value:function(){var e={cancel:!1};if(this.parent.notify("prevent-frozen-scroll-refresh",e),!e.cancel){var t=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("table"),i=this.parent.getContent().querySelector(".e-movablecontent").querySelector("table"),n=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");if(i&&t){var r=this.parent.getContent().querySelector(".e-frozenscrollbar"),s=this.parent.getContent().querySelector(".e-movablescrollbar"),a=this.parent.getContent().querySelector(".e-frozen-right-scrollbar"),l=this.parent.getContent().querySelector(".e-movablechild"),o=this.parent.getContent(),h=ni(),c=t.offsetWidth,u=i.offsetWidth;if(this.parent.enableColumnVirtualization){var d=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack");d&&(u=d.scrollWidth)}r.style.width=c.toString()+"px";var p=this.parent.getContent().querySelector(".e-movablecontent").offsetWidth;if(n){var g=n.offsetWidth;o.firstChild.scrollHeight>o.firstChild.clientHeight&&(g=n.offsetWidth+h),a.style.width=g.toString()+"px",p-=g}"auto"!==this.parent.height&&("Left"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())&&o.firstChild.scrollHeight>=o.firstChild.clientHeight&&(u+=h),s.style.width=p.toString()+"px",l.style.width=u.toString()+"px"}}}},{key:"getSiblingsHeight",value:function(e){return this.getHeightFromDirection(e,"previous")+this.getHeightFromDirection(e,"next")}},{key:"getHeightFromDirection",value:function(e,t){for(var i=e[t+"ElementSibling"],n=0,r=["e-gridheader","e-gridfooter","e-groupdroparea","e-gridpager","e-toolbar"];i;)r.some((function(e){return i.classList.contains(e)}))&&(n+=i.offsetHeight),i=i[t+"ElementSibling"];return n}},{key:"isWidthUndefined",value:function(){var e=this.parent.getColumns().filter((function(e){return Object(m.X)(e.width)&&Object(m.X)(e.minWidth)})).length;return this.parent.getColumns().length===e}},{key:"getWidth",value:function(e){if(Object(m.X)(e.width)&&this.parent.allowResizing&&Object(m.X)(e.minWidth)&&!this.isWidthUndefined()&&(e.width=200),this.parent.isFrozenGrid()&&Object(m.X)(e.width)&&("frozen-left"===e.getFreezeTableName()||"frozen-right"===e.getFreezeTableName())&&(e.width=200),!e.width)return null;var t=parseInt(e.width.toString(),10);return e.minWidth&&t<parseInt(e.minWidth.toString(),10)?e.minWidth:e.maxWidth&&t>parseInt(e.maxWidth.toString(),10)?e.maxWidth:e.width}},{key:"getTableWidth",value:function(e){var t,i=0,n=c(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,s=this.getWidth(r);"auto"===r.width&&(s=0),!1!==r.visible&&null!==s&&(i+=parseInt(s.toString(),10))}}catch(a){n.e(a)}finally{n.f()}return i}},{key:"calcMovableOrFreezeColWidth",value:function(e){var t=this.parent.getColumns().slice(),i=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),n=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenRightColumnsCount();return"movable"===e?(r&&t.splice(i+n,t.length),i&&t.splice(0,i)):"freeze-left"===e?t.splice(i,t.length):"freeze-right"===e&&t.splice(0,i+n),Object(m.L)(this.getTableWidth(t))}},{key:"setWidthToFrozenRightTable",value:function(){var e=this.calcMovableOrFreezeColWidth("freeze-right");e=this.isAutoResize()?"100%":e;var t=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(".e-table"),i=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table");t.style.width=e,i.style.width=e}},{key:"setWidthToFrozenLeftTable",value:function(){var e=this.calcMovableOrFreezeColWidth("freeze-left");e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e}},{key:"setWidthToMovableTable",value:function(){var e="",t=this.parent.getColumns().filter((function(e){return Object(m.X)(e.width)})).length>=1,i=this.parent.getColumns().filter((function(e){return"auto"===e.width})).length>=1;"number"!=typeof this.parent.width||t||i?t||i||(e=this.calcMovableOrFreezeColWidth("movable")):e=Object(m.L)(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5),e=this.isAutoResize()?"100%":e,this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild&&(this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild.style.width=e),this.parent.getContent().querySelector(".e-movablecontent").firstElementChild.style.width=e}},{key:"setWidthToFrozenEditTable",value:function(){var e=this.calcMovableOrFreezeColWidth("freeze");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=e}},{key:"setWidthToMovableEditTable",value:function(){var e=this.calcMovableOrFreezeColWidth("movable");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=e}},{key:"setWidthToTable",value:function(){var e=Object(m.L)(this.getTableWidth(this.parent.getColumns()));this.parent.isFrozenGrid()?((this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&this.setWidthToFrozenLeftTable(),this.setWidthToMovableTable(),this.parent.getFrozenRightColumnsCount()&&this.setWidthToFrozenRightTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new R({width:"30px"})),e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e);var t=this.parent.element.querySelector(".e-table.e-inline-edit");t&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):t&&(t.style.width=e)}},{key:"isAutoResize",value:function(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode}}]),e}(),Xe=function(){function t(e){p(this,t),this.currentInfo={},this.oneTime=!0,this.swap={},this.forget=!1,this.skipFocus=!0,this.focusByClick=!1,this.prevIndexes={},this.refMatrix=this.refreshMatrix(!0),this.actions=["downArrow","upArrow"],this.parent=e,this.rowModelGen=new $(this.parent),this.addEventListener()}return f(t,[{key:"focusCheck",value:function(e){var t=e.target;this.focusByClick=!0,this.skipFocus=t.classList.contains("e-grid")}},{key:"onFocus",value:function(){if(!(this.parent.isDestroyed||m.d.isDevice||this.parent.enableVirtualization)){this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,this.parent.isFrozenGrid()),this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||this.parent.editModule.getBatchChanges().addedRecords.length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new _({isDataRow:!0})]}),this.getContent().selector,!1);var e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.skipFocus&&(this.focus(),this.skipFocus=!1)}}},{key:"passiveFocus",value:function(e){this.parent.isDestroyed||e.target&&e.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,Object(m.v)([this.currentInfo.element],["e-focused","e-focus"]))}},{key:"onBlur",value:function(e){this.parent.isEdit||e&&(!e.relatedTarget||Object(m.C)(e.relatedTarget,".e-grid"))||(this.removeFocus(),this.skipFocus=!1,this.currentInfo.skipAction=!1,this.getContent().getFocusInfo().elementToFocus&&(this.getContent().getFocusInfo().elementToFocus.tabIndex=0))}},{key:"onClick",value:function(e,t){if(!Wt(e.target,"e-filterbarcell")||!e.target.classList.contains("e-input-group-icon")){var i=!Object(m.X)(Object(m.C)(e.target,".e-gridcontent")),n=!Object(m.X)(Object(m.C)(e.target,".e-gridheader"));i=i&&n?!i:i;var r=!Object(m.X)(Object(m.C)(e.target,".e-frozencontent"))||!Object(m.X)(Object(m.C)(e.target,".e-frozenheader")),s=!1;if("Left-Right"===this.parent.getFrozenMode()&&(s=!Object(m.X)(Object(m.C)(e.target,".e-frozen-right-content"))||!Object(m.X)(Object(m.C)(e.target,".e-frozen-right-header")),r=r&&!s),!(!i&&Object(m.X)(Object(m.C)(e.target,".e-gridheader"))||e.target.classList.contains("e-content"))&&Object(m.X)(Object(m.C)(e.target,".e-unboundcell")))if(this.setActive(i,r,s),i||!Object(m.X)(Object(m.C)(e.target,".e-gridheader"))){var a={cancel:!1,byKey:!1,byClick:!Object(m.X)(e.target),clickArgs:e};if(this.parent.notify("beforecellfocused",a),!a.cancel&&!Object(m.C)(e.target,".e-inline-edit")&&(this.setActive(i,r,s),this.getContent())){if(!1===this.getContent().onClick(e,t))return;this.focus()}}else this.clearOutline()}}},{key:"onKeyPress",value:function(e){if(!this.skipOn(e)){this.activeKey=e.action;var t={cancel:!1,byKey:!0,byClick:!1,keyArgs:e};if(this.parent.notify("beforecellfocused",t),!t.cancel){var i=this.getContent().matrix.current;this.currentInfo.outline=!0;var n=this.getContent().jump(e.action,i);this.swap=n,n.swap&&(this.setActive(!n.toHeader,n.toFrozen,n.toFrozenRight),this.getContent().matrix.current=this.getContent().getNextCurrent(i,n,this.active,e.action),this.prevIndexes={}),this.setActiveByKey(e.action,this.getContent()),!1!==this.getContent().onKeyPress(e)?(e.preventDefault(),this.focus(e)):this.clearIndicator()}}}},{key:"skipOn",value:function(e){var t=e.target;if(!t)return!1;if(this.currentInfo.skipAction)return this.clearIndicator(),!0;if(["pageUp","pageDown","altDownArrow"].indexOf(e.action)>-1)return this.clearIndicator(),!0;var i=Object(m.C)(t,"th")&&!Object(m.C)(t,"th").tabIndex;!e.target.classList.contains("e-filterbaroperator")||13!==e.keyCode&&27!==e.keyCode||Object(m.C)(e.target,".e-filterbarcell").querySelector("input").focus(),i&&null!==Object(m.C)(document.activeElement,".e-filterbarcell")&&this.removeFocus();var n=null!==Object(m.C)(document.activeElement,".e-filterbarcell");if(this.parent.enableHeaderFocus&&n){var r=this.active.matrix,s=r.current;n=r.matrix[s[0]].lastIndexOf(1)!==s[1]}return"delete"===e.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(e.action)>-1)||n||null!==Object(m.C)(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(e.action)>-1||null===Object(m.C)(t,".e-gridcontent")&&null===Object(m.C)(t,".e-gridheader")||"space"===e.action&&!t.classList.contains("e-gridchkbox")&&null===Object(m.C)(t,".e-gridchkbox")&&null===Object(m.C)(t,".e-headerchkcelldiv")||null!==Object(m.C)(t,".e-filter-popup")}},{key:"focusVirtualElement",value:function(e){var t=this;if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){var i={virtualData:{},isAdd:!1,isCancel:!1};this.parent.notify("get-virtual-data",i);var n=this.actions.some((function(e){return e===t.activeKey})),r=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1;i.isAdd||Object.keys(i.virtualData).length||n||i.isCancel||r?(i.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,n&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",e)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.currentInfo.elementToFocus.focus()}}},{key:"getFocusedElement",value:function(){return this.currentInfo.elementToFocus}},{key:"getContent",value:function(){return this.active||this.content}},{key:"setActive",value:function(e,t,i){this.active=e?t?this.fContent:i?this.frContent:this.content:t?this.fHeader:i?this.frHeader:this.header}},{key:"setFocusedElement",value:function(e,t){var i=this;this.currentInfo.elementToFocus=e,setTimeout((function(){Object(m.X)(i.currentInfo.elementToFocus)||(i.parent.enableVirtualization||i.parent.enableInfiniteScrolling?i.focusVirtualElement(t):i.currentInfo.elementToFocus.focus())}),0)}},{key:"focus",value:function(e){this.parent.notify("virtaul-cell-focus",e),this.removeFocus(),this.addFocus(this.getContent().getFocusInfo(),e)}},{key:"removeFocus",value:function(e){this.currentInfo.element&&(Object(m.ib)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)}},{key:"addOutline",value:function(){var e=this.getContent().getFocusInfo();e.element&&(Object(m.v)([e.element],["e-focused"]),Object(m.v)([e.elementToFocus],["e-focus"]))}},{key:"focusHeader",value:function(){this.setActive(!1,this.parent.isFrozenGrid()),this.resetFocus()}},{key:"focusContent",value:function(){this.setActive(!0,this.parent.isFrozenGrid()),this.resetFocus()}},{key:"resetFocus",value:function(){var e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.focus()}},{key:"addFocus",value:function(t,i){if(this.currentInfo=t,this.currentInfo.outline=t.outline&&!Object(m.X)(i),t.element){var n=t.elementToFocus.classList.contains("e-focus");if(!n){this.currentInfo.outline&&Object(m.v)([t.element],["e-focused"]),Object(m.v)([t.elementToFocus],["e-focus"]),t.element.tabIndex=0,n||this.setFocusedElement(t.elementToFocus,i),this.parent.notify("cellfocused",{element:t.elementToFocus,parent:t.element,indexes:this.getContent().matrix.current,byKey:!Object(m.X)(i),byClick:Object(m.X)(i),keyArgs:i,isJump:this.swap.swap,container:this.getContent().getInfo(i),outline:!Object(m.X)(i),swapInfo:this.swap});var r=e(this.getContent().matrix.current,2),s=r[0],a=r[1];this.prevIndexes={rowIndex:s,cellIndex:a},this.focusedColumnUid=this.parent.getColumnByIndex(a).uid,this.focusByClick=!1}}}},{key:"refreshMatrix",value:function(e){var t=this;return function(i){e&&i.args&&i.args.isFrozen&&!t.fContent?t.fContent=new Ye(t.parent):e&&!t.frContent&&i.args&&i.args.renderFrozenRightContent?t.frContent=new Je(t.parent):e&&!t.content&&(t.content=new Ke(t.parent)),!e&&i.args&&i.args.isFrozen&&!t.fHeader?t.fHeader=new _e(t.parent):!e&&i.args&&i.args.renderFrozenRightContent&&!t.frHeader?t.frHeader=new Ze(t.parent):e||t.header||(t.header=new Ue(t.parent));var n=e?i.args&&i.args.isFrozen?t.fContent:i.args&&i.args.renderFrozenRightContent?t.frContent:t.content:i.args&&i.args.isFrozen?t.fHeader:i.args&&i.args.renderFrozenRightContent?t.frHeader:t.header,r=e?i.rows.slice(t.parent.frozenRows):i.rows,s=e?i.rows.slice(0,t.parent.frozenRows):i.rows;t.parent.isCollapseStateEnabled()&&e&&(r=r.filter((function(e){return!1!==e.visible})));var a=!Object(m.X)(t.parent.rowTemplate),l=n.matrix.generate(s,n.selector,a);if("batchAdd"===i.name&&t.parent.isFrozenGrid()){var o=t.parent.getMovableRowsObject().map((function(e){return e.clone()})),h=r.map((function(e){return e.clone()}));if(t.fContent.matrix.generate(h,t.fContent.selector,a),t.content.matrix.generate(o,t.content.selector,a),"Left-Right"===t.parent.getFrozenMode()){var c=t.parent.getFrozenRightRowsObject().map((function(e){return e.clone()}));t.frContent.matrix.generate(c,t.frContent.selector,a)}}else n.matrix.generate(r,n.selector,a);if(n.generateRows(s,{matrix:l,handlerInstance:i.args&&i.args.isFrozen?t.fHeader:i.args&&i.args.renderFrozenRightContent?t.frHeader:t.header}),!m.d.isDevice&&i&&i.args&&(t.focusByClick||"paging"!==i.args.requestType||(t.skipFocus=!1,t.parent.element.focus()),"grouping"===i.args.requestType&&(t.skipFocus=!0)),i&&i.args&&"virtualscroll"===i.args.requestType)if(t.currentInfo.uid){var u;if(i.rows.some((function(e,i){return u=i,e.uid===t.currentInfo.uid}))){t.content.matrix.current[0]=u,t.content.matrix.current[1]=t.parent.getColumnIndexByUid(t.focusedColumnUid)||0;var d=t.getContent().getFocusInfo().elementToFocus;if(d){var p=d.getBoundingClientRect(),g=t.parent.element.getBoundingClientRect();p.top>=0&&p.left>=0&&p.right<=Math.min(g.right,window.innerWidth||document.documentElement.clientWidth)&&p.bottom<=Math.min(g.bottom,window.innerHeight||document.documentElement.clientHeight)&&t.focus()}}}else if(i.args.focusElement&&i.args.focusElement.classList.contains("e-filtertext")){var f=t.parent.element.querySelector("#"+i.args.focusElement.id);f&&f.focus()}}}},{key:"addEventListener",value:function(){var e=this;if(!this.parent.isDestroyed){m.l.add(this.parent.element,"mousedown",this.focusCheck,this),m.l.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=function(t){return e.passiveFocus(t)},!0),m.l.add(this.parent.element,"focusout",this.onBlur,this),this.parent.on(V,this.onKeyPress,this),this.parent.on(H,this.onClick,this),this.parent.on(A,this.refMatrix,this),this.parent.on("partial-refresh",this.refMatrix,this),this.parent.on(q,this.refreshMatrix(),this),this.parent.on("close-edit",this.restoreFocus,this),this.parent.on("restore-Focus",this.restoreFocus,this);for(var t=["start-edit","start-add"],i=0;i<t.length;i++)this.parent.on(t[i],this.clearIndicator,this);this.parent.on("sorting-complete",this.restoreFocus,this),this.parent.on("filtering-complete",this.filterfocus,this);for(var n=["grouping","ungrouping"],r=0;r<n.length;r++)this.parent.on(n[r]+"-complete",this.restoreFocusWithAction,this);this.parent.on("batchAdd",this.refMatrix,this),this.parent.on("batchCancel",this.refMatrix,this),this.parent.on("batchDelete",this.refMatrix,this),this.parent.on("detailDataBound",this.refMatrix,this),this.parent.on(L,this.refMatrix,this),this.parent.on("cellfocused",this.internalCellFocus,this)}}},{key:"filterfocus",value:function(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()}},{key:"removeEventListener",value:function(){if(!this.parent.isDestroyed){m.l.remove(this.parent.element,"mousedown",this.focusCheck),m.l.remove(this.parent.element,"focus",this.onFocus),m.l.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),this.parent.off(V,this.onKeyPress),this.parent.off(H,this.onClick),this.parent.off(A,this.refMatrix),this.parent.off("partial-refresh",this.refMatrix),this.parent.off(q,this.refreshMatrix()),this.parent.off("close-edit",this.restoreFocus),this.parent.off("restore-focus",this.restoreFocus);for(var e=["start-edit","start-add"],t=0;t<e.length;t++)this.parent.off(e[t],this.clearOutline);this.parent.off("sorting-complete",this.restoreFocus),this.parent.off("filtering-complete",this.filterfocus);for(var i=["grouping","ungrouping"],n=0;n<i.length;n++)this.parent.on(i[n]+"-complete",this.restoreFocusWithAction);this.parent.off("batchAdd",this.refMatrix),this.parent.off("batchDelete",this.refMatrix),this.parent.off("batchCancel",this.refMatrix),this.parent.off("detailDataBound",this.refMatrix),this.parent.off(L,this.refMatrix),this.parent.off("cellfocused",this.internalCellFocus)}}},{key:"destroy",value:function(){this.removeEventListener()}},{key:"restoreFocus",value:function(){this.addFocus(this.getContent().getFocusInfo())}},{key:"restoreFocusWithAction",value:function(e){if(!this.parent.enableInfiniteScrolling){var t=this.getContent().matrix,i=t.current;switch(e.requestType){case"grouping":case"ungrouping":i[1]=!i.length||this.parent.groupSettings.showGroupedColumn||Object(m.X)(t.matrix[i[0]])?"grouping"===e.requestType?i[1]+1:i[1]-1:t.matrix[i[0]].indexOf(1)}this.getContent().matrix.current=i,this.addFocus(this.getContent().getFocusInfo())}}},{key:"clearOutline",value:function(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator()),this.clearIndicator()}},{key:"clearIndicator",value:function(){this.currentInfo.element&&this.currentInfo.elementToFocus&&Object(m.ib)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])}},{key:"getPrevIndexes",value:function(){var e=this.forget;return this.forget=!1,e||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes}},{key:"forgetPrevious",value:function(){this.forget=!0}},{key:"setActiveByKey",value:function(e,t){var i=this;if(this.parent.isFrozenGrid()||0!==this.parent.frozenRows){var n,r={home:function(){return{toHeader:!n.isContent,toFrozen:!0}},end:function(){return{toHeader:!n.isContent,toFrozen:!1}},ctrlHome:function(){return{toHeader:!0,toFrozen:i.parent.isFrozenGrid()}},ctrlEnd:function(){return{toHeader:!1,toFrozen:!1}}};if(e in r){n=t.getInfo();var s=r[e]();this.setActive(!s.toHeader,s.toFrozen),this.getContent().matrix.current=t.matrix.current}}}},{key:"internalCellFocus",value:function(e){if(e.byKey&&e.container.isContent&&"enter"===e.keyArgs.action&&(e.parent.classList.contains("e-detailcell")||e.parent.classList.contains("e-unboundcell")||e.parent.classList.contains("e-templatecell"))){this.clearIndicator();var t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t),this.currentInfo.skipAction=!0}}}]),t}(),Ge=function(){function e(){p(this,e),this.matrix=[],this.current=[]}return f(e,[{key:"set",value:function(e,t,i){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.columns)),this.matrix[e]=this.matrix[e]||[],this.matrix[e][t]=i?1:0}},{key:"get",value:function(e,t,i,n,r){var s=t;if(e+i[0]<0)return[e,t];e=Math.max(0,Math.min(e+i[0],this.rows));var a=!0;if(Object(m.X)(this.matrix[e]))return null;if(t=Math.max(0,Math.min(t+i[1],this.matrix[e].length-1)),s+i[1]>this.matrix[e].length-1&&r(e,t,n))return[e,s];var l=this.first(this.matrix[e],t,i,!0,n);t=null===l?s:l;var o=Object(m.V)("".concat(e,".").concat(t),this.matrix);if(e!==this.rows||"downArrow"!==n&&"enter"!==n||(i[0]=-1),null===l){e=this.current[0];for(var h=0;h<this.rows;h++)if(this.matrix[h].some((function(e){return 1===e}))){a=!1;break}if(a)return[e,t]}return this.inValid(o)||!r(e,t,n)?this.get(e,s,i,n,r):[e,t]}},{key:"first",value:function(e,t,i,n,r){return(t<0||t===e.length)&&this.inValid(e[t])&&"upArrow"!==r&&"downArrow"!==r||!e.some((function(e){return 1===e}))?null:this.inValid(e[t])?this.first(e,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(r)?n?0:++t:t+i[1],i,!1,r):t}},{key:"select",value:function(e,t){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.matrix[e].length-1)),this.current=[e,t]}},{key:"generate",value:function(e,t,i){this.rows=e.length-1,this.matrix=[];for(var n=0;n<e.length;n++){var r=e[n].cells.filter((function(e){return!0!==e.isSpanned}));this.columns=Math.max(r.length-1,0|this.columns);for(var s=0;s<r.length;s++)this.set(n,s,t(e[n],r[s],i))}return this.matrix}},{key:"inValid",value:function(e){return 0===e||void 0===e}}]),e}(),Ke=function(){function t(e){var i=this;p(this,t),this.matrix=new Ge,this.parent=e,this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]},this.indexesByKey=function(e){return{home:[i.matrix.current[0],-1,0,1],end:[i.matrix.current[0],i.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[i.matrix.rows,i.matrix.columns+1,0,-1]}[e]||null}}return f(t,[{key:"getTable",value:function(){return this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()}},{key:"onKeyPress",value:function(e){var t=this.getCurrentFromAction(e.action,this.keyActions[e.action],e.action in this.keyActions,e);if(t){if((["tab","shiftTab"].indexOf(e.action)>-1&&this.matrix.current||[]).toString()===t.toString()){if(t.toString()===[this.matrix.rows,this.matrix.columns].toString()||t.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===t.toString())return!1;t=this.editNextRow(t[0],t[1],e.action)}this.matrix.select(t[0],t[1])}}},{key:"editNextRow",value:function(e,t,i){var n=this.parent,r=n.editSettings.allowNextRowEdit&&(n.isEdit||n.isLastCellPrimaryKey),s=n.getColumnIndexByField(n.getVisibleColumns()[0].field),a=this.getTable().rows[e].cells[t];return"tab"===i&&r&&(e++,t=s+(this.getTable().rows[e].querySelectorAll(".e-indentcell").length+this.getTable().rows[e].querySelectorAll(".e-detailrowcollapse").length)),"shiftTab"===i&&r&&(e--,t=n.getColumnIndexByField(n.getVisibleColumns()[n.getVisibleColumns().length-1].field)),a.classList.contains("e-rowcell")||a.classList.contains("e-headercell")||a.classList.contains("e-groupcaption")?[e,t]:this.editNextRow(e,t,i)}},{key:"getCurrentFromAction",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!n&&!this.indexesByKey(t)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(r))return this.matrix.current;var s=this.indexesByKey(t)||[].concat(h(this.matrix.current),h(i)),a=e(s,4),l=a[0],o=a[1],c=a[2],u=a[3];return this.matrix.get(l,o,[c,u],t,this.validator())}},{key:"onClick",value:function(t,i){var n=t.target;if(n=(n=n.classList.contains("e-rowcell")?n:Object(m.C)(n,"td"))||Object(m.C)(t.target,"td.e-detailrowcollapse")||Object(m.C)(t.target,"td.e-detailrowexpand"),!(n=(n=Object(m.C)(t.target,"td.e-detailcell")&&Object(m.X)(Object(m.C)(Object(m.C)(t.target,".e-grid"),"td.e-detailcell"))?null:n)&&Object(m.C)(n,"table").classList.contains("e-table")?n:null))return!1;var r=[n.parentElement.rowIndex,n.cellIndex],s=r[0],a=r[1],l=e(this.matrix.current,2),o=l[0],h=l[1],c=Object(m.V)("".concat(s,".").concat(a),this.matrix.matrix);if(this.matrix.inValid(c)||!i&&o===s&&h===a||!Wt(t.target,"e-rowcell")&&!Wt(t.target,"e-groupcaption"))return!1;this.matrix.select(s,a)}},{key:"getFocusInfo",value:function(){var t={},i=e(this.matrix.current,2),n=i[0],r=void 0===n?0:n,s=i[1],a=void 0===s?0:s;return this.matrix.current=[r,a],t.element=Object(m.X)(this.getTable().rows[r])?null:this.getTable().rows[r].cells[a],t.element?(t.elementToFocus=t.element.classList.contains("e-unboundcell")||t.element.classList.contains("e-detailcell")?t.element:this.getFocusable(t.element),t.outline=!0,t.uid=t.element.parentElement.getAttribute("data-uid"),t):t}},{key:"getFocusable",value:function(e){var t='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])';this.parent.isEdit&&(t='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea');var i=[].slice.call(e.querySelectorAll(t));return i.length?i[0]:e}},{key:"selector",value:function(e,t,i){var n=[K.Expand,K.GroupCaption,K.CaptionSummary,K.GroupSummary];return(e.isDataRow&&t.visible&&(t.isDataCell||t.isTemplate)||e.isDataRow&&t.cellType===K.DetailExpand&&Object(m.X)(t.visible)||!e.isDataRow&&n.indexOf(t.cellType)>-1||t.column&&"checkbox"===t.column.type||t.cellType===K.CommandColumn||e.isDataRow&&i)&&!("delete"===e.edit&&e.isDirty)}},{key:"jump",value:function(e,t){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftTab"===e)&&0===t[1],n=("rightArrow"===e||"tab"===e)&&t[1]===this.matrix.columns,r="Left-Right"===this.parent.getFrozenMode()&&n;"Right"===this.parent.getFrozenMode()&&(i=n);var s=0!==this.parent.frozenRows&&"shiftEnter"===e;"tab"!==e||this.parent.isEdit||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.matrix.current[0]+1,this.matrix.current[1]=-1,i=this.parent.isFrozenGrid()),"shiftTab"!==e||this.parent.isEdit||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.matrix.current[0]-1,this.matrix.current[1]=this.matrix.matrix[t[0]].length);var a=!1,l=document.activeElement.parentElement;return(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&l.classList.contains("e-row")&&(a=parseInt(l.getAttribute("aria-rowindex"),10)>0),{swap:!a&&(("upArrow"===e||s)&&0===t[0]||i||r),toHeader:("upArrow"===e||s)&&0===t[0],toFrozen:i,toFrozenRight:r}}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=[];return"Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?("leftArrow"!==i&&"shiftTab"!==i||(n[0]=e[0],n[1]=t.matrix.columns+1),"Left-Right"!==this.parent.getFrozenMode()||"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1)):"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1),"downArrow"!==i&&"enter"!==i||(n[0]=-1,n[1]=e[1]),n}},{key:"generateRows",value:function(e,t){var i,n=t.matrix,r=t.handlerInstance,s=r.matrix.matrix.length,a=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?s+1:s;r.matrix.matrix=r.matrix.matrix.slice(0,a),r.matrix.rows=a,(i=r.matrix.matrix).push.apply(i,h(n)),r.matrix.rows+=n.length}},{key:"getInfo",value:function(t){var i=this.getFocusInfo(),n=e(this.matrix.current,2),r=n[0],s=n[1],a=i.element.classList.contains("e-rowcell"),l=a||t&&"enter"!==t.action&&(i.element.classList.contains("e-detailrowcollapse")||i.element.classList.contains("e-detailrowexpand")),o=[Math.min(parseInt(i.element.parentElement.getAttribute("aria-rowindex"),10),r),Math.min(parseInt(i.element.getAttribute("aria-colindex"),10),s)];return{isContent:!0,isDataCell:a,indexes:[o[0],o[1]],isSelectable:l}}},{key:"validator",value:function(){var e=this.getTable();return function(t,i,n){if(!Object(m.X)(e.rows[t])){var r;i=e.querySelector(".e-emptyrow")?0:i;var s=0!==(r=e.rows[t].cells[0].classList.contains("e-editcell")?e.rows[t].cells[0].querySelectorAll("td")[i]:e.rows[t].cells[i]).getBoundingClientRect().width;if("enter"===n||"shiftEnter"===n)return s&&r.classList.contains("e-rowcell");if(("shiftUp"===n||"shiftDown"===n)&&r.classList.contains("e-rowcell"))return s;if("shiftUp"!==n&&"shiftDown"!==n)return s}return!1}}},{key:"shouldFocusChange",value:function(t){var i=e(this.matrix.current,2),n=i[0],r=void 0===n?-1:n,s=i[1],a=void 0===s?-1:s;if(r<0||a<0)return!0;var l=Object(m.V)("".concat(r,".cells.").concat(a),this.getTable().rows);return!l||"enter"!==t.action&&"shiftEnter"!==t.action||l.classList.contains("e-rowcell")&&!l.classList.contains("e-unboundcell")&&(!l.classList.contains("e-templatecell")||l.classList.contains("e-editedbatchcell"))&&!l.classList.contains("e-detailcell")}},{key:"getGridSeletion",value:function(){return!Object(m.W)()&&this.parent.allowSelection&&this.parent.selectionSettings.allowColumnSelection}}]),t}(),Ue=function(t){n(a,t);var r=s(a);function a(e){return p(this,a),r.call(this,e)}return f(a,[{key:"getTable",value:function(){return this.parent.isFrozenGrid()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()}},{key:"onClick",value:function(e){var t=e.target;if((t=t.classList.contains("e-headercell")?t:Object(m.C)(t,"th"))||0===this.parent.frozenRows||(t=e.target.classList.contains("e-rowcell")?e.target:Object(m.C)(e.target,"td")),e.target.classList.contains("e-columnheader")||e.target.querySelector(".e-stackedheadercell"))return!1;if(t){var i=[t.parentElement.rowIndex,t.cellIndex],n=i[0],r=i[1],s=Object(m.V)("".concat(n,".").concat(r),this.matrix.matrix);if(this.matrix.inValid(s))return!1;this.matrix.select(t.parentElement.rowIndex,t.cellIndex)}}},{key:"getFocusInfo",value:function(){var t={},i=e(this.matrix.current,2),n=i[0],r=void 0===n?0:n,s=i[1],a=void 0===s?0:s;return t.element=this.getTable().rows[r].cells[a],Object(m.X)(t.element)||(t.elementToFocus=this.getFocusable(t.element),t.outline=!t.element.classList.contains("e-filterbarcell")),t}},{key:"selector",value:function(e,t){return t.visible&&(void 0!==t.column.field||t.isTemplate||!Object(m.X)(t.column.template))||"checkbox"===t.column.type||t.cellType===K.StackedHeader}},{key:"jump",value:function(e,t){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1],n=("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,r="Left-Right"===this.parent.getFrozenMode()&&n;"Right"===this.parent.getFrozenMode()&&(i=n);var s,a,l=0!==this.parent.frozenRows&&"enter"===e,o=i||r,h=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,c=h&&!Object(m.X)(h[t[0]]);return this.parent.enableHeaderFocus&&"tab"===e&&(a=this.matrix.matrix.length-1===t[0],(s=t[1]===this.matrix.matrix[t[0]].lastIndexOf(1))&&(this.matrix.current[0]=a?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.isFrozenGrid()&&a&&s&&(i=!0,o=!1)),{swap:("downArrow"===e||l)&&t[0]===this.matrix.matrix.length-1||c&&(i||r)||"tab"===e&&a&&s,toHeader:o,toFrozen:i,toFrozenRight:r}}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=[];return"Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?(("leftArrow"===i||"shiftLeft"===i&&this.getGridSeletion()||"shiftTab"===i)&&(n[0]=e[0],n[1]=t.matrix.columns+1),"Left-Right"===this.parent.getFrozenMode()&&("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1)):("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1),"upArrow"!==i&&"shiftEnter"!==i||(n[0]=this.matrix.matrix.length,n[1]=e[1]),n}},{key:"generateRows",value:function(e){var t=this.matrix.matrix.length;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type){this.matrix.rows=++this.matrix.rows;for(var i=e[0].cells,n=0;n<i.length;n++)this.matrix.set(t,n,i[n].visible&&!1!==i[n].column.allowFiltering)}}},{key:"getInfo",value:function(e){return Object(m.K)(i(o(a.prototype),"getInfo",this).call(this,e),{isContent:!1,isHeader:!0})}},{key:"validator",value:function(){return function(){return!0}}},{key:"shouldFocusChange",value:function(t){var i=e(this.matrix.current,2),n=i[0],r=i[1];if(n<0||r<0)return!0;var s=Object(m.V)("".concat(n,".cells.").concat(r),this.getTable().rows);return!s||"enter"!==t.action&&"altDownArrow"!==t.action||!s.classList.contains("e-headercell")}}]),a}(Ke),Ye=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"getTable",value:function(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")}},{key:"jump",value:function(e,t){var i=("upArrow"===e||0!==this.parent.frozenRows&&"shiftEnter"===e)&&0===t[0];return"Right"===this.parent.getFrozenMode()?{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:i,toFrozen:i}:{swap:i||("tab"===e||"rightArrow"===e)&&t[1]===this.matrix.columns,toHeader:i,toFrozen:i}}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=[];return"Right"===this.parent.getFrozenMode()?"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1):("tab"===i&&this.parent.enableHeaderFocus&&(n[0]=e[0],n[1]=-1),"leftArrow"!==i&&"shiftTab"!==i||(n[0]=e[0],n[1]=t.matrix.columns+1)),"downArrow"!==i&&"enter"!==i||(n[0]=-1,n[1]=e[1]),n}}]),i}(Ke),_e=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"jump",value:function(e,t){var i=0!==this.parent.frozenRows&&"enter"===e,n=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,r=n&&!Object(m.X)(n[t[0]]);if("Right"===this.parent.getFrozenMode()){var s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||r&&s,toHeader:s,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}}return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns&&r,toHeader:("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}}},{key:"getTable",value:function(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=[];return"Right"===this.parent.getFrozenMode()?("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1):("leftArrow"===i||"shiftLeft"===i&&this.getGridSeletion()||"shiftTab"===i)&&(n[0]=e[0],n[1]=t.matrix.columns+1),"upArrow"!==i&&"shiftEnter"!==i||(n[0]=this.matrix.matrix.length,n[1]=e[1]),n}}]),i}(Ue),Qe=function(){function e(t){p(this,e),this.searchBox=t}return f(e,[{key:"searchFocus",value:function(e){e.target.parentElement.classList.add("e-input-focus")}},{key:"searchBlur",value:function(e){e.target.parentElement.classList.remove("e-input-focus")}},{key:"wireEvent",value:function(){this.searchBox&&(m.l.add(this.searchBox,"focus",this.searchFocus,this),m.l.add(this.searchBox,"blur",this.searchBlur,this))}},{key:"unWireEvent",value:function(){this.searchBox&&(m.l.remove(this.searchBox,"focus",this.searchFocus),m.l.remove(this.searchBox,"blur",this.searchBlur))}}]),e}(),Je=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"getTable",value:function(){return this.parent.getContent().querySelector(".e-frozen-right-content .e-table")}},{key:"jump",value:function(e,t){var i=("upArrow"===e||0!==this.parent.frozenRows&&"shiftEnter"===e)&&0===t[0];return{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:i,toFrozenRight:i}}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>3?arguments[3]:void 0,i=[];return"rightArrow"!==t&&"tab"!==t||(i[0]=e[0],i[1]=-1),"downArrow"!==t&&"enter"!==t||(i[0]=-1,i[1]=e[1]),i}}]),i}(Ke),Ze=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return f(i,[{key:"jump",value:function(e,t){var i=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,n=i&&!Object(m.X)(i[t[0]]),r=0!==this.parent.frozenRows&&"enter"===e,s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||r)&&t[0]===this.matrix.matrix.length-1||n&&s,toHeader:s,toFrozenRight:("downArrow"===e||r)&&t[0]===this.matrix.matrix.length-1}}},{key:"getTable",value:function(){return this.parent.getHeaderContent().querySelector(".e-frozen-right-header .e-table")}},{key:"getNextCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>3?arguments[3]:void 0,i=[];return("rightArrow"===t||"shiftRight"===t&&this.getGridSeletion()||"tab"===t)&&(i[0]=e[0],i[1]=0),"upArrow"!==t&&"shiftEnter"!==t||(i[0]=this.matrix.matrix.length,i[1]=e[1]),i}}]),i}(Ue),$e=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},et=(ce=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),$e([Object(m.s)(12)],ce.prototype,"pageSize",void 0),$e([Object(m.s)(8)],ce.prototype,"pageCount",void 0),$e([Object(m.s)(1)],ce.prototype,"currentPage",void 0),$e([Object(m.s)()],ce.prototype,"totalRecordsCount",void 0),$e([Object(m.s)(!1)],ce.prototype,"enableQueryString",void 0),$e([Object(m.s)(!1)],ce.prototype,"pageSizes",void 0),$e([Object(m.s)(null)],ce.prototype,"template",void 0),ce),tt=(he=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);s>3&&a&&Object.defineProperty(t,i,a)}([Object(m.s)("startsWith")],he.prototype,"operator",void 0),he),it=function(){function t(e,i,n){p(this,t),this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.selectedColumnsIndexes=[],this.checkBoxState=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.enableSelectMultiTouch=!1,this.clearRowCheck=!1,this.selectRowCheck=!1,this.selectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.needColumnSelection=!1,this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.cellselected=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.initialRowSelection=!1,this.autoFillRLselection=!0,this.parent=e,this.selectionSettings=i,this.factory=n.getService("rendererFactory"),this.focus=n.getService("focus"),this.addEventListener(),this.wireEvents()}return f(t,[{key:"initializeSelection",value:function(){this.parent.log("selection_key_missing"),this.render()}},{key:"onActionBegin",value:function(e,t){this.parent.trigger(t,this.fDataUpdate(e))}},{key:"fDataUpdate",value:function(e){if(!(this.isMultiSelection||Object(m.X)(e.cellIndex)&&Object(m.X)(e.rowIndex))){var t=this.getRowObj(Object(m.X)(e.rowIndex)?Object(m.X)(e.cellIndex)?this.currentIndex:e.cellIndex.rowIndex:e.rowIndex);e.foreignKeyData=t.foreignKeyData}return e}},{key:"onActionComplete",value:function(e,t){this.parent.trigger(t,this.fDataUpdate(e)),this.isMultiSelection=!1}},{key:"getModuleName",value:function(){return"selection"}},{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),m.l.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),m.l.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))}},{key:"isEditing",value:function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection}},{key:"getSelectedMovableRow",value:function(e){var t=this.parent;return t.isFrozenGrid()&&this.parent.getContent().querySelector(".e-movablecontent")?t.getMovableRowByIndex(e):null}},{key:"getSelectedFrozenRightRow",value:function(e){var t=this.parent;return t.isFrozenGrid()&&"Left-Right"===t.getFrozenMode()&&t.getFrozenRightContent()?t.getFrozenRightRowByIndex(e):null}},{key:"getCurrentBatchRecordChanges",value:function(){var e=this.parent;if("Batch"===e.editSettings.mode&&e.editModule){var t=zt(this.parent.getCurrentViewRecords());t="Bottom"===e.editSettings.newRowPosition?t.concat(this.parent.editModule.getBatchChanges().addedRecords):this.parent.editModule.getBatchChanges().addedRecords.concat(t);for(var i=this.parent.editModule.getBatchChanges().deletedRecords,n=this.parent.getPrimaryKeyFieldNames()[0],r=0;r<i.length;r++)for(var s=0;s<t.length;s++)if(i[r][n]===t[s][n]){t.splice(s,1);break}return t}return e.getCurrentViewRecords()}},{key:"selectRow",value:function(e,t){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)this.addRowsToSelection([e]);else{var i,n=this.parent,r=n.getRowByIndex(e),s=this.getSelectedMovableRow(e),a=this.getSelectedFrozenRightRow(e);if(n.enableVirtualization&&e>-1){this.parent.notify("select-virtual-Row",{selectedIndex:e});var l=n.isFrozenGrid()?n.contentModule.getRowObjectByIndex(e):null;if(!r||!n.getRowObjectFromUID(r.getAttribute("data-uid"))&&!l)return void(this.parent.getSelectedRecords().length>0&&this.clearRowSelection());i=l||n.getRowObjectFromUID(r.getAttribute("data-uid")).data}else i=this.getCurrentBatchRecordChanges()[e];if(this.isRowType()&&r&&!this.isEditing()){var o,h=r.hasAttribute("aria-selected");if(this.activeTarget(),t=t?!!this.selectedRowIndexes.length&&1===this.selectedRowIndexes.length&&e===this.selectedRowIndexes[0]:t)this.rowSelectingCallBack(o,t,e,i,!1,h,"cancel")(o);else{!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(o={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:r,previousRow:n.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},o=this.addMovableArgs(o,s,a)):o={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowIndex:this.prevRowIndex,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},this.parent.trigger("rowSelecting",this.fDataUpdate(o),this.rowSelectingCallBack(o,t,e,i,!1,h,"cancel"))}}}}},{key:"rowSelectingCallBack",value:function(e,t,i,n,r,s,a){var l=this;return function(e){Object(m.X)(e)||!0!==e[a]?(l.index=i,l.toggle=t,l.data=n,l.removed=r,s&&l.selectionSettings.persistSelection&&"ResetOnRowClick"!==l.selectionSettings.checkboxMode?(l.clearSelectedRow(i),l.selectRowCallBack()):!s&&l.selectionSettings.persistSelection&&"ResetOnRowClick"!==l.selectionSettings.checkboxMode&&l.selectRowCallBack(),"ResetOnRowClick"===l.selectionSettings.checkboxMode&&l.clearSelection(),(!l.selectionSettings.persistSelection||"ResetOnRowClick"===l.selectionSettings.checkboxMode||!l.parent.isCheckBoxSelection&&l.selectionSettings.persistSelection)&&(l.selectRowCheck=!0,l.clearRow())):l.disableInteracted()}}},{key:"selectRowCallBack",value:function(){var e,t=this.parent,i=this.index,n=this.toggle,r=this.data,s=this.removed,a=t.getRowByIndex(i),l=this.getSelectedMovableRow(i),o=this.getSelectedFrozenRightRow(i);if(n||s||(this.selectedRowIndexes.indexOf(i)<=-1&&(this.updateRowSelection(a,i),this.selectMovableRow(l,o,i)),this.selectRowIndex(i)),!n){!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(e={data:r,rowIndex:i,row:a,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},e=this.addMovableArgs(e,l,o)):e={data:r,rowIndex:i,row:a,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},this.onActionComplete(e,"rowSelected")}Object(m.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",[i]),this.isInteracted=!1,this.updateRowProps(i)}},{key:"selectMovableRow",value:function(e,t,i){this.parent.isFrozenGrid()&&(this.updateRowSelection(e,i),"Left-Right"===this.parent.getFrozenMode()&&t&&this.updateRowSelection(t,i))}},{key:"addMovableArgs",value:function(e,t,i){if(this.parent.isFrozenGrid()){var n={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};"Left-Right"===this.parent.getFrozenMode()&&i&&(n.frozenRightRow=i,n.previousFrozenRightRow=this.parent.getFrozenRightDataRows()[this.prevRowIndex]),e=Object.assign({},e,n)}return e}},{key:"selectRowsByRange",value:function(e,t){this.selectRows(this.getCollectionFromIndexes(e,t)),this.selectRowIndex(t)}},{key:"selectRows",value:function(e){var t=this,i=this.parent,n=this.isSingleSel()?e[e.length-1]:e[0];this.isMultiSelection=!0;var r,s=[],a=[],l=this.getSelectedMovableRow(n),o=this.getSelectedFrozenRightRow(n),h=[];if(this.isRowType()&&!this.isEditing()){for(var u=0,d=e.length;u<d;u++){var p=this.parent.getDataRows()[e[u]],g=this.getRowObj(p);g&&(h.push(g.data),s.push(p),a.push(g.foreignKeyData))}this.activeTarget(),!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(r={cancel:!1,rowIndexes:e,row:s,rowIndex:n,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:h,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:a},r=this.addMovableArgs(r,l,o)):r={cancel:!1,rowIndexes:e,rowIndex:n,previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:h,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:a},this.parent.trigger("rowSelecting",this.fDataUpdate(r),(function(r){if(Object(m.X)(r)||!0!==r.cancel){t.clearRow(),t.selectRowIndex(e.slice(-1)[0]);var u=function(e){if(t.updateRowSelection(i.getRowByIndex(e),e),i.isFrozenGrid()){var r="Left-Right"===t.parent.getFrozenMode()?i.getFrozenRightRowByIndex(e):void 0;t.selectMovableRow(i.getMovableRowByIndex(e),r,e)}t.updateRowProps(n)};if(t.isSingleSel())u(n);else{var d,p=c(e);try{for(p.s();!(d=p.n()).done;){u(d.value)}}catch(g){p.e(g)}finally{p.f()}}!Object(m.W)()||t.parent.isJsComponent||t.parent.isHybrid?(r={rowIndexes:e,row:s,rowIndex:n,target:t.actualTarget,prevRow:i.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,data:Object(m.W)()?h:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:a},r=t.addMovableArgs(r,l,o)):r={rowIndexes:e,rowIndex:n,previousRowIndex:t.prevRowIndex,row:s,prevRow:i.getRows()[t.prevRowIndex],data:Object(m.W)()?h:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:a},t.isRowSelected&&t.onActionComplete(r,"rowSelected"),t.isInteracted=!1}else t.disableInteracted()}))}}},{key:"addRowsToSelection",value:function(e){var t=this,i=this.parent,n=this.target;this.isMultiSelection=!0;var r,s=i.getSelectedRowIndexes().concat(e),a=this.isSingleSel()?i.getRowByIndex(e[e.length-1]):i.getRowByIndex(e[0]),l=this.isSingleSel()?this.getSelectedMovableRow(e[e.length-1]):this.getSelectedMovableRow(e[0]),o=this.isSingleSel()?this.getSelectedFrozenRightRow(e[e.length-1]):this.getSelectedFrozenRightRow(e[0]);if(this.isRowType()&&!this.isEditing()||this.selectionSettings.checkboxOnly){var h,u=this.parent.getColumns().filter((function(e){return"checkbox"===e.type})),d=c(e);try{var p=function(){var e=h.value,c=t.getRowObj(e),d=t.selectedRowIndexes.indexOf(e)>-1;if(t.selectRowIndex(e),d&&(u.length||t.selectionSettings.enableToggle||t.isMultiCtrlRequest)){if(t.isAddRowsToSelection=!0,t.rowDeselect("rowDeselecting",[e],[c.data],[a],[c.foreignKeyData],n),t.isCancelDeSelect)return{v:void 0};t.selectedRowIndexes.splice(t.selectedRowIndexes.indexOf(e),1),t.selectedRecords.splice(t.selectedRecords.indexOf(a),1),a.removeAttribute("aria-selected"),t.addRemoveClassesForRow(a,!1,null,"e-selectionbackground","e-active"),l&&(t.selectedRecords.splice(t.selectedRecords.indexOf(l),1),l.removeAttribute("aria-selected"),t.addRemoveClassesForRow(l,!1,null,"e-selectionbackground","e-active")),o&&(t.selectedRecords.splice(t.selectedRecords.indexOf(o),1),o.removeAttribute("aria-selected"),t.addRemoveClassesForRow(o,!1,null,"e-selectionbackground","e-active")),t.rowDeselect("rowDeselected",[e],[c.data],[a],[c.foreignKeyData],n,[l],void 0,[o]),t.isInteracted=!1,t.isMultiSelection=!1,t.isAddRowsToSelection=!1}else{t.activeTarget(),!Object(m.W)()||t.parent.isJsComponent||t.parent.isHybrid?(r={cancel:!1,data:c.data,rowIndex:e,row:a,target:t.actualTarget,prevRow:i.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,isCtrlPressed:t.isMultiCtrlRequest,isShiftPressed:t.isMultiShiftRequest,foreignKeyData:c.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},r=t.addMovableArgs(r,l,o)):r={cancel:!1,data:c.data,rowIndex:e,previousRowIndex:t.prevRowIndex,isCtrlPressed:t.isMultiCtrlRequest,isShiftPressed:t.isMultiShiftRequest,foreignKeyData:c.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},t.parent.trigger("rowSelecting",t.fDataUpdate(r),(function(i){Object(m.X)(i)||!0!==i.cancel?(t.isSingleSel()&&t.clearRow(),t.updateRowSelection(a,e),t.selectMovableRow(l,o,e)):t.disableInteracted()}))}if(!d){!Object(m.W)()||t.parent.isJsComponent||t.parent.isHybrid?(r={data:c.data,rowIndex:e,row:a,target:t.actualTarget,prevRow:i.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,foreignKeyData:c.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},r=t.addMovableArgs(r,l,o)):r={data:c.data,rowIndex:e,previousRowIndex:t.prevRowIndex,row:a,prevRow:i.getRows()[t.prevRowIndex],foreignKeyData:c.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},t.onActionComplete(r,"rowSelected")}if(t.isInteracted=!1,t.updateRowProps(e),t.isSingleSel())return"break"};for(d.s();!(h=d.n()).done;){var g=p();if("break"===g)break;if("object"==typeof g)return g.v}}catch(f){d.e(f)}finally{d.f()}}}},{key:"getCollectionFromIndexes",value:function(e,t){for(var i=[],n=e<=t?{i:e,max:t}:{i:t,max:e},r=n.i,s=n.max;r<=s;r++)i.push(r);return e>t&&i.reverse(),i}},{key:"clearRow",value:function(){this.clearRowCheck=!0,this.clearRowSelection()}},{key:"clearRowCallBack",value:function(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))}},{key:"clearSelectedRow",value:function(e){if(this.toggle){var t=this.parent.getRowByIndex(e);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active")),this.removed=!0,this.updatePersistCollection(t,!1),this.updateCheckBoxes(t),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(e),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(e)),1)}}},{key:"updateRowProps",value:function(e){this.prevRowIndex=e,this.isRowSelected=this.selectedRowIndexes.length&&!0}},{key:"updatePersistCollection",value:function(e,t){var i=this;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!Object(m.X)(e)){this.parent.isPersistSelection||this.ensureCheckboxFieldSelection();var n=this.getRowObj(e),r=n.data?n.data[this.primaryKey]:null;if(null===r)return;n.isSelected=t,t?(this.selectedRowState[r]=t,this.persistSelectedData.some((function(e){return e[i.primaryKey]===r}))||this.persistSelectedData.push(n.data)):this.updatePersistDelete(r)}}},{key:"updatePersistDelete",value:function(e){var t,i=this;delete this.selectedRowState[e],this.persistSelectedData.some((function(n,r){return t=r,n[i.primaryKey]===e}))&&this.persistSelectedData.splice(t,1)}},{key:"updateCheckBoxes",value:function(e,t,i){if(!Object(m.X)(e)){var n=e.querySelector(".e-checkselect");Object(m.X)(n)||(vi(n.nextElementSibling,t),fi(n,t),(Object(m.X)(this.checkedTarget)||!Object(m.X)(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(i))}}},{key:"updateRowSelection",value:function(e,t){if(e){this.selectedRowIndexes.push(t);var i=this.selectedRowIndexes.length;if(this.parent.isFrozenGrid()&&i>1&&this.selectedRowIndexes[i-2]===this.selectedRowIndexes[i-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(e),e.setAttribute("aria-selected","true"),this.updatePersistCollection(e,!0),this.updateCheckBoxes(e,!0),this.addRemoveClassesForRow(e,!0,null,"e-selectionbackground","e-active"),!this.preventFocus){var n=this.focus.getPrevIndexes().cellIndex?e.cells[this.focus.getPrevIndexes().cellIndex]:e.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(this.parent.contextMenuModule&&2===this.mouseButton&&(n=this.parent.contextMenuModule.cell),!n)return;this.focus.onClick({target:n},!0)}}}},{key:"clearSelection",value:function(){if(!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!Object(m.X)(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var e=this.parent.element.querySelector(".e-gridpopup").querySelector("span");e.classList.contains("e-rowselect")&&e.classList.remove("e-spanclicked"),this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.clearColumnSelection(),this.prevRowIndex=void 0,this.enableSelectMultiTouch=!1,this.isInteracted=!1}}},{key:"clearRowSelection",value:function(){var e=this;if(this.isRowSelected){var t=this.parent,i=this.parent.getDataRows(),n=[],r=[],s=[],a=[],l=[],o=[],h=this.target;this.parent.getCurrentViewRecords();for(var c=0,u=this.selectedRowIndexes.length;c<u;c++){var d="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[c]]:this.parent.getDataRows()[this.selectedRowIndexes[c]],p=this.getRowObj(d);p&&(n.push(p.data),r.push(d),l.push(this.selectedRowIndexes[c]),o.push(p.foreignKeyData)),t.isFrozenGrid()&&(s.push(t.getMovableRows()[this.selectedRowIndexes[c]]),"Left-Right"===t.getFrozenMode()&&a.push(t.getFrozenRightRows()[this.selectedRowIndexes[c]]))}this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked),this.rowDeselect("rowDeselecting",l,n,r,o,h,s,(function(){if(e.isCancelDeSelect&&(e.isRowClicked||e.checkSelectAllClicked)){if(e.parent.isPersistSelection)if("Intermediate"===e.getCheckAllStatus(e.parent.element.querySelector(".e-checkselectall")))for(var t=0;t<e.selectedRecords.length;t++)e.updatePersistCollection(e.selectedRecords[t],!0);else e.parent.checkAllRows="Check",e.updatePersistSelectedData(!0);e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))}else{for(var c=[].slice.call(i.filter((function(e){return e.hasAttribute("aria-selected")}))),u=0;u<c.length;u++)e.disableUI&&!Object(m.W)()||(c[u].removeAttribute("aria-selected"),e.addRemoveClassesForRow(c[u],!1,!0,"e-selectionbackground","e-active")),e.updatePersistCollection(c[u],!1),e.updateCheckBoxes(c[u]);Object(m.W)()&&e.parent.isServerRendered&&e.parent.enableVirtualization&&e.getRenderer().setSelection(null,!1,!0);for(var d=0,p=e.selectedRowIndexes.length;d<p;d++){var g=e.getSelectedMovableRow(e.selectedRowIndexes[d]);g&&(e.disableUI&&!Object(m.W)()||(g.removeAttribute("aria-selected"),e.addRemoveClassesForRow(g,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(g),e.updatePersistCollection(g,!1));var f=e.getSelectedFrozenRightRow(e.selectedRowIndexes[d]);f&&(e.disableUI||(f.removeAttribute("aria-selected"),e.addRemoveClassesForRow(f,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(f),e.updatePersistCollection(f,!1))}e.selectedRowIndexes=[],e.selectedRecords=[],e.isRowSelected=!1,e.selectRowIndex(-1),e.rowDeselect("rowDeselected",l,n,r,o,h,s,void 0,a),e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))}}),a)}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))}},{key:"rowDeselect",value:function(e,t,i,n,r,s,a,l,o){var h=this;if(this.selectionSettings.persistSelection&&(this.isRowClicked||this.checkSelectAllClicked)||!this.selectionSettings.persistSelection){var c={rowIndex:t[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.persistSelectedData:i,foreignKeyData:r,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===e&&delete c.cancel;if(!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid){var u="rowIndexes",d="foreignKeyData";c.row=n,c.target=this.actualTarget,this.actualTarget&&!Object(m.X)(Object(m.C)(this.actualTarget,"thead"))||t.length>1?(c.rowIndex=t[0],c[u]=t):1===t.length&&(c.data=c.data[0],c.row=c.row[0],c[d]=c[d][0],this.isAddRowsToSelection&&(c[u]=t))}else{c.rowIndex=c.rowIndex[c.rowIndex.length-1],c.data=c.data[c.data.length-1]}this.parent.trigger(e,Object(m.W)()&&!this.parent.isJsComponent||!this.parent.isFrozenGrid()?c:Object.assign({},c,{mRow:a,frozenRightRow:o}),(function(e){h.isCancelDeSelect=e.cancel,h.isCancelDeSelect&&(h.isRowClicked||h.checkSelectAllClicked)||(h.updatePersistCollection(n[0],!1),h.updateCheckBoxes(n[0],void 0,t[0]),a&&h.updateCheckBoxes(a[0],void 0,t[0]),o&&h.updateCheckBoxes(o[0],void 0,t[0])),void 0!==l&&l()}))}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==l&&l()}},{key:"getRowObj",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentIndex;return Object(m.X)(e)?{}:("number"==typeof e&&(e=this.parent.getRowByIndex(e)),e&&this.parent.getRowObjectFromUID(e.getAttribute("data-uid"))||{})}},{key:"getSelectedMovableCell",value:function(e){var t=this.parent,i=t.getColumnByIndex(e.cellIndex);return t.isFrozenGrid()&&"movable"===i.getFreezeTableName()?t.getMovableCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex)):null}},{key:"selectCell",value:function(e,t){if(this.isCellType()){var i,n=this.parent,r=this.getSelectedMovableCell(e);r||(r=n.getCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex))),this.currentIndex=e.rowIndex;var s=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isCellType()&&r&&!this.isEditing()){var a=r.classList.contains("e-cellselectionbackground");(t=t?!Object(m.ab)(this.prevCIdxs)&&e.rowIndex===this.prevCIdxs.rowIndex&&e.cellIndex===this.prevCIdxs.cellIndex&&a:t)?this.successCallBack(i,t,e,r,s)(i):(i={data:s,cellIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1},(!Object(m.W)()||this.parent.isJsComponent)&&(i.currentCell=r,i.previousRowCellIndex=this.prevECIdxs),this.parent.trigger("cellSelecting",this.fDataUpdate(i),this.successCallBack(i,t,e,r,s)),this.cellselected=!0)}}}},{key:"successCallBack",value:function(e,t,i,n,r){var s=this;return function(e){if((Object(m.X)(e)||!0!==e.cancel)&&(t||(e.currentCell=e.currentCell?e.currentCell:n),s.clearCell(),t||s.updateCellSelection(n,i.rowIndex,i.cellIndex),!t)){var a;!Object(m.W)()||s.parent.isJsComponent||s.parent.isHybrid?(a={data:r,cellIndex:i,currentCell:n,selectedRowCellIndex:s.selectedRowCellIndexes,previousRowCell:s.prevECIdxs?s.getCellIndex(s.prevECIdxs.rowIndex,s.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=s.prevECIdxs:a={data:r,cellIndex:i,selectedRowCellIndex:s.selectedRowCellIndexes},s.updateCellProps(i,i),s.onActionComplete(a,"cellSelected")}}}},{key:"getCellIndex",value:function(e,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(e,t):this.parent.getCellFromIndex(e,t)}},{key:"selectCellsByRange",value:function(e,t){var i=this;if(this.isCellType()){var n,r,s=this.parent,a=this.getSelectedMovableCell(e),l=s.getFrozenColumns();a||(a=s.getCellFromIndex(e.rowIndex,e.cellIndex));var o,h=e,c=t=t||e;this.currentIndex=e.rowIndex;var u=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){var d={data:u,cellIndex:e,currentCell:a,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};Object(m.W)()||(d.previousRowCellIndex=this.prevECIdxs),this.parent.trigger("cellSelecting",this.fDataUpdate(d),(function(d){if(Object(m.X)(d)||!0!==d.cancel){if(i.clearCell(),e.rowIndex>t.rowIndex){var p=e;e=t,t=p}for(var g=e.rowIndex;g<=t.rowIndex;g++){i.selectionSettings.cellSelectionMode.indexOf("Box")<0?(n=g===e.rowIndex?e.cellIndex:0,r=g===t.rowIndex?t.cellIndex:i.getLastColIndex(g)):(n=e.cellIndex,r=t.cellIndex),o=[];for(var f=n<r?n:r,v=n>r?n:r;f<=v;f++)(a=l?f<l?s.getCellFromIndex(g,f):s.getMovableCellFromIndex(g,f):s.getCellFromIndex(g,f))&&(o.push(f),i.updateCellSelection(a),i.addAttribute(a));i.selectedRowCellIndexes.push({rowIndex:g,cellIndexes:o})}var b;!Object(m.W)()||i.parent.isJsComponent||i.parent.isHybrid?(b={data:u,cellIndex:c,currentCell:s.getCellFromIndex(c.rowIndex,c.cellIndex),selectedRowCellIndex:i.selectedRowCellIndexes,previousRowCell:i.prevECIdxs?i.getCellIndex(i.prevECIdxs.rowIndex,i.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=i.prevECIdxs:b={data:u,cellIndex:c,selectedRowCellIndex:i.selectedRowCellIndexes},i.isDragged||(i.onActionComplete(b,"cellSelected"),i.cellselected=!0),i.updateCellProps(h,c)}}))}}}},{key:"selectCells",value:function(e){if(this.isCellType()){var t=this.parent,i=this.getSelectedMovableCell(e[0]),n=t.getFrozenColumns();i||(i=t.getCellFromIndex(e[0].rowIndex,e[0].cellIndexes[0])),this.currentIndex=e[0].rowIndex;var r,s,a=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(r={data:a,cellIndex:e[0].cellIndexes[0],currentCell:i,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:r={data:a,cellIndex:e[0].cellIndexes[0],isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(r,"cellSelecting");for(var l=0,o=e.length;l<o;l++)for(var h=0,c=e[l].cellIndexes.length;h<c;h++)(i=n?e[l].cellIndexes[h]<n?t.getCellFromIndex(e[l].rowIndex,e[l].cellIndexes[h]):t.getMovableCellFromIndex(e[l].rowIndex,e[l].cellIndexes[h]):t.getCellFromIndex(e[l].rowIndex,e[l].cellIndexes[h]))&&(this.updateCellSelection(i),this.addAttribute(i),this.addRowCellIndex({rowIndex:e[l].rowIndex,cellIndex:e[l].cellIndexes[h]}));this.updateCellProps({rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]},{rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]}),!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(s={data:a,cellIndex:e[0].cellIndexes[0],currentCell:i,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:s={data:a,cellIndex:e[0].cellIndexes[0],selectedRowCellIndex:this.selectedRowCellIndexes},this.onActionComplete(s,"cellSelected")}}}},{key:"addCellsToSelection",value:function(e){if(this.isCellType()){var t,i,n=this.parent;this.currentIndex=e[0].rowIndex;var r=this.getCurrentBatchRecordChanges()[this.currentIndex],s=n.getFrozenLeftCount(),a=n.getMovableColumnsCount();if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){this.hideAutoFill();var l,o=n.getColumnByIndex(e[0].cellIndex);Xi(this.parent,(function(t,i){l=i[e[0].rowIndex]}),[o.getFreezeTableName()&&"frozen-left"!==o.getFreezeTableName()?[]:n.getRowsObject(),"movable"===o.getFreezeTableName()?n.getMovableRowsObject():[],"frozen-right"===o.getFreezeTableName()?n.getFrozenRightRowsObject():[]]);var h,u=[],d=c(e);try{for(d.s();!(h=d.n()).done;){for(var p=h.value,g=0,f=this.selectedRowCellIndexes.length;g<f;g++)if(this.selectedRowCellIndexes[g].rowIndex===p.rowIndex){i=g;break}(t=this.getSelectedMovableCell(p))||(t=n.getCellFromIndex(p.rowIndex,this.getColIndex(p.rowIndex,p.cellIndex)));var v=void 0,b="movable"===o.getFreezeTableName()?p.cellIndex-s:"frozen-right"===o.getFreezeTableName()?p.cellIndex-(s+a):p.cellIndex;u.push(l.cells[b].foreignKeyData),!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(v={cancel:!1,data:r,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,currentCell:t,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?n.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:v={cancel:!1,data:r,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,isCtrlPressed:this.isMultiCtrlRequest};var y=i>-1;if(y){var C=this.selectedRowCellIndexes[i].cellIndexes;C.indexOf(p.cellIndex)>-1?(this.cellDeselect("cellDeselecting",[{rowIndex:p.rowIndex,cellIndexes:[p.cellIndex]}],r,[t],u),C.splice(C.indexOf(p.cellIndex),1),0===C.length&&this.selectedRowCellIndexes.splice(i,1),t.classList.remove("e-cellselectionbackground"),t.removeAttribute("aria-selected"),this.cellDeselect("cellDeselected",[{rowIndex:p.rowIndex,cellIndexes:[p.cellIndex]}],r,[t],u)):(y=!1,this.onActionBegin(v,"cellSelecting"),this.addRowCellIndex({rowIndex:p.rowIndex,cellIndex:p.cellIndex}),this.updateCellSelection(t),this.addAttribute(t))}else{if(this.onActionBegin(v,"cellSelecting"),!Object(m.X)(v)&&!0===v.cancel)return;this.updateCellSelection(t,p.rowIndex,p.cellIndex)}if(!y){var w=void 0;!Object(m.W)()||this.parent.isJsComponent||this.parent.isHybrid?(w={data:r,cellIndex:e[0],currentCell:t,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes}).previousRowCellIndex=this.prevECIdxs:w={data:r,cellIndex:e[0],selectedRowCellIndex:this.selectedRowCellIndexes},this.onActionComplete(w,"cellSelected"),this.cellselected=!0}this.updateCellProps(p,p)}}catch(k){d.e(k)}finally{d.f()}}}}},{key:"getColIndex",value:function(e,t){var i=this.parent.isFrozenGrid(),n=this.parent.getColumnByIndex(t),r=Yi(this.parent,n,e);if(r)for(var s=0;s<r.length;s++)if(parseInt(r[s].getAttribute("aria-colindex"),10)===t)return i&&("movable"===n.getFreezeTableName()?s+=this.parent.getFrozenLeftCount():"frozen-right"===n.getFreezeTableName()&&(s+=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount())),s;return-1}},{key:"getLastColIndex",value:function(e){var t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[e].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[e].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute("aria-colindex"),10)}},{key:"clearCell",value:function(){this.clearCellSelection()}},{key:"cellDeselect",value:function(e,t,i,n,r){n[0]&&n[0].classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(m.C)(n[0],"tr"));var s={cells:n,data:i,cellIndexes:t,foreignKeyData:r,cancel:!1};this.parent.trigger(e,s),this.isPreventCellSelect=s.cancel}},{key:"updateCellSelection",value:function(e,t,i){Object(m.X)(t)||this.addRowCellIndex({rowIndex:t,cellIndex:i}),e.classList.add("e-cellselectionbackground"),e.classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(m.C)(e,"tr"),!0),this.addAttribute(e)}},{key:"addAttribute",value:function(e){this.target=e,Object(m.X)(e)||(e.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:e},!0))}},{key:"updateCellProps",value:function(e,t){this.prevCIdxs=e,this.prevECIdxs=t,this.isCellSelected=this.selectedRowCellIndexes.length&&!0}},{key:"addRowCellIndex",value:function(e){for(var t,i,n=0,r=this.selectedRowCellIndexes.length;n<r;n++)if(this.selectedRowCellIndexes[n].rowIndex===e.rowIndex){t=!0,i=n;break}t?this.selectedRowCellIndexes[i].cellIndexes.indexOf(e.cellIndex)<0&&this.selectedRowCellIndexes[i].cellIndexes.push(e.cellIndex):this.selectedRowCellIndexes.push({rowIndex:e.rowIndex,cellIndexes:[e.cellIndex]})}},{key:"clearCellSelection",value:function(){if(this.isCellSelected){var e=this.parent,t=this.getSelectedCellsElement(),i=this.selectedRowCellIndexes,n=[],r=[],s=[],a=this.getCurrentBatchRecordChanges(),l=e.isFrozenGrid();this.hideAutoFill();for(var o=0,h=i.length;o<h;o++){n.push(a[i[o].rowIndex]);for(var c=this.getRowObj(i[o].rowIndex),u=0,d=i[o].cellIndexes.length;u<d;u++)if(l){var p=e.getColumnByIndex(i[o].cellIndexes[u]);r.push(_i(this.parent,p,i[o].rowIndex,i[o].cellIndexes[u]))}else c.cells&&s.push(c.cells[i[o].cellIndexes[u]].foreignKeyData),r.push(e.getCellFromIndex(i[o].rowIndex,i[o].cellIndexes[u]))}if(this.cellDeselect("cellDeselecting",i,n,r,s),!0===this.isPreventCellSelect)return;for(var g=0,f=t.length;g<f;g++)t[g].classList.remove("e-cellselectionbackground"),t[g].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none"),this.selectedRowCellIndexes=[],this.isCellSelected=!1,!this.isDragged&&this.cellselected&&this.cellDeselect("cellDeselected",i,n,r,s)}}},{key:"getSelectedCellsElement",value:function(){var e,t=this.parent,i=t.getDataRows();t.isFrozenGrid()&&(e=t.getMovableDataRows(),i=t.addMovableRows(i,e),"Left-Right"===t.getFrozenMode()&&(i=t.addMovableRows(i,t.getFrozenRightDataRows())));for(var n=[],r=0,s=i.length;r<s;r++)n=n.concat([].slice.call(i[r].querySelectorAll(".e-cellselectionbackground")));return n}},{key:"mouseMoveHandler",value:function(e){e.preventDefault();var t,i=this.parent.element.getBoundingClientRect(),n=this.x,r=this.y,s=Yt(e),a=s.x-i.left,l=s.y-i.top,o=Object(m.C)(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(o||(o=Object(m.C)(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),n>a&&(t=a,a=n,n=t),r>l&&(t=l,l=r,r=t),this.element.style.left=n+"px",this.element.style.top=r+"px",this.element.style.width=a-n+"px",this.element.style.height=l-r+"px"),o&&!e.ctrlKey&&!e.shiftKey){var h=parseInt(o.getAttribute("aria-rowindex"),10);if(this.isCellDrag){var c=Wt(e.target,"e-rowcell");c&&(this.startAFCell=this.startCell,this.endAFCell=Wt(e.target,"e-rowcell"),this.selectLikeExcel(e,h,parseInt(c.getAttribute("aria-colindex"),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,h)}}},{key:"selectLikeExcel",value:function(e,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())}},{key:"drawBorders",value:function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")}},{key:"isLastCell",value:function(e){var t=[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===e}},{key:"isLastRow",value:function(e){var t=[].slice.call(Object(m.C)(e,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[t.length-1]}},{key:"isFirstRow",value:function(e){var t=[].slice.call(Object(m.C)(e,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[0]}},{key:"isFirstCell",value:function(e){return[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===e}},{key:"setBorders",value:function(e,t,i){var n=[].slice.call(e.querySelectorAll(".e-cellselectionbackground")).filter((function(e){return""===e.style.display}));if(n.length){var r=this.parent.isFrozenGrid(),s=n[0],a=n[n.length-1],l=s.getBoundingClientRect(),o=a.getBoundingClientRect(),h=s.offsetParent.getBoundingClientRect(),c=!this.isLastRow(a)||"1"!==i&&"2"!==i&&"5"!==i?0:2,u=this.parent.frozenRows&&("1"===i||"2"===i)&&this.isFirstRow(s)?1.5:0,d=r&&("2"===i||"4"===i)&&this.isFirstCell(s)?1:0,p=("Right"!==this.parent.getFrozenMode()||"1"!==i&&"3"!==i)&&("Left-Right"!==this.parent.getFrozenMode()||"5"!==i&&"6"!==i)||!this.isFirstCell(s)?0:1;this.parent.enableRtl?(t.style.right=h.right-l.right-d+"px",t.style.width=l.right-o.left+d+1+"px"):(t.style.left=l.left-h.left-d-p+"px",t.style.width=o.right-l.left+d-p+1+"px"),t.style.top=l.top-h.top-u+"px",t.style.height=o.top-l.top>0?o.top-h.top+o.height+1-(l.top-h.top)-c+u+"px":o.height+u-c+1+"px",this.selectDirection+=i}else t.style.display="none"}},{key:"positionBorders",value:function(){this.updateStartEndCells(),this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),"Left-Right"===this.parent.getFrozenMode()&&this.setBorders(this.parent.contentModule.getFrozenRightContent(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4"),"Left-Right"===this.parent.getFrozenMode()&&this.setBorders(this.parent.headerModule.getFrozenRightHeader(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))}},{key:"applyBothFrozenBorders",value:function(e){var t=this.parent.enableRtl;switch(e.length){case 6:this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth="0 0 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth="2px 0 0 0",this.frcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.frhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0";break;case 4:e.includes("1")&&e.includes("2")&&e.includes("3")&&e.includes("4")&&(this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0"),e.includes("2")&&e.includes("4")&&e.includes("5")&&e.includes("6")&&(this.mcBdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.frcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.frhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0");break;case 3:this.bdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.mcBdrElement.style.borderWidth="2p 0 2px 0",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.mhBdrElement.style.borderWidth="2px 0 2px 0",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0");break;case 2:e.includes("1")&&(this.mcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("2")&&(this.bdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frcBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("3")&&(this.mhBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.bdrElement.style.borderWidth="0 2px 2px 2px"),e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frhBdrElement.style.borderWidth=t?"2px 0 2px 2px":"2px 2px 2px 0",this.mcBdrElement.style.borderWidth="0 2px 2px 2px"),e.includes("5")&&(this.mcBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth="2px 2px 0 2px")),e.includes("6")&&(this.mhBdrElement.style.borderWidth=t?"2px 2px 2px 0":"2px 0 2px 2px",this.frcBdrElement.style.borderWidth="0 2px 2px 2px");break;default:this.bdrElement.style.borderWidth="2px",this.mcBdrElement.style.borderWidth="2px",this.frcBdrElement.style.borderWidth="2px",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px",this.mhBdrElement.style.borderWidth="2px",this.frhBdrElement.style.borderWidth="2px")}}},{key:"applyBorders",value:function(e){var t=this.parent.enableRtl;if("Left-Right"===this.parent.getFrozenMode())this.applyBothFrozenBorders(e);else switch(e.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.mcBdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.fhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0",this.mhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px"):(this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px",this.mcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0",this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px",this.mhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0");break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=e.includes("2")?t?"2px 0 2px 2px":"2px 2px 2px 0":"0 2px 2px 2px",this.mcBdrElement.style.borderWidth=e.includes("1")?t?"2px 2px 2px 0":"2px 0 2px 2px":"0 2px 2px 2px",this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?"2px 2px 0 2px":t?"2px 0 2px 2px":"2px 2px 2px 0",this.mhBdrElement.style.borderWidth=e.includes("2")?"2px 2px 0 2px":t?"2px 2px 2px 0":"2px 0 2px 2px")):(this.bdrElement.style.borderWidth=e.includes("2")?t?"2px 2px 2px 0":"2px 0 2px 2px":"0 2px 2px 2px",this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=e.includes("1")?t?"2px 0 2px 2px":"2px 2px 2px 0":"0 2px 2px 2px"),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?"2px 2px 0 2px":t?"2px 2px 2px 0":"2px 0 2px 2px",this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=e.includes("2")?"2px 2px 0 2px":t?"2px 0 2px 2px":"2px 2px 2px 0")));break;default:this.bdrElement.style.borderWidth="2px",this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth="2px"),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px",this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth="2px"))}}},{key:"createBorders",value:function(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),"Left-Right"===this.parent.getFrozenMode()&&(this.frcBdrElement=this.parent.contentModule.getFrozenRightContent().appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),"Left-Right"===this.parent.getFrozenMode()&&(this.frhBdrElement=this.parent.headerModule.getFrozenRightHeader().appendChild(Object(m.F)("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))}},{key:"showHideBorders",value:function(e){this.bdrElement&&(this.bdrElement.style.display=e,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.display=e,"Left-Right"===this.parent.getFrozenMode()&&(this.frcBdrElement.style.display=e)),this.parent.frozenRows&&(this.fhBdrElement.style.display=e),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement.style.display=e,"Left-Right"===this.parent.getFrozenMode()&&(this.frhBdrElement.style.display=e)))}},{key:"drawAFBorders",value:function(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()}},{key:"positionAFBorders",value:function(){if(this.startCell&&this.bdrAFLeft){var e=this.startAFCell.getBoundingClientRect(),t=this.endAFCell.getBoundingClientRect(),i=t.top-e.top>0?1:0,n=t.top-e.top>=0&&(Wt(this.startAFCell,"e-movablecontent")||Wt(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,r=(Wt(this.startAFCell,"e-movablecontent")||Wt(this.startAFCell,"e-movableheader"))&&this.isFirstCell(this.startAFCell)?1:0,s=this.isLastRow(this.endAFCell)&&(Wt(this.endAFCell,"e-movablecontent")||Wt(this.endAFCell,"e-frozencontent"))?2:0,a=this.startAFCell.offsetParent.getBoundingClientRect(),l=this.parent.element.getBoundingClientRect(),o=this.startAFCell.offsetParent.parentElement.scrollTop-this.startAFCell.offsetTop,h=this.startAFCell.offsetParent.parentElement.scrollLeft-this.startAFCell.offsetLeft,c=this.parent.element.clientHeight,u=this.parent.element.clientWidth;o=o>0?Math.floor(o)-1:0,h=h>0?h:0;var d=e.left-l.left;if(this.parent.enableRtl){var p=Wt(this.startAFCell,"e-movablecontent")||Wt(this.startAFCell,"e-movableheader")?e.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-l.left:0;this.bdrAFLeft.style.right=l.right-t.right-2+t.width+"px",this.bdrAFLeft.style.width=u<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=l.right-e.right-r+p-1+"px",this.bdrAFTop.style.left=t.left-l.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-r+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")}else if(this.bdrAFLeft.style.left=d-r+h-1+"px",this.bdrAFRight.style.left=t.left-l.left-2+t.width+"px",this.bdrAFRight.style.width=u<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=d+h-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-r+1+"px",u<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)){var g=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-u;this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-g+"px"}if(this.bdrAFLeft.style.top=e.top-l.top-n+o+"px",this.bdrAFLeft.style.height=t.top-e.top>0?t.top-a.top+t.height+1-(e.top-a.top)+n-s-o+"px":t.height+n-s-o+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-i-1+"px",this.bdrAFBottom.style.width=c<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,c<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)){var f=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-c;this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-f+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px"}}}},{key:"createAFBorders",value:function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(Object(m.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(Object(m.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(Object(m.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(Object(m.F)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))}},{key:"showAFBorders",value:function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")}},{key:"hideAFBorders",value:function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")}},{key:"updateValue",value:function(e,t,i){var n=this.createBeforeAutoFill(e,t,i);if(!n.cancel){var r=this.parent.getColumnByIndex(t);this.parent.editModule&&i&&this.parent.editModule.updateCell(e,r.field,"number"===r.type?parseInt(n.value,10):n.value)}}},{key:"createBeforeAutoFill",value:function(e,t,i){var n={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger("beforeAutoFill",n),n}},{key:"getAutoFillCells",value:function(e,t){var i=".e-cellselectionbackground",n=[].slice.call(this.parent.getDataRows()[e].querySelectorAll(i));return this.parent.isFrozenGrid()&&(n=n.concat([].slice.call(this.parent.getMovableDataRows()[e].querySelectorAll(i))),"Left-Right"===this.parent.getFrozenMode()&&(n=n.concat([].slice.call(this.parent.getFrozenRightDataRows()[e].querySelectorAll(i))))),n}},{key:"selectLikeAutoFill",value:function(e,t){var i=parseInt(Wt(this.startAFCell,"e-row").getAttribute("aria-rowindex"),10),n=parseInt(this.startAFCell.getAttribute("aria-colindex"),10),r=parseInt(Wt(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),s=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),a=this.selectedRowCellIndexes.length-1,l=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!Wt(e.target,"e-rowcell"):this.startAFCell=this.parent.getCellFromIndex(i,n),this.endAFCell=this.parent.getCellFromIndex(i+a,n+l),this.drawAFBorders();break;case this.autoFillRLselection&&n+l<s&&s-n-l+1>r-i-a&&s-n-l+1>i-r:if(this.endAFCell=this.parent.getCellFromIndex(i+a,s),r=parseInt(Wt(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),s=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),t){for(var o=parseInt(this.endCell.getAttribute("aria-colindex"),10),h=i;h<=r;h++)for(var c=this.getAutoFillCells(h,n),u=0,d=o+1;d<=s;d++)u>l&&(u=0),this.updateValue(h,d,c[u]),u++;this.selectCellsByRange({rowIndex:i,cellIndex:this.startCellIndex},{rowIndex:r,cellIndex:s})}else this.drawAFBorders();break;case this.autoFillRLselection&&n>s&&n-s+1>r-i-a&&n-s+1>i-r:if(this.startAFCell=this.parent.getCellFromIndex(i,s),this.endAFCell=this.endCell,t){for(var p=i;p<=i+a;p++){var g=this.getAutoFillCells(p,n);g.reverse();for(var f=0,m=this.startCellIndex-1;m>=s;m--)f>l&&(f=0),this.updateValue(p,m,g[f]),f++}this.selectCellsByRange({rowIndex:i,cellIndex:s},{rowIndex:i+a,cellIndex:this.startCellIndex+l})}else this.drawAFBorders();break;case i>r:if(this.startAFCell=this.parent.getCellFromIndex(r,n),this.endAFCell=this.endCell,t){for(var v=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),b=v,y=i-1;y>=r;y--){b===this.startIndex-1&&(b=v);var C=this.getAutoFillCells(b,n),w=0;b--;for(var k=this.startCellIndex;k<=this.startCellIndex+l;k++)this.updateValue(y,k,C[w]),w++}this.selectCellsByRange({rowIndex:r,cellIndex:n+l},{rowIndex:i+a,cellIndex:n})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(r,n+l),t){for(var S=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),O=this.startIndex,x=S+1;x<=r;x++){O===S+1&&(O=this.startIndex);var j=this.getAutoFillCells(O,n);O++;for(var R=0,D=this.startCellIndex;D<=this.startCellIndex+l;D++)this.updateValue(x,D,j[R]),R++}this.selectCellsByRange({rowIndex:S-a,cellIndex:n},{rowIndex:r,cellIndex:n+l})}else this.drawAFBorders()}}},{key:"mouseUpHandler",value:function(e){if(document.body.classList.remove("e-disableuserselect"),this.element&&Object(m.hb)(this.element),this.mUPTarget=this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?Wt(e.target,"e-rowcell"):null,this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode){var t=e.target,i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),n=parseInt(t.getAttribute("aria-colindex"),10);this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:i,cellIndex:n})}if(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel){var r=Wt(e.target,"e-rowcell");this.endAFCell=r||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1}m.l.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),this.parent.frozenRows&&m.l.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler),m.l.remove(document.body,"mouseup",this.mouseUpHandler)}},{key:"hideAutoFill",value:function(){this.autofill&&(this.autofill.style.display="none")}},{key:"updateAutoFillPosition",value:function(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var e=parseInt(this.target.getAttribute("aria-colindex"),10),t=parseInt(this.target.getAttribute("index"),10),i=this.getAutoFillCells(this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,e).filter((function(e){return""===e.style.display})),n=this.parent.getColumnByIndex(e),r="movable"===n.getFreezeTableName(),s=t<this.parent.frozenRows,a="Left-Right"===this.parent.getFrozenMode()&&"frozen-right"===n.getFreezeTableName();Object(m.lb)("#"+this.parent.element.id+"_autofill",Wt(this.target,"e-table"))||(Object(m.lb)("#"+this.parent.element.id+"_autofill",this.parent.element)&&Object(m.lb)("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=Object(m.F)("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",s?r?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):r?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),a&&(s?this.parent.getFrozenRightHeader().appendChild(this.autofill):this.parent.getFrozenRightContent().appendChild(this.autofill)));var l=i[i.length-1];if(l&&l.offsetParent){var o=l.getBoundingClientRect(),h=l.offsetParent.getBoundingClientRect(),c=this.isLastCell(l)?4:0,u=this.isLastRow(l)?3:0;this.parent.enableRtl?this.autofill.style.right=h.right-o.right+o.width-4-c+"px":this.autofill.style.left=o.left-h.left+o.width-4-c+"px",this.autofill.style.top=o.top-h.top+o.height-5-u+"px"}this.autofill.style.display=""}else this.hideAutoFill()}},{key:"mouseDownHandler",value:function(e){this.mouseButton=e.button;var t,i=e.target,n=this.parent,r=Wt(i,"e-grid");if(!(r&&r.id!==n.element.id||Wt(i,"e-headercontent")&&!this.parent.frozenRows||Wt(i,"e-editedbatchcell")||Wt(i,"e-editedrow"))){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),Wt(i,"e-rowcell")&&!e.shiftKey&&!e.ctrlKey){if(n.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,t=!0;else if(n.allowRowDragAndDrop&&!n.isEdit){if(!this.isRowType()||this.isSingleSel()||Object(m.C)(i,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);t=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),n.getContent().appendChild(this.element)}t&&this.enableDrag(e,!0)}this.updateStartEndCells(),(i.classList.contains("e-autofill")||i.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}}},{key:"updateStartEndCells",value:function(){var e=[].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground"));this.startCell=e[0],this.endCell=e[e.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(Wt(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}},{key:"updateStartCellsIndex",value:function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(Wt(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))}},{key:"enableDrag",value:function(e,t){var i=this.parent;if(t){var n=Object(m.C)(e.target,"tr");this.startDIndex=parseInt(n.getAttribute("aria-rowindex"),10),this.startDCellIndex=parseInt(Wt(e.target,"e-rowcell").getAttribute("aria-colindex"),10)}document.body.classList.add("e-disableuserselect");var r=i.element.getBoundingClientRect(),s=Yt(e);this.x=s.x-r.left,this.y=s.y-r.top,m.l.add(i.getContent(),"mousemove",this.mouseMoveHandler,this),this.parent.frozenRows&&m.l.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this),m.l.add(document.body,"mouseup",this.mouseUpHandler,this)}},{key:"clearSelAfterRefresh",value:function(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType||this.clearSelection()}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(z,this.enableAfterRender,this),this.parent.on(F,this.initializeSelection,this),this.parent.on("rowselected",this.onActionComplete,this),this.parent.on("cellselected",this.onActionComplete,this),this.parent.on(B,this.onPropertyChanged,this),this.parent.on("cellfocused",this.onCellFocused,this),this.parent.on("beforeFragAppend",this.clearSelAfterRefresh,this),this.parent.on("column-position-changed",this.columnPositionChanged,this),this.parent.on(A,this.initialEnd,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(D,this.actionBeginFunction),this.parent.addEventListener(E,this.actionCompleteFunction),this.parent.on("rows-removed",this.rowsRemoved,this),this.parent.on(q,this.refreshHeader,this),this.addEventListener_checkbox())}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(z,this.enableAfterRender),this.parent.off(F,this.initializeSelection),this.parent.off("rowselected",this.onActionComplete),this.parent.off("cellselected",this.onActionComplete),this.parent.off(B,this.onPropertyChanged),this.parent.off("cellfocused",this.onCellFocused),this.parent.off("beforeFragAppend",this.clearSelAfterRefresh),this.parent.off("column-position-changed",this.columnPositionChanged),this.parent.removeEventListener(D,this.actionBeginFunction),this.parent.removeEventListener(E,this.actionCompleteFunction),this.parent.off("rows-removed",this.rowsRemoved),this.parent.off(q,this.refreshHeader),this.removeEventListener_checkbox())}},{key:"wireEvents",value:function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS&&(m.l.add(this.parent.element,"keydown",this.keyDownHandler,this),m.l.add(this.parent.element,"keyup",this.keyUpHandler,this))}},{key:"unWireEvents",value:function(){this.isMacOS&&(m.l.remove(this.parent.element,"keydown",this.keyDownHandler),m.l.remove(this.parent.element,"keyup",this.keyUpHandler))}},{key:"columnPositionChanged",value:function(){this.parent.isPersistSelection||this.clearSelection()}},{key:"refreshHeader",value:function(){this.setCheckAllState()}},{key:"rowsRemoved",value:function(e){for(var t=0;t<e.records.length;t++)delete this.selectedRowState[e.records[t][this.primaryKey]],--this.totalRecordsCount;this.setCheckAllState()}},{key:"beforeFragAppend",value:function(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()}},{key:"getCheckAllBox",value:function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.initPerisistSelection())}},{key:"render",value:function(e){m.l.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this),m.l.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName()){var t=this.parent;Object(m.X)(e.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()),Object(m.X)(e.properties.mode)&&Object(m.X)(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.initPerisistSelection(),this.parent.getColumns().filter((function(e){return"checkbox"===e.type})).length&&(t.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode)),this.drawBorders()}}},{key:"hidePopUp",value:function(){this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")}},{key:"initialEnd",value:function(e){var t=this.parent.isFrozenGrid(),i="Left-Right"===this.parent.getFrozenMode();(!t||t&&!i&&!e.args.isFrozen||i&&e.args.renderFrozenRightContent)&&(this.parent.off(A,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))}},{key:"checkBoxSelectionChanged",value:function(){this.parent.off(A,this.checkBoxSelectionChanged);var e=this.parent,t=e.getColumns().filter((function(e){return"checkbox"===e.type}));t.length>0&&(e.isCheckBoxSelection=!0,this.chkField=t[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,Object(m.X)(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(e.selectionSettings.type="Multiple",e.dataBind()):this.initPerisistSelection()),e.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())}},{key:"initPerisistSelection",value:function(){var e=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(e.isPersistSelection=!1,this.selectedRowState={})}},{key:"ensureCheckboxFieldSelection",value:function(){var e=this.parent;if(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!e.enableVirtualization&&this.chkField&&(e.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!e.isPersistSelection)){var t=this.parent.getDataModule(),i=(new v.g).where(this.chkField,"equal",!0);i.params||(i.params=this.parent.query.params);var n=t.getData({},i),r=this;this.parent.showSpinner(),n.then((function(e){r.dataSuccess(e.result),r.refreshPersistSelection(),r.parent.hideSpinner()}))}}},{key:"dataSuccess",value:function(e){for(var t=0;t<e.length;t++)Object(m.X)(this.selectedRowState[e[t][this.primaryKey]])&&e[t][this.chkField]&&(this.selectedRowState[e[t][this.primaryKey]]=e[t][this.chkField]);this.persistSelectedData=e}},{key:"setRowSelection",value:function(e){if(!this.parent.getDataModule().isRemote()&&!Object(m.W)())if(e)if(this.parent.groupSettings.columns.length){var t,i=c(this.getData().records);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.selectedRowState[n[this.primaryKey]]=!0}}catch(l){i.e(l)}finally{i.f()}}else{var r,s=c(this.getData());try{for(s.s();!(r=s.n()).done;){var a=r.value;this.selectedRowState[a[this.primaryKey]]=!0}}catch(l){s.e(l)}finally{s.f()}}else this.selectedRowState={}}},{key:"getData",value:function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))}},{key:"refreshPersistSelection",value:function(){var e=this.parent.getRows();if(this.parent.isCheckBoxSelection&&this.parent.isFrozenGrid()&&(this.parent.getMovableContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getMovableRows()),"Left-Right"===this.parent.getFrozenMode()&&this.parent.getFrozenRightContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getFrozenRightRows())),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,null!==e&&e.length>0&&(this.parent.isPersistSelection||this.chkField)){for(var t=[],i=0;i<e.length;i++){var n=void 0,r=this.getRowObj(e[i]),s=r&&r.data?r.data[this.primaryKey]:null;if(null===s)return;var a=e[i].querySelector(".e-checkselect");this.selectedRowState[s]||"Check"===this.parent.checkAllRows&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(s)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(s)>0||"Intermediate"===this.parent.checkAllRows&&!Object(m.X)(this.chkField)&&r.data[this.chkField]?(t.push(parseInt(e[i].getAttribute("aria-rowindex"),10)),n=!0):(n=!1,this.checkedTarget!==a&&this.parent.isCheckBoxSelection&&vi(a.nextElementSibling,n)),this.updatePersistCollection(e[i],n)}this.isSingleSel()&&t.length>0?this.selectRow(t[0],!0):this.selectRows(t)}this.parent.isCheckBoxSelection&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()}},{key:"actionBegin",value:function(e){if("save"===e.requestType&&this.parent.isPersistSelection){var t=this.parent.element.querySelector(".e-edit-checkselect");if(!Object(m.X)(t)){var i=Object(m.C)(t,".e-editedrow");if(i){"Dialog"===this.parent.editSettings.mode&&(i=this.parent.element.querySelector(".e-dlgeditrow"));var n=this.getRowObj(i);if(!n)return;this.selectedRowState[n.data[this.primaryKey]]=n.isSelected=t.checked}else this.isCheckedOnAdd=t.checked}}}},{key:"actionComplete",value:function(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action&&this.isCheckedOnAdd){var t=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[t.data[this.primaryKey]]=t.isSelected=this.isCheckedOnAdd}this.refreshPersistSelection()}if("delete"===e.requestType&&this.parent.isPersistSelection){for(var i=(Object(m.W)()?this.getSelectedRecords():e.data).slice(),n=0;n<i.length;n++)Object(m.X)(i[n][this.primaryKey])||this.updatePersistDelete(i[n][this.primaryKey]);this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}"paging"===e.requestType&&(this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0)}},{key:"onDataBound",value:function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.refreshPersistSelection(),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var e=this.parent.getRowsObject(),t=[],i=0;i<e.length;i++)e[i].isSelected&&t.push(i);t.length&&this.selectRows(t),this.initialRowSelection=!0}}},{key:"updatePersistSelectedData",value:function(e){if(this.parent.isPersistSelection){for(var t=this.parent.getRows(),i=0;i<t.length;i++)this.updatePersistCollection(t[i],e);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||Object(m.W)()?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}}},{key:"checkSelectAllAction",value:function(e){var t=this.getRenderer(),i=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),e&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(e),Object(m.W)()&&this.parent.enableVirtualization&&!Object(m.X)(this.parent.contentModule.currentInfo.endIndex)?this.selectRowsByRange(this.parent.contentModule.currentInfo.startIndex,this.parent.contentModule.currentInfo.endIndex):this.selectRowsByRange(t.getVirtualRowIndex(0),t.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(e),this.clearSelection()),this.chkAllCollec=[],!Object(m.X)(i)){var n=i.querySelector(".e-edit-checkselect");Object(m.X)(n)||vi(n.nextElementSibling,e)}}},{key:"checkSelectAll",value:function(e){var t=this,i=this.getCheckAllStatus(e),n="Check"===i;if(this.isHeaderCheckboxClicked=!0,"Intermediate"===i&&(n=this.getCurrentBatchRecordChanges().some((function(e){return e[t.primaryKey]in t.selectedRowState}))),this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!n),Object(m.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&(this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!n,"checkbox",null),this.checkBoxState=!n,!n)){var r=this.parent.contentModule.vgenerator.rowCache;Object.values(r).forEach((function(e){return e.isSelected=!0}));for(var s=0;s<Object.keys(r).length;s++)-1===this.parent.selectionModule.selectedRowIndexes.indexOf(Number(Object.keys(r)[s]))&&this.parent.selectionModule.selectedRowIndexes.push(Number(Object.keys(r)[s]))}this.target=null,this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState(),this.triggerChkChangeEvent(e,!n)}},{key:"getCheckAllStatus",value:function(e){var t=e?e.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t.contains("e-check")?"Check":t.contains("e-uncheck")?"Uncheck":t.contains("e-stop")?"Intermediate":"None"}},{key:"checkSelect",value:function(e){var t=Object(m.C)(this.checkedTarget,".e-rowcell"),i=this.parent;this.isMultiCtrlRequest=!0;var n=0;if(this.isHeaderCheckboxClicked=!1,Si(i)){var r=t.parentElement.getAttribute("data-uid");n=i.getRows().map((function(e){return e.getAttribute("data-uid")})).indexOf(r)}else n=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&"Top"===this.parent.editSettings.newRowPosition&&++n,this.rowCellSelectionHandler(n,parseInt(t.getAttribute("aria-colindex"),10)),this.moveIntoUncheckCollection(Object(m.C)(t,".e-row")),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(e,e.nextElementSibling.classList.contains("e-check"))}},{key:"moveIntoUncheckCollection",value:function(e){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var t=this.getRowObj(e),i=t&&t.data?t.data[this.primaryKey]:null;if(!i)return;this.chkAllCollec.indexOf(i)<0?this.chkAllCollec.push(i):this.chkAllCollec.splice(this.chkAllCollec.indexOf(i),1)}}},{key:"triggerChkChangeEvent",value:function(e,t){this.parent.trigger("checkBoxChange",{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:e}),this.parent.isEdit||(this.checkedTarget=null)}},{key:"updateSelectedRowIndex",value:function(e){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.getDataModule().isRemote()&&(!Object(m.W)()||!this.parent.isServerRendered))if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];for(var t=this.getData().length,i=0;i<t;i++)this.selectedRowIndexes.push(i)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else if(e&&"false"===this.parent.getRowByIndex(e).getAttribute("aria-selected")){var n=this.selectedRowIndexes.indexOf(e);this.selectedRowIndexes.splice(n,1)}}},{key:"setCheckAllState",value:function(e,t){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){var i,n=Object(m.W)()&&this.parent.isServerRendered&&this.parent.enableVirtualization;if(n){i=!Object.values(this.parent.contentModule.vgenerator.rowCache).filter((function(e){return void 0===e.isSelected||!1===e.isSelected})).length&&Object.values(this.parent.contentModule.vgenerator.rowCache).filter((function(e){return e.isSelected})).length===this.selectedRowIndexes.length}var r=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||n||(r=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length);var s=this.getCheckAllBox();if(s){var a=s.nextElementSibling;Object(m.ib)([a],["e-check","e-stop","e-uncheck"]),fi(s,!1),s.indeterminate=!1,i||r===this.totalRecordsCount&&this.totalRecordsCount||!(!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||Object(m.W)()&&this.parent.isServerRendered||r!==this.getData().length)?(Object(m.v)([a],["e-check"]),fi(s,!0),t&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):n&&!this.selectedRowIndexes.length||0===r&&!n||0===this.getCurrentBatchRecordChanges().length?(Object(m.v)([a],["e-uncheck"]),t&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck",0===r&&0===this.getCurrentBatchRecordChanges().length?Object(m.v)([a.parentElement],["e-checkbox-disabled"]):Object(m.ib)([a.parentElement],["e-checkbox-disabled"])):(Object(m.v)([a],["e-stop"]),this.parent.checkAllRows="Intermediate",s.indeterminate=!0),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||this.updateSelectedRowIndex(e)}}}},{key:"keyDownHandler",value:function(e){(("chrome"===m.d.info.name||"safari"===m.d.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===m.d.info.name&&17===e.keyCode||"mozilla"===m.d.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0)}},{key:"keyUpHandler",value:function(e){(("chrome"===m.d.info.name||"safari"===m.d.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===m.d.info.name&&17===e.keyCode||"mozilla"===m.d.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!1)}},{key:"clickHandler",value:function(e){var t=e.target;this.actualTarget=t,(Wt(t,"e-row")||Wt(t,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&t.classList.contains("e-headercell"))&&(this.isInteracted=!0),this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.isMultiShiftRequest=e.shiftKey,this.popUpClickHandler(e);var i,n=!1;this.preventFocus=!0;var r=Wt(t,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!!(r&&r.querySelectorAll(".e-checkselectall")||this.selectionSettings.persistSelection&&Wt(t,"e-row")),r&&r.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(i=r.querySelector('input[type="checkbox"]'),n=!0),this.drawBorders(),this.updateAutoFillPosition(),(t=Wt(t,"e-rowcell"))&&t.parentElement.classList.contains("e-row")&&!this.parent.selectionSettings.checkboxOnly||n){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=t,Object(m.X)(i)){var s=this.parent,a=0;if(Si(s)){var l=t.parentElement.getAttribute("data-uid");a=s.getRows().map((function(e){return e.getAttribute("data-uid")})).indexOf(l)}else a=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&++a,this.mUPTarget&&this.mUPTarget.isEqualNode(t)||this.rowCellSelectionHandler(a,parseInt(t.getAttribute("aria-colindex"),10)),this.parent.hoverFrozenRows(e),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(Object(m.C)(t,".e-row")),this.setCheckAllState())}else this.checkedTarget=i,i.classList.contains("e-checkselectall")?this.checkSelectAll(i):this.checkSelect(i);this.parent.isCheckBoxSelection||!m.d.isDevice||this.isSingleSel()||this.showPopup(e)}else if(e.target.classList.contains("e-headercell")&&!e.target.classList.contains("e-stackedheadercell")){var o=e.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");this.headerSelectionHandler(this.parent.getColumnIndexByUid(o))}this.isMultiCtrlRequest=!1,this.isMultiShiftRequest=!1,Object(m.X)(Object(m.C)(e.target,".e-unboundcell"))&&(this.preventFocus=!1)}},{key:"popUpClickHandler",value:function(e){var t=e.target;Object(m.C)(t,".e-headercell")||e.target.classList.contains("e-rowcell")||Object(m.C)(t,".e-gridpopup")?t.classList.contains("e-rowselect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}},{key:"showPopup",value:function(e){this.selectionSettings.enableSimpleMultiRowSelection||Ht(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))}},{key:"rowCellSelectionHandler",value:function(e,t){if(!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel())this.isDragged||this.selectRow(e,this.selectionSettings.enableToggle),this.selectCell({rowIndex:e,cellIndex:t},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders();else if(this.isMultiShiftRequest)this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!Object(m.C)(this.target,".e-rowcell").classList.contains("e-gridchkbox")?this.selectRowsByRange(Object(m.ab)(this.prevRowIndex)?e:this.prevRowIndex,e):this.addRowsToSelection([e]),this.selectCellsByRange(Object(m.ab)(this.prevCIdxs)?{rowIndex:e,cellIndex:t}:this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.updateAutoFillPosition(),this.drawBorders();else{if(this.addRowsToSelection([e]),Object(m.W)()&&this.parent.enableVirtualization&&this.parent.isServerRendered){var i=this.parent.getSelectedRowIndexes();this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",i)}this.addCellsToSelection([{rowIndex:e,cellIndex:t}]),this.showHideBorders("none")}this.isDragged=!1}},{key:"onCellFocused",value:function(t){if(this.parent.frozenRows&&t.container.isHeader&&t.byKey)if("upArrow"===t.keyArgs.action)t.isJump=this.parent.allowFiltering?"INPUT"===t.element.tagName:"TH"===t.element.tagName;else if("downArrow"===t.keyArgs.action){var i=Number(t.element.parentElement.getAttribute("aria-rowindex"));t.isJump=0===i}else"ctrlHome"===t.keyArgs.action&&(t.isJump=!0);var n=this.parent.isFrozenGrid()?(t.container.isHeader&&"TD"!==t.element.tagName&&t.isJump&&!this.selectionSettings.allowColumnSelection||(t.container.isContent||"TD"===t.element.tagName)&&!(t.container.isSelectable||"TD"===t.element.tagName))&&!(t.byKey&&"space"===t.keyArgs.action):(t.container.isHeader&&t.isJump||t.container.isContent&&!t.container.isSelectable)&&!(t.byKey&&"space"===t.keyArgs.action)&&!(t.element.classList.contains("e-detailrowexpand")||t.element.classList.contains("e-detailrowcollapse")),r=t.container.isHeader&&"TD"!==t.element.tagName&&!Object(m.C)(t.element,".e-rowcell")&&!(t.byKey&&"space"===t.keyArgs.action);if(t.byKey&&!n){var s=e(t.container.isContent?t.container.indexes:t.indexes,2),a=s[0],l=s[1],o=this.focus.getPrevIndexes();if(this.parent.frozenRows)if(t.container.isHeader&&("TD"===t.element.tagName||Object(m.C)(t.element,".e-rowcell"))){var h=this.parent.getHeaderTable().querySelector("thead").childElementCount;a-=h,o.rowIndex=Object(m.X)(o.rowIndex)?null:o.rowIndex-h}else a+=this.parent.frozenRows,o.rowIndex=0!==o.rowIndex&&Object(m.X)(o.rowIndex)?null:o.rowIndex+this.parent.frozenRows;if(this.parent.isFrozenGrid()){var c=Number(t.element.getAttribute("aria-colindex")),u=this.parent.getSelectedRowCellIndexes();u.length&&0===o.cellIndex&&(o.cellIndex=u[u.length-1].cellIndexes[0]),o.cellIndex=Object(m.X)(o.cellIndex)?null:o.cellIndex===l?c:c-1,l=c}if(!(r||-1===["ctrlPlusA","escape"].indexOf(t.keyArgs.action)&&"space"!==t.keyArgs.action&&a===o.rowIndex&&l===o.cellIndex)||this.selectionSettings.allowColumnSelection){this.preventFocus=!0;var d=this.getKeyColIndex(t);switch(this.needColumnSelection&&(l=d),t.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=t.element,this.applyDownUpKey(a,l);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(a,l);break;case"shiftDown":case"shiftUp":this.shiftDownKey(a,l);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(a,l);break;case"home":case"end":l="end"===t.keyArgs.action?this.getLastColIndex(a):0,this.applyHomeEndKey(a,l);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(a,l);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(t.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(a)}this.needColumnSelection=!1,this.preventFocus=!1,this.positionBorders(),this.updateAutoFillPosition()}}else n&&!this.parent.isCheckBoxSelection&&this.clearSelection()}},{key:"getKeyColIndex",value:function(e){var t,i=null,n=e.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&Wt(e.element,"e-columnheader"))if(this.needColumnSelection=!!e.container.isHeader,n){if("rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)return i;t=n.getAttribute("e-mappinguid");var r=this.getstackedColumns(this.parent.getColumnByUid(t).columns),s=this.parent.getColumnIndexByUid(r[r.length-1].uid),a=this.parent.getColumnIndexByUid(r[0].uid);i=this.prevColIndex>=s?a:s}else i=this.parent.getColumnIndexByUid(e.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return i}},{key:"ctrlPlusA",value:function(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})}},{key:"applySpaceSelection",value:function(e){e.classList.contains("e-checkselectall")?(this.checkedTarget=e,this.checkSelectAll(this.checkedTarget)):e.classList.contains("e-checkselect")&&(this.checkedTarget=e,this.checkSelect(this.checkedTarget))}},{key:"applyDownUpKey",value:function(e,t){var i=this.parent;this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&!this.selectionSettings.persistSelection&&(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&(this.selectRow(e,!0),this.applyUpDown(i.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0),this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)}},{key:"applyUpDown",value:function(e){if(!(e<0)){this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);var t=parseInt(this.target.getAttribute("aria-colindex"),10),i=this.parent.getFrozenColumns();this.target=i&&t>=i?this.contentRenderer.getMovableRowByIndex(e).querySelectorAll(".e-rowcell")[t-i]:this.contentRenderer.getRowByIndex(e).querySelectorAll(".e-rowcell")[t],this.addAttribute(this.target)}}},{key:"applyRightLeftKey",value:function(e,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:e,cellIndex:t},!0),this.addAttribute(this.target))}},{key:"applyHomeEndKey",value:function(e,t){this.isCellType()?this.selectCell({rowIndex:e,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(e,t))}},{key:"shiftDownKey",value:function(e,t){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&(Object(m.ab)(this.prevRowIndex)?this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,e),this.applyUpDown(e))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1}},{key:"applyShiftLeftRightKey",value:function(e,t){this.isMultiShiftRequest=!0,this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1}},{key:"getstackedColumns",value:function(e){for(var t=[],i=0,n=e.length;i<n;i++)e[i].columns?this.getstackedColumns(e[i].columns):t.push(e[i]);return t}},{key:"applyCtrlHomeEndKey",value:function(e,t){this.isRowType()&&(this.selectRow(e,!0),this.addAttribute(this.parent.getCellFromIndex(e,t))),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0)}},{key:"addRemoveClassesForRow",value:function(e,t,i){if(e){for(var n=[].slice.call(e.querySelectorAll(".e-rowcell")),r=e.querySelector(".e-detailrowcollapse")||e.querySelector(".e-detailrowexpand"),s=e.querySelector(".e-rowdragdrop"),a=arguments.length,l=new Array(a>3?a-3:0),o=3;o<a;o++)l[o-3]=arguments[o];r&&n.push(r),s&&n.push(s),ui.apply(void 0,[n,t].concat(l))}this.getRenderer().setSelection(e?e.getAttribute("data-uid"):null,t,i)}},{key:"isRowType",value:function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}},{key:"isCellType",value:function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode}},{key:"isSingleSel",value:function(){return"Single"===this.selectionSettings.type}},{key:"getRenderer",value:function(){return Object(m.X)(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(U.Content)),this.contentRenderer}},{key:"getSelectedRecords",value:function(){return this.selectionSettings.persistSelection?this.persistSelectedData:this.parent.getRowsObject().filter((function(e){return e.isSelected})).map((function(e){return e.data}))}},{key:"selectColumn",value:function(e){var t=this.parent;if(!Object(m.X)(t.getColumns()[e])){var i=t.getColumnByIndex(e),n=t.getColumnHeaderByUid(i.uid),r=n.classList.contains("e-columnselection");if(t.selectionSettings.allowColumnSelection){var s=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(e)>-1;if(this.clearColDependency(),!r||!this.selectionSettings.enableToggle||s){var a={columnIndex:e,headerCell:n,column:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(a,"columnSelecting"),a.cancel)return void this.disableInteracted();t.selectionSettings.enableToggle&&e===this.prevColIndex&&r&&!s||this.updateColSelection(n,e),this.onActionComplete({columnIndex:e,headerCell:n,column:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex},"columnSelected")}this.updateColProps(e)}}}},{key:"selectColumnsByRange",value:function(e,t){var i=this.parent;if(!Object(m.X)(i.getColumns()[e])){var n=[];if("Single"===i.selectionSettings.type||Object(m.X)(t))n[0]=e;else for(var r=e<t,s=e;r?s<=t:s>=t;r?s++:s--)n.push(s);this.selectColumns(n)}}},{key:"selectColumns",value:function(e){var t=this.parent,i=this.getselectedCols();if("Single"===t.selectionSettings.type&&(e=[e[0]]),t.selectionSettings.allowColumnSelection){this.clearColDependency();var n={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(n,"columnSelecting"),n.cancel)this.disableInteracted();else{for(var r=0,s=e.length;r<s;r++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(e[r]).uid),e[r]);i=this.getselectedCols();var a={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(a,"columnSelected"),this.updateColProps(e[0])}}}},{key:"selectColumnWithExisting",value:function(e){var t=this.parent;if(!Object(m.X)(t.getColumns()[e])){var i=t.getFrozenColumns(),n=i&&e>=i,r=t.getColumnHeaderByUid(t.getColumnByIndex(e).uid),s=this.getselectedCols();if("Single"===t.selectionSettings.type&&this.clearColDependency(),t.selectionSettings.allowColumnSelection){if(n?t.getMovableRows():t.getDataRows(),this.selectedColumnsIndexes.indexOf(e)>-1)this.clearColumnSelection(e);else{var a={columnIndex:e,headerCell:s,columnIndexes:this.selectedColumnsIndexes,column:t.getColumnByIndex(e),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(a,"columnSelecting"),a.cancel)return void this.disableInteracted();this.updateColSelection(r,e);var l={columnIndex:e,headerCell:s=this.getselectedCols(),column:t.getColumnByIndex(e),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(l,"columnSelected")}this.updateColProps(e)}}}},{key:"clearColumnSelection",value:function(e){if(this.isColumnSelected){var t=this.parent;if(!Object(m.X)(e)&&-1===this.selectedColumnsIndexes.indexOf(e))return;var i,n=Object(m.X)(e)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:e,r=t.getColumnByIndex(n),s=t.getColumnByIndex(n),a={columnIndex:n,headerCell:i="frozen-right"===r.getFreezeTableName()?t.getFrozenRightColumnHeaderByIndex(n):"movable"===r.getFreezeTableName()?t.getMovableColumnHeaderByIndex(n):t.getColumnHeaderByUid(s.uid),columnIndexes:this.selectedColumnsIndexes,column:s,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(a,"columnDeselecting"))return void this.disableInteracted();for(var l=Object(m.X)(e)?[].slice.call(t.getHeaderContent().querySelectorAll(".e-columnselection")):[i],o=this.getSelectedColumnCells(e),h=0,c=l.length;h<c;h++)ui([l[h]],!1,"e-columnselection");for(var u=0,d=o.length;u<d;u++)ui([o[u]],!1,"e-columnselection");Object(m.X)(e)?(this.columnDeselect(a,"columnDeselected"),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter((function(e){return e.isSelected=!1}))):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(e),1),this.parent.getColumns()[e].isSelected=!1)}}},{key:"getselectedCols",value:function(){var e,t=this.parent;if(this.selectedColumnsIndexes.length>1){e=[];for(var i=0;i<this.selectedColumnsIndexes.length;i++)e.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[i]).uid))}else e=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return e}},{key:"getSelectedColumnCells",value:function(e){var t,i,n=this.parent,r=!Object(m.X)(this.parent.rowTemplate),s=r?n.getRows():n.getDataRows();n.isFrozenGrid()&&n.getContent().querySelector(".e-movablecontent")&&(t=r?n.getMovableRows():n.getMovableDataRows(),s=n.addMovableRows(s,t),"Left-Right"===n.getFrozenMode()&&(i=r?n.getFrozenRightRows():n.getFrozenRightDataRows(),s=n.addMovableRows(s,i)));for(var a=[],l=Object(m.X)(e)?".e-columnselection":'[aria-colindex="'+e+'"]',o=0,h=s.length;o<h;o++)a=a.concat([].slice.call(s[o].querySelectorAll(l)));return a}},{key:"columnDeselect",value:function(e,t){return"columnDeselected"===t&&delete e.cancel,this.onActionComplete(e,t),e.cancel}},{key:"updateColProps",value:function(e){this.prevColIndex=e,this.isColumnSelected=this.selectedColumnsIndexes.length&&!0}},{key:"clearColDependency",value:function(){this.clearColumnSelection(),this.selectedColumnsIndexes=[]}},{key:"updateColSelection",value:function(e,t){if(!Object(m.X)(this.parent.getColumns()[t])){var i,n=this.parent.getFrozenLeftCount(),r=this.parent.getMovableColumnsCount(),s=this.parent.getColumnByIndex(t),a=!Object(m.X)(this.parent.rowTemplate);this.selectedColumnsIndexes.push(t),this.parent.getColumns()[t].isSelected=!0,"frozen-right"===s.getFreezeTableName()?(t-=n+r,i=a?this.parent.getFrozenRightRows():this.parent.getFrozenRightDataRows()):"movable"===s.getFreezeTableName()?(t-=n,i=a?this.parent.getMovableRows():this.parent.getMovableDataRows()):(t+=this.parent.getIndentCount(),i=a?this.parent.getRows():this.parent.getDataRows()),ui([e],!0,"e-columnselection");for(var l=0,o=i.length;l<o;l++)i[l].classList.contains("e-row")&&(!i[l].classList.contains("e-editedrow")&&!i[l].classList.contains("e-addedrow")||"Normal"!==this.parent.editSettings.mode||Object(m.X)(i[l].querySelector("tr").childNodes[t])?Object(m.X)(i[l].childNodes[t])||ui([i[l].childNodes[t]],!0,"e-columnselection"):ui([i[l].querySelector("tr").childNodes[t]],!0,"e-columnselection"))}}},{key:"headerSelectionHandler",value:function(e){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(e):this.isMultiShiftRequest?this.selectColumnsByRange(Object(m.ab)(this.prevColIndex)?e:this.prevColIndex,e):this.selectColumnWithExisting(e)}},{key:"addEventListener_checkbox",value:function(){var e=this;this.parent.on(T,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(I,this.onDataBoundFunction),this.parent.on(A,this.checkBoxSelectionChanged,this),this.parent.on("before-refresh-on-data-change",this.initPerisistSelection,this),this.parent.on(L,this.setCheckAllForEmptyGrid,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(E,this.actionCompleteFunc),this.parent.on(H,this.clickHandler,this),this.resizeEndFn=function(){e.updateAutoFillPosition(),e.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener("resizeStop",this.resizeEndFn)}},{key:"removeEventListener_checkbox",value:function(){this.parent.off(T,this.dataReady),this.parent.removeEventListener(I,this.onDataBoundFunction),this.parent.removeEventListener(E,this.actionCompleteFunc),this.parent.off(L,this.setCheckAllForEmptyGrid),this.parent.off(H,this.clickHandler),this.parent.off("before-refresh-on-data-change",this.initPerisistSelection)}},{key:"setCheckAllForEmptyGrid",value:function(){var e=this.getCheckAllBox();if(e){this.parent.isCheckBoxSelection=!0;var t=e.nextElementSibling;Object(m.ib)([t],["e-check","e-stop","e-uncheck"])}}},{key:"dataReady",value:function(e){this.isHeaderCheckboxClicked=!1,"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)}},{key:"actionCompleteHandler",value:function(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()}},{key:"selectRowIndex",value:function(e){this.parent.isSelectedRowIndexUpdating=!0,this.parent.selectedRowIndex=e}},{key:"disableInteracted",value:function(){this.isInteracted=!1}},{key:"activeTarget",value:function(){this.actualTarget=this.isInteracted?this.actualTarget:null}}]),t}(),nt=function(){function e(t){p(this,e),this.parent=t,this.addEventListener()}return f(e,[{key:"search",value:function(e){var t=this.parent;e=Object(m.X)(e)?"":e,oi(t)?t.notify(G,{instance:this,handler:this.search,arg1:e}):e!==t.searchSettings.key?(t.searchSettings.key=e.toString(),t.dataBind()):this.refreshSearch&&t.refresh()}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(B,this.onPropertyChanged,this),this.parent.on("searching-complete",this.onSearchComplete,this),this.parent.on(N,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(E,this.actionCompleteFunc),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(B,this.onPropertyChanged),this.parent.off("searching-complete",this.onSearchComplete),this.parent.off(N,this.destroy),this.parent.removeEventListener(E,this.actionCompleteFunc),this.parent.off("cancel-Begin",this.cancelBeginEvent))}},{key:"destroy",value:function(){this.removeEventListener()}},{key:"onPropertyChanged",value:function(e){e.module===this.getModuleName()&&(Object(m.X)(e.properties.key)?this.parent.notify(P,{requestType:"searching",type:D}):this.parent.notify(P,{requestType:"searching",type:D,searchString:this.parent.searchSettings.key}))}},{key:"onSearchComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(E,Object(m.K)(e,{searchString:this.parent.searchSettings.key,requestType:"searching",type:E}))}},{key:"onActionComplete",value:function(e){this.refreshSearch="searching"!==e.requestType}},{key:"cancelBeginEvent",value:function(e){"searching"===e.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)}},{key:"getModuleName",value:function(){return"search"}}]),e}(),rt=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"show",value:function(e,t){var i=this.getToggleFields(e),n=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var r=0;r<n.length;r++)n[r].visible=!0;this.setVisible(n)}},{key:"hide",value:function(e,t){var i=this.getToggleFields(e),n=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var r=0;r<n.length;r++)n[r].visible=!1;this.setVisible(n)}},{key:"getToggleFields",value:function(e){return"string"==typeof e?[e]:e}},{key:"getColumns",value:function(e,t){var i=this;return At(e,(function(e,n){return At(i.parent.columnModel,(function(i,n){if(i[t]===e)return i}))[0]}))}},{key:"setVisible",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i=i.length>0?i:Object(m.W)()?JSON.parse(JSON.stringify(e)):e,this.parent.trigger(D,{requestType:"columnstate",cancel:!1,columns:i},(function(n){var r=t.parent.getColumns();if(e=Object(m.X)(e)?r:e,n.cancel)return t.parent.notify("reset-columns",{showHideArgs:n}),void(e.length>0&&(e[0].visible=!0));Si(t.parent)&&t.parent.contentModule.emptyVcRows(),t.parent.allowSelection&&t.parent.getSelectedRecords().length&&t.parent.clearSelection(),t.parent.enableColumnVirtualization?e.filter((function(e){return r.some((function(t){return e.field===t.field}))})).length&&t.parent.notify("column-visible-changed",e):t.parent.notify("column-visible-changed",e),t.parent.trigger(E,{requestType:"columnstate",columns:i}),"All"!==t.parent.columnQueryMode&&t.parent.refresh()}))}}]),e}(),st=function(){function e(t){p(this,e),this.lastScrollTop=0,this.previousValues={top:0,left:0},this.oneTimeReady=!0,this.parent=t,this.widthService=new We(t),this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"scroll"}},{key:"setWidth",value:function(e){this.parent.element.style.width=Object(m.L)(this.parent.width),e&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element&&this.parent.toolbarModule.toolbar.refreshOverflow()}},{key:"setHeight",value:function(){var t=0,i=this.parent.getContent().querySelector(".e-content"),n=this.parent.height;if(this.parent.isFrozenGrid()&&"auto"!==this.parent.height&&this.parent.height.toString().indexOf("%")<0&&(n=parseInt(n,10)-e.getScrollBarWidth()),!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height){var r=this.parent.getHeaderContent().querySelector("tbody");t=r?r.offsetHeight:0,r&&t&&(t-=r.querySelectorAll(".e-addedrow").length*this.parent.getRowHeight()),i.style.height=Object(m.L)(n-t)}else i.style.height=Object(m.L)(n);this.ensureOverflow(i)}},{key:"setPadding",value:function(){var t=this.parent.getHeaderContent(),i=e.getScrollBarWidth()-this.getThreshold(),n=this.getCssProperties(),r="Right"===this.parent.getFrozenMode()||"Left-Right"===this.parent.getFrozenMode()?"0.5px":"1px";t.querySelector(".e-headercontent").style[n.border]=i>0?r:"0px",t.style[n.padding]=i>0?i+"px":"0px"}},{key:"removePadding",value:function(e){var t=this.getCssProperties(e),i=this.parent.getHeaderContent().querySelector(".e-headercontent");i.style[t.border]="",i.parentElement.style[t.padding]="";var n=this.parent.getFooterContent();n&&n.classList.contains("e-footerpadding")&&n.classList.remove("e-footerpadding")}},{key:"refresh",value:function(){if("100%"===this.parent.height){var e=this.parent.getContent();this.parent.element.style.height="100%";var t=this.widthService.getSiblingsHeight(e);e.style.height="calc(100% - "+t+"px)",this.parent.isFrozenGrid()&&(e.firstElementChild.style.height="calc(100% - "+ni()+"px)")}}},{key:"getThreshold",value:function(){return"mozilla"===m.d.info.name?.5:1}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(L,this.wireEvents,this),this.parent.on(A,this.wireEvents,this),this.parent.on(z,this.onPropertyChanged,this),this.parent.on("textWrapRefresh",this.wireEvents,this),this.parent.on(q,this.setScrollLeft,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(L,this.wireEvents),this.parent.off(A,this.wireEvents),this.parent.off(z,this.onPropertyChanged),this.parent.off("textWrapRefresh",this.wireEvents),this.parent.off(q,this.setScrollLeft))}},{key:"setScrollLeft",value:function(){this.parent.isFrozenGrid()?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector(".e-headercontent").scrollLeft=this.previousValues.left}},{key:"onFrozenContentScroll",value:function(){var e=this;return function(t){null===e.content.querySelector("tbody")||e.parent.isPreventScrollEvent||(!Object(m.X)(e.parent.infiniteScrollModule)&&e.parent.enableInfiniteScrolling&&e.parent.notify("infinite-scroll-handler",t),e.previousValues.top=t.target.scrollTop)}}},{key:"onContentScroll",value:function(e){var t=this,i=e,n=i.classList.contains("e-headercontent");return function(e){if(null!==t.content.querySelector("tbody")&&!t.parent.isPreventScrollEvent){if(!Object(m.X)(t.parent.infiniteScrollModule)&&t.parent.enableInfiniteScrolling&&t.parent.notify("infinite-scroll-handler",e),t.parent.groupSettings.columns.length&&t.parent.groupSettings.enableLazyLoading){var r=t.previousValues.top<t.parent.getContent().firstElementChild.scrollTop;t.parent.notify("lazy-load-scroll-handler",{scrollDown:r})}t.parent.notify("virtual-scroll-edit",{});var s=e.target,a=s.scrollLeft,l=s.classList.contains("e-summarycontent");t.previousValues.left!==a?(t.parent.notify("close-filter-dialog",e),i.scrollLeft=a,l&&(t.header.scrollLeft=a),t.previousValues.left=a,t.parent.notify("scroll",{left:a})):t.previousValues.top=n?s.scrollTop:t.previousValues.top}}}},{key:"onCustomScrollbarScroll",value:function(e,t){var i=this,n=e,r=t;return function(e){if(null!==i.content.querySelector("tbody")){var t=e.target.scrollLeft;i.previousValues.left!==t&&(n.scrollLeft=t,r.scrollLeft=t,i.previousValues.left=t,i.parent.notify("scroll",{left:t}))}}}},{key:"onTouchScroll",value:function(e){var t=this,i=e;return function(e){if("mouse"!==e.pointerType){var n=t.parent.isFrozenGrid(),r=t.getPointXY(e),s=i.scrollLeft+(t.pageXY.x-r.x),a=n?t.parent.getHeaderContent().querySelector(".e-movableheader"):t.parent.getHeaderContent().querySelector(".e-headercontent"),l=n?t.parent.getContent().querySelector(".e-movablecontent"):t.parent.getContent().querySelector(".e-content");t.previousValues.left===s||s<0||a.scrollWidth-a.clientWidth<s||(e.preventDefault(),a.scrollLeft=s,l.scrollLeft=s,n&&(t.parent.getContent().querySelector(".e-movablescrollbar").scrollLeft=s),t.pageXY.x=r.x,t.previousValues.left=s)}}}},{key:"setPageXY",value:function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}}},{key:"getPointXY",value:function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t}},{key:"wireEvents",value:function(){var e=this;if(this.oneTimeReady){var t=this.parent.isFrozenGrid();this.content=this.parent.getContent().querySelector(".e-content"),this.header=this.parent.getHeaderContent().querySelector(".e-headercontent");var i=this.content.querySelector(".e-movablecontent"),n=(this.content.querySelector(".e-frozencontent"),this.header.querySelector(".e-movableheader")),r=this.parent.getContent().querySelector(".e-movablescrollbar");this.parent.frozenRows&&(m.l.add(t?n:this.header,"touchstart pointerdown",this.setPageXY(),this),m.l.add(t?n:this.header,"touchmove pointermove",this.onTouchScroll(t?i:this.content),this)),this.parent.isFrozenGrid()?(m.l.add(r,"scroll",this.onCustomScrollbarScroll(i,n),this),m.l.add(i,"scroll",this.onCustomScrollbarScroll(r,n),this),m.l.add(n,"scroll",this.onCustomScrollbarScroll(r,i),this),m.l.add(this.content,"scroll",this.onFrozenContentScroll(),this),m.l.add(n,"touchstart pointerdown",this.setPageXY(),this),m.l.add(n,"touchmove pointermove",this.onTouchScroll(i),this),m.l.add(i,"touchstart pointerdown",this.setPageXY(),this),m.l.add(i,"touchmove pointermove",this.onTouchScroll(n),this)):(m.l.add(this.content,"scroll",this.onContentScroll(this.header),this),m.l.add(this.header,"scroll",this.onContentScroll(this.content),this)),this.parent.aggregates.length&&m.l.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this),this.refresh(),this.oneTimeReady=!1}var s,a,l,o=this.parent.getContentTable();Dt((function(){s=e.header.scrollLeft,a=o.scrollHeight,l=e.parent.getContent().clientHeight}),(function(){var t={cancel:!1};e.parent.notify("check-scroll-reset",t),e.parent.enableVirtualization||e.parent.enableInfiniteScrolling||(a<l&&(Object(m.v)(o.querySelectorAll("tr:last-child td"),"e-lastrowcell"),e.parent.isFrozenGrid()&&Object(m.v)(e.parent.getContent().querySelector(".e-movablecontent").querySelectorAll("tr:last-child td"),"e-lastrowcell")),t.cancel||((e.parent.frozenRows>0||e.parent.isFrozenGrid())&&e.header.querySelector(".e-movableheader")?e.header.querySelector(".e-movableheader").scrollLeft=e.previousValues.left:e.header.scrollLeft=e.previousValues.left,e.content.scrollLeft=e.previousValues.left,e.content.scrollTop=e.previousValues.top)),e.parent.enableColumnVirtualization||(e.content.scrollLeft=s),e.parent.isFrozenGrid()&&e.header.querySelector(".e-movableheader")&&(e.header.querySelector(".e-movableheader").scrollLeft=e.content.querySelector(".e-movablecontent").scrollLeft)})),this.parent.isPreventScrollEvent=!1}},{key:"getCssProperties",value:function(e){var t={},i=Object(m.X)(e)?this.parent.enableRtl:e;return t.border=i?"borderLeftWidth":"borderRightWidth",t.padding=i?"paddingLeft":"paddingRight",t}},{key:"ensureOverflow",value:function(e){e.style.overflowY="auto"===this.parent.height?"auto":"scroll"}},{key:"onPropertyChanged",value:function(e){e.module===this.getModuleName()&&(this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight(),this.setWidth(!Object(m.X)(e.properties.width)))}},{key:"destroy",value:function(){var e=this.parent.element;if(e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))){this.removeEventListener(),this.removePadding();var t=this.parent.getContent().querySelector(".e-content");Object(m.ib)([this.parent.getHeaderContent().querySelector(".e-headercontent")],"e-headercontent"),Object(m.ib)([t],"e-content"),t.style.height="",this.parent.element.style.width="",m.l.remove(t,"scroll",this.onContentScroll)}}}],[{key:"getScrollBarWidth",value:function(){return ni()}}]),e}(),at=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},lt=(de=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).templateFn={},e}return f(i,[{key:"setFormatter",value:function(e){this.formatFn=e}},{key:"getFormatter",value:function(){return this.formatFn}},{key:"setTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==this.footerTemplate&&(this.templateFn[Object(m.P)(K,K.Summary)]={fn:Object(m.E)(this.footerTemplate,e),property:"footerTemplate"}),void 0!==this.groupFooterTemplate&&(this.templateFn[Object(m.P)(K,K.GroupSummary)]={fn:Object(m.E)(this.groupFooterTemplate,e),property:"groupFooterTemplate"}),void 0!==this.groupCaptionTemplate&&(this.templateFn[Object(m.P)(K,K.CaptionSummary)]={fn:Object(m.E)(this.groupCaptionTemplate,e),property:"groupCaptionTemplate"})}},{key:"getTemplate",value:function(e){return this.templateFn[Object(m.P)(K,e)]}},{key:"setPropertiesSilent",value:function(e){this.setProperties(e,!0)}}]),i}(m.e),at([Object(m.s)()],de.prototype,"type",void 0),at([Object(m.s)()],de.prototype,"field",void 0),at([Object(m.s)()],de.prototype,"columnName",void 0),at([Object(m.s)()],de.prototype,"format",void 0),at([Object(m.s)()],de.prototype,"footerTemplate",void 0),at([Object(m.s)()],de.prototype,"groupFooterTemplate",void 0),at([Object(m.s)()],de.prototype,"groupCaptionTemplate",void 0),at([Object(m.s)()],de.prototype,"customAggregate",void 0),de),ot=(ue=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),at([Object(m.f)([],lt)],ue.prototype,"columns",void 0),ue),ht=function(){function e(t){p(this,e),this.copyContent="",this.isSelect=!1,this.parent=t,this.addEventListener()}return f(e,[{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(A,this.initialEnd,this),this.parent.on(V,this.keyDownHandler,this),this.parent.on(H,this.clickHandler,this),m.l.add(this.parent.element,"keydown",this.pasteHandler,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(V,this.keyDownHandler),this.parent.off(A,this.initialEnd),this.parent.off(H,this.clickHandler),m.l.remove(this.parent.element,"keydown",this.pasteHandler))}},{key:"clickHandler",value:function(e){var t=e.target;t=Wt(t,"e-rowcell")}},{key:"pasteHandler",value:function(e){var t=this,i=this.parent,n=/(Mac)/i.test(navigator.platform);if(86===e.keyCode&&(e.ctrlKey||n&&e.metaKey)&&!i.isEdit){if(!Object(m.C)(document.activeElement,".e-rowcell")||!i.editSettings.allowEditing||"Batch"!==i.editSettings.mode||"Cell"!==i.selectionSettings.mode||"Flow"===i.selectionSettings.cellSelectionMode)return;this.activeElement=document.activeElement,this.clipBoardTextArea.value="";var r=window.scrollX,s=window.scrollY;this.clipBoardTextArea.focus(),setTimeout((function(){t.activeElement.focus(),window.scrollTo(r,s),t.paste(t.clipBoardTextArea.value,t.parent.getSelectedRowCellIndexes()[0].rowIndex,t.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])}),10)}}},{key:"paste",value:function(e,t,i){var n,r,s,a=this.parent,l=i,o=t;if(a.editSettings.allowEditing&&"Batch"===a.editSettings.mode&&"Cell"===a.selectionSettings.mode&&"Flow"!==a.selectionSettings.cellSelectionMode){var h,c,u,d=e.split("\n"),p=a.getDataRows(),g=this.parent.isFrozenGrid();g&&(c=a.getMovableDataRows(),a.getFrozenRightColumnsCount()&&(u=a.getFrozenRightDataRows()));for(var f=0;f<d.length;f++){if(h=d[f].split("\t"),l=i,f===d.length-1&&""===d[f]||Object(m.ab)(a.getRowByIndex(o))){l++;break}for(var v=0;v<h.length;v++){if(s=a.getCellFromIndex(o,l),g){var b=c[o];s=!!p[o].querySelector('[aria-colindex="'+l+'"]')||b.querySelector('[aria-colindex="'+l+'"]'),u&&!s&&(s=u[o].querySelector('[aria-colindex="'+l+'"]'))}if(!s){l++;break}if(r=(n=a.getColumnByIndex(l)).getParser()?n.getParser()(h[v]):h[v],n.allowEditing&&!n.isPrimaryKey&&!n.template){var y={column:n,data:r,rowIndex:o};this.parent.trigger("beforePaste",y),o=y.rowIndex,y.cancel||a.editModule&&("number"===n.type?this.parent.editModule.updateCell(o,n.field,parseFloat(y.data)):a.editModule.updateCell(o,n.field,y.data))}l++}o++}a.selectionModule.selectCellsByRange({rowIndex:t,cellIndex:i},{rowIndex:o-1,cellIndex:l-1});var C=this.parent.getCellFromIndex(o-1,l-1);C&&Object(m.A)(C,["e-focus","e-focused"],[])}}},{key:"initialEnd",value:function(){this.parent.off(A,this.initialEnd),this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":"clipboard"}}),this.parent.element.appendChild(this.clipBoardTextArea)}},{key:"keyDownHandler",value:function(e){"ctrlPlusC"===e.action?this.copy():"ctrlShiftPlusH"===e.action&&this.copy(!0)}},{key:"setCopyData",value:function(e){if(""===window.getSelection().toString()){var t,i,n=this.parent.isFrozenGrid();this.clipBoardTextArea.value=this.copyContent="";var r=this.parent.getRows();if(n&&(t=this.parent.getMovableDataRows(),"Left-Right"===this.parent.getFrozenMode()&&(i=this.parent.getFrozenRightRows())),"Cell"!==this.parent.selectionSettings.mode){var s=this.parent.getSelectedRowIndexes().sort((function(e,t){return e-t}));if(e){for(var a=[],l=0;l<this.parent.getVisibleColumns().length;l++)a[l]=this.parent.getVisibleColumns()[l].headerText;this.getCopyData(a,!1,"\t",e),this.copyContent+="\n"}for(var o=0;o<s.length;o++){o>0&&(this.copyContent+="\n");var c=[].slice.call(r[s[o]].querySelectorAll(".e-rowcell"));n&&(c.push.apply(c,h([].slice.call(t[s[o]].querySelectorAll(".e-rowcell")))),i&&c.push.apply(c,h([].slice.call(i[s[o]].querySelectorAll(".e-rowcell"))))),this.getCopyData(c,!1,"\t",e)}}else{var u=this.checkBoxSelection();if(u.status){if(e){for(var d=[],p=0;p<u.colIndexes.length;p++)d.push(this.parent.getColumnHeaderByIndex(u.colIndexes[p]));this.getCopyData(d,!1,"\t",e),this.copyContent+="\n"}for(var g=0;g<u.rowIndexes.length;g++){g>0&&(this.copyContent+="\n");var f=[].slice.call(r[u.rowIndexes[g]].querySelectorAll(".e-cellselectionbackground"));n&&(f.push.apply(f,h([].slice.call(t[u.rowIndexes[g]].querySelectorAll(".e-cellselectionbackground")))),i&&f.push.apply(f,h([].slice.call(i[u.rowIndexes[g]].querySelectorAll(".e-cellselectionbackground"))))),this.getCopyData(f,!1,"\t",e)}}else this.getCopyData([].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground")),!0,"\n",e)}var v={data:this.copyContent,cancel:!1};if(this.parent.trigger("beforeCopy",v),v.cancel)return;this.clipBoardTextArea.value=this.copyContent=v.data,m.d.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0}}},{key:"getCopyData",value:function(e,t,i,n){for(var r="string"!=typeof e[0],s=0;s<e.length;s++)n&&t&&(this.copyContent+=this.parent.getColumns()[parseInt(e[s].getAttribute("aria-colindex"),10)].headerText+"\n"),r?e[s].classList.contains("e-hide")||(Object(m.W)()?!e[s].classList.contains("e-gridchkbox")&&Object.keys(e[s].querySelectorAll(".e-check")).length?this.copyContent+=!0:!e[s].classList.contains("e-gridchkbox")&&Object.keys(e[s].querySelectorAll(".e-uncheck")).length?this.copyContent+=!1:this.copyContent+=e[s].innerText:this.copyContent+=e[s].innerText):this.copyContent+=e[s],s<e.length-1&&(this.copyContent+=i)}},{key:"copy",value:function(e){document.queryCommandSupported("copy")&&(this.setCopyData(e),document.execCommand("copy"),this.clipBoardTextArea.blur()),this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)}},{key:"getModuleName",value:function(){return"clipboard"}},{key:"destroy",value:function(){this.removeEventListener(),this.clipBoardTextArea&&Object(m.hb)(this.clipBoardTextArea)}},{key:"checkBoxSelection",value:function(){var e=this.parent,t={status:!1};if("Cell"===e.selectionSettings.mode){var i,n,r=e.getSelectedRowCellIndexes(),s=[];for(n=0;n<r.length&&(r[n].cellIndexes.length&&s.push(r[n].rowIndex),!r[n].cellIndexes.length||(i||(i=JSON.stringify(r[n].cellIndexes.sort())),i===JSON.stringify(r[n].cellIndexes.sort())));n++);s.sort((function(e,t){return e-t})),n===r.length&&s[s.length-1]-s[0]==s.length-1&&(t={status:!0,rowIndexes:s,colIndexes:r[0].cellIndexes})}return t}}]),e}(),ct=new m.r,ut=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},dt=(je=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)()],je.prototype,"field",void 0),ut([Object(m.s)()],je.prototype,"direction",void 0),ut([Object(m.s)(!1)],je.prototype,"isFromGroup",void 0),je),pt=(xe=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.f)([],dt)],xe.prototype,"columns",void 0),ut([Object(m.s)(!0)],xe.prototype,"allowUnsort",void 0),xe),gt=(Oe=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)()],Oe.prototype,"field",void 0),ut([Object(m.s)()],Oe.prototype,"operator",void 0),ut([Object(m.s)()],Oe.prototype,"value",void 0),ut([Object(m.s)()],Oe.prototype,"matchCase",void 0),ut([Object(m.s)(!1)],Oe.prototype,"ignoreAccent",void 0),ut([Object(m.s)()],Oe.prototype,"predicate",void 0),ut([Object(m.s)({})],Oe.prototype,"actualFilterValue",void 0),ut([Object(m.s)({})],Oe.prototype,"actualOperator",void 0),ut([Object(m.s)()],Oe.prototype,"type",void 0),ut([Object(m.s)()],Oe.prototype,"ejpredicate",void 0),ut([Object(m.s)()],Oe.prototype,"uid",void 0),ut([Object(m.s)()],Oe.prototype,"isForeignKey",void 0),Oe),ft=(Se=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)(!1)],Se.prototype,"enableCache",void 0),ut([Object(m.s)(3)],Se.prototype,"maxBlocks",void 0),ut([Object(m.s)(3)],Se.prototype,"initialBlocks",void 0),Se),mt=(ke=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.f)([],gt)],ke.prototype,"columns",void 0),ut([Object(m.s)("FilterBar")],ke.prototype,"type",void 0),ut([Object(m.s)()],ke.prototype,"mode",void 0),ut([Object(m.s)(!0)],ke.prototype,"showFilterBarStatus",void 0),ut([Object(m.s)(1500)],ke.prototype,"immediateModeDelay",void 0),ut([Object(m.s)()],ke.prototype,"operators",void 0),ut([Object(m.s)(!1)],ke.prototype,"ignoreAccent",void 0),ut([Object(m.s)(!1)],ke.prototype,"enableCaseSensitivity",void 0),ut([Object(m.s)(!1)],ke.prototype,"showFilterBarOperator",void 0),ke),vt=(we=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)("Row")],we.prototype,"mode",void 0),ut([Object(m.s)("Flow")],we.prototype,"cellSelectionMode",void 0),ut([Object(m.s)("Single")],we.prototype,"type",void 0),ut([Object(m.s)(!1)],we.prototype,"checkboxOnly",void 0),ut([Object(m.s)(!1)],we.prototype,"persistSelection",void 0),ut([Object(m.s)("Default")],we.prototype,"checkboxMode",void 0),ut([Object(m.s)(!1)],we.prototype,"enableSimpleMultiRowSelection",void 0),ut([Object(m.s)(!0)],we.prototype,"enableToggle",void 0),ut([Object(m.s)(!1)],we.prototype,"allowColumnSelection",void 0),we),bt=(Ce=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)([])],Ce.prototype,"fields",void 0),ut([Object(m.s)("")],Ce.prototype,"key",void 0),ut([Object(m.s)("contains")],Ce.prototype,"operator",void 0),ut([Object(m.s)(!0)],Ce.prototype,"ignoreCase",void 0),ut([Object(m.s)(!1)],Ce.prototype,"ignoreAccent",void 0),Ce),yt=(ye=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)()],ye.prototype,"targetID",void 0),ye),Ct=(be=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)("Both")],be.prototype,"wrapMode",void 0),be),wt=(ve=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)("Normal")],ve.prototype,"mode",void 0),ve),kt=(me=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)(!0)],me.prototype,"showDropArea",void 0),ut([Object(m.s)(!1)],me.prototype,"allowReordering",void 0),ut([Object(m.s)(!1)],me.prototype,"showToggleButton",void 0),ut([Object(m.s)(!1)],me.prototype,"showGroupedColumn",void 0),ut([Object(m.s)(!0)],me.prototype,"showUngroupButton",void 0),ut([Object(m.s)(!1)],me.prototype,"disablePageWiseAggregates",void 0),ut([Object(m.s)([])],me.prototype,"columns",void 0),ut([Object(m.s)()],me.prototype,"captionTemplate",void 0),ut([Object(m.s)(!1)],me.prototype,"enableLazyLoading",void 0),me),St=(fe=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(m.e),ut([Object(m.s)(!1)],fe.prototype,"allowAdding",void 0),ut([Object(m.s)(!1)],fe.prototype,"allowEditing",void 0),ut([Object(m.s)(!1)],fe.prototype,"allowDeleting",void 0),ut([Object(m.s)("Normal")],fe.prototype,"mode",void 0),ut([Object(m.s)(!0)],fe.prototype,"allowEditOnDblClick",void 0),ut([Object(m.s)(!0)],fe.prototype,"showConfirmDialog",void 0),ut([Object(m.s)(!1)],fe.prototype,"showDeleteConfirmDialog",void 0),ut([Object(m.s)("")],fe.prototype,"template",void 0),ut([Object(m.s)("")],fe.prototype,"headerTemplate",void 0),ut([Object(m.s)("")],fe.prototype,"footerTemplate",void 0),ut([Object(m.s)("Top")],fe.prototype,"newRowPosition",void 0),ut([Object(m.s)({})],fe.prototype,"dialog",void 0),ut([Object(m.s)(!1)],fe.prototype,"allowNextRowEdit",void 0),fe),Ot=(ge=pe=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).isPreventScrollEvent=!1,n.inViewIndexes=[],n.keyA=!1,n.frozenRightCount=0,n.frozenLeftCount=0,n.tablesCount=1,n.movableCount=0,n.visibleFrozenLeft=0,n.visibleFrozenRight=0,n.visibleMovable=0,n.frozenLeftColumns=[],n.frozenRightColumns=[],n.movableColumns=[],n.media={},n.isFreezeRefresh=!1,n.tableIndex=0,n.componentRefresh=m.h.prototype.refresh,n.isVirtualAdaptive=!1,n.vRows=[],n.vcRows=[],n.vGroupOffsets={},n.rowUid=0,n.currentViewData=[],n.lockcolPositionCount=0,n.prevPageMoving=!1,n.pageTemplateChange=!1,n.isAutoGen=!1,n.mediaBindInstance={},n.commandDelIndex=void 0,n.asyncTimeOut=50,n.enableLogger=!0,n.needsID=!0,pe.Inject(it),Object(m.qb)("mergePersistData",n.mergePersistGridData,l(n)),n}return f(r,[{key:"getPersistData",value:function(){for(var e=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],t={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]},i=0;i<e.length;i++){var n,r=this[e[i]],s=c(t[e[i]]);try{for(s.s();!(n=s.n()).done;)delete r[n.value]}catch(a){s.e(a)}finally{s.f()}}return this.pageSettings.template=void 0,this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!Object(m.X)(this.pagerTemplate),this.addOnPersist(e)}},{key:"requiredModules",value:function(){this.setFrozenCount();var e=[];return this.isDestroyed||(this.allowFiltering&&e.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&e.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),e.push({member:"resize",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&e.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&e.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&e.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&e.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&e.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&e.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows||this.frozenRightCount||this.frozenLeftCount)&&e.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(e)),e}},{key:"extendRequiredModules",value:function(e){this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this,this.serviceLocator]}),this.groupSettings.enableLazyLoading&&e.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this,this.serviceLocator]}),this.showColumnChooser&&e.push({member:"columnChooser",args:[this,this.serviceLocator]}),this.isForeignKeyEnabled(this.columns)&&e.push({member:"foreignKey",args:[this,this.serviceLocator]}),this.enableLogger&&e.push({member:"logger",args:[this]}),Object(m.W)()&&e.push({member:"blazor",args:[this]})}},{key:"preRender",value:function(){this.serviceLocator=new He,this.initProperties(),this.initializeServices()}},{key:"initProperties",value:function(){this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.allowServerDataBinding=!1,this.ignoreCollectionWatch=!0,Object(m.W)()&&this.enableVirtualization&&this.allowGrouping&&(this.isExpanded=!1),this.mergeCells={},this.isEdit=!1,this.checkAllRows="None",this.isCheckBoxSelection=!1,this.isPersistSelection=!1,this.componentRefresh=m.h.prototype.refresh,this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No Matches Found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",EndsWith:"Ends With",Contains:"Contains",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No Matches Found",ClearFilter:"Clear Filter",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser dialog",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest"},this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert",delete:"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}}},{key:"render",value:function(){this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{role:"grid"}),Object(m.W)()&&this.renderComplete(),Object(b.g)({target:this.element},this.createElement),this.renderModule=new qe(this,this.serviceLocator),this.searchModule=new nt(this),this.scrollModule=new st(this),this.notify(M,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.trigger("load"),Vt(this.columns,this.enableColumnVirtualization,this),this.enablePersistence&&this.notify("columns-prepared",{}),Object(m.W)()&&this.isServerRendered||(this.getMediaColumns(),qt(this.columns)),this.checkLockColumns(this.columns),this.getColumns(),this.processModel(),this.gridRender(),this.wireEvents(),this.addListener(),this.updateDefaultCursor(),this.updateStackedFilter(),this.showSpinner(),this.notify(F,{}),Object(m.W)()&&this.isServerRendered&&ct.notify("component-rendered",{id:this.element.id,grid:this})}},{key:"showSpinner",value:function(){Object(b.n)(this.element)}},{key:"hideSpinner",value:function(){Object(b.k)(this.element)}},{key:"updateStackedFilter",value:function(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().querySelectorAll(".e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")}},{key:"getMediaColumns",value:function(){if(!this.enableColumnVirtualization){var e=this.getColumns();if(this.getShowHideService=this.serviceLocator.getService("showHideService"),!Object(m.X)(e))for(var t=0;t<e.length;t++)Object(m.X)(e[t].hideAtMedia)||!Object(m.X)(e[t].visible)&&!e[t].visible||this.pushMediaColumn(e[t],t)}}},{key:"pushMediaColumn",value:function(e,t){this.mediaCol.push(e),this.media[e.uid]=window.matchMedia(e.hideAtMedia),this.mediaQueryUpdate(t,this.media[e.uid]),this.mediaBindInstance[t]=this.mediaQueryUpdate.bind(this,t),this.media[e.uid].addListener(this.mediaBindInstance[t])}},{key:"updateMediaColumns",value:function(e){if(!this.enableColumnVirtualization){for(var t=this.getColumnIndexByUid(e.uid),i=0;i<this.mediaCol.length;i++)if(e.uid===this.mediaCol[i].uid)return void this.mediaCol.splice(i,1);this.pushMediaColumn(e,t)}}},{key:"mediaQueryUpdate",value:function(e,t){var i=this.getColumns()[e];this.mediaCol.some((function(e){return e.uid===i.uid}))&&(i.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,i.visible?this.showHider.show(i.headerText,"headerText"):this.showHider.hide(i.headerText,"headerText")))}},{key:"refreshMediaCol",value:function(){this.isInitialLoad=!0;var e=this.element.querySelector(".e-gridfooter");this.aggregates.length&&this.element.scrollHeight>this.height&&e&&Object(m.v)([e],["e-footerpadding"]),this.getColumns().filter((function(e){return"checkbox"===e.type})).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1)}},{key:"removeMediaListener",value:function(){for(var e=0;e<this.mediaCol.length;e++)this.media[this.mediaCol[e].uid].removeListener(this.mediaBindInstance[this.mediaCol[e].index])}},{key:"eventInitializer",value:function(){}},{key:"destroy",value:function(){var e=this.element;if(e){var t=!(!e.querySelector(".e-gridheader")||!e.querySelector(".e-gridcontent"));t&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(N,{}),this.destroyDependentModules(),t&&i(o(r.prototype),"destroy",this).call(this),this.toolTipObj.destroy();for(var n=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"],s=0;s<n.length;s++)this[n[s]]&&(this[n[s]]=null);Object(m.W)()&&this.isServerRendered?this.element.style.display="none":this.element.innerHTML="",Object(m.A)(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]),this.isAngular&&!this.isFreezeRefresh&&(this.element=null),this.isFreezeRefresh=!1}}},{key:"destroyDependentModules",value:function(){var e=this.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy())}},{key:"getModuleName",value:function(){return"grid"}},{key:"enableBoxSelection",value:function(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")}},{key:"onPropertyChanged",value:function(e,t){var i,n=!1,r=!1,s=!1;if(!this.isDestroyed){this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close();var a=Object.keys(e);a.indexOf("columns")>-1&&(this.updateColumnObject(),r=!0);for(var l=0,o=a;l<o.length;l++){var h=o[l];switch(h){case"allowPaging":this.notify(z,{module:"pager",enable:this.allowPaging}),n=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1,this.notify(B,{module:"pager",properties:e.pageSettings});break}this.notify(B,{module:"pager",properties:e.pageSettings}),(Object(m.X)(e.pageSettings.currentPage)&&Object(m.X)(e.pageSettings.pageSize)&&Object(m.X)(e.pageSettings.totalRecordsCount)||!Object(m.X)(t.pageSettings)&&e.pageSettings.currentPage!==t.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(n=!0);break;case"allowSorting":this.notify(z,{module:"sort",enable:this.allowSorting}),n=!0,i=!0;break;case"allowFiltering":this.updateStackedFilter(),this.notify(z,{module:"filter",enable:this.allowFiltering}),n=!0,"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(z,{module:"scroll",properties:{width:e.width,height:e.height}});break;case"allowReordering":this.headerModule.refreshUI(),i=!0;break;case"allowRowDragAndDrop":this.notify(z,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop}),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"allowSelection":this.notify(z,{module:"selection",enable:this.allowSelection});break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=Lt(this.rowTemplate),n=!0;break;case"detailTemplate":this.detailTemplateFn=Lt(this.detailTemplate),n=!0;break;case"allowGrouping":this.notify(z,{module:"group",enable:this.allowGrouping}),this.headerModule.refreshUI(),n=!0,i=!0;break;case"enableInfiniteScrolling":case"childGrid":n=!0;break;case"toolbar":this.notify(z,{module:"toolbar"});break;case"groupSettings":this.notify(B,{module:"group",properties:e.groupSettings,oldProperties:t.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(n=!0),this.notify(z,{module:"aggregate",properties:e});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns"),s=!0,r=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(n=!0),this.getDataModule().isQueryInvokedFromData=!1;break;default:this.extendedPropertyChange(h,e,r)}}i&&this.updateDefaultCursor(),r?s||this.getFrozenColumns()||this.frozenRows?Object(m.W)()&&this.isServerRendered||this.freezeRefresh():this.refresh():n&&(this.notify(P,{requestType:"refresh"}),n=!1,this.maintainSelection(e.selectedRowIndex))}}},{key:"extendedPropertyChange",value:function(e,t,i){switch(e){case"enableRtl":this.updateRTL(),this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=t.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind()),"auto"!==this.height&&(this.scrollModule.removePadding(!t.enableRtl),this.scrollModule.setPadding()),this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=t.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind()),this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=t.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind()),this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=t.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind()),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader(),this.notify("rtl-updated",{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI(),this.updateResizeLines();break;case"rowHeight":this.rowHeight?Object(m.v)([this.element],"e-grid-min-height"):Object(m.ib)([this.element],"e-grid-min-height"),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI(),this.notify(z,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(z,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(z,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(z,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter(),this.notify(B,{module:"filter",properties:t.filterSettings});break;case"searchSettings":this.notify(B,{module:"search",properties:t.searchSettings});break;case"sortSettings":this.notify(B,{module:"sort"});break;case"selectionSettings":this.notify(B,{module:"selection",properties:t.selectionSettings});break;case"editSettings":this.notify(B,{module:"edit",properties:t.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap(),this.notify("freezerender",{case:"textwrap",isModeChg:"textWrapSettings"===e});break;case"dataSource":var n=this.getDataModule().getState();if(Object.getPrototypeOf(t).deepWatch)for(var r=this.getPrimaryKeyFieldNames()[0],s=0,a=Object.keys(t.dataSource);s<a.length;s++)this.setRowData(Object(m.V)(r,this.dataSource[a[s]]),this.dataSource[a[s]]);else if(n.isPending){for(var l=Object(m.X)(this.dataSource)?[]:this.dataSource.result,o=n.group||[],h=0;h<o.length;h++)l=v.b.group(l,o[h],n.aggregates||[]);this.dataSource={result:l,count:this.dataSource.count,aggregates:this.dataSource.aggregates},this.getDataModule().setState({}),n.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify("datasource-modified",{}),i||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify("before-refresh-on-data-change",{}));this.scrollRefresh();break;case"enableHover":(t.enableHover?m.v:m.ib)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(t.selectedRowIndex),this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable()}}},{key:"maintainSelection",value:function(e){var t=this;-1!==e&&this.on(A,(function i(){t.selectRow(e),t.off(A,i)}),this)}},{key:"setProperties",value:function(e,t){i(o(r.prototype),"setProperties",this).call(this,e,t),e.filterSettings&&this.filterModule&&t&&this.filterModule.refreshFilter()}},{key:"setTablesCount",value:function(){var e=this.getFrozenColumns(),t=this.getFrozenLeftColumnsCount(),i=this.getFrozenRightColumnsCount();!e||t||i?e||!t&&!i||(t&&!i||i&&!t?this.tablesCount=2:t&&i&&(this.tablesCount=3)):this.tablesCount=2}},{key:"getTablesCount",value:function(){return this.tablesCount}},{key:"updateDefaultCursor",value:function(){var e=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),t=[].slice.call(this.getHeaderContent().querySelectorAll(".e-stackedheadercell")),i=this.getColumns();if(this.enableColumnVirtualization&&this.getFrozenColumns()){var n=this.contentModule.getHeaderCells();e=n.length?n:e}for(var r=0;r<e.length;r++){var s=e[r];(this.allowGrouping||this.allowReordering||this.allowSorting)&&s.classList.add(i[r].allowReordering&&i[r].allowSorting&&i[r].allowGrouping?"e-mousepointer":"e-defaultcursor")}for(var a=0;a<t.length;a++)this.allowReordering&&t[a].classList.add("e-mousepointer")}},{key:"updateColumnModel",value:function(e){for(var t=0,i=e.length;t<i;t++)e[t].columns?this.updateColumnModel(e[t].columns):this.columnModel.push(e[t]);this.updateColumnLevelFrozen(),this.updateFrozenColumns(),this.updateLockableColumns()}},{key:"updateColumnLevelFrozen",value:function(){var e=this.columnModel,t=[],i=[],n=[];if(this.frozenLeftCount||this.frozenRightCount){for(var r=0,s=e.length;r<s;r++){var a=e[r];"Left"===a.freeze?(a.freezeTable="frozen-left",t.push(a)):"Right"===a.freeze?(a.freezeTable="frozen-right",i.push(a)):(a.freezeTable="movable",n.push(a))}this.columnModel=t.concat(n).concat(i)}}},{key:"updateFrozenColumns",value:function(){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var e=this.columnModel,t=this.frozenColumns,i=this.getFrozenColumns(),n=0,r=0,s=e.length;r<s;r++){var a=e[r];t&&(a.freezeTable=r<t?"frozen-left":"movable"),a.isFrozen&&r>=t?(a.freezeTable="frozen-left",e.splice(this.frozenColumns+n,0,e.splice(r,1)[0]),n++):i&&!t&&(a.freezeTable="movable")}}},{key:"getFrozenLeftCount",value:function(){return this.getFrozenColumns()||this.getFrozenLeftColumnsCount()}},{key:"isFrozenGrid",value:function(){return 0!==this.getFrozenColumns()||0!==this.getFrozenLeftColumnsCount()||0!==this.getFrozenRightColumnsCount()}},{key:"getFrozenMode",value:function(){return this.frozenName}},{key:"updateLockableColumns",value:function(){for(var e=this.columnModel,t=0,i=0,n=this.getFrozenColumns(),r=0;r<e.length;r++)e[r].lockColumn&&(r<n?(e.splice(t,0,e.splice(r,1)[0]),t++):(e.splice(n+i,0,e.splice(r,1)[0]),i++))}},{key:"checkLockColumns",value:function(e){for(var t=0;t<e.length;t++)e[t].columns?this.checkLockColumns(e[t].columns):e[t].lockColumn&&this.lockcolPositionCount++}},{key:"getColumns",value:function(e){var t=this,i=this.inViewIndexes.map((function(e){return e-t.groupSettings.columns.length})).filter((function(e){return e>-1})),n=i.length;(!this.enableColumnVirtualization||Object(m.X)(this.columnModel)||0===this.columnModel.length||e)&&(this.columnModel=[],this.updateColumnModel(this.columns));var r=0===n?this.columnModel:this.columnModel.slice(i[0],i[n-1]+1);return this.contentModule&&this.enableColumnVirtualization&&this.isFrozenGrid()&&i.length&&i[0]>0&&(r=this.contentModule.ensureFrozenCols(r)),r}},{key:"getStackedHeaderColumnByHeaderText",value:function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(n.field===e||n.headerText===e){this.stackedColumn=n;break}n.columns&&this.getStackedHeaderColumnByHeaderText(e,n.columns)}return this.stackedColumn}},{key:"getColumnIndexesInView",value:function(){return this.inViewIndexes}},{key:"getQuery",value:function(){return this.query}},{key:"getLocaleConstants",value:function(){return this.defaultLocale}},{key:"setColumnIndexesInView",value:function(e){this.inViewIndexes=e}},{key:"getVisibleColumns",value:function(){var e,t=[],i=c(this.columnModel);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.visible&&t.push(n)}}catch(r){i.e(r)}finally{i.f()}return t}},{key:"getHeaderContent",value:function(){return this.headerModule.getPanel()}},{key:"setGridHeaderContent",value:function(e){this.headerModule.setPanel(e)}},{key:"getContentTable",value:function(){return this.contentModule.getTable()}},{key:"setGridContentTable",value:function(e){this.contentModule.setTable(e)}},{key:"getContent",value:function(){return this.contentModule.getPanel()}},{key:"setGridContent",value:function(e){this.contentModule.setPanel(e)}},{key:"getHeaderTable",value:function(){return this.headerModule.getTable()}},{key:"setGridHeaderTable",value:function(e){this.headerModule.setTable(e)}},{key:"getFooterContent",value:function(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement}},{key:"getFooterContentTable",value:function(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement.firstChild.firstChild}},{key:"getPager",value:function(){return this.gridPager}},{key:"setGridPager",value:function(e){this.gridPager=e}},{key:"getRowByIndex",value:function(e){return this.contentModule.getRowByIndex(e)}},{key:"getMovableRowByIndex",value:function(e){return this.contentModule.getMovableRowByIndex(e)}},{key:"getFrozenRowByIndex",value:function(e){return this.getFrozenDataRows()[e]}},{key:"getRows",value:function(){return this.contentModule.getRowElements()}},{key:"getFrozenRightRowByIndex",value:function(e){return this.contentModule.getFrozenRightRowByIndex(e)}},{key:"getRowInfo",value:function(e){var t=e,i={target:e};if(!Object(m.X)(e)&&Object(m.X)(Wt(t,"e-detailrowcollapse")&&Object(m.X)(Wt(t,"e-recordplusexpand")))){var n=Object(m.C)(t,".e-rowcell");if(!n){var r=Object(m.C)(t,".e-row");if(!Object(m.X)(r)){var s=this.getRowObjectFromUID(r.getAttribute("data-uid")),a=parseInt(r.getAttribute("aria-rowindex"),10);i={row:r,rowData:s.data,rowIndex:a}}return i}var l=parseInt(n.getAttribute("aria-colindex"),10);if(!Object(m.X)(n)&&!isNaN(l)){var o=Object(m.C)(n,".e-row"),h=parseInt(o.getAttribute("aria-rowindex"),10),c=this.getFrozenColumns(),u=this.columnModel[l].getFreezeTableName(),d=this.contentModule.getRows(),p=l+this.getIndentCount();this.isFrozenGrid()&&("frozen-left"===u?d=this.contentModule.getRows():"movable"===u?(p=l-c-this.frozenLeftCount,d=this.contentModule.getMovableRows()):"frozen-right"===u&&(p=l-(this.frozenLeftCount+this.movableCount),d=this.contentModule.getFrozenRightRows()));var g,f=d.filter((function(e){return e.uid===o.getAttribute("data-uid")})),v={};Object.keys(f).length&&(v=f[0].data,g=f[0].cells[p].column),i={cell:n,cellIndex:l,row:o,rowIndex:h,rowData:v,column:g,target:e}}}return i}},{key:"getMovableRows",value:function(){return this.contentModule.getMovableRowElements()}},{key:"getFrozenRightRows",value:function(){return this.contentModule.getFrozenRightRowElements()}},{key:"getDataRows",value:function(){return this.getAllDataRows()}},{key:"getAllDataRows",value:function(e){if(Object(m.X)(this.getContentTable().querySelector("tbody")))return[];var t=this.isFrozenGrid()?this.getFrozenLeftContentTbody():this.getContentTable().querySelector("tbody"),i=[].slice.call(t.children);if(this.frozenRows){var n=this.isFrozenGrid()?this.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"):this.getHeaderTable().querySelector("tbody"),r=[].slice.call(n.children);i=this.addMovableRows(r,i)}return this.generateDataRows(i,e)}},{key:"addMovableRows",value:function(e,t){for(var i=0,n=t.length;i<n;i++)e.push(t[i]);return e}},{key:"generateDataRows",value:function(e,t){for(var i=[],n=0,r=e.length;n<r;n++)!e[n].classList.contains("e-row")||e[n].classList.contains("e-hiddenrow")&&!t||(this.isCollapseStateEnabled()?i[parseInt(e[n].getAttribute("aria-rowindex"))]=e[n]:i.push(e[n]));return i}},{key:"getMovableDataRows",value:function(){return this.getAllMovableDataRows()}},{key:"getAllMovableDataRows",value:function(e){if(!this.isFrozenGrid())return[];var t=[].slice.call(this.getContent().querySelector(".e-movablecontent").querySelector("tbody").children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)}},{key:"getFrozenDataRows",value:function(){return this.getAllFrozenDataRows()}},{key:"getAllFrozenDataRows",value:function(e){var t=[].slice.call(this.getContent().querySelector(".e-frozencontent").querySelector("tbody").children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)}},{key:"getFrozenRightDataRows",value:function(){return this.getAllFrozenRightDataRows()}},{key:"getAllFrozenRightDataRows",value:function(e){if("Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode())return[];var t=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector("tbody").children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody").children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)}},{key:"setCellValue",value:function(e,t,i){var n,r,s,a,l,o=this.getPrimaryKeyFieldNames()[0],h=new ae(this,this.serviceLocator),c={},u=this.contentModule.getRows(),d=this.contentModule.getMovableRows();if(n=this.getColumnIndexByField(t),this.groupSettings.columns.length&&(n+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&n++,this.isRowDragable()&&n++,r=this.getColumnByField(t),l=u.filter((function(t){return Object(m.V)(o,t.data)===e}))[0],c=d.filter((function(t){return Object(m.V)(o,t.data)===e}))[0],s=Object(m.X)(l)?null:this.element.querySelector("[data-uid="+l.uid+"]"),a=Object(m.X)(c)?null:this.element.querySelector("[data-uid="+c.uid+"]"),!Object(m.X)(s)){Object(m.qb)(t,i,l.data);var p=Object(m.X)(s.cells[n])?a.cells[n-this.frozenColumns]:s.cells[n];if(!Object(m.X)(p)){var g,f=l.cells[n];this.frozenColumns&&(g=c.cells[n-this.frozenColumns]),h.refreshTD(p,Object(m.X)(f)?g:f,l.data,{index:l.index}),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})),Object(m.X)(c)||Object(m.X)(c.changes)||(c.changes[t]=i),this.trigger("queryCellInfo",{cell:p,column:r,data:l.data})}}}},{key:"refreshReactColumnTemplateByUid",value:function(e){var t=this;this.isReact&&this.clearTemplate(["columnTemplate"],void 0,(function(){for(var i=t.getRowsObject(),n=t.getIndentCount(),r=t.getNormalizedColumnIndex(e),s=0;s<i.length;s++)if(i[s].isDataRow&&!Object(m.X)(i[s].index)){var a=i[s].cells[r],l=new ae(t,t.serviceLocator),o=t.getCellFromIndex(i[s].index,r-n);l.refreshTD(o,a,i[s].data,{index:i[s].index})}}))}},{key:"setRowData",value:function(e,t){var i,n=this.contentModule.getRows(),r=this.getPrimaryKeyFieldNames()[0],s=new Z(this.serviceLocator,null,this);this.groupSettings.columns.length>0&&this.aggregates.length>0&&(n=n.filter((function(e){return e.isDataRow}))),i=n.filter((function(t){return Object(m.V)(r,t.data)===e}))[0],!Object(m.X)(i)&&this.element.querySelectorAll("[data-uid="+i.uid+"]").length&&(i.changes=t,bi(i,this.getForeignKeyColumns(),i.changes),s.refresh(i,this.getColumns(),!0),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})))}},{key:"getCellFromIndex",value:function(e,t){return _i(this,this.getColumnByIndex(t),e,t)}},{key:"getMovableCellFromIndex",value:function(e,t){if(!("Left-Right"===this.frozenName&&t>=this.movableCount)){var i=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableDataRows()[e]&&this.getMovableDataRows()[e].querySelectorAll(".e-rowcell")[t-i]}}},{key:"getFrozenRightCellFromIndex",value:function(e,t){var i=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount(),n=this.getFrozenRightDataRows();return n[e]&&n[e].querySelectorAll(".e-rowcell")[t-i]}},{key:"getColumnHeaderByIndex",value:function(e){return this.getHeaderTable().querySelectorAll(".e-headercell")[e]}},{key:"getMovableColumnHeaderByIndex",value:function(e){var t=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableVirtualHeader().querySelectorAll(".e-headercell")[e-t]}},{key:"getFrozenRightColumnHeaderByIndex",value:function(e){var t=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount();return this.getFrozenRightHeader().querySelectorAll(".e-headercell")[e-t]}},{key:"getFrozenLeftColumnHeaderByIndex",value:function(e){return this.getFrozenVirtualHeader().querySelectorAll(".e-headercell")[e]}},{key:"getRowObjectFromUID",value:function(e,t,i){var n=this.contentModule.getRows(),r=this.rowObject(n,e);return this.isFrozenGrid()&&(!r||t||i)?((!(r=this.rowObject(this.contentModule.getMovableRows(),e))&&"Left-Right"===this.getFrozenMode()||i)&&(r=this.rowObject(this.contentModule.getFrozenRightRows(),e)),r):Object(m.X)(r)&&this.enableVirtualization&&this.groupSettings.columns.length>0?r=this.rowObject(this.vRows,e):r}},{key:"rowObject",value:function(e,t){var i,n=c(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r.uid===t)return r}}catch(s){n.e(s)}finally{n.f()}return null}},{key:"getRowsObject",value:function(){return this.contentModule.getRows()}},{key:"getMovableRowsObject",value:function(){var e=[];return this.isFrozenGrid()&&(e=this.contentModule.getMovableRows()),e}},{key:"getFrozenRightRowsObject",value:function(){var e=[];return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()||(e=this.contentModule.getFrozenRightRows()),e}},{key:"getColumnHeaderByField",value:function(e){var t=this.getColumnByField(e);return t?this.getColumnHeaderByUid(t.uid):void 0}},{key:"getColumnHeaderByUid",value:function(e){var t=this.getHeaderContent().querySelector("[e-mappinguid="+e+"]");return t?t.parentElement:void 0}},{key:"getColumnByIndex",value:function(e){var t;return this.getColumns().some((function(i,n){return t=i,n===e})),t}},{key:"getColumnByField",value:function(e){return At(this.getColumns(),(function(t,i){if(t.field===e)return t}))[0]}},{key:"getColumnIndexByField",value:function(e){for(var t=this.getColumns(),i=0;i<t.length;i++)if(t[i].field===e)return i;return-1}},{key:"getColumnByUid",value:function(e){return At([].concat(h(this.getColumns()),h(this.getStackedColumns(this.columns))),(function(t,i){if(t.uid===e)return t}))[0]}},{key:"getStackedColumns",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=c(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.columns&&(i.push(r),this.getStackedColumns(r.columns,i))}}catch(s){n.e(s)}finally{n.f()}return i}},{key:"getColumnIndexByUid",value:function(e){var t=At(this.getColumns(),(function(t,i){if(t.uid===e)return i}))[0];return Object(m.X)(t)?-1:t}},{key:"getUidByColumnField",value:function(e){return At(this.getColumns(),(function(t,i){if(t.field===e)return t.uid}))[0]}},{key:"getNormalizedColumnIndex",value:function(e){return this.getColumnIndexByUid(e)+this.getIndentCount()}},{key:"getIndentCount",value:function(){var e=0;return this.allowGrouping&&(e+=this.groupSettings.columns.length),this.isDetail()&&e++,this.isRowDragable()&&Object(m.X)(this.rowDropSettings.targetID)&&e++,e}},{key:"getColumnFieldNames",value:function(){for(var e,t=[],i=0,n=this.getColumns().length;i<n;i++)(e=this.getColumns()[i]).visible&&t.push(e.field);return t}},{key:"getRowTemplate",value:function(){return this.rowTemplateFn}},{key:"getDetailTemplate",value:function(){return this.detailTemplateFn}},{key:"getEditTemplate",value:function(){return this.editTemplateFn}},{key:"getEditHeaderTemplate",value:function(){return this.editHeaderTemplateFn}},{key:"getEditFooterTemplate",value:function(){return this.editFooterTemplateFn}},{key:"getPrimaryKeyFieldNames",value:function(){for(var e=[],t=0;t<this.columnModel.length;t++)this.columnModel[t].isPrimaryKey&&e.push(this.columnModel[t].field);return e}},{key:"refresh",value:function(){this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh()}},{key:"refreshHeader",value:function(){this.headerModule.refreshUI()}},{key:"getSelectedRows",value:function(){return this.selectionModule?this.selectionModule.selectedRecords:[]}},{key:"getSelectedRowIndexes",value:function(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]}},{key:"getSelectedRowCellIndexes",value:function(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]}},{key:"getSelectedRecords",value:function(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]}},{key:"getSelectedColumnsUid",value:function(){var e=this,t=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter((function(i){return t.push(e.getColumns()[i].uid)})),t}},{key:"getDataModule",value:function(){return this.renderModule.data}},{key:"showColumns",value:function(e,t){this.showHider.show(e,t=t||"headerText")}},{key:"hideColumns",value:function(e,t){this.showHider.hide(e,t=t||"headerText")}},{key:"getFrozenColumns",value:function(){return this.frozenColumns+this.getFrozenCount(this.columns,0,0)}},{key:"getFrozenRightColumnsCount",value:function(){return this.frozenRightCount}},{key:"getFrozenLeftColumnsCount",value:function(){return this.frozenLeftCount}},{key:"getMovableColumnsCount",value:function(){return this.movableCount}},{key:"setFrozenCount",value:function(){this.frozenLeftCount=this.frozenRightCount=this.movableCount=0,this.visibleFrozenLeft=this.visibleFrozenRight=this.visibleMovable=0,this.frozenLeftColumns=[],this.frozenRightColumns=[],this.movableColumns=[],this.splitFrozenCount(this.columns),this.frozenColumns&&(this.frozenLeftCount||this.frozenRightCount)&&this.setProperties({frozenColumns:0},!0),this.setTablesCount(),this.frozenLeftCount&&!this.frozenRightCount?this.frozenName="Left":this.frozenRightCount&&!this.frozenLeftCount?this.frozenName="Right":this.frozenLeftCount&&this.frozenRightCount&&(this.frozenName="Left-Right")}},{key:"getVisibleFrozenLeftCount",value:function(){return this.visibleFrozenLeft}},{key:"getVisibleFrozenRightCount",value:function(){return this.visibleFrozenRight}},{key:"getVisibleMovableCount",value:function(){return this.visibleMovable}},{key:"getFrozenRightColumns",value:function(){return this.frozenRightColumns}},{key:"getFrozenLeftColumns",value:function(){return this.frozenLeftColumns}},{key:"getMovableColumns",value:function(){return this.movableColumns}},{key:"splitFrozenCount",value:function(e){for(var t=0;t<e.length;t++)e[t].columns?this.splitFrozenCount(e[t].columns):"Right"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenRight++,this.frozenRightColumns.push(e[t]),this.frozenRightCount++):"Left"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenLeft++,this.frozenLeftColumns.push(e[t]),this.frozenLeftCount++):(!1!==e[t].visible&&this.visibleMovable++,this.movableColumns.push(e[t]),this.movableCount++)}},{key:"getVisibleFrozenColumns",value:function(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)}},{key:"getFilterUIInfo",value:function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}}},{key:"getVisibleFrozenColumnsCount",value:function(){for(var e=0,t=this.columnModel,i=0;i<this.frozenColumns;i++)t[i].visible&&e++;if(this.frozenLeftCount||this.frozenRightCount)for(var n=0;n<t.length;n++)!t[n].visible||"Left"!==t[n].freeze&&"Right"!==t[n].freeze||e++;return e}},{key:"getVisibleFrozenCount",value:function(e,t){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var i=0,n=e.length;i<n;i++)e[i].columns?t=this.getVisibleFrozenCount(e[i].columns,t):e[i].isFrozen&&e[i].visible&&t++;return t}},{key:"getFrozenCount",value:function(e,t,i){for(var n=0,r=e.length;n<r;n++)e[n].columns?t=this.getFrozenCount(e[n].columns,t,i):(e[n].isFrozen&&i>this.frozenColumns-1&&t++,i++);return t}},{key:"goToPage",value:function(e){this.pagerModule&&this.pagerModule.goToPage(e)}},{key:"updateExternalMessage",value:function(e){this.pagerModule&&this.pagerModule.updateExternalMessage(e)}},{key:"sortColumn",value:function(e,t,i){this.sortModule&&this.sortModule.sortColumn(e,t,i)}},{key:"clearSorting",value:function(){this.sortModule&&this.sortModule.clearSorting()}},{key:"removeSortColumn",value:function(e){this.sortModule&&this.sortModule.removeSortColumn(e)}},{key:"filterByColumn",value:function(e,t,i,n,r,s,a,l){this.filterModule&&this.filterModule.filterByColumn(e,t,i,n,r,s,a,l)}},{key:"clearFiltering",value:function(e){this.filterModule&&this.filterModule.clearFiltering(e)}},{key:"removeFilteredColsByField",value:function(e,t){this.filterModule&&this.filterModule.removeFilteredColsByField(e,t)}},{key:"selectRow",value:function(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)}},{key:"selectRows",value:function(e){this.selectionModule&&this.selectionModule.selectRows(e)}},{key:"clearSelection",value:function(){this.selectionModule&&this.selectionModule.clearSelection()}},{key:"selectCell",value:function(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)}},{key:"selectCellsByRange",value:function(e,t){this.selectionModule.selectCellsByRange(e,t)}},{key:"search",value:function(e){this.searchModule&&this.searchModule.search(e)}},{key:"print",value:function(){this.printModule&&this.printModule.print()}},{key:"deleteRecord",value:function(e,t){this.editModule&&this.editModule.deleteRecord(e,t)}},{key:"startEdit",value:function(){this.editModule&&this.editModule.startEdit()}},{key:"endEdit",value:function(){this.editModule&&this.editModule.endEdit()}},{key:"closeEdit",value:function(){this.editModule&&this.editModule.closeEdit()}},{key:"addRecord",value:function(e,t){this.editModule&&this.editModule.addRecord(e,t)}},{key:"deleteRow",value:function(e){this.editModule&&this.editModule.deleteRow(e)}},{key:"editCell",value:function(e,t){this.editModule&&this.editModule.editCell(e,t)}},{key:"saveCell",value:function(){this.editModule&&this.editModule.saveCell()}},{key:"updateCell",value:function(e,t,i){this.editModule&&this.editModule.updateCell(e,t,i)}},{key:"updateRow",value:function(e,t){this.editModule&&this.editModule.updateRow(e,t)}},{key:"getBatchChanges",value:function(){return this.editModule?this.editModule.getBatchChanges():{}}},{key:"enableToolbarItems",value:function(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)}},{key:"copy",value:function(e){this.clipboardModule&&this.clipboardModule.copy(e)}},{key:"recalcIndentWidth",value:function(){var e=this;if(this.getHeaderTable().querySelector(".e-emptycell")&&(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&!this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")&&this.getContentTable()){var t=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,i=[].slice.call(this.getHeaderTable().querySelector("colgroup").childNodes),n=[].slice.call(this.getContentTable().querySelector("colgroup").childNodes),r=t/30,s="Right"===this.getFrozenMode()?this.frozenRightCount:0,a=this.element.offsetWidth,l=function(t,r){if(Bi(e)){var s=(r/a*100).toFixed(1)+"%";i[t].style.width=s,n[t].style.width=s}else i[t].style.width=r+"px",n[t].style.width=r+"px";e.notify("column-width-changed",{index:t,width:r})};for(r>=1&&(t=30/r),(this.enableColumnVirtualization||this.isAutoGen)&&(t=30);s<this.groupSettings.columns.length;)l(s,t),s++;this.isDetail()&&(l(s,t),s++),this.isRowDragable()&&l(s,t),this.isAutoGen=!1,this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}}},{key:"resetIndentWidth",value:function(){if(Bi(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter((function(e){return(!e.width||"auto"===e.width)&&e.minWidth})).length>0){var e=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(e)}this.isFrozenGrid()&&this.widthService&&this.widthService.refreshFrozenScrollbar()}},{key:"isRowDragable",value:function(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID&&!this.enableVirtualization}},{key:"reorderColumns",value:function(e,t){this.reorderModule&&this.reorderModule.reorderColumns(e,t)}},{key:"reorderColumnByIndex",value:function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(e,t)}},{key:"reorderColumnByTargetIndex",value:function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(e,t)}},{key:"reorderRows",value:function(e,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(e,t)}},{key:"refreshDataSource",value:function(e,t){this.notify("refreshdataSource",e)}},{key:"disableRowDD",value:function(e){var t=this.getHeaderTable(),i=this.getContentTable(),n=t.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),r=this.getRows(),s=e?"none":"";Object(m.ob)(t.querySelector("colgroup").childNodes[0],{display:s}),Object(m.ob)(i.querySelector("colgroup").childNodes[0],{display:s});for(var a=0;a<this.getRows().length;a++){var l=r[a].firstElementChild;e?Object(m.v)([l],"e-hide"):Object(m.ib)([l],["e-hide"])}for(var o=0;o<t.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;o++){var h=n[o];e?Object(m.v)([h],"e-hide"):Object(m.ib)([h],["e-hide"])}}},{key:"autoFitColumns",value:function(e){this.resizeModule&&this.resizeModule.autoFitColumns(e)}},{key:"createColumnchooser",value:function(e,t,i){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(e,t,i)}},{key:"initializeServices",value:function(){this.serviceLocator.register("widthService",this.widthService=new We(this)),this.serviceLocator.register("cellRendererFactory",new Ve),this.serviceLocator.register("rendererFactory",new Ne),this.serviceLocator.register("localization",this.localeObj=new m.p(this.getModuleName(),this.defaultLocale,this.locale)),this.serviceLocator.register("valueFormatter",this.valueFormatterService=new j(this.locale)),this.serviceLocator.register("showHideService",this.showHider=new rt(this)),this.serviceLocator.register("ariaService",this.ariaService=new le),this.serviceLocator.register("focus",this.focusModule=new Xe(this))}},{key:"processModel",value:function(){var e,t,i=this,n=this.groupSettings.columns,r=this.sortSettings.columns;if(this.allowGrouping)for(var s=function(s,a){t=0;for(var l=r.length;t<l;t++)if(r[t].field===n[s]){e=!0;break}if(e?i.allowSorting?i.sortedColumns.push(r[t].field):r[t].direction="Ascending":r.push({field:n[s],direction:"Ascending",isFromGroup:!0}),!i.groupSettings.showGroupedColumn){var o=i.enableColumnVirtualization?i.columns.filter((function(e){return e.field===n[s]}))[0]:i.getColumnByField(n[s]);o?o.visible=!1:i.log("initial_action",{moduleName:"group",columnName:n[s]})}},a=0,l=n.length;a<l;a++)s(a);if(!n.length)for(var o=0;o<r.length;o++)this.sortedColumns.push(r[o].field);if(this.rowTemplateFn=Lt(this.rowTemplate),this.detailTemplateFn=Lt(this.detailTemplate),this.editTemplateFn=Lt(this.editSettings.template),this.editHeaderTemplateFn=Lt(this.editSettings.headerTemplate),this.editFooterTemplateFn=Lt(this.editSettings.footerTemplate),!Object(m.X)(this.parentDetails)){var h=Object(m.X)(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue;this.query.where(this.queryString,"equal",h,!0)}this.initForeignColumn()}},{key:"initForeignColumn",value:function(){this.isForeignKeyEnabled(this.getColumns())&&this.notify("initForeignKeyColumn",this.getForeignKeyColumns())}},{key:"gridRender",value:function(){this.updateRTL(),this.enableHover&&this.element.classList.add("e-gridhover"),m.d.isDevice&&this.element.classList.add("e-device"),this.rowHeight&&this.element.classList.add("e-grid-min-height"),Object(m.A)(this.element,["e-responsive","e-default"],[]);var e=this.serviceLocator.getService("rendererFactory");this.headerModule=e.getRenderer(U.Header),this.contentModule=e.getRenderer(U.Content),this.printModule=new jt(this,this.scrollModule),this.clipboardModule=new ht(this),this.renderModule.render(),this.eventInitializer(),this.createGridPopUpElement(),this.widthService.setWidthToColumns(),this.updateGridLines(),this.applyTextWrap(),this.createTooltip(),this.enableBoxSelection()}},{key:"dataReady",value:function(){this.scrollModule.setWidth(),this.scrollModule.setHeight(),"auto"!==this.height&&this.scrollModule.setPadding()}},{key:"updateRTL",value:function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},{key:"createGridPopUpElement",value:function(){var e=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),t=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});Object(m.w)([t,this.createElement("div",{className:"e-uptail e-tail"})],e),t.appendChild(this.createElement("span")),Object(m.w)([t,this.createElement("div",{className:"e-downtail e-tail"})],e),this.element.appendChild(e)}},{key:"updateGridLines",value:function(){switch(Object(m.A)(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()}},{key:"updateResizeLines",value:function(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")}},{key:"applyTextWrap",value:function(){if(this.allowTextWrap){var e=[].slice.call(this.element.querySelectorAll(".e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":hi(this.element,!1),hi(this.getContent(),!1),hi(e,!0);break;case"Content":hi(this.getContent(),!0),hi(this.element,!1),hi(e,!1);break;default:hi(this.element,!0),hi(this.getContent(),!1),hi(e,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify("refreshResizeHandlers",{})}}},{key:"removeTextWrap",value:function(){hi(this.element,!1),hi([].slice.call(this.element.querySelectorAll(".e-columnheader")),!1),hi(this.getContent(),!1),"Content"!==this.textWrapSettings.wrapMode&&this.notify("refreshResizeHandlers",{})}},{key:"createTooltip",value:function(){this.toolTipObj=new b.d({opensOn:"custom",content:""},this.element)}},{key:"freezeRefresh",value:function(){this.isFreezeRefresh=!0,this.enableVirtualization&&(this.pageSettings.currentPage=1),this.componentRefresh()}},{key:"getTooltipStatus",value:function(e){var t,i=this.getHeaderTable(),n=(this.getContentTable(),this.createTable(i,"e-gridheader","header")),r=this.createTable(i,"e-gridheader","content"),s=e.classList.contains("e-headercell")?n:r,a=e.classList.contains("e-headercell")?"th":"tr";return s.querySelector(a).className=e.className,s.querySelector(a).innerHTML=e.innerHTML,t=s.querySelector(a).getBoundingClientRect().width,document.body.removeChild(n),document.body.removeChild(r),t>e.getBoundingClientRect().width}},{key:"mouseMoveHandler",value:function(e){if(this.isEllipsisTooltip()){var t=Wt(e.target,"e-ellipsistooltip");this.prevElement===t&&"mouseout"!==e.type||this.toolTipObj.close();var i=e.target.tagName;if(t&&"mouseout"!==e.type&&(!m.d.isDevice||-1===["A","BUTTON","INPUT"].indexOf(i))){if(t.getAttribute("aria-describedby"))return;this.getTooltipStatus(t)&&(this.toolTipObj.content=t.getElementsByClassName("e-headertext").length?t.getElementsByClassName("e-headertext")[0].innerText:t.innerText,this.prevElement=t,this.toolTipObj.open(t))}}this.hoverFrozenRows(e)}},{key:"hoverFrozenRows",value:function(e){if(this.isFrozenGrid()){var t=Wt(e.target,"e-row");if([].slice.call(this.element.querySelectorAll(".e-frozenhover")).length&&"mouseout"===e.type)for(var i=[].slice.call(this.element.querySelectorAll(".e-frozenhover")),n=0;n<i.length;n++)i[n].classList.remove("e-frozenhover");else if(t){var r=[].slice.call(this.element.querySelectorAll('tr[aria-rowindex="'+t.getAttribute("aria-rowindex")+'"]'));r.splice(r.indexOf(t),1);for(var s=0;s<r.length;s++)"true"!=t.getAttribute("aria-selected")&&r[s]?r[s].classList.add("e-frozenhover"):r[s]&&r[s].classList.remove("e-frozenhover")}}}},{key:"isEllipsisTooltip",value:function(){var e=this.getColumns();if("EllipsisWithTooltip"===this.clipMode)return!0;for(var t=0;t<e.length;t++)if("EllipsisWithTooltip"===e[t].clipMode)return!0;return!1}},{key:"scrollHandler",value:function(){this.isEllipsisTooltip()&&this.toolTipObj.close()}},{key:"createTable",value:function(e,t,i){var n=this.createElement("div");n.className=this.element.className,n.style.cssText="display: inline-block;visibility:hidden;position:absolute";var r=this.createElement("div");r.className=t;var s=this.createElement("table");s.className=e.className,s.style.cssText="table-layout: auto;width: auto";var a="header"===i?"th":"td",l=this.createElement("tr"),o=this.createElement(a);return l.appendChild(o),s.appendChild(l),r.appendChild(s),n.appendChild(r),document.body.appendChild(n),n}},{key:"onKeyPressed",value:function(e){"tab"!==e.action&&"shiftTab"!==e.action||this.toolTipObj.close()}},{key:"wireEvents",value:function(){m.l.add(this.element,"click",this.mouseClickHandler,this),m.l.add(this.element,"touchend",this.mouseClickHandler,this),m.l.add(this.element,"focusout",this.focusOutHandler,this),m.l.add(this.element,"dblclick",this.dblClickHandler,this),m.l.add(this.element,"keydown",this.keyPressHandler,this),m.l.add(window,"resize",this.resetIndentWidth,this),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex),this.keyboardModule=new m.o(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),m.l.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this),m.l.add(this.element,"mousemove",this.mouseMoveHandler,this),m.l.add(this.element,"mouseout",this.mouseMoveHandler,this),m.l.add(this.getContent(),"touchstart",this.tapEvent,this),m.l.add(document.body,"keydown",this.keyDownHandler,this)}},{key:"unwireEvents",value:function(){m.l.remove(this.element,"click",this.mouseClickHandler),m.l.remove(this.element,"touchend",this.mouseClickHandler),m.l.remove(this.element,"focusout",this.focusOutHandler),m.l.remove(this.element,"dblclick",this.dblClickHandler),m.l.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler),m.l.remove(this.element,"mousemove",this.mouseMoveHandler),m.l.remove(this.element,"mouseout",this.mouseMoveHandler),m.l.remove(this.element,"keydown",this.keyPressHandler),m.l.remove(this.getContent(),"touchstart",this.tapEvent),m.l.remove(document.body,"keydown",this.keyDownHandler),m.l.remove(window,"resize",this.resetIndentWidth)}},{key:"addListener",value:function(){this.isDestroyed||(this.on(T,this.dataReady,this),this.on(A,this.recalcIndentWidth,this),this.on(q,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(I,this.dataBoundFunction),this.on(V,this.onKeyPressed,this),this.on(A,this.blazorTemplate,this))}},{key:"removeListener",value:function(){this.isDestroyed||(this.off(T,this.dataReady),this.off(A,this.recalcIndentWidth),this.off(q,this.recalcIndentWidth),this.removeEventListener(I,this.dataBoundFunction),this.off(V,this.onKeyPressed))}},{key:"blazorTemplate",value:function(){if(Object(m.W)()){this.pageSettings.template&&Object(m.sb)(this.element.id+"_template","Template",this.pageSettings);for(var e=0;e<this.columnModel.length;e++){if(this.columnModel[e].template&&Object(m.sb)(this.element.id+this.columnModel[e].uid,"Template",this.columnModel[e],!1),this.columnModel[e].headerTemplate&&Object(m.sb)(this.element.id+this.columnModel[e].uid+"headerTemplate","HeaderTemplate",this.columnModel[e],!1),"FilterBar"==this.filterSettings.type&&this.columnModel[e].filterTemplate){for(var t=this.columnModel[e].field,i=this.element.id+this.columnModel[e].uid+"filterTemplate",n=this.filterSettings.columns,r=0;r<n.length;r++)t==n[r].field&&(m.z[i][0][t]=n[r].value);Object(m.sb)(this.element.id+this.columnModel[e].uid+"filterTemplate","FilterTemplate",this.columnModel[e],!1)}"FilterBar"!=this.filterSettings.type&&this.columnModel[e].filterTemplate&&Object(m.sb)(this.element.id+this.columnModel[e].uid+"filterTemplate","FilterTemplate",this.columnModel[e])}this.groupSettings.captionTemplate&&Object(m.sb)(this.element.id+"captionTemplate","CaptionTemplate",this.groupSettings);for(var s=0;s<this.aggregates.length;s++)for(var a=0;a<this.aggregates[s].columns.length;a++)this.aggregates[s].columns[a].footerTemplate&&Object(m.sb)(this.element.id+this.aggregates[s].columns[a].guid+"footerTemplate","FooterTemplate",this.aggregates[s].columns[a]),this.aggregates[s].columns[a].groupFooterTemplate&&Object(m.sb)(this.element.id+this.aggregates[s].columns[a].guid+"groupFooterTemplate","GroupFooterTemplate",this.aggregates[s].columns[a]),this.aggregates[s].columns[a].groupCaptionTemplate&&Object(m.sb)(this.element.id+this.aggregates[s].columns[a].guid+"groupCaptionTemplate","GroupCaptionTemplate",this.aggregates[s].columns[a])}}},{key:"getCurrentViewRecords",value:function(){return Si(this)?Object(m.X)(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData}},{key:"mouseClickHandler",value:function(e){if(!(this.isChildGrid(e)||Wt(e.target,"e-gridpopup")&&e.touches||this.element.querySelectorAll(".e-cloneproperties").length||this.checkEdit(e))&&((this.allowRowDragAndDrop||!Wt(e.target,"e-gridcontent")&&"TD"!==e.target.tagName)&&(this.allowGrouping||this.allowReordering||!Wt(e.target,"e-gridheader"))||!e.touches)){Wt(e.target,"e-gridheader")&&this.allowRowDragAndDrop&&!Wt(e.target,"e-filterbarcell")&&e.preventDefault();var t=this.getRowInfo(e.target);t.cancel=!1;var i=!1,n=Object(m.C)(e.target,"tr");if(n&&n.getAttribute("data-uid")){var r=this.getRowObjectFromUID(n.getAttribute("data-uid"));i=!!r&&r.isDataRow}if(Object(m.W)()){var s=Object(m.K)({},t.column);t={rowData:t.rowData,rowIndex:t.rowIndex,cellIndex:t.cellIndex,column:s}}i&&this.trigger("recordClick",t),this.notify(H,e)}}},{key:"checkEdit",value:function(e){var t=Wt(e.target,"e-row"),i="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains("e-editedrow")||t.classList.contains("e-addedrow"));return!Wt(e.target,"e-unboundcelldiv")&&(i||Wt(e.target,"e-rowcell")&&Wt(e.target,"e-rowcell").classList.contains("e-editedbatchcell"))}},{key:"dblClickHandler",value:function(e){var t=Wt(e.target,"e-grid");if(!Object(m.X)(t)&&t.id===this.element.id&&!Object(m.C)(e.target,".e-unboundcelldiv")){var i=!1,n=Object(m.C)(e.target,"tr");if(n&&n.getAttribute("data-uid")){var r=this.getRowObjectFromUID(n.getAttribute("data-uid"));i=!!r&&r.isDataRow}var s=this.getRowInfo(e.target);s.target=e.target,i&&this.trigger("recordDoubleClick",s),this.notify("dblclick",e)}}},{key:"focusOutHandler",value:function(e){if(!this.isChildGrid(e)){Wt(e.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None");var t=this.element.querySelector(".e-cancel:not(.e-hide)");t&&t.classList.add("e-hide");var i=e.relatedTarget,n=i?i.getAttribute("aria-owns"):null;i&&(Wt(i,"e-grid")||(!Object(m.X)(n)&&n)===e.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||m.d.isDevice||("Batch"===this.editSettings.mode&&(this.editModule.saveCell(),this.notify("editNextValCell",{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1}}},{key:"isChildGrid",value:function(e){var t=Wt(e.target,"e-grid");return!(!t||t.id===this.element.id)}},{key:"mergePersistGridData",value:function(e){var t=this.getLocalData();if(!Object(m.X)(t)&&""!==t||!Object(m.X)(e)){var i=Object(m.X)(e)?JSON.parse(t):e;this.enableVirtualization&&(i.pageSettings.currentPage=1);var n=Object.keys(i);this.isProtectedOnChange=!0;for(var r=0,s=n;r<s.length;r++){var a=s[r];"object"!=typeof this[a]||Object(m.X)(this[a])?this[a]=i[a]:Array.isArray(this[a])&&"columns"===a?(Object(m.W)()&&this.isServerRendered||qt(this[a]),this.mergeColumns(i[a],this[a]),this[a]=i[a]):Object(m.K)(this[a],i[a])}this.isProtectedOnChange=!1}}},{key:"mergeColumns",value:function(e,t){for(var i=this,n=e,r=function(e){var r=t.filter((function(t){return t.index===n[e].index}))[0];Object(m.X)(r)||(r.columns&&r.columns.length?(i.mergeColumns(n[e].columns,r.columns),n[e]=Object(m.K)(r,n[e],{},!0)):(Object(m.W)()&&(n[e].guid=r.guid,n[e].uid=r.uid),n[e]=Object(m.K)(r,n[e],{},!0)))},s=0;s<n.length;s++)r(s)}},{key:"isDetail",value:function(){return!Object(m.X)(this.detailTemplate)||!Object(m.X)(this.childGrid)}},{key:"isCommandColumn",value:function(e){var t=this;return e.some((function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)}))}},{key:"isForeignKeyEnabled",value:function(e){var t=this;return e.some((function(e){return e.columns?t.isForeignKeyEnabled(e.columns):!(!e.dataSource||!e.foreignKeyValue)}))}},{key:"keyPressHandler",value:function(e){var t=Object(m.K)(e,{cancel:!1});this.trigger("keyPressed",t),!0===t.cancel&&e.stopImmediatePropagation()}},{key:"keyDownHandler",value:function(e){e.altKey&&(74===e.keyCode&&(this.keyA?(this.notify("group-collapse",{target:e.target,collapse:!1}),this.keyA=!1):(this.focusModule.focusHeader(),this.focusModule.addOutline())),87===e.keyCode&&(this.focusModule.focusContent(),this.focusModule.addOutline()),65===e.keyCode&&(this.keyA=!0),72===e.keyCode&&this.keyA&&(this.notify("group-collapse",{target:e.target,collapse:!0}),this.keyA=!1))}},{key:"keyActionHandler",value:function(e){this.isChildGrid(e)||this.isEdit&&"escape"!==e.action&&"enter"!==e.action&&"shiftEnter"!==e.action&&"tab"!==e.action&&"shiftTab"!==e.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===e.action&&(e.preventDefault(),this.print()),this.notify(V,e)))}},{key:"setInjectedModules",value:function(e){this.injectedModules=e}},{key:"updateColumnObject",value:function(){Vt(this.columns,this.enableColumnVirtualization,this),Object(m.W)()&&this.isServerRendered||qt(this.columns),this.initForeignColumn(),this.notify(X,{})}},{key:"getForeignKeyColumns",value:function(){return this.getColumns().filter((function(e){return e.isForeignColumn()}))}},{key:"getRowHeight",value:function(){return this.rowHeight?this.rowHeight:function(e){if(void 0!==ei)return ei;var t=Object(m.F)("table",{className:"e-table",styles:"visibility: hidden"});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(t);var i=t.querySelector("td").getBoundingClientRect();return e.removeChild(t),ei=Math.ceil(i.height)}(this.element)}},{key:"refreshColumns",value:function(){this.setFrozenCount();var e=this.getContent().querySelector(".e-frozen-left-content"),t=this.getContent().querySelector(".e-frozen-right-content"),i=!this.frozenRightCount&&!this.frozenLeftCount;if(0===this.getFrozenColumns()&&(!e&&this.frozenLeftCount||!t&&this.frozenRightCount||e&&!this.frozenLeftCount||t&&!this.frozenRightCount))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(i&&(1===this.getFrozenColumns()&&!e||0===this.getFrozenColumns()&&e))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.isFrozenGrid()){var n=this.contentModule.getMovableContent().querySelector(".e-table");Object(m.hb)(n.querySelector("colgroup"));var r=this.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);if(n.insertBefore(r,n.querySelector("tbody")),"Left-Right"===this.getFrozenMode()){var s=this.contentModule.getFrozenRightContent().querySelector(".e-table");Object(m.hb)(s.querySelector("colgroup"));var a=this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").cloneNode(!0);s.insertBefore(a,s.querySelector("tbody"))}}if(this.isFrozenGrid()){var l=this.getContent().querySelector(".e-movablescrollbar").scrollLeft;this.headerModule.getMovableHeader().scrollLeft=l,this.contentModule.getMovableContent().scrollLeft=l}}},{key:"excelExport",value:function(e,t,i,n){return Object(m.W)()?(this.excelExportModule.Map(this,e,t,i,!1,n),null):this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!1,n):null}},{key:"csvExport",value:function(e,t,i,n){return Object(m.W)()?(this.excelExportModule.Map(this,e,t,i,!0,n),null):this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!0,n):null}},{key:"pdfExport",value:function(e,t,i,n){return Object(m.W)()?(this.pdfExportModule.Map(this,e,t,i,n),null):this.pdfExportModule?this.pdfExportModule.Map(this,e,t,i,n):null}},{key:"groupColumn",value:function(e){this.groupModule&&this.groupModule.groupColumn(e)}},{key:"groupExpandAll",value:function(){this.groupModule&&this.groupModule.expandAll()}},{key:"groupCollapseAll",value:function(){this.groupModule&&this.groupModule.collapseAll()}},{key:"clearGrouping",value:function(){this.groupModule&&this.groupModule.clearGrouping()}},{key:"ungroupColumn",value:function(e){this.groupModule&&this.groupModule.ungroupColumn(e)}},{key:"openColumnChooser",value:function(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)}},{key:"scrollRefresh",value:function(){var e=this;this.on(A,(function t(){e.scrollModule.refresh(),e.off(A,t)}),this)}},{key:"detailCollapseAll",value:function(){this.detailRowModule&&this.detailRowModule.collapseAll()}},{key:"detailExpandAll",value:function(){this.detailRowModule&&this.detailRowModule.expandAll()}},{key:"clearCellSelection",value:function(){this.selectionModule&&this.selectionModule.clearCellSelection()}},{key:"clearRowSelection",value:function(){this.selectionModule&&this.selectionModule.clearRowSelection()}},{key:"selectCells",value:function(e){this.selectionModule&&this.selectionModule.selectCells(e)}},{key:"selectRowsByRange",value:function(e,t){this.selectionModule&&this.selectionModule.selectRowsByRange(e,t)}},{key:"isContextMenuOpen",value:function(){return this.contextMenuModule&&this.contextMenuModule.isOpen}},{key:"ensureModuleInjected",value:function(e){return this.getInjectedModules().indexOf(e)>=0}},{key:"destroyTemplate",value:function(e,t){this.clearTemplate(e,t)}},{key:"log",value:function(e,t){this.loggerModule&&this.loggerModule.log(e,t)}},{key:"applyBiggerTheme",value:function(e){this.element.classList.contains("e-bigger")&&e.classList.add("e-bigger")}},{key:"getPreviousRowData",value:function(){return this.getRowsObject()[this.getRows().length-1].data}},{key:"hideScroll",value:function(){var e=this.getContent().querySelector(".e-content"),t=this.getContent().querySelector(".e-scrollbar");if(e.scrollHeight<=e.clientHeight&&(this.scrollModule.removePadding(),e.style.overflowY="auto"),this.isFrozenGrid()&&t){var i=this.getContent().querySelector(".e-movablescrollbar"),n=this.getContent().querySelector(".e-movablechild");t.style.display="flex",i.offsetWidth>=n.offsetWidth&&(t.style.display="none",this.notify("frozenHeight",0))}}},{key:"getRowIndexByPrimaryKey",value:function(e){var t=this.getPrimaryKeyFieldNames()[0];e="object"==typeof e?e[t]:e;for(var i=0;i<this.getRowsObject().length;i++)if(this.getRowsObject()[i].data[t]===e)return this.getRowsObject()[i].index;return-1}},{key:"grabColumnByFieldFromAllCols",value:function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var i=this.columnModel,n=0;n<i.length;n++)e===i[n].field&&(t=i[n]);return t}},{key:"grabColumnByUidFromAllCols",value:function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var i=this.columnModel,n=0;n<i.length;n++)e===i[n].uid&&(t=i[n]);return t}},{key:"getFilteredRecords",value:function(){if(this.allowFiltering&&this.filterSettings.columns.length){var e=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof v.a?this.renderModule.data.getData(this.dataSource,e):this.dataSource instanceof v.a?this.dataSource.executeLocal(e):new v.a(this.dataSource,e).executeLocal(e)}return[]}},{key:"getUserAgent",value:function(){var e=m.d.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)}},{key:"tapEvent",value:function(e){this.getUserAgent()&&(ti.timer?(clearTimeout(ti.timer),ti.timer=null,this.dblClickHandler(e),this.notify("double-tap",e)):ti.timer=setTimeout((function(){ti.timer=null}),300))}},{key:"getRowUid",value:function(e){return"".concat(e).concat(this.rowUid++)}},{key:"getMovableVirtualContent",value:function(){return this.getContent().querySelector(".e-movablecontent")}},{key:"getFrozenVirtualContent",value:function(){return this.getContent().querySelector(".e-frozencontent")}},{key:"getMovableVirtualHeader",value:function(){return this.getHeaderContent().querySelector(".e-movableheader")}},{key:"getFrozenVirtualHeader",value:function(){return this.getHeaderContent().querySelector(".e-frozenheader")}},{key:"getRowElementByUID",value:function(e){var t,i=[];if(this.isFrozenGrid()){var n=[].slice.call(this.getFrozenVirtualContent().querySelector("tbody").children),r=[].slice.call(this.getMovableVirtualContent().querySelector("tbody").children),s=[];if(3===this.tablesCount&&(s=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector("tbody").children)),this.frozenRows){if(i=(i=[].slice.call(this.getFrozenVirtualHeader().querySelector("tbody").children)).concat([].slice.call(this.getMovableVirtualHeader().querySelector("tbody").children)),3===this.tablesCount){var a=this.getHeaderContent().querySelector(".e-frozen-right-header");i=i.concat([].slice.call(a.querySelector("tbody").children)).concat(s)}i=i.concat(n).concat(r)}else i=n.concat(r).concat(s)}else{var l=[].slice.call(this.getContent().querySelector("tbody").children);i=this.frozenRows?(i=[].slice.call(this.getHeaderContent().querySelector("tbody").children)).concat(l):l}var o,h=c(i);try{for(h.s();!(o=h.n()).done;){var u=o.value;if(u.getAttribute("data-uid")===e){t=u;break}}}catch(d){h.e(d)}finally{h.f()}return t}},{key:"getHiddenColumns",value:function(){var e,t=[],i=c(this.columnModel);try{for(i.s();!(e=i.n()).done;){var n=e.value;!1===n.visible&&t.push(n)}}catch(r){i.e(r)}finally{i.f()}return t}},{key:"calculatePageSizeByParentHeight",value:function(e){if(this.allowPaging&&(this.allowTextWrap&&"Header"==this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if(-1!=e.indexOf("%")&&(e=parseInt(e)/100*this.element.clientHeight),e>this.getNoncontentHeight()+this.getRowHeight()&&(t=(e-this.getNoncontentHeight())/this.getRowHeight()),t>0)return Math.floor(t)}return 0}},{key:"getNoncontentHeight",value:function(){var e=0;if(Object(m.X)(this.getHeaderContent().clientHeight)||(e+=this.getHeaderContent().clientHeight),this.toolbar&&!Object(m.X)(this.element.querySelector(".e-toolbar").clientHeight)&&(e+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!Object(m.X)(this.element.querySelector(".e-gridpager").clientHeight)&&(e+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!Object(m.X)(this.element.querySelector(".e-columnheader").clientHeight)&&(e+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!Object(m.X)(this.element.querySelector(".e-groupdroparea").clientHeight)&&(e+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!Object(m.X)(this.element.querySelector(".e-summaryrow").clientHeight))for(var t=0;t<this.element.querySelectorAll(".e-summaryrow").length;t++)e+=this.element.querySelectorAll(".e-summaryrow")[t].clientHeight;return e}},{key:"getSummaryValues",value:function(e,t){return v.b.aggregates[e.type.toLowerCase()](t,e.field)}},{key:"serverExcelExport",value:function(e){this.exportGrid(e)}},{key:"serverPdfExport",value:function(e){this.exportGrid(e)}},{key:"exportGrid",value:function(e){var t=this,i=this,n=i.getDataModule().generateQuery(!0),r=(new v.h).processQuery(new v.a({url:""}),n).data,s=JSON.parse(this.addOnPersist(["allowGrouping","allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","groupSettings","columns","locale","searchSettings"]));s.columns.forEach((function(e){i.getColumnByUid(e.uid)&&(e.headerText=i.getColumnByUid(e.uid).headerText,e.format)&&(e.format=en("object"==typeof e.format?e.format.format:e.format,e.type)),e.columns&&t.setHeaderText(e.columns)}));var a=this.createElement("form",{id:"ExportForm",styles:"display:none;"}),l=this.createElement("input",{id:"gridInput",attrs:{name:"gridModel"}}),o=this.createElement("input",{id:"queryInput",attrs:{name:"requestModel"}});l.value=JSON.stringify(s),o.value=r,a.method="POST",a.action=e,a.appendChild(l),a.appendChild(o),document.body.appendChild(a),a.submit(),a.remove()}},{key:"setHeaderText",value:function(e){for(var t=0;t<e.length;t++){if(e[t].headerText=this.getColumnByUid(e[t].uid).headerText,e[t].format){var i=e[t];e[t].format=en("object"==typeof i.format?i.format.format:i.format,e[t].type)}e[t].columns&&this.setHeaderText(e[t].columns)}}},{key:"isCollapseStateEnabled",value:function(){return!1===this.isExpanded}},{key:"updateRowValue",value:function(e,t){var i={requestType:"save",data:t};this.showSpinner(),this.notify("update-data",i),this.refresh()}},{key:"setForeignKeyData",value:function(){this.dataBind();var e=this.getDataModule().getForeignKeyDataState();e.isPending?(this.getDataModule().setForeignKeyDataState({}),e.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())}},{key:"resetFilterDlgPosition",value:function(e){var t=this.getColumnHeaderByField(e);if(t){var i=t.querySelector(".e-filtermenudiv"),n=this.element.querySelector(".e-filter-popup");if(i&&n){var r=this.element.getBoundingClientRect(),s=i.getBoundingClientRect();n&&(n.style.left=(s.right-r.left).toString()+"px")}}}},{key:"renderTemplates",value:function(){this.notify("reactTemplateRender",this.portals),this.renderReactTemplates()}},{key:"batchUpdate",value:function(e){this.processRowChanges(e)}},{key:"batchAsyncUpdate",value:function(e){this.processBulkRowChanges(e)}},{key:"processBulkRowChanges",value:function(e){var t=this;if(this.dataToBeUpdated)for(var i=["addedRecords","changedRecords","deletedRecords"],n=this.getPrimaryKeyFieldNames()[0],r=0;r<i.length;r++)e[i[r]]&&qi(this,e,i[r],n);else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e),setTimeout((function(){t.processRowChanges(t.dataToBeUpdated),t.dataToBeUpdated=null}),this.asyncTimeOut)}},{key:"processRowChanges",value:function(e){var t=this,i=this.getPrimaryKeyFieldNames()[0];e=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e);var n=this.getDataModule().saveChanges(e,i,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?n.then((function(e){t.setNewData()})):this.setNewData()}},{key:"setNewData",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then((function(i){e.bulkRefresh(i.result,t,i.count)}))}},{key:"deleteRowElement",value:function(e){var t=this.getRowElementByUID(e.uid),i=parseInt(t.getAttribute("aria-rowindex"),10);if(Object(m.hb)(t),this.getFrozenColumns()){var n=this.getMovableRows()[i];Object(m.hb)(n)}}},{key:"bulkRefresh",value:function(e,t,i){for(var n=this,r=this.getRowsObject(),s=this.getPrimaryKeyFieldNames()[0],a=function(t){e.filter((function(e){return e[s]===r[t].data[s]})).length||(n.deleteRowElement(r[t]),r.splice(t,1),t--),l=t},l=0;l<r.length;l++)a(l);for(var o=function(i){var r=void 0;t.filter((function(t){t[s]===e[i][s]&&(t!==e[i]&&n.setRowData(e[i][s],e[i]),r=!0)})),r||n.renderRowElement(e[i],i)},h=0;h<e.length;h++)o(h);this.currentViewData=e;var c=[].slice.call(this.getContentTable().querySelectorAll(".e-row"));Pi(this,this.getRowsObject(),c),Vi(this),this.allowPaging&&this.notify(B,{module:"pager",properties:{totalRecordsCount:i}})}},{key:"renderRowElement",value:function(e,t){var i,n=new Z(this.serviceLocator,null,this),r=new $(this).generateRows([e]),s=n.render(r[0],this.getColumns());this.addRowObject(r[0],t);var a=this.getContentTable().querySelector("tbody");if(a.querySelector(".e-emptyrow")){var l=a.querySelector(".e-emptyrow");if(l.parentNode.removeChild(l),this.getFrozenColumns()){var o=this.getContent().querySelector(".e-movablecontent").querySelector("tbody");o.firstElementChild.parentNode.removeChild(o.firstElementChild)}}this.getFrozenColumns()&&(i=ki(s,this.getFrozenColumns(),this),(this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.getContent().querySelector(".e-movablecontent").querySelector("tbody")).appendChild(i),"auto"===this.height&&this.notify("frozenHeight",{})),a=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("tbody"):this.getContent().querySelector("tbody"),(a=this.getContent().querySelector("tbody")).appendChild(s)}},{key:"addRowObject",value:function(e,t){var i=this.getFrozenColumns();if(i){var n=this.getMovableRowsObject(),r=e.clone();r.cells=r.cells.slice(i),e.cells=e.cells.slice(0,i),n.splice(t,1,r)}this.getRowsObject().splice(t,1,e)}},{key:"getHeight",value:function(e){return Number.isInteger(e)||-1==e.indexOf("%")?Number.isInteger(e)||"auto"===this.height?this.height:parseInt(e):parseInt(e)/100*this.element.clientHeight}},{key:"getFrozenRightContent",value:function(){return this.getContent().querySelector(".e-frozen-right-content")}},{key:"getFrozenRightHeader",value:function(){return this.getHeaderContent().querySelector(".e-frozen-right-header")}},{key:"getMovableHeaderTbody",value:function(){return this.getMovableVirtualHeader().querySelector("tbody")}},{key:"getMovableContentTbody",value:function(){return this.getMovableVirtualContent().querySelector("tbody")}},{key:"getFrozenHeaderTbody",value:function(){return this.getFrozenVirtualHeader().querySelector("tbody")}},{key:"getFrozenLeftContentTbody",value:function(){return this.getFrozenVirtualContent().querySelector("tbody")}},{key:"getFrozenRightHeaderTbody",value:function(){return this.getFrozenRightHeader().querySelector("tbody")}},{key:"getFrozenRightContentTbody",value:function(){var e;return this.getFrozenRightContent()&&(e=this.getFrozenRightContent().querySelector("tbody")),e}}]),r}(m.h),ut([Object(m.s)()],ge.prototype,"parentDetails",void 0),ut([Object(m.s)([])],ge.prototype,"columns",void 0),ut([Object(m.s)(!0)],ge.prototype,"enableAltRow",void 0),ut([Object(m.s)(!0)],ge.prototype,"enableHover",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableAutoFill",void 0),ut([Object(m.s)(!0)],ge.prototype,"allowKeyboard",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowTextWrap",void 0),ut([Object(m.g)({},Ct)],ge.prototype,"textWrapSettings",void 0),ut([Object(m.g)({},wt)],ge.prototype,"resizeSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowPaging",void 0),ut([Object(m.g)({},et)],ge.prototype,"pageSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableVirtualization",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableColumnVirtualization",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableInfiniteScrolling",void 0),ut([Object(m.g)({},bt)],ge.prototype,"searchSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowSorting",void 0),ut([Object(m.s)("Ellipsis")],ge.prototype,"clipMode",void 0),ut([Object(m.s)(!0)],ge.prototype,"allowMultiSorting",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowExcelExport",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowPdfExport",void 0),ut([Object(m.g)({},pt)],ge.prototype,"sortSettings",void 0),ut([Object(m.g)({},ft)],ge.prototype,"infiniteScrollSettings",void 0),ut([Object(m.s)(!0)],ge.prototype,"allowSelection",void 0),ut([Object(m.s)(-1)],ge.prototype,"selectedRowIndex",void 0),ut([Object(m.g)({},vt)],ge.prototype,"selectionSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowFiltering",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowReordering",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowResizing",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowRowDragAndDrop",void 0),ut([Object(m.g)({},yt)],ge.prototype,"rowDropSettings",void 0),ut([Object(m.g)({},mt)],ge.prototype,"filterSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"allowGrouping",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableImmutableMode",void 0),ut([Object(m.s)(!1)],ge.prototype,"showColumnMenu",void 0),ut([Object(m.g)({},kt)],ge.prototype,"groupSettings",void 0),ut([Object(m.g)({},St)],ge.prototype,"editSettings",void 0),ut([Object(m.f)([],ot)],ge.prototype,"aggregates",void 0),ut([Object(m.s)(!1)],ge.prototype,"showColumnChooser",void 0),ut([Object(m.g)({},tt)],ge.prototype,"columnChooserSettings",void 0),ut([Object(m.s)(!1)],ge.prototype,"enableHeaderFocus",void 0),ut([Object(m.s)("auto")],ge.prototype,"height",void 0),ut([Object(m.s)("auto")],ge.prototype,"width",void 0),ut([Object(m.s)("Default")],ge.prototype,"gridLines",void 0),ut([Object(m.s)()],ge.prototype,"rowTemplate",void 0),ut([Object(m.s)()],ge.prototype,"detailTemplate",void 0),ut([Object(m.s)()],ge.prototype,"childGrid",void 0),ut([Object(m.s)()],ge.prototype,"queryString",void 0),ut([Object(m.s)("AllPages")],ge.prototype,"printMode",void 0),ut([Object(m.s)("Expanded")],ge.prototype,"hierarchyPrintMode",void 0),ut([Object(m.s)([])],ge.prototype,"dataSource",void 0),ut([Object(m.s)(null)],ge.prototype,"rowHeight",void 0),ut([Object(m.s)()],ge.prototype,"query",void 0),ut([Object(m.s)("USD")],ge.prototype,"currencyCode",void 0),ut([Object(m.s)()],ge.prototype,"toolbar",void 0),ut([Object(m.s)()],ge.prototype,"contextMenuItems",void 0),ut([Object(m.s)()],ge.prototype,"columnMenuItems",void 0),ut([Object(m.s)()],ge.prototype,"toolbarTemplate",void 0),ut([Object(m.s)()],ge.prototype,"pagerTemplate",void 0),ut([Object(m.s)(0)],ge.prototype,"frozenRows",void 0),ut([Object(m.s)(0)],ge.prototype,"frozenColumns",void 0),ut([Object(m.s)("All")],ge.prototype,"columnQueryMode",void 0),ut([Object(m.s)({})],ge.prototype,"currentAction",void 0),ut([Object(m.s)("18.4.39")],ge.prototype,"ej2StatePersistenceVersion",void 0),ut([Object(m.k)()],ge.prototype,"created",void 0),ut([Object(m.k)()],ge.prototype,"destroyed",void 0),ut([Object(m.k)()],ge.prototype,"load",void 0),ut([Object(m.k)()],ge.prototype,"rowDataBound",void 0),ut([Object(m.k)()],ge.prototype,"queryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"headerCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"actionBegin",void 0),ut([Object(m.k)()],ge.prototype,"actionComplete",void 0),ut([Object(m.k)()],ge.prototype,"actionFailure",void 0),ut([Object(m.k)()],ge.prototype,"dataBound",void 0),ut([Object(m.k)()],ge.prototype,"recordDoubleClick",void 0),ut([Object(m.k)()],ge.prototype,"recordClick",void 0),ut([Object(m.k)()],ge.prototype,"rowSelecting",void 0),ut([Object(m.k)()],ge.prototype,"rowSelected",void 0),ut([Object(m.k)()],ge.prototype,"rowDeselecting",void 0),ut([Object(m.k)()],ge.prototype,"rowDeselected",void 0),ut([Object(m.k)()],ge.prototype,"cellSelecting",void 0),ut([Object(m.k)()],ge.prototype,"cellSelected",void 0),ut([Object(m.k)()],ge.prototype,"cellDeselecting",void 0),ut([Object(m.k)()],ge.prototype,"cellDeselected",void 0),ut([Object(m.k)()],ge.prototype,"columnSelecting",void 0),ut([Object(m.k)()],ge.prototype,"columnSelected",void 0),ut([Object(m.k)()],ge.prototype,"columnDeselecting",void 0),ut([Object(m.k)()],ge.prototype,"columnDeselected",void 0),ut([Object(m.k)()],ge.prototype,"columnDragStart",void 0),ut([Object(m.k)()],ge.prototype,"columnDrag",void 0),ut([Object(m.k)()],ge.prototype,"columnDrop",void 0),ut([Object(m.k)()],ge.prototype,"printComplete",void 0),ut([Object(m.k)()],ge.prototype,"beforePrint",void 0),ut([Object(m.k)()],ge.prototype,"pdfQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"pdfHeaderQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"pdfAggregateQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"excelAggregateQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"exportDetailDataBound",void 0),ut([Object(m.k)()],ge.prototype,"excelQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"excelHeaderQueryCellInfo",void 0),ut([Object(m.k)()],ge.prototype,"beforeExcelExport",void 0),ut([Object(m.k)()],ge.prototype,"excelExportComplete",void 0),ut([Object(m.k)()],ge.prototype,"beforePdfExport",void 0),ut([Object(m.k)()],ge.prototype,"pdfExportComplete",void 0),ut([Object(m.k)()],ge.prototype,"rowDragStartHelper",void 0),ut([Object(m.k)()],ge.prototype,"detailDataBound",void 0),ut([Object(m.k)()],ge.prototype,"rowDragStart",void 0),ut([Object(m.k)()],ge.prototype,"rowDrag",void 0),ut([Object(m.k)()],ge.prototype,"rowDrop",void 0),ut([Object(m.k)()],ge.prototype,"toolbarClick",void 0),ut([Object(m.k)()],ge.prototype,"beforeOpenColumnChooser",void 0),ut([Object(m.k)()],ge.prototype,"batchAdd",void 0),ut([Object(m.k)()],ge.prototype,"batchDelete",void 0),ut([Object(m.k)()],ge.prototype,"batchCancel",void 0),ut([Object(m.k)()],ge.prototype,"beforeBatchAdd",void 0),ut([Object(m.k)()],ge.prototype,"beforeBatchDelete",void 0),ut([Object(m.k)()],ge.prototype,"beforeBatchSave",void 0),ut([Object(m.k)()],ge.prototype,"beginEdit",void 0),ut([Object(m.k)()],ge.prototype,"commandClick",void 0),ut([Object(m.k)()],ge.prototype,"cellEdit",void 0),ut([Object(m.k)()],ge.prototype,"cellSave",void 0),ut([Object(m.k)()],ge.prototype,"cellSaved",void 0),ut([Object(m.k)()],ge.prototype,"resizeStart",void 0),ut([Object(m.k)()],ge.prototype,"resizing",void 0),ut([Object(m.k)()],ge.prototype,"resizeStop",void 0),ut([Object(m.k)()],ge.prototype,"keyPressed",void 0),ut([Object(m.k)()],ge.prototype,"beforeDataBound",void 0),ut([Object(m.k)()],ge.prototype,"contextMenuOpen",void 0),ut([Object(m.k)()],ge.prototype,"contextMenuClick",void 0),ut([Object(m.k)()],ge.prototype,"columnMenuOpen",void 0),ut([Object(m.k)()],ge.prototype,"columnMenuClick",void 0),ut([Object(m.k)()],ge.prototype,"checkBoxChange",void 0),ut([Object(m.k)()],ge.prototype,"beforeCopy",void 0),ut([Object(m.k)()],ge.prototype,"beforePaste",void 0),ut([Object(m.k)()],ge.prototype,"beforeAutoFill",void 0),ut([Object(m.k)()],ge.prototype,"columnDataStateChange",void 0),ut([Object(m.k)()],ge.prototype,"dataStateChange",void 0),ut([Object(m.k)()],ge.prototype,"dataSourceChanged",void 0),ut([Object(m.k)()],ge.prototype,"exportGroupCaption",void 0),ut([Object(m.k)()],ge.prototype,"lazyLoadGroupExpand",void 0),ut([Object(m.k)()],ge.prototype,"lazyLoadGroupCollapse",void 0),ge=pe=ut([m.q],ge));var xt,jt=((xt=function(){function e(t,i){p(this,e),this.isAsyncPrint=!1,this.defered=new v.c,this.parent=t,this.parent.isDestroyed||(this.parent.on(A,this.isContentReady(),this),this.parent.addEventListener(D,this.actionBegin.bind(this)),this.parent.on(L,this.onEmpty.bind(this)),this.parent.on("hierarchyprint",this.hierarchyPrint,this),this.scrollModule=i)}return f(e,[{key:"isContentReady",value:function(){var e=this;return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?function(){e.defered.promise.then((function(){e.contentReady()})),e.isPrintGrid()&&e.hierarchyPrint()}:this.contentReady}},{key:"hierarchyPrint",value:function(){this.removeColGroup(this.parent);var e=window.printGridObj;e&&!e.element.querySelector("[aria-busy=true")&&e.printModule.defered.resolve()}},{key:"print",value:function(){this.renderPrintGrid(),this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWind.moveTo(0,0),this.printWind.resizeTo(screen.availWidth,screen.availHeight)}},{key:"onEmpty",value:function(){this.isPrintGrid()&&this.contentReady()}},{key:"actionBegin",value:function(){this.isPrintGrid()&&(this.isAsyncPrint=!0)}},{key:"renderPrintGrid",value:function(){var e=this.parent,t=Object(m.F)("div",{id:this.parent.element.id+"_print",className:e.element.className+" e-print-grid"});document.body.appendChild(t);var i=new Ot(ji(e,e.hierarchyPrintMode));if(e.isFrozenGrid()&&!e.getFrozenColumns())for(var n=0;n<i.columns.length;n++)i.columns[n]=Object(m.K)({},i.columns[n]),i.columns[n].freeze=void 0;this.parent.isAngular&&(i.viewContainerRef=this.parent.viewContainerRef),i.load=function(){},i.query=e.getQuery().clone(),window.printGridObj=i,i.isPrinting=!0;var r=i.getInjectedModules(),s=e.getInjectedModules();r&&r.length===s.length||i.setInjectedModules(s),e.notify("printGrid-Init",{element:t,printgrid:i}),this.parent.log("exporting_begin",this.getModuleName()),i.registeredTemplate=this.parent.registeredTemplate,i.appendTo(t),i.trigger=e.trigger}},{key:"contentReady",value:function(){if(this.isPrintGrid()){var e=this.parent;if(this.isAsyncPrint)return void this.printGrid();var t={requestType:"print",element:e.element,selectedRows:e.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:e.hierarchyPrintMode};if(this.isAsyncPrint||e.trigger("beforePrint",t),t.cancel)return void Object(m.I)(e.element);this.isAsyncPrint||this.printGrid()}}},{key:"printGrid",value:function(){var e=this.parent;if("auto"!==e.height){var t=this.scrollModule.getCssProperties(),i=e.element.querySelector(".e-content"),n=e.element.querySelector(".e-gridheader");i.style.height="auto",i.style.overflowY="auto",n.style[t.padding]="",n.firstElementChild.style[t.border]=""}e.allowGrouping&&(e.groupSettings.columns.length?this.removeColGroup(e):e.element.querySelector(".e-groupdroparea").style.display="none");var r,s=c([].slice.call(e.element.querySelectorAll(".e-content")));try{for(s.s();!(r=s.n()).done;)r.value.style.overflowX="hidden"}catch(u){s.e(u)}finally{s.f()}var a,l=e.element.querySelectorAll(".e-spin-show"),o=c([].slice.call(l));try{for(o.s();!(a=o.n()).done;){var h=a.value;Object(m.A)(h,["e-spin-hide"],["e-spin-show"])}}catch(u){o.e(u)}finally{o.f()}this.printGridElement(e),e.isPrinting=!1,delete window.printGridObj,e.trigger("printComplete",{element:e.element}),this.parent.log("exporting_complete",this.getModuleName())}},{key:"printGridElement",value:function(e){Object(m.A)(e.element,["e-print-grid-layout"],["e-print-grid"]),e.isPrinting&&Object(m.I)(e.element),this.printWind=Object(m.gb)(e.element,this.printWind)}},{key:"removeColGroup",value:function(e){var t=e.groupSettings.columns.length,i=e.element,n="#"+e.element.id;if(t){for(var r=Object(m.mb)(n+"captioncell.e-groupcaption",i),s=r[t-1].getAttribute("colspan"),a=0;a<r.length;a++)r[a].setAttribute("colspan",s);var l=Object(m.mb)("colgroup".concat(n,"colGroup"),i),o=Object(m.mb)(".e-content colgroup",i);this.hideColGroup(l,t),this.hideColGroup(o,t)}}},{key:"hideColGroup",value:function(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t;n++)e[i].children[n].style.display="none"}},{key:"isPrintGrid",value:function(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting}},{key:"destroy",value:function(){this.parent.isDestroyed||(this.parent.off(A,this.contentReady.bind(this)),this.parent.removeEventListener(D,this.actionBegin.bind(this)),this.parent.off(L,this.onEmpty.bind(this)),this.parent.off("hierarchyprint",this.hierarchyPrint))}},{key:"getModuleName",value:function(){return"print"}}]),e}()).printGridProp=[].concat(h(["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]),["beforePrint","printComplete","load"]),xt);function Rt(e,t,i){return Object(m.X)(e)||""===e?"":v.b.getObject(e,t)}function Dt(e,t){requestAnimationFrame((function(){try{t(null,e())}catch(i){t(i)}}))}function Et(e){return!Object(m.X)(e)&&!Object(m.X)(e.columns)&&e.columns.length>0}function It(e,t){for(var i=e.columns,n=t.columns,r=0;r<i.length;r++)if(n.length-1>=r)if(n[r].columns)for(var s=0;s<n[r].columns.length;s++)i[r].columns[s].type=n[r].columns[s].type;else i[r].type=n[r].type}var Mt=0;function Ft(e,t){Mt=0;var i=t.groupSettings.columns.length,n=e.gSummary,r=0,s="aggregatesCount";if(n===e.data.count)return t.groupSettings.columns.length&&!Object(m.X)(e[s])&&e[s]?1!==t.groupSettings.columns.length?Mt+=0!==e.indent&&n<2?e.gSummary*(i-e.indent+(i-e.indent)*e[s]):e.gSummary*(i-e.indent+(i-e.indent-1)*e[s])+e[s]:1===t.groupSettings.columns.length&&(Mt+=e.gSummary*(i-e.indent)+e[s]):t.groupSettings.columns.length&&(Mt+=1!==t.groupSettings.columns.length?e.gSummary*(t.groupSettings.columns.length-e.indent):e.gSummary),Mt;for(var a=0,l=e.data.items.length;a<l;a++){var o=e.data.items[a];Mt+=o.items.length+(i===t.columns.length||Object(m.X)(o.items.records)?0:o.items.records.length),r+=Object(m.X)(o.items.records)||Object(m.X)(e[s])?o.items.length:o.items.records.length,o.items.GroupGuid&&0!==o.items.childLevels&&Tt(o)}return Mt+=e.data.items.length,Object(m.X)(e[s])||e[s]&&Mt&&0!==r&&(Mt+=(Mt-r)*e[s]+e[s]),Mt}function Tt(e){for(var t=0,i=e.items.length;t<i;t++){var n=e.items[t];Mt+=n.count,0!==n.items.childLevels&&Tt(n)}}function At(e,t){for(var i=[],n=0,r=e.length;n<r;n++){var s=t(e[n],n);Object(m.X)(s)||i.push(s)}return i}function zt(e){for(var t=[],i=0;i<e.length;i++)t.push(Object(m.K)({},Nt(e[i]),{},!0));return t}function Lt(e){if(e)try{if(document.querySelectorAll(e).length)return Object(m.E)(document.querySelector(e).innerHTML.trim())}catch(t){return Object(m.E)(e)}}function Bt(e,t){var i={},n=["style","class"];Object(m.K)(i,t,{}),"style"in i&&(Object(m.ob)(e,i[n[0]]),delete i[n[0]]),"class"in i&&(Object(m.v)([e],i[n[1]]),delete i[n[1]]),Object(m.x)(e,i)}function Pt(e,t,i,n){for(var r=Object(m.K)(e,t,i),s=Object.keys(r),a=0;a<s.length;a++)n&&-1!==n.indexOf(s[a])&&delete r[s[a]];return r}function qt(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0,n=e.length;i<n;i++)e[i].columns?(e[i].index=Object(m.X)(e[i].index)?t:e[i].index,t++,t=qt(e[i].columns,t)):(e[i].index=Object(m.X)(e[i].index)?t:e[i].index,t++);return t}function Vt(e,t,i){for(var n=0,r=e.length;n<r;n++){var s=void 0;"string"==typeof e[n]?s=new R({field:e[n]},i):e[n]instanceof R?s=e[n]:e[n].columns?(e[n].columns=Vt(e[n].columns,null,i),s=new R(e[n],i)):s=new R(e[n],i),s.type&&"checkbox"===s.type.toLowerCase()&&(s.allowReordering=!1),s.headerText=Object(m.X)(s.headerText)?s.foreignKeyValue||s.field||"":s.headerText,s.foreignKeyField=s.foreignKeyField||s.field,s.valueAccessor=("string"==typeof s.valueAccessor?Object(m.V)(s.valueAccessor,window):s.valueAccessor)||Rt,s.width=t&&Object(m.X)(s.width)?200:s.width,Object(m.X)(s.visible)&&(s.visible=!0),e[n]=s}return e}function Ht(e,t,i){var n,r=e.querySelector("span"),s=e.parentElement.getBoundingClientRect(),a=t.target.getBoundingClientRect();r.className=i,e.style.display="",n=(Object(m.X)(t.clientY)?t.changedTouches[0].clientY:t.clientY)>e.offsetHeight+10,e.style.top=a.top-s.top+(n?-(e.offsetHeight+10):e.offsetHeight+10)+"px",e.style.left=function(e,t,i,n){var r=e.offsetWidth/2,s=Yt(t).x;return s-i.left<r?i.left-n:i.right-s<r?i.right-n-2*r:s-n-r}(e,t,a,s.left)+"px",n?(e.querySelector(".e-downtail").style.display="",e.querySelector(".e-uptail").style.display="none"):(e.querySelector(".e-downtail").style.display="none",e.querySelector(".e-uptail").style.display="")}function Nt(e){return e instanceof m.e?Object(m.V)("properties",e):e}function Wt(e,t,i){for(var n=e;n&&!(i?n.id===t:n.classList.contains(t));)n=n.parentElement;return n}function Xt(e,t){for(var i=-1,n=0,r=t.length;n<r;n++)if(t[n].isEqualNode(e)){i=n;break}return i}function Gt(e,t){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function Kt(e){for(var t=[],i=0,n=e.length;i<n;i++)e[i].hasOwnProperty("properties")?t.push(e[i].properties):t.push(e[i]);return t}function Ut(e,t){for(var i=[].slice.call(e.querySelectorAll(t)),n=0;n<i.length;n++)Object(m.hb)(i[n])}function Yt(e){var t={};return t.x=Object(m.X)(e.clientX)?e.changedTouches[0].clientX:e.clientX,t.y=Object(m.X)(e.clientY)?e.changedTouches[0].clientY:e.clientY,t}var _t=0;function Qt(e){return e+_t++}function Jt(e,t){for(var i=0,n=t.length;i<n;i++)e.appendChild(n===t.length?t[i]:t[0]);return e}function Zt(e,t,i){for(var n=e,r=[];n;)(i?n.id===t:n.classList.contains(t))&&r.push(n),n=n.parentElement;return r}function $t(e,t,i,n){if("Custom"===e){var r=i.customAggregate;return"string"==typeof r&&(r=Object(m.V)(r,window)),r?r.call(n,t,i):""}return i.field in t||t instanceof Array?v.b.aggregates[e.toLowerCase()](t,i.field):null}var ei,ti,ii=null;function ni(){if(null!==ii)return ii;var e,t=document.createElement("div");return t.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth|0,document.body.removeChild(t),ii=e}function ri(e){return e.split(".").length>1}function si(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/\./g,"___")}function ai(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/___/g,".")}function li(e,t,i){var n=Wt(i,"e-row"),r=!n||n&&!n.classList.contains("e-insertedrow");return"beginEdit"===t&&r?!(e.isIdentity||e.isPrimaryKey||!e.allowEditing):!("add"===t&&e.isIdentity||r&&!e.allowEditing&&!e.isIdentity&&!e.isPrimaryKey)}function oi(e){var t=Object(m.lb)("#"+e.element.id+"EditConfirm",e.element);return"Batch"===e.editSettings.mode&&Object(m.mb)(".e-updatedtd",e.element).length&&e.editSettings.showConfirmDialog&&(!t||t.classList.contains("e-popup-close"))}function hi(e,t){e=e instanceof Array?e:[e];for(var i=0;i<e.length;i++)t?e[i].classList.add("e-wrap"):e[i].classList.remove("e-wrap")}function ci(e,t,i){var n,r=e.getService("valueFormatter");switch("date"!==t.type&&"datetime"!==t.type||(n={type:t.type,skeleton:t.format},Object(m.W)()&&i&&(n.isServerRendered=i),"string"==typeof t.format&&"yMd"!==t.format&&(n.format=t.format)),t.type){case"date":case"datetime":t.setFormatter(r.getFormatFunction(n)),t.setParser(r.getParserFunction(n));break;case"number":t.setFormatter(r.getFormatFunction({format:t.format})),t.setParser(r.getParserFunction({format:t.format}))}}function ui(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];for(var s=0,a=e.length;s<a;s++)t?(Object(m.A)(e[s],[].concat(n),[]),e[s].setAttribute("aria-selected","true")):(Object(m.A)(e[s],[],[].concat(n)),e[s].removeAttribute("aria-selected"))}function di(e,t,i){var n=t.element.style.display;t.element.style.display="block";var r,s=t.width;if(i.enableRtl){r=Object(b.e)(e,"left","bottom"),t.element.style.top=r.top+e.getBoundingClientRect().height-35+"px",t.element.style.display=n;var a=r.left-s+e.clientWidth;t.element.style.left=a<1?s+a+-16+"px":a-16+"px"}else{r=Object(b.f)(e,t.element),t.element.style.display=n,t.element.style.top=r.top+e.getBoundingClientRect().height-5+"px";var l=r.left-s+e.clientWidth;t.element.style.left=l<1?s+l-16+"px":l+-4+"px"}}function pi(e,t){e.popup.element.style.zIndex=(t.zIndex+1).toString()}function gi(e){var t=e.querySelector(".e-frame"),i=t.previousSibling;t.classList.contains("e-check")?(i.checked=!1,Object(m.A)(t,["e-uncheck"],["e-check"])):(i.checked=!0,Object(m.A)(t,["e-check"],["e-uncheck"]))}function fi(e,t){e.checked=t}function mi(e,t,i){var n=Object(m.F)("div",{className:i});return n.appendChild(t),n.setAttribute("uid",e),n}function vi(e,t){Object(m.ib)([e],["e-check","e-stop","e-uncheck"]),e.classList.add(t?"e-check":"e-uncheck")}function bi(e,t,i){for(var n=0;n<t.length;n++)Object(m.qb)(t[n].field,yi(t[n],i),e.foreignKeyData);for(var r=e.cells,s=0;s<r.length;s++)r[s].isForeignKey&&Object(m.qb)("foreignKeyData",Object(m.V)(r[s].column.field,e.foreignKeyData),r[s])}function yi(e,t,i,n){var r=e.foreignKeyField,s=Object(m.X)(i)?Rt(e.field,t):i;s=Object(m.X)(s)?"":s;var a=new v.g,l=n||(e.dataSource instanceof v.a&&e.dataSource.dataSource.json.length?e.dataSource.dataSource.json:e.columnData);return s.getDay?a.where(wi({field:r,operator:"equal",value:s,matchCase:!1})):a.where(r,"==",s,!1),new v.a(l).executeLocal(a)}function Ci(e,t){var i;return t.some((function(t){return i=t,t.foreignKeyValue===e}))&&i}function wi(e,t){var i,n,r,s=Object(m.K)({},Nt(e)),a=Object(m.K)({},Nt(e));if(Object(m.X)(e.value))return i=new v.f(s.field,s.operator,s.value,!1);var l=new Date(e.value);if("equal"===e.operator||"notequal"===e.operator){"datetime"===t?(n=new Date(l.setSeconds(l.getSeconds()-1)),r=new Date(l.setSeconds(l.getSeconds()+2)),e.value=new Date(l.setSeconds(r.getSeconds()-1))):(n=new Date(l.setHours(0)-1),r=new Date(l.setHours(24))),s.value=n,a.value=r,"equal"===e.operator?(s.operator="greaterthan",a.operator="lessthan"):"notequal"===e.operator&&(s.operator="lessthanorequal",a.operator="greaterthanorequal");var o=new v.f(s.field,s.operator,s.value,!1),h=new v.f(a.field,a.operator,a.value,!1);i="equal"===e.operator?o.and(h):o.or(h)}else"string"==typeof s.value&&(s.value=new Date(s.value)),i=new v.f(s.field,s.operator,s.value,!1);return e.setProperties?e.setProperties({ejpredicate:i},!0):e.ejpredicate=i,i}function ki(e,t,i){t=t&&i&&i.isRowDragable()?t+1:t;for(var n=e.cloneNode(!0),r=0;r<t;r++)n.removeChild(n.children[0]);for(var s=t,a=e.childElementCount;s<a;s++)e.removeChild(e.children[e.childElementCount-1]);return n}function Si(e){return e.enableVirtualization&&e.groupSettings.columns.length>0&&e.isVirtualAdaptive}function Oi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(e){for(var i=t,n=e.split("."),r=0;r<n.length&&!Object(m.X)(i);r++)i=i[n[r]];return i}}function xi(e,t){var i=new m.n;return"date"===t?"object"==typeof e?i.getDatePattern({type:e.type?e.type:"date",format:e.format},!1):Object(m.W)()?i.getDatePattern({type:"dateTime",format:e},!1):i.getDatePattern({type:"dateTime",skeleton:e},!1):"object"==typeof e?i.getDatePattern({type:e.type?e.type:"dateTime",format:e.format},!1):Object(m.W)()?i.getDatePattern({type:"dateTime",format:e},!1):i.getDatePattern({type:"dateTime",skeleton:e},!1)}function ji(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Expanded",i={};if(!e)return i;var n,r=e.isFrozenGrid()&&!e.getFrozenColumns(),s=c(jt.printGridProp);try{for(s.s();!(n=s.n()).done;){var a=n.value;i[a]="columns"===a?Kt(r?e.getColumns():e[a]):"allowPaging"===a?"CurrentPage"===e.printMode:Nt(e[a])}}catch(l){s.e(l)}finally{s.f()}return e.childGrid&&"None"!==t&&(i.expandedRows=function(e,t){var i,n={},r=c(e.getRowsObject());try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s.isExpand&&!s.isDetailRow){var a=e.allowPaging&&"AllPages"===e.printMode?s.index+e.pageSettings.currentPage*e.pageSettings.pageSize-e.pageSettings.pageSize:s.index;n[a]={},n[a].isExpand=!0,n[a].gridModel=ji(s.childGrid,t),n[a].gridModel.query=e.childGrid.query}}}catch(l){r.e(l)}finally{r.f()}return n}(e,t)),i}function Ri(e,t,i,n){var r=e||{},s=arguments.length;n&&(s-=1);for(var a=1;a<s;a++)if(arguments[a])for(var l=arguments[a],o=Object.keys(Object.getPrototypeOf(l)).length?Object.keys(l).concat(Di(l)):Object.keys(l),h=0;h<o.length;h++){var c=void 0,u=r[o[h]],d=l[o[h]];n&&(Object(m.Y)(d)||Array.isArray(d))?Object(m.Y)(d)?(c=u||{},r[o[h]]=Object(m.K)({},c,d,n)):(c=u||[],r[o[h]]=Object(m.K)([],c,d,n)):r[o[h]]=d}return r}function Di(e){for(var t=[];Object.getPrototypeOf(e)&&Object.keys(Object.getPrototypeOf(e)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(e))),e=Object.getPrototypeOf(e);return t}function Ei(e){for(var t=0,i=0;i<e.length;i++){var n=Ii(e[i],0);t<n&&(t=n)}return t+1}function Ii(e,t){var i=t,n=[];if(e.columns){t++;for(var r=0;r<e.columns.length;r++)n[r]=Ii(e.columns[r],t);for(var s=0;s<n.length;s++)i<n[s]&&(i=n[s]);t=i}return t}function Mi(e,t){e.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function Fi(e,t){if(e&&t){var i=Object(m.C)(e,".e-row").getBoundingClientRect().height,n=Object(m.C)(t,".e-row").getBoundingClientRect().height;i>n?t.style.height=i+"px":e.style.height=n+"px"}}function Ti(e,t){var i=t.getContent().firstElementChild.offsetHeight;return e&&e.getBoundingClientRect().top>i}function Ai(e,t){return e&&e.getBoundingClientRect().top<t}function zi(e,t){var i,n=e.getPrimaryKeyFieldNames()[0];return e.getCurrentViewRecords().filter((function(e,r){e[n]===t[n]&&(i=r)})),i}function Li(e,t){var i;i=function(e){var t=new v.h,i=new v.a({url:"",adaptor:new v.h}),n=t.processQuery(i,e);return JSON.parse(n.data)}(t);var n=new v.c;return i.dataSource=n.resolve,i.action=e,{state:i,deffered:n}}function Bi(e){for(var t=e.getVisibleColumns(),i=0,n=0,r=0;r<t.length;r++)Object(m.ab)(t[r].width)?n++:-1!==t[r].width.toString().indexOf("%")&&i++;return("auto"===e.width||"string"==typeof e.width&&-1!==e.width.indexOf("%"))&&"chrome"!==m.d.info.name&&!e.groupSettings.showGroupedColumn&&e.groupSettings.columns.length&&i&&!n}function Pi(e,t,i,n){for(var r=n||0,s=0;s<t.length;s++)if(t[s].isDataRow){t[s].index=r,t[s].isAltRow=!!e.enableAltRow&&r%2!=0,i[s].setAttribute("aria-rowindex",r.toString()),t[s].isAltRow?i[s].classList.add("e-altrow"):i[s].classList.remove("e-altrow");for(var a=0;a<i[s].cells.length;a++)i[s].cells[a].setAttribute("index",r.toString());r++}t.length||e.renderModule.emptyRow(!0)}function qi(e,t,i,n){var r=e.dataToBeUpdated[i].concat(t[i]).reduce((function(e,t){return e[t[n]]=void 0===e[t[n]]?t:Object.assign(e[t[n]],t),e}),{});e.dataToBeUpdated[i]=Object.keys(r).map((function(e){return r[e]}))}function Vi(e){if(e.isFrozenGrid()){e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));var t="Left-Right"===e.getFrozenMode()?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";e.contentModule.freezeRowElements=[].slice.call(e.element.querySelectorAll(t)),"Left-Right"===e.getFrozenMode()&&(e.contentModule.frozenRightRowElements=[].slice.call(e.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function Hi(e){return e.tableIndex===e.getTablesCount()&&(e.tableIndex=0),++e.tableIndex}function Ni(e,t){var i,n=e.getFrozenColumns(),r=e.getFrozenLeftColumnsCount(),s=e.getFrozenRightColumnsCount();return!n||r||s?n||!r&&!s||(i=function(e,t){var i,n=e.getFrozenLeftColumnsCount(),r=e.getFrozenRightColumnsCount(),s=Object(m.X)(t)?Hi(e):t;return n&&!r?1===s?i="frozen-left":2===s&&(i="movable"):r&&!n?1===s?i="frozen-right":2===s&&(i="movable"):1===s?i="frozen-left":2===s?i="movable":3===s&&(i="frozen-right"),i}(e,t)):i=function(e,t){var i,n=Object(m.X)(t)?Hi(e):t;return 1===n?i="frozen-left":2===n&&(i="movable"),i}(e,t),i}function Wi(e,t,i){var n=e.getFrozenLeftCount(),r=e.getMovableColumnsCount(),s=e.getFrozenRightColumnsCount(),a=e.getFrozenMode(),l=e.isRowDragable()?1:0,o="Right"===a?n+r:n+r+l,h="Right"===a?n:n+l,c="Right"===a?t.length-s-l:s?t.length-s:t.length;return"frozen-left"===i?t=t.slice(0,n?n+l:t.length):"frozen-right"===i?t=t.slice(o,t.length):"movable"===i&&(t=t.slice(h,c)),t}function Xi(e,t,i,n){(i[0].length||n)&&t("frozen-left",i[0]),e.isFrozenGrid()&&(i[1].length||n)&&t("movable",i[1]),"Left-Right"!==e.getFrozenMode()&&"Right"!==e.getFrozenMode()||!i[2].length&&!n||t("frozen-right",i[2])}function Gi(e){return["Right"!==e.getFrozenMode()?e.getRowsObject():[],e.getMovableRowsObject(),e.getFrozenRightRowsObject()]}function Ki(e){return["Right"!==e.getFrozenMode()?e.getAllDataRows(!0):[],e.getAllMovableDataRows(!0),e.getAllFrozenRightDataRows(!0)]}function Ui(e,t,i){for(var n=e.children.length,r=0,s=0;s<n;s++,r++)s>=t&&s<i||(e.removeChild(e.children[r]),r--)}function Yi(e,t,i){return"movable"===t.getFreezeTableName()?[].slice.call(e.getMovableDataRows()[i].querySelectorAll(".e-rowcell")):"frozen-right"===t.getFreezeTableName()?[].slice.call(e.getFrozenRightDataRows()[i].querySelectorAll(".e-rowcell")):[].slice.call(e.getDataRows()[i].querySelectorAll(".e-rowcell"))}function _i(e,t,i,n){var r=e.getFrozenLeftCount(),s=e.getMovableColumnsCount();return n="movable"===t.getFreezeTableName()?n-r:"frozen-right"===t.getFreezeTableName()?n-(r+s):n,Yi(e,t,i)[n]}function Qi(e,t,i,n,r,s){"frozen-left"===e.getFreezeTableName()||!t&&"frozen-right"===e.getFreezeTableName()||1===s?i[si(e.field)]=e.validationRules:"movable"!==e.getFreezeTableName()&&e.getFreezeTableName()?"frozen-right"===e.getFreezeTableName()&&(r[si(e.field)]=e.validationRules):n[si(e.field)]=e.validationRules}function Ji(e){var t;return e.isFrozenGrid()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getMovableHeaderTbody():e.getMovableContentTbody()),t}function Zi(e){var t;return"Left-Right"===e.getFrozenMode()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getFrozenRightHeaderTbody():e.getFrozenRightContentTbody()),t}function $i(e,t,i,n,r,s,a){e&&n&&a(e,n),t&&r&&a(t,r),i&&s&&a(i,s)}function en(e,t){var i,n=new m.n;if("number"===t)try{i=n.getNumberPattern({format:e,currency:this.currency,useGrouping:!0},!0)}catch(s){i=e}else if("date"===t||"time"===t||"datetime"===t)try{i=n.getDatePattern({skeleton:e,type:t},!1)}catch(s){try{i=n.getDatePattern({format:e,type:t},!1)}catch(s){i=e}}else i=e;if("number"!==t){var r={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};i=i.replace(/G|H|c|'| a|yy|y|EEEE|E/g,(function(e){return r[e]}))}return i}!function(e){e.timer=null}(ti||(ti={}));var tn,nn=function(){function e(t){p(this,e),this.existingPredicate={},this.foreignKeyQuery=new v.g,this.filterState=!0,this.values={},this.renderEmpty=!1,this.parent=t,this.id=this.parent.element.id,this.valueFormatter=new j(this.parent.locale),this.cBoxTrue=Object(y.f)(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=Object(y.f)(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Object(m.v)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return f(e,[{key:"destroy",value:function(){this.closeDialog()}},{key:"wireEvents",value:function(){m.l.add(this.dlg,"click",this.clickHandler,this),m.l.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=Object(m.G)(this.searchBoxKeyUp,200),m.l.add(this.dlg.querySelector(".e-searchinput"),"keyup",this.searchHandler,this)}},{key:"unWireEvents",value:function(){m.l.remove(this.dlg,"click",this.clickHandler),m.l.remove(this.dlg,"keyup",this.keyupHandler);var e=this.dlg.querySelector(".e-searchinput");e&&m.l.remove(e,"keyup",this.searchHandler)}},{key:"foreignKeyFilter",value:function(e,t,i){var n=this,r={},s=[],a=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(a.where(i)).then((function(i){n.options.column.columnData=i.result,n.parent.notify("generateQuery",{predicate:r,column:n.options.column}),e.ejpredicate=r.predicate.predicates;for(var a=r.predicate.predicates,l=0;l<a.length;l++)s.push({field:a[l].field,predicate:"or",matchCase:a[l].ignoreCase,ignoreAccent:a[l].ignoreAccent,operator:a[l].operator,value:a[l].value,type:n.options.type});e.filterCollection=s.length?s:t.filter((function(e){return e.field=n.options.field})),n.options.handler(e)}))}},{key:"foreignFilter",value:function(e,t){var i=new v.f(this.options.column.foreignKeyValue,this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",t,!0,this.options.ignoreAccent);this.foreignKeyFilter(e,[e.filterCollection],i)}},{key:"searchBoxClick",value:function(e){e.target.classList.contains("e-searchclear")&&(this.sInput.value="",this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())}},{key:"searchBoxKeyUp",value:function(e){this.refreshCheckboxes(),this.updateSearchIcon()}},{key:"updateSearchIcon",value:function(){this.sInput.value.length?Object(m.A)(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):Object(m.A)(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])}},{key:"getLocalizedLabel",value:function(e){return this.localeObj.getConstant(e)}},{key:"updateDataSource",value:function(){var e=this.options.dataSource;if(!(e instanceof v.a))for(var t=0;t<e.length;t++)if("object"!=typeof e){var i={};i[this.options.field]=e[t],e[t]=i}}},{key:"updateModel",value:function(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new v.g,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length}},{key:"getAndSetChkElem",value:function(e){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!e.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};C.c.createInput(t,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox}},{key:"showDialog",value:function(e){var t={requestType:"filterbeforeopen",columnName:this.options.field,columnType:this.options.type,cancel:!1};Object(m.W)()&&!this.parent.isJsComponent||(t.filterModel=this),this.parent.notify("cbox-filter-begin",t),t.cancel||(this.dialogObj=new b.a({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),width:!Object(m.X)(Wt(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this)}),this.dialogObj.isStringTemplate=!0,this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),this.parent.element.appendChild(this.dlg),this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=this.options.height+"px",this.dialogObj.show(),this.wireEvents(),Object(b.g)({target:this.spinner},this.parent.createElement),Object(b.n)(this.spinner),this.getAllData())}},{key:"dialogCreated",value:function(e){m.d.isDevice?this.dialogObj.position={X:"center",Y:"center"}:di(this.options.target,this.dialogObj,this.parent),this.parent.notify("filterDialogCreated",e)}},{key:"openDialog",value:function(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)}},{key:"closeDialog",value:function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){var e=this.options.columns.filter((function(e){return e.getFilterItemTemplate()})),t=this.parent.registeredTemplate;e.length&&!Object(m.X)(t)&&t.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.isReact&&(this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.renderTemplates()),this.parent.notify("filter-menu-close",{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),Object(m.hb)(this.dlg),this.dlg=null}}},{key:"clearFilter",value:function(){var e={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify("filter-Prevent",e),e.cancel||this.options.handler({action:"clear-filter",field:this.options.field})}},{key:"btnClick",value:function(e){if(this.filterState){if("input"===e.target.tagName.toLowerCase()&&e.target.classList.contains("e-searchinput")){var t=e.target.value;"boolean"===this.options.column.type&&(""!==t&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(t.toLowerCase())?t=!0:""!==t&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(t.toLowerCase())&&(t=!1));var i={action:"filtering",filterCollection:{field:this.options.field,operator:this.options.isRemote?"string"===this.options.column.type?"contains":"equal":"date"===this.options.column.type||"datetime"===this.options.column.type||"boolean"===this.options.column.type?"equal":"contains",value:t,matchCase:!1,type:this.options.column.type},field:this.options.field};null!=t&&""!==t?this.isForeignColumn(this.options.column)?this.foreignFilter(i,t):this.options.handler(i):this.closeDialog()}else if(13===e.keyCode)this.fltrBtnHandler();else{var n=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===n?this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===n&&this.clearFilter()}this.closeDialog()}else"input"!==e.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog())}},{key:"fltrBtnHandler",value:function(){var t,i,n,r,s=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),a=s,l="equal",o=this.searchBox.querySelector(".e-searchinput"),h={field:this.options.field,predicate:"or",uid:this.options.uid,operator:l,type:this.options.type,matchCase:this.options.allowCaseSensitive,ignoreAccent:this.options.ignoreAccent},c=this.itemsCnt!==s.length&&this.itemsCnt-s.length<s.length;c&&""===o.value&&(l="notequal",s=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),h.predicate="and",h.operator="notequal");var u=[];if(s.length!==this.itemsCnt||o.value&&""!==o.value){for(var d=0;d<s.length;d++){t=this.values[Wt(s[d],"e-ftrchk").getAttribute("uid")],r=Object(m.K)({},{value:t},h),t&&!t.toString().length&&(r.operator=c?"notequal":"equal"),""===t||Object(m.X)(t)?u=u.concat(e.generateNullValuePredicates(h)):u.push(r);var p={instance:this,handler:this.fltrBtnHandler,arg1:r.field,arg2:r.predicate,arg3:r.operator,arg4:r.matchCase,arg5:r.ignoreAccent,arg6:r.value,cancel:!1};if(this.parent.notify("filter-Prevent",p),p.cancel)return}"date"!==this.options.type&&"datetime"!==this.options.type||(n=a.length-1,i=this.values[Wt(a[n],"e-ftrchk").getAttribute("uid")],Object(m.X)(i)&&c&&u.push({field:h.field,matchCase:h.matchCase,operator:"equal",predicate:"and",value:null})),this.initiateFilter(u)}else this.clearFilter()}},{key:"initiateFilter",value:function(e){var t,i=e[0];if(!Object(m.X)(i)){t=i.ejpredicate?i.ejpredicate:new v.f(i.field,i.operator,i.value,!i.matchCase,i.ignoreAccent);for(var n=1;n<e.length;n++)t=void 0!==e[n].ejpredicate?t[e[n].predicate](e[n].ejpredicate):t[e[n].predicate](e[n].field,e[n].operator,e[n].value,!e[n].matchCase,e[n].ignoreAccent);var r={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:v.f.or(t)};this.options.handler(r)}}},{key:"isForeignColumn",value:function(e){return!!e.isForeignColumn&&e.isForeignColumn()}},{key:"refreshCheckboxes",value:function(){var e=this,t=this.sInput.value,i=this.options.column,n=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),r=this.options.query.clone(),s=n.queries.filter((function(e){return e&&"onWhere"===e.fn}))[0];n.queries=[],r.queries=[];var a,l="string"!==this.options.type&&parseFloat(t)?parseFloat(t):t,o=this.options.isRemote?"string"===this.options.type?"contains":"equal":this.options.type?"contains":"equal",h=this.options.ignoreAccent,c=this.isForeignColumn(i)?i.foreignKeyValue:i.field;l=""===l||void 0===l?void 0:l;var u=this.options.dataManager.adaptor.getModuleName;"boolean"===this.options.type&&(void 0!==l&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(l.toLowerCase())&&u?(u(),l=!0):void 0!==l&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(l.toLowerCase())&&u&&(u(),l=!1),o="equal"),"date"!==this.options.type&&"datetime"!==this.options.type||(l=this.valueFormatter.fromView(t,this.options.parserFn,this.options.type)),this.addDistinct(n);var d={requestType:"filtersearchbegin",filterModel:this,columnName:c,column:i,operator:o,matchCase:!0,ignoreAccent:h,filterChoiceCount:null,query:n,value:l};Object(m.W)()&&!this.parent.isJsComponent&&(d.filterModel={}),this.parent.trigger(D,d,(function(u){if(u.operator=Object(m.W)()&&"none"!==u.excelSearchOperator?u.excelSearchOperator:u.operator,a=new v.f(c,u.operator,l,u.matchCase,u.ignoreAccent),"date"===e.options.type||"datetime"===e.options.type){if(o="equal",Object(m.X)(l)&&t.length)return;a=wi({field:c,operator:o,value:l,matchCase:!0,ignoreAccent:h},e.options.type)}t.length?(a=Object(m.X)(s)?a:a.and(s.e),n.where(a)):Object(m.X)(s)||n.where(s.e),u.filterChoiceCount=Object(m.X)(u.filterChoiceCount)?1e3:u.filterChoiceCount;var d={};Object(b.n)(e.spinner),e.renderEmpty=!1,e.isForeignColumn(i)&&t.length?("result"in i.dataSource?new v.a(i.dataSource.result):i.dataSource).executeQuery(n).then((function(t){var n=e.options.column.columnData;e.options.column.columnData=t.result,e.parent.notify("generateQuery",{predicate:d,column:i}),d.predicate.predicates.length?r.where(d.predicate):e.renderEmpty=!0,e.options.column.columnData=n,r.take(u.filterChoiceCount),e.search(u,r)})):(n.take(u.filterChoiceCount),e.search(u,n))}))}},{key:"search",value:function(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)}},{key:"getPredicateFromCols",value:function(t){for(var i=e.getPredicate(t),n=[],r={},s=void 0!==this.parent.getForeignKeyColumns,a=s?this.parent.getForeignKeyColumns():[],l=0,o=Object.keys(i);l<o.length;l++){var h=o[l],c=void 0;s&&this.parent.getColumnByField(h).isForeignColumn()&&(c=Ci(h,a)),c?(this.parent.notify("generateQuery",{predicate:r,column:c}),r.predicate.predicates.length&&n.push(v.f.or(r.predicate.predicates))):n.push(i[h])}return n.length&&v.f.and(n)}},{key:"getQuery",value:function(){return this.parent.getQuery?this.parent.getQuery().clone():new v.g}},{key:"getAllData",value:function(){var e=this,t=this.getQuery();t.requiresCount(),this.addDistinct(t);var i={requestType:"filterchoicerequest",query:t,filterChoiceCount:null};Object(m.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.parent.trigger(D,i,(function(i){i.filterChoiceCount=Object(m.X)(i.filterChoiceCount)?1e3:i.filterChoiceCount,t.take(i.filterChoiceCount),e.parent.dataSource&&"result"in e.parent.dataSource?e.filterEvent(i,t):e.processDataOperation(t,!0)}))}},{key:"addDistinct",value:function(e){var t=v.b.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),e.distinct(t),e}},{key:"filterEvent",value:function(e,t){var i=this,n=Li(e,t);this.parent.trigger("dataStateChange",n.state),n.deffered.promise.then((function(e){i.dataSuccess(e)}))}},{key:"processDataOperation",value:function(e,t){var i=this;this.options.dataSource=this.options.dataSource instanceof v.a?this.options.dataSource:new v.a(this.options.dataSource);var n=[],r=[];if(this.isForeignColumn(this.options.column)&&t){var s="result"in this.options.column.dataSource?new v.a(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,n.push(s.executeQuery(this.foreignKeyQuery)),r.push((function(e){return i.foreignKeyData=e}))}n.push(this.options.dataSource.executeQuery(e)),r.push(this.dataSuccess.bind(this));var a=0;Promise.all(n).then((function(e){for(var t=0;t<e.length;t++)r[a++](e[t].result)}))}},{key:"dataSuccess",value:function(t){this.fullData=t;var i={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify("beforeCheckboxRenderer",i),i.executeQuery){var n=new v.g;if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var r=this.parent.searchSettings,s=r.fields.length?r.fields:this.options.columns.map((function(e){return e.field}));n.search(r.key,s,r.operator,r.ignoreCase,r.ignoreAccent)}if(this.options.filteredColumns.length){for(var a=[],l=0;l<this.options.filteredColumns.length;l++){var o=this.options.filteredColumns[l];this.options.uid?(o.uid=o.uid||this.parent.getColumnByField(o.field).uid,o.uid!==this.options.uid&&a.push(this.options.filteredColumns[l])):o.field!==this.options.field&&a.push(this.options.filteredColumns[l])}var h=this.getPredicateFromCols(a);h&&n.where(h)}var c=new v.a(i.dataSource).executeLocal(n);this.filteredData=e.getDistinct(c,this.options.field,this.options.column,this.foreignKeyData).records||[]}this.processDataSource(null,!0,i.executeQuery?this.filteredData:i.dataSource),this.sInput.focus();var u={requestType:"filterafteropen",columnName:this.options.field,columnType:this.options.type};Object(m.W)()&&!this.parent.isJsComponent||(u.filterModel=this),this.parent.notify("cbox-filter-complete",u)}},{key:"processDataSource",value:function(e,t,i){Object(b.n)(this.spinner),this.updateResult(),this.createFilterItems(i,t)}},{key:"processSearch",value:function(e){this.processDataOperation(e)}},{key:"updateResult",value:function(){this.result={};var e=this.getPredicateFromCols(this.options.filteredColumns),t=new v.g;e&&t.where(e);var i,n=c(new v.a(this.fullData).executeLocal(t));try{for(n.s();!(i=n.n()).done;){var r=i.value;this.result[Oi(this.options.field,r)]=!0}}catch(s){n.e(s)}finally{n.f()}}},{key:"clickHandler",value:function(e){var t=e.target,i=Wt(t,"e-checkbox-wrapper");if(Wt(t,"e-searchbox")&&this.searchBoxClick(e),i){var n=i.querySelector(".e-selectall");n?this.updateAllCBoxes(!n.classList.contains("e-check")):gi(i.parentElement),this.updateIndeterminatenBtn(),i.querySelector(".e-chk-hidden").focus()}this.setFocus(Wt(i,"e-ftrchk"))}},{key:"keyupHandler",value:function(e){this.setFocus(Wt(e.target,"e-ftrchk"))}},{key:"setFocus",value:function(e){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e.classList.add("e-chkfocus")}},{key:"updateAllCBoxes",value:function(e){var t,i=c([].slice.call(this.cBox.querySelectorAll(".e-frame")));try{for(i.s();!(t=i.n()).done;){var n=t.value;vi(n,e),fi(n.previousSibling,e)}}catch(r){i.e(r)}finally{i.f()}}},{key:"dialogOpen",value:function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.dialogObj.element.querySelector(".e-btn").focus())}},{key:"createCheckbox",value:function(e,t,i){var n=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);fi(n.querySelector("input"),t);var r=n.querySelector(".e-label"),s=Ri({},i,{column:this.options.column,parent:this.parent});return r.innerHTML=!Object(m.X)(e)&&e.toString().length?e:this.getLocalizedLabel("Blanks"),Object(m.v)([r],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&(r.innerHTML="",this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,r),this.parent.renderTemplates()):Jt(r,this.options.template(s,this.parent,"filterItemTemplate"))),n}},{key:"updateIndeterminatenBtn",value:function(){var e=this.cBox.children.length-1,t=[],i=this.cBox.querySelector(".e-selectall"),n=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length,r=this.dialogObj.btnObj[0];r.disabled=!1;var s=i.previousSibling;fi(s,!1),s.indeterminate=!1,e===n?(t=["e-check"],fi(s,!0)):n?(t=["e-stop"],s.indeterminate=!0):(t=["e-uncheck"],r.disabled=!0),this.filterState=!r.disabled,r.dataBind(),Object(m.ib)([i],["e-check","e-stop","e-uncheck"]),Object(m.v)([i],t)}},{key:"createFilterItems",value:function(e,i){for(var n=this.parent.createElement("div"),r=this.dialogObj.btnObj[0],s=-1,a=0;a<e.length;a++){var l=Object(m.V)("ejValue",e[a]);(""===l||Object(m.X)(l))&&(s+=1)}if(this.itemsCnt=-1!==s?e.length-s:e.length,e.length&&!this.renderEmpty){var o=this.getLocalizedLabel("SelectAll"),h=this.createCheckbox(o,!1,t({},this.options.field,o)),c=mi(Qt("cbox"),h,"e-ftrchk");c.querySelector(".e-frame").classList.add("e-selectall"),n.appendChild(c);var u=new v.f("field","equal",this.options.field);this.options.foreignKeyValue&&(u=u.or("field","equal",this.options.foreignKeyValue));for(var d,p=new v.a(this.options.filteredColumns).executeLocal((new v.g).where(u)).length,g=0;g<e.length;g++){var f=Qt("cbox");this.values[f]=Object(m.V)("ejValue",e[g]);var y=Object(m.V)(this.options.field,e[g]);this.options.formatFn&&(y=this.valueFormatter.toView(y,this.options.formatFn));var C={value:y,column:this.options.column,data:e[g]};if(this.parent.notify("filter-cbox-value",C),""===(y=C.value)||Object(m.X)(y)){if(d)continue;d=!0}var w=this.createCheckbox(y,this.getCheckedState(p,this.values[f]),Object(m.V)("dataObj",e[g]));n.appendChild(mi(f,w,"e-ftrchk"))}this.cBox.innerHTML="",Jt(this.cBox,[].slice.call(n.children)),this.updateIndeterminatenBtn(),r.disabled=!1}else n.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",Jt(this.cBox,[].slice.call(n.children)),r.disabled=!0;this.filterState=!r.disabled,r.dataBind();var k={requestType:"filterchoicerequest",dataSource:this.renderEmpty||Object(m.W)()&&this.parent.isServerRendered?[]:e};Object(m.W)()&&!this.parent.isJsComponent||(k.filterModel=this),this.parent.notify("cbox-filter-complete",k),Object(b.k)(this.spinner)}},{key:"getCheckedState",value:function(e,t){return!this.isFiltered||!e||this.result[t]}}],[{key:"generateNullValuePredicates",value:function(e){var t=[];return"string"===e.type&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t}},{key:"getDistinct",value:function(e,t,i,n){for(var r,s=e.length,a=[],l={},o=!(!i||!i.isForeignColumn)&&i.isForeignColumn();s--;)if(!((r=Oi(t,r=e[s]))in l)){var h={};if(h.ejValue=r,l[r]=!0,o){var c=yi(i,{},r,n)[0];Object(m.qb)("foreignKeyData",c,e[s]),r=Object(m.V)(i.foreignKeyValue,c)}Object(m.qb)(t,Object(m.X)(r)?null:r,h),Object(m.qb)("dataObj",e[s],h),a.push(h)}return v.b.group(v.b.sort(a,t,v.b.fnAscending),"ejValue")}},{key:"getPredicate",value:function(t){for(var i=v.b.distinct(t,"field",!0)||[],n=[],r={},s=0;s<i.length;s++)0!==(n=new v.a(t).executeLocal((new v.g).where("field","equal",i[s].field))).length&&(r[i[s].field]=e.generatePredicate(n));return r}},{key:"generatePredicate",value:function(t){var i,n,r=t?t.length:0;(n=e.updateDateFilter(t[0])).ignoreAccent=!Object(m.X)(n.ignoreAccent)&&n.ignoreAccent,i="date"===n.type||"datetime"===n.type?wi(n,n.type):n.ejpredicate?n.ejpredicate:new v.f(n.field,n.operator,n.value,!e.getCaseValue(n),n.ignoreAccent);for(var s=1;s<r;s++)t[s]=e.updateDateFilter(t[s]),r>2&&s>1&&"or"===t[s].predicate?i.predicates.push("date"===t[s].type||"datetime"===t[s].type?wi(t[s],t[s].type):new v.f(t[s].field,t[s].operator,t[s].value,!e.getCaseValue(t[s]),t[s].ignoreAccent)):i="date"===t[s].type||"datetime"===t[s].type?"and"===t[s].predicate&&"equal"===t[s].operator?i.or(wi(t[s],t[s].type),t[s].type,t[s].ignoreAccent):i[t[s].predicate](wi(t[s],t[s].type),t[s].type,t[s].ignoreAccent):t[s].ejpredicate?i[t[s].predicate](t[s].ejpredicate):i[t[s].predicate](t[s].field,t[s].operator,t[s].value,!e.getCaseValue(t[s]),t[s].ignoreAccent);return i||null}},{key:"getCaseValue",value:function(e){return Object(m.X)(e.matchCase)?!("string"===e.type||Object(m.X)(e.type)&&"string"==typeof e.value):e.matchCase}},{key:"updateDateFilter",value:function(e){return("date"===e.type||"datetime"===e.type||e.value instanceof Date)&&(e.type=e.type||"date"),e}}]),e}(),rn=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e)).customFilterOperators=i,n.isExcel=!0,n}return f(r,[{key:"getCMenuDS",value:function(e,t){var i={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]};i.date=i.number,i.datetime=i.number;for(var n=[],r=0;r<i[e].length;r++)n.push(i[e][r].length?t?{text:this.getLocalizedLabel(i[e][r])+"...",iconCss:"e-icons e-icon-check "+(t===i[e][r].toLowerCase()?"":"e-emptyicon")}:{text:this.getLocalizedLabel(i[e][r])+"..."}:{separator:!0});return n}},{key:"destroy",value:function(){this.dlg&&(this.unwireExEvents(),i(o(r.prototype),"destroy",this).call(this)),this.cmenu&&this.cmenu.parentElement&&Object(m.hb)(this.cmenu)}},{key:"createMenu",value:function(e,t,i,n){this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl");var r=this.parent.createElement("ul"),s=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&"grid"===this.parent.getModuleName()){var a=this.parent.getColumnHeaderByUid(n.uid).getAttribute("aria-sort"),l=this.parent.getColumnByField(n.field).allowSorting,o=l&&"Ascending"!==a?"e-excel-ascending":"e-disabled e-excel-ascending",h=l&&"Descending"!==a?"e-excel-descending":"e-disabled e-excel-descending",c=this.getLocalizedLabel("string"===e?"SortAtoZ":"datetime"===e||"date"===e?"SortByOldest":"SortSmallestToLargest"),u=this.getLocalizedLabel("string"===e?"SortZtoA":"datetime"===e||"date"===e?"SortByNewest":"SortLargestToSmallest");r.appendChild(this.createMenuElem(c,o,"e-sortascending")),r.appendChild(this.createMenuElem(u,h,"e-sortdescending"));var d=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});r.appendChild(d)}r.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",s)),"boolean"!==e&&r.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[e]),"e-submenu",i&&this.ensureTextFilter()?"e-icon-check":s+" e-emptyicon",!0)),this.menu.appendChild(r),this.parent.notify("before-filter-cmenu-open",{element:this.menu})}},{key:"createMenuElem",value:function(e,t,i,n){var r=this.parent.createElement("li",{className:t+" e-menu-item"});return r.innerHTML=e,r.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+i}),r.firstChild),n&&r.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),r}},{key:"wireExEvents",value:function(){m.l.add(this.dlg,"mouseover",this.hoverHandler,this),m.l.add(this.dlg,"click",this.clickExHandler,this)}},{key:"unwireExEvents",value:function(){m.l.remove(this.dlg,"mouseover",this.hoverHandler),m.l.remove(this.dlg,"click",this.clickExHandler)}},{key:"clickExHandler",value:function(e){var t=Wt(e.target,"e-menu-item");t&&this.getLocalizedLabel("ClearFilter")===t.innerText.trim()&&(this.clearFilter(),this.closeDialog())}},{key:"destroyCMenu",value:function(){this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),Object(m.hb)(this.cmenu))}},{key:"hoverHandler",value:function(e){var t,i=e.target.querySelector(".e-contextmenu"),n=Wt(e.target,"e-menu-item"),r=this.menu.querySelector(".e-focused");if(r&&r.classList.remove("e-focused"),n&&(n.classList.add("e-focused"),t=n.classList.contains("e-submenu")),!i){if(!t){var s=this.menu.querySelector(".e-submenu");Object(m.X)(s)||s.classList.remove("e-selected"),this.isCMenuOpen=!1,this.destroyCMenu()}var a=this.ensureTextFilter();if(!this.isCMenuOpen&&t){n.classList.add("e-selected"),this.isCMenuOpen=!0;var l={items:this.getCMenuDS(this.options.type,a?a.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose};this.parent.element.appendChild(this.cmenu),this.menuObj=new S.a(l,this.cmenu);var o=this.menu.querySelector(".e-submenu").getBoundingClientRect(),h={top:0,left:0};if(m.d.isDevice){var c=this.getContextBounds(this.menuObj);h.top=(window.innerHeight-c.height)/2,h.left=(window.innerWidth-c.width)/2,this.closeDialog()}else h.top=m.d.isIE?window.pageYOffset+o.top:window.scrollY+o.top,h.left=this.getCMenuYPosition(this.dlg,this.menuObj);this.menuObj.open(h.top,h.left,e.target),Mi(this.parent.element,this.menuObj.element.parentElement)}}}},{key:"ensureTextFilter",value:function(){var e,t=this.existingPredicate[this.options.field];return t&&2===t.length?e="greaterthanorequal"===t[0].operator&&"lessthanorequal"===t[1].operator?"between":"customfilter":t&&1===t.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=t[0].operator),e}},{key:"preventClose",value:function(e){e.event instanceof MouseEvent&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)}},{key:"getContextBounds",value:function(e){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()}},{key:"getCMenuYPosition",value:function(e,t){var i=this.getContextBounds(t).width,n=e.getBoundingClientRect(),r=e.offsetWidth-e.clientWidth;return r=r?r+1:0,n.right+i-this.parent.element.clientWidth<1?n.right+1-r:n.left-i-1+r}},{key:"openDialog",value:function(e){var t=this;this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),this.dialogObj.dataBind();var i=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter((function(e){return t.options.field===e.field})).length;this.createMenu(e.type,i>0,1===i||2===i,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),this.wireExEvents()}},{key:"closeDialog",value:function(){i(o(r.prototype),"closeDialog",this).call(this)}},{key:"selectHandler",value:function(e){e.item&&(this.menuItem=e.item,this.renderDialogue(e))}},{key:"renderDialogue",value:function(e){var t=this,i=e.element,n=this.options.field,r=!Object(m.X)(n)&&ri(n),s=!Object(m.X)(n)&&si(n),a=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:r?s+"-xlflmenu":n+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:r?s+"-xlfldlg":n+"-xlfldlg"}),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new b.a({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var e=t.dlgObj.element.querySelector("table.e-xlfl-table>tr");t.options.column.filterTemplate?Object(m.W)()?e.querySelector(".e-xlfl-valuediv").children[0].focus():e.querySelector("#"+t.options.column.field+"-xlfl-frstvalue").focus():e.cells[1].querySelector("input:not([type=hidden])").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,i,n),buttons:[{click:this.filterBtnClick.bind(this,n),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:"e-xlfl-cancelbtn"}}],content:a,width:430,animationSettings:{effect:"None"}}),this.dlgObj.isStringTemplate=!0,this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.dlgObj.appendTo(this.dlgDiv)}},{key:"removeDialog",value:function(){if(Object(m.W)())for(var e=this.options.columns||[],t=0;t<e.length;t++)if(e[t].filterTemplate){var i=this.parent.element.id+e[t].uid+"filterTemplate";Object(m.sb)(i,"FilterTemplate",e[t])}this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates()),this.removeObjects([this.dropOptr,this.datePicker,this.dateTimePicker,this.actObj,this.numericTxtObj,this.dlgObj]),Object(m.hb)(this.dlgDiv)}},{key:"createdDialog",value:function(e,t){this.renderCustomFilter(e,t),this.dlgObj.element.style.left="0px",this.dlgObj.element.style.top="0px",m.d.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify("beforeCustomFilterOpen",{column:t,dialog:this.dialogObj}),this.dlgObj.show(),Mi(this.parent.element,this.dlgObj.element.parentElement)}},{key:"renderCustomFilter",value:function(e,t){var i=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),n=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});i.appendChild(n);var r=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});i.appendChild(r),this.renderFilterUI(t,i)}},{key:"filterBtnClick",value:function(e){var t,i=!Object(m.X)(e)&&ri(e),n=!Object(m.X)(e)&&si(e),r=i?n:e,s=this.options.column.filterTemplate&&Object(m.W)()?this.dlgDiv.querySelector(".-xlfl-frstvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+r+"-xlfl-frstvalue").ej2_instances[0],a=this.dlgDiv.querySelector("#"+r+"-xlfl-frstoptr").ej2_instances[0],l=this.options.column.filterTemplate&&Object(m.W)()?this.dlgDiv.querySelector(".-xlfl-secndvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+r+"-xlfl-secndvalue").ej2_instances[0],o=this.dlgDiv.querySelector("#"+r+"-xlfl-secndoptr").ej2_instances[0];"string"===this.options.type&&(t=this.dlgDiv.querySelector("#"+r+"-xlflmtcase").ej2_instances[0].checked);var h=this.dlgDiv.querySelector("#"+r+"e-xlfl-frstpredicate").ej2_instances[0],c=(this.dlgDiv.querySelector("#"+r+"e-xlfl-secndpredicate"),h.checked?"and":"or");null===l.value&&(c="or"),this.filterByColumn(this.options.field,a.value,s.value,c,t,this.options.ignoreAccent,o.value,l.value),this.removeDialog()}},{key:"filterByColumn",value:function(e,t,i,n,r,s,a,l){var o,h=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,c=this.isForeignColumn(h)?h.foreignKeyValue:e,u=[];u.push({field:c,predicate:n,matchCase:r,ignoreAccent:s,operator:t,value:i,type:this.options.type});var d={instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:n,arg5:r,arg6:s,arg7:a,arg8:l,cancel:!1};if(this.parent.notify("filter-Prevent",d),!d.cancel){o=new v.f(c,t.toLowerCase(),i,!r,s),Object(m.X)(l)||Object(m.X)(a)||(u.push({field:c,predicate:n,matchCase:r,ignoreAccent:s,operator:a,value:l,type:this.options.type}),o=o[n](c,a.toLowerCase(),l,!r,s));var p={action:"filtering",filterCollection:u,field:this.options.field,ejpredicate:o,actualPredicate:u};this.isForeignColumn(h)?this.foreignKeyFilter(p,u,o):this.options.handler(p)}}},{key:"renderOperatorUI",value:function(e,t,i,n,r){var s=this.parent.createElement("tr",{className:"e-xlfl-fields"});t.appendChild(s);var a=this.parent.createElement("td",{className:"e-xlfl-optr"});s.appendChild(a);var l=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),o=!Object(m.X)(e)&&ri(e),h=!Object(m.X)(e)&&si(e),c=this.parent.createElement("input",{id:o?h+i:e+i});l.appendChild(c),a.appendChild(l);var u=this.customFilterOperators[this.options.type+"Operator"];this.optrData=u;var d=this.dropSelectedVal(this.options.column,n,r),p="";this.menuItem&&((p=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(d=r?p:void 0),p===this.getLocalizedLabel("Between")&&(d=this.getLocalizedLabel(r?"GreaterThanOrEqual":"LessThanOrEqual")));var g=this.options.column;return this.dropOptr=new w.d(Pt({dataSource:u,fields:{text:"text",value:"value"},text:d,open:this.dropDownOpen.bind(this),enableRtl:this.parent.enableRtl,change:this.dropDownValueChange.bind(this)},g.filter.params)),this.dropOptr.appendTo(c),{fieldElement:s,operator:this.getSelectedValue(d)}}},{key:"dropDownOpen",value:function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}},{key:"dropDownValueChange",value:function(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString()}},{key:"getFilterUIInfo",value:function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}}},{key:"getSelectedValue",value:function(e){var t=new v.a(this.optrData).executeLocal((new v.g).where("text","equal",e));return Object(m.X)(t[0])?"":t[0].value}},{key:"dropSelectedVal",value:function(e,t,i){var n;return n=t&&t.length>0?2===t.length?i?t[0].operator:t[1].operator:i?t[0].operator:void 0:i&&"string"===e.type&&!e.filter.operator?"startswith":i?e.filter.operator||"equal":void 0,this.getSelectedText(n)}},{key:"getSelectedText",value:function(e){var t=new v.a(this.optrData).executeLocal((new v.g).where("value","equal",e));return Object(m.X)(t[0])?"":t[0].text}},{key:"renderFilterUI",value:function(e,t){var i=this.existingPredicate[e],n=this.parent.createElement("table",{className:"e-xlfl-table"});t.appendChild(n);var r=this.parent.createElement("colGroup");r.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',n.appendChild(r);var s=this.renderOperatorUI(e,n,"-xlfl-frstoptr",i,!0);this.firstOperator=s.operator,this.renderFlValueUI(e,s,"-xlfl-frstvalue",i,!0);var a=this.parent.createElement("tr",{className:"e-xlfl-predicate"});n.appendChild(a),this.renderRadioButton(e,a,i),s=this.renderOperatorUI(e,n,"-xlfl-secndoptr",i,!1),this.secondOperator=s.operator,this.renderFlValueUI(e,s,"-xlfl-secndvalue",i,!1)}},{key:"renderRadioButton",value:function(e,t,i){var n=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});t.appendChild(n);var r=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),s=!Object(m.X)(e)&&ri(e),a=!Object(m.X)(e)&&si(e),l=this.parent.createElement("input",{id:s?a+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),o=this.parent.createElement("input",{id:s?a+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});r.appendChild(l),r.appendChild(o),n.appendChild(r),"string"===this.options.type&&this.renderMatchCase(e,t,n,"-xlflmtcase",i);var h=new y.d({label:this.getLocalizedLabel("AND"),name:"default",cssClass:"e-xlfl-radio-and",checked:!0,enableRtl:this.parent.enableRtl}),c=new y.d({label:this.getLocalizedLabel("OR"),name:"default",cssClass:"e-xlfl-radio-or",enableRtl:this.parent.enableRtl});"and"===(i&&2===i.length?i[1].predicate:"and")?(h.checked=!0,c.checked=!1):(c.checked=!0,h.checked=!1),h.appendTo(l),c.appendTo(o)}},{key:"removeObjects",value:function(e){var t,i=c(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;n&&!n.isDestroyed&&n.destroy()}}catch(r){i.e(r)}finally{i.f()}}},{key:"renderFlValueUI",value:function(e,t,i,n,r){var s=this.parent.createElement("td",{className:"e-xlfl-value"});t.fieldElement.appendChild(s);var a=!Object(m.X)(e)&&ri(e),l=!Object(m.X)(e)&&si(e),o=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),h=this.options.filteredColumns.some((function(t){return e===t.field})),c=this.options.filteredColumns.filter((function(t){return t.field===e}));if(this.options.column.filterTemplate){var u={},d=this.options.column;h&&i&&(u=this.getExcelFilterData(i,u,d,n,c));var p=this.parent.element.id+d.uid+"filterTemplate";this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate?(this.options.column.getFilterTemplate()(u,this.parent,"filterTemplate",p,null,null,o),this.parent.renderTemplates()):Jt(o,this.options.column.getFilterTemplate()(u,this.parent,"filterTemplate",p)),Object(m.W)()?(o.children[0].classList.add(i),this.dlgDiv.querySelectorAll(".e-xlfl-value").length>1&&Object(m.sb)(p,"FilterTemplate",d)):o.children[0].id=a?l+i:e+i,s.appendChild(o)}else{var g,f,v=this.parent.createElement("input",{id:a?l+i:e+i});o.appendChild(v),s.appendChild(o),n&&n.length>0&&(g=(f=2===n.length?r?n[0]:n[1]:r?n[0]:void 0)&&f.operator===t.operator?f.value:void 0),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,e,v,g,this.parent.enableRtl)}}},{key:"getExcelFilterData",value:function(e,t,i,n,r){var s="-xlfl-frstvalue"===e?0:1;if("-xlfl-frstvalue"===e||r.length>1){var a=this.options.column.columnData&&r.length>1?1===this.options.column.columnData.length?0:1:s;(t={column:n instanceof Array?n[s]:n})[this.options.field]=i.foreignKeyValue?this.options.column.columnData[a][i.foreignKeyValue]:r[a].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[a][i.foreignKeyValue])}return t}},{key:"renderMatchCase",value:function(e,t,i,n,r){var s=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),a=!Object(m.X)(e)&&ri(e),l=!Object(m.X)(e)&&si(e),o=this.parent.createElement("input",{id:a?l+n:e+n,attrs:{type:"checkbox"}});s.appendChild(o),i.appendChild(s);var h=!!(r&&r.length>0)&&(r&&2===r.length?r[1].matchCase:r[0].matchCase);new y.b({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:h}).appendTo(o)}},{key:"renderDate",value:function(e,t,i,n,r){var s=xi(e.format,e.type);this.datePicker=new k.b(Pt({format:s,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:r,value:new Date(n),locale:this.parent.locale},e.column.filter.params)),this.datePicker.appendTo(i)}},{key:"renderDateTime",value:function(e,t,i,n,r){var s=xi(e.format,e.type);this.dateTimePicker=new k.d(Pt({format:s,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:r,value:new Date(n),locale:this.parent.locale},e.column.filter.params)),this.dateTimePicker.appendTo(i)}},{key:"completeAction",value:function(e){e.result=function(e){for(var t={},i=[],n=0;n<e.length;n++)e[n]in t||(i.push(e[n].toString()),t[e[n]]=1);return i}(e.result)}},{key:"renderNumericTextBox",value:function(e,t,i,n,r){this.numericTxtObj=new C.e(Pt({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:r,value:n,locale:this.parent.locale},e.column.filter.params)),this.numericTxtObj.appendTo(i)}},{key:"renderAutoComplete",value:function(e,t,i,n,r){var s=this,a=this.options.column,l=this.isForeignColumn(a),o=l?a.dataSource:e.dataSource,h={value:l?a.foreignKeyValue:t},c=new w.a(Pt({dataSource:o instanceof v.a?o:new v.a(o),fields:h,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:"e-popup-flmenu",autofill:!0,focus:function(){var n=!Object(m.X)(t)&&ri(t),r=!Object(m.X)(t)&&si(t),a=n?r:t;c.filterType=s.dlgDiv.querySelector("#"+a+(i.id===a+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,c.ignoreCase="string"!==e.type||!s.dlgDiv.querySelector("#"+a+"-xlflmtcase").ej2_instances[0].checked,c.filterType=Object(m.X)(c.filterType)?"equal":c.filterType},placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:r,actionComplete:function(e){var i=!Object(m.X)(t)&&ri(t);e.result=e.result.filter((function(e,t,n){return n.map((function(e){return i?s.performComplexDataOperation(c.fields.value,e):e[c.fields.value]})).indexOf(i?s.performComplexDataOperation(c.fields.value,e):e[s.actObj.fields.value])===t}))},text:n},a.filter.params));if(o&&"result"in o){var u=Li({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger("dataStateChange",u.state),u.deffered.promise.then((function(e){c.dataSource=new v.a(e)}))}c.appendTo(i),this.actObj=c}},{key:"performComplexDataOperation",value:function(e,t){for(var i,n=e.split(".").length,r=e.split("."),s=t,a=0;a<n;a++)s=i=s[r[a]];return i}}]),r}(nn),sn=function(){function e(t,i,n,r){p(this,e),this.contentRefresh=!0,this.isModelChanged=!0,this.aria=new le,this.currentTarget=null,this.parent=t,this.sortSettings=i,this.sortedColumns=n,this.focus=r.getService("focus"),this.addEventListener()}return f(e,[{key:"updateModel",value:function(){var e,t={field:this.columnName,direction:this.direction},i=this.parent.groupSettings.columns,n=!1;if(this.isMultiSort)(e=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(e,1),this.sortSettings.columns.push(t),this.sortSettings.columns=this.sortSettings.columns;else if(i.length){for(var r=[],s=0,a=i.length;s<a;s++)if(e=this.getSortedColsIndexByField(i[s],r),this.columnName===i[s])n=!0,r.push(t);else{var l=this.getSortColumnFromField(i[s]);r.push({field:l.field,direction:l.direction,isFromGroup:l.isFromGroup})}n||r.push(t),this.sortSettings.columns=r}else this.sortSettings.columns=[t];this.parent.dataBind(),this.lastSortedCol=this.columnName}},{key:"onActionComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null);var t=this.isRemove?{requestType:"sorting",type:E}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:E};this.isRemove=!1,this.parent.trigger(E,Object(m.K)(e,t))}},{key:"sortColumn",value:function(e,t,i){var n=this.parent;!1===this.parent.getColumnByField(e).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:e}):(n.allowMultiSorting||(i=n.allowMultiSorting),this.isActionPrevent()?n.notify(G,{instance:this,handler:this.sortColumn,arg1:e,arg2:t,arg3:i}):(this.backupSettings(),this.columnName=e,this.direction=t,this.isMultiSort=i,this.removeSortIcons(),n.getColumnHeaderByField(e),this.updateSortedCols(e,i),this.updateModel()))}},{key:"backupSettings",value:function(){this.lastSortedCols=zt(this.sortSettings.columns),this.lastCols=this.sortedColumns}},{key:"restoreSettings",value:function(){this.isModelChanged=!1,this.isMultiSort=!0,this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0),this.sortedColumns=this.lastCols,this.isModelChanged=!0}},{key:"updateSortedCols",value:function(e,t){if(!t)if(this.parent.allowGrouping)for(var i=0,n=this.sortedColumns.length;i<n;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[i])<0&&(this.sortedColumns.splice(i,1),n--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(e)<0&&this.sortedColumns.push(e)}},{key:"onPropertyChanged",value:function(e){e.module===this.getModuleName()&&(this.contentRefresh&&this.parent.notify(P,this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:D,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:D,cancel:!1,target:this.currentTarget}),this.refreshSortSettings(),this.removeSortIcons(),this.addSortIcons())}},{key:"refreshSortSettings",value:function(){this.sortedColumns.length=0;for(var e=this.sortSettings.columns,t=0;t<e.length;t++)e[t].isFromGroup||this.sortedColumns.push(e[t].field)}},{key:"clearSorting",value:function(){var e=Kt(this.sortSettings.columns);if(this.isActionPrevent())this.parent.notify(G,{instance:this,handler:this.clearSorting});else{for(var t=0,i=e.length;t<i;t++)this.removeSortColumn(e[t].field);Object(m.W)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)}}},{key:"isActionPrevent",value:function(){return oi(this.parent)}},{key:"removeSortColumn",value:function(e){var t=this.parent,i=this.sortSettings.columns;if(!(0===i.length&&this.sortedColumns.indexOf(e)<0))if(this.isActionPrevent())this.parent.notify(G,{instance:this,handler:this.removeSortColumn,arg1:e});else{this.backupSettings(),this.removeSortIcons();for(var n=0,r=i.length;n<r;n++)if(i[n].field===e){if(t.allowGrouping&&t.groupSettings.columns.indexOf(i[n].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(i[n].field),1),i.splice(n,1),this.isRemove=!0,this.isModelChanged&&this.parent.notify(P,{requestType:"sorting",type:D,target:this.currentTarget});break}this.addSortIcons()}}},{key:"getSortedColsIndexByField",value:function(e,t){for(var i=t||this.sortSettings.columns,n=0,r=i.length;n<r;n++)if(i[n].field===e)return n;return-1}},{key:"getModuleName",value:function(){return"sort"}},{key:"initialEnd",value:function(){if(this.parent.off(A,this.initialEnd),(!Object(m.W)()||!this.parent.isServerRendered)&&this.parent.getColumns().length&&this.sortSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1;var t,i=c(e.sortSettings.columns.slice());try{for(i.s();!(t=i.n()).done;){var n=t.value;this.sortedColumns.indexOf(n.field)>-1&&this.sortColumn(n.field,n.direction,!0)}}catch(r){i.e(r)}finally{i.f()}this.isMultiSort=!1,this.contentRefresh=!0}}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(A,this.initialEnd,this),this.parent.on("sorting-complete",this.onActionComplete,this),this.parent.on(B,this.onPropertyChanged,this),this.parent.on(H,this.clickHandler,this),this.parent.on(q,this.refreshSortIcons,this),this.parent.on(V,this.keyPressed,this),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("sorting-complete",this.onActionComplete),this.parent.off(B,this.onPropertyChanged),this.parent.off(H,this.clickHandler),this.parent.off(q,this.refreshSortIcons),this.parent.off(V,this.keyPressed),this.parent.off("cancel-Begin",this.cancelBeginEvent))}},{key:"destroy",value:function(){this.isModelChanged=!1;var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())}},{key:"cancelBeginEvent",value:function(e){"sorting"===e.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)}},{key:"clickHandler",value:function(e){var t=this.parent;this.currentTarget=null,this.popUpClickHandler(e);var i=Object(m.C)(e.target,".e-headercell");if(i&&!e.target.classList.contains("e-grptogglebtn")&&!i.classList.contains("e-resized")&&!e.target.classList.contains("e-rhandler")&&!e.target.classList.contains("e-columnmenu")&&!e.target.classList.contains("e-filtermenudiv")&&!Wt(e.target,"e-stackedheadercell")&&!(t.allowSelection&&t.selectionSettings.allowColumnSelection&&e.target.classList.contains("e-headercell"))){var n=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));i.querySelectorAll(".e-ascending"),"checkbox"!==n.type&&(this.initiateSort(i,e,n),m.d.isDevice&&this.showPopUp(e))}if(i&&i.classList.remove("e-resized"),Wt(e.target,"e-excel-ascending")||Wt(e.target,"e-excel-descending")){var r=Object(m.C)(e.target,".e-filter-popup").getAttribute("uid"),s=Object(m.X)(Wt(e.target,"e-excel-descending"))?"Ascending":"Descending";this.sortColumn(t.getColumnByUid(r).field,s,!1)}}},{key:"keyPressed",value:function(e){var t=e.target;if(!this.parent.isEdit&&("enter"===e.action||"ctrlEnter"===e.action||"shiftEnter"===e.action)&&Object(m.C)(t,".e-headercell")){var i=this.focus.getFocusedElement();if(Object(m.X)(i)||!i.classList.contains("e-headercell")||!i.querySelector(".e-headercelldiv"))return;var n=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(i,e,n)}}},{key:"initiateSort",value:function(e,t,i){var n=this.parent,r=i.field;this.currentTarget=t.target;var s=e.querySelectorAll(".e-ascending").length?"Descending":"Ascending";t.shiftKey||this.sortSettings.allowUnsort&&e.querySelectorAll(".e-descending").length&&!(n.groupSettings.columns.indexOf(r)>-1)?(this.removeSortColumn(r),Object(m.W)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)):this.sortColumn(r,s,t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey)}},{key:"showPopUp",value:function(e){var t=Object(m.C)(e.target,".e-headercell");!this.parent.allowMultiSorting||Object(m.X)(t)&&!this.parent.isContextMenuOpen()||Ht(this.parent.element.querySelector(".e-gridpopup"),e,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))}},{key:"popUpClickHandler",value:function(e){var t=e.target;Object(m.C)(t,".e-headercell")||e.target.classList.contains("e-rowcell")||Object(m.C)(t,".e-gridpopup")?t.classList.contains("e-sortdirect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"}},{key:"addSortIcons",value:function(){for(var e,t,i=this.parent,n=this.sortSettings.columns,r=this.parent.getColumns().map((function(e){return e.field})),s=0,a=n.length;s<a;s++)e=i.getColumnHeaderByField(n[s].field),-1===r.indexOf(n[s].field)||Object(m.X)(e)||(this.aria.setSort(e,n[s].direction),this.isMultiSort&&n.length>1&&e.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(s+1).toString()}),e.querySelector(".e-headertext")),t=e.querySelector(".e-sortfilterdiv"),"Ascending"===n[s].direction?Object(m.A)(t,["e-ascending","e-icon-ascending"],[]):Object(m.A)(t,["e-descending","e-icon-descending"],[]))}},{key:"removeSortIcons",value:function(e){for(var t,i=this.parent,n=this.sortSettings.columns,r=this.parent.getColumns().map((function(e){return e.field})),s=e||0,a=Object(m.X)(e)?n.length:e+1;s<a;s++)t=i.getColumnHeaderByField(n[s].field),Object(m.X)(t)||i.allowGrouping&&i.groupSettings.columns.indexOf(n[s].field)>-1&&!t.querySelector(".e-sortfilterdiv")||-1!==r.indexOf(n[s].field)&&(this.aria.setSort(t,"none"),Object(m.A)(t.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),t.querySelector(".e-sortnumber")&&t.querySelector(".e-headercelldiv").removeChild(t.querySelector(".e-sortnumber")))}},{key:"getSortColumnFromField",value:function(e){for(var t=0,i=this.sortSettings.columns.length;t<i;t++)if(this.sortSettings.columns[t].field===e)return this.sortSettings.columns[t];return!1}},{key:"updateAriaAttr",value:function(){var e,t=this.parent.getColumns().map((function(e){return e.field})),i=c(this.sortedColumns);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(-1!==t.indexOf(n)){var r=this.parent.getColumnHeaderByField(n);this.aria.setSort(r,this.getSortColumnFromField(n).direction)}}}catch(s){i.e(s)}finally{i.f()}}},{key:"refreshSortIcons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{args:{isFrozen:!1}};e.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())}}]),e}(),an=function(){function e(t){p(this,e),this.pagerModule=t}return f(e,[{key:"render",value:function(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()}},{key:"refresh",value:function(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.updateStyles()}},{key:"refreshNumericLinks",value:function(){var e,t=this.pagerModule,i=t.element.querySelector(".e-numericcontainer"),n=document.createDocumentFragment();i.innerHTML="";for(var r=1;r<=t.pageCount;r++)e=Object(m.F)("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Goto Page "+r,href:"javascript:void(0);",name:"Goto page"+r}}),t.currentPage===r&&Object(m.A)(e,["e-currentitem","e-active"],["e-pager-default"]),n.appendChild(e);i.appendChild(n),this.links=[].slice.call(i.childNodes)}},{key:"wireEvents",value:function(){m.l.add(this.pagerElement,"click",this.clickHandler,this)}},{key:"unwireEvents",value:function(){m.l.remove(this.pagerModule.element,"click",this.clickHandler)}},{key:"destroy",value:function(){this.unwireEvents()}},{key:"renderNumericContainer",value:function(){this.element=Object(m.F)("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(Object(m.F)("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)}},{key:"renderFirstNPrev",value:function(e){this.first=Object(m.F)("div",{className:"e-first e-icons e-icon-first",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}),this.prev=Object(m.F)("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}),Object(m.w)([this.first,this.prev],e)}},{key:"renderPrevPagerSet",value:function(e){var t=Object(m.F)("div");this.PP=Object(m.F)("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:Object(m.W)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.PP),e.appendChild(t)}},{key:"renderNextPagerSet",value:function(e){var t=Object(m.F)("div");this.NP=Object(m.F)("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:Object(m.W)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.NP),e.appendChild(t)}},{key:"renderNextNLast",value:function(e){this.next=Object(m.F)("div",{className:"e-next e-icons e-icon-next",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}),this.last=Object(m.F)("div",{className:"e-last e-icons e-icon-last",attrs:{title:Object(m.W)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":Object(m.W)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}),Object(m.w)([this.next,this.last],e)}},{key:"clickHandler",value:function(e){var t=this.pagerModule,i=e.target;return t.previousPageNo=t.currentPage,i.classList.contains("e-disable")||Object(m.X)(i.getAttribute("index"))||(t.currentPage=parseInt(i.getAttribute("index"),10),t.dataBind()),!1}},{key:"updateLinksHtml",value:function(){var e,t,i=this.pagerModule;i.currentPage=1===i.totalPages?1:i.currentPage,i.currentPage>i.totalPages&&i.totalPages&&(i.currentPage=i.totalPages),e=parseInt((i.currentPage/i.pageCount).toString(),10),i.currentPage%i.pageCount==0&&e>0&&(e-=1);for(var n=0;n<i.pageCount;n++)(t=e*i.pageCount+1+n)<=i.totalPages?(this.links[n].style.display="",this.links[n].setAttribute("index",t.toString()),this.links[n].innerHTML=i.customText?i.customText+t:t.toString(),i.currentPage!==t?this.links[n].classList.add("e-pager-default"):this.links[n].classList.remove("e-pager-default")):(this.links[n].innerHTML=i.customText?i.customText+t:t.toString(),this.links[n].style.display="none"),Object(m.A)(this.links[n],[],["e-currentitem","e-active"]);this.first.setAttribute("index","1"),this.last.setAttribute("index",i.totalPages.toString()),this.prev.setAttribute("index",(i.currentPage-1).toString()),this.next.setAttribute("index",(i.currentPage+1).toString()),this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1"),this.pagerElement.querySelector(".e-mlast").setAttribute("index",i.totalPages.toString()),this.pagerElement.querySelector(".e-mprev").setAttribute("index",(i.currentPage-1).toString()),this.pagerElement.querySelector(".e-mnext").setAttribute("index",(i.currentPage+1).toString()),this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-i.pageCount).toString()),this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())}},{key:"updateStyles",value:function(){this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length&&Object(m.A)(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[])}},{key:"updateFirstNPrevStyles",value:function(){var e=["e-firstpage","e-pager-default"],t=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],n=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(Object(m.A)(this.prev,i,n),Object(m.A)(this.first,e,t),Object(m.A)(this.pagerElement.querySelector(".e-mfirst"),e,t),Object(m.A)(this.pagerElement.querySelector(".e-mprev"),i,n)):(Object(m.A)(this.prev,n,i),Object(m.A)(this.first,t,e),Object(m.A)(this.pagerElement.querySelector(".e-mprev"),n,i),Object(m.A)(this.pagerElement.querySelector(".e-mfirst"),t,e))}},{key:"updatePrevPagerSetStyles",value:function(){this.pagerModule.currentPage>this.pagerModule.pageCount?Object(m.A)(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):Object(m.A)(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])}},{key:"updateNextPagerSetStyles",value:function(){var e=this.pagerModule,t=this.links[0].innerHTML.replace(e.customText,"");!t.length||!this.links.length||parseInt(t,10)+e.pageCount>e.totalPages?Object(m.A)(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):Object(m.A)(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])}},{key:"updateNextNLastStyles",value:function(){var e=["e-lastpage","e-pager-default"],t=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],n=["e-nextpagedisabled","e-disable"],r=this.pagerModule;r.currentPage===r.totalPages||0===r.totalRecordsCount?(Object(m.A)(this.last,t,e),Object(m.A)(this.next,n,i),Object(m.A)(this.pagerElement.querySelector(".e-mlast"),t,e),Object(m.A)(this.pagerElement.querySelector(".e-mnext"),n,i)):(Object(m.A)(this.last,e,t),Object(m.A)(this.next,i,n),Object(m.A)(this.pagerElement.querySelector(".e-mlast"),e,t),Object(m.A)(this.pagerElement.querySelector(".e-mnext"),i,n))}}]),e}(),ln=function(){function e(t){p(this,e),this.pagerModule=t}return f(e,[{key:"render",value:function(){var e=Object(m.F)("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=Object(m.F)("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=Object(m.F)("span",{className:"e-pagecountmsg",styles:"textalign:right"}),Object(m.w)([this.pageNoMsgElem,this.pageCountMsgElem],e),this.pagerModule.element.appendChild(e),this.refresh()}},{key:"refresh",value:function(){var e=this.pagerModule;Object(m.W)()?(this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("CurrentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel("TotalItemsInfo"),[e.totalRecordsCount||0])):(this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("currentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0,e.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel(e.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[e.totalRecordsCount||0,e.totalRecordsCount?e.pageSize*(e.currentPage-1)+1:0,e.pageSize*e.currentPage>e.totalRecordsCount?e.totalRecordsCount:e.pageSize*e.currentPage])),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)}},{key:"hideMessage",value:function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")}},{key:"showMessage",value:function(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""}},{key:"destroy",value:function(){}},{key:"format",value:function(e,t){for(var i,n=0;n<t.length;n++)i=new RegExp("\\{"+n+"\\}","gm"),e=e.replace(i,t[n].toString());return e}}]),e}(),on=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},hn=(tn=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).hasParent=!1,n}return f(r,[{key:"requiredModules",value:function(){var e=[];return this.enableExternalMessage&&e.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&e.push({member:"pagerdropdown",args:[this]}),e}},{key:"preRender",value:function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager",previousPagerTooltip:"Go to previous pager",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager",PreviousPagerTooltip:"Go to previous pager",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All"},this.containerModule=new an(this),this.pagerMessageModule=new ln(this)}},{key:"render",value:function(){this.template?this.isReactTemplate()?(this.on("pager-refresh",this.pagerTemplate,this),this.notify("pager-refresh",{})):this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}))}},{key:"getPersistData",value:function(){return this.addOnPersist(["currentPage","pageSize"])}},{key:"destroy",value:function(){this.isReactTemplate()&&(this.off("pager-refresh",this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),i(o(r.prototype),"destroy",this).call(this),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML="")}},{key:"destroyTemplate",value:function(e,t){this.clearTemplate(e,t)}},{key:"getModuleName",value:function(){return"pager"}},{key:"onPropertyChanged",value:function(e,t){if(!this.isDestroyed){e.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var i=0,n=Object.keys(e);i<n.length;i++)switch(n[i]){case"currentPage":this.checkGoToPage(e.currentPage,t.currentPage)&&this.currentPageChanged(e,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==e.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize)),e.pageSize!==t.pageSize?(this.pageSize=e.pageSize,this.currentPageChanged(e,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}}}},{key:"getLocalizedLabel",value:function(e){return this.localeObj.getConstant(e)}},{key:"goToPage",value:function(e){this.checkGoToPage(e)&&(this.currentPage=e,this.dataBind())}},{key:"setPageSize",value:function(e){this.pageSize=e,this.dataBind()}},{key:"checkpagesizes",value:function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)}},{key:"checkGoToPage",value:function(e,t){return e!==this.currentPage&&(this.previousPageNo=this.currentPage),Object(m.X)(t)||(this.previousPageNo=t),this.previousPageNo!==e&&e>=1&&e<=this.totalPages}},{key:"currentPageChanged",value:function(e,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),e.currentPage!==t.currentPage||e.pageSize!==t.pageSize){var i={currentPage:this.currentPage,newProp:e,oldProp:t,cancel:!1};this.trigger("click",i),i.cancel||this.refresh()}}},{key:"pagerTemplate",value:function(){if(!this.isReactTemplate()||!this.hasParent){var e;this.element.classList.add("e-pagertemplate"),this.compile(this.template);var t={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},i=this.element.parentElement.id+"_template";this.isReactTemplate()?(this.getPagerTemplate()(t,this,"template",i,null,null,this.element),this.renderReactTemplates()):(e=Object(m.W)()?this.getPagerTemplate()(t,this,"template",i,this.isStringTemplate):this.getPagerTemplate()(t),Jt(this.element,e))}}},{key:"updateTotalPages",value:function(){this.totalPages=this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1}},{key:"getPagerTemplate",value:function(){return this.templateFn}},{key:"compile",value:function(e){if(e)try{document.querySelectorAll(e).length&&(this.templateFn=Object(m.E)(document.querySelector(e).innerHTML.trim()))}catch(t){this.templateFn=Object(m.E)(e)}}},{key:"refresh",value:function(){this.template?this.isReactTemplate()?(this.updateTotalPages(),this.notify("pager-refresh",{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate()):(this.updateRTL(),this.containerModule.refresh(),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh())}},{key:"updateRTL",value:function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},{key:"initLocalization",value:function(){this.localeObj=new m.p(this.getModuleName(),this.defaultConstants,this.locale)}},{key:"updateQueryString",value:function(e){var t=this.getUpdatedURL(window.location.href,"page",e.toString());window.history.pushState({path:t},"",t)}},{key:"getUpdatedURL",value:function(e,t,i){var n=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i");if(e.match(n))return e.replace(n,"$1"+t+"="+i+"$2");var r="";return-1!==e.indexOf("#")&&(r=e.replace(/.*#/,"#"),e=e.replace(/#.*/,"")),e+(-1!==e.indexOf("?")?"&":"?")+t+"="+i+r}},{key:"renderFirstPrevDivForDevice",value:function(){this.element.appendChild(Object(m.F)("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:Object(m.W)()?this.getLocalizedLabel("FirstPageTooltip"):this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(m.F)("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:Object(m.W)()?this.getLocalizedLabel("PreviousPageTooltip"):this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))}},{key:"renderNextLastDivForDevice",value:function(){this.element.appendChild(Object(m.F)("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:Object(m.W)()?this.getLocalizedLabel("NextPageTooltip"):this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(m.F)("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:Object(m.W)()?this.getLocalizedLabel("LastPageTooltip"):this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))}},{key:"addAriaLabel",value:function(){var e=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"];if(!m.d.isDevice)for(var t=0;t<e.length;t++){var i=this.element.querySelector(e[t]);i.setAttribute("aria-label",i.getAttribute("title"))}}},{key:"isReactTemplate",value:function(){return this.isReact&&this.template&&"string"!=typeof this.template}}]),r}(m.h),on([Object(m.s)(!1)],tn.prototype,"enableQueryString",void 0),on([Object(m.s)(!1)],tn.prototype,"enableExternalMessage",void 0),on([Object(m.s)(!0)],tn.prototype,"enablePagerMessage",void 0),on([Object(m.s)(12)],tn.prototype,"pageSize",void 0),on([Object(m.s)(10)],tn.prototype,"pageCount",void 0),on([Object(m.s)(1)],tn.prototype,"currentPage",void 0),on([Object(m.s)()],tn.prototype,"totalRecordsCount",void 0),on([Object(m.s)()],tn.prototype,"externalMessage",void 0),on([Object(m.s)(!1)],tn.prototype,"pageSizes",void 0),on([Object(m.s)()],tn.prototype,"template",void 0),on([Object(m.s)("")],tn.prototype,"customText",void 0),on([Object(m.k)()],tn.prototype,"click",void 0),on([Object(m.k)()],tn.prototype,"dropDownChanged",void 0),on([Object(m.k)()],tn.prototype,"created",void 0),tn=on([m.q],tn)),cn=function(){function e(t){p(this,e),this.pagerModule=t}return f(e,[{key:"getModuleName",value:function(){return"pagerdropdown"}},{key:"render",value:function(){var e=this.pagerModule;this.pagerDropDownDiv=Object(m.F)("div",{className:"e-pagesizes"});var t=Object(m.F)("div",{className:"e-pagerdropdown"}),i=Object(m.F)("div",{className:"e-pagerconstant"}),n=Object(m.F)("input",{attrs:{type:"text",tabindex:"1"}});this.pagerCons=Object(m.F)("span",{className:"e-constant",innerHTML:Object(m.W)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown")}),t.appendChild(n),i.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(t),this.pagerDropDownDiv.appendChild(i),this.pagerModule.element.appendChild(this.pagerDropDownDiv);var r=this.pagerModule.pageSizes,s=r.length?this.convertValue(r):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],a=this.pagerModule.pageSize;this.dropDownListObject=new w.d({dataSource:s,value:a.toString(),change:this.onChange.bind(this),cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(n),r.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),e.pageSize=a,e.dataBind(),e.trigger("dropDownChanged",{pageSize:a}),this.addEventListener()}},{key:"onChange",value:function(e){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.refresh(),e.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh()),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:parseInt(this.dropDownListObject.value,10)})}},{key:"refresh",value:function(){this.pagerCons&&(this.pagerCons.innerHTML=this.pagerModule.pageSize===this.pagerModule.totalRecordsCount?Object(m.W)()?this.pagerModule.getLocalizedLabel("PagerAllDropDown"):this.pagerModule.getLocalizedLabel("pagerAllDropDown"):Object(m.W)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown"))}},{key:"beforeValueChange",value:function(e){if("number"==typeof e.newProp.value){var t=e.newProp.value.toString();e.newProp.value=t}}},{key:"convertValue",value:function(e){for(var t=e,i=0;i<t.length;i++)t[i]=parseInt(t[i],10)?t[i].toString():""!==this.pagerModule.getLocalizedLabel(t[i])?this.pagerModule.getLocalizedLabel(t[i]):t[i];return t}},{key:"setDropDownValue",value:function(e,t){this.dropDownListObject&&(this.dropDownListObject[e]=t)}},{key:"addEventListener",value:function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)}},{key:"removeEventListener",value:function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)}},{key:"destroy",value:function(e){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),Object(m.hb)(this.pagerDropDownDiv))}}]),e}(),un=function(){function e(t){p(this,e),this.pagerModule=t}return f(e,[{key:"getModuleName",value:function(){return"externalMessage"}},{key:"render",value:function(){this.element=Object(m.F)("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}}),this.pagerModule.element.appendChild(this.element),this.refresh()}},{key:"refresh",value:function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()}},{key:"hideMessage",value:function(){Object(m.X)(this.element)||(this.element.style.display="none")}},{key:"showMessage",value:function(){this.element.style.display=""}},{key:"destroy",value:function(){Object(m.hb)(this.element)}}]),e}(),dn=function(){function e(t,i){p(this,e),this.isInitialRender=!0,hn.Inject(un,cn),this.parent=t,this.pageSettings=i,this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"pager"}},{key:"render",value:function(){var e,t=this.parent;this.pagerDestroy(),Object(m.X)(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0),this.element=this.parent.createElement("div",{className:"e-gridpager"}),e=Pt({},Object(m.K)({},Nt(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:t.enableRtl,locale:t.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]),this.pagerObj=new hn(e),this.pagerObj.hasParent=!0,this.pagerObj.on("pager-refresh",this.renderReactPagerTemplate,this),this.pagerObj.allowServerDataBinding=!1}},{key:"onSelect",value:function(e){this.pageSettings.pageSize=e.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)}},{key:"addAriaAttr",value:function(){if(!this.pageSettings.template){for(var e=this.parent.createElement("div",{className:"e-numericcontainer"}),t=this.element.querySelector(".e-pagercontainer"),i=document.createDocumentFragment(),n=this.element.querySelector(".e-numericcontainer"),r=n.querySelectorAll("a"),s=0;s<r.length;s++){this.parent.getContentTable()?r[s].setAttribute("aria-owns",this.parent.getContentTable().id):r[s].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");var a=this.parent.createElement("div");a.appendChild(r[s]),i.appendChild(a)}e.appendChild(i),t.replaceChild(e,n);for(var l=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],o=0;o<l.length;o++){var h=this.element.querySelector(l[o]);this.parent.getContentTable()&&h.setAttribute("aria-owns",this.parent.getContentTable().id)}}}},{key:"dataReady",value:function(e){this.updateModel(e)}},{key:"refresh",value:function(){this.pagerObj.refresh()}},{key:"goToPage",value:function(e){this.pagerObj.goToPage(e)}},{key:"setPageSize",value:function(e){this.pagerObj.setPageSize(e)}},{key:"updateModel",value:function(e){this.parent.pageSettings.totalRecordsCount=e.count,this.parent.dataBind()}},{key:"onActionComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(E,Object(m.K)(e,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:E}))}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName()){for(var t=e.properties,i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.pagerObj[r]=t[r]}this.pagerObj.dataBind()}}},{key:"clickHandler",value:function(e){var t=this.parent;if(this.isForceCancel||oi(t)&&!t.prevPageMoving)return this.isForceCancel?this.isForceCancel=!1:(Object(m.X)(e.newProp)||Object(m.X)(e.newProp.pageSize)?e.currentPage&&(t.notify(G,{instance:this,handler:this.goToPage,arg1:e.currentPage}),this.pagerObj.currentPage=t.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:t.pageSettings.currentPage):(t.notify(G,{instance:this,handler:this.setPageSize,arg1:e.newProp.pageSize}),this.pagerObj.pageSize=e.oldProp.pageSize,t.pageSettings.pageSize=e.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(e.cancel=!0);t.pageSettings.pageSize=this.pagerObj.pageSize,t.prevPageMoving=!1;var i=this.pageSettings.currentPage;this.pageSettings.currentPage=e.currentPage;var n={cancel:!1,requestType:"paging",previousPage:i,currentPage:e.currentPage,type:D};this.parent.notify(P,n),n.cancel&&(e.cancel=!0),this.parent.requestTypeAction="paging"}},{key:"keyPressHandler",value:function(e){e.action in pn&&(e.preventDefault(),this.element.querySelector(pn[e.action]).click())}},{key:"updateExternalMessage",value:function(e){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=e,this.pagerObj.dataBind()}},{key:"appendToElement",value:function(e){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.isReact=this.parent.isReact,this.pagerObj.appendTo(this.element),this.isInitialLoad=!1}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))}},{key:"addEventListener",value:function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created},this.parent.isDestroyed||(this.parent.isReact&&this.parent.addEventListener("created",this.handlers.created.bind(this)),this.parent.on(M,this.handlers.load,this),this.parent.on(F,this.handlers.end,this),this.parent.on(T,this.handlers.ready,this),this.parent.on("paging-complete",this.handlers.complete,this),this.parent.on(z,this.handlers.updateLayout,this),this.parent.on(B,this.handlers.inboundChange,this),this.parent.on(V,this.handlers.keyPress,this))}},{key:"created",value:function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())}},{key:"isReactTemplate",value:function(){return this.parent.isReact&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template}},{key:"renderReactPagerTemplate",value:function(){if(!this.isInitialRender&&this.isReactTemplate()){this.parent.destroyTemplate(["pagerTemplate"]),this.element.classList.add("e-pagertemplate"),this.pagerObj.compile(this.pagerObj.template);var e=this.parent.pageSettings;this.pagerObj.templateFn({currentPage:e.currentPage,pageSize:e.pageSize,pageCount:e.pageCount,totalRecordsCount:e.totalRecordsCount,totalPages:this.pagerObj.totalPages},this.parent,"pagerTemplate",this.parent.id+"_pagertemplate",null,null,this.pagerObj.element),this.parent.renderTemplates()}}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.isReact&&this.parent.removeEventListener("created",this.handlers.created),this.parent.off("pager-refresh",this.renderReactPagerTemplate),this.parent.off(M,this.handlers.load),this.parent.off(F,this.handlers.end),this.parent.off(T,this.handlers.ready),this.parent.off("paging-complete",this.handlers.complete),this.parent.off(z,this.handlers.updateLayout),this.parent.off(B,this.handlers.inboundChange),this.parent.off(V,this.handlers.keyPress))}},{key:"destroy",value:function(){this.removeEventListener(),this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]),this.pagerObj.destroy()}},{key:"pagerDestroy",value:function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),Object(m.hb)(this.element))}}]),e}(),pn={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"},gn=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TH",{className:"e-filterbarcell"}),e}return f(i,[{key:"getGui",value:function(){return this.parent.createElement("div")}},{key:"render",value:function(e,t){var i,n=this.parent.element.querySelector(".e-filterbar"),r=this.element.cloneNode(),s=this.getGui(),a=e.column;if(n.appendChild(r),r.setAttribute("e-mappinguid",a.uid),a.filterTemplate){var l={};if(t&&(l[a.field]=t[a.field]),l.column=a,a.visible){var o=this.parent.element.id+a.uid+"filterTemplate";this.parent.isReact&&"string"!=typeof a.filterTemplate?(a.getFilterTemplate()(l,this.parent,"filterTemplate",o,null,null,r),this.parent.renderTemplates()):Jt(r,a.getFilterTemplate()(l,this.parent,"filterTemplate",o))}else r.classList.add("e-hide")}else if("checkbox"!==a.type){if(!Object(m.X)(a.allowFiltering)&&!a.allowFiltering||Object(m.X)(a.filterBarTemplate))Object(m.x)(s,{class:"e-filterdiv e-fltrinputdiv"}),i=this.parent.createElement("input",{id:a.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:a.headerText+e.attributes.title,value:t[e.column.field]?t[e.column.field]:"",role:"search"}}),s.appendChild(i),C.c.createInput({element:i,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},this.parent.createElement);else if(r.classList.add("e-fltrtemp"),Object(m.x)(s,{class:"e-fltrtempdiv"}),Object(m.X)(a.filterBarTemplate.create))i=this.parent.createElement("input",{id:a.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:a.headerText}}),s.appendChild(i);else{var h={column:a,node:Element},c=a.filterBarTemplate.create;if("string"==typeof c&&(c=Object(m.V)(c,window)),"string"==typeof(i=c(h))){var u=this.parent.createElement("div");u.innerHTML=i,i=u.firstChild}Object(m.x)(s,{class:"e-filterUi_input e-filtertext e-fltrTemp",title:a.headerText,id:a.field+"_filterBarcell"}),s.appendChild(i)}if((!1===a.allowFiltering||""===a.field||Object(m.X)(a.field))&&(i.setAttribute("disabled","true"),i.classList.add("e-disable")),a.visible||r.classList.add("e-hide"),this.appendHtml(r,s),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&Object(m.X)(a.filterTemplate)&&this.operatorIconRender(s,a,e),(Object(m.X)(a.allowFiltering)||a.allowFiltering)&&!Object(m.X)(a.filterBarTemplate)){var d=a.filterBarTemplate.write,p={element:i,column:a};"string"==typeof d&&(d=Object(m.V)(d,window)),d.call(this,p)}}return r}},{key:"appendHtml",value:function(e,t){return e.appendChild(t),e}},{key:"operatorIconRender",value:function(e,t,i){var n=this.parent,r=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:i.column.uid});e.querySelector("span").appendChild(r);var s=t.filter&&t.filter.operator?t.filter.operator:"equal";Object(m.X)(n.filterModule.operators[t.field])||(s=n.filterModule.operators[t.field]),this.dropOptr=new w.d({fields:{text:"text",value:"value"},popupHeight:"auto",value:s,width:"0px",enabled:t.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){this.dataSource=n.filterModule.customOperators[n.getColumnByUid(this.element.id).type+"Operator"];for(var e=0;e<this.dataSource.length;e++)t.filter&&t.filter.operator&&Object(m.X)(n.filterModule.operators[t.field])&&this.dataSource[e].value===t.filter.operator&&(this.value=t.filter.operator)}}),this.dropOptr.appendTo(r);var a=Object(m.C)(this.dropOptr.element,"span");a.classList.add("e-filterbardropdown"),a.removeAttribute("tabindex")}},{key:"internalEvent",value:function(e){var t=this.parent,i=t.getColumnByUid(e.element.getAttribute("id"));e.column=i,t.filterModule.operators[i.field]=e.value,t.notify("get-filterbar-operator",e)}}]),i}(ae),fn=function(){function e(t,i,n,r){p(this,e),this.parent=t,this.serviceLocator=n,this.filterSettings=r,this.customFilterOperators=i}return f(e,[{key:"renderOperatorUI",value:function(e,t,i,n){this.dialogObj=n;var r=i.type+"Operator";this.optrData=this.customOptr=Object(m.X)(this.parent.filterSettings.operators)||Object(m.X)(this.parent.filterSettings.operators[r])?this.customFilterOperators[r]:this.parent.filterSettings.operators[r];var s=this.customOptr,a=this.dropSelectedVal(i,r),l=this.parent.createElement("div",{className:"e-flm_optrdiv"});e.appendChild(l);var o=this.parent.createElement("input",{id:i.uid+"-floptr"});l.appendChild(o),this.dropOptr=new w.d({dataSource:s,fields:{text:"text",value:"value"},open:this.dropDownOpen.bind(this),cssClass:"e-popup-flmenu",text:a}),this.dropOptr.appendTo("#"+i.uid+"-floptr")}},{key:"dropDownOpen",value:function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}},{key:"dropSelectedVal",value:function(e,t){var i,n="",r=c(this.parent.filterSettings.columns);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(e.field===s.field||e.isForeignColumn()&&e.foreignKeyValue===s.field){var a=new v.a(this.optrData).executeLocal((new v.g).where("value","equal",s.operator));n=Object(m.X)(a[0])?"":a[0].text}}}catch(h){r.e(h)}finally{r.f()}if(""===n)if(e.filter.operator)for(var l=Object.keys(this.optrData).length,o=0;o<l;o++)this.optrData[o].value===e.filter.operator&&(n=this.optrData[o].text);else n=this.optrData[0].text;return n}},{key:"getFlOperator",value:function(){return this.dropOptr.value}}]),e}(),mn=function(){function e(t,i,n){p(this,e),this.parent=t,this.serLocator=i,this.filterSettings=n}return f(e,[{key:"create",value:function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+e.column.uid}),e.target.appendChild(this.instance),this.dialogObj=e.dialogObj,this.actObj=this.getAutoCompleteOptions(e),this.actObj.appendTo(this.instance)}},{key:"getAutoCompleteOptions",value:function(e){var t,i=this,n=e.column.isForeignColumn();n&&((t=new v.g).params=this.parent.query.params);var r=n?e.column.dataSource:this.parent.dataSource,s={value:n?e.column.foreignKeyValue:e.column.field},a=new w.a(Object(m.K)({dataSource:r instanceof v.a?r:new v.a(r),fields:s,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:n?t:this.parent.query.clone(),sortOrder:"Ascending",open:this.openPopup.bind(this),cssClass:"e-popup-flmenu",focus:function(){i.actObj.filterType=e.getOptrInstance.getFlOperator()},autofill:!0,placeholder:e.localizeText.getConstant("EnterValue"),actionComplete:function(e){e.result=e.result.filter((function(e,t,n){return n.map((function(e){return Object(m.V)(i.actObj.fields.value,e)})).indexOf(Object(m.V)(i.actObj.fields.value,e))===t}))}},e.column.filter.params));if(r&&"result"in r){var l=Li({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new v.g);this.parent.trigger("dataStateChange",l.state),l.deffered.promise.then((function(e){a.dataSource=new v.a(e)}))}return a}},{key:"write",value:function(e){""===e.filteredValue||Object(m.X)(e.filteredValue)||(document.querySelector("#strui-"+e.column.uid).ej2_instances[0].value=e.filteredValue)}},{key:"read",value:function(e,t,i,n){var r=document.querySelector("#strui-"+t.uid).ej2_instances[0];m.d.isDevice&&(r.hidePopup(),r.focusOut());var s=r.value;(Object(m.X)(s)||""===s)&&(s=null),n.filterByColumn(t.field,i,s,"and",this.parent.filterSettings.enableCaseSensitivity)}},{key:"openPopup",value:function(e){pi(e,this.dialogObj)}}]),e}(),vn=function(){function e(t,i,n){p(this,e),this.filterSettings=n,this.parent=t,this.serviceLocator=i}return f(e,[{key:"create",value:function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+e.column.uid}),e.target.appendChild(this.instance),this.numericTxtObj=new C.e(Object(m.K)({format:"string"==typeof e.column.format||Object(m.ab)(e.column.format)?e.column.format:e.column.format.format,locale:this.parent.locale,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},e.column.filter.params)),this.numericTxtObj.appendTo(this.instance)}},{key:"write",value:function(e){document.querySelector("#numberui-"+e.column.uid).ej2_instances[0].value=e.filteredValue}},{key:"read",value:function(e,t,i,n){var r=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;Object(m.X)(r)&&(r=parseFloat(e.value)),n.filterByColumn(t.field,i,r,"and",!0)}}]),e}(),bn=function(){function e(t,i,n){p(this,e),this.parent=t,this.serviceLocator=i,this.filterSettings=n}return f(e,[{key:"create",value:function(e){var t=e.column.isForeignColumn(),i=t?e.column.dataSource:this.parent.dataSource,n=t?e.column.foreignKeyValue:e.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+e.column.uid}),e.target.appendChild(this.elem),this.dialogObj=e.dialogObj,this.dropInstance=new w.d(Object(m.K)({dataSource:i instanceof v.a?i:new v.a(i),query:(new v.g).select(n),fields:{text:n,value:n},placeholder:e.localizeText.getConstant("SelectValue"),cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this),actionComplete:function(e){e.result=v.b.distinct(e.result,n,!0)}},e.column.filter.params)),this.dropInstance.appendTo(this.elem)}},{key:"write",value:function(e){var t=document.querySelector("#bool-ui-"+e.column.uid).ej2_instances[0];Object(m.X)(e.filteredValue)||(t.text=e.filteredValue)}},{key:"read",value:function(e,t,i,n){var r=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0];n.filterByColumn(t.field,i,r.value,"and",!1)}},{key:"openPopup",value:function(e){pi(e,this.dialogObj)}}]),e}(),yn=function(){function e(t,i,n){p(this,e),this.parent=t,this.locator=i,this.fltrSettings=n}return f(e,[{key:"create",value:function(e){var t=xi(e.column.format,e.column.type);this.dialogObj=e.dialogObj,this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+e.column.uid}),e.target.appendChild(this.inputElem),"date"===e.column.type?this.datePickerObj=new k.b(Object(m.K)({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},e.column.filter.params)):"datetime"===e.column.type&&(this.datePickerObj=new k.d(Object(m.K)({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},e.column.filter.params))),this.datePickerObj.appendTo(this.inputElem)}},{key:"write",value:function(e){document.querySelector("#dateui-"+e.column.uid).ej2_instances[0].value=Object(m.X)(e.filteredValue)?null:new Date(e.filteredValue)}},{key:"read",value:function(e,t,i,n){var r=document.querySelector("#dateui-"+t.uid).ej2_instances[0].value;r=Object(m.X)(r)?null:r,n.filterByColumn(t.field,i,r,"and",!0)}},{key:"openPopup",value:function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()}}]),e}(),Cn=function(){function e(t,i,n,r,s){p(this,e),this.isDialogOpen=!1,this.colTypes={string:mn,number:vn,date:yn,boolean:bn,datetime:yn},this.parent=t,this.filterSettings=i,this.serviceLocator=n,this.customFilterOperators=r,this.filterObj=s,this.flMuiObj=new fn(this.parent,this.customFilterOperators,this.serviceLocator),this.l10n=this.serviceLocator.getService("localization")}return f(e,[{key:"openDialog",value:function(e){this.col=this.parent.getColumnByField(e.field),(Object(m.X)(this.col.filter)||Object(m.X)(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(e.target,this.col)}},{key:"closeDialog",value:function(e){if(this.dlgObj){if(Object(m.W)())for(var t=this.parent.getColumns(),i=0;i<t.length;i++)if(t[i].filterTemplate){var n=this.parent.element.id+t[i].uid+"filterTemplate";Object(m.sb)(n,"FilterTemplate",t[i])}this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates());var r=document.getElementById(this.dlgObj.element.id);if(this.dlgObj&&!this.dlgObj.isDestroyed&&r){var s={cancel:!1,column:this.col,target:e,element:r};if(this.parent.notify("filter-menu-close",s),s.cancel)return;this.isDialogOpen=!1,this.dlgObj.destroy(),Object(m.hb)(r)}}}},{key:"renderDlgContent",value:function(e,t){var i={requestType:"filterbeforeopen",columnName:t.field,columnType:t.type};Object(m.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.parent.trigger(D,i);var n=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:t.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:t.uid+"-flmdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new b.a({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,e,t),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:"e-flmenu-cancelbtn"}}],content:n,width:!Object(m.X)(Wt(e,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:"e-filter-popup"}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv)}},{key:"dialogCreated",value:function(e,t){m.d.isDevice||di(e,this.dlgObj,this.parent),this.renderFilterUI(e,t),this.parent.notify("filterDialogCreated",{}),this.dlgObj.element.style.maxHeight="350px",this.dlgObj.show(),t.filterTemplate||this.writeMethod(t,this.dlgObj.element.querySelector("#"+t.uid+"-flmenu"));var i={requestType:"filterafteropen",columnName:t.field,columnType:t.type};Object(m.W)()&&!this.parent.isJsComponent||(i.filterModel=this),this.isDialogOpen=!0,this.parent.trigger(E,i)}},{key:"renderFilterUI",value:function(e,t){var i=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t}),this.renderOperatorUI(i,e,t),this.renderFlValueUI(i,e,t)}},{key:"renderOperatorUI",value:function(e,t,i){this.flMuiObj.renderOperatorUI(e,t,i,this.dlgObj)}},{key:"renderFlValueUI",value:function(e,t,i){var n=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),r=this.filterObj;e.appendChild(n);var s=new this.colTypes[i.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(i.filterTemplate){var a={};a[i.field]=a.value=r.values[i.field],i.foreignKeyValue&&(a[i.foreignKeyValue]=r.values[i.field],a[i.field]=void 0),a.column=i;var l=this.parent.element.id+i.uid+"filterTemplate";if(this.parent.isReact&&"string"!=typeof i.filterTemplate)i.getFilterTemplate()(a,this.parent,"filterTemplate",l,null,null,n),this.parent.renderTemplates();else{var o=i.getFilterTemplate()(a,this.parent,"filterTemplate",l);Object(m.sb)(l,"FilterTemplate",i),Jt(n,o)}}else if(Object(m.X)(i.filter)||Object(m.X)(i.filter.ui)||Object(m.X)(i.filter.ui.create))s.create({column:i,target:n,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj});else{var h=i.filter.ui.create;"string"==typeof h&&(h=Object(m.V)(h,window)),h({column:i,target:n,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj})}}},{key:"writeMethod",value:function(e,t){var i,n,r=t.querySelector(".e-flmenu-valinput"),s=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings),a=c(this.filterSettings.columns);try{for(a.s();!(n=a.n()).done;){var l=n.value;e.uid===l.uid&&(i=l.value)}}catch(h){a.e(h)}finally{a.f()}if(Object(m.X)(e.filter)||Object(m.X)(e.filter.ui)||Object(m.X)(e.filter.ui.write))s.write({column:e,target:r,parent:this.parent,filteredValue:i});else{var o=e.filter.ui.write;"string"==typeof o&&(o=Object(m.V)(o,window)),o({column:e,target:r,parent:this.parent,filteredValue:i})}}},{key:"filterBtnClick",value:function(e){var t,i=this.dlgObj.element.querySelector(".e-flmenu-valuediv input");t=this.flMuiObj.getFlOperator();var n=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(e.filterTemplate){var r,s=this.dlgDiv.querySelector(".e-flmenu-valuediv");if(s.children[0].value)r=s.children[0].value;else if(Object(m.W)()||Object(m.X)(s.children[0].ej2_instances)){var a=s.querySelector(".e-control");r="boolean"===e.type?a.checked:Object(m.X)(a.ej2_instances)?a.value:a.ej2_instances[0].value}else r=s.children[0].ej2_instances[0].value;this.filterObj.filterByColumn(e.field,t,r)}else if(Object(m.X)(e.filter)||Object(m.X)(e.filter.ui)||Object(m.X)(e.filter.ui.read))n.read(i,e,t,this.filterObj);else{var l=e.filter.ui.read;"string"==typeof l&&(l=Object(m.V)(l,window)),l({element:i,column:e,operator:t,fltrObj:this.filterObj})}this.closeDialog()}},{key:"clearBtnClick",value:function(e){this.filterObj.removeFilteredColsByField(e.field),Object(m.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.closeDialog();var t=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",i=this.parent.element.querySelector('[e-mappinguid="'+e.uid+'"]').parentElement.querySelector(t);i&&i.classList.remove("e-filtered")}},{key:"destroy",value:function(){this.closeDialog()}},{key:"getFilterUIInfo",value:function(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}}}]),e}(),wn=function(){function e(t,i,n){p(this,e),this.parent=t,this.isresetFocus=!0,this.checkBoxBase=new nn(t),this.addEventListener()}return f(e,[{key:"destroy",value:function(){this.removeEventListener(),this.checkBoxBase.closeDialog()}},{key:"openDialog",value:function(e){this.checkBoxBase.openDialog(e),this.parent.log("column_type_missing",{column:e.column})}},{key:"closeDialog",value:function(){this.removeEventListener(),this.checkBoxBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})}},{key:"getModuleName",value:function(){return"checkboxFilter"}},{key:"actionBegin",value:function(e){this.parent.trigger(D,e)}},{key:"actionComplete",value:function(e){this.parent.trigger(E,e)}},{key:"actionPrevent",value:function(e){oi(this.parent)&&(this.parent.notify(G,e),e.cancel=!0)}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on("cbox-filter-begin",this.actionBegin,this),this.parent.on("cbox-filter-complete",this.actionComplete,this),this.parent.on("filter-Prevent",this.actionPrevent,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("cbox-filter-begin",this.actionBegin),this.parent.off("cbox-filter-complete",this.actionComplete),this.parent.off("filter-Prevent",this.actionPrevent))}}]),e}(),kn=function(e){n(i,e);var t=s(i);function i(e,n,r,s){var a;return p(this,i),(a=t.call(this,e,n,r)).parent=e,a.isresetFocus=!0,a.excelFilterBase=new rn(e,s),a}return f(i,[{key:"destroy",value:function(){this.excelFilterBase.closeDialog()}},{key:"openDialog",value:function(e){this.excelFilterBase.openDialog(e)}},{key:"closeDialog",value:function(){this.excelFilterBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})}},{key:"filterByColumn",value:function(e,t,i,n,r,s,a,l){this.excelFilterBase.filterByColumn(e,t,i,n,r,s,a,l)}},{key:"getFilterUIInfo",value:function(){return this.excelFilterBase.getFilterUIInfo()}},{key:"getModuleName",value:function(){return"excelFilter"}}]),i}(wn),Sn=function(){function e(t,i,n){p(this,e),this.predicate="and",this.contentRefresh=!0,this.filterByMethod=!0,this.refresh=!0,this.values={},this.operators={},this.cellText={},this.nextFlMenuOpen="",this.type={Menu:Cn,CheckBox:wn,Excel:kn},this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.fltrDlgDetails={field:"",isOpen:!1},this.skipNumberInput=["="," ","!"],this.skipStringInput=[">","<","="],this.actualPredicate={},this.parent=t,this.filterSettings=i,this.serviceLocator=n,this.addEventListener()}return f(e,[{key:"render",value:function(e){if(!(v.b.getObject("args.isFrozen",e)||"Left-Right"===this.parent.getFrozenMode()&&v.b.getObject("args.renderFrozenRightContent",e))){var t=this.parent;if(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&t.columns.length){var i=this.parent.element.querySelector(".e-filterbar");i&&Object(m.hb)(i);var n,r=new Z(this.serviceLocator,K.Filter,t);this.serviceLocator.getService("cellRendererFactory").addCellRenderer(K.Filter,new gn(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),r.element=this.parent.createElement("tr",{className:"e-filterbar"}),(n=this.generateRow()).data=this.values,"Right"===t.getFrozenMode()?t.getFrozenRightHeader().querySelector("thead").appendChild(r.element):this.parent.getHeaderContent().querySelector("thead").appendChild(r.element);var s=this.parent.element.querySelector(".e-rowdragheader");this.element=r.render(n,t.getColumns(),null,null,r.element);var a=this.element.querySelector(".e-detailheadercell");a&&(a.className="e-filterbarcell e-mastercell"),s&&(s.className="e-dragheadercell e-mastercell");var l=[].slice.call(this.element.querySelectorAll(".e-grouptopleftcell"));l.length&&l[l.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify("freezerender",{case:"filter"})}}}},{key:"destroy",value:function(){var e=this.parent.element;if(e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator)for(var t=this.element.querySelectorAll(".e-filterbaroperator"),i=0;i<t.length;i++)t[i].ej2_instances[0].destroy();if(this.element){Object(m.hb)(this.element);var n=this.parent.getHeaderContent().querySelector(".e-filterbar");this.parent.isFrozenGrid()&&n&&Object(m.hb)(n)}}}},{key:"generateRow",value:function(e){var t=new _({});return t.cells=this.generateCells(),t}},{key:"generateCells",value:function(){var e=[];if(this.parent.allowGrouping)for(var t=0,i=this.parent.groupSettings.columns.length;t<i;t++)e.push(this.generateCell({},K.HeaderIndent));(this.parent.detailTemplate||this.parent.childGrid)&&e.push(this.generateCell({},K.DetailHeader)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&e.push(this.generateCell({},K.RowDragHIcon));var n,r=c(this.parent.getColumns());try{for(r.s();!(n=r.n()).done;){var s=n.value;e.push(this.generateCell(s))}}catch(a){r.e(a)}finally{r.f()}return"Right"===this.parent.getFrozenMode()&&e.push(this.generateCell({},K.RowDragHIcon)),e}},{key:"generateCell",value:function(e,t){var i={visible:e.visible,isDataCell:!1,rowId:"",column:e,cellType:t||K.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new Q(i)}},{key:"updateModel",value:function(){var e=this.parent.getColumnByField(this.fieldName);this.filterObjIndex=this.getFilteredColsIndexByField(e),this.prevFilterObject=this.filterSettings.columns[this.filterObjIndex];for(var t=Array.isArray(this.value)?this.value:[this.value],i=0,n=t.length;i<n;i++){var r=e.isForeignColumn()?e.foreignKeyValue:this.fieldName;this.currentFilterObject={field:r,uid:e.uid,isForeignKey:e.isForeignColumn(),operator:this.operator,value:t[i],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}};var s=this.getFilteredColsIndexByField(e);s>-1&&!Array.isArray(this.value)?this.filterSettings.columns[s]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject)}this.filterSettings.columns=this.filterSettings.columns,this.parent.dataBind()}},{key:"getFilteredColsIndexByField",value:function(e){for(var t=this.filterSettings.columns,i=0,n=t.length;i<n;i++)if(t[i].uid===e.uid||e.isForeignColumn()&&this.parent.getColumnByUid(e.uid).field===e.foreignKeyValue)return i;return-1}},{key:"onActionComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null);var t=this.isRemove?{requestType:"filtering",type:E}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:Object(m.X)(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:E};this.parent.trigger(E,Object(m.K)(e,t)),this.isRemove=!1}},{key:"wireEvents",value:function(){m.l.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)}},{key:"unWireEvents",value:function(){m.l.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())}},{key:"initialEnd",value:function(){if(this.parent.off(A,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.initialLoad=!0;var t,i=c(e.filterSettings.columns);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.filterByColumn(n.field,n.operator,n.value,n.predicate,n.matchCase,n.ignoreAccent,n.actualFilterValue,n.actualOperator)}}catch(r){i.e(r)}finally{i.f()}this.initialLoad=!1,this.updateFilterMsg(),this.contentRefresh=!0}}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(z,this.enableAfterRender,this),this.parent.on("filtering-complete",this.onActionComplete,this),this.parent.on(B,this.onPropertyChanged,this),this.parent.on(V,this.keyUpHandler,this),this.parent.on("column-position-changed",this.columnPositionChanged,this),this.parent.on(q,this.render,this),this.parent.on(A,this.initialEnd,this),this.parent.on("filter-menu-close",this.filterMenuClose,this),m.l.add(document,"click",this.clickHandler,this),this.parent.on("filterOpen",this.columnMenuFilter,this),this.parent.on(H,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on("close-filter-dialog",this.clickHandler,this))}},{key:"removeEventListener",value:function(){m.l.remove(document,"click",this.clickHandler),this.parent.isDestroyed||(this.parent.off(z,this.enableAfterRender),this.parent.off("filtering-complete",this.onActionComplete),this.parent.off(B,this.onPropertyChanged),this.parent.off(V,this.keyUpHandler),this.parent.off("column-position-changed",this.columnPositionChanged),this.parent.off(q,this.render),this.parent.off("filterOpen",this.columnMenuFilter),this.parent.off("filter-menu-close",this.filterMenuClose),this.parent.off(H,this.filterIconClickHandler),this.parent.off("close-filter-dialog",this.clickHandler))}},{key:"filterMenuClose",value:function(e){this.fltrDlgDetails.isOpen=!1}},{key:"filterByColumn",value:function(e,t,i,n,r,s,a,l){var o,h=this,c=this.parent;if(this.column=c.grabColumnByFieldFromAllCols(e),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(t=this.getOperatorName(e)),this.column)if("FilterBar"===this.filterSettings.type&&(o=c.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),Object(m.X)(this.column.allowFiltering)||this.column.allowFiltering)if(oi(c))c.notify(G,{instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:n,arg5:r,arg6:s,arg7:a,arg8:l});else{if(this.predicate=n||(Array.isArray(i)?"or":"and"),this.value=i,this.matchCase=r||!1,this.ignoreAccent=this.ignoreAccent=Object(m.X)(s)?this.parent.filterSettings.ignoreAccent:s,this.fieldName=e,this.operator=t,i=!Object(m.X)(i)&&i.toString(),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),c.getColumnHeaderByField(e).setAttribute("aria-filtered","true"),o&&"FilterBar"===this.filterSettings.type){if(i.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,i))return this.filterStatusMsg=i.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();o.value!==i&&(o.value=i)}Object(m.X)(this.column.format)?this.values[this.column.field]=i:(this.applyColumnFormat(i),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(o.value=this.values[this.column.field]));var u={field:this.fieldName,predicate:n,matchCase:r,ignoreAccent:s,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter((function(e){return e.field===h.fieldName})).length>1&&!Object(m.X)(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(u):this.actualPredicate[this.fieldName]=[u],this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText})}},{key:"applyColumnFormat",value:function(e){var t="date"===this.column.type||"datetime"===this.column.type?new Date(e):parseFloat(e);this.values[this.column.field]=this.setFormatForFlColumn(t,this.column)}},{key:"skipUid",value:function(e){for(var t=!0,i=Object.keys(e),n=0;n<i.length;n++){var r=Object.keys(e[i[n]]);1===r.length&&"uid"===r[0]&&(t=!1)}return t}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName())for(var t=0,i=Object.keys(e.properties);t<i.length;t++){var n=i[t];switch(n){case"columns":var r={currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:D,cancel:!1};if(this.contentRefresh&&this.skipUid(e.properties.columns)){if(this.parent.notify(P,r),r.cancel)return void(Object(m.X)(this.prevFilterObject)?this.filterSettings.columns.splice(this.filterSettings.columns.length-1,1):this.filterSettings.columns[this.filterObjIndex]=this.prevFilterObject);this.addFilteredClass(r.currentFilteringColumn),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter()}break;case"showFilterBarStatus":e.properties[n]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader(),this.refreshFilterSettings()}}}},{key:"refreshFilterSettings",value:function(){if("FilterBar"===this.filterSettings.type){for(var e=0;e<this.filterSettings.columns.length;e++){this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[e].uid);var t=this.filterSettings.columns[e].value;t=!Object(m.X)(t)&&t.toString(),Object(m.X)(this.column.format)?this.values[this.filterSettings.columns[e].field]=this.filterSettings.columns[e].value:this.applyColumnFormat(t);var i=this.getFilterBarElement(this.column.field);i&&(i.value=""===this.cellText[this.filterSettings.columns[e].field]||Object(m.X)(this.cellText[this.filterSettings.columns[e].field])?this.filterSettings.columns[e].value:this.cellText[this.column.field])}if(0===this.filterSettings.columns.length)for(var n=this.parent.getColumns(),r=0;r<n.length;r++){var s=this.getFilterBarElement(n[r].field);s&&""!==s.value&&(s.value="",delete this.values[n[r].field])}}}},{key:"getFilterBarElement",value:function(e){var t,i="[id='"+e+"_filterBarcell']";return i&&!Object(m.X)(this.element)&&(t=this.element.querySelector(i)),t}},{key:"refreshFilter",value:function(){this.refreshFilterSettings(),this.updateFilterMsg()}},{key:"clearFiltering",value:function(e){var t=this,i=Kt(this.filterSettings.columns);if(!Object(m.X)(e))return this.refresh=!1,e.forEach((function(e){t.removeFilteredColsByField(e,!1)})),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(oi(this.parent))this.parent.notify(G,{instance:this,handler:this.clearFiltering});else{for(var n=0;n<i.length;n++)i[n].uid=i[n].uid||this.parent.getColumnByField(i[n].field).uid;var r=i.map((function(e){return e.uid})),s=r.filter((function(e,t){return r.indexOf(e)===t}));this.refresh=!1;for(var a=0,l=s.length;a<l;a++)this.removeFilteredColsByField(this.parent.getColumnByUid(s[a]).field,!1);if(Object(m.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.refresh=!0,s.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(var o=[].slice.call(this.parent.element.querySelectorAll(".e-filtered")),h=0,c=o.length;h<c;h++)o[0].removeAttribute("aria-filtered"),o[0].classList.remove("e-filtered");this.isRemove=!0,this.filterStatusMsg="",this.updateFilterMsg()}}},{key:"checkAlreadyColFiltered",value:function(e){var t,i=c(this.filterSettings.columns);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.field===e&&n.value===this.value&&n.operator===this.operator&&n.predicate===this.predicate)return!0}}catch(r){i.e(r)}finally{i.f()}return!1}},{key:"columnMenuFilter",value:function(e){this.column=e.col;var t=Object(m.C)(e.target,"#"+e.id);e.isClose&&!t?this.filterModule.closeDialog():t&&this.filterDialogOpen(this.column,e.target)}},{key:"filterDialogOpen",value:function(e,t,i,n){var r=this.parent;this.filterModule&&this.filterModule.closeDialog(),this.filterModule=new this.type[e.filter.type||this.parent.filterSettings.type](this.parent,r.filterSettings,this.serviceLocator,this.customOperators,this);var s=e.filter.dataSource||r.dataSource&&"result"in r.dataSource?r.dataSource:r.getDataModule().dataManager;this.filterModule.openDialog({type:e.type,field:e.field,displayName:e.headerText,dataSource:s,format:e.format,height:800,columns:r.getColumns(),filteredColumns:r.filterSettings.columns,target:t,dataManager:r.getDataModule().dataManager,formatFn:e.getFormatter(),ignoreAccent:r.filterSettings.ignoreAccent,parserFn:e.getParser(),query:r.query,template:e.getFilterItemTemplate(),hideSearchbox:!Object(m.X)(e.filter.hideSearchbox)&&e.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:r.getLocaleConstants(),position:{X:i,Y:n},column:e,foreignKeyValue:e.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:r.localeObj,isRemote:r.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity})}},{key:"removeFilteredColsByField",value:function(e,t){var i,n=this,r=this.filterSettings.columns;if(oi(this.parent))this.parent.notify(G,{instance:this,handler:this.removeFilteredColsByField,arg1:e,arg2:t});else{for(var s=r.map((function(e){return e.uid})),a=s.filter((function(e,t){return s.indexOf(e)===t})),l=function(s,l){r[l].uid=r[l].uid||n.parent.getColumnByField(r[l].field).uid;s=r.length;var o=n.parent.grabColumnByUidFromAllCols(a[l]);if(o.field===e||o.field===o.foreignKeyValue&&o.isForeignColumn()){var h=n.filterSettings.columns.filter((function(e){return e.uid===o.uid}))[0];if("FilterBar"===n.filterSettings.type&&!t){var c="[id='"+o.field+"_filterBarcell']";(i=n.parent.getHeaderContent().querySelector(c))&&(i.value="",delete n.values[e])}for(;s--;)r[s].uid===o.uid&&r.splice(s,1);var u=n.parent.getColumnHeaderByField(o.field);return u.removeAttribute("aria-filtered"),"FilterBar"!==n.filterSettings.type&&u.querySelector(n.parent.showColumnMenu?".e-columnmenu":".e-icon-filter").classList.remove("e-filtered"),n.isRemove=!0,n.actualPredicate[e]&&delete n.actualPredicate[e],n.values[e]&&delete n.values[e],n.refresh&&(Object(m.W)()&&!n.parent.isJsComponent?(n.parent.setProperties({filterSettings:{columns:n.filterSettings.columns}},!0),n.parent.notify(P,{requestType:"filtering",type:D,currentFilterObject:{field:o.field,operator:n.operator,value:n.value,predicate:n.predicate,matchCase:n.matchCase,ignoreAccent:n.ignoreAccent,actualFilterValue:{},actualOperator:{}},currentFilterColumn:o})):n.parent.notify(P,{requestType:"filtering",type:D,currentFilterObject:h,currentFilterColumn:o,action:"clearFilter"})),"break"}},o=0,h=a.length;o<h;o++){if("break"===l(h,o))break}this.updateFilterMsg()}}},{key:"getModuleName",value:function(){return"filter"}},{key:"keyUpHandlerImmediate",value:function(e){13!==e.keyCode&&this.keyUpHandler(e)}},{key:"keyUpHandler",value:function(e){var t=this.parent,i=e.target;if(i&&Object(m.cb)(i,".e-filterbar input")){var n=Object(m.C)(i,"th.e-filterbarcell");if(this.column=t.getColumnByUid(n.getAttribute("e-mappinguid")),!this.column)return;if("altDownArrow"===e.action&&this.parent.filterSettings.showFilterBarOperator){var r=Object(m.C)(i,"span").querySelector(".e-filterbaroperator");r.ej2_instances[0].showPopup(),r.focus()}"Immediate"!==this.filterSettings.mode&&(13!==e.keyCode||e.target.classList.contains("e-filterbaroperator"))||9===e.keyCode||(this.value=i.value.trim(),this.processFilter(e))}if("altDownArrow"===e.action&&"FilterBar"!==this.filterSettings.type){var s=t.focusModule.currentInfo.element;if(s&&s.classList.contains("e-headercell")){var a=t.getColumnByUid(s.firstElementChild.getAttribute("e-mappinguid"));this.openMenuByField(a.field),this.parent.focusModule.clearIndicator()}}"escape"===e.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),t.notify("restore-Focus",{}))}},{key:"updateCrossIcon",value:function(e){e.value.length&&e.nextElementSibling.classList.remove("e-hide")}},{key:"updateFilterMsg",value:function(){if("FilterBar"===this.filterSettings.type){var e,t,i=this.parent,n=this.filterSettings.columns;if(this.serviceLocator.getService("valueFormatter"),!this.filterSettings.showFilterBarStatus)return;if(n.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage")){this.filterStatusMsg="";for(var r=0;r<n.length;r++)if(t=i.grabColumnByUidFromAllCols(n[r].uid)||i.grabColumnByFieldFromAllCols(n[r].field),r&&(this.filterStatusMsg+=" && "),Object(m.X)(t.format))this.filterStatusMsg+=t.headerText+": "+this.values[t.field];else{var s="date"===t.type||"datetime"===t.type?this.valueFormatter.fromView(this.values[t.field],t.getParser(),t.type):this.values[t.field];e="date"!==t.type&&"datetime"!==t.type?this.serviceLocator.getService("valueFormatter").toView(s,t.getParser()).toString():this.setFormatForFlColumn(s,t),this.filterStatusMsg+=t.headerText+": "+e}}i.allowPaging&&i.updateExternalMessage(this.filterStatusMsg),this.filterStatusMsg=""}}},{key:"setFormatForFlColumn",value:function(e,t){return this.serviceLocator.getService("valueFormatter").toView(e,t.getFormatter()).toString()}},{key:"checkForSkipInput",value:function(e,t){var i;if("number"===e.type)(v.b.operatorSymbols[t]||this.skipNumberInput.indexOf(t)>-1)&&(i=!0);else if("string"===e.type){var n,r=c(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.skipStringInput.indexOf(s)>-1&&(i=!0)}}catch(a){r.e(a)}finally{r.f()}}return i}},{key:"processFilter",value:function(e){this.stopTimer(),this.startTimer(e)}},{key:"startTimer",value:function(e){var t=this;this.timer=window.setInterval((function(){t.onTimerTick()}),13===e.keyCode?0:this.filterSettings.immediateModeDelay)}},{key:"stopTimer",value:function(){window.clearInterval(this.timer)}},{key:"onTimerTick",value:function(){var e,t="[id='"+this.column.field+"_filterBarcell']",i=this.element.querySelector(t);if(!i&&this.parent.isFrozenGrid()&&(i=this.parent.getHeaderContent().querySelector(t)),this.cellText[this.column.field]=i.value,this.stopTimer(),Object(m.X)(this.column.filterBarTemplate))e=JSON.parse(JSON.stringify(i.value));else{var n=this.column.filterBarTemplate.read;"string"==typeof n&&(n=Object(m.V)(n,window)),Object(m.X)(n)||(this.value=n.call(this,i))}Object(m.X)(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,i.value=e,this.updateFilterMsg())}},{key:"validateFilterValue",value:function(e){var t,i;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal,t=[">","<","=","!"];for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1){i=n;break}this.getOperator(e.substring(i)),0!==i&&(this.value=e.substring(0,i)),""!==this.value&&e.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type)),isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal,""===this.value||this.value instanceof Date||(this.getOperator(e),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),Object(m.X)(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1,"*"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(e.length-1)?(this.value=this.value.slice(0,-1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.endsWith):this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.startsWith;break;case"boolean":"true"===e.toLowerCase()||"1"===e?this.value=!0:"false"===e.toLowerCase()||"0"===e?this.value=!1:e.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")),this.operator=this.filterOperators.equal;break;default:this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal}}},{key:"getOperator",value:function(e){var t=e.charAt(0),i=e.slice(0,2),n=Object(m.K)({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},v.b.operatorSymbols);(n.hasOwnProperty(t)||n.hasOwnProperty(i))&&(this.operator=n[t],this.value=e.substring(1),this.operator||(this.operator=n[i],this.value=e.substring(2))),this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))}},{key:"columnPositionChanged",value:function(e){}},{key:"getLocalizedCustomOperators",value:function(){var e=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}],numberOperator:e,dateOperator:e,datetimeOperator:e,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}}},{key:"openMenuByField",value:function(e){var t=this.parent,i=t.getColumnByField(e),n=t.getColumnHeaderByField(e).querySelector(".e-filtermenudiv");if(n){var r=t.element.getBoundingClientRect(),s=n.getBoundingClientRect();this.filterDialogOpen(i,n,s.right-r.left,s.bottom-r.top)}}},{key:"filterIconClickHandler",value:function(e){var t=e.target;if(t.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){var i=this.parent.getColumnByUid(Wt(t,"e-headercell").firstElementChild.getAttribute("e-mappinguid"));if(this.column=i,this.fltrDlgDetails.field===i.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog(),this.fltrDlgDetails={field:i.field,isOpen:!0},this.openMenuByField(i.field)}}},{key:"clickHandler",value:function(e){if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(Wt(e.target,"e-filterbarcell")&&e.target.classList.contains("e-input-group-icon")&&Object(m.C)(e.target,"div").querySelector(".e-filterbaroperator").focus(),e.target.classList.contains("e-list-item"))){var t=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup","");-1!==t.indexOf("grid-column")&&Object(m.C)(document.getElementById(t),"div").querySelector(".e-filtertext").focus()}if("Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){var i=e.target,n=i.classList.contains("e-day"),r=Wt(this.parent.element,"e-dialog"),s=!1,a=Wt(i,"e-popup"),l=this.parent.element.querySelector(".e-filter-popup");if(r&&a&&(s=r.id===a.id),l&&(Wt(i,"e-excel-ascending")||Wt(i,"e-excel-descending"))&&this.filterModule.closeDialog(i),Wt(i,"e-filter-popup")||i.classList.contains("e-filtermenudiv"))return;!this.filterModule||Wt(i,"e-popup-wrapper")||Object(m.C)(i,".e-filter-item.e-menu-item")||n||(s&&!Wt(i,"e-filter-popup")&&!Wt(i,"e-popup-flmenu")||!a&&l)&&(this.filterModule.isresetFocus=Wt(i,"e-grid")&&Wt(i,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(i)),"Immediate"===this.filterSettings.mode&&i.classList.contains("e-clear-icon")&&this.removeFilteredColsByField(i.previousElementSibling.id.slice(0,-14))}}},{key:"filterHandler",value:function(e){var t;this.actualPredicate[e.field]=e.actualPredicate;for(var i=new v.a(this.filterSettings.columns),n=(new v.g).where("field",this.filterOperators.equal,e.field),r=i.executeLocal(n),s=0;s<r.length;s++){for(var a=-1,l=0;l<this.filterSettings.columns.length;l++)if(r[s].field===this.filterSettings.columns[l].field){a=l;break}-1!==a&&this.filterSettings.columns.splice(a,1)}"clear-filter"===e.action&&Object(m.W)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.values[e.field]&&delete this.values[e.field];var o=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";t=this.parent.getColumnHeaderByField(e.field).querySelector(o),"filtering"===e.action?(this.filterSettings.columns=this.filterSettings.columns.concat(e.filterCollection),this.filterSettings.columns.length&&t&&t.classList.add("e-filtered")):(t&&t.classList.remove("e-filtered"),e.requestType="filtering",this.parent.renderModule.refresh(e)),this.parent.dataBind()}},{key:"updateFilter",value:function(){var e=this.filterSettings.columns;this.actualPredicate={};for(var t=0;t<e.length;t++){this.column=this.parent.getColumnByField(e[t].field)||Ci(e[t].field,this.parent.getForeignKeyColumns());var i=e[t].field;this.parent.getColumnByField(e[t].field)||(i=Ci(e[t].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(i,e[t].operator,e[t].value,e[t].type,e[t].predicate,e[t].matchCase,e[t].ignoreAccent,e[t].uid)}}},{key:"refreshFilterIcon",value:function(e,t,i,n,r,s,a,l){var o;o={field:e,predicate:r,matchCase:s,ignoreAccent:a,operator:t,value:i,type:n},this.actualPredicate[e]?this.actualPredicate[e].push(o):this.actualPredicate[e]=[o];var h=l?this.parent.grabColumnByUidFromAllCols(l).field:e;this.addFilteredClass(h)}},{key:"addFilteredClass",value:function(e){var t;this.parent.showColumnMenu?t=this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu"):this.parent.getColumnByField(e)&&(t=this.parent.getColumnHeaderByField(e).querySelector(".e-icon-filter")),t&&t.classList.add("e-filtered")}},{key:"getFilterUIInfo",value:function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}}},{key:"getOperatorName",value:function(e){return document.getElementById(this.parent.getColumnByField(e).uid).ej2_instances[0].value}}]),e}(),On=function(){function e(t){p(this,e),this.tapped=!1,this.isDblClk=!0,this.parent=t,this.parent.isDestroyed||(this.widthService=new We(t),this.addEventListener())}return f(e,[{key:"autoFitColumns",value:function(e){var t=null==e||e.length<=0?this.parent.getColumns().map((function(e){return e.field})):"string"==typeof e?[e]:e;this.findColumn(t)}},{key:"autoFit",value:function(){var e=this.parent.getColumns().filter((function(e){return!0===e.autoFit})).map((function(e){return e.field||e.headerText}));e.length>0&&this.autoFitColumns(e),"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()}},{key:"resizeColumn",value:function(e,t,i){var n,r,s,a,l,o,h=this.parent,c=0,u=0,d=i||this.parent.getUidByColumnField(e),p=this.parent.getNormalizedColumnIndex(d),g=this.parent.getColumnIndexByField(e),f=h.getFrozenColumns()||h.getFrozenLeftColumnsCount(),v=h.getMovableColumnsCount();if(Object(m.X)(h.getFooterContent())||(s=h.getFooterContentTable()),h.isFrozenGrid()){var b=h.getColumnByField(e);"frozen-left"===b.getFreezeTableName()?(n=h.getHeaderTable(),r=h.getContentTable(),a=n.querySelector('[e-mappinguid="'+d+'"]').parentElement.cloneNode(!0),l=r.querySelectorAll("td:nth-child(".concat(p+1,")")),s&&(o=s.querySelectorAll("td:nth-child(".concat(p+1,")")))):"movable"===b.getFreezeTableName()?(n=h.getHeaderContent().querySelector(".e-movableheader").children[0],r=h.getContent().querySelector(".e-movablecontent").children[0],a=n.querySelector('[e-mappinguid="'+d+'"]').parentElement.cloneNode(!0),l=r.querySelectorAll("td:nth-child(".concat(p-f+1,")")),s&&(o=(s=h.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child(".concat(p-f+1,")")))):"frozen-right"===b.getFreezeTableName()&&(n=h.getHeaderContent().querySelector(".e-frozen-right-header").children[0],r=h.getContent().querySelector(".e-frozen-right-content").children[0],a=n.querySelector('[e-mappinguid="'+d+'"]').parentElement.cloneNode(!0),l=r.querySelectorAll("td:nth-child(".concat(p-(f+v)+1,")")),s&&(o=(s=h.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child(".concat(p-(f+v)+1,")"))))}else n=h.getHeaderTable(),r=h.getContentTable(),a=n.querySelector('[e-mappinguid="'+d+'"]').parentElement.cloneNode(!0),l=r.querySelectorAll("td:nth-child(".concat(p+1,"):not(.e-groupcaption)")),s&&(o=s.querySelectorAll("td:nth-child(".concat(p+1,"):not(.e-groupcaption)")));var y=n.querySelector("tr").querySelectorAll(".e-grouptopleftcell");if(y.length>0)for(var C=0;C<y.length;C++)u+=y[C].offsetWidth;var w=r.querySelector(".e-detailrowcollapse")||r.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&w&&(u+=w.offsetWidth);var k=[a],S=[],O=[];if(s)for(var x=0;x<o.length;x++)O[x]=o[x].cloneNode(!0);for(var j=0;j<l.length;j++)S[j]=l[j].cloneNode(!0);var D=this.createTable(n,k,"e-gridheader"),E=this.createTable(r,S,"e-gridcontent"),I=null;O.length&&(I=this.createTable(s,O,"e-gridfooter"));var M=h.getColumns()[g],F=M.width=Object(m.L)(Math.max(D,E,I)),T=M.maxWidth&&parseFloat(M.maxWidth.toString());if(parseInt(F,10)>T&&(M.width=T),this.widthService.setColumnWidth(h.getColumns()[g]),!1===h.getColumns().some((function(e){return null==e.width||e.width.length<=0})))for(var A=h.getColumns(),z=0;z<A.length;z++)A[z].visible&&(c+=parseFloat(A[z].width));var L=c+u;c>0&&!h.isFrozenGrid()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new R({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(L="100%"),n.style.width=Object(m.L)(L),r.style.width=Object(m.L)(L),Object(m.X)(s)||(s.style.width=Object(m.L)(L)));var B=n.offsetWidth;h.getContent().scrollWidth>B?(n.classList.add("e-tableborder"),r.classList.add("e-tableborder")):(n.classList.remove("e-tableborder"),r.classList.remove("e-tableborder")),Object(m.X)(s)||s.classList.add("e-tableborder")}},{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())}},{key:"getModuleName",value:function(){return"resize"}},{key:"findColumn",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this.parent.getColumnIndexByField(i),r=this.parent.getColumns()[n];n>-1&&!Object(m.X)(r)&&!0===r.visible&&this.resizeColumn(i,n)}}},{key:"createTable",value:function(e,t,i){var n=this.parent.createElement("div");n.className=this.parent.element.className,n.style.cssText="display: inline-block;visibility:hidden;position:absolute";var r=this.parent.createElement("div");r.className=i;var s=this.parent.createElement("table");s.className=e.className,s.classList.add("e-resizetable"),s.style.cssText="table-layout: auto;width: auto";for(var a=this.parent.createElement("tr"),l=0;l<t.length;l++){var o=a.cloneNode();o.className=e.querySelector("tr").className,o.appendChild(t[l]),s.appendChild(o)}r.appendChild(s),n.appendChild(r),document.body.appendChild(n);var h=s.getBoundingClientRect().width;return document.body.removeChild(n),Math.ceil(h)}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(q,this.refreshHeight,this),this.parent.on(F,this.wireEvents,this),this.parent.on(A,this.autoFit,this),this.parent.on("refreshResizeHandlers",this.refreshHeight,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(q,this.refreshHeight),this.parent.off(F,this.wireEvents),this.parent.off("refreshResizeHandlers",this.refreshHeight))}},{key:"render",value:function(){this.unwireEvents(),this.wireEvents(),this.setHandlerHeight()}},{key:"refreshHeight",value:function(){for(var e=this.getResizeHandlers(),t=0;t<e.length;t++)e[t].parentElement.offsetHeight>0&&(e[t].style.height=e[t].parentElement.offsetHeight+"px");this.setHandlerHeight()}},{key:"wireEvents",value:function(){m.l.add(this.parent.getHeaderContent(),m.d.touchStartEvent,this.touchResizeStart,this),m.l.add(this.parent.getHeaderContent(),"dblclick",this.callAutoFit,this)}},{key:"unwireEvents",value:function(){m.l.remove(this.parent.getHeaderContent(),m.d.touchStartEvent,this.touchResizeStart),m.l.remove(this.parent.getHeaderContent(),"dblclick",this.callAutoFit)}},{key:"getResizeHandlers",value:function(){return this.parent.isFrozenGrid()?[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")):[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-rhandler"))}},{key:"setHandlerHeight",value:function(){for(var e=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-rsuppress")),t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"}},{key:"callAutoFit",value:function(e){if(e.target.classList.contains("e-rhandler")){var t=this.getTargetColumn(e);if(t.columns)return;this.resizeColumn(t.field,this.parent.getNormalizedColumnIndex(t.uid),t.uid),Object(m.C)(e.target,"th.e-headercell").classList.add("e-resized")}}},{key:"touchResizeStart",value:function(e){if(!ti.timer)return ti.timer=setTimeout((function(){ti.timer=null}),300),this.resizeStart(e);clearTimeout(ti.timer),ti.timer=null,this.callAutoFit(e)}},{key:"resizeStart",value:function(e){var t=this;if(e.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.parent.allowGrouping)for(var i=0;i<this.parent.groupSettings.columns.length;i++)this.widthService.setColumnWidth(new R({width:"30px"}),i);var n,r=c(this.refreshColumnWidth());try{for(r.s();!(n=r.n()).done;){var s=n.value;this.widthService.setColumnWidth(s)}}catch(v){r.e(v)}finally{r.f()}this.widthService.setWidthToTable()}if(this.refreshStackedColumnWidth(),this.element=e.target,this.parent.getVisibleFrozenColumns()){var a=this.parent.getMovableContentTbody(),l=this.parent.getFrozenLeftContentTbody(),o=this.parent.getFrozenRightContentTbody(),h=[].slice.call(a.querySelectorAll("tr")),u=[].slice.call(l.querySelectorAll("tr")),d=[];"Left-Right"===this.parent.getFrozenMode()&&o&&(d=[].slice.call(o.querySelectorAll("tr")));for(var p=function(e){Xi(t.parent,(function(i,n){t.parent.rowHeight?n[e].style.height=t.parent.rowHeight+"px":n[e].style.removeProperty("height")}),[u,h,d])},g=0;g<h.length;g++)p(g)}this.parentElementWidth=this.parent.element.getBoundingClientRect().width,this.appendHelper(),this.column=this.getTargetColumn(e),this.pageX=this.getPointX(e),this.minMove="frozen-right"===this.column.getFreezeTableName()?this.parent.enableRtl?(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(Object(m.X)(this.column.width)?"":this.column.width.toString()):parseFloat(Object(m.X)(this.column.width)?"":this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.parent.enableRtl?parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(Object(m.X)(this.column.width)?"":this.column.width.toString()),this.minMove+=this.pageX}var f;if(m.d.isDevice&&!this.helper.classList.contains("e-ricon"))this.helper.classList.add("e-ricon"),m.l.add(document,m.d.touchStartEvent,this.removeHelper,this),m.l.add(this.helper,m.d.touchStartEvent,this.resizeStart,this);else f=!Object(m.W)()||this.parent.isJsComponent?{e:e,column:this.column}:{column:Object(m.K)({},this.column)},this.parent.trigger("resizeStart",f,(function(e){e.cancel||t.parent.isEdit?t.cancelResizeAction():(m.l.add(document,m.d.touchEndEvent,t.resizeEnd,t),m.l.add(t.parent.element,m.d.touchMoveEvent,t.resizing,t),t.updateCursor("add"))}))}}},{key:"cancelResizeAction",value:function(e){e&&(m.l.remove(this.parent.element,m.d.touchMoveEvent,this.resizing),m.l.remove(document,m.d.touchEndEvent,this.resizeEnd),this.updateCursor("remove")),m.d.isDevice&&(m.l.remove(document,m.d.touchStartEvent,this.removeHelper),m.l.remove(this.helper,m.d.touchStartEvent,this.resizeStart)),Object(m.I)(this.helper),this.refresh()}},{key:"getWidth",value:function(e,t,i){return t&&e<t?t:i&&e>i?i:e}},{key:"updateResizeEleHeight",value:function(){for(var e=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")),t=0;t<e.length;t++)e[t].style.height=this.element.parentElement.offsetHeight+"px"}},{key:"getColData",value:function(e,t){return{width:parseFloat(Object(m.X)(this.widthService.getWidth(e))||"auto"===this.widthService.getWidth(e)?"0":this.widthService.getWidth(e).toString())+t,minWidth:e.minWidth?parseFloat(e.minWidth.toString()):null,maxWidth:e.maxWidth?parseFloat(e.maxWidth.toString()):null}}},{key:"resizing",value:function(e){if(!Object(m.X)(this.column)){var t=0;Object(m.X)(this.column)&&(t=Wt(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight());var i=this.getPointX(e),n=this.parent.enableRtl?-(i-this.pageX):i-this.pageX;"frozen-right"===this.column.getFreezeTableName()&&(n=this.parent.enableRtl?i-this.pageX:this.pageX-i);var r=this.getColData(this.column,n);r.width||(r.width=Object(m.C)(this.element,"th").offsetWidth);var s=this.getWidth(r.width,r.minWidth,r.maxWidth);if(this.parent.log("resize_min_max",{column:this.column,width:s}),"frozen-right"===this.column.getFreezeTableName()&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i)&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),("frozen-right"!==this.column.getFreezeTableName()&&(!this.parent.enableRtl&&this.minMove>=i||this.parent.enableRtl&&this.minMove<=i)||"frozen-right"===this.column.getFreezeTableName()&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i))&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),s!==parseFloat(Object(m.X)(this.column.width)||"auto"===this.column.width?t.toString():this.column.width.toString())){this.pageX=i,this.column.width=Object(m.L)(s);var a={e:e,column:this.column};if(this.parent.trigger("resizing",a),a.cancel)return void this.cancelResizeAction(!0);var l=[this.column],o=[this.column];this.column.columns&&(l=this.getSubColumns(this.column,[]),l=this.calulateColumnsWidth(l,!1,n),o=this.calulateColumnsWidth(l,!0,n));var h,u=c(o);try{for(u.s();!(h=u.n()).done;){var d=h.value;this.widthService.setColumnWidth(d,null,"resize")}}catch(p){u.e(p)}finally{u.f()}this.updateHelper()}this.isDblClk=!1}}},{key:"calulateColumnsWidth",value:function(e,t,i){var n,r=[],s=c(e);try{for(s.s();!(n=s.n()).done;){for(var a=n.value,l=0,o=0;o<e.length;o++)l+=parseFloat(e[o].width.toString());var h=this.getColData(a,parseFloat(a.width)*i/l),u=this.getWidth(h.width,h.minWidth,h.maxWidth);u!==parseFloat(a.width.toString())&&(t&&(a.width=Object(m.L)(u<1?1:u)),r.push(a))}}catch(d){s.e(d)}finally{s.f()}return r}},{key:"getSubColumns",value:function(e,t){var i,n=c(e.columns);try{for(n.s();!(i=n.n()).done;){var r=i.value;!1!==r.visible&&r.allowResizing&&(r.columns?this.getSubColumns(r,t):t.push(r))}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"resizeEnd",value:function(e){if(this.helper&&!this.parent.isDestroyed){var t;m.l.remove(this.parent.element,m.d.touchMoveEvent,this.resizing),m.l.remove(document,m.d.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),Object(m.I)(this.helper),t=!Object(m.W)()||this.parent.isJsComponent?{e:e,column:this.column}:{column:Object(m.K)({},this.column)};var i=this.parent.getContent().querySelector(".e-content"),n=i.querySelector(".e-movablecontent")?i.querySelector(".e-movablecontent"):i;n.scrollHeight>n.clientHeight&&(this.parent.scrollModule.setPadding(),n.style.overflowY="scroll"),this.parent.trigger("resizeStop",t),Object(m.C)(this.element,".e-headercell").classList.add("e-resized"),this.isFrozenColResized=!!Wt(this.element,"e-frozenheader"),this.parent.isFrozenGrid()&&this.parent.notify("freezerender",{case:"textwrap"}),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify("textWrapRefresh",{case:"textwrap"})),this.refresh(),this.doubleTapEvent(e),this.isDblClk=!0}}},{key:"getPointX",value:function(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX}},{key:"refreshColumnWidth",value:function(){var e,t=this.parent.getColumns(),i=c([].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell")));try{for(i.s();!(e=i.n()).done;){var n,r=e.value,s=c(t);try{for(s.s();!(n=s.n()).done;){var a=n.value;if(r.querySelector("[e-mappinguid]")&&r.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===a.uid&&a.visible){a.width=r.getBoundingClientRect().width;break}}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return t}},{key:"refreshStackedColumnWidth",value:function(){var e,t=c(this.parent.getStackedColumns(this.parent.columns));try{for(t.s();!(e=t.n()).done;){var i=e.value;i.width=this.getStackedWidth(i,0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"getStackedWidth",value:function(e,t){var i,n=c(e.columns);try{for(n.s();!(i=n.n()).done;){var r=i.value;!1!==r.visible&&(r.columns?this.getStackedWidth(r,t):t+=r.width)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"getTargetColumn",value:function(e){var t=Object(m.C)(e.target,"th.e-headercell"),i=(t=t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}},{key:"updateCursor",value:function(e){var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th"));t.push(this.parent.element);var i,n=c(t);try{for(n.s();!(i=n.n()).done;){i.value.classList[e]("e-rcursor")}}catch(r){n.e(r)}finally{n.f()}}},{key:"refresh",value:function(){this.column=null,this.pageX=null,this.element=null,this.helper=null}},{key:"appendHelper",value:function(){this.helper=this.parent.createElement("div",{className:"e-rhelper"}),this.parent.element.appendChild(this.helper),this.setHelperHeight()}},{key:"setHelperHeight",value:function(){var e=this.parent.isFrozenGrid(),t=e?this.parent.getContent().querySelector(".e-content").offsetHeight:this.parent.getContent().offsetHeight-this.getScrollBarWidth(),i=Object(m.C)(this.element,"th.e-headercell"),n=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),r=this.parent.getFrozenRightColumnsCount();e&&(n=Wt(i,"e-movableheader")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll("tr")):r&&Wt(i,"e-frozen-right-header")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelectorAll("tr")):[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelectorAll("tr")));for(var s=n.indexOf(i.parentElement);s<n.length&&s>-1;s++)t+=n[s].offsetHeight;var a=this.calcPos(i);Wt(i,"e-frozen-right-header")?a.left+=this.parent.enableRtl?i.offsetWidth-2:-1:a.left+=this.parent.enableRtl?-1:i.offsetWidth-2,this.helper.style.cssText="height: "+t+"px; top: "+a.top+"px; left:"+Math.floor(a.left)+"px;"}},{key:"getScrollBarWidth",value:function(e){var t=this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&e||t.scrollWidth>t.clientWidth?ni():0}},{key:"removeHelper",value:function(e){var t=e.target.classList;t.contains("e-rhandler")||t.contains("e-ricon")||!this.helper||(m.l.remove(document,m.d.touchStartEvent,this.removeHelper),m.l.remove(this.helper,m.d.touchStartEvent,this.resizeStart),Object(m.I)(this.helper),this.refresh())}},{key:"updateHelper",value:function(){var e,t=Object(m.C)(this.element,"th.e-headercell");if((e=Wt(t,"e-frozen-right-header")?Math.floor(this.calcPos(t).left+(this.parent.enableRtl?t.offsetWidth-2:-1)):Math.floor(this.calcPos(t).left+(this.parent.enableRtl?-1:t.offsetWidth-2)))>this.parentElementWidth&&(e=this.parentElementWidth-2),this.parent.isFrozenGrid()){var i=Object(m.C)(t,".e-table").offsetLeft;e<i&&(e=i)}this.helper.style.left=e+"px"}},{key:"calcPos",value:function(e){for(var t={top:0,left:0},i=e.getBoundingClientRect(),n=e.ownerDocument,r=Wt(e,"e-grid")||n.documentElement;r&&(r===n.body||r===n.documentElement)&&"static"===r.style.position;)r=r.parentNode;return r&&r!==e&&1===r.nodeType&&(t=r.getBoundingClientRect()),{top:i.top-t.top,left:i.left-t.left}}},{key:"doubleTapEvent",value:function(e){this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(e),this.tapped=null):this.tapped=setTimeout(this.timeoutHandler(),300))}},{key:"getUserAgent",value:function(){var e=m.d.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)}},{key:"timeoutHandler",value:function(){this.tapped=null}}]),e}(),xn=function(){function e(t,i,n,r){var s=this;p(this,e),this.sortRequired=!0,this.isAppliedGroup=!1,this.isAppliedUnGroup=!1,this.reorderingColumns=[],this.visualElement=Object(m.F)("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}}),this.helper=function(e){var t=s.parent,i=e.sender.target,n=i.classList.contains("e-groupheadercell")?i:Wt(i,"e-groupheadercell");return!(!n||!i.classList.contains("e-drag")&&s.groupSettings.allowReordering)&&(s.column=t.getColumnByField(n.firstElementChild.getAttribute("ej-mappingname")),s.visualElement.textContent=n.textContent,s.visualElement.style.width=n.offsetWidth+2+"px",s.visualElement.style.height=n.offsetHeight+2+"px",s.visualElement.setAttribute("e-mappinguid",s.column.uid),t.element.appendChild(s.visualElement),s.visualElement)},this.dragStart=function(e){s.parent.element.classList.add("e-ungroupdrag"),Object(m.W)()&&e.bindEvents(e.dragElement)},this.drag=function(e){s.groupSettings.allowReordering&&s.animateDropper(e);var t=e.target,i=s.parent.element.querySelector(".e-cloneproperties");s.parent.trigger("columnDrag",{target:t,draggableType:"headercell",column:s.column}),s.groupSettings.allowReordering||(Object(m.A)(i,["e-defaultcur"],["e-notallowedcur"]),Wt(t,"e-gridcontent")||Wt(t,"e-headercell")||Object(m.A)(i,["e-notallowedcur"],["e-defaultcur"]))},this.dragStop=function(e){s.parent.element.classList.remove("e-ungroupdrag");var t=!(Wt(e.target,"e-gridcontent")||Wt(e.target,"e-gridheader"));if(s.groupSettings.allowReordering&&t){if(Object(m.hb)(e.helper),Wt(e.target,"e-groupdroparea"))s.rearrangeGroup(e);else if(!Wt(e.target,"e-grid")){var i=s.parent.getColumnByUid(e.helper.getAttribute("e-mappinguid")).field;-1!==s.groupSettings.columns.indexOf(i)&&s.ungroupColumn(i)}}else t&&Object(m.hb)(e.helper)},this.animateDropper=function(e){var t=s.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),i=s.parent.getColumnByUid(t).field,n=Wt(e.target,"e-groupdroparea"),r=Wt(e.target,"e-group-animator"),a=[].slice.call(s.element.querySelectorAll(".e-groupheadercell")).map((function(e){return e.querySelector("div").getAttribute("ej-mappingname")})),l=JSON.parse(JSON.stringify(a));if(r||n){if(r){var o=r.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),h=+r.getAttribute("index");if(o!==i){var c=l.indexOf(i);-1!==c&&l.splice(c,1),l.splice(h+(-1!==h&&c===h?1:0),0,i)}}else n&&-1===l.indexOf(i)&&l.push(i);s.element.innerHTML="",l.length&&!s.element.classList.contains("e-grouped")&&s.element.classList.add("e-grouped"),s.reorderingColumns=l;for(var u=0;u<l.length;u++)s.addColToGroupDrop(l[u])}else s.addLabel(),s.removeColFromGroupDrop(i)},this.drop=function(e){var t=s.parent,i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));s.element.classList.remove("e-hover"),Object(m.hb)(e.droppedElement),s.aria.setDropTarget(s.parent.element.querySelector(".e-groupdroparea"),!1),s.aria.setGrabbed(s.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1),Object(m.X)(i)||!1===i.allowGrouping||Wt(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id")?s.parent.log("action_disabled_column",{moduleName:s.getModuleName(),columnName:i.headerText}):s.groupColumn(i.field)},this.contentRefresh=!0,this.aria=new le,this.parent=t,this.groupSettings=i,this.serviceLocator=r,this.sortedColumns=n,this.focus=r.getService("focus"),this.addEventListener(),this.groupGenerator=new ne(this.parent)}return f(e,[{key:"addLabel",value:function(){if(!this.element.querySelectorAll(".e-group-animator").length){var e=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=e,this.element.classList.remove("e-grouped")}}},{key:"rearrangeGroup",value:function(e){this.sortRequired=!1,this.updateModel()}},{key:"columnDrag",value:function(e){this.groupSettings.allowReordering&&this.animateDropper(e);var t=this.parent.element.querySelector(".e-cloneproperties");Object(m.A)(t,["e-defaultcur"],["e-notallowedcur"]),Wt(e.target,"e-groupdroparea")||this.parent.allowReordering&&Wt(e.target,"e-headercell")||Object(m.A)(t,["e-notallowedcur"],["e-defaultcur"]),e.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")}},{key:"columnDragStart",value:function(e){if(!e.target.classList.contains("e-stackedheadercell")){var t=this.parent.element.querySelector(".e-groupdroparea");this.aria.setDropTarget(t,e.column.allowGrouping);var i=e.target.classList.contains("e-headercell")?e.target:Wt(e.target,"e-headercell");this.aria.setGrabbed(i,!0,!e.column.allowGrouping)}}},{key:"columnDrop",value:function(e){var t=this.parent;if("grouping"===e.droppedElement.getAttribute("action")){var i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(Object(m.X)(i)||!1===i.allowGrouping||Wt(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id"))return;this.ungroupColumn(i.field)}}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(z,this.enableAfterRender,this),this.parent.on("grouping-complete",this.onActionComplete,this),this.parent.on("ungrouping-complete",this.onActionComplete,this),this.parent.on(B,this.onPropertyChanged,this),this.parent.on(H,this.clickHandler,this),this.parent.on("columnDrag",this.columnDrag,this),this.parent.on("columnDragStart",this.columnDragStart,this),this.parent.on("header-drop",this.columnDrop,this),this.parent.on("columnDrop",this.columnDrop,this),this.parent.on(q,this.refreshSortIcons,this),this.parent.on("sorting-complete",this.refreshSortIcons,this),this.parent.on(V,this.keyPressHandler,this),this.parent.on(A,this.initialEnd,this),this.parent.on(L,this.initialEnd,this),this.parent.on(F,this.render,this),this.parent.on("group-aggregates",this.onGroupAggregates,this),this.parent.on("blazor-action-begin",this.blazorActionBegin,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(F,this.render),this.parent.off(z,this.enableAfterRender),this.parent.off("grouping-complete",this.onActionComplete),this.parent.off("ungrouping-complete",this.onActionComplete),this.parent.off(B,this.onPropertyChanged),this.parent.off(H,this.clickHandler),this.parent.off("columnDrag",this.columnDrag),this.parent.off("columnDragStart",this.columnDragStart),this.parent.off("columnDrop",this.columnDrop),this.parent.off("header-drop",this.columnDrop),this.parent.off(q,this.refreshSortIcons),this.parent.off("sorting-complete",this.refreshSortIcons),this.parent.off(V,this.keyPressHandler),this.parent.off("group-aggregates",this.onGroupAggregates),this.parent.off("blazor-action-begin",this.blazorActionBegin),this.parent.off("group-expand-collapse",this.updateExpand))}},{key:"blazorActionBegin",value:function(){this.parent.allowGrouping&&!this.parent.isCollapseStateEnabled()&&this.expandAll()}},{key:"initialEnd",value:function(){var e=this.parent;if(this.parent.off(A,this.initialEnd),this.parent.off(L,this.initialEnd),Object(m.W)()&&e.isServerRendered){for(var t=0;t<e.columns.length;t++)this.removeColFromGroupDrop(e.columns[t].field);this.updateGroupDropArea()}if(this.parent.getColumns().length&&this.groupSettings.columns.length){this.contentRefresh=!1;var i,n=c(e.groupSettings.columns);try{for(n.s();!(i=n.n()).done;){var r=i.value;this.groupColumn(r)}}catch(s){n.e(s)}finally{n.f()}this.contentRefresh=!0}}},{key:"keyPressHandler",value:function(e){var t=this.parent;if("ctrlSpace"===e.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(e.action))switch(e.preventDefault(),e.action){case"altDownArrow":case"altUpArrow":var i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){for(var n,r=t.getContentTable().querySelector("tbody").children,s=t.getDataRows()[i[i.length-1]].rowIndex;s>=0;s--)if(!r[s].classList.contains("e-row")&&!r[s].classList.contains("e-detailrow")){n=r[s];break}this.expandCollapseRows(n.querySelector("altUpArrow"===e.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(this.parent.isEdit||null!==Object(m.C)(e.target,"#"+this.parent.element.id+"_searchbar"))return;var a=this.focus.getFocusedElement(),l=a?a.parentElement.querySelector('[class^="e-record"]'):null;if(!l)break;this.expandCollapseRows(l);break;case"ctrlSpace":var o=t.focusModule.currentInfo.element;if(o&&o.classList.contains("e-headercell")){var h=t.getColumnByUid(o.firstElementChild.getAttribute("e-mappinguid"));h.field&&t.groupSettings.columns.indexOf(h.field)<0?this.groupColumn(h.field):this.ungroupColumn(h.field)}}}},{key:"clickHandler",value:function(e){this.expandCollapseRows(e.target),this.applySortFromTarget(e.target),this.unGroupFromTarget(e.target),this.toogleGroupFromHeader(e.target)}},{key:"unGroupFromTarget",value:function(e){e.classList.contains("e-ungroupbutton")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname"))}},{key:"toogleGroupFromHeader",value:function(e){this.groupSettings.showToggleButton&&(e.classList.contains("e-grptogglebtn")?e.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):e.classList.contains("e-toggleungroup")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname")))}},{key:"applySortFromTarget",value:function(e){var t=this.parent,i=Object(m.C)(e,".e-groupheadercell");if(t.allowSorting&&i&&!e.classList.contains("e-ungroupbutton")&&!e.classList.contains("e-toggleungroup")){var n=i.firstElementChild.getAttribute("ej-mappingname");t.getColumnHeaderByField(n).querySelectorAll(".e-ascending").length?t.sortColumn(n,"Descending",!0):t.sortColumn(n,"Ascending",!0)}}},{key:"expandCollapseRows",value:function(e){var t=Wt(e,"e-recordplusexpand")||Wt(e,"e-recordpluscollapse");if(t){var i,n,r,s,a=t.cellIndex,l=t.parentElement.rowIndex,o=this.parent.getContentTable().querySelector("tbody").children,h=[].slice.call(o).slice(l+1,o.length),c=[],u=this.parent,d=t.parentElement.querySelectorAll(".e-indentcell").length,p=!1;if(Object(m.W)()&&this.parent.isCollapseStateEnabled())return void this.parent.notify("group-expand-collapse",{uid:t.parentElement.getAttribute("data-uid"),isExpand:t.classList.contains("e-recordpluscollapse")});if(t.classList.contains("e-recordpluscollapse")?(Object(m.v)([t],"e-recordplusexpand"),Object(m.ib)([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",p=!0,Si(u)&&this.updateVirtualRows(u,e,p,s,r),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionExpand(t.parentElement)):(i=!0,Object(m.ib)([t],"e-recordplusexpand"),Object(m.v)([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",Si(u)&&this.updateVirtualRows(u,e,!i,s,r),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionCollapse(t.parentElement)),this.aria.setExpand(t,p),!Si(u)&&!this.parent.groupSettings.enableLazyLoading)for(var g=0,f=h.length;g<f&&h[g].querySelectorAll("td")[a]&&h[g].querySelectorAll("td")[a].classList.contains("e-indentcell")&&h;g++)i?h[g].style.display="none":h[g].querySelectorAll(".e-indentcell").length===d+1&&(h[g].style.display="",(n=h[g].querySelector(".e-recordplusexpand"))&&c.push(n),h[g].classList.contains("e-detailrow")&&h[g-1].querySelectorAll(".e-detailrowcollapse").length&&(h[g].style.display="none"));for(var v=0,b=c.length;v<b;v++)Object(m.ib)([c[v]],"e-recordplusexpand"),Object(m.v)([c[v]],"e-recordpluscollapse"),c[v].firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",this.expandCollapseRows(c[v])}}},{key:"updateVirtualRows",value:function(e,t,i,n,r){var s=e.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid"));s.isExpand=i,function(e){for(var t=[],i=e.vRows,n=0;n<i.length;n++)i[n].isDataRow?t.push(i[n]):i[n].isDataRow||(t.push(i[n]),!i[n].isExpand&&i[n].isCaptionRow&&(n+=Ft(i[n],e)));e.vcRows=t}(e),(n=e.getDataModule().generateQuery(!1)).queries=e.getDataModule().aggregateQuery(e.getQuery().clone()).queries;var a={requestType:"virtualscroll",rowObject:s};e.getDataModule().getData(a,n.requiresCount()).then((function(t){return e.renderModule.dataManagerSuccess(t,a)}))}},{key:"expandCollapse",value:function(e){if(Object(m.W)()&&this.parent.isCollapseStateEnabled())this.parent.notify("group-expand-collapse",{isExpand:e});else{e||this.parent.notify("initial-collapse",e);for(var t,i=this.parent.getContentTable().querySelector("tbody").children,n=0,r=i.length;n<r;n++)i[n].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((t=i[n].querySelector(e?".e-recordpluscollapse":".e-recordplusexpand"))&&(t.className=e?"e-recordplusexpand":"e-recordpluscollapse",t.firstElementChild.className=e?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"),i[n].firstElementChild.classList.contains("e-recordplusexpand")||i[n].firstElementChild.classList.contains("e-recordpluscollapse")||(i[n].style.display=e?"":"none")):i[n].style.display=e?"":"none"}}},{key:"expandAll",value:function(){this.expandCollapse(!0)}},{key:"collapseAll",value:function(){this.expandCollapse(!1)}},{key:"render",value:function(){this.l10n=this.serviceLocator.getService("localization"),this.renderGroupDropArea(),this.initDragAndDrop(),this.refreshToggleBtn()}},{key:"renderGroupDropArea",value:function(){var e=this.parent.element.querySelector(".e-groupdroparea");e&&Object(m.hb)(e),this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}}),this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate"),this.updateGroupDropArea(),this.parent.element.insertBefore(this.element,this.parent.element.firstChild),this.groupSettings.showDropArea||(this.element.style.display="none")}},{key:"updateGroupDropArea",value:function(e){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){var t=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=t,this.element.classList.remove("e-grouped")}else(this.element.innerHTML===this.l10n.getConstant("GroupDropArea")&&(1===this.groupSettings.columns.length||!this.isAppliedGroup&&!this.isAppliedUnGroup)||e)&&(this.element.innerHTML=""),this.element.classList.add("e-grouped")}},{key:"initDragAndDrop",value:function(){this.initializeGHeaderDrop(),this.initializeGHeaderDrag()}},{key:"initializeGHeaderDrag",value:function(){new m.i(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})}},{key:"initializeGHeaderDrop",value:function(){new m.j(this.element,{accept:".e-dragclone",drop:this.drop})}},{key:"groupColumn",value:function(e){var t=this.parent,i=t.getColumnByField(e);Object(m.X)(i)||!1===i.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(e)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):oi(t)?t.notify(G,{instance:this,handler:this.groupColumn,arg1:e}):(i.visible=t.groupSettings.showGroupedColumn,this.colName=e,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(e),this.updateGroupDropArea(),this.isAppliedGroup=!1)}},{key:"ungroupColumn",value:function(e){var t=this.parent,i=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(t){return t.field===e}))[0]:t.getColumnByField(e);if(!(Object(m.X)(i)||!1===i.allowGrouping||this.groupSettings.columns.indexOf(e)<0))if(oi(t))t.notify(G,{instance:this,handler:this.ungroupColumn,arg1:e});else{if(i.visible=!0,Object(m.W)()&&t.isServerRendered){var n=[];n[0]=i,this.parent.notify("setvisibility",n)}this.colName=i.field;var r=JSON.parse(JSON.stringify(this.groupSettings.columns));if(r.splice(r.indexOf(this.colName),1),this.sortedColumns.indexOf(e)<0)for(var s=0,a=t.sortSettings.columns.length;s<a;s++)if(e===t.sortSettings.columns[s].field){t.sortSettings.columns.splice(s,1);break}Object(m.W)()&&this.parent.isServerRendered&&(t.sortSettings.columns=t.sortSettings.columns),this.groupSettings.allowReordering&&(this.reorderingColumns=r),this.groupSettings.columns=r,t.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}}},{key:"updateModel",value:function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));e=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):e,this.sortRequired&&(-1===e.indexOf(this.colName)&&e.push(this.colName),this.groupAddSortingQuery(this.colName)),this.sortRequired=!0,this.parent.groupSettings.columns=e,this.parent.dataBind()}},{key:"onActionComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),"grouping"===e.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);var t=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:E}:{requestType:"ungrouping",type:E};this.parent.trigger(E,Object(m.K)(e,t)),this.colName=null}},{key:"groupAddSortingQuery",value:function(e){for(var t=0;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[t].field!==e;)t++;if(this.parent.sortSettings.columns.length===t){this.parent.sortSettings.columns.push({field:e,direction:"Ascending",isFromGroup:!0});Object(m.W)()&&this.parent.isServerRendered&&(this.parent.sortSettings.columns=this.parent.sortSettings.columns)}else this.parent.allowSorting||(this.parent.sortSettings.columns[t].direction="Ascending")}},{key:"createElement",value:function(e){var t=this.parent,i="Ascending",n=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),r=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),s=this.parent.createElement("div",{attrs:{"ej-mappingname":e}}),a=this.parent.getColumnByField(e),l=t.getColumnHeaderByUid(a.uid);return this.groupSettings.allowReordering&&s.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":"Drag the grouped column"}})),s.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:a.headerText,attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),this.groupSettings.showToggleButton&&s.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"ungroup button"}})),l.querySelectorAll(".e-ascending,.e-descending").length&&(i=l.querySelector(".e-ascending")?"Ascending":"Descending"),s.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+i.toLowerCase()+" e-icon-"+i.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),s.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:Object(m.W)()?this.l10n.getConstant("UnGroupButton"):this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":"ungroup the grouped column"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),r.appendChild(s),this.groupSettings.columns.indexOf(e),this.groupSettings.allowReordering&&(n.appendChild(r),n.appendChild(this.createSeparator()),r=n),r}},{key:"addColToGroupDrop",value:function(e){if(!this.groupSettings.allowReordering||!this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+e+"]")){var t=this.parent.getColumnByField(e);if(!Object(m.X)(t)){var i=this.createElement(e);if(this.groupSettings.allowReordering){var n=this.element.querySelectorAll(".e-group-animator").length;i.setAttribute("index",n.toString())}this.element.appendChild(i)}}}},{key:"createSeparator",value:function(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"Separator for the grouped columns"},styles:this.groupSettings.showUngroupButton?"":"display:none"})}},{key:"refreshToggleBtn",value:function(e){if(this.groupSettings.showToggleButton)for(var t=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv")),i=0,n=t.length;i<n;i++)if(!t[i].classList.contains("e-emptycell")&&!t[i].classList.contains("e-headerchkcelldiv")){var r=this.parent.getColumnByUid(t[i].getAttribute("e-mappinguid"));(!this.parent.showColumnMenu||this.parent.showColumnMenu&&!r.showColumnMenu)&&(t[i].querySelectorAll(".e-grptogglebtn").length&&Object(m.hb)(t[i].querySelectorAll(".e-grptogglebtn")[0]),e||t[i].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(r.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":"Group button"}})))}}},{key:"removeColFromGroupDrop",value:function(e){if(!Object(m.X)(this.getGHeaderCell(e))){var t=this.getGHeaderCell(e);if(this.groupSettings.allowReordering){var i=Wt(t,"e-group-animator");Object(m.hb)(i)}else Object(m.hb)(t);this.updateGroupDropArea()}this.isAppliedUnGroup=!1}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName())for(var t=0,i=Object.keys(e.properties);t<i.length;t++){var n=i[t];switch(n){case"columns":var r=void 0;if(this.contentRefresh){if(this.isAppliedUnGroup)r={columnName:this.colName,requestType:"ungrouping",type:D};else{if(!this.isAppliedGroup){this.updateGroupDropArea(!0);for(var s=0;s<this.parent.sortSettings.columns.length;s++)this.parent.sortSettings.columns[s].isFromGroup&&(this.parent.sortSettings.columns.splice(s,1),s--);for(var a=0;a<this.groupSettings.columns.length;a++)this.colName=this.groupSettings.columns[a],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),a<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[a])}r={columnName:this.colName,requestType:e.properties[n].length?"grouping":"ungrouping",type:D}}if(!this.groupSettings.showGroupedColumn)for(var l=e.oldProperties[n],o=0;o<l.length;o++)-1===e.properties[n].indexOf(l[o])&&(this.parent.getColumnByField(l[o]).visible=!0);Object(m.W)()&&this.parent.isServerRendered&&this.parent.isCollapseStateEnabled()&&"grouping"===r.requestType&&this.parent.refreshHeader(),this.parent.notify(P,r)}break;case"showDropArea":this.updateGroupDropArea(),this.element.style.display=this.groupSettings.showDropArea?"":"none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn),this.parent.notify(P,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton "),this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}}},{key:"updateGroupedColumn",value:function(e){for(var t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[t]).visible=e}},{key:"updateButtonVisibility",value:function(e,t){for(var i=[].slice.call(this.element.querySelectorAll("."+t)),n=0;n<i.length;n++)i[n].style.display=e?"":"none"}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&this.render()}},{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.isDestroyed||this.parent.refreshing||this.clearGrouping(),this.removeEventListener(),this.refreshToggleBtn(!0),Object(m.hb)(this.element))}},{key:"clearGrouping",value:function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));this.contentRefresh=!1;for(var t=0,i=e.length;t<i;t++)t===i-1&&(this.contentRefresh=!0),this.ungroupColumn(e[t]);this.contentRefresh=!0}},{key:"getModuleName",value:function(){return"group"}},{key:"refreshSortIcons",value:function(e){var t,i=this.parent,n=i.sortSettings.columns,r=i.groupSettings.columns,s=this.parent.getColumns().map((function(e){return e.field}));this.refreshToggleBtn();for(var a=0,l=n.length;a<l;a++)-1!==s.indexOf(n[a].field)&&(t=i.getColumnHeaderByField(n[a].field),!i.allowSorting&&(this.sortedColumns.indexOf(n[a].field)>-1||this.groupSettings.columns.indexOf(n[a].field)>-1)?(Object(m.A)(t.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),n.length>1&&t.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(a+1).toString()}))):this.getGHeaderCell(n[a].field)&&this.getGHeaderCell(n[a].field).querySelectorAll(".e-groupsort").length&&("Ascending"===n[a].direction?Object(m.A)(this.getGHeaderCell(n[a].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):Object(m.A)(this.getGHeaderCell(n[a].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(var o=0,h=r.length;o<h;o++)-1!==s.indexOf(r[o])&&i.getColumnHeaderByField(r[o]).setAttribute("aria-grouped","true")}},{key:"getGHeaderCell",value:function(e){return this.element&&this.element.querySelector('[ej-mappingname="'+e+'"]')?this.element.querySelector('[ej-mappingname="'+e+'"]').parentElement:null}},{key:"onGroupAggregates",value:function(e){var t=this.iterateGroupAggregates(e),i=this.groupGenerator.generateRows(t,{}),n=this.parent.getRowsObject().filter((function(e){return!e.isDataRow})),r=i.filter((function(e){return!e.isDataRow}));this.parent.isReact&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]);for(var s=0;s<r.length;s++){var a=r[s],l=a.cells.filter((function(e){return e.isDataCell}));this.parent.notify("refresh-aggregate-cell",{cells:l,data:a.data,dataUid:n[s]?n[s].uid:""})}}},{key:"iterateGroupAggregates",value:function(e){var t=e instanceof Array?e:[],i=this.parent.getRowsObject(),n=this.parent.getCurrentViewRecords(),r=[],s=i.map((function(e){return"delete"===e.edit&&r.push(e.data),e.changes instanceof Object?e.changes:e.data})),a=this.parent.getPrimaryKeyFieldNames()[0];s=0===t.length?s:t;var l=n.map((function(e){var t,i=v.b.getObject(a,e);return s.some((function(e){return t=e,i===v.b.getObject(a,e)}))?t:e}));if((!e.type||"cancel"!==e.type)&&r.length>0)for(var o=0;o<r.length;o++){var h=l.indexOf(r[o]);l.splice(h,1)}for(var c,u,d=[],p=this.parent.aggregates,g=0;g<p.length;g++)for(var f=p[g],m=0;m<f.columns.length;m++){var b;b={type:f.columns[m].type.toString().toLowerCase(),field:f.columns[m].field},d.push(b)}for(var y=this.parent.groupSettings.columns,C=0;C<y.length;C++)u=c||l,c=v.b.group(u,y[C],d,null,null);return c}},{key:"updateExpand",value:function(e){for(var t=e.uid,i=e.isExpand,n=this.parent.getRowsObject(),r=0;r<n.length;r++){var s=n[r];if(s.uid===t||Object(m.X)(t)){s.isExpand=i;for(var a=function(e){var i=void 0,r=n[e];if(r.parentUid!==s.uid&&(i=n.filter((function(e){return e.uid===r.parentUid}))[0]),r.parentUid===s.uid?r.visible=s.isExpand:Object(m.X)(i)||r.parentUid!==i.uid||(i.isExpand&&!0===i.visible?r.visible=!0:i.isExpand&&!1===i.visible&&(r.visible=!1)),Object(m.X)(t))return"break"},l=r+1;l<n.length;l++){if("break"===a(l))break}}}this.parent.notify(A,{rows:n,args:{isFrozen:!1,rows:n}})}}]),e}(),jn=function(e){n(i,e);var t=s(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).aggregates={},r.parent=e,r.locator=n,r.modelGenerator=new ee(r.parent),r.addEventListener(),r}return f(i,[{key:"renderPanel",value:function(){var e=this.parent.createElement("div",{className:"e-gridfooter"}),t=this.parent.createElement("div",{className:"e-summarycontent"}),i=t;if(this.parent.isFrozenGrid()){var n=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-left-footercontent"}),r=this.parent.createElement("div",{className:"e-movablefootercontent"}),s=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-right-footercontent"});(this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&(t.appendChild(n),this.frozenContent=n),t.appendChild(r),this.movableContent=r,i=r,this.parent.getFrozenRightColumnsCount()&&(t.appendChild(s),this.frozenRightContent=s)}m.d.isDevice&&(i.style.overflowX="scroll"),e.appendChild(t),this.setPanel(e),null!=this.parent.getPager()?this.parent.element.insertBefore(e,this.parent.getPager()):this.parent.element.appendChild(e)}},{key:"renderTable",value:function(){var e=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),t=this.createContentTable("_footer_table").querySelector(".e-table"),i=this.parent.createElement("tfoot");if(t.appendChild(i),this.parent.isFrozenGrid()){var n=t.cloneNode(!0),r=t.cloneNode(!0);if(e&&(this.frozenContent.appendChild(n),this.freezeTable=n),this.parent.getFrozenRightColumnsCount()){Object(m.hb)(r.querySelector("colgroup"));var s=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").cloneNode(!0);r.insertBefore(s,r.querySelector("tbody")),this.frozenRightContent.appendChild(r),this.frTable=r}this.movableContent.appendChild(t),Object(m.hb)(t.querySelector("colgroup"));var a=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);t.insertBefore(a,t.querySelector("tbody")),this.setColGroup(a)}this.setTable(t)}},{key:"renderSummaryContent",value:function(e,t,i,n){var r=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData,s=this.modelGenerator.getData(),a=Object(m.X)(i)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(i,n),l=Object(m.X)(i)?this.modelGenerator.generateRows(r,e||this.aggregates):this.modelGenerator.generateRows(r,e||this.aggregates,i,n),o=document.createDocumentFragment(),h=new Z(this.locator,null,this.parent);h.element=this.parent.createElement("TR",{className:"e-summaryrow"});for(var c=0,u=s.length;c<u;c++){var d=l[c];if(d){var p=h.render(d,a);o.appendChild(p)}}t.tFoot.appendChild(o),this.aggregates=Object(m.X)(e)?this.aggregates:e}},{key:"refresh",value:function(e){var t=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),i=this.parent.getMovableColumnsCount(),n=this.parent.getFrozenRightColumnsCount();if(this.parent.isFrozenGrid()&&(Object(m.hb)(this.getPanel()),this.renderPanel(),this.renderTable(),t&&(this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.freezeTable,0,t))),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(e,this.getTable(),t,n?t+i:void 0),this.parent.getFrozenRightColumnsCount()){this.frTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.frTable,t+i,t+i+n);var r=[].slice.call(this.getTable().querySelectorAll(".e-lastsummarycell"));if(r.length)for(var s=0;s<r.length;s++)r[s].style.borderRight="0px"}if(this.parent.isFrozenGrid()){var a,l=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").querySelectorAll(".e-summaryrow"));if(t){a=[].slice.call(this.parent.element.querySelector(".e-frozen-left-footercontent").querySelectorAll(".e-summaryrow")),this.refreshHeight(a,l);var o=this.frozenContent;o.offsetHeight||(o.style.height=this.getTable().offsetHeight+"px")}if(n){var h=[].slice.call(this.parent.element.querySelector(".e-frozen-right-footercontent").querySelectorAll(".e-summaryrow"));this.refreshHeight(h,l),a&&this.refreshHeight(h,a);var c=this.frTable;c.offsetHeight||(c.style.height=this.getTable().offsetHeight+"px")}this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable())}this.onScroll()}},{key:"refreshHeight",value:function(e,t){for(var i=0;i<e.length;i++){var n=e[i].getBoundingClientRect().height,r=t[i].getBoundingClientRect().height;n<r?(e[i].classList.remove("e-hide"),e[i].style.height=r+"px"):n>r&&(t[i].classList.remove("e-hide"),t[i].style.height=n+"px")}}},{key:"refreshCol",value:function(){var e,t=e=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?e=this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):(e=ki(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector("colGroup")))),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)}},{key:"onWidthChange",value:function(e){this.getColFromIndex(e.index).style.width=Object(m.L)(e.width),this.parent.allowResizing&&"resize"===e.module&&this.updateFooterTableWidth(this.getTable())}},{key:"onScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent").scrollLeft:this.parent.getContent().firstChild.scrollLeft};this.getTable().parentElement.scrollLeft=e.left}},{key:"getColFromIndex",value:function(e){var t=this.parent.getFrozenColumns();return(t=t&&this.parent.isRowDragable()?t+1:t)&&t>e?this.freezeTable.querySelector("colGroup").children[e]:this.getColGroup().children[e-t]}},{key:"columnVisibilityChanged",value:function(){this.refresh()}},{key:"addEventListener",value:function(){this.parent.on("colgroup-refresh",this.refreshCol,this),this.parent.on("column-width-changed",this.onWidthChange,this),this.parent.on("scroll",this.onScroll,this),this.parent.on("column-visible-changed",this.columnVisibilityChanged,this),this.parent.on("refresh-footer-rendered",this.refreshFooterRenderer,this)}},{key:"removeEventListener",value:function(){this.parent.off("colgroup-refresh",this.refreshCol),this.parent.off("column-width-changed",this.onWidthChange),this.parent.off("scroll",this.onScroll),this.parent.off("column-visible-changed",this.columnVisibilityChanged),this.parent.off("refresh-footer-rendered",this.refreshFooterRenderer)}},{key:"updateFooterTableWidth",value:function(e){var t=this.parent.getHeaderTable();t&&e&&(e.style.width=t.style.width)}},{key:"refreshFooterRenderer",value:function(e){var t=this.onAggregates(e);this.refresh(t)}},{key:"getIndexByKey",value:function(e,t){for(var i=this.parent.getPrimaryKeyFieldNames()[0],n=0;n<t.length;n++)if(t[n][i]===e[i])return n;return-1}},{key:"onAggregates",value:function(e){e=e instanceof Array?e:[];var t=this.parent.getPrimaryKeyFieldNames()[0],i=[],n=!1,r={},s=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.dataSource.dataSource.json.length?this.parent.dataSource.dataSource.json:this.parent.getCurrentViewRecords();if(this.parent.editModule&&(r=this.parent.editModule.getBatchChanges()),Object.keys(r).length){for(var a=0;a<s.length;a++)n=!1,r.changedRecords.length&&this.getIndexByKey(s[a],r.changedRecords)>-1&&(n=!0,i.push(r.changedRecords[this.getIndexByKey(s[a],r.changedRecords)])),r.deletedRecords.length&&this.getIndexByKey(s[a],r.deletedRecords)>-1?n=!0:n||i.push(s[a]);if(r.addedRecords.length)for(var l=0;l<r.addedRecords.length;l++)i.push(r.addedRecords[l])}else i=e.length?zt(s).map((function(i){var n,r=v.b.getObject(t,i);return e.some((function(e){return n=e,r===v.b.getObject(t,e)}))?n:i})):s;e.type&&"cancel"===e.type&&(i=s);for(var o,h={},c=this.parent.aggregates,u=0;u<c.length;u++)for(var d=0;d<c[u].columns.length;d++){var p=c[u].columns[d].type.toString();o=$t(p,i,c[u].columns[d],this.parent),h[c[u].columns[d].field+" - "+p.toLowerCase()]=o}return{result:i,count:i.length,aggregates:h}}}]),i}(re),Rn=function(e){n(i,e);var t=s(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).element=e.parent.createElement("TD",{className:"e-summarycell",attrs:{role:"gridcell",tabindex:"-1"}}),e}return f(i,[{key:"getValue",value:function(e,t,i){var n;return n=Object(m.X)(i.type)?i.columnName:i.field+" - "+("string"==typeof i.type?i.type.toLowerCase():""),t[i.columnName]?t[i.columnName][n]:""}},{key:"evaluate",value:function(e,t,i,n){var r=t.column;if(this.parent.on("refresh-aggregate-cell",this.refreshWithAggregate(e,t),this),!(r.footerTemplate||r.groupFooterTemplate||r.groupCaptionTemplate))return!0;var s=r.getTemplate(t.cellType),a="",l=this.parent.getColumnByField(i[r.columnName].field);if(!Object(m.X)(l)&&(i[r.columnName].headerText=l.headerText,l.isForeignColumn())){var o=l.columnData.filter((function(e){return e[l.foreignKeyField]===i[r.columnName].key}))[0];o&&(i[r.columnName].foreignKey=o[l.foreignKeyValue])}return Object(m.W)()&&(a=this.parent.element.id+r.guid+s.property),this.parent.isReact&&(r.footerTemplate?"string"!=typeof r.footerTemplate:r.groupFooterTemplate?"string"!=typeof r.groupFooterTemplate:r.groupCaptionTemplate&&"string"!=typeof r.groupCaptionTemplate)?(s.fn(i[r.columnName],this.parent,s.property,a,null,null,e),this.parent.renderTemplates()):Jt(e,s.fn(i[r.columnName],this.parent,s.property,a)),!1}},{key:"refreshWithAggregate",value:function(e,t){var i=this,n=t;return function(t){var r=n.column.columnName?n.column.columnName:null,s=Object(m.X)(r)?null:t.cells.filter((function(e){return e.column.columnName===r}))[0];e.parentElement&&e.parentElement.getAttribute("data-uid")===t.dataUid&&r&&r===s.column.columnName&&i.refreshTD(e,s,t.data)}}}]),i}(ae),Dn=function(){function e(t,i,n){var r=this;p(this,e),this.fromWheel=!1,this.touchMove=!1,this.options={},this.sentinelInfo={up:{check:function(e,t){var i=e.top-r.containerRect.top;return t.entered=i>=0,i+r.options.pageHeight/2>=0},axis:"Y"},down:{check:function(e,t){var i=e.bottom;return t.entered=e.bottom<=r.containerRect.bottom,i-r.options.pageHeight/2<=r.options.pageHeight/2},axis:"Y"},right:{check:function(e,t){var i=e.right;return r.movableEle?(t.entered=i<r.movableContainerRect.right,i-r.movableContainerRect.width<=r.movableContainerRect.right):(t.entered=i<r.containerRect.right,i-r.containerRect.width<=r.containerRect.right)},axis:"X"},left:{check:function(e,t){var i=e.left;return t.entered=i>0,r.movableEle?i+r.movableContainerRect.width>=r.movableContainerRect.left:i+r.containerRect.width>=r.containerRect.left},axis:"X"}},this.element=t,this.options=i,this.movableEle=n}return f(e,[{key:"observe",value:function(e,t){var i=this;this.containerRect=this.options.container.getBoundingClientRect(),m.l.add(this.options.container,"wheel",(function(){return i.fromWheel=!0}),this),m.l.add(this.options.container,"scroll",this.virtualScrollHandler(e,t),this),this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),m.l.add(this.options.scrollbar,"wheel",(function(){return i.fromWheel=!0}),this),m.l.add(this.options.scrollbar,"scroll",this.virtualScrollHandler(e,t),this))}},{key:"check",value:function(e){var t=this.sentinelInfo[e];return t.check(!this.movableContainerRect||"left"!==e&&"right"!==e?this.element.getBoundingClientRect():this.movableEle.getBoundingClientRect(),t)}},{key:"virtualScrollHandler",value:function(e,t){var i=this,n="chrome"===m.d.info.name?200:100,r=Object(m.G)(e,n),s=Object(m.G)(e,50);return this.options.prevTop=this.options.prevLeft=0,function(e){var n=i.options.movableContainer?i.options.container.scrollTop:e.target.scrollTop,a=i.options.movableContainer?i.options.scrollbar.scrollLeft:e.target.scrollLeft,l=i.options.prevTop<n?"down":"up";l=i.options.prevLeft===a?l:i.options.prevLeft<a?"right":"left",i.options.prevTop=n,i.options.prevLeft=a;var o=i.sentinelInfo[l];if(-1!==i.options.axes.indexOf(o.axis)){var h=i.check(l);if(o.entered&&t(!i.movableEle||"right"!==l&&"left"!==l?i.element:i.movableEle,o,l,{top:n,left:a},i.fromWheel,h),h){var c=r;"X"===o.axis&&(c=s),c({direction:l,sentinel:o,offset:{top:n,left:a},focusElement:document.activeElement})}i.fromWheel=!1}}}},{key:"setPageHeight",value:function(e){this.options.pageHeight=e}}]),e}(),En=function(){function e(t){p(this,e),this.cOffsets={},this.cache={},this.movableCache={},this.frozenRightCache={},this.rowCache={},this.data={},this.groups={},this.parent=t,this.model=this.parent.pageSettings,this.rowModelGenerator=this.parent.allowGrouping?new ne(this.parent):new $(this.parent)}return f(e,[{key:"generateRows",value:function(e,t){var i=this.parent.isFrozenGrid(),n=t.virtualInfo=t.virtualInfo||this.getData(),r=n.sentinelInfo&&"X"===n.sentinelInfo.axis,s=[],a=this.getBlockIndexes(r||!n.loadNext||n.loadSelf?n.page:n.nextInfo.page),l=[];if((i&&2===this.parent.getTablesCount()&&!t.renderMovableContent||3===this.parent.getTablesCount()&&!t.renderMovableContent&&!t.renderFrozenRightContent||!i)&&this.checkAndResetCache(t.requestType),Si(this.parent)&&this.parent.vcRows.length)return this.parent.vcRows;if(this.parent.enableColumnVirtualization)for(var o=0;o<n.blockIndexes.length;o++)if(this.isBlockAvailable(n.blockIndexes[o])&&(this.cache[n.blockIndexes[o]]=this.rowModelGenerator.refreshRows(this.cache[n.blockIndexes[o]])),t.renderMovableContent&&this.isMovableBlockAvailable(n.blockIndexes[o])||t.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(n.blockIndexes[o])){var c=t.renderMovableContent?this.movableCache:this.frozenRightCache;c[n.blockIndexes[o]]=this.rowModelGenerator.refreshRows(c[n.blockIndexes[o]])}if(Object(m.W)()&&this.parent.isServerRendered){var u="virtualStartIndex";if(t[u]||0!==Object.keys(this.rowCache).length){if(t[u]){for(var d=t.startIndex,p=[],g=0;g<Object.keys(this.rowCache).length;g++)p.push(Number(Object.keys(this.rowCache)[g]));for(var f=0;f<e.length;f++){var v=[],b=p.indexOf(d);v.push(e[f]),-1===b&&(this.rowCache[d]=this.rowModelGenerator.generateRows(v,{startIndex:d})[0]),d++}}}else{for(var y=0;y<e.length;y++){var C=[];C.push(e[y]),this.rowCache[y]=this.rowModelGenerator.generateRows(C,{startIndex:y})[0]}for(var w=0,k=0;k<this.parent.pageSettings.pageSize;k++)s[w]=this.rowCache[k],w++}if(!Object(m.X)(t[u]))for(var S=0,O=t.startIndex;O<t.endIndex;O++)s[S]=this.rowCache[O],S++}else{for(var x=n.blockIndexes,j=0;j<x.length;j++){if(!this.isBlockAvailable(x[j])){var R=void 0,D=this.rowModelGenerator.generateRows(e,{virtualInfo:n,startIndex:this.getStartIndex(x[j],e)});Si(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=D,this.parent.vcRows=D),Si(this.parent)?(R=this.model.pageSize/2,this.isBlockAvailable(a[0])||(this.cache[a[0]]=D.slice(0,R)),this.isBlockAvailable(a[1])||(this.cache[a[1]]=D.slice(R,this.model.pageSize))):(R=~~Math.max(D.length,this.model.pageSize)/2,this.isBlockAvailable(a[0])||(this.cache[a[0]]=D.slice(0,R)),this.isBlockAvailable(a[1])||(this.cache[a[1]]=D.slice(R)))}if(this.parent.groupSettings.columns.length&&!r&&this.cache[x[j]]&&(this.cache[x[j]]=this.updateGroupRow(this.cache[x[j]],x[j])),t.renderMovableContent&&!this.isMovableBlockAvailable(x[j])||t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(x[j])){var E=t.renderMovableContent?this.movableCache:this.frozenRightCache,I=this.rowModelGenerator.generateRows(e,{virtualInfo:n,startIndex:this.getStartIndex(x[j],e)}),M=~~Math.max(I.length,this.model.pageSize)/2;(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(a[0])||t.renderMovableContent&&!this.isMovableBlockAvailable(a[0]))&&(E[a[0]]=I.slice(0,M)),(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(a[1])||t.renderMovableContent&&!this.isMovableBlockAvailable(a[1]))&&(E[a[1]]=I.slice(M))}if(t.renderMovableContent||t.renderFrozenRightContent||!this.cache[x[j]]){var F=t.renderMovableContent?this.movableCache:this.frozenRightCache;F[x[j]]&&s.push.apply(s,h(F[x[j]]))}else s.push.apply(s,h(this.cache[x[j]]));this.isBlockAvailable(x[j])&&l.push(x[j])}n.blockIndexes=l}if(!Object(m.W)()||Object(m.W)()&&!this.parent.isServerRendered){this.parent.allowGrouping?this.parent.currentViewData.records=s.map((function(e){return e.data})):i?(t.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||t.renderFrozenRightContent)&&(this.parent.currentViewData=s.map((function(e){return e.data}))):this.parent.currentViewData=s.map((function(e){return e.data}))}return s}},{key:"getBlockIndexes",value:function(e){return[e+(e-1),2*e]}},{key:"getPage",value:function(e){return e%2==0?e/2:(e+1)/2}},{key:"isBlockAvailable",value:function(e){return e in this.cache}},{key:"isMovableBlockAvailable",value:function(e){return e in this.movableCache}},{key:"isFrozenRightBlockAvailable",value:function(e){return e in this.frozenRightCache}},{key:"getData",value:function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}}},{key:"getStartIndex",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(this.getPage(e)-1)*this.model.pageSize;return i||e%2!=0?n:n+~~(this.model.pageSize/2)}},{key:"getColumnIndexes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent.getHeaderContent().querySelector(".e-headercontent");this.parent.isFrozenGrid()&&(t=t.querySelector(".e-movableheader"));var i=[],n=0|t.scrollLeft,r=Object.keys(this.cOffsets),s=t.getBoundingClientRect().width;n=Math.min(this.cOffsets[r.length-1]-s,n);var a=m.d.isDevice?2*s:s/2,l=n+s+(0===n?a:0);return r.some((function(t,r,s){var o=Number(t),h=e.cOffsets[t];return n-a<=h&&l+a>=h&&i.push(o),l+a<h})),Object(m.W)()&&this.parent.isServerRendered&&(this.parent.contentModule.startColIndex=i[0],this.parent.contentModule.endColIndex=i[i.length-1]),this.addFrozenIndex(i),i}},{key:"addFrozenIndex",value:function(e){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===e[0])for(var t=0;t<this.parent.getFrozenColumns();t++)e.push(e[e.length-1]+1)}},{key:"checkAndResetCache",value:function(e){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"];this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===e&&t.splice(t.indexOf(e),1);var i=t.some((function(t){return e===t}));return i&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),i}},{key:"refreshColOffsets",value:function(){var e=this,t=0;this.cOffsets={};for(var i=this.parent.groupSettings.columns.length,n=this.parent.columns,r=n.length,s=this.parent.groupSettings.columns,a=0;a<s.length;a++)this.cOffsets[a]=30+(0|this.cOffsets[a-1]);for(var l,o=Array.apply(null,Array(r)).map((function(){return t++})),h=0;h<o.length;h++)o[h]=o[h]+i,this.cOffsets[o[h]]=(0|this.cOffsets[o[h]-1])+((l=n[h]).visible&&(e.parent.groupSettings.showGroupedColumn?l.visible:e.parent.groupSettings.columns.indexOf(l.field)<0)?parseInt(n[h].width,10):0)}},{key:"updateGroupRow",value:function(e,t){for(var i=e[0],n=[],r=Object.keys(this.cache),s=0;s<r.length;s++)Number(r[s])<t&&(n=[].concat(h(n),h(this.cache[r[s]])));return i&&i.isDataRow||t%2==0?e:this.iterateGroup(e,n)}},{key:"iterateGroup",value:function(e,t){var i=e[0],n=0;return i&&i.isDataRow||e.some((function(e){return t.some((function(t,i){var r=t&&void 0!==t.data.field&&t.data.field===e.data.field&&t.data.key===e.data.key;return r&&(n=i),r}))}))&&(e.shift(),e=this.iterateGroup(e,t.slice(n))),e}},{key:"getRows",value:function(){for(var e=[],t=!(!Object(m.W)()||!this.parent.isServerRendered),i=Object.keys(t?this.rowCache:this.cache),n=0;n<i.length;n++)e=[].concat(h(e),h(t?this.rowCache[i[n]]:this.cache[i[n]]));return e}}]),e}(),In=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).prevHeight=0,n.startIndex=0,n.preStartIndex=0,n.preventEvent=!1,n.actions=["filtering","searching","grouping","ungrouping"],n.offsets={},n.tmpOffsets={},n.virtualEle=new Fn,n.offsetKeys=[],n.isFocused=!1,n.isSelection=!1,n.isBottom=!1,n.rndrCount=0,n.empty=void 0,n.isCancel=!1,n.requestTypes=["beginEdit","cancel","delete","add","save"],n.isNormaledit="Normal"===n.parent.editSettings.mode,n.virtualData={},n.emptyRowData={},n.vfColIndex=[],n.frzIdx=1,n.locator=i,n.eventListener("on"),n.parent.on("column-visible-changed",n.setVisible,l(n)),n.vgenerator=n.generator,n}return f(r,[{key:"renderTable",value:function(){this.header=this.locator.getService("rendererFactory").getRenderer(U.Header),i(o(r.prototype),"renderTable",this).call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.content=this.getPanel().querySelector(".e-content"),this.virtualEle.renderWrapper(this.parent.height),this.virtualEle.renderPlaceHolder(),this.virtualEle.wrapper.style.position="absolute";var e=this.parent.dataSource instanceof v.a&&!this.parent.dataSource.dataSource.offline,t={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:e,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new Dn(this.virtualEle.wrapper,t)}},{key:"renderEmpty",value:function(e){this.getTable().appendChild(e),this.virtualEle.adjustTable(0,0)}},{key:"scrollListener",value:function(e){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=e.offset),!this.preventEvent&&!this.parent.isDestroyed){this.isFocused=!Object(m.X)(document.activeElement)&&(this.content===Object(m.C)(document.activeElement,".e-content")||this.content===document.activeElement);var t=e.sentinel,i=this.preStartIndex,n=this.parent.getColumnIndexesInView(),r=this.currentInfo=this.getInfoFromView(e.direction,t,e.offset);if(Object(m.W)()&&this.parent.isServerRendered&&this.parent.enableColumnVirtualization&&JSON.stringify(n)!==JSON.stringify(r.columnIndexes)){this.parent.refreshHeader();var s=this.getColumnOffset(this.startColIndex-1),a=this.getColumnOffset(this.endColIndex-1)-s+"";this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",startColumnIndex:r.columnIndexes[0],endColumnIndex:r.columnIndexes[r.columnIndexes.length-1],axis:"X",VTablewidth:a,translateX:this.getColumnOffset(r.columnIndexes[0]-1)}),this.parent.notify("setcolumnstyles",{})}return Si(this.parent)&&!Object(m.W)()?"Y"===t.axis&&r.blockIndexes&&this.prevInfo.blockIndexes.toString()===r.blockIndexes.toString()&&"up"===e.direction&&2!==r.blockIndexes[r.blockIndexes.length-1]?void 0:(r.event="refresh-virtual-block",Object(m.X)(r.offsets)||(r.offsets.top=this.content.scrollTop),void this.parent.notify(r.event,{requestType:"virtualscroll",virtualInfo:r,focusElement:e.focusElement})):(!Object(m.W)()||Object(m.W)()&&!this.parent.isServerRendered)&&this.prevInfo&&("Y"===t.axis&&this.prevInfo.blockIndexes.toString()===r.blockIndexes.toString()||"X"===t.axis&&this.prevInfo.columnIndexes.toString()===r.columnIndexes.toString())?(m.d.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,void this.restoreEdit()):(this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?r.columnIndexes:[]),!Object(m.W)()||Object(m.W)()&&!this.parent.isServerRendered?this.parent.pageSettings.currentPage=r.loadNext&&!r.loadSelf?r.nextInfo.page:r.page:Object(m.W)()&&this.parent.isServerRendered&&this.preStartIndex!==i&&this.parent.pageSettings.currentPage===r.currentPage&&this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",virtualStartIndex:r.startIndex,virtualEndIndex:r.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}),void(!Object(m.W)()||Object(m.W)()&&!this.parent.isServerRendered?(this.requestType="virtualscroll",this.parent.notify(r.event,{requestType:"virtualscroll",virtualInfo:r,focusElement:e.focusElement})):this.preStartIndex!==i&&this.parent.pageSettings.currentPage!==r.currentPage&&(this.parent.pageSettings.currentPage=r.currentPage,this.parent.notify(r.event,{requestType:"virtualscroll",virtualStartIndex:r.startIndex,virtualEndIndex:r.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}))))}this.preventEvent=!1}},{key:"block",value:function(e){return this.vgenerator.isBlockAvailable(e)}},{key:"getInfoFromView",value:function(e,t,i){var n=!1,r=[],s={direction:e,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex},a=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;s.page=this.getPageFromTop(i.top,s),s.blockIndexes=r=this.vgenerator.getBlockIndexes(s.page),s.loadSelf=!this.vgenerator.isBlockAvailable(r[s.block]);var l=this.ensureBlocks(s);if("upArrow"===this.activeKey&&s.blockIndexes.toString()!==l.toString()&&-1===s.blockIndexes.indexOf(l[l.length-1])&&(n=!0),s.blockIndexes=l,s.loadNext=!l.filter((function(e){return-1===r.indexOf(e)})).every(this.block.bind(this)),s.event=s.loadNext||s.loadSelf?P:"refresh-virtual-block",s.nextInfo=s.loadNext?{page:Math.max(1,s.page+("down"===e?1:-1))}:{},n&&(s.blockIndexes=[s.blockIndexes[0]-1,s.blockIndexes[0],s.blockIndexes[0]+1]),"downArrow"===this.activeKey){var o=Math.ceil(this.rowIndex/this.getBlockSize());1!==o&&(s.blockIndexes[1]!==o||s.blockIndexes.length<3)&&(s.blockIndexes=[o-1,o,o+1])}if(s.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(s.event="refresh-virtual-block"),Object(m.W)()&&this.parent.isServerRendered){var h=this.parent.getRowHeight(),c=i.top/h,u=a/h,d=c+u,p=this.parent.pageSettings.pageSize/4;if("down"===s.direction){var g=Math.round(d)-Math.round(p);if(Object(m.X)(s.startIndex)||d>s.startIndex+Math.round(this.parent.pageSettings.pageSize/2+p)&&s.endIndex!==this.count){s.startIndex=g>=0?Math.round(g):0,s.startIndex=s.startIndex>c?Math.floor(c):s.startIndex;var f=s.startIndex+this.parent.pageSettings.pageSize;s.startIndex=f<d?Math.ceil(d)-this.parent.pageSettings.pageSize:s.startIndex,s.endIndex=f<this.count?f:this.count,s.startIndex=f>=this.count?s.endIndex-this.parent.pageSettings.pageSize:s.startIndex,s.currentPage=Math.ceil(s.endIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex()}}else if("up"===s.direction&&s.startIndex&&s.endIndex&&c<Math.round((s.startIndex*h+p*h)/h)){var v=Math.round(c+(p>u?p:u+u/4));s.endIndex=v<this.count?v:this.count;var b=s.endIndex-this.parent.pageSettings.pageSize;s.startIndex=b>0?b:0,s.endIndex=b<0?this.parent.pageSettings.pageSize:s.endIndex,s.currentPage=Math.ceil(s.startIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex()}this.preStartIndex=this.startIndex=s.startIndex,this.preEndIndex=s.endIndex,s.event=s.currentPage!==this.parent.pageSettings.currentPage?P:"refresh-virtual-block"}return s}},{key:"setKeyboardNavIndex",value:function(){this.blazorDataLoad=!0,"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())}},{key:"ensureBlocks",value:function(e){var t,i=this,n=e.blockIndexes[e.block],r=n,s=Math.max,a="down"===e.direction?[s(n,1),++n,++n]:[s(n-1,1),n,n+1];return this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===e.sentinelInfo.axis||"Y"===e.sentinelInfo.axis&&e.page===this.prevInfo.page)&&(a=this.prevInfo.blockIndexes),a=a.filter((function(e,t){return a.indexOf(e)===t})),this.prevInfo.blockIndexes.toString()===a.toString()||((e.loadSelf||"down"===e.direction&&this.isEndBlock(r))&&(a=this.vgenerator.getBlockIndexes(e.page)),a.some((function(e,n){var r=e===(Si(i.parent)?i.getGroupedTotalBlocks():i.getTotalBlocks());return r&&(t=n),r})),void 0!==t&&(a=a.slice(0,t+1),0===e.block&&1===a.length&&this.vgenerator.isBlockAvailable(a[0]-1)&&(a=[a[0]-1,a[0]]))),a}},{key:"appendContent",value:function(e,t,i){var n=this,r=this.parent.isFrozenGrid(),s=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),a=this.parent.enableColumnVirtualization&&r;this.checkFirstBlockColIndexes(i);var l=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo;this.prevInfo=this.prevInfo||i.virtualInfo;var o=l.columnIndexes[0]-1;a&&l.columnIndexes[0]===s&&(o=l.columnIndexes[0]-s-1);var h,c=this.getColumnOffset(o),u=l.blockIndexes;this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%");var d,p=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;if(!this.requestTypes.some((function(e){return e===n.requestType}))){var g=this.getTranslateY(this.content.scrollTop,p,l);this.virtualEle.adjustTable(a?0:c,g),a&&this.virtualEle.adjustMovableTable(c,0)}if(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(a?0:c,0),a&&this.header.virtualEle.adjustMovableTable(c,0)),this.parent.enableColumnVirtualization){var f=l.columnIndexes;h=this.getColumnOffset(f[f.length-1])-this.getColumnOffset(f[0]-1)+"",a?this.header.virtualEle.setMovableWrapperWidth(h):this.header.virtualEle.setWrapperWidth(h)}if(a?this.virtualEle.setMovableWrapperWidth(h,m.d.isIE||"edge"===m.d.info.name):this.virtualEle.setWrapperWidth(h,m.d.isIE||"edge"===m.d.info.name),Object(m.X)(e.parentNode)||Object(m.hb)(e),r?i.renderFrozenRightContent?d=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("tbody"):i.renderMovableContent?i.renderMovableContent&&(d=this.parent.getMovableVirtualContent().querySelector("tbody")):d=this.parent.getFrozenVirtualContent().querySelector("tbody"):d=this.parent.element.querySelector(".e-content").querySelector("tbody"),d&&(Object(m.hb)(d),e=null),this.parent.isReact&&!Object(m.X)(this.parent.rowTemplate)?e=t:(e=this.parent.createElement("tbody")).appendChild(t),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(var v=0;v<this.parent.frozenRows;v++)e.children[0].remove();if(r?(i.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table").appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType):i.renderMovableContent?i.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(e),"Left-Right"!==this.parent.getFrozenMode()&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType)):this.parent.getFrozenVirtualContent().querySelector(".e-table").appendChild(e),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=l.columnIndexes=Object(m.K)([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length){if(!Si(this.parent)&&"up"===l.direction){var b=this.offsets[this.getTotalBlocks()]-this.prevHeight;this.preventEvent=!0,this.content.scrollTop=this.content.scrollTop+b}this.setVirtualHeight(),this.observer.setPageHeight(this.getOffset(u[u.length-1])-this.getOffset(u[0]-1))}this.prevInfo=l,this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();var y=Math.ceil(this.getTotalBlocks()/2);this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===y&&1===u.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(X,{}),this.focusCell(i),this.restoreEdit(i),this.restoreAdd(i),this.initialRowTop||(this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top)}},{key:"checkFirstBlockColIndexes",value:function(e){if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===e.virtualInfo.columnIndexes[0]){var t=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount();if(!e.renderMovableContent&&e.virtualInfo.columnIndexes.length>i){this.vfColIndex=e.virtualInfo.columnIndexes;for(var n=0;n<i;n++)t.push(n);e.virtualInfo.columnIndexes=t}else e.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=Object(m.K)([],e.virtualInfo.columnIndexes)),e.virtualInfo.columnIndexes=Object(m.K)([],this.vfColIndex),e.virtualInfo.columnIndexes.splice(0,i))}}},{key:"focusCell",value:function(e){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var t=this.parent.getRowByIndex(this.rowIndex);t.cells[this.cellIndex].focus({preventScroll:!0}),this.parent.selectRow(parseInt(t.getAttribute("aria-rowindex"),10)),this.activeKey=this.empty}}},{key:"restoreEdit",value:function(e){if(this.isNormaledit){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),n=this.parent.getFrozenMode(),r=e&&(t||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&r)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!Object(m.X)(this.editedRowIndex)){var s=this.getRowByIndex(this.editedRowIndex);if(Object.keys(this.virtualData).length&&s&&!this.content.querySelector(".e-editedrow")){var a=s.getBoundingClientRect().top;a<this.content.offsetHeight&&a>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(s))}if(s&&this.content.querySelector(".e-editedrow")&&!Object.keys(this.virtualData).length){var l=Object(m.K)({},this.getRowObjectByIndex(this.editedRowIndex));this.virtualData=this.getVirtualEditedData(l)}}this.restoreAdd(e)}}},{key:"getVirtualEditedData",value:function(e){var t=[].slice.call(this.parent.element.querySelectorAll(".e-gridform")),i=this.parent.isFrozenGrid(),n=this.parent.editModule.getCurrentEditedData(t[0],e);return i&&(2===this.parent.getTablesCount()&&(n=this.parent.editModule.getCurrentEditedData(t[1],e)),3===this.parent.getTablesCount()&&(n=this.parent.editModule.getCurrentEditedData(t[1],e),n=this.parent.editModule.getCurrentEditedData(t[2],e))),n}},{key:"restoreAdd",value:function(e){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),n=this.parent.getFrozenMode();if((!i||i&&e&&(t||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent))&&this.isNormaledit&&this.isAdd&&!this.parent.element.querySelector(".e-addedrow")){var r="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),s="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(r||s)&&(this.parent.isEdit=!1,this.parent.addRecord())}}},{key:"onDataReady",value:function(e){Object(m.X)(e.count)||(this.count=e.count,this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(e.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some((function(t){return e.requestType===t}))&&this.refreshOffsets(),this.setVirtualHeight(),this.resetScrollPosition(e.requestType)}},{key:"setVirtualHeight",value:function(e){var t=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%";if(this.parent.isFrozenGrid()){var i=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2];i=i>this.content.clientHeight?i:0,this.virtualEle.setVirtualHeight(i,t)}else{var n=Object(m.W)()&&this.parent.isServerRendered&&this.parent.groupSettings.columns.length&&e?e:this.offsets[Si(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()];this.virtualEle.setVirtualHeight(n,t)}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,t),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,t),this.header.virtualEle.setMovableVirtualHeight(1,t)))}},{key:"getPageFromTop",value:function(e,t){var i=this,n=Si(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),r=0;return this.offsetKeys.some((function(s){var a=Number(s),l=e<=i.offsets[s]||a===n&&e>i.offsets[s];return l&&(i.offsetKeys.length%2!=0&&a.toString()===i.offsetKeys[i.offsetKeys.length-2]&&e<=i.offsets[i.offsetKeys.length-1]&&(a+=1),t.block=a%2==0?1:0,r=Math.max(1,Math.min(i.vgenerator.getPage(a),i.maxPage))),l})),r}},{key:"getTranslateY",value:function(e,t,i,n){void 0===i&&((i={page:this.getPageFromTop(e,{})}).blockIndexes=this.vgenerator.getBlockIndexes(i.page));var r=(i.blockIndexes[0]||1)-1,s=this.getOffset(r),a=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);n&&(i=this.prevInfo);var l=s>e?this.getOffset(r-1):a<e+t?this.getOffset(r+1):s,o=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]];return l+o>this.offsets[Si(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()]&&(l-=l+o-this.offsets[this.getTotalBlocks()]),l}},{key:"getOffset",value:function(e){return Math.min(0|this.offsets[e],0|this.offsets[this.maxBlock])}},{key:"onEntered",value:function(){var e=this;return function(t,i,n,r,s,a){m.d.isIE&&!s&&a&&!e.preventEvent&&e.parent.showSpinner();var l=e.parent.enableColumnVirtualization&&e.parent.isFrozenGrid(),o="X"===i.axis,h=e.prevInfo.offsets?e.prevInfo.offsets.top:null,c=e.content.getBoundingClientRect().height,u=e.getColumnOffset(o?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1),d=e.getTranslateY(r.top,c,o&&h===r.top?e.prevInfo:void 0,!0);Object(m.W)()&&e.parent.isServerRendered&&e.currentInfo&&e.currentInfo.startIndex&&o&&(d=e.currentInfo.startIndex*e.parent.getRowHeight()),e.virtualEle.adjustTable(l?0:u,Math.min(d,e.offsets[e.maxBlock])),l&&e.virtualEle.adjustMovableTable(u,0),Object(m.W)()&&e.parent.isServerRendered&&o&&e.parent.notify("setcolumnstyles",{refresh:!0}),e.parent.enableColumnVirtualization&&(!Object(m.W)()||Object(m.W)()&&!e.parent.isServerRendered)&&(e.header.virtualEle.adjustTable(l?0:u,0),l&&e.header.virtualEle.adjustMovableTable(u,0))}}},{key:"dataBound",value:function(){this.parent.notify("refresh-virtual-frozen-height",{}),this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):Object(m.W)()||(this.activeKey=this.empty)}},{key:"rowSelected",value:function(e){if(this.isSelection&&!this.isLastBlockRow(e.rowIndex)){var t=(a=this.content.firstElementChild,l=document.defaultView.getComputedStyle(a,null).getPropertyValue("transform").replace(/,/g,""),{width:parseFloat(l.split(" ")[4]),height:parseFloat(l.split(" ")[5])}),i=e.row.getBoundingClientRect().top,n=this.content.getBoundingClientRect().height,r=n<i,s=r?i-n:this.initialRowTop-i;this.virtualEle.adjustTable(t.width,r?t.height-s:t.height+s)}var a,l;this.isSelection=!1}},{key:"isLastBlockRow",value:function(e){var t=this.parent.getContent().firstElementChild,i=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1;return e>=this.maxPage*this.parent.pageSettings.pageSize-i}},{key:"eventListener",value:function(e){var t=this;this.parent[e](T,this.onDataReady,this),this.parent.addEventListener(I,this.dataBound.bind(this)),this.parent.addEventListener(D,this.actionBegin.bind(this)),this.parent.addEventListener(E,this.actionComplete.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelected.bind(this)),this.parent[e]("refresh-virtual-block",this.refreshContentRows,this),this.parent[e]("select-virtual-Row",this.selectVirtualRow,this),this.parent[e]("virtaul-cell-focus",this.virtualCellFocus,this),this.parent[e]("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent[e]("virtual-scroll-add-action-begin",this.addActionBegin,this),this.parent[e]("virtual-scroll-edit",this.restoreEdit,this),this.parent[e]("virtual-scroll-edit-success",this.editSuccess,this),this.parent[e]("refresh-virtual-cache",this.refreshCache,this),this.parent[e]("edit-reset",this.resetIsedit,this),this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("virtual-scroll-edit-cancel",this.editCancel,this);for(var i=this.actions,n=0;n<i.length;n++)this.parent[e](i[n]+"-begin",this.onActionBegin,this);this.parent.on(A,(function e(){t.observer.observe((function(e){return t.scrollListener(e)}),t.onEntered());var i=t.parent;i.enablePersistence&&i.scrollPosition&&(t.content.scrollTop=i.scrollPosition.top,t.scrollListener({direction:"down",sentinel:t.observer.sentinelInfo.down,offset:i.scrollPosition,focusElement:i.element}),i.enableColumnVirtualization&&(t.content.scrollLeft=i.scrollPosition.left)),t.parent.off(A,e)}),this)}},{key:"getVirtualData",value:function(e){e.virtualData=this.virtualData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}},{key:"editCancel",value:function(e){var t=zi(this.parent,e.data);Object(m.X)(t)||(e.data=this.parent.getCurrentViewRecords()[t])}},{key:"editSuccess",value:function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewData(e.data),this.isAdd=!1)}},{key:"updateCurrentViewData",value:function(e){var t=zi(this.parent,e);Object(m.X)(t)||(this.parent.getCurrentViewRecords()[t]=e)}},{key:"actionBegin",value:function(e){"virtualscroll"!==e.requestType&&(this.requestType=e.requestType),e.cancel||this.parent.notify("refresh-virtual-frozenrows",e)}},{key:"virtualCellFocus",value:function(e){var t=document.activeElement;if(t.classList.contains("e-rowcell")&&e&&("upArrow"===e.action||"downArrow"===e.action)){var i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10);if(e&&("downArrow"===e.action||"upArrow"===e.action)){var n=this.parent.getContent().firstElementChild;"downArrow"===e.action?i+=1:i-=1,this.rowIndex=i,this.cellIndex=parseInt(t.getAttribute("aria-colindex"),10);var r=this.parent.getRowByIndex(i),s=this.parent.pageSettings.currentPage,a=Math.floor(n.offsetHeight/this.parent.getRowHeight())-1,l=!1;Object(m.X)(r)&&(l=!0,("downArrow"===e.action&&s===this.maxPage-1||"upArrow"===e.action&&1===s)&&(l=!1)),l||Ti(r,this.parent)&&"downArrow"===e.action||Ai(r,2*this.parent.getRowHeight())&&"upArrow"===e.action?(this.activeKey=e.action,n.scrollTop="downArrow"===e.action?(i-a)*this.parent.getRowHeight():i*this.parent.getRowHeight()):this.activeKey=this.empty,(!Object(m.W)()||Object(m.W)()&&!this.blazorDataLoad)&&this.parent.selectRow(i)}}}},{key:"editActionBegin",value:function(e){this.editedRowIndex=e.index;var t=Object(m.K)({},this.getRowObjectByIndex(e.index));e.data=Object.keys(this.virtualData).length?this.virtualData:t}},{key:"refreshCache",value:function(e){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.vgenerator.cache[t][i].data=e,this.vgenerator.movableCache[t]&&(this.vgenerator.movableCache[t][i].data=e),this.vgenerator.frozenRightCache[t]&&(this.vgenerator.frozenRightCache[t][i].data=e)}},{key:"actionComplete",value:function(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.refreshOffsets(),this.refreshVirtualElement(),this.isNormaledit&&("cancel"===e.requestType&&(this.isCancel=!0),this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule.previousVirtualData={})),this.parent.enableColumnVirtualization&&"filterafteropen"===e.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(e.columnName)}},{key:"resetIsedit",value:function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)}},{key:"scrollAfterEdit",value:function(){if(this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")){var e=this.parent.element.querySelector(".e-editedrow"),t=this.parent.element.querySelector(".e-addedrow");if(e||t){var i=e?Object(m.K)({},this.getRowObjectByIndex(this.editedRowIndex)):Object(m.K)({},this.emptyRowData);this.virtualData=this.getVirtualEditedData(i)}}}},{key:"createEmptyRowdata",value:function(){var e=this;this.parent.getColumns().filter((function(t){e.emptyRowData[t.field]=e.empty}))}},{key:"addActionBegin",value:function(e){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.isAdd=!0;var t=this.parent.pageSettings.currentPage;t>1&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),e.startEdit=!1,this.content.scrollTop=0),t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),e.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}}},{key:"getRowObjectByIndex",value:function(e){return this.getRowCollection(e,!1,!0)}},{key:"getBlockSize",value:function(){return this.parent.pageSettings.pageSize>>1}},{key:"getBlockHeight",value:function(){return this.getBlockSize()*this.parent.getRowHeight()}},{key:"isEndBlock",value:function(e){var t=this.getTotalBlocks();return e>=t||e===t-1}},{key:"getGroupedTotalBlocks",value:function(){var e=this.parent.vcRows;return Math.floor(e.length/this.getBlockSize()<1?1:e.length/this.getBlockSize())}},{key:"getTotalBlocks",value:function(){return Math.ceil(this.count/this.getBlockSize())}},{key:"getColumnOffset",value:function(e){return 0|this.vgenerator.cOffsets[e]}},{key:"getModelGenerator",value:function(){return new En(this.parent)}},{key:"resetScrollPosition",value:function(e){this.actions.some((function(t){return t===e}))&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0),"virtualscroll"!==e&&(this.isAdd=!1)}},{key:"onActionBegin",value:function(e){this.parent.setProperties({pageSettings:{currentPage:1}},!0)}},{key:"getRows",value:function(){return this.vgenerator.getRows()}},{key:"getRowByIndex",value:function(e){return Si(this.parent)?this.parent.getDataRows()[e]:this.getRowCollection(e,!1)}},{key:"getMovableVirtualRowByIndex",value:function(e){return this.getRowCollection(e,!0)}},{key:"getFrozenRightVirtualRowByIndex",value:function(e){return this.getRowCollection(e,!1,!1,!0)}},{key:"getRowCollection",value:function(e,t,i,n){var r=this.prevInfo.blockIndexes,s=!Object(m.W)()||Object(m.W)()&&!this.parent.isServerRendered?(r[0]-1)*this.getBlockSize():this.startIndex,a=t?this.parent.getMovableDataRows():this.parent.getDataRows();a=n?this.parent.getFrozenRightDataRows():a;var l=(i?this.parent.getCurrentViewRecords():a)[e-s];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(l=i?e<=this.parent.frozenRows?this.parent.getRowsObject()[e].data:l:e<=this.parent.frozenRows?a[e]:a[e-s+this.parent.frozenRows]),l}},{key:"getVirtualRowIndex",value:function(e){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+e}},{key:"refreshOffsets",value:function(){var e=this.parent,t=0,i=this.getBlockSize(),n=Si(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();this.prevHeight=this.offsets[n],this.maxBlock=n%2==0?n-2:n-1,this.offsets={};for(var r=Array.apply(null,Array(n)).map((function(){return++t})),s=0;s<r.length;s++){var a=(this.vgenerator.cache[r[s]]||[]).length,l=Si(this.parent)?e.vcRows.length%i:this.count%i,o=!Si(this.parent)&&r[s]in this.vgenerator.cache?a*this.parent.getRowHeight():l&&r[s]===n?l*this.parent.getRowHeight():this.getBlockHeight();this.offsets[r[s]]=(0|this.offsets[r[s]-1])+o,this.tmpOffsets[r[s]]=0|this.offsets[r[s]-1]}this.offsetKeys=Object.keys(this.offsets),Si(this.parent)&&(this.parent.vGroupOffsets=this.offsets),this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()}},{key:"refreshVirtualElement",value:function(){this.vgenerator.refreshColOffsets(),this.setVirtualHeight()}},{key:"setVisible",value:function(e){var t,i,n=this.parent,r=this.parent.getFrozenColumns();r&&(t=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),i=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col"))),Object(m.W)()&&n.isServerRendered&&this.parent.notify("setvisibility",e);var s,a=[];(a=this.getRows()).some((function(e){return e.isDataRow&&(s=e),e.isDataRow}));var l=!0;!n.groupSettings.columns.length&&s&&(l=!1);for(var o=n.getDataRows(),h=0,c=e.length;h<c;h++){var u=void 0,d=e[h],p=n.getNormalizedColumnIndex(d.uid),g=!0===d.visible?"":"none";if(t&&i?p>=r?(u=i,o=this.parent.getMovableRows(),p-=r):u=t:u=this.getColGroup().children,-1!==p&&s&&p<s.cells.length&&Object(m.ob)(u[p],{display:g}),!l){var f;(f=d.visible?this.virtualEle.wrapper.offsetWidth+parseInt(d.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(d.width.toString(),10))>n.width?(this.setDisplayNone(o,p,g,a),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(f+""),this.refreshVirtualElement()):l=!0}!this.parent.invokedFromMedia&&d.hideAtMedia&&this.parent.updateMediaColumns(d),this.parent.invokedFromMedia=!1}if(Object(m.W)()&&this.parent.isServerRendered&&l){var v=this.parent.inViewIndexes,b=this.getColumnOffset(v[0]-1),y=this.getColumnOffset(v[v.length-1])-b+"";this.parent.notify("refresh-virtual-indices",{requestType:"virtualScrollRefresh",startColumnIndex:v[0],endColumnIndex:v[v.length-1],axis:"X",VTablewidth:y,translateX:b}),this.parent.notify("setcolumnstyles",{})}l||r?this.refreshContentRows({requestType:"refresh"}):this.parent.notify("partial-refresh",{rows:a,args:{isFrozen:!1,rows:a}})}},{key:"selectVirtualRow",value:function(e){var t=this;if("upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.requestTypes.some((function(e){return e===t.requestType}))&&!this.parent.selectionModule.isInteracted){var i=this.parent.getRowByIndex(e.selectedIndex),n=this.parent.getRowHeight();if(!i||!this.isRowInView(i)){this.isSelection=!0,this.selectedRowIndex=e.selectedIndex;var r=(e.selectedIndex+1)*n;Object(m.X)(r)||(this.content.scrollTop=r)}}this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty}},{key:"isRowInView",value:function(e){var t=e.getBoundingClientRect().top;return t>=this.initialRowTop&&t<=this.content.offsetHeight}}]),r}(re),Mn=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).virtualEle=new Fn,n.isMovable=!1,n.gen=new En(n.parent),n.parent.on("column-visible-changed",n.setVisible,l(n)),n.parent.on("refresh-virtual-block",(function(e){return"X"===e.virtualInfo.sentinelInfo.axis?n.refreshUI():null}),l(n)),n}return f(r,[{key:"renderTable",value:function(){this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),Object(m.W)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{startColumnIndex:this.parent.contentModule.startColIndex,endColumnIndex:this.parent.contentModule.endColIndex,axis:"X"}),i(o(r.prototype),"renderTable",this).call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.getPanel().querySelector(".e-headercontent"),this.virtualEle.content.style.position="relative",this.virtualEle.renderWrapper(),this.virtualEle.renderPlaceHolder("absolute")}},{key:"appendContent",value:function(e){this.isMovable?(this.virtualEle.movableWrapper.appendChild(e),this.isMovable=!1):this.virtualEle.wrapper.appendChild(e)}},{key:"refreshUI",value:function(){this.isMovable=this.parent.isFrozenGrid(),this.setFrozenTable(this.parent.getMovableVirtualContent()),this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),i(o(r.prototype),"refreshUI",this).call(this),this.setFrozenTable(this.parent.getFrozenVirtualContent())}},{key:"setVisible",value:function(e){var t,i,n,r,s,a=this.parent,l=this.parent.getFrozenColumns();l&&(r=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),s=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col")));for(var o=0,h=e.length;o<h;o++){var c=void 0,u=e[o];if(i=a.getNormalizedColumnIndex(u.uid),t=u.visible?"":"none",r&&s?i>=l?(c=s,i-=l):c=r:c=this.getColGroup().children,Object(m.ob)(c[i],{display:t}),a.enableColumnVirtualization&&!a.groupSettings.columns.length){var d;(d=u.visible?this.virtualEle.wrapper.offsetWidth+parseInt(u.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(u.width.toString(),10))>a.width?(this.setDisplayNone(u,t),this.virtualEle.setWrapperWidth(d+""),this.gen.refreshColOffsets()):n=!0}else n=!0;n&&!l&&this.refreshUI()}l&&this.parent.notify("column-position-changed",{})}},{key:"setFrozenTable",value:function(e){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(e.querySelector(".e-table"))}},{key:"setDisplayNone",value:function(e,t){var i=this.parent.isFrozenGrid(),n=this.getTable();i&&"movable"===e.getFreezeTableName()&&(n=this.parent.getMovableVirtualHeader().querySelector(".e-table"));var r,s=c([].slice.apply(n.querySelectorAll("th.e-headercell")));try{for(s.s();!(r=s.n()).done;){var a=r.value;if(a.querySelector("[e-mappinguid]")&&a.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===e.uid){Object(m.ob)(a,{display:t}),""===t&&Object(m.ib)([a],"e-hide");break}}}catch(l){s.e(l)}finally{s.f()}}}]),r}(se),Fn=function(){function e(){p(this,e)}return f(e,[{key:"renderWrapper",value:function(e){Object(m.W)()?(this.wrapper=this.content.querySelector(".e-virtualtable")?this.content.querySelector(".e-virtualtable"):Object(m.F)("div",{className:"e-virtualtable"}),this.wrapper.setAttribute("styles","min-height:"+Object(m.L)(e))):this.wrapper=Object(m.F)("div",{className:"e-virtualtable",styles:"min-height:"+Object(m.L)(e)}),this.wrapper.appendChild(this.table),this.content.appendChild(this.wrapper)}},{key:"renderPlaceHolder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"relative";Object(m.W)()?(this.placeholder=this.content.querySelector(".e-virtualtrack")?this.content.querySelector(".e-virtualtrack"):Object(m.F)("div",{className:"e-virtualtrack"}),this.placeholder.setAttribute("styles","position:"+e)):this.placeholder=Object(m.F)("div",{className:"e-virtualtrack",styles:"position:"+e}),this.content.appendChild(this.placeholder)}},{key:"renderFrozenWrapper",value:function(e){this.wrapper=Object(m.F)("div",{className:"e-virtualtable",styles:"min-height:".concat(Object(m.L)(e),"; display: flex")}),this.content.appendChild(this.wrapper)}},{key:"renderFrozenPlaceHolder",value:function(){this.placeholder=Object(m.F)("div",{className:"e-virtualtrack"}),this.content.appendChild(this.placeholder)}},{key:"renderMovableWrapper",value:function(e){this.movableWrapper=Object(m.F)("div",{className:"e-virtualtable",styles:"min-height:"+Object(m.L)(e)}),this.movableContent.appendChild(this.movableWrapper)}},{key:"renderMovablePlaceHolder",value:function(){this.movablePlaceholder=Object(m.F)("div",{className:"e-virtualtrack"}),this.movableContent.appendChild(this.movablePlaceholder)}},{key:"adjustTable",value:function(e,t){this.wrapper.style.transform="translate(".concat(e,"px, ").concat(t,"px)")}},{key:"adjustMovableTable",value:function(e,t){this.movableWrapper.style.transform="translate(".concat(e,"px, ").concat(t,"px)")}},{key:"setMovableWrapperWidth",value:function(e,t){this.movableWrapper.style.width=e?e+"px":t?"100%":""}},{key:"setMovableVirtualHeight",value:function(e,t){this.movablePlaceholder.style.height=e+"px",this.movablePlaceholder.style.width=t}},{key:"setWrapperWidth",value:function(e,t){this.wrapper.style.width=e?e+"px":t?"100%":""}},{key:"setVirtualHeight",value:function(e,t){this.placeholder.style.height=e+"px",this.placeholder.style.width=t}},{key:"setFreezeWrapperWidth",value:function(e,t,i){e.style.width=t?t+"px":i?"100%":""}}]),e}(),Tn=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"addNew",value:function(e,t){var i;this.isEdit=!1;var n=Ji(this.parent),r=Zi(this.parent);if(i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderTable().querySelector("tbody"):this.parent.getContentTable().querySelector("tbody"),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),i.querySelector(".e-emptyrow")){var s=i.querySelector(".e-emptyrow");if(s.parentNode.removeChild(s),this.parent.isFrozenGrid()){var a=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody");if(a.firstElementChild.parentNode.removeChild(a.firstElementChild),"Left-Right"===this.parent.getFrozenMode()){var l=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");l.firstElementChild.parentNode.removeChild(l.firstElementChild)}}}if("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(e,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),this.parent.isFrozenGrid()){var o=this.renderMovableform(t.row,t);if("Top"===this.parent.editSettings.newRowPosition?n.insertBefore(o,n.firstChild):n.appendChild(o),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),o.setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),r){var h=this.renderFrozenRightForm(t.row,t);"Top"===this.parent.editSettings.newRowPosition?r.insertBefore(h,r.firstChild):r.appendChild(h);var c=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount();t.row.querySelector(".e-normaledit").setAttribute("colspan",c+""),h.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())}"auto"===this.parent.height&&this.parent.notify("frozenHeight",{})}}},{key:"renderFrozenRightForm",value:function(e,t){var i=e.cloneNode(!0),n=t.frozenRightForm=i.querySelector("form");return this.parent.editSettings.template?(n.innerHTML="",this.appendChildren(n,t.rowData,!1),i):(this.renderRightFrozen(e,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").innerHTML,i)}},{key:"renderMovableform",value:function(e,t){var i=e.cloneNode(!0),n=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(n.innerHTML="",this.appendChildren(n,t.rowData,!1),i):(this.renderMovable(e,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,i)}},{key:"updateFreezeEdit",value:function(e,t){return t=t.concat([].slice.call(this.getFreezeRow(e).querySelectorAll("td.e-rowcell"))),"Left-Right"===this.parent.getFrozenMode()&&(t=t.concat([].slice.call(this.getFreezeRightRow(e).querySelectorAll("td.e-rowcell")))),t}},{key:"getFreezeRightRow",value:function(e){var t=parseInt(e.getAttribute("aria-rowindex"),10),i=this.parent.getFrozenLeftContentTbody(),n=this.parent.getFrozenHeaderTbody(),r=this.parent.getFrozenRightHeaderTbody(),s=this.parent.getFrozenRightContentTbody();return i.contains(e)||n.contains(e)?this.parent.getFrozenRightRowByIndex(t):s.contains(e)||r.contains(e)?this.parent.getRowByIndex(t):e}},{key:"getFreezeRow",value:function(e){if(this.parent.isFrozenGrid()){var t=parseInt(e.getAttribute("aria-rowindex"),10),i=this.parent.getFrozenLeftContentTbody(),n=this.parent.getMovableContentTbody(),r=this.parent.getFrozenHeaderTbody(),s=this.parent.getMovableHeaderTbody();if(i.contains(e)||r.contains(e))return this.parent.getMovableRowByIndex(t);if(n.contains(e)||s.contains(e))return this.parent.getRowByIndex(t)}return e}},{key:"update",value:function(e,t){if(this.isEdit=!0,(Object(m.C)(t.row,".e-movablecontent")||Object(m.C)(t.row,".e-movableheader"))&&(t.row=this.getFreezeRow(t.row),Object(m.W)()&&this.parent.isServerRendered&&(t.cloneRow=t.row.cloneNode(!0))),(Object(m.C)(t.row,".e-frozen-right-content")||Object(m.C)(t.row,".e-frozen-right-header"))&&(t.row=this.getFreezeRightRow(t.row)),Object(m.W)()&&this.parent.isServerRendered){t.row.parentNode.insertBefore(t.cloneRow,t.row),t.row.classList.add("e-hiddenrow");var i=[].slice.call(t.cloneRow.querySelectorAll("td.e-rowcell"));t.cloneRow.innerHTML="",i=this.updateFreezeEdit(t.cloneRow,i),t.cloneRow.appendChild(this.getEditElement(e,!0,i,t,!0)),t.cloneRow.classList.add("e-editedrow"),this.refreshFreezeEdit(t.cloneRow,t)}else{var n=[].slice.call(t.row.querySelectorAll("td.e-rowcell"));t.row.innerHTML="",n=this.updateFreezeEdit(t.row,n),t.row.appendChild(this.getEditElement(e,!0,n,t,!0)),t.row.classList.add("e-editedrow"),this.parent.editModule.checkLastRow(t.row,t),this.refreshFreezeEdit(t.row,t)}}},{key:"refreshFreezeEdit",value:function(e,t){var i,n,r=e.firstChild;this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(r.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("colgroup").innerHTML);var s=parseInt(e.getAttribute("aria-rowindex"),10);if(this.parent.isFrozenGrid()){s<this.parent.frozenRows?(n=this.parent.getHeaderContent(),i=".e-frozenheader"):(n=this.parent.getContent(),i=".e-frozencontent");var a,l,o=r.cloneNode(!0),h=r.cloneNode(!0),c=t.movableForm=o.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(c,t.rowData),n.querySelector(i).contains(e)?(a=this.parent.getMovableRowByIndex(s),Object(m.W)()&&this.parent.isServerRendered?(t.frozen=a,t.cloneFrozen=a.cloneNode(!0),a.classList.add("e-hiddenrow"),a.parentNode.insertBefore(t.cloneFrozen,a),this.updateFrozenCont(t.cloneFrozen,r,o)):(this.updateFrozenCont(a,r,o),"Left-Right"===this.parent.getFrozenMode()&&(t.frozenRightForm=h.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),l=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(l,r,h)))):(a=this.parent.getRowByIndex(s),Object(m.W)()&&this.parent.isServerRendered?(t.frozen=a,t.cloneFrozen=a.cloneNode(!0),a.parentNode.insertBefore(t.cloneFrozen,a),a.classList.add("e-hiddenrow"),this.updateFrozenCont(t.cloneFrozen,o,r)):(this.updateFrozenCont(a,o,r),"Left-Right"===this.parent.getFrozenMode()&&(t.frozenRightForm=h.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),l=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(l,h,r)))),Object(m.W)()&&this.parent.isServerRendered?(t.cloneFrozen.appendChild(o),t.cloneFrozen.classList.add("e-editedrow")):(a.appendChild(o),a.classList.add("e-editedrow"),"Left-Right"===this.parent.getFrozenMode()&&(l.appendChild(h),l.classList.add("e-editedrow"),Fi(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)")))),Fi(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}}},{key:"refreshEditForm",value:function(e,t){this.parent.editSettings.template&&(e.innerHTML="",this.appendChildren(e,t,!1))}},{key:"updateFrozenRightCont",value:function(e,t,i){e.innerHTML="",this.renderRightFrozen(t,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup").innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+""),i.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")}},{key:"updateFrozenCont",value:function(e,t,i){e.innerHTML="",this.renderMovable(t,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),i.setAttribute("colspan",this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns()+"")}},{key:"renderRightFrozen",value:function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),n=0,r=0;r<i.length;r++,n++)if("frozen-right"===i[r].getFreezeTableName()){var s=n-this.parent.getMovableColumnsCount();t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[s])),n--}}},{key:"renderMovable",value:function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),n=0,r=0;r<i.length;r++,n++)"movable"===i[r].getFreezeTableName()&&(t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[n])),n--)}},{key:"getEditElement",value:function(e,t,i,n,r){var s=this.parent,a=0,l=Object(m.X)(s.detailTemplate)&&Object(m.X)(s.childGrid)?0:1;s.allowGrouping&&(a=s.groupSettings.columns.length);var o=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(s.getVisibleColumns().length-s.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),h=n.form=this.parent.createElement("form",{id:s.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(h,n.rowData,r),o.appendChild(h),o;var c=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25"}});c.appendChild(s.getContentTable().querySelector("colgroup").cloneNode(!0));var u=this.parent.createElement("tbody"),d=this.parent.createElement("tr"),p=0;for(l&&d.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),d.firstChild),s.isRowDragable()&&d.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));p<a;)d.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),p++;var g=0;for(p=0;t&&g<i.length&&p<s.getColumns().length||p<s.getColumns().length;){var f=t?i[g].getAttribute("colspan"):null,v=s.getColumns()[p],b=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(v.textAlign?v.textAlign:""),colspan:f||""}});v.visible?(b.appendChild(e[v.uid]),"booleanedit"===v.editType?b.classList.add("e-boolcell"):(v.commands||v.commandsTemplate)&&Object(m.v)([b],"e-unboundcell")):b.classList.add("e-hide"),d.appendChild(b),p=f?p+parseInt(f,10):p+1,g++}return u.appendChild(d),c.appendChild(u),h.appendChild(c),o.appendChild(h),o}},{key:"removeEventListener",value:function(){}},{key:"appendChildren",value:function(e,t,i){var n=this,r=Object(m.K)({},t,{isAdd:!this.isEdit,isFrozen:i},!0),s=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(r,this.parent,"editSettingsTemplate",s,null,null,e),this.parent.renderTemplates()):Jt(e,this.parent.getEditTemplate()(r,this.parent,"editSettingsTemplate",s)),Object(m.sb)(s,"Template",this.parent.editSettings,!0,(function(){for(var e=n.parent.getColumns(),t=0;t<e.length;t++)e[t].validationRules&&(n.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)}))}}]),e}(),An=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"update",value:function(e,t){if(Object(m.W)()&&this.parent.isServerRendered){t.cloneCell.innerHTML="",t.cloneCell.appendChild(this.getEditElement(e,t)),t.cloneCell.classList.remove("e-ellipsistooltip"),t.cloneCell.classList.add("e-editedbatchcell"),Object(m.A)(t.row,["e-editedrow","e-batchrow"],[])}else t.cell.innerHTML="",t.cell.appendChild(this.getEditElement(e,t)),t.cell.classList.remove("e-ellipsistooltip"),t.cell.classList.add("e-editedbatchcell"),Object(m.A)(t.row,["e-editedrow","e-batchrow"],[])}},{key:"getEditElement",value:function(e,t){var i=this.parent.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-gridform"});return i.appendChild(e[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),i}},{key:"removeEventListener",value:function(){}}]),e}(),zn=function(){function e(t,i){p(this,e),this.parent=t,this.serviceLocator=i,this.parent.isDestroyed||(this.parent.on("dialog-destroy",this.destroy,this),this.parent.on(N,this.destroy,this))}return f(e,[{key:"setLocaleObj",value:function(){this.l10n=this.serviceLocator.getService("localization")}},{key:"addNew",value:function(e,t){this.isEdit=!1,this.createDialog(e,t)}},{key:"update",value:function(e,t){this.isEdit=!0,this.createDialog(e,t)}},{key:"createDialog",value:function(e,t){var i=this.parent;this.dialog=this.parent.createElement("div",{id:i.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),this.dialog.setAttribute("aria-label","Dialog edit"),i.element.appendChild(this.dialog),this.setLocaleObj(),this.dialogObj=new b.a(Object(m.K)({header:i.editSettings.headerTemplate?this.getDialogEditTemplateElement("HeaderTemplate",t):this.isEdit?this.l10n.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle"),isModal:!0,visible:!0,cssClass:"e-edit-dialog",content:this.getEditElement(e,t),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),closeOnEscape:!0,width:i.editSettings.template?"auto":"330px",target:t.target?t.target:document.body,animationSettings:{effect:"None"},footerTemplate:i.editSettings.footerTemplate?this.getDialogEditTemplateElement("FooterTemplate",t):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},i.editSettings.dialog&&i.editSettings.dialog.params||{})),Object(m.W)()?this.dialogObj.locale=this.parent.locale:t.dialog=this.dialogObj,this.dialogObj.isStringTemplate=!0,this.dialogObj.appendTo(this.dialog),Mi(this.parent.element,this.dialogObj.element.parentElement)}},{key:"btnClick",value:function(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()}},{key:"dialogClose",value:function(){this.parent.closeEdit()}},{key:"destroy",value:function(e){for(var t=["template","headerTemplate","footerTemplate"],i=0;i<t.length;i++)if(this.parent.editSettings[t[i]]){var n=t[i].charAt(0).toUpperCase()+t[i].slice(1),r=this.parent.element.id+"editSettings"+n;Object(m.sb)(r,n,this.parent.editSettings)}this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.parent.notify(W,{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),Object(m.hb)(this.dialog))}},{key:"getDialogEditTemplateElement",value:function(e,t){var i=this.parent.createElement("div",{className:"e-dialog"+e}),n=Object(m.K)({},t.rowData,{isAdd:!this.isEdit},!0),r=this.parent.element.id+"editSettings"+e;return Jt(i,("HeaderTemplate"===e?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(n,this.parent,"editSettings"+e,r)),Object(m.sb)(r,e,this.parent.editSettings),i}},{key:"getEditElement",value:function(e,t){var i=this,n=this.parent,r=this.parent.createElement("div",{className:this.isEdit?"e-editedrow":"e-insertedrow"}),s=t.form=this.parent.createElement("form",{id:n.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){var a=this.parent.element.id+"editSettingsTemplate",l=Object(m.K)({},t.rowData,{isAdd:!this.isEdit},!0);this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(l,this.parent,"editSettingsTemplate",a,null,null,s),this.parent.renderTemplates()):Jt(s,this.parent.getEditTemplate()(l,this.parent,"editSettingsTemplate",a));return Object(m.sb)(a,"Template",this.parent.editSettings,!0,(function(){for(var e=i.parent.getColumns(),t=0;t<e.length;t++)e[t].validationRules&&(i.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)})),r.appendChild(s),r}for(var o=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"6px"}}),h=this.parent.createElement("tbody"),c=n.getColumns(),u=0;u<c.length;u++)if(!(this.parent.editModule.checkColumnIsGrouped(c[u])||c[u].commands||c[u].commandsTemplate||"checkbox"===c[u].type)){var d=this.parent.createElement("tr"),p=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});this.parent.createElement("label",{innerHTML:c[u].field}),e[c[u].uid].classList.remove("e-input"),p.appendChild(e[c[u].uid]),d.appendChild(p),h.appendChild(d)}return o.appendChild(h),s.appendChild(o),r.appendChild(s),r}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("dialog-destroy",this.destroy),this.parent.off(N,this.destroy))}}]),e}(),Ln=function(){function e(t,i){p(this,e),this.editType={Inline:Tn,Normal:Tn,Batch:An,Dialog:zn},this.parent=t,this.serviceLocator=i,this.renderer=new this.editType[this.parent.editSettings.mode](t,i),this.focus=i.getService("focus")}return f(e,[{key:"addNew",value:function(e){this.renderer.addNew(this.getEditElements(e),e),this.convertWidget(e)}},{key:"update",value:function(e){this.renderer.update(this.getEditElements(e),e),this.parent.notify("edit-form",e),this.convertWidget(e)}},{key:"convertWidget",value:function(e){var t,i,n,r,s=this.parent,a=s.isFrozenGrid(),l="Right"===s.getFrozenMode()&&"Normal"===s.editSettings.mode?1:0,o="Dialog"===s.editSettings.mode?Object(m.lb)("#"+s.element.id+"_dialogEdit_wrapper .e-gridform",document):s.element.querySelectorAll(".e-gridform")[l];if(a&&"Normal"===s.editSettings.mode){var h=parseInt(e.row.getAttribute("aria-rowindex"),10);s.frozenRows&&("add"===e.requestType&&"Top"===s.editSettings.newRowPosition||h<s.frozenRows)?(n=s.element.querySelector(".e-movableheader").querySelector(".e-gridform"),"Left-Right"===this.parent.getFrozenMode()&&(r=e.frozenRightForm)):(n=s.element.querySelector(".e-movablecontent").querySelector(".e-gridform"),"Left-Right"===this.parent.getFrozenMode()&&(r=e.frozenRightForm))}var u,d=c("Batch"!==s.editSettings.mode?s.getColumns():[s.getColumnByField(e.columnName)]);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(!this.parent.editSettings.template||Object(m.X)(p.field)){if(!this.parent.editModule.checkColumnIsGrouped(p)&&!p.commands){p.valueAccessor(p.field,e.rowData,p),i="movable"===p.getFreezeTableName()&&"Normal"===s.editSettings.mode?n.querySelector("[e-mappinguid="+p.uid+"]"):r&&"frozen-right"===p.getFreezeTableName()&&"Normal"===s.editSettings.mode?r.querySelector("[e-mappinguid="+p.uid+"]"):o.querySelector("[e-mappinguid="+p.uid+"]");var g=p.edit.write;Object(m.X)(i)||("string"==typeof g?(g=Oi(g,window))({rowData:e.rowData,element:i,column:p,requestType:e.requestType,row:e.row,foreignKeyData:p.isForeignColumn()&&Oi(p.field,e.foreignKeyData)}):p.edit.write({rowData:e.rowData,element:i,column:p,requestType:e.requestType,row:e.row,foreignKeyData:p.isForeignColumn()&&Oi(p.field,e.foreignKeyData)}),t||i.getAttribute("disabled")||(this.focusElement(i,e.type),t=!0))}}else{var f=Object(m.K)({},e);f.element=o.querySelector("[name="+si(p.field)+"]"),Object(m.X)(f.element)&&a&&(f.element=n.querySelector("[name="+si(p.field)+"]")),"string"==typeof p.edit.write?Oi(p.edit.write,window)(f):p.edit.write(f)}}}catch(y){d.e(y)}finally{d.f()}if(a&&!this.parent.allowTextWrap&&("add"===e.requestType||"beginEdit"===e.requestType)&&"Dialog"!==this.parent.editSettings.mode&&!Object(m.X)(o)&&!Object(m.X)(n)){var v=n.querySelector("tr").children[0],b=o.querySelector("tr").children[0];b.offsetHeight>v.offsetHeight?(v.style.height=b.offsetHeight+"px",r&&(n.querySelector("tr").children[0].style.height=b.offsetHeight+"px")):(b.style.height=v.offsetHeight+"px",r&&(n.querySelector("tr").children[0].style.height=v.offsetHeight+"px"))}}},{key:"focusElement",value:function(e,t){var i=this.parent.element.querySelector(".e-edit-checkselect");Object(m.X)(i)||i.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode?this.focus.onClick({target:Object(m.C)(e,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&Wt(e,"e-addedrow")?e.focus():e.focus({preventScroll:!0}),e.classList.contains("e-defaultcell")&&e.setSelectionRange(e.value.length,e.value.length)}},{key:"getEditElements",value:function(e){var t=this,i=this.parent,n={},r="Batch"!==i.editSettings.mode?i.getColumns():[i.getColumnByField(e.columnName)];if(this.parent.editSettings.template)return{};for(var s=0,a=r.length;s<a;s++){var l=r[s];if(!this.parent.editModule.checkColumnIsGrouped(l))if(l.commands||l.commandsTemplate){var o=this.serviceLocator.getService("cellRendererFactory"),h=new $(this.parent),c=o.getCellRenderer(K.CommandColumn),u=h.generateRows(e.rowData)[0].cells.filter((function(e){return e.rowID})),d=c.render(u[s],e.rowData,{index:e.row?e.row.getAttribute("aria-rowindex"):0}),p=d.firstElementChild;p.setAttribute("textAlign",d.getAttribute("textAlign")),n[l.uid]=p}else{var g=void 0,f=l.valueAccessor(l.field,e.rowData,l),v={column:l,value:f,type:e.requestType,data:e.rowData},b=l.edit.create;if(l.editTemplate){g=this.parent.createElement("span",{attrs:{"e-mappinguid":l.uid}});var y=this.parent.element.id+l.uid+"editTemplate",C=Ri({},e.rowData,{column:l});if(this.parent.isReact&&"string"!=typeof l.editTemplate?(l.getEditTemplate()(Object(m.K)({index:e.rowIndex},C),this.parent,"editTemplate",y,null,null,g),this.parent.renderTemplates()):Jt(g,l.getEditTemplate()(Object(m.K)({index:e.rowIndex},C),this.parent,"editTemplate",y)),Object(m.W)()){Object(m.sb)(y,"EditTemplate",l,!0,function(e){var i=e;return function(){t.parent.editModule.formObj.rules[i.field]=i.validationRules}}(l))}}else{if("string"==typeof b?g=(b=Oi(b,window))(v):g=l.edit.create(v),"string"==typeof g){var w=this.parent.createElement("div");w.innerHTML=g,g=w.firstChild}var k="input"!==g.tagName&&g.querySelectorAll("input").length,S=si(l.field);Object(m.x)(k?g.querySelector("input"):g,{name:S,"e-mappinguid":l.uid,id:i.element.id+S}),Object(m.A)(g,["e-input","e-field"],[]),"Right"===l.textAlign&&g.classList.add("e-ralign"),((l.isPrimaryKey||l.isIdentity)&&"beginEdit"===e.requestType||l.isIdentity&&"add"===e.requestType)&&g.setAttribute("disabled","")}n[l.uid]=g}}return n}},{key:"destroy",value:function(){this.renderer.removeEventListener()}}]),e}(),Bn=function(){function e(t){p(this,e),this.activeClasses=["e-selectionbackground","e-active"],this.parent=t}return f(e,[{key:"create",value:function(e){var t=e.column,i="e-field e-boolcell";"checkbox"===t.type&&(i="e-field e-boolcell e-edit-checkselect");var n=si(e.column.field);return this.parent.createElement("input",{className:i,attrs:{type:"checkbox",value:e.value,"e-mappinguid":t.uid,id:this.parent.element.id+n,name:n}})}},{key:"read",value:function(e){return e.checked}},{key:"write",value:function(e){var t,i;if("add"===e.requestType||e.row.classList.contains("e-addedrow"),Object(m.X)(e.row)||(t=e.row.querySelector(".e-edit-checkselect")),Oi(e.column.field,e.rowData)&&(i=JSON.parse(Oi(e.column.field,e.rowData).toString().toLowerCase())),!Object(m.X)(t)&&"checkbox"===e.column.type){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var n=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));i=!!n&&n.isSelected}ui.apply(void 0,[[].slice.call(e.row.querySelectorAll(".e-rowcell")),i].concat(h(this.activeClasses)))}this.obj=new y.b(Object(m.K)({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:i,disabled:!li(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,change:this.checkBoxChange.bind(this)},e.column.edit.params)),Object(m.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element)}},{key:"checkBoxChange",value:function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),ui.apply(void 0,[[].slice.call(this.editRow.querySelectorAll(".e-rowcell")),t].concat(h(this.activeClasses)))}}},{key:"destroy",value:function(){this.obj&&this.obj.destroy()}}]),e}(),Pn=function(){function e(t){p(this,e),this.parent=t,this.flag=!1}return f(e,[{key:"create",value:function(e){var t=si(e.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":e.column.uid}})}},{key:"write",value:function(e){this.column=e.column;var t="Dialog"!==this.parent.editSettings.mode,i=new v.f(e.column.field,"notequal",null,!0,!1);this.obj=new w.d(Object(m.K)({dataSource:this.parent.dataSource instanceof v.a?this.parent.dataSource:new v.a(this.parent.dataSource),query:(new v.g).where(i).select(e.column.field),enabled:li(e.column,e.requestType,e.element),fields:{value:e.column.field},value:Oi(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.ddActionComplete.bind(this),created:this.dropdownCreated.bind(this),placeholder:t?"":e.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always",open:this.dropDownOpen.bind(this),sortOrder:"Ascending"},e.column.edit.params)),this.obj.query.params=this.parent.query.params,Object(m.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element),e.element.setAttribute("name",si(e.column.field))}},{key:"read",value:function(e){return e.ej2_instances[0].value}},{key:"dropdownCreated",value:function(e){this.flag=!0}},{key:"ddActionComplete",value:function(e){e.result=v.b.distinct(e.result,this.obj.fields.value,!0),this.flag&&this.column.dataSource&&("result"in this.column.dataSource?this.column.dataSource.result=e.result:this.column.dataSource instanceof v.a&&(this.column.dataSource.dataSource.json=e.result)),this.flag=!1}},{key:"dropDownOpen",value:function(e){var t=Wt(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!Object(m.X)(t)){var i=Object(m.lb)("#"+t.id,document).ej2_instances[0];e.popup.element.style.zIndex=(i.zIndex+1).toString()}}},{key:"destroy",value:function(){this.obj&&this.obj.destroy()}}]),e}(),qn=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"keyEventHandler",value:function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}}},{key:"create",value:function(e){var t=si(e.column.field);return this.instances=new m.n(this.parent.locale),this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,"e-mappinguid":e.column.uid}})}},{key:"read",value:function(e){return this.obj.value}},{key:"write",value:function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new C.e(Object(m.K)({value:parseFloat(Oi(e.column.field,e.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,enabled:li(e.column,e.requestType,e.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale},t.edit.params)),e.element.setAttribute("name",si(e.column.field)),this.obj.appendTo(e.element),this.obj.element.addEventListener("keydown",this.keyEventHandler)}},{key:"destroy",value:function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())}}]),e}(),Vn=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"create",value:function(e){var t=e.column;return this.parent.createElement("input",{className:"e-field e-input e-defaultcell",attrs:{type:"text",value:Object(m.X)(e.value)?"":e.value,"e-mappinguid":t.uid,id:this.parent.element.id+si(t.field),name:si(t.field),style:"text-align:"+t.textAlign}})}},{key:"read",value:function(e){return e.value}},{key:"write",value:function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new C.g(Object(m.K)({element:e.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:li(e.column,e.requestType,e.element),placeholder:i?"":e.column.headerText},t.edit.params)),this.obj.appendTo(e.element)}},{key:"destroy",value:function(){this.obj&&this.obj.destroy()}}]),e}(),Hn=function(){function e(t,i,n){p(this,e),this.args={},this.currentVirtualData={},this.parent=t,this.renderer=n,this.serviceLocator=i,this.addEventListener()}return f(e,[{key:"clickHandler",value:function(e){var t=e.target,i=this.parent;(Wt(t,"e-gridcontent")&&Wt(Wt(t,"e-gridcontent"),"e-grid").id===i.element.id||i.frozenRows&&Wt(t,"e-headercontent"))&&!Wt(t,"e-unboundcelldiv")&&(this.rowIndex=Wt(t,"e-rowcell")?parseInt(t.parentElement.getAttribute("aria-rowindex"),10):-1,i.isEdit&&i.editModule.endEdit())}},{key:"dblClickHandler",value:function(e){Wt(e.target,"e-rowcell")&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(Wt(e.target,"e-row"))}},{key:"editComplete",value:function(e){switch(this.parent.isEdit=!1,Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==e.action&&this.parent.selectRow(0),this.parent.trigger(E,Object(m.K)(e,{requestType:"save",type:E}));break;case"delete":if(Object(m.W)()&&!this.parent.isJsComponent){var t="data";e[t]=e[t][0]}this.parent.trigger(E,Object(m.K)(e,{requestType:"delete",type:E})),this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}}},{key:"startEdit",value:function(e){var t=this,i=this.parent,n=i.getPrimaryKeyFieldNames(),r=[];if(this.rowIndex=this.editRowIndex=parseInt(e.getAttribute("aria-rowindex"),10),!i.enableVirtualization&&!i.enableInfiniteScrolling||this.parent.element.querySelector('.e-row[aria-rowindex="'+this.rowIndex+'"]')){if(Object(m.W)())for(var s=this.parent.getColumns(),a=0;a<s.length;a++){var l=s[a];l.template&&Object(m.jb)(i.element.id+l.uid,"Template",this.rowIndex)}if(Si(i)){var o=i.getRowObjectFromUID(e.getAttribute("data-uid"));this.previousData=o.data}else if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){var h={data:this.previousData,index:this.rowIndex};this.parent.notify("virtual-scroll-edit-action-begin",h),this.previousData=h.data}else this.previousData=i.getCurrentViewRecords()[this.rowIndex];for(var c=0;c<n.length;c++)r.push(Oi(n[c],this.previousData));this.uid=e.getAttribute("data-uid");var u=i.getRowObjectFromUID(this.uid),d={primaryKey:n,primaryKeyValue:r,requestType:"beginEdit",rowData:this.previousData,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:u&&u.foreignKeyData,target:void 0};Object(m.W)()&&!this.parent.isJsComponent||(d.row=e),i.trigger("beginEdit",d,(function(n){n.type="actionBegin",i.trigger(D,n,(function(n){if(!n.cancel){i.isEdit=!0,n.row=n.row?n.row:e,Object(m.W)()&&i.isServerRendered&&(t.originalRow=n.row,t.cloneRow=n.row.cloneNode(!0),n.cloneRow=t.cloneRow),"Dialog"!==i.editSettings.mode&&i.clearSelection(),"Dialog"===i.editSettings.mode&&i.selectionModule&&(i.selectionModule.preventFocus=!0,n.row.classList.add("e-dlgeditrow")),t.renderer.update(n),Object(m.W)()&&(n.form=null,t.cloneFrozen=n.cloneFrozen,t.frozen=n.frozen,t.cloneRow=n.cloneRow,t.originalRow=n.row),t.uid=e.getAttribute("data-uid"),i.editModule.applyFormValidation(),n.type="actionComplete",i.trigger(E,n),t.args=n,t.parent.allowTextWrap&&t.parent.notify("freezerender",{case:"textwrap"}),Object(m.W)()&&(t.parent.notify(W,{}),i.element.querySelector(".e-gridpopup").style.display="none",t.parent.notify("start-edit",{}))}}))}))}}},{key:"updateRow",value:function(e,t){var i=this,n=this.parent;this.editRowIndex=e;var r={requestType:"save",action:"edit",type:D,data:t,cancel:!1,previousData:n.getCurrentViewRecords()[e],row:n.getRowByIndex(e)};n.showSpinner(),n.notify("update-data",r),r.promise?r.promise.then((function(){return n.refresh()})).catch((function(e){return i.edFail(e)})):n.refresh()}},{key:"editFormValidate",value:function(){var e=this.parent,t=e.editModule.formObj.validate(),i=!e.editModule.mFormObj||e.editModule.mFormObj.validate(),n=!e.editModule.frFormObj||e.editModule.frFormObj.validate();return t&&i&&n}},{key:"endEdit",value:function(){var e=this.parent;if(this.parent.isEdit&&this.editFormValidate()){var t=Object(m.K)({},{},this.previousData,!0),i=Object(m.K)(this.args,{requestType:"save",type:D,data:t,cancel:!1,previousData:this.previousData,selectedRow:e.selectedRowIndex,foreignKeyData:{}}),n="Right"===e.getFrozenMode()?1:0,r="Dialog"===e.editSettings.mode,s=Object(m.lb)("#"+e.element.id+"_dialogEdit_wrapper",document),a=r?s.querySelector(".e-gridform"):e.element.querySelectorAll(".e-gridform")[n],l={virtualData:{},isAdd:!1};if(this.parent.notify("get-virtual-data",l),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||"Normal"!==this.parent.editSettings.mode||a?t=e.editModule.getCurrentEditedData(a,t):this.parent.isEdit&&(this.currentVirtualData=t=i.data=l.virtualData),e.isFrozenGrid()&&"Normal"===e.editSettings.mode){var o,h,u=e.getMovableVirtualHeader().querySelector(".e-gridform"),d=e.getMovableVirtualContent().querySelector(".e-gridform"),p=[u||d],g=[];"Left-Right"===e.getFrozenMode()&&(o=e.getFrozenRightHeader().querySelector(".e-gridform"),h=e.getFrozenRightContent().querySelector(".e-gridform"),g=[o||h]),Xi(this.parent,(function(i,n){var r,s=c(n);try{for(s.s();!(r=s.n()).done;){var a=r.value;a&&(t=e.editModule.getCurrentEditedData(a,t))}}catch(l){s.e(l)}finally{s.f()}}),[[],p,g])}if(Object(m.W)()){i.form=null,i.movableForm=null,i.row={}}var f=[].slice.call(e.element.querySelectorAll(".e-editedrow")).length;if(l.isAdd||!Object.keys(this.currentVirtualData).length||f||(f=1),r?s.querySelectorAll(".e-editedrow").length:f)i.action="edit",e.trigger(D,i,(function(t){t.cancel||(e.showSpinner(),e.notify("update-data",t))}));else if(i.action="add",i.selectedRow=0,i.index=this.addedRowIndex,e.notify("virtual-scroll-edit-success",{}),e.notify(P,i),this.addedRowIndex=null,i.cancel)return}}},{key:"destroyElements",value:function(){var e=this.parent;e.editModule.destroyWidgets(),e.editModule.destroyForm(),this.parent.notify("dialog-destroy",{})}},{key:"editHandler",value:function(e){var t=this;e.promise?e.promise.then((function(i){return t.edSucc(i,e)})).catch((function(e){return t.edFail(e)})):this.editSuccess(e.data,e)}},{key:"edSucc",value:function(e,t){this.editSuccess(e,t)}},{key:"edFail",value:function(e){if(Object(m.W)()&&this.parent.isServerRendered){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message)}this.editFailure(e)}},{key:"updateCurrentViewData",value:function(e){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=e)}},{key:"requestSuccess",value:function(e){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==e.action&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))}},{key:"editSuccess",value:function(e,t){if(!(Object(m.X)(e)||e instanceof Array)){t.data=Object(m.K)({},Object(m.K)({},t.rowData,t.data),e)}var i;this.requestSuccess(t),this.parent.trigger("beforeDataBound",t),t.type=E,this.parent.isEdit=!1,Object(m.W)()&&this.parent.isServerRendered?(this.closeForm(),i={requestType:t.requestType,rowIndex:t.rowIndex,action:t.action,data:t.data},this.parent.notify("editsuccess",i)):this.refreshRow(t.data),this.parent.notify("virtual-scroll-edit-success",t),this.parent.editModule.checkLastRow(t.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(t.data),this.blazorTemplate(),Object(m.W)()&&this.parent.isServerRendered||(this.editRowIndex=null,this.parent.trigger(E,t)),Object(m.W)()&&this.parent.notify(W,{}),(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&(this.parent.isPersistSelection||this.parent.selectionSettings.checkboxOnly)||"Dialog"===this.parent.editSettings.mode||(Object(m.W)()&&this.parent.isServerRendered?i.editRowIndex=this.rowIndex>-1?this.rowIndex:this.editRowIndex:this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex)),this.parent.hideSpinner()}},{key:"closeForm",value:function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus(),this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow")),this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))}},{key:"blazorTemplate",value:function(){var e=this.parent.getColumns();this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&Object(m.sb)(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings);for(var t=0;t<e.length;t++){var i=e[t];i.template&&Object(m.sb)(this.parent.element.id+i.uid,"Template",i,!1),i.editTemplate&&Object(m.sb)(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i)}}},{key:"editFailure",value:function(e){this.parent.trigger("actionFailure",Object(m.W)()&&e instanceof Array?e[0]:{error:e}),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})}},{key:"needRefresh",value:function(){var e=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(e=!1),e}},{key:"refreshRow",value:function(e){var t=this.parent.isFrozenGrid(),i=new Z(this.serviceLocator,null,this.parent),n=this.parent.getRowObjectFromUID(this.uid);if(n){n.changes=e,this.parent.notify("refresh-virtual-cache",e),bi(n,this.parent.getForeignKeyColumns(),n.changes),this.needRefresh()&&i.refresh(n,this.parent.getColumns(),!0);var r=[].slice.call(this.parent.element.querySelectorAll('[aria-rowindex="'+n.index+'"]'));if(t&&r.length)for(var s=0;s<r.length;s++){var a=r[s].getAttribute("data-uid");a!==this.uid&&((n=this.parent.getRowObjectFromUID(a)).changes=e,i.refresh(n,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(r[s]))}}}},{key:"closeEdit",value:function(){var e=this;if(this.parent.isEdit){var t=this.parent,i=Object(m.K)(this.args,{requestType:"cancel",type:D,cancel:!1,data:this.previousData,selectedRow:t.selectedRowIndex});t.notify("virtual-scroll-edit-cancel",i),this.blazorTemplate(),Object(m.W)()&&(i.form=null),t.trigger(D,i,(function(i){if(!i.cancel){"Dialog"===e.parent.editSettings.mode&&e.parent.notify("dialog-destroy",{}),t.isEdit=!1,e.stopEditStatus(),i.type=E,"Dialog"!==t.editSettings.mode&&(Object(m.W)()&&t.isServerRendered?e.closeForm():e.refreshRow(i.data));var n=t.groupSettings.enableLazyLoading&&t.groupSettings.columns.length&&!t.getContentTable().querySelector("tr.e-emptyrow");t.getContentTable().querySelector("tr.e-emptyrow")||t.getContentTable().querySelector("tr.e-row")||n||t.renderModule.emptyRow(),"Dialog"!==t.editSettings.mode&&t.selectRow(e.rowIndex),t.trigger(E,i),Object(m.W)()&&(e.parent.notify(W,{}),e.parent.notify("close-edit",{}))}}))}}},{key:"addRecord",value:function(e,t){var i=this,n=this.parent;if(this.addedRowIndex=t=Object(m.X)(t)?0:t,e)n.notify(P,{requestType:"save",type:D,data:e,selectedRow:0,action:"add",index:t});else if(!n.isEdit){this.previousData={},this.uid="";for(var r=n.columnModel,s=0;s<r.length;s++)r[s].field&&v.b.setValue(r[s].field,r[s].defaultValue,this.previousData);var a={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:D,index:t,rowData:this.previousData,target:void 0},l={virtualData:{}};this.parent.notify("get-virtual-data",l),(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(l.virtualData).length&&(a.data=a.rowData=l.virtualData),Object(m.W)()&&(a.form=null),n.trigger(D,a,(function(e){e.cancel||(n.isEdit=!0,"Dialog"!==n.editSettings.mode&&n.clearSelection(),i.renderer.addNew(e),n.editModule.applyFormValidation(),e.type=E,e.row=n.element.querySelector(".e-addedrow"),n.trigger(E,e),Object(m.W)()&&(i.parent.notify(W,{}),i.parent.notify("start-add",{})),i.args=e)}))}}},{key:"deleteRecord",value:function(e,i){if(this.editRowIndex=this.parent.selectedRowIndex,i){i=i instanceof Array?i:[i];var n=this.parent,r=Object.keys(i).length;e=e||this.parent.getPrimaryKeyFieldNames()[0];for(var s=function(r){var s=void 0,a=n.currentViewData.some((function(t){return s=t,i[r]===Oi(e,t)||i[r]===t}));i[r]=a?s:t({},e,i[r])},a=0;a<r;a++)s(a)}var l={requestType:"delete",type:D,foreignKeyData:{},data:i||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};if(Object(m.X)(this.parent.commandDelIndex)||(l.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&l.data.length>1){var o=this.parent.getSelectedRows()[0].getAttribute("data-uid");l.data=[this.parent.getRowObjectFromUID(o).data]}Object(m.W)()&&!this.parent.isJsComponent&&(l.data=l.data[0]),this.parent.notify(P,l)}},{key:"stopEditStatus",value:function(){for(var e=this.parent,t=[].slice.call(e.element.querySelectorAll(".e-addedrow")),i=[].slice.call(e.element.querySelectorAll(".e-editedrow")),n=0;n<t.length;n++)Object(m.hb)(t[n]);for(var r=0;r<i.length;r++)i[r].classList.remove("e-editedrow")}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on("crud-Action",this.editHandler,this),this.parent.on("double-tap",this.dblClickHandler,this),this.parent.on(H,this.clickHandler,this),this.parent.on("recordAdded",this.requestSuccess,this),this.parent.on("dblclick",this.dblClickHandler,this),this.parent.on("delete-complete",this.editComplete,this),this.parent.on("save-complete",this.editComplete,this),this.parent.on("closeinline",this.closeForm,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("crud-Action",this.editHandler),this.parent.off("double-tap",this.dblClickHandler),this.parent.off(H,this.clickHandler),this.parent.off("recordAdded",this.requestSuccess),this.parent.off("dblclick",this.dblClickHandler),this.parent.off("delete-complete",this.editComplete),this.parent.off("save-complete",this.editComplete),this.parent.off("closeinline",this.closeForm))}},{key:"destroy",value:function(){this.removeEventListener(),this.renderer.destroy()}}]),e}(),Nn=function(e){n(r,e);var t=s(r);function r(e,i,n){var s;return p(this,r),(s=t.call(this,e,i)).parent=e,s.serviceLocator=i,s.renderer=n,s}return f(r,[{key:"closeEdit",value:function(){i(o(r.prototype),"closeEdit",this).call(this)}},{key:"addRecord",value:function(e,t){i(o(r.prototype),"addRecord",this).call(this,e,t)}},{key:"endEdit",value:function(){i(o(r.prototype),"endEdit",this).call(this)}},{key:"updateRow",value:function(e,t){i(o(r.prototype),"updateRow",this).call(this,e,t)}},{key:"deleteRecord",value:function(e,t){i(o(r.prototype),"deleteRecord",this).call(this,e,t)}},{key:"startEdit",value:function(e){i(o(r.prototype),"startEdit",this).call(this,e)}}]),r}(Hn),Wn=function(){function t(e,i,n){p(this,t),this.cellDetails={},this.originalCell={},this.cloneCell={},this.editNext=!1,this.preventSaveCell=!1,this.parent=e,this.serviceLocator=i,this.renderer=n,this.focus=i.getService("focus"),this.addEventListener()}return f(t,[{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(H,this.clickHandler,this),this.parent.on("dblclick",this.dblClickHandler,this),this.parent.on("beforecellfocused",this.onBeforeCellFocused,this),this.parent.on("cellfocused",this.onCellFocused,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(I,this.dataBoundFunction),this.parent.addEventListener("batchCancel",this.batchCancelFunction),this.parent.on("double-tap",this.dblClickHandler,this),this.parent.on(V,this.keyDownHandler,this),this.parent.on("editNextValCell",this.editNextValCell,this),this.parent.on("closebatch",this.closeForm,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(H,this.clickHandler),this.parent.off("dblclick",this.dblClickHandler),this.parent.off("beforecellfocused",this.onBeforeCellFocused),this.parent.off("cellfocused",this.onCellFocused),this.parent.removeEventListener(I,this.dataBoundFunction),this.parent.removeEventListener("batchCancel",this.batchCancelFunction),this.parent.off("double-tap",this.dblClickHandler),this.parent.off(V,this.keyDownHandler),this.parent.off("editNextValCell",this.editNextValCell),this.parent.off("closebatch",this.closeForm))}},{key:"batchCancel",value:function(e){this.parent.focusModule.restoreFocus()}},{key:"dataBound",value:function(){this.parent.notify(W,{})}},{key:"destroy",value:function(){this.removeEventListener()}},{key:"clickHandler",value:function(e){Wt(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&Object(m.C)(this.form,"td")!==Object(m.C)(e.target,"td")&&(this.saveCell(),this.editNextValCell()),Wt(e.target,"e-rowcell")&&!this.parent.isEdit&&this.setCellIdx(e.target))}},{key:"dblClickHandler",value:function(e){var t=Wt(e.target,"e-rowcell"),i=Wt(e.target,"e-row");t&&i&&!isNaN(parseInt(t.getAttribute("aria-colindex"),10))&&!t.parentElement.classList.contains("e-editedrow")&&this.editCell(parseInt(i.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(t.getAttribute("aria-colindex"),10)].field,this.isAddRow(parseInt(i.getAttribute("aria-rowindex"),10)))}},{key:"onBeforeCellFocused",value:function(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())}},{key:"onCellFocused",value:function(t){var i=this.parent.getFrozenLeftCount(),n=this.parent.getFrozenRightColumnsCount(),r=this.parent.getContent().querySelector(".e-movablecontent"),s=this.parent.getHeaderContent().querySelector(".e-movableheader"),a=!(t.container.isContent&&t.container.isDataCell||this.parent.frozenRows&&t.container.isHeader);if(t.byKey&&!a){var l=e(t.container.indexes,2),o=l[0],h=l[1];if(i&&(r.contains(t.element)||this.parent.frozenRows&&s.contains(t.element))&&(h+=i),n){var c=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");(this.parent.getContent().querySelector(".e-frozen-right-content").contains(t.element)||this.parent.frozenRows&&c.contains(t.element))&&(h+=i+this.parent.getMovableColumnsCount())}this.parent.frozenRows&&t.container.isContent&&(o+=this.parent.frozenRows);var u=this.parent.isEdit;if(!this.parent.element.querySelectorAll(".e-popup-open").length)switch(u=u&&!this.validateFormObj(),t.keyArgs.action){case"tab":case"shiftTab":var d=this.parent.getColumns()[t.indexes[1]];d&&!this.parent.isEdit&&this.editCell(t.indexes[0],d.field),(u||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(o,h);break;case"enter":case"shiftEnter":t.keyArgs.preventDefault(),u&&this.editCell(o,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(o,h),this.focus.focus()}}else this.parent.isEdit&&a&&this.saveCell()}},{key:"isAddRow",value:function(e){return this.parent.getDataRows()[e].classList.contains("e-insertedrow")}},{key:"editCellFromIndex",value:function(e,t){this.cellDetails.rowIndex=e,this.cellDetails.cellIndex=t,this.editCell(e,this.parent.getColumns()[t].field,this.isAddRow(e))}},{key:"closeEdit",value:function(){var e=this,t=this.parent,i=this.parent.getRowsObject(),n={cancel:!1,batchChanges:this.getBatchChanges()};if(t.notify("before-batch-cancel",n),!n.cancel){var r=this.parent.getColumns();if(Object(m.W)())for(var s=0;s<r.length;s++){var a=r[s];a.template&&Object(m.sb)(this.parent.element.id+a.uid,"Template",a,!1)}t.isEdit&&this.saveCell(!0),this.isAdded=!1,t.clearSelection();for(var l=Gi(this.parent),o=function(t){var n=!1,r=i[t].isDirty;Xi(e.parent,(function(i,s){(n=e.removeBatchElementChanges(s[t],r))&&s.splice(t,1)}),l),n&&t--,h=t},h=0;h<i.length;h++)o(h);Object(m.W)()&&t.isServerRendered&&t.selectRow(t.selectionModule.prevRowIndex),t.getContentTable().querySelector("tr.e-row")||t.renderModule.renderEmptyRow();var c=this.parent.getRowsObject();t.notify("batchCancel",{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new _({isDataRow:!0,cells:[new Q({isDataCell:!0,visible:!0})]})]}),t.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),t.notify(W,{}),this.parent.notify("tooltip-destroy",{}),c={requestType:"batchCancel",rows:this.parent.getRowsObject()},t.trigger("batchCancel",c)}}},{key:"removeBatchElementChanges",value:function(e,t){var i=this.parent,n=new Z(this.serviceLocator,null,this.parent),r=!1;if(t){e.isDirty=t;var s=i.getRowElementByUID(e.uid);if(s&&(s.classList.contains("e-insertedrow")?(Object(m.hb)(s),r=!0):(bi(e,this.parent.getForeignKeyColumns(),e.data),delete e.changes,delete e.edit,e.isDirty=!1,Object(m.W)()&&i.isServerRendered?(this.removeHideAndSelection(s),this.closeForm()):(Object(m.A)(s,[],["e-hiddenrow","e-updatedtd"]),n.refresh(e,i.getColumns(),!1))),this.parent.aggregates.length>0)){var a=[];a.type="cancel",this.parent.notify("refresh-footer-rendered",a),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",a)}}return r}},{key:"removeHideAndSelection",value:function(e){if(e.classList.contains("e-hiddenrow")){e.removeAttribute("aria-selected");for(var t=[].slice.call(e.querySelectorAll(".e-selectionbackground")),i=0;i<t.length;i++)Object(m.ib)([t[i]],["e-selectionbackground","e-active"])}Object(m.A)(e,[],["e-hiddenrow","e-updatedtd"])}},{key:"deleteRecord",value:function(e,t){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(e,t),this.parent.aggregates.length>0&&(this.parent.notify("refresh-footer-rendered",{}),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",{}))}},{key:"addRecord",value:function(e){this.bulkAddRow(e)}},{key:"endEdit",value:function(e){this.parent.isEdit&&this.validateFormObj()||this.batchSave()}},{key:"closeForm",value:function(){for(var e=0;e<Object.keys(this.originalCell).length;e++)for(var t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[e]===Object.keys(this.cloneCell)[t]&&(this.cloneCell[Object.keys(this.cloneCell)[t]].replaceWith(this.originalCell[Object.keys(this.originalCell)[e]]),this.originalCell[Object.keys(this.originalCell)[e]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[e]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={},this.originalCell={}}},{key:"validateFormObj",value:function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()}},{key:"batchSave",value:function(){var e=this,t=this.parent;if(t.isCheckBoxSelection){var i=t.element.querySelector(".e-checkselectall").parentElement;i.classList.contains("e-checkbox-disabled")&&t.pageSettings.totalRecordsCount>t.currentViewData.length&&Object(m.ib)([i],["e-checkbox-disabled"])}var n=this.parent.getColumns();if(Object(m.W)())for(var r=0;r<n.length;r++){var s=n[r];s.template&&(m.z[this.parent.element.id+s.uid]=[],Object(m.jb)(this.parent.element.id+s.uid,"Template"))}if(this.saveCell(),!(t.isEdit||this.editNextValCell()||t.isEdit)){var a=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&a.deletedRecords.length&&this.parent.selectionSettings.persistSelection&&(a.deletedRecords=this.removeSelectedData,this.removeSelectedData=[]);var l={changedRecords:this.parent.getRowsObject().filter((function(e){return e.isDirty&&-1===["add","delete"].indexOf(e.edit)})).map((function(e){return e.data}))};t.trigger("beforeBatchSave",{batchChanges:a,cancel:!1},(function(i){if(!i.cancel){if(Object(m.W)()&&e.parent.isServerRendered){var n=e.parent.getContent();if(e.closeForm(),Object(m.ib)(n.querySelectorAll(".e-updatedtd"),["e-updatedtd"]),n.querySelector(".e-insertedrow, .e-hiddenrow")){Object(m.ib)(n.querySelectorAll(".e-hiddenrow"),["e-hiddenrow"]);for(var r=[].slice.call(n.querySelectorAll(".e-insertedrow")),s=0;s<r.length;s++)r[s].remove()}e.refreshRowIdx()}t.showSpinner(),t.notify("bulk-save",{changes:a,original:l})}}))}}},{key:"getBatchChanges",value:function(){var e,t={addedRecords:[],deletedRecords:[],changedRecords:[]},i=c(this.parent.getRowsObject());try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.isDirty)switch(n.edit){case"add":t.addedRecords.push(n.changes);break;case"delete":t.deletedRecords.push(n.data);break;default:t.changedRecords.push(n.changes)}}}catch(r){i.e(r)}finally{i.f()}return t}},{key:"removeRowObjectFromUID",value:function(e){for(var t=this.parent.getRowsObject(),i=0,n=t.length;i<n&&t[i].uid!==e;i++);Xi(this.parent,(function(e,t){t.splice(i,1)}),Gi(this.parent))}},{key:"addRowObject",value:function(e){var t=this.parent,i="Top"===t.editSettings.newRowPosition;Xi(this.parent,(function(n,r){var s=e.clone();s.cells=Wi(t,s.cells,n),i?r.unshift(s):r.push(s)}),Gi(this.parent),!0)}},{key:"bulkDelete",value:function(e,t){var i=this;this.removeSelectedData=[];var n=this.parent,r=n.selectedRowIndex,s=n.getSelectedRows(),a={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:r,rowData:t||n.getSelectedRecords()[0],cancel:!1};(Object(m.W)()&&!this.parent.isJsComponent||(a.row=t?n.editModule.deleteRowUid?n.getRowElementByUID(n.editModule.deleteRowUid):n.getRows()[n.getCurrentViewRecords().indexOf(t)]:t?n.getRows()[r]:s[0],a.row))&&n.trigger("beforeBatchDelete",a,(function(e){if(!e.cancel){if(i.removeSelectedData=n.getSelectedRecords(),n.clearSelection(),e.row=e.row?e.row:t?n.getRows()[r]:s[0],i.parent.isFrozenGrid()){t&&(r=parseInt(e.row.getAttribute("aria-rowindex"),10),(s=[]).push(n.getRowByIndex(r)),s.push(n.getMovableRowByIndex(r)),"Left-Right"===n.getFrozenMode()&&s.push(n.getFrozenRightRowByIndex(r)));for(var a=0;a<s.length;a++){var l=s[a].getAttribute("data-uid");if(s[a].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(l),Object(m.hb)(s[a]);else{var o=n.getRowObjectFromUID(l);o.isDirty=!0,o.edit="delete",Object(m.A)(s[a],["e-hiddenrow","e-updatedtd"],[]),n.frozenRows&&r<n.frozenRows&&n.getMovableDataRows().length>=n.frozenRows&&(n.getMovableHeaderTbody().appendChild(n.getMovableRowByIndex(n.frozenRows-1)),n.getFrozenHeaderTbody().appendChild(n.getRowByIndex(n.frozenRows-1)),"Left-Right"===n.getFrozenMode()&&n.getFrozenRightHeaderTbody().appendChild(n.getFrozenRightRowByIndex(n.frozenRows-1))),n.frozenRows&&r<n.frozenRows&&n.getDataRows().length>=n.frozenRows&&n.getHeaderTable().querySelector("tbody").appendChild(n.getRowByIndex(n.frozenRows-1))}delete s[a]}}else if(i.parent.isFrozenGrid()||1!==s.length&&!t)for(var h=0;h<s.length;h++){var c=s[h].getAttribute("data-uid");if(s[h].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(c),Object(m.hb)(s[h]);else{Object(m.A)(s[h],["e-hiddenrow","e-updatedtd"],[]);var u=n.getRowObjectFromUID(c);u.isDirty=!0,u.edit="delete",delete s[h]}}else{var d=e.row.getAttribute("data-uid");if(d=t&&i.parent.editModule.deleteRowUid?d=i.parent.editModule.deleteRowUid:d,e.row.classList.contains("e-insertedrow"))i.removeRowObjectFromUID(d),Object(m.hb)(e.row);else{var p=n.getRowObjectFromUID(d);p.isDirty=!0,p.edit="delete",Object(m.A)(e.row,["e-hiddenrow","e-updatedtd"],[])}delete e.row}i.refreshRowIdx(),t&&(n.editModule.deleteRowUid=void 0,n.getSelectedRows().length&&(r=parseInt(n.getSelectedRows()[0].getAttribute("aria-rowindex"),10))),n.isCheckBoxSelection||n.selectRow(r),n.trigger("batchDelete",e),n.notify("batchDelete",{rows:i.parent.getRowsObject()}),n.notify(W,{})}}))}},{key:"refreshRowIdx",value:function(){for(var e=this,t=this.parent.getAllDataRows(!0),i=Ki(this.parent),n=function(n,r,a){t[a].classList.contains("e-row")&&!t[a].classList.contains("e-hiddenrow")?(Xi(e.parent,(function(e,t){t[a].setAttribute("aria-rowindex",n.toString())}),i),n++):Xi(e.parent,(function(e,t){t[a].removeAttribute("aria-rowindex")}),i),s=n},r=0,s=0,a=t.length;r<a;r++)n(s,0,r)}},{key:"getIndexFromData",value:function(e){return Gt(e,this.parent.getCurrentViewRecords())}},{key:"bulkAddRow",value:function(e){var t=this,i=this.parent;if(i.editSettings.allowAdding&&(i.isEdit&&(this.saveCell(),this.parent.notify("editNextValCell",{})),!i.isEdit)){this.parent.element.classList.add("e-editing");var n={defaultData:e||this.getDefaultData(),primaryKey:i.getPrimaryKeyFieldNames(),cancel:!1};i.trigger("beforeBatchAdd",n,(function(n){if(!n.cancel){var r,s;t.isAdded=!0,i.clearSelection();for(var a,l,o=new Z(t.serviceLocator,null,t.parent),h=new $(t.parent).generateRows([n.defaultData]),c=o.render(h[0],i.getColumns()),u=0;u<t.parent.groupSettings.columns.length;u++)c.insertBefore(t.parent.createElement("td",{className:"e-indentcell"}),c.firstChild),h[0].cells.unshift(new Q({cellType:K.Indent}));var d=i.getContentTable().querySelector("tbody");if(c.classList.add("e-insertedrow"),d.querySelector(".e-emptyrow")){var p=d.querySelector(".e-emptyrow");p.parentNode.removeChild(p),t.removeFrozenTbody()}i.isFrozenGrid()&&(s=c.cloneNode(!0),r=t.renderMovable(c,s),c="Right"===i.getFrozenMode()?s:c,t.renderFrozenAddRow(c,r,s)),d=i.frozenRows&&"Top"===i.editSettings.newRowPosition?i.getHeaderTable().querySelector("tbody"):i.getContentTable().querySelector("tbody"),"Top"===t.parent.editSettings.newRowPosition?d.insertBefore(c,d.firstChild):d.appendChild(c),Object(m.v)(c.querySelectorAll(".e-rowcell"),["e-updatedtd"]),h[0].isDirty=!0,h[0].changes=Object(m.K)({},{},h[0].data,!0),h[0].edit="add",t.addRowObject(h[0]),t.refreshRowIdx(),t.focus.forgetPrevious(),i.notify("batchAdd",{rows:t.parent.getRowsObject(),args:{isFrozen:t.parent.isFrozenGrid()}});var g=t.getBatchChanges(),f=t.parent.getCurrentViewRecords().length+g.addedRecords.length-g.deletedRecords.length-1;i.selectRow("Top"===t.parent.editSettings.newRowPosition?0:f),e||(l=t.findNextEditableCell(0,!0),a=i.getColumns()[l],t.editCell("Top"===t.parent.editSettings.newRowPosition?0:f,a.field,!0)),t.parent.aggregates.length>0&&(e||g.addedRecords.length)&&t.parent.notify("refresh-footer-rendered",{}),i.trigger("batchAdd",{defaultData:n.defaultData,row:c,columnObject:a,columnIndex:l,primaryKey:n.primaryKey,cell:c.cells[l]}),i.isFrozenGrid()&&Fi(r.querySelector("td:not(.e-hide)"),c.querySelector("td:not(.e-hide)")),Object(m.W)()&&(t.parent.notify(W,{}),t.parent.notify("start-add",{}))}}))}}},{key:"renderFrozenAddRow",value:function(e,t,i){var n=this.parent,r=Ji(this.parent),s=Zi(this.parent);"Top"===n.editSettings.newRowPosition?r.insertBefore(t,r.firstChild):r.appendChild(t),Object(m.v)(t.querySelectorAll(".e-rowcell"),["e-updatedtd"]),s&&i&&("Top"===n.editSettings.newRowPosition?s.insertBefore(i,s.firstChild):s.appendChild(i),Object(m.v)(i.querySelectorAll(".e-rowcell"),["e-updatedtd"]),Fi(i.querySelector("td:not(.e-hide)"),e.querySelector("td:not(.e-hide)"))),"auto"===n.height&&n.notify("frozenHeight",{})}},{key:"removeFrozenTbody",value:function(){var e=this.parent;if(e.isFrozenGrid()){var t=e.getContent().querySelector(".e-movablecontent").querySelector("tbody");if(t.firstElementChild.parentNode.removeChild(t.firstElementChild),"Left-Right"===e.getFrozenMode()){var i=e.getContent().querySelector(".e-frozen-right-content").querySelector("tbody");i.firstElementChild.parentNode.removeChild(i.firstElementChild)}}}},{key:"renderMovable",value:function(e,t){var i=e.cloneNode(!0),n=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount();return Ui(e,0,r),Ui(i,r,s?i.children.length-s:i.children.length),Ui(t,r+n,t.children.length),i}},{key:"findNextEditableCell",value:function(e,t,i){for(var n,r=this.parent.getColumns(),s=r.length,a=e;a<s;a++){if(n=!!i&&Object(m.X)(r[a].validationRules),!t&&this.checkNPCell(r[a]))return a;if(t&&!r[a].template&&r[a].visible&&r[a].allowEditing&&(!r[a].isIdentity||!r[a].isPrimaryKey)&&!n)return a}return-1}},{key:"checkNPCell",value:function(e){return!e.template&&e.visible&&!e.isPrimaryKey&&!e.isIdentity&&e.allowEditing}},{key:"getDefaultData",value:function(){var e,t={},i={number:0,string:null,boolean:!1,date:null,datetime:null},n=c(this.parent.columnModel);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.field&&Object(m.qb)(r.field,r.defaultValue?r.defaultValue:i[r.type],t)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"setCellIdx",value:function(e){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=e.cellIndex-t,this.cellDetails.rowIndex=parseInt(e.getAttribute("index"),10)}},{key:"editCell",value:function(e,t,i){var n=this.parent,r=n.getColumnByField(t);this.index=e,this.field=t,this.isAdd=i;var s=n.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===e&&this.parent.getDataRows().length-1!==e);Object(m.W)()&&r.template&&!i&&Object(m.jb)(this.parent.element.id+r.uid,"Template",e),n.editSettings.allowEditing&&(!s&&r.allowEditing?this.editCellExtend(e,t,i):s&&(this.editNext=!0,this.saveCell()))}},{key:"editCellExtend",value:function(e,t,i){var n,r,s=this,a=this.parent,l=a.getColumnByField(t),o=a.getPrimaryKeyFieldNames();if(!a.isEdit){var h=Object(m.K)({},{},this.getDataByIndex(e),!0);if("movable"===l.getFreezeTableName()||"frozen-right"===l.getFreezeTableName()?(n="movable"===l.getFreezeTableName()?a.getMovableDataRows()[e]:a.getFrozenRightDataRows()[e],r=this.parent.getRowObjectFromUID(n.getAttribute("data-uid")),h=r.changes?Object(m.K)({},{},r.changes,!0):h):(n=a.getDataRows()[e],h=Object(m.K)({},{},this.getDataByIndex(e),!0)),o[0]===l.field&&!n.classList.contains("e-insertedrow")||l.columns||l.isPrimaryKey&&l.isIdentity)this.parent.isLastCellPrimaryKey=!0;else{this.parent.isLastCellPrimaryKey=!1,this.parent.element.classList.add("e-editing");var c=a.getRowObjectFromUID(n.getAttribute("data-uid")),u=[].slice.apply(n.cells),d={columnName:l.field,isForeignKey:!Object(m.X)(l.foreignKeyValue),primaryKey:o,rowData:h,validationRules:Object(m.K)({},l.validationRules?l.validationRules:{}),value:Oi(l.field,h),type:i?"add":"edit",cancel:!1,foreignKeyData:c&&c.foreignKeyData};(Object(m.W)()&&!this.parent.isJsComponent||(d.cell=u[this.getColIndex(u,this.getCellIdx(l.uid))],d.row=n,d.columnObject=l,d.cell))&&a.trigger("cellEdit",d,(function(t){if(!t.cancel){if(t.cell=t.cell?t.cell:u[s.getColIndex(u,s.getCellIdx(l.uid))],t.row=t.row?t.row:n,t.columnObject=t.columnObject?t.columnObject:l,t.columnObject.index=Object(m.X)(t.columnObject.index)?0:t.columnObject.index,s.cellDetails={rowData:h,column:l,value:t.value,isForeignKey:t.isForeignKey,rowIndex:e,cellIndex:parseInt(t.cell.getAttribute("aria-colindex"),10),foreignKeyData:t.foreignKeyData},t.cell.classList.contains("e-updatedtd")&&(s.isColored=!0,t.cell.classList.remove("e-updatedtd")),Object(m.W)()&&a.isServerRendered){var i=t.row.querySelectorAll(".e-indentcell, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop").length;s.cloneCell["".concat(s.cellDetails.rowIndex).concat(t.columnObject.index)]=t.cloneCell=t.cell.cloneNode(!0),Wt(t.cell,"e-movableheader")||Wt(t.cell,"e-movablecontent")?(t.row.insertCell(t.columnObject.index-a.getFrozenColumns()),t.row.replaceChild(t.cloneCell,t.row.cells[t.columnObject.index-a.getFrozenColumns()])):(t.row.insertCell(t.columnObject.index+i),t.row.replaceChild(t.cloneCell,t.row.cells[t.columnObject.index+i])),s.originalCell["".concat(s.cellDetails.rowIndex).concat(t.columnObject.index)]=t.cell.parentElement.removeChild(t.cell),Object(m.ib)([s.cloneCell["".concat(s.cellDetails.rowIndex).concat(t.columnObject.index)]],["e-focus","e-focused"])}a.isEdit=!0,a.clearSelection(),a.isCheckBoxSelection&&a.isPersistSelection||a.selectRow(s.cellDetails.rowIndex,!0),s.renderer.update(t),s.parent.notify("batcheditform-rendered",t),s.form=Object(m.lb)("#"+a.element.id+"EditForm",a.element),a.editModule.applyFormValidation([l]),s.parent.element.querySelector(".e-gridpopup").style.display="none"}}))}}}},{key:"updateCell",value:function(e,t,i){var n=this.parent,r=n.getColumnByField(t),s=n.getColumnIndexByField(t);if(r&&!r.isPrimaryKey){var a=_i(this.parent,r,e,s),l="movable"===r.getFreezeTableName()?this.parent.getMovableRowsObject()[e]:"frozen-right"===r.getFreezeTableName()?n.getFrozenRightRowsObject()[e]:n.getRowObjectFromUID(a.parentElement.getAttribute("data-uid"));this.refreshTD(a,r,l,i),this.parent.trigger("queryCellInfo",{cell:a,column:r,data:l.changes})}}},{key:"setChanges",value:function(e,t,i,n){var r;if(this.parent.isFrozenGrid()){var s,a=this.parent.getRowElementByUID(e.uid),l=parseInt(a.getAttribute("aria-rowindex"),10);if((r=this.parent.getRowsObject()[l]).changes||(r.changes=Object(m.K)({},{},e.data,!0)),Object(m.X)(t)||Object(m.qb)(t,i,r.changes),Object(m.W)()&&this.parent.isServerRendered&&(Wt(n,"e-movableheader")||Wt(n,"e-movablecontent"))){var o=this.parent.getMovableRowByIndex(this.cellDetails.rowIndex),h=parseInt(o.getAttribute("aria-rowindex"),10);s=this.parent.getMovableRowsObject()[h]}else s=this.parent.getMovableRowsObject()[l];if(s.changes=Object(m.K)({},{},r.changes,!0),e.data[t]!==i&&(s.isDirty=!0,r.isDirty=!0),"Left-Right"===this.parent.getFrozenMode()){var c=this.parent.getFrozenRightRowsObject()[l];c.changes=Object(m.K)({},{},r.changes,!0),e.data[t]!==i&&(c.isDirty=!0)}}else e.changes||(e.changes=Object(m.K)({},{},e.data,!0)),Object(m.X)(t)||v.b.setValue(t,i,e.changes),e.data[t]!==i&&(e.isDirty=!0)}},{key:"updateRow",value:function(e,t){for(var i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.updateCell(e,r,t[r])}}},{key:"getCellIdx",value:function(e){var t=this.parent.getColumnIndexByUid(e)+this.parent.groupSettings.columns.length;return Object(m.X)(this.parent.detailTemplate)&&Object(m.X)(this.parent.childGrid)||t++,this.parent.isRowDragable()&&t++,t}},{key:"refreshTD",value:function(e,t,i,n){var r,s=new ae(this.parent,this.serviceLocator);n="number"!==t.type||Object(m.X)(n)?n:parseFloat(n),this.setChanges(i,t.field,n,e);var a,l,o=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();o=o&&this.parent.isRowDragable()?o+1:o,bi(i,this.parent.getForeignKeyColumns(),i.changes),r=o&&"movable"===t.getFreezeTableName()&&this.parent.getColumns().length===i.cells.length?i.cells.slice(o,i.cells.length):i.cells,this.parent.isReact&&(a=e.parentElement,l=e.cellIndex);var h=0;o&&(h="movable"===t.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?o:"frozen-right"===t.getFreezeTableName()?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():h),s.refreshTD(e,r[this.getCellIdx(t.uid)-h],i.changes,{index:this.getCellIdx(t.uid)}),this.parent.isReact?(this.newReactTd=a.cells[l],a.cells[l].classList.add("e-updatedtd")):e.classList.add("e-updatedtd"),e.classList.add("e-updatedtd"),this.parent.notify(W,{})}},{key:"getColIndex",value:function(e,t){var i=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(i=this.parent.groupSettings.columns.length),Object(m.X)(this.parent.detailTemplate)&&Object(m.X)(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++;for(var n=0;n<e.length;n++)if(parseInt(e[n].getAttribute("aria-colindex"),10)===t-i)return n;return-1}},{key:"editNextValCell",value:function(){var e=this.parent,t=this.getBatchChanges(),i=this.parent.getCurrentViewRecords().length+t.addedRecords.length-t.deletedRecords.length-1;if(this.isAdded&&!e.isEdit){for(var n=this.cellDetails.cellIndex;n<e.getColumns().length;n++){if(e.isEdit)return;var r=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),s=e.getColumns()[r];if(s){if("Bottom"===this.parent.editSettings.newRowPosition)this.editCell(i,s.field,!0);else{var a={index:0,column:s};this.parent.notify("next-cell-index",a),this.editCell(a.index,s.field,!0)}this.saveCell()}}e.isEdit||(this.isAdded=!1)}}},{key:"escapeCellEdit",value:function(){var e=this.generateCellArgs();e.value=e.previousValue,this.successCallBack(e,e.cell.parentElement,e.column,!0)(e)}},{key:"generateCellArgs",value:function(){var e=this.parent;this.parent.element.classList.remove("e-editing");var t=this.cellDetails.column,i={};i[t.field]=Oi(t.field,this.cellDetails.rowData);var n=e.editModule.getCurrentEditedData(this.form,i),r=Object(m.K)({},n);n=Object(m.K)({},n,this.cellDetails.rowData);var s=Oi(t.field,r);Object(m.X)(t.field)||Object(m.ab)(s)||Object(m.qb)(t.field,s,n);var a={columnName:t.field,value:Oi(t.field,n),rowData:this.cellDetails.rowData,column:t,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};return Object(m.W)()&&!this.parent.isJsComponent||(a.cell=this.form.parentElement,a.columnObject=t),a}},{key:"saveCell",value:function(e){if(!this.preventSaveCell){var t=this.parent;if(e||t.isEdit&&!this.validateFormObj()){this.preventSaveCell=!0;var i=this.generateCellArgs(),n=Object(m.W)()?Wt(this.form,"e-row"):i.cell.parentElement,r=Object(m.W)()?this.cellDetails.column:i.column;Object(m.W)()&&delete i.column,e?this.successCallBack(i,n,r)(i):(t.trigger("cellSave",i,this.successCallBack(i,n,r)),t.notify("batchedit-form",{formObj:this.form}))}}}},{key:"successCallBack",value:function(e,t,i,n){var r=this;return function(e){var s=r.parent;if(e.cell=e.cell?e.cell:r.form.parentElement,e.columnObject=e.columnObject?e.columnObject:i,e.columnObject.index=Object(m.X)(e.columnObject.index)?0:e.columnObject.index,e.cancel){if(r.preventSaveCell=!1,r.editNext){if(r.editNext=!1,r.cellDetails.rowIndex===r.index&&r.cellDetails.column.field===r.field)return;r.editCellExtend(r.index,r.field,r.isAdd)}}else{if(s.editModule.destroyWidgets([i]),s.isEdit=!1,s.editModule.destroyForm(),Object(m.W)()&&i.template&&!e.cell.parentElement.classList.contains("e-insertedrow")&&Object(m.sb)(s.element.id+i.uid,"Template",i,!1),r.parent.notify("tooltip-destroy",{}),Object(m.W)()&&s.isServerRendered&&(Wt(e.cell,"e-movableheader")||Wt(e.cell,"e-movablecontent")))r.refreshTD(e.cell,i,s.getMovableRowsObject()[r.cellDetails.rowIndex],e.value);else{var a=Wt(e.cell,"e-movablecontent")||Wt(e.cell,"e-movableheader")?s.getRowObjectFromUID(t.getAttribute("data-uid"),!0):s.getRowObjectFromUID(t.getAttribute("data-uid"));"Left-Right"===s.getFrozenMode()&&(Wt(e.cell,"e-frozen-right-header")||Wt(e.cell,"e-frozen-right-content"))&&(a=s.getRowObjectFromUID(t.getAttribute("data-uid"),!1,!0)),r.refreshTD(e.cell,i,a,e.value),r.parent.isReact&&(e.cell=r.newReactTd)}if(Object(m.ib)([t],["e-editedrow","e-batchrow"]),Object(m.ib)([e.cell],["e-editedbatchcell","e-boolcell"]),(!Object(m.X)(e.value)&&e.value.toString()===(Object(m.X)(r.cellDetails.value)?"":r.cellDetails.value).toString()&&!r.isColored||Object(m.X)(e.value)&&Object(m.X)(r.cellDetails.value)&&!e.cell.parentElement.classList.contains("e-insertedrow"))&&(e.cell.classList.remove("e-updatedtd"),Object(m.W)()&&s.isServerRendered&&(Object(m.X)(e.value)?"":e.value).toString()===(Object(m.X)(r.cellDetails.value)?"":r.cellDetails.value).toString()&&(r.cloneCell["".concat(parseInt(t.getAttribute("aria-rowindex"),10)).concat(e.columnObject.index)].classList.contains("e-selectionbackground")?r.originalCell["".concat(parseInt(t.getAttribute("aria-rowindex"),10)).concat(e.columnObject.index)].classList.add("e-selectionbackground","e-active"):r.originalCell["".concat(parseInt(t.getAttribute("aria-rowindex"),10)).concat(e.columnObject.index)].classList.remove("e-selectionbackground","e-active"),r.cloneCell["".concat(parseInt(t.getAttribute("aria-rowindex"),10)).concat(e.columnObject.index)].replaceWith(r.originalCell["".concat(parseInt(t.getAttribute("aria-rowindex"),10)).concat(e.columnObject.index)]))),Object(m.X)(n)&&s.trigger("cellSaved",e),s.notify(W,{}),r.isColored=!1,r.parent.aggregates.length>0&&(r.parent.notify("refresh-footer-rendered",{}),r.parent.groupSettings.columns.length>0&&!r.isAddRow(r.cellDetails.rowIndex)&&r.parent.notify("group-aggregates",{})),r.preventSaveCell=!1,r.editNext){if(r.editNext=!1,r.cellDetails.rowIndex===r.index&&r.cellDetails.column.field===r.field)return;var l=s.getColumnByField(r.field);l&&l.allowEditing&&r.editCellExtend(r.index,r.field,r.isAdd)}n&&s.notify("restore-Focus",{})}}}},{key:"getDataByIndex",value:function(e){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[e].getAttribute("data-uid"));return t.changes?t.changes:t.data}},{key:"keyDownHandler",value:function(e){if(("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){var t=this.parent,i=this.getBatchChanges(),n=this.parent.getCurrentViewRecords().length+i.addedRecords.length-i.deletedRecords.length-1,r=Wt(e.target,"e-rowcell");if(r){var s=r.querySelector(".e-field");if(s){var a=this.parent.getVisibleColumns();a["tab"===e.action?a.length-1:0].field===s.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex===n&&"tab"===e.action?"Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord():this.saveCell())}}}}},{key:"addCancelWhilePaging",value:function(){this.validateFormObj()&&(this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.isColored=!1)}}]),t}(),Xn=function(e){n(r,e);var t=s(r);function r(e,i,n){var s;return p(this,r),(s=t.call(this,e,i)).parent=e,s.serviceLocator=i,s.renderer=n,s}return f(r,[{key:"closeEdit",value:function(){i(o(r.prototype),"closeEdit",this).call(this)}},{key:"addRecord",value:function(e,t){i(o(r.prototype),"addRecord",this).call(this,e,t)}},{key:"endEdit",value:function(){i(o(r.prototype),"endEdit",this).call(this)}},{key:"updateRow",value:function(e,t){i(o(r.prototype),"updateRow",this).call(this,e,t)}},{key:"deleteRecord",value:function(e,t){i(o(r.prototype),"deleteRecord",this).call(this,e,t)}},{key:"startEdit",value:function(e){i(o(r.prototype),"startEdit",this).call(this,e)}}]),r}(Hn),Gn=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"create",value:function(e){var t=si(e.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":e.column.uid}})}},{key:"read",value:function(e){return e.ej2_instances[0].value}},{key:"write",value:function(e){"datepickeredit"===e.column.editType?this.obj=new k.b(Object(m.K)(Kn(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params)):"datetimepickeredit"===e.column.editType&&(this.obj=new k.d(Object(m.K)(Kn(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params))),Object(m.W)()&&(this.obj.locale=this.parent.locale),this.obj.appendTo(e.element)}},{key:"destroy",value:function(){this.obj&&this.obj.destroy()}}]),e}();function Kn(e,t,i){var n="Dialog"!==t,r=xi(e.column.format,e.column.type),s=Oi(e.column.field,e.rowData);return{floatLabelType:n?"Never":"Always",value:s=s?new Date(s):null,format:r,placeholder:n?"":e.column.headerText,enableRtl:i,enabled:li(e.column,e.requestType,e.element)}}var Un,Yn=function(){function e(t){p(this,e),this.parent=t}return f(e,[{key:"read",value:function(e,t){return t}},{key:"write",value:function(){}},{key:"destroy",value:function(){}}]),e}(),_n=((Un=function(){function e(t,i){p(this,e),this.editType={Inline:Nn,Normal:Nn,Batch:Wn,Dialog:Xn},this.parent=t,this.serviceLocator=i,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}return f(e,[{key:"updateColTypeObj",value:function(){for(var t=this.parent.columnModel,i=0;i<t.length;i++)this.parent.editSettings.template||t[i].editTemplate?t[i].edit=Object(m.K)(new e.editCellType.templateedit(this.parent),t[i].edit||{}):t[i].edit=Object(m.K)(new e.editCellType[t[i].editType&&e.editCellType[t[i].editType]?t[i].editType:"defaultedit"](this.parent,this.serviceLocator),t[i].edit||{});this.parent.log("primary_column_missing")}},{key:"getModuleName",value:function(){return"edit"}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName())for(var t=this.parent,i=0,n=Object.keys(e.properties);i<n.length;i++)switch(n[i]){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),t.isEdit=!1,t.refresh()}}},{key:"updateEditObj",value:function(){this.editModule&&this.editModule.destroy(),this.renderer=new Ln(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)}},{key:"initialEnd",value:function(){this.updateColTypeObj()}},{key:"startEdit",value:function(e){var t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)e||(e=t.getSelectedRows()[0]);else if(!e)return void this.showDialog("EditOperationAlert",this.alertDObj);this.isLastRow=e.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex,"none"!==e.style.display&&(this.editModule.startEdit(e),Object(m.W)()||(this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{})))}}},{key:"checkLastRow",value:function(e,t){var i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&t&&"add"===t.requestType&&this.parent.height>this.parent.getContentTable().scrollHeight?Object(m.v)(e.querySelectorAll(".e-rowcell"),"e-lastrowadded"):i&&e&&e.classList&&Object(m.v)(e.querySelectorAll(".e-rowcell"),"e-lastrowcell")}},{key:"closeEdit",value:function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.querySelectorAll(".e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),Object(m.W)()||(this.refreshToolbar(),this.parent.notify("close-edit",{})))}},{key:"refreshToolbar",value:function(){this.parent.notify(W,{})}},{key:"addRecord",value:function(e,t){if(this.parent.editSettings.allowAdding){var i={startEdit:!0};e||this.parent.notify("virtual-scroll-add-action-begin",i),i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(e,t),Object(m.W)()||(this.refreshToolbar(),this.parent.notify("start-add",{})))}}},{key:"deleteRecord",value:function(e,t){var i=this.parent;i.editSettings.allowDeleting&&(t||i.getSelectedRecords().length||!Object(m.X)(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(e,t):this.showDialog("DeleteOperationAlert",this.alertDObj))}},{key:"deleteRow",value:function(e){this.deleteRowUid=e.getAttribute("data-uid");var t=this.parent.getRowObjectFromUID(this.deleteRowUid);Object(m.X)(t)||this.deleteRecord(null,t.data)}},{key:"endEdit",value:function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(Object(m.X)(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify("editNextValCell",{}),Object(m.X)(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()}},{key:"updateCell",value:function(e,t,i){this.editModule.updateCell(e,t,i)}},{key:"updateRow",value:function(e,t){this.editModule.updateRow(e,t)}},{key:"batchCancel",value:function(){this.closeEdit()}},{key:"batchSave",value:function(){this.endEdit()}},{key:"editCell",value:function(e,t){this.editModule.editCell(e,t)}},{key:"editFormValidate",value:function(){return!!this.formObj&&this.formObj.validate()}},{key:"getBatchChanges",value:function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}}},{key:"getCurrentEditCellData",value:function(){var e=this.getCurrentEditedData(this.formObj.element,{});return e[Object.keys(e)[0]]}},{key:"saveCell",value:function(){this.editModule.saveCell()}},{key:"endEditing",value:function(){this.parent.element.classList.remove("e-editing"),this.editModule.endEdit(),this.refreshToolbar()}},{key:"showDialog",value:function(e,t){t.content="<div>"+this.l10n.getConstant(e)+"</div>",t.dataBind(),t.show()}},{key:"getValueFromType",value:function(e,t){var i=t;switch(e.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==e.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==e.editType&&"datetimepickeredit"!==e.editType&&t&&t.length?i=new Date(t):""===t&&(i=null)}return i}},{key:"destroyToolTip",value:function(){var e,t=c([].slice.call(this.parent.element.querySelectorAll(".e-griderror")));try{for(t.s();!(e=t.n()).done;){var i=e.value;Object(m.hb)(i)}}catch(n){t.e(n)}finally{t.f()}this.parent.getContent().firstElementChild.style.position="relative"}},{key:"createConfirmDlg",value:function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")}},{key:"createAlertDlg",value:function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-flat",isPrimary:!0}}],"EditAlert")}},{key:"alertClick",value:function(){this.alertDObj.hide()}},{key:"dlgWidget",value:function(e,t){var i=this.parent.createElement("div",{id:this.parent.element.id+t});this.parent.element.appendChild(i);var n={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"}};n.buttons=e;var r=new b.a(n);return r.isStringTemplate=!0,r.appendTo(i),r}},{key:"dlgCancel",value:function(){this.parent.focusModule.clearIndicator(),this.parent.focusModule.restoreFocus(),this.dialogObj.hide()}},{key:"dlgOk",value:function(e){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&(this.editModule.addCancelWhilePaging(),Object(m.W)()&&this.parent.isServerRendered&&this.editModule.closeEdit()),this.executeAction()}this.dlgCancel()}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(B,this.onPropertyChanged,this),this.parent.on(F,this.initialEnd,this),this.parent.on(V,this.keyPressHandler,this),this.parent.on(X,this.updateColTypeObj,this),this.parent.on("tooltip-destroy",this.destroyToolTip,this),this.parent.on(G,this.preventBatch,this),this.parent.on("destroy-form",this.destroyForm,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(D,this.actionBeginFunction),this.parent.addEventListener(E,this.actionCompleteFunction))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(B,this.onPropertyChanged),this.parent.off(F,this.initialEnd),this.parent.off(V,this.keyPressHandler),this.parent.off(X,this.updateColTypeObj),this.parent.off("tooltip-destroy",this.destroyToolTip),this.parent.off(G,this.preventBatch),this.parent.off("destroy-form",this.destroyForm),this.parent.removeEventListener(E,this.actionCompleteFunction),this.parent.removeEventListener(D,this.actionBeginFunction))}},{key:"actionComplete",value:function(e){["add","beginEdit","save","delete","cancel"].indexOf(e.requestType)<0&&(this.parent.isEdit=!1),"batchsave"===e.requestType&&this.parent.focusModule.restoreFocus(),this.refreshToolbar()}},{key:"getCurrentEditedData",value:function(e,t){var i=this.parent;if(i.editSettings.template){for(var n=[].slice.call(e.elements),r=0;r<n.length;r++)if(n[r].hasAttribute("name")&&"e-multi-hidden"!==n[r].className||n[r].classList.contains("e-multiselect")){var s=void 0,a=n[r].hasAttribute("name")?ai(n[r].getAttribute("name")):ai(n[r].getAttribute("id")),l=i.getColumnByField(a)||{field:a,type:n[r].getAttribute("type")};"checkbox"===l.type||"boolean"===l.type?s=n[r].checked:n[r].value?(s=n[r].value,n[r].ej2_instances&&n[r].ej2_instances.length&&!Object(m.X)(n[r].ej2_instances[0].value)&&(n[r].blur(),s=n[r].ej2_instances[0].value,"date"!==l.type&&"dateTime"!==l.type&&"datetime"!==l.type||!n[r].ej2_instances[0].isServerRendered||(s=n[r].value))):n[r].ej2_instances&&(s=n[r].ej2_instances[0].value),l.edit&&"string"==typeof l.edit.read?s=Object(m.V)(l.edit.read,window)(n[r],s):l.edit&&l.edit.read&&(s=l.edit.read(n[r],s)),s=i.editModule.getValueFromType(l,s),"radio"===n[r].type?n[r].checked&&v.b.setValue(l.field,s,t):v.b.setValue(l.field,s,t)}return t}for(var o=i.columnModel.filter((function(e){return e.editTemplate})),h=0;h<o.length;h++)if(e[si(o[h].field)]){var c=[].slice.call(e[si(o[h].field)]),u=(c=c.length?c:[e[si(o[h].field)]]).filter((function(e){return!Object(m.X)(e.ej2_instances)}));0===u.length&&(u=c.filter((function(e){return e.hasAttribute("name")})));for(var d=0;d<u.length;d++){var p=this.getValue(o[h],u[d],t);v.b.setValue(o[h].field,p,t)}}for(var g=[].slice.call(e.querySelectorAll(".e-field")),f=0,b=g.length;f<b;f++){var y=i.getColumnByUid(g[f].getAttribute("e-mappinguid"));if(y&&y.field){var C=this.getValue(y,g[f],t);v.b.setValue(y.field,C,t)}}return t}},{key:"getValue",value:function(e,t,i){var n=!t.ej2_instances||Object(m.W)()&&t.ej2_instances[0].isServerRendered&&("date"===e.type||"datetime"===e.type)?t.value:t.ej2_instances[0].value,r=this.parent,s=e.edit.read;return"checkbox"!==e.type&&"boolean"!==e.type||(n=t.checked),"string"==typeof s?(s=Object(m.V)(s,window),n=r.editModule.getValueFromType(e,s(t,n))):n=r.editModule.getValueFromType(e,e.edit.read(t,n)),Object(m.X)(i[e.field])&&""===n&&(n=i[e.field]),n}},{key:"onActionBegin",value:function(e){if("columnstate"===e.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{var t=this.parent.element.querySelector(".e-editedrow");if(t&&this.parent.frozenRows&&"virtualscroll"===e.requestType&&parseInt(Wt(t,"e-row").getAttribute("aria-rowindex"),10)<this.parent.frozenRows)return;"Batch"===this.parent.editSettings.mode||!this.formObj||this.formObj.isDestroyed||-1!==["filterafteropen","filterbeforeopen","filterchoicerequest","save","infiniteScroll"].indexOf(e.requestType)||e.cancel||(this.destroyWidgets(),this.destroyForm())}}},{key:"destroyWidgets",value:function(e){this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(e=e||this.parent.getVisibleColumns()).some((function(e){return!Object(m.X)(e.editTemplate)}))&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates());var t,i=c(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.edit.destroy;Object(m.W)()&&n.editTemplate&&(Object(m.jb)(this.parent.element.id+n.uid+"editTemplate","EditTemplate"),Object(m.sb)(this.parent.element.id+n.uid+"editTemplate","EditTemplate",n,!1)),n.edit.destroy&&("string"==typeof r?(r=Object(m.V)(r,window))():n.edit.destroy())}}catch(l){i.e(l)}finally{i.f()}for(var s=[].slice.call(this.formObj.element.elements),a=0;a<s.length;a++)s[a].hasAttribute("name")&&s[a].ej2_instances&&s[a].ej2_instances.length&&!s[a].ej2_instances[0].isDestroyed&&s[a].ej2_instances[0].destroy()}},{key:"destroyForm",value:function(){this.destroyToolTip(),this.formObj&&!this.formObj.isDestroyed&&this.formObj.destroy(),this.destroyToolTip()}},{key:"destroy",value:function(){var e=this.parent.element;if(e){var t=!(!e.querySelector(".e-gridheader")||!e.querySelector(".e-gridcontent"));t&&this.destroyForm(),this.removeEventListener();var i=this.dialogObj.element;i.childElementCount>0&&(this.dialogObj.destroy(),Object(m.hb)(i)),(i=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),Object(m.hb)(i)),t&&this.editModule&&this.editModule.destroy()}}},{key:"keyPressHandler",value:function(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":Wt(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(Wt(e.target,"e-gridcontent")||this.parent.frozenRows&&Wt(e.target,"e-headercontent"))||document.querySelectorAll(".e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.closeEdit())}}},{key:"preventBatch",value:function(e){this.preventObj=e,this.showDialog("BatchSaveLostChanges",this.dialogObj)}},{key:"executeAction",value:function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)}},{key:"applyFormValidation",value:function(e){var t=this.parent,i=t.isFrozenGrid(),n="Normal"===this.parent.editSettings.mode,r="Right"===this.parent.getFrozenMode()&&n?1:0,s="Dialog"!==this.parent.editSettings.mode?t.element.querySelectorAll(".e-gridform")[r]:Object(m.lb)("#"+t.element.id+"_dialogEdit_wrapper .e-gridform",document),a="Right"===this.parent.getFrozenMode()&&n?0:1,l=t.element.querySelectorAll(".e-gridform")[a],o={},h={},c={};e=e||t.getColumns();for(var u=0;u<e.length;u++)e[u].visible&&(Object(m.W)()&&e[u].editTemplate||e[u].validationRules&&Qi(e[u],a,o,h,c,e.length));if(i&&"Dialog"!==this.parent.editSettings.mode){if(this.parent.editModule.mFormObj=this.createFormObj(l,h),"Left-Right"===this.parent.getFrozenMode()){var d=t.element.querySelectorAll(".e-gridform")[2];this.parent.editModule.frFormObj=this.createFormObj(d,c)}}else o=Object(m.K)(o,h,c);this.parent.editModule.formObj=Object(m.W)()&&this.parent.editSettings.template?this.createFormObj(s,{}):this.createFormObj(s,o)}},{key:"createFormObj",value:function(e,t){var i=this;return new C.b(e,{rules:t,locale:this.parent.locale,validationComplete:function(e){i.validationComplete(e)},customPlacement:function(e,t){var n=e.getAttribute("e-mappinguid"),r={column:i.parent.getColumnByUid(n),error:t,inputElement:e,value:e.value};i.valErrorPlacement(e,t),i.parent.notify("validation-custom-placement",r)}})}},{key:"valErrorPlacement",value:function(e,t){if(this.parent.isEdit){var i=t.getAttribute("for"),n=this.getElemTable(e).querySelector("#"+i+"_Error");n?n.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(e,t,i,"")}}},{key:"getElemTable",value:function(e){var t;return"Dialog"!==this.parent.editSettings.mode&&(t=this.parent.frozenRows&&this.parent.frozenRows>(parseInt(Object(m.C)(e,".e-row").getAttribute("aria-rowindex"),10)||0)),"Dialog"!==this.parent.editSettings.mode?t?this.parent.getHeaderTable():this.parent.getContentTable():Object(m.lb)("#"+this.parent.element.id+"_dialogEdit_wrapper",document)}},{key:"resetElemPosition",value:function(e,t){var i=Wt(t.element,"e-rowcell");if(i){var n=i.getBoundingClientRect().right,r=e.getBoundingClientRect().right;r>n&&(e.style.left=e.offsetLeft-(r-n)+"px")}}},{key:"validationComplete",value:function(e){if(this.parent.isEdit){var t=this.getElemTable(e.element).querySelector("#"+e.inputName+"_Error");t&&("failure"===e.status?(t.style.display="",this.resetElemPosition(t,e)):t.style.display="none")}}},{key:"createTooltip",value:function(e,t,i,n){var r=this.parent.getColumnByField(i),s="Left-Right"===this.parent.getFrozenMode()&&"Normal"===this.parent.editSettings.mode&&"frozen-right"===r.getFreezeTableName()?this.frFormObj.element:this.formObj.element,a=this.parent.getContent().firstElementChild,l=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();l&&(a=this.parent.getMovableVirtualContent());var o,h,c=a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth,u="Dialog"!==this.parent.editSettings.mode,d=Object(m.C)(e,".e-rowcell"),p=Object(m.C)(e,".e-row"),g=this.parent.getContent().querySelector(".e-frozencontent"),f=!1,v=!1,y=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,C=[].slice.call(g?this.parent.getFrozenVirtualContent().querySelectorAll(".e-row"):this.parent.getContent().querySelectorAll(".e-row"));if("Batch"===this.parent.editSettings.mode&&y>1&&C.length>=y&&C[C.length-1].getAttribute("aria-rowindex")===p.getAttribute("aria-rowindex")&&(v=!0),u){if(this.parent.frozenRows){var w=l?this.parent.getFrozenVirtualHeader().querySelector("tbody").children:this.parent.getHeaderTable().querySelector("tbody").children;f=(o=w.length>(parseInt(p.getAttribute("aria-rowindex"),10)||0))&&parseInt(p.getAttribute("aria-rowindex"),10)===w.length-1}(f||y>1&&C.length>=y&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||d.classList.contains("e-lastrowcell")&&!p.classList.contains("e-addedrow"))||v)&&(h=!0)}var k=u?o?this.parent.getHeaderTable():this.parent.getContentTable():Object(m.lb)("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),S=k.getBoundingClientRect(),O=u?this.parent.element.getBoundingClientRect().left:S.left,x=Object(m.C)(e,"td"),j=x?x.getBoundingClientRect():e.parentElement.getBoundingClientRect(),R=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:i+"_Error",styles:"display:"+n+";top:"+((o?j.top+j.height:j.bottom-S.top-(l?g.scrollTop:0))+k.scrollTop+9)+"px;left:"+(j.left-O+k.scrollLeft+j.width/2)+"px;max-width:"+j.width+"px;text-align:center;"});u&&S.left<O&&(R.style.left=parseInt(R.style.left,10)-S.left+O+"px");var D,E=this.parent.createElement("div",{className:"e-tip-content"});E.appendChild(t),h?((D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),R.appendChild(E),R.appendChild(D),(l||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?(("Normal"===this.parent.editSettings.mode?Object(m.C)(e,".e-editcell"):Object(m.C)(e,".e-table")).style.position="relative",R.style.position="absolute","Batch"===this.parent.editSettings.mode||Object(m.C)(e,".e-frozencontent")||Object(m.C)(e,".e-frozenheader")||this.parent.frozenRows&&!l?s.appendChild(R):this.mFormObj.element.appendChild(R)):this.formObj.element.appendChild(R),!h&&u&&a.getBoundingClientRect().bottom<j.bottom+j.height&&(a.scrollTop=a.scrollTop+R.offsetHeight+D.scrollHeight);var I=parseInt(document.defaultView.getComputedStyle(R,null).getPropertyValue("font-size"),10);if(R.getBoundingClientRect().width<j.width&&R.querySelector("label").getBoundingClientRect().height/(1.2*I)>=2&&(R.style.width=R.style.maxWidth),R.style.left=(l||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?x.offsetLeft+(x.offsetWidth/2-R.offsetWidth/2)+"px":parseInt(R.style.left,10)-R.offsetWidth/2+"px",u&&!c&&!this.parent.allowPaging||l||this.parent.frozenRows){a.style.position="static";var M=Object(b.f)(x,R);R.style.top=M.top+j.height+9+"px"}if(h){if(!c||l||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization)R.style.bottom=j.height+9+"px";else{var F=a.scrollWidth>a.offsetWidth?ni():0;R.style.bottom=this.parent.height-a.querySelector("table").offsetHeight-F+j.height+9+"px"}if(C.length<y&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType){var T=(this.parent.frozenRows?this.parent.frozenRows+(C.length-1):C.length-1)*this.parent.getRowHeight(),A=this.parent.getContent().clientHeight-T;R.style.bottom=A+9+"px"}R.style.top=null}}},{key:"checkColumnIsGrouped",value:function(e){return!(e.visible||this.parent.groupSettings.columns.indexOf(e.field)>-1)}}],[{key:"AddEditors",value:function(t){e.editCellType=Object(m.K)(e.editCellType,t)}}]),e}()).editCellType={dropdownedit:Pn,numericedit:qn,datepickeredit:Gn,datetimepickeredit:Gn,booleanedit:Bn,defaultedit:Vn,templateedit:Yn},Un),Qn=function(){function e(t){p(this,e),this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=t}return f(e,[{key:"getFData",value:function(e,t){return yi(t,{},e,this.foreignKeyData[t.field])[0]}},{key:"getGridRowModel",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=[],s=t.length;if(s){for(var a=0;a<s;a++,n++){var l={isExpand:!1};l.data=t[a],l.index=n,i.childGrid&&("All"===i.hierarchyPrintMode?l.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[n]&&(l.isExpand=i.expandedRows[n].isExpand));var o=new _(l);o.cells=this.generateCells(e,i),r.push(o)}this.processColumns(r)}return r}},{key:"generateCells",value:function(e,t){var i=[];if(t.childGridLevel)for(var n=t.childGridLevel,r=0;n>r;r++)i.push(this.generateCell({},K.Indent));var s,a=c(e);try{for(a.s();!(s=a.n()).done;){var l=s.value;i.push(this.generateCell(l,K.Data))}}catch(o){a.e(o)}finally{a.f()}return i}},{key:"getColumnData",value:function(e){var t,i=this,n=[],r=e.getForeignKeyColumns();if(r.length){for(var s=0;s<r.length;s++){var a="result"in r[s].dataSource?new v.a(r[s].dataSource.result):r[s].dataSource;n.push(a.executeQuery(new v.g))}t=Promise.all(n).then((function(e){for(var t=0;t<r.length;t++)i.foreignKeyData[r[t].field]=e[t].result}))}return t}},{key:"getHeaders",value:function(e,t){this.hideColumnInclude=!!t,this.colDepth=Ei(e);for(var i=[],n=0;n<this.colDepth;n++)i[n]=new _({}),i[n].cells=[];return i=this.processColumns(i),{rows:i=this.processHeaderCells(i,e),columns:this.generateActualColumns(e)}}},{key:"getConvertedWidth",value:function(e){var t=parseFloat(e);return-1!==e.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t}},{key:"generateActualColumns",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=c(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.commands||(r.columns?(r.visible||this.hideColumnInclude)&&0!==this.getCellCount(r,0)&&this.generateActualColumns(r.columns,i):(r.visible||this.hideColumnInclude)&&i.push(r))}}catch(s){n.e(s)}finally{n.f()}return i}},{key:"processHeaderCells",value:function(e,t){for(var i=t,n=0;n<i.length;n++)i[n].commands||(e=this.appendGridCells(i[n],e,0));return e}},{key:"appendGridCells",value:function(e,t,i){if(e.columns||!1===e.visible&&!this.hideColumnInclude||e.commands){if(e.columns){var n,r=this.getCellCount(e,0);r&&t[i].cells.push(new Q({cellType:K.StackedHeader,column:e,colSpan:r}));for(var s=0,a=e.columns.length;s<a;s++)e.columns[s].visible&&!n&&(n=!0),t=this.appendGridCells(e.columns[s],t,i+1)}}else t[i].cells.push(this.generateCell(e,K.Header,this.colDepth-i,i));return t}},{key:"generateCell",value:function(e,t,i,n){var r={visible:e.visible,isDataCell:t===K.Data,column:e,cellType:t,rowSpan:i,index:n};return(!r.rowSpan||r.rowSpan<2)&&delete r.rowSpan,new Q(r)}},{key:"processColumns",value:function(e){var t=this.parent,i=[];t.enableColumnVirtualization&&(i=t.getColumnIndexesInView());for(var n=0,r=e.length;n<r;n++)if(t.allowGrouping)for(var s=0,a=t.groupSettings.columns.length;s<a;s++)t.enableColumnVirtualization&&-1===i.indexOf(s)||e[n].cells.splice(0,0,this.generateCell({},K.HeaderIndent));return e}},{key:"getCellCount",value:function(e,t){if(e.columns)for(var i=0;i<e.columns.length;i++)t=this.getCellCount(e.columns[i],t);else(e.visible||this.hideColumnInclude)&&t++;return t}},{key:"checkAndExport",value:function(e,t){Object.keys(e).some((function(t){return!e[t]}))||t()}},{key:"failureHandler",value:function(e,t,i){var n=this;return function(){e[t.id]=!0,n.checkAndExport(e,i)}}},{key:"createChildGrid",value:function(e,t,i,n){var r=new Ot(this.parent.detailRowModule.getGridModel(e,t,i));e.isPrinting=!1,r.parentDetails={parentID:e.element.id,parentPrimaryKeys:e.getPrimaryKeyFieldNames(),parentKeyField:e.childGrid.queryString,parentKeyFieldValue:Object(m.V)(r.queryString,t.data),parentRowData:t.data};var s=Qt("child-grid"),a=Object(m.F)("div",{id:s,styles:"display: none"});return document.body.appendChild(a),r.id=s,n[s]=!1,{childGrid:r,element:a}}},{key:"getGridExportColumns",value:function(e){for(var t=[],i=0,n=e;i<n.length;i++)"checkbox"!==n[i].type&&t.push(n[i]);return t}}],[{key:"getQuery",value:function(e,t){var i=t.generateQuery(!0).requiresCount();return t.isRemote()&&(e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length?i.lazyLoad=[]:i.take(e.pageSettings.totalRecordsCount)),i}}]),e}(),Jn=function(){function e(t){p(this,e),this.valueFormatter=new j(t),this.internationalization=new m.n(t)}return f(e,[{key:"returnFormattedValue",value:function(e,t){return!Object(m.X)(e.value)&&e.value?this.valueFormatter.getFormatFunction(t)(e.value):""}},{key:"formatCellValue",value:function(e,t){if(e.isForeignKey&&(e.value=Object(m.V)(e.column.foreignKeyValue,yi(e.column,{},e.value)[0])),"number"===e.column.type&&void 0!==e.column.format&&""!==e.column.format)return e.value||0===e.value?this.internationalization.getNumberFormat({format:e.column.format})(e.value):"";if("boolean"===e.column.type&&""!==e.value)return e.value?"true":"false";if("date"!==e.column.type&&"datetime"!==e.column.type&&"time"!==e.column.type||void 0===e.column.format)return(Object(m.X)(e.column.type)||Object(m.X)(e.value))&&Object(m.X)(e.value)?"":e.value.toString();if("string"==typeof e.value&&(e.value=new Date(e.value)),"string"==typeof e.column.format){var i,n=e.column.format;return i="date"===e.column.type?t?{type:"date",format:n}:{type:"date",skeleton:n}:"time"===e.column.type?t?{type:"time",format:n}:{type:"time",skeleton:n}:t?{type:"dateTime",format:n}:{type:"dateTime",skeleton:n},this.returnFormattedValue(e,i)}return e.column.format instanceof Object&&void 0===e.column.format.type?e.value.toString():(r="date"===e.column.type?{type:e.column.format.type,format:e.column.format.format,skeleton:e.column.format.skeleton}:"time"===e.column.type?{type:"time",format:e.column.format.format,skeleton:e.column.format.skeleton}:{type:"dateTime",format:e.column.format.format,skeleton:e.column.format.skeleton},this.returnFormattedValue(e,r));var r}}]),e}(),Zn=function(){function e(t,i){p(this,e),this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isElementIdChanged=!1,this.foreignKeyData={},this.gridPool={},this.parent=t,this.helper=new Qn(t),this.locator=i,this.l10n=this.locator.getService("localization")}return f(e,[{key:"getModuleName",value:function(){return"ExcelExport"}},{key:"init",value:function(e){null!==e.element&&""===e.element.id&&(e.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=e,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new Jn(e.locale),e.id=Qt("main-grid"),this.gridPool[e.id]=!1)}},{key:"Map",value:function(e,t,i,n,r,s){var a=e;this.gridPool={},e.childGrid&&(Object(m.X)(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=ji(e).expandedRows);var l={requestType:"beforeExcelExport",gridObject:a,cancel:!1,isMultipleExport:i,workbook:n,isCsv:r,isBlob:s};return a.trigger("beforeExcelExport",l),l.cancel?new Promise((function(e,t){return e()})):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new Y(a),this.isExporting=!0,this.isBlob=l.isBlob,this.isCsvExport=!!l.isCsv&&l.isCsv,Et(t)&&It(t,a),this.processRecords(a,t,l.isMultipleExport,l.workbook))}},{key:"exportingSuccess",value:function(e){this.isExporting=!1,this.parent.trigger("excelExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),e(this.book)}},{key:"processRecords",value:function(e,t,i,n){var r=this;if(Object(m.X)(t)||Object(m.X)(t.dataSource)){if(Object(m.X)(t)||"CurrentPage"!==t.exportType){var s=[];return s.push(this.data.getData({},Qn.getQuery(e,this.data))),s.push(this.helper.getColumnData(e)),new Promise((function(a,l){Promise.all(s).then((function(s){r.init(e),r.processInnerRecords(e,t,i,n,s[0]).then((function(){r.exportingSuccess(a)}))})).catch((function(e){l(r.book),r.parent.trigger("actionFailure",e)}))}))}return new Promise((function(s,a){r.init(e),r.processInnerRecords(e,t,i,n,r.parent.getCurrentViewRecords()),r.exportingSuccess(s)}))}t.dataSource instanceof v.a||(t.dataSource=new v.a(t.dataSource));var a=t.query?t.query:new v.g;return(Object(m.X)(a.isCountRequired)||e.aggregates)&&(a.isCountRequired=!0),new Promise((function(s,l){t.dataSource.executeQuery(a).then((function(a){r.init(e),r.processInnerRecords(e,t,i,n,a).then((function(){r.exportingSuccess(s)}))}))}))}},{key:"processInnerRecords",value:function(e,t,i,n,r){var s=this;this.groupedColLength=e.groupSettings.columns.length;var a,l=5,o=[],h=!Object(m.X)(t);return h&&!Object(m.X)(t.multipleExport)&&(this.expType=Object(m.X)(t.multipleExport.type)?"AppendToSheet":t.multipleExport.type,Object(m.X)(t.multipleExport.blankRows)||(l=t.multipleExport.blankRows)),Object(m.X)(n)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[]):"NewSheet"===this.expType?(this.workSheet=n.worksheets,this.rows=[],this.columns=[],this.styles=n.styles):(this.workSheet=[],this.rows=n.worksheets[0].rows,this.columns=n.worksheets[0].columns,this.styles=n.styles,this.rowLength=this.rows[this.rows.length-1].index+l,this.rowLength++),h&&(Object(m.X)(i)?(Object(m.X)(t.header)||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(m.X)(t.footer)||(this.footer=JSON.parse(JSON.stringify(t.footer)))):(Object(m.X)(t.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(m.X)(t.footer)||"AppendToSheet"===this.expType&&i||(this.footer=JSON.parse(JSON.stringify(t.footer))))),this.includeHiddenColumn=!!h&&t.includeHiddenColumn,new Promise((function(i,n){e.childGridLevel=0,o=s.processGridExport(e,t,r),s.globalResolve=i,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)})).then((function(){var r=[];s.organiseRows(o,o[0].index,r),s.rows=s.rows.concat(r),Object(m.X)(s.footer)||("AppendToSheet"===s.expType&&!i||"NewSheet"===s.expType)&&s.processExcelFooter(s.footer);var l={};if(s.columns.length>0&&(l.columns=s.columns),l.rows=s.rows,l.enableRtl=s.parent.enableRtl,s.workSheet.push(l),s.book.worksheets=s.workSheet,s.book.styles=s.styles,e.notify("finalPageSetup",s.book),!i){if(s.isCsvExport){Object(m.W)()&&e.isServerRendered&&(s.book.isServerRendered=e.isServerRendered),h&&!Object(m.X)(t.separator)&&","!==t.separator&&(a=t.separator);var c=new O.a(s.book,"csv",e.locale,e.currencyCode,a);s.isBlob?s.blobPromise=c.saveAsBlob("text/csv"):c.save(h&&t.fileName?t.fileName:"Export.csv")}else{var u=new O.a(s.book,"xlsx",e.locale,e.currencyCode);s.isBlob?s.blobPromise=u.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):u.save(h&&t.fileName?t.fileName:"Export.xlsx")}s.isElementIdChanged&&(e.element.id=""),delete e.expandedRows}return n}))}},{key:"organiseRows",value:function(e,t,i){if(!e.length)return t;for(var n=0;n<e.length;n++){var r=e[n],s=r.childRows;s?(r.index=t++,delete r.childRows,i.push(r),t=this.organiseRows(s,t,i)):(r.index=t++,i.push(r))}return t}},{key:"processGridExport",value:function(e,t,i){var n=[],r=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(m.X)(t)||Object(m.X)(t.theme)||(this.theme=t.theme),e.childGrid&&!Object(m.X)(t)&&(e.hierarchyPrintMode=t.hierarchyExportMode||"Expanded");var s=new Qn(e),a=Et(t)?Vt(t.columns,e.enableColumnVirtualization):s.getGridExportColumns(r?e.getColumns():e.columns),l=s.getHeaders(a,this.includeHiddenColumn);return n=this.processHeaderContent(e,l,e.groupSettings.columns.length,n),n=Object(m.X)(t)||Object(m.X)(t.dataSource)||t.dataSource instanceof v.a?Object(m.X)(t)||"CurrentPage"!==t.exportType?this.processRecordContent(e,i,l,t,void 0,n,s):this.processRecordContent(e,i,l,t,e.currentViewData,n,s):this.processRecordContent(e,i,l,t,t.dataSource,n,s),e.notify("export-DataBound",{excelRows:n,type:"excel"}),n}},{key:"processRecordContent",value:function(e,t,i,n,r,s,a){var l;return l=!Object(m.X)(r)&&r.length?r:t.result,Object(m.X)(l.level)?this.processRecordRows(e,l,i,0,0,n,s,a):this.processGroupedRows(e,l,i,l.level,0,n,s,a),Object(m.X)(t.aggregates)||(Object(m.X)(r)?this.processAggregates(e,t.result.GroupGuid?t.result.records:t.result,s):this.processAggregates(e,t.result,s,r)),s}},{key:"processGroupedRows",value:function(e,t,i,n,r,s,a,l){var o,h=c(t);try{for(h.s();!(o=h.n()).done;){var u=o.value,d=[],p={};p.index=1+n;var g=e.getColumnByField(u.field),f={value:u.key,column:g,style:void 0,isForeignKey:g.isForeignColumn()},v=e.getColumnByField(u.field).headerText+": "+(g.enableGroupByFormat?u.key:this.exportValueFormatter.formatCellValue(f))+" - ",b={captionText:v+=u.count>1?u.count+" items":u.count+" item",type:this.isCsvExport?"CSV":"Excel"};this.parent.trigger("exportGroupCaption",b),p.value=b.captionText,p.style=this.getCaptionThemeStyle(this.theme);var y=new ie(e).generateRows(u);if(this.fillAggregates(e,y,t.level+t.childLevels,a,this.rowLength),d.push(p),a[a.length-1].cells.length>0){var C,w=t.level+t.childLevels+y[0].cells.length,k=0,S=c(a[a.length-1].cells);try{for(S.s();!(C=S.n()).done;){var O=C.value;O.index<w&&(w=O.index),O.index>k&&(k=O.index),d[d.length-1].index!==O.index&&d.push(O)}}catch(E){S.e(E)}finally{S.f()}for(w-p.index>1&&(p.colSpan=w-p.index);k<i.columns.length+n+t.childLevels;){var x={};x.index=k+1,x.style=this.getCaptionThemeStyle(this.theme),d.push(x),k++}}else{var j,R=0,D=c(i.columns);try{for(D.s();!(j=D.n()).done;){j.value.visible&&R++}}catch(E){D.e(E)}finally{D.f()}p.colSpan=t.childLevels+R}a[a.length-1].cells=d,this.rowLength++,this.groupedColLength<8&&n>1&&(a[a.length-1].grouping={outlineLevel:n-1,isCollapsed:!0}),!Object(m.X)(t.childLevels)&&t.childLevels>0?this.processGroupedRows(e,u.items,i,u.items.level,r,s,a,l):(r=this.processRecordRows(e,u.items,i,n,r,s,a,l),this.processAggregates(e,u,a,void 0,n,!0))}}catch(E){h.e(E)}finally{h.f()}}},{key:"processRecordRows",value:function(e,t,i,n,r,s,a,l){var o,h=1,u=[],d=c(l.getGridRowModel(i.columns,t,e,r));try{for(d.s();!(o=d.n()).done;){var p=o.value;u=[],r++,h=1;for(var g=0,f=p.cells.length;g<f;g++){var v=p.cells[g];if(v.cellType===K.Data){var b=void 0,y=v.column,C=y.field,w=Object(m.X)(C)?"":y.valueAccessor(C,p.data,y),k=Object(m.X)(w)?"":w;if(y.isForeignColumn&&y.isForeignColumn()&&(b=l.getFData(k,y),k=Object(m.V)(y.foreignKeyValue,b)),!Object(m.X)(k)){var S={},O={data:p.data,column:y,foreignKeyData:b,value:k,style:void 0,colSpan:1,cell:S};if(e.trigger("excelQueryCellInfo",O),(S=O.cell).index=h+n+e.childGridLevel,S.value=O.value,""===O.data&&e.childGridLevel&&1===h&&(O={style:{hAlign:"left"}},S.colSpan=e.getVisibleColumns().length,S.value=this.l10n.getConstant("EmptyRecord")),O.colSpan>1&&(S.colSpan=O.colSpan),Object(m.X)(O.style))S.style={name:e.element.id+"column"+(h+n)};else{var x=this.getColumnStyle(e,h+n);S.style=this.mergeOptions(this.styles[x],O.style)}u.push(S)}h++}}var j={index:this.rowLength++,cells:u};if(this.groupedColLength<8&&n>0?(j.grouping={outlineLevel:n,isCollapsed:!0},a.push(j)):a.push(j),!Object(m.X)(e.childGrid)){e.isPrinting=!0;var R=!Object(m.X)(s)&&s.exportType?s.exportType:"AllPages",D=this.helper.createChildGrid(e,p,R,this.gridPool),E=D.childGrid,I=D.element;E.actionFailure=l.failureHandler(this.gridPool,E,this.globalResolve),E.childGridLevel=e.childGridLevel+1,this.parent.trigger("exportdetaildatabound",{childGrid:E,row:p,exportProperties:s}),E.beforeDataBound=this.childGridCell(j,E,s,p),E.appendTo(I)}e.notify("export-RowDataBound",{rowObj:p,type:"excel",excelRows:a})}}catch(M){d.e(M)}finally{d.f()}return r}},{key:"childGridCell",value:function(e,t,i,n){var r=this;return function(s){t.beforeDataBound=null,s.cancel=!0,0===s.result.length&&(s.result=[""]),e.childRows=r.processGridExport(t,i,s);for(var a=r.parent.groupSettings.columns.length,l=e.childRows,o=0;o<l.length;o++)l[o].grouping={outlineLevel:a+t.childGridLevel,isCollapsed:!n.isExpand,isHidden:!n.isExpand};return t.destroy(),Object(m.I)(t.element),r.gridPool[t.id]=!0,r.helper.checkAndExport(r.gridPool,r.globalResolve),e}}},{key:"processAggregates",value:function(e,t,i,n,r,s){var a=new ee(e),l=a.getColumns();l=l.filter((function(e){return Object(m.X)(e.commands)&&"checkbox"!==e.type})),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo();var o;if(o=Object(m.X)(n)?t:n,void 0===r&&(r=0),e.groupSettings.columns.length>0&&s){var h=new te(e).generateRows(o,{level:o.level});h.length>0&&(i=this.fillAggregates(e,h,r,i))}else{r=e.groupSettings.columns.length>0&&!s?e.groupSettings.columns.length:r;var c=a.generateRows(o,t.aggregates,null,null,l);c.length>0&&!s&&(i=this.fillAggregates(e,c,r,i))}return i}},{key:"fillAggregates",value:function(e,t,i,n,r){var s,a=c(t);try{for(a.s();!(s=a.n()).done;){var l,o=s.value,h=[],u=0,d=c(o.cells);try{for(d.s();!(l=d.n()).done;){var p=l.value,g={};if(p.cellType!==K.DetailFooterIntent&&(p.visible||this.includeHiddenColumn))if(u++,p.isDataCell){var f=!Object(m.X)(p.column.footerTemplate),v=!Object(m.X)(p.column.groupFooterTemplate),b=!Object(m.X)(p.column.groupCaptionTemplate);if(g.index=u+i+e.childGridLevel,f)g.value=this.getAggreateValue(K.Summary,p.column.footerTemplate,p,o);else if(v)g.value=this.getAggreateValue(K.GroupSummary,p.column.groupFooterTemplate,p,o);else if(b)g.value=this.getAggreateValue(K.CaptionSummary,p.column.groupCaptionTemplate,p,o);else for(var y=0,C=Object.keys(o.data[p.column.field]);y<C.length;y++){C[y]===p.column.type&&(Object(m.X)(o.data[p.column.field].Sum)?Object(m.X)(o.data[p.column.field].Average)?Object(m.X)(o.data[p.column.field].Max)?Object(m.X)(o.data[p.column.field].Min)?Object(m.X)(o.data[p.column.field].Count)?Object(m.X)(o.data[p.column.field].TrueCount)?Object(m.X)(o.data[p.column.field].FalseCount)?Object(m.X)(o.data[p.column.field].Custom)||(g.value=o.data[p.column.field].Custom):g.value=o.data[p.column.field][p.column.field+" - falsecount"]:g.value=o.data[p.column.field][p.column.field+" - truecount"]:g.value=o.data[p.column.field][p.column.field+" - count"]:g.value=o.data[p.column.field][p.column.field+" - min"]:g.value=o.data[p.column.field][p.column.field+" - max"]:g.value=o.data[p.column.field][p.column.field+" - average"]:g.value=o.data[p.column.field][p.column.field+" - sum"])}g.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(p.column,g.style,p.column.field);var w=p.attributes.style;w.textAlign&&(g.style.hAlign=w.textAlign.toLowerCase()),this.parent.trigger("excelAggregateQueryCellInfo",{row:o,type:f?"Footer":v?"GroupFooter":"GroupCaption",style:g}),h.push(g)}else void 0===r&&(g.index=u+i+e.childGridLevel,g.style=this.getCaptionThemeStyle(this.theme),h.push(g))}}catch(O){d.e(O)}finally{d.f()}if(Object(m.X)(r)){var k={};if(this.groupedColLength<8&&this.groupedColLength>0){var S={outlineLevel:n[n.length-1].grouping.outlineLevel,isCollapsed:!0};k={index:this.rowLength++,cells:h,grouping:S}}else k={index:this.rowLength++,cells:h};n.push(k)}else n.push({index:r,cells:h})}}catch(O){a.e(O)}finally{a.f()}return n}},{key:"aggregateStyle",value:function(e,t,i){var n=this.parent.getColumnByField(i);if("object"==typeof e.format){var r=e.format;t.numberFormat=Object(m.X)(r.format)?r.skeleton:r.format,Object(m.X)(r.type)||(t.type=r.type.toLowerCase())}else t.numberFormat=e.format;!Object(m.X)(n)&&Object(m.X)(t.type)&&(t.type=n.type.toLowerCase())}},{key:"getAggreateValue",value:function(e,t,i,n){var r,s={};s[Object(m.P)(K,i.cellType)]=Object(m.E)(t);var a=n.data[i.column.field?i.column.field:i.column.columnName];return this.parent.isReact||this.parent.isVue?(r=s[Object(m.P)(K,i.cellType)](a,this.parent),this.parent.isReact&&this.parent.renderTemplates()):r=s[Object(m.P)(K,i.cellType)](a),r[0].textContent}},{key:"mergeOptions",value:function(e,t){for(var i={},n=Object.keys(e),r=0;r<n.length;r++)"name"!==n[r]&&(i[n[r]]=e[n[r]]);n=Object.keys(t);for(var s=0;s<n.length;s++)"name"!==n[s]&&(i[n[s]]=t[n[s]]);return i}},{key:"getColumnStyle",value:function(e,t){var i,n=0,r=c(this.styles);try{for(r.s();!(i=r.n()).done;){if(i.value.name===e.element.id+"column"+t)return n;n++}}catch(s){r.e(s)}finally{r.f()}}},{key:"processHeaderContent",value:function(e,t,i,n){var r=t.rows,s=t.columns,a=[];if(i>0)for(var l=0;l!==i;)this.columns.push({index:l+1,width:30}),l++;for(var o=0;o<r.length;o++){for(var h=1+i,c=[],u=0;u<r[o].cells.length;u++){var d={},p={},g=r[o].cells[u];if(g.cellType!==K.HeaderIndent&&g.cellType!==K.DetailHeader){for(var f={contains:!0,index:1};f.contains;)if(h=(f=this.getIndex(a,1,h)).index,!f.contains){p.index=f.index+e.childGridLevel;break}if(!Object(m.X)(g.rowSpan)&&1!==g.rowSpan){p.rowSpan=g.rowSpan;for(var v=1;v<g.rowSpan+1;v++){var b={rowIndex:0,columnIndex:0};b.rowIndex=v,b.columnIndex=h,a.push(b)}}Object(m.X)(g.colSpan)||1===g.colSpan||(p.colSpan=g.colSpan,h=h+p.colSpan-1),p.value=g.column.headerText,d=this.getHeaderThemeStyle(this.theme),Object(m.X)(g.column.textAlign)||(d.hAlign=g.column.textAlign.toLowerCase()),Object(m.X)(g.column.headerTextAlign)||(d.hAlign=g.column.headerTextAlign.toLowerCase());var y={cell:p,gridCell:g,style:d};e.trigger("excelHeaderQueryCellInfo",y),p.style=y.style,c.push(p),h++}}n.push({index:this.rowLength++,cells:c})}for(var C=0;C<s.length;C++)this.parseStyles(e,s[C],this.getRecordThemeStyle(this.theme),i+C+1);return n}},{key:"getHeaderThemeStyle",value:function(e){var t={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return Object(m.X)(e)||Object(m.X)(e.header)||(t=this.updateThemeStyle(e.header,t)),t}},{key:"updateThemeStyle",value:function(e,t){return Object(m.K)(t,e)}},{key:"getCaptionThemeStyle",value:function(e){var t={fontSize:13,backColor:"#F6F6F6"};return Object(m.X)(e)||Object(m.X)(e.caption)||(t=this.updateThemeStyle(e.caption,t)),t}},{key:"getRecordThemeStyle",value:function(e){var t={fontSize:13,borders:{color:"#E0E0E0"}};return Object(m.X)(e)||Object(m.X)(e.record)||(t=this.updateThemeStyle(e.record,t)),t}},{key:"processExcelHeader",value:function(e){if(!Object(m.X)(e.rows)&&("NewSheet"===this.expType||1===this.rowLength)){var t;this.rowLength=void 0===e.headerRows?e.rows.length:e.headerRows,t=this.rowLength<e.rows.length?this.rowLength:e.rows.length,this.rowLength++;for(var i=0;i<t;i++){var n=e.rows[i];(null===n.index||Object(m.X)(n.index))&&(n.index=i+1),this.updatedCellIndex(n)}}}},{key:"updatedCellIndex",value:function(e){for(var t=e.cells.length,i=0;i<t;i++){var n=e.cells[i];(null===n.index||Object(m.X)(n.index))&&(n.index=i+1)}this.rows.push(e)}},{key:"processExcelFooter",value:function(e){if(!Object(m.X)(e.rows)){var t;void 0===e.footerRows?this.rowLength+=e.rows.length:e.footerRows>e.rows.length?(this.rowLength+=e.footerRows-e.rows.length,t=e.rows.length):t=e.footerRows;for(var i=0;i<t;i++){var n=e.rows[i];null==n.index?n.index=this.rowLength++:n.index+=this.rowLength,this.updatedCellIndex(n)}}}},{key:"getIndex",value:function(e,t,i){var n,r=c(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(s.rowIndex===t&&s.columnIndex===i)return{contains:!0,index:i+=1}}}catch(a){r.e(a)}finally{r.f()}return{contains:!1,index:i}}},{key:"parseStyles",value:function(e,t,i,n){if(!Object(m.X)(t.format))if("object"==typeof t.format){var r=t.format;i.numberFormat=Object(m.X)(r.format)?r.skeleton:r.format,Object(m.X)(r.type)||(i.type=r.type.toLowerCase())}else i.numberFormat=t.format,i.type=t.type;Object(m.X)(t.textAlign)||(i.hAlign=t.textAlign.toLowerCase()),Object.keys(i).length>0&&(i.name=e.element.id+"column"+n,this.styles.push(i)),Object(m.X)(t.width)||this.columns.push({index:n+e.childGridLevel,width:"number"==typeof t.width?t.width:this.helper.getConvertedWidth(t.width)})}},{key:"destroy",value:function(){}}]),e}(),$n=function(){function e(t){p(this,e),this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.headerOnPages=[],this.drawPosition={xPosition:0,yPosition:0},this.parent=t,this.helper=new Qn(t),this.gridPool={}}return f(e,[{key:"getModuleName",value:function(){return"PdfExport"}},{key:"init",value:function(e){this.exportValueFormatter=new Jn(e.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=e,this.isGrouping=!1,this.isExporting=!0,e.id=Qt("main-grid"),this.gridPool[e.id]=!1,this.pdfPageSettings=new x.m}},{key:"exportWithData",value:function(e,t,i,n,r,s,a){var l=this;this.init(e),this.pdfDocument=Object(m.X)(t)?new x.e:t,this.processExport(e,n,r,s).then((function(){l.isExporting=!1,e.trigger("pdfExportComplete",l.isBlob?{promise:l.blobPromise}:{}),l.parent.log("exporting_complete",l.getModuleName()),i(l.pdfDocument)})).catch((function(e){a(l.pdfDocument),l.parent.trigger("actionFailure",e)}))}},{key:"Map",value:function(e,t,i,n,r){var s=this;this.data=new Y(this.parent),this.isBlob=r,this.gridPool={},e.childGrid&&(Object(m.X)(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=ji(e).expandedRows);var a={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0}};if(Object(m.W)()||(a.gridObject=e),e.trigger("beforePdfExport",a),!0===a.cancel)return new Promise((function(e,t){return e()}));if(Et(t)&&It(t,e),this.headerOnPages=a.headerPageNumbers,this.drawPosition=a.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),!Object(m.X)(t)&&!Object(m.X)(t.dataSource)&&t.dataSource instanceof v.a)return new Promise((function(r,a){t.dataSource.executeQuery(new v.g).then((function(l){s.exportWithData(e,n,r,l,t,i,a)}))}));if(Object(m.X)(t)||"CurrentPage"!==t.exportType){var l=[];return l.push(this.data.getData({},Qn.getQuery(e,this.data))),l.push(this.helper.getColumnData(e)),new Promise((function(r,a){Promise.all(l).then((function(l){s.init(e),s.pdfDocument=Object(m.X)(n)?new x.e:n,s.processExport(e,l[0],t,i).then((function(){s.isExporting=!1,e.trigger("pdfExportComplete",s.isBlob?{promise:s.blobPromise}:{}),s.parent.log("exporting_complete",s.getModuleName()),r(s.pdfDocument)})).catch((function(e){a(s.pdfDocument),s.parent.trigger("actionFailure",e)}))}))}))}return new Promise((function(r,a){s.exportWithData(e,n,r,s.parent.getCurrentViewRecords(),t,i,a)}))}},{key:"processExport",value:function(e,t,i,n){var r,s=this,a=this.pdfDocument.sections.add();this.processSectionExportProperties(a,i);var l=a.pages.add();return new Promise((function(n,a){r=s.processGridExport(e,t,i),s.globalResolve=n,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)})).then((function(){return r.draw(l,s.drawPosition.xPosition,s.drawPosition.yPosition),s.drawHeader(i),n||(s.isBlob?s.blobPromise=s.pdfDocument.save():!Object(m.X)(i)&&i.fileName?s.pdfDocument.save(i.fileName):s.pdfDocument.save("Export.pdf"),s.pdfDocument.destroy(),delete e.expandedRows),s.pdfDocument}))}},{key:"processSectionExportProperties",value:function(e,t){return Object(m.X)(t)||Object(m.X)(t.pageOrientation)&&Object(m.X)(t.pageSize)||(this.pdfPageSettings.orientation="Landscape"===t.pageOrientation?x.l.Landscape:x.l.Portrait,this.pdfPageSettings.size=this.getPageSize(t.pageSize),e.setPageSettings(this.pdfPageSettings)),e}},{key:"processGridExport",value:function(e,t,i){var n=!0,r=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(m.X)(i)||(this.gridTheme=i.theme,Object(m.W)()&&!Object(m.X)(this.gridTheme)&&this.getGridPdfFont(this.gridTheme),n=!!Object(m.X)(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);var s=new Qn(e),a=this.processExportProperties(i,t.result),l=Et(i)?Vt(i.columns,e.enableColumnVirtualization):s.getGridExportColumns(r?e.getColumns():e.columns);l=l.filter((function(e){return Object(m.X)(e.commands)}));var o=!1;e.groupSettings.columns.length&&(o=!0),e.childGrid&&!Object(m.X)(i)&&(e.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var h=new x.h,c=this.getHeaderThemeStyle(),u=c.border,d=c.font,p=c.brush,g=s.getHeaders(l,this.hideColumnInclude),f=g.columns;h=this.processGridHeaders(e.groupSettings.columns.length,h,g.rows,f,u,d,p,e,n,l),this.setColumnProperties(f,h,s,e,n);var v=this.getSummaryCaptionThemeStyle();if(!Object(m.X)(a)&&a.length){if(o?(Object(m.X)(v.border)||(u=v.border),this.processGroupedRecords(h,a,f,e,u,0,v.font,v.brush,v.backgroundBrush,t,i,s,0)):this.processRecord(u,f,e,a,h,0,i,s,0),!Object(m.X)(t.aggregates)){var b,y=new ee(e),C=y.getColumns();C=C.filter((function(e){return Object(m.X)(e.commands)&&"checkbox"!==e.type})),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo(),b=this.customDataSource?y.generateRows(a,t.aggregates):this.currentViewData?y.generateRows(this.parent.getCurrentViewRecords(),t.aggregates):o?y.generateRows(a.records,t.aggregates):y.generateRows(t.result,t.aggregates,null,null,C),this.processAggregates(b,h,u,v.font,v.brush,v.backgroundBrush,!1)}}else h.rows.addRow().style.setBorder(u);return h}},{key:"getSummaryCaptionThemeStyle",value:function(){if(Object(m.X)(this.gridTheme)||Object(m.X)(this.gridTheme.caption))return{font:new x.q(x.f.Helvetica,9.75),brush:new x.p(new x.c(0,0,0)),backgroundBrush:new x.p(new x.c(246,246,246))};var e=Object(m.X)(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,t=Object(m.X)(this.gridTheme.caption.fontName)?x.f.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),i=this.getFontStyle(this.gridTheme.caption),n=new x.c(0,0,0);if(!Object(m.X)(this.gridTheme.caption.fontColor)){var r=this.hexToRgb(this.gridTheme.caption.fontColor);n=new x.c(r.r,r.g,r.b)}var s=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,a=new x.q(t,e,i);return Object(m.X)(this.gridTheme.caption.font)||(a=this.gridTheme.caption.font),{font:a,brush:new x.p(n),backgroundBrush:new x.p(new x.c(246,246,246)),border:s}}},{key:"getGridPdfFont",value:function(e){var t=0;if(e.header&&e.header.font){var i=e.header.font.fontFamily,n=e.header.font.fontSize,r=e.header.font.fontStyle;if(t=Object(m.X)(x.g[r])?0:x.g[r],e.header.font.isTrueType)e.header.font=new x.t(i,n,t);else{var s=Object(m.X)(i)?x.f.Helvetica:this.getFontFamily(i);e.header.font=new x.q(s,n,t)}}if(e.caption&&e.caption.font){var a=e.caption.font.fontFamily,l=e.caption.font.fontSize,o=e.caption.font.fontStyle;if(t=Object(m.X)(x.g[o])?0:x.g[o],e.caption.font.isTrueType)e.caption.font=new x.t(a,l,t);else{var h=Object(m.X)(a)?x.f.Helvetica:this.getFontFamily(a);e.caption.font=new x.q(h,l,t)}}if(e.record&&e.record.font){var c=e.record.font.fontFamily,u=e.record.font.fontSize,d=e.record.font.fontStyle;if(t=Object(m.X)(x.g[d])?0:x.g[d],e.record.font.isTrueType)e.record.font=new x.t(c,u,t);else{var p=Object(m.X)(c)?x.f.Helvetica:this.getFontFamily(c);e.record.font=new x.q(p,u,t)}}}},{key:"getHeaderThemeStyle",value:function(){var e=new x.b;if(Object(m.X)(this.gridTheme)||Object(m.X)(this.gridTheme.header))return e.all=new x.o(new x.c(234,234,234)),{border:e,font:new x.q(x.f.Helvetica,10.5),brush:new x.p(new x.c(102,102,102))};var t=Object(m.X)(this.gridTheme.header.fontName)?x.f.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),i=this.getFontStyle(this.gridTheme.header),n=Object(m.X)(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,r=new x.c;if(!Object(m.X)(this.gridTheme.header.fontColor)){var s=this.hexToRgb(this.gridTheme.header.fontColor);r=new x.c(s.r,s.g,s.b)}var a=new x.q(t,n,i);return Object(m.X)(this.gridTheme.header.font)||(a=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:a,brush:new x.p(r)}}},{key:"processGroupedRecords",value:function(e,t,i,n,r,s,a,l,o,h,u,d,p){var g,f=this,v=s,b=c(t);try{var y=function(){var s=g.value,c=e.rows.addRow(),b=n.getColumnByField(s.field),y={value:s.key,column:b,style:void 0,isForeignKey:b.isForeignColumn()},C=f.parent.getColumnByField(s.field).headerText+": "+(b.enableGroupByFormat?s.key:f.exportValueFormatter.formatCellValue(y))+" - "+s.count+(t.count>1?" items":" item");f.parent.trigger("exportGroupCaption",{captionText:C,type:"PDF"},(function(g){var b;c.cells.getCell(v).value=g.captionText,c.cells.getCell(v+1).style.stringFormat=new x.r(x.s.Left),c.style.setBorder(r),c.style.setFont(a),c.style.setTextBrush(l),c.style.setBackgroundBrush(o);var y=new ie(n);b=Object(m.X)(s.items.records)?y.generateRows(s.items,s):y.generateRows(s.items.records,s),Object(m.X)(b)||0!==b.length||(c.cells.getCell(v+1).columnSpan=e.columns.count-(v+1)),!Object(m.X)(t.childLevels)&&t.childLevels>0?(f.processAggregates(b,e,r,a,l,o,!0,c,v),f.processGroupedRecords(e,s.items,i,n,r,v+1,a,l,o,h,u,d,p),b=new te(n).generateRows(s.items.records,s),f.processAggregates(b,e,r,a,l,o,!1)):(f.processAggregates(b,e,r,a,l,o,!0,c,v),p=f.processRecord(r,i,n,s.items,e,v+1,u,d,p),b=new te(n).generateRows(s.items,s),f.processAggregates(b,e,r,a,l,o,!1,null,null,!0))}))};for(b.s();!(g=b.n()).done;)y()}catch(C){b.e(C)}finally{b.f()}}},{key:"processGridHeaders",value:function(e,t,i,n,r,s,a,l,o,h){var c=this,u=n.length+e,d=Ei(h),p=h,g=0;this.parent.allowGrouping&&(g=this.parent.groupSettings.columns.length),t.columns.add(u),t.headers.add(i.length);var f=function(e,n,l,o,h){var u=t.headers.getHeader(e),d=u.cells.getCell(n),p=i[e].cells[n];Object(m.X)(l.headerTextAlign)||(d.style.stringFormat=c.getHorizontalAlignment(l.headerTextAlign)),o>0&&(d.rowSpan=o,d.style.stringFormat=c.getVerticalAlignment("Bottom",d.style.stringFormat,l.textAlign)),h>0&&(d.columnSpan=h),u.style.setBorder(r),u.style.setFont(s),u.style.setTextBrush(a),d.value=l.headerText,Object(m.X)(p)||p.cellType!==K.HeaderIndent&&p.cellType!==K.DetailHeader||(d.value="",d.width=20),c.parent.trigger("pdfHeaderQueryCellInfo",{cell:d,gridCell:p,style:d.style})};return function e(t,i,n,r,s,a){for(var l=0,o=0;o<t.length;o++)if(a&&(r=l=l+n+(0===o?0:-1),n=0),t[o].columns&&t[o].columns.length){var h=e(t[o].columns,i-1,0,o+r,s+1,!1);f(s,o+r,t[o],0,h),n+=h,r=r+h-1}else(t[o].visible||c.hideColumnInclude)&&(n++,f(s,o+r+g,t[o],i,0));return n}(p,d,0,0,0,!0),t.columns.count>=6&&o&&(t.style.allowHorizontalOverflow=!0),t}},{key:"processExportProperties",value:function(e,t){if(Object(m.X)(e))this.currentViewData=!1,this.customDataSource=!1;else{Object(m.X)(e.theme)||(this.gridTheme=e.theme);var i=this.pdfPageSettings.size;if(this.drawHeader(e),!Object(m.X)(e.footer)){var n=e.footer,r=new x.v(0,i.width-80-.75*n.fromBottom),s=new x.x(i.width-80,.75*n.height),a=new x.w(r,s);this.pdfDocument.template.bottom=this.drawPageTemplate(new x.n(a),n)}Object(m.X)(e.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=e.includeHiddenColumn),Object(m.X)(e.dataSource)?Object(m.X)(e.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===e.exportType?(t=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(e.dataSource instanceof v.a||(t=e.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return t}},{key:"drawHeader",value:function(e){var t=this,i=this.pdfPageSettings.size;if(!Object(m.X)(e)&&!Object(m.X)(e.header)){var n=e.header,r=new x.v(0,n.fromTop),s=new x.x(i.width-80,.75*n.height),a=new x.w(r,s);if(this.headerOnPages.length){var l=this.drawPageTemplate(new x.n(a),n);this.headerOnPages.filter((function(e){e-1>=0&&e-1<t.pdfDocument.pages.count-1&&t.pdfDocument.pages.getPageByIndex(e-1).graphics.drawPdfTemplate(l.template,new x.v(0,0))}))}else this.pdfDocument.template.top=this.drawPageTemplate(new x.n(a),n)}}},{key:"drawPageTemplate",value:function(e,t){var i,n=c(t.contents);try{for(n.s();!(i=n.n()).done;){var r=i.value;switch(this.processContentValidation(r),r.type){case"Text":if(""===r.value||null==r.value||"string"!=typeof r.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,r);break;case"PageNumber":this.drawPageNumber(e,r);break;case"Image":if(null==r.src||""===r.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,r);break;case"Line":this.drawLine(e,r);break;default:throw new Error("Please set valid content type...")}}}catch(s){n.e(s)}finally{n.f()}return e}},{key:"processContentValidation",value:function(e){if(null==e.type)throw new Error("please set valid content type...");if("Line"===e.type){if(null==e.points)throw new Error("please enter valid points in "+e.type+" content...");if(null==e.points.x1||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if(null==e.points.y1||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if(null==e.points.x2||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if(null==e.points.y2||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if(null==e.position)throw new Error("please enter valid position in "+e.type+" content...");if(null==e.position.x||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if(null==e.position.y||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}}},{key:"drawText",value:function(e,t){var i=this.getFont(t),n=this.getBrushFromContent(t),r=null;if(!Object(m.X)(t.style.textPenColor)){var s=this.hexToRgb(t.style.textPenColor);r=new x.o(new x.c(s.r,s.g,s.b))}null==n&&null==r&&(n=new x.p(new x.c(0,0,0)));var a=t.value.toString(),l=.75*t.position.x,o=.75*t.position.y,h=new x.r,c=this.setContentFormat(t,h);null===c||Object(m.X)(c.format)||Object(m.X)(c.size)?e.graphics.drawString(a,i,r,n,l,o,h):e.graphics.drawString(a,i,r,n,l,o,c.size.width,c.size.height,c.format)}},{key:"drawPageNumber",value:function(e,t){var i=this.getFont(t),n=null;if(Object(m.X)(t.style.textBrushColor))n=new x.p(new x.c(0,0,0));else{var r=this.hexToRgb(t.style.textBrushColor);n=new x.p(new x.c(r.r,r.g,r.b))}var s,a,l=new x.k(i,n);if(l.numberStyle=this.getPageNumberStyle(t.pageNumberType),Object(m.X)(t.format))a="{0}",s=new x.d(i,n,a,l);else if(-1!==t.format.indexOf("$total")&&-1!==t.format.indexOf("$current")){var o=new x.j(i);o.numberStyle=this.getPageNumberStyle(t.pageNumberType),t.format.indexOf("$total")>t.format.indexOf("$current")?a=(a=t.format.replace("$current","0")).replace("$total","1"):a=(a=t.format.replace("$current","1")).replace("$total","0"),s=new x.d(i,n,a,l,o)}else if(-1!==t.format.indexOf("$current")&&-1===t.format.indexOf("$total"))a=t.format.replace("$current","0"),s=new x.d(i,n,a,l);else{var h=new x.j(i);a=t.format.replace("$total","0"),s=new x.d(i,n,a,h)}var c=.75*t.position.x,u=.75*t.position.y,d=this.setContentFormat(t,s.stringFormat);null===d||Object(m.X)(d.format)||Object(m.X)(d.size)||(s.stringFormat=d.format,s.bounds=new x.w(c,u,d.size.width,d.size.height)),s.draw(e.graphics,c,u)}},{key:"drawImage",value:function(e,t){var i=.75*t.position.x,n=.75*t.position.y,r=Object(m.X)(t.size)?void 0:.75*t.size.width,s=Object(m.X)(t.size)?void 0:.75*t.size.height,a=new x.a(t.src);Object(m.X)(r)?e.graphics.drawImage(a,i,n):e.graphics.drawImage(a,i,n,r,s)}},{key:"drawLine",value:function(e,t){var i=.75*t.points.x1,n=.75*t.points.y1,r=.75*t.points.x2,s=.75*t.points.y2,a=this.getPenFromContent(t);Object(m.X)(t.style)||null===t.style||(Object(m.X)(t.style.penSize)||null===t.style.penSize||"number"!=typeof t.style.penSize||(a.width=.75*t.style.penSize),a.dashStyle=this.getDashStyle(t.style.dashStyle)),e.graphics.drawLine(a,i,n,r,s)}},{key:"processAggregates",value:function(e,t,i,n,r,s,a,l,o,h){var u,d=c(e);try{for(d.s();!(u=d.n()).done;){for(var p=u.value,g=-1,f=0,v=!0,b=[],y=0;y<t.columns.count;y++){var C=p.cells[f];if(C.cellType!==K.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===C.visible;)C.cellType!==K.DetailFooterIntent&&(Object(m.X)(l)||Object(m.X)(l.cells.getCell(y).value)?b.push(""):(this.parent.trigger("pdfAggregateQueryCellInfo",{row:p,type:"GroupCaption",style:l.cells}),b.push(""),b.push(l.cells.getCell(y).value),v=!1,a||(y+=1)),y+=1,f+=1,C=p.cells[f]);for(;!Object(m.X)(C.visible)&&!C.visible;)f+=1,C=p.cells[f]}if(C.isDataCell){var w={};if(Object(m.X)(C.column.footerTemplate)&&Object(m.X)(C.column.groupCaptionTemplate)&&Object(m.X)(C.column.groupFooterTemplate)){var k=this.getSummaryWithoutTemplate(p.data[C.column.field]);Object(m.X)(k)||b.push(k)}else{var S=void 0,O=this.getTemplateFunction(w,y,g,C);w=O.templateFunction,g=O.leastCaptionSummaryIndex;var x=p.data[C.column.field?C.column.field:C.column.columnName];this.parent.isReact||this.parent.isVue?(S=w[Object(m.P)(K,C.cellType)](x,this.parent),this.parent.isReact&&this.parent.renderTemplates()):S=w[Object(m.P)(K,C.cellType)](x),b.push(S[0].textContent),v=!1}}else b.push("");v&&""!==b[y]&&!Object(m.X)(b[y])&&null!==b[y]&&(v=!1),f+=1}else y--,f++}if(a)for(var j=this.parent.groupSettings.columns.length+1;j<b.length-1;j++)b[j]=b[j+1];if(!v)if(a)for(var R=0;R<t.columns.count;R++)l.cells.getCell(R).value=b[R].toString(),R===o+1&&-1!==g&&1!==g?l.cells.getCell(R).columnSpan=g-(o+1):R===o+1&&-1===g&&(l.cells.getCell(R).columnSpan=t.columns.count-(o+1));else{var D=t.rows.addRow();D.style.setBorder(i),D.style.setFont(n),D.style.setTextBrush(r),D.style.setBackgroundBrush(s),this.parent.trigger("pdfAggregateQueryCellInfo",{row:p,type:h?"GroupFooter":"Footer",style:D.cells});for(var E=0;E<t.columns.count;E++)D.cells.getCell(E).value=b[E].toString()}}}catch(I){d.e(I)}finally{d.f()}}},{key:"getTemplateFunction",value:function(e,t,i,n){return Object(m.X)(n.column.footerTemplate)||n.cellType!==K.Summary?Object(m.X)(n.column.groupCaptionTemplate)?e[Object(m.P)(K,K.GroupSummary)]=Object(m.E)(n.column.groupFooterTemplate):(-1===i&&(i=t),e[Object(m.P)(K,K.CaptionSummary)]=Object(m.E)(n.column.groupCaptionTemplate)):e[Object(m.P)(K,K.Summary)]=Object(m.E)(n.column.footerTemplate),{templateFunction:e,leastCaptionSummaryIndex:i}}},{key:"getSummaryWithoutTemplate",value:function(e){return Object(m.X)(e.Sum)?Object(m.X)(e.Average)?Object(m.X)(e.Max)?Object(m.X)(e.Min)?Object(m.X)(e.Count)?Object(m.X)(e.TrueCount)?Object(m.X)(e.FalseCount)?Object(m.X)(e.Custom)?void 0:e.Custom:e.FalseCount:e.TrueCount:e.Count:e.Min:e.Max:e.Average:e.Sum}},{key:"setColumnProperties",value:function(e,t,i,n,r){for(var s=n.groupSettings.columns.length,a=0;a<s;a++)t.columns.getColumn(a).width=20;for(var l=0;l<e.length;l++)Object(m.X)(e[l].textAlign)||(t.columns.getColumn(l+s).format=this.getHorizontalAlignment(e[l].textAlign)),t.style.allowHorizontalOverflow&&!Object(m.X)(e[l].width)&&r&&(t.columns.getColumn(l+s).width="number"==typeof e[l].width?.75*e[l].width:.75*i.getConvertedWidth(e[l].width))}},{key:"setRecordThemeStyle",value:function(e,t){if(Object(m.X)(this.gridTheme)||Object(m.X)(this.gridTheme.record))e.style.setTextBrush(new x.p(new x.c(0,0,0)));else{var i=Object(m.X)(this.gridTheme.record.fontName)?x.f.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),n=Object(m.X)(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,r=this.getFontStyle(this.gridTheme.record),s=new x.q(i,n,r);Object(m.X)(this.gridTheme.record.font)||(s=this.gridTheme.record.font),e.style.setFont(s);var a=new x.c;if(!Object(m.X)(this.gridTheme.record.fontColor)){var l=this.hexToRgb(this.gridTheme.record.fontColor);a=new x.c(l.r,l.g,l.b)}e.style.setTextBrush(new x.p(a))}var o=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):t;return e.style.setBorder(o),e}},{key:"processRecord",value:function(e,t,i,n,r,s,a,l,o){var h,u=c(l.getGridRowModel(t,n,i,o));try{for(u.s();!(h=u.n()).done;){var d=h.value;o++;for(var p=this.setRecordThemeStyle(r.rows.addRow(),e),g=d.cells.length,f=0;f<g;f++){var v=d.cells[f];if(v.cellType===K.Data){var b=void 0,y=v.column,C=y.field,w=Object(m.X)(C)?"":y.valueAccessor(C,d.data,y),k=Object(m.X)(w)?"":w;y.isForeignColumn&&y.isForeignColumn()&&(b=l.getFData(k,y),k=Object(m.V)(y.foreignKeyValue,b));var S=d.data,O=p.cells.getCell(f),j={data:S,value:k,column:y,style:void 0,colSpan:1,cell:O};if(j.value=this.exportValueFormatter.formatCellValue(j,i.isServerRendered),this.parent.trigger("pdfQueryCellInfo",j),O.value=j.value,Object(m.X)(j.style)||this.processCellStyle(O,j),j.colSpan>1){f+1+j.colSpan>p.cells.count&&(j.colSpan=p.cells.count-(f+1)),O.columnSpan=j.colSpan;for(var R=1;R<O.columnSpan;R++)p.cells.getCell(f+R).value="";f+=j.colSpan-1}}}if(d.isExpand){var D=this.setRecordThemeStyle(r.rows.addRow(),e),E=D.cells.getCell(s);E.columnSpan=D.cells.count-s,E.style.cellPadding=new x.i(10,10,10,10),i.isPrinting=!0;var I=!Object(m.X)(a)&&a.exportType?a.exportType:"AllPages",M=this.helper.createChildGrid(i,d,I,this.gridPool),F=M.childGrid,T=M.element;F.actionFailure=l.failureHandler(this.gridPool,F,this.globalResolve),this.parent.trigger("exportdetaildatabound",{childGrid:F,row:d,cell:E,exportProperties:a}),F.beforeDataBound=this.childGridCell(E,F,a),F.appendTo(T)}this.parent.notify("export-RowDataBound",{type:"pdf",rowObj:d})}}catch(A){u.e(A)}finally{u.f()}return o}},{key:"childGridCell",value:function(e,t,i){var n=this;return function(r){return t.beforeDataBound=null,r.cancel=!0,e.value=n.processGridExport(t,r,i),t.destroy(),Object(m.I)(t.element),n.gridPool[t.id]=!0,n.helper.checkAndExport(n.gridPool,n.globalResolve),e}}},{key:"processCellStyle",value:function(e,t){if(!Object(m.X)(t.style.backgroundColor)){var i=this.hexToRgb(t.style.backgroundColor);e.style.backgroundBrush=new x.p(new x.c(i.r,i.g,i.b))}if(Object(m.X)(t.style.textAlignment)||(e.style.stringFormat=this.getHorizontalAlignment(t.style.textAlignment)),Object(m.X)(t.style.cellPadding)||(e.style.cellPadding=t.style.cellPadding),Object(m.X)(t.style.verticalAlignment)||(e.style.stringFormat=this.getVerticalAlignment(t.style.verticalAlignment,e.style.stringFormat)),!Object(m.X)(t.style.textBrushColor)){var n=this.hexToRgb(t.style.textBrushColor);e.style.textBrush=new x.p(new x.c(n.r,n.g,n.b))}if(!Object(m.X)(t.style.textPenColor)){var r=this.hexToRgb(t.style.textPenColor);e.style.textPen=new x.o(new x.c(r.r,r.g,r.b))}if(Object(m.X)(t.style.fontFamily)&&Object(m.X)(t.style.fontSize)&&Object(m.X)(t.style.bold)&&Object(m.X)(t.style.italic)&&Object(m.X)(t.style.underline)&&Object(m.X)(t.style.strikeout)||(e.style.font=this.getFont(t)),!Object(m.X)(t.style.border)){var s=new x.b,a=t.style.border.width,l=Object(m.X)(a)||"number"!=typeof a?void 0:.75*a,o=new x.c(196,196,196);if(!Object(m.X)(t.style.border.color)){var h=this.hexToRgb(t.style.border.color);o=new x.c(h.r,h.g,h.b)}var c=new x.o(o,l);Object(m.X)(t.style.border.dashStyle)||(c.dashStyle=this.getDashStyle(t.style.border.dashStyle)),s.all=c,e.style.borders=s}Object(m.X)(t.style.paragraphIndent)||(e.style.stringFormat=new x.r,e.style.stringFormat.paragraphIndent=t.style.paragraphIndent)}},{key:"getHorizontalAlignment",value:function(e,t){switch(void 0===t&&(t=new x.r),e){case"Right":t.alignment=x.s.Right;break;case"Center":t.alignment=x.s.Center;break;case"Justify":t.alignment=x.s.Justify;break;case"Left":t.alignment=x.s.Left}return t}},{key:"getVerticalAlignment",value:function(e,t,i){switch(void 0===t&&(t=new x.r,t=this.getHorizontalAlignment(i,t)),e){case"Bottom":t.lineAlignment=x.u.Bottom;break;case"Middle":t.lineAlignment=x.u.Middle;break;case"Top":t.lineAlignment=x.u.Top}return t}},{key:"getFontFamily",value:function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}}},{key:"getFont",value:function(e){if(e.font)return e.font;var t=Object(m.X)(e.style.fontSize)?9.75:.75*e.style.fontSize,i=Object(m.X)(e.style.fontFamily)?x.f.TimesRoman:this.getFontFamily(e.style.fontFamily),n=x.g.Regular;return!Object(m.X)(e.style.bold)&&e.style.bold&&(n|=x.g.Bold),!Object(m.X)(e.style.italic)&&e.style.italic&&(n|=x.g.Italic),!Object(m.X)(e.style.underline)&&e.style.underline&&(n|=x.g.Underline),!Object(m.X)(e.style.strikeout)&&e.style.strikeout&&(n|=x.g.Strikeout),new x.q(i,t,n)}},{key:"getPageNumberStyle",value:function(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}}},{key:"setContentFormat",value:function(e,t){if(!Object(m.X)(e.size)){var i=.75*e.size.width,n=.75*e.size.height;if(t=new x.r(x.s.Left,x.u.Middle),!Object(m.X)(e.style.hAlign))switch(e.style.hAlign){case"Right":t.alignment=x.s.Right;break;case"Center":t.alignment=x.s.Center;break;case"Justify":t.alignment=x.s.Justify;break;default:t.alignment=x.s.Left}return Object(m.X)(e.style.vAlign)||(t=this.getVerticalAlignment(e.style.vAlign,t)),{format:t,size:new x.x(i,n)}}return null}},{key:"getPageSize",value:function(e){switch(e){case"Letter":return new x.x(612,792);case"Note":return new x.x(540,720);case"Legal":return new x.x(612,1008);case"A0":return new x.x(2380,3368);case"A1":return new x.x(1684,2380);case"A2":return new x.x(1190,1684);case"A3":return new x.x(842,1190);case"A5":return new x.x(421,595);case"A6":return new x.x(297,421);case"A7":return new x.x(210,297);case"A8":return new x.x(148,210);case"A9":return new x.x(105,148);case"B0":return new x.x(2836,4008);case"B1":return new x.x(2004,2836);case"B2":return new x.x(1418,2004);case"B3":return new x.x(1002,1418);case"B4":return new x.x(709,1002);case"B5":return new x.x(501,709);case"Archa":return new x.x(648,864);case"Archb":return new x.x(864,1296);case"Archc":return new x.x(1296,1728);case"Archd":return new x.x(1728,2592);case"Arche":return new x.x(2592,3456);case"Flsa":return new x.x(612,936);case"HalfLetter":return new x.x(396,612);case"Letter11x17":return new x.x(792,1224);case"Ledger":return new x.x(1224,792);default:return new x.x(595,842)}}},{key:"getDashStyle",value:function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}}},{key:"getPenFromContent",value:function(e){var t=new x.o(new x.c(0,0,0));if(!Object(m.X)(e.style)&&null!==e.style&&!Object(m.X)(e.style.penColor)){var i=this.hexToRgb(e.style.penColor);t=new x.o(new x.c(i.r,i.g,i.b))}return t}},{key:"getBrushFromContent",value:function(e){var t=null;if(!Object(m.X)(e.style.textBrushColor)){var i=this.hexToRgb(e.style.textBrushColor);t=new x.p(new x.c(i.r,i.g,i.b))}return t}},{key:"hexToRgb",value:function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color...");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}},{key:"getFontStyle",value:function(e){var t=x.g.Regular;return!Object(m.X)(e)&&e.bold&&(t|=x.g.Bold),!Object(m.X)(e)&&e.italic&&(t|=x.g.Italic),!Object(m.X)(e)&&e.underline&&(t|=x.g.Underline),!Object(m.X)(e)&&e.strikeout&&(t|=x.g.Strikeout),t}},{key:"getBorderStyle",value:function(e){var t=new x.b;if(Object(m.X)(e))t.all=new x.o(new x.c(234,234,234));else{var i=e.width,n=Object(m.X)(i)||"number"!=typeof i?void 0:.75*i,r=new x.c(196,196,196);if(!Object(m.X)(e.color)){var s=this.hexToRgb(e.color);r=new x.c(s.r,s.g,s.b)}var a=new x.o(r,n);Object(m.X)(e.dashStyle)||(a.dashStyle=this.getDashStyle(e.dashStyle)),t.all=a}return t}},{key:"destroy",value:function(){}}]),e}(),er=function(e){n(i,e);var t=s(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).buttonElement=r.parent.createElement("button",{}),r.unbounDiv=r.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),r.element=r.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{role:"gridcell",tabindex:"-1"}}),r}return f(i,[{key:"render",value:function(e,t,i){var n=this.element.cloneNode();if(n.appendChild(this.unbounDiv.cloneNode()),n.setAttribute("aria-label","is Command column column header "+e.column.headerText),e.column.commandsTemplate)if(this.parent.isReact&&"string"!=typeof e.column.commandsTemplate){var r=this.parent+"commandsTemplate";e.column.getColumnTemplate()(t,this.parent,"commandsTemplate",r,null,null,n.firstElementChild),this.parent.renderTemplates()}else Jt(n.firstElementChild,e.column.getColumnTemplate()(t));else{var s,a=c(e.commands);try{for(a.s();!(s=a.n()).done;){var l=s.value;n=this.renderButton(n,l,i.index,l.uid)}}catch(o){a.e(o)}finally{a.f()}}return this.setAttributes(n,e,i),this.parent.isEdit?(Object(m.v)(n.querySelectorAll(".e-edit-delete"),"e-hide"),Object(m.ib)(n.querySelectorAll(".e-save-cancel"),"e-hide")):(Object(m.v)(n.querySelectorAll(".e-save-cancel"),"e-hide"),Object(m.ib)(n.querySelectorAll(".e-edit-delete"),"e-hide")),n}},{key:"renderButton",value:function(e,t,i,n){var r=this.buttonElement.cloneNode();Object(m.x)(r,{id:this.parent.element.id+(t.type||"")+"_"+i+"_"+n,type:"button",title:Object(m.X)(t.title)?t.buttonOption.content||this.localizer.getConstant(t.type)||t.type:t.title,"data-uid":n}),r.onclick=t.buttonOption.click;var s=new y.a(t.buttonOption,r);switch(s.commandType=t.type,e.firstElementChild.appendChild(s.element),t.type){case"Edit":case"Delete":Object(m.v)([r],["e-edit-delete","e-"+t.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":Object(m.v)([r],["e-save-cancel","e-"+t.type.toLowerCase()+"button"])}return e}}]),i}(ae),tr=function(){function e(t){p(this,e),this.parent=t,this.rowModelGenerator=new $(this.parent)}return f(e,[{key:"generateRows",value:function(e,t,i){var n=this.parent.getFrozenColumns(),r=Ni(this.parent);if(n=n&&this.parent.isRowDragable()?n+1:n,"virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&"movable"!==r)return null;var s=this.parent.enableVirtualization&&!t.isFrozenRowsRender?i:this.rowModelGenerator.generateRows(e,t);if(Object(m.W)()&&!this.parent.isJsComponent)return s;for(var a=0,l=s.length;a<l;a++)s[a].cells=Wi(this.parent,s[a].cells,r);return s}}]),e}(),ir=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).isInitialRender=!0,n.widthService=i.getService("widthService"),n.addEventListener(),n}return f(r,[{key:"addEventListener",value:function(){this.parent.addEventListener(E,this.actionComplete.bind(this)),this.parent.addEventListener("batchAdd",this.batchAdd.bind(this)),this.parent.on("batchCancel",this.batchAdd.bind(this)),this.parent.addEventListener("batchDelete",this.batchAdd.bind(this)),this.parent.on("set-height-to-frozen-element",this.refreshScrollOffset),this.parent.on("column-visible-changed",this.widthService.refreshFrozenScrollbar,this)}},{key:"batchAdd",value:function(e){if("auto"!==this.parent.height&&("batchCancel"!==e.name&&(!this.parent.frozenRows||"Top"!==this.parent.editSettings.newRowPosition)||"batchCancel"===e.name||"batchDelete"===e.name)){this.refreshScrollOffset();var t=this.getTable().offsetHeight;"add"===e.name&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}}},{key:"setHeightToContent",value:function(e){this.getFrozenContent().style.height=e.toString()+"px",this.getMovableContent().style.height=e.toString()+"px"}},{key:"actionComplete",value:function(e){if("Dialog"!==this.parent.editSettings.mode&&("add"===e.requestType||"cancel"===e.requestType&&e.row.classList.contains("e-addedrow"))&&(!this.parent.frozenRows||"Bottom"===this.parent.editSettings.newRowPosition)&&"auto"!==this.parent.height){this.refreshScrollOffset();var t=this.getTable().offsetHeight;"add"===e.requestType&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.removeEventListener(E,this.actionComplete),this.parent.removeEventListener("batchAdd",this.batchAdd),this.parent.off("column-visible-changed",this.widthService.refreshFrozenScrollbar))}},{key:"renderPanel",value:function(){i(o(r.prototype),"renderPanel",this).call(this);var e=this.parent.element.querySelector(".e-frozencontent"),t=this.parent.element.querySelector(".e-movablecontent");Object(m.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-left-content"}),t=this.parent.createElement("div",{className:"e-movablecontent"}),this.getPanel().querySelector(".e-content").appendChild(e),this.getPanel().querySelector(".e-content").appendChild(t)),this.setFrozenContent(e),this.setMovableContent(t)}},{key:"renderFrozenRigthPanel",value:function(){i(o(r.prototype),"renderPanel",this).call(this)}},{key:"renderEmpty",value:function(e){Object(m.W)()&&!this.parent.isJsComponent||(i(o(r.prototype),"renderEmpty",this).call(this,e),this.getMovableContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(m.v)([this.getMovableContent().querySelector("tbody").querySelector("tr")],["e-emptyrow"]),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenColumns(),this.getFrozenContent().style.borderRightWidth="0px",this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").innerHTML="",this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").innerHTML=""))}},{key:"renderFrozenRightEmpty",value:function(e){i(o(r.prototype),"renderEmpty",this).call(this,e)}},{key:"setFrozenContent",value:function(e){this.frozenContent=e}},{key:"setMovableContent",value:function(e){this.movableContent=e}},{key:"getFrozenContent",value:function(){return this.frozenContent}},{key:"getMovableContent",value:function(){return this.movableContent}},{key:"getModelGenerator",value:function(){return new tr(this.parent)}},{key:"renderFrozenRightTable",value:function(){i(o(r.prototype),"renderTable",this).call(this)}},{key:"renderTable",value:function(){var e;null==this.getFrozenContent().querySelector(".e-table")?(i(o(r.prototype),"renderTable",this).call(this),this.getFrozenContent().appendChild(this.getTable()),e=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(e)):(this.setTable(this.getFrozenContent().querySelector(".e-table")),this.setColGroup(this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)),this.getFrozenContent().querySelector(".e-table").appendChild(this.getColGroup()),e=this.getMovableContent().querySelector(".e-table"),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")),this.getMovableContent().querySelector("colgroup")&&Object(m.hb)(this.getMovableContent().querySelector("colgroup"));var t=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"));var n=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=n,this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-left-scrollbar",this.getScrollbarDisplay())}},{key:"getScrollbarDisplay",value:function(){var e="";return(this.parent.getFrozenColumns()&&!this.parent.getVisibleFrozenColumns()||this.parent.getFrozenLeftColumnsCount()&&!this.parent.getVisibleFrozenLeftCount())&&(e="none"),e}},{key:"renderHorizontalScrollbar",value:function(e,t,i){var n=this.parent.createElement("div",{className:e,styles:"display:"+t}),r=this.parent.createElement("div",{className:"e-movablescrollbar"}),s=this.parent.createElement("div",{className:"e-movablechild"}),a=ni().toString();this.setScrollbarHeight(r,a),this.setScrollbarHeight(s,a),r.appendChild(s),this.appendScrollbar(n,r,i)}},{key:"appendScrollbar",value:function(e,t,i){var n=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});n.appendChild(e),n.appendChild(t),this.parent.getContent().appendChild(n)}},{key:"setScrollbarHeight",value:function(e,t){e.style.minHeight=t+"px",e.style.maxHeight=t+"px"}},{key:"setIsFrozen",value:function(e,t){e.isFrozen=!e.isFrozen}},{key:"setTbody",value:function(e,t){var i;Object(m.X)(e[0].cells[0])&&(this.getMovableContent().querySelector("tbody").innerHTML="");var n=e[0].cells[0],r=n.index;return Object(m.ab)(r)&&this.parent.isRowDragable()&&(r=(n=e[0].cells[1]).index),0===r&&(this.getPanel().firstChild.style.overflowX="hidden"),this.parent.enableColumnVirtualization&&t.renderMovableContent&&"virtualscroll"===t.requestType&&this.getMovableContent().scrollLeft>0&&0!==t.virtualInfo.columnIndexes[0]&&(r=this.parent.getFrozenColumns()),n&&n.column&&(i=n.column.getFreezeTableName()),this.setIdx(r),i}},{key:"splitRows",value:function(e){"frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows}},{key:"renderNextFrozentPart",value:function(e,t){"frozen-left"===t&&(this.parent.enableVirtualization&&(e.renderMovableContent=!0),this.refreshContentRows(Object(m.K)({},e)))}},{key:"appendContent",value:function(e,t,i,n){this.parent.isReact&&!Object(m.X)(this.parent.rowTemplate)?e=t:e.appendChild(t),"frozen-left"===n?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e)):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset(),this.widthService.refreshFrozenScrollbar()),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1)}},{key:"refreshScrollOffset",value:function(){if("auto"!==this.parent.height){var e=this.getTable().offsetHeight+1;this.setHeightToContent(e)}this.parent.notify("refresh-frozen-height",{})}},{key:"getFrozenHeader",value:function(e){return"frozen-left"===e?this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"):this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody")}},{key:"refreshTbody",value:function(e){e.childElementCount<1&&e.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td")))}},{key:"refreshHeight",value:function(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"}),this.getFrozenContent().style.borderRightWidth="1px"}},{key:"setIdx",value:function(e){this.idx=e}},{key:"getIdx",value:function(){return this.idx}},{key:"getTbody",value:function(e){return"frozen-left"===e?this.getTable().querySelector("tbody"):this.getMovableContent().querySelector("tbody")}}]),r}(re),nr=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).addEventListener(),n}return f(r,[{key:"addEventListener",value:function(){this.parent.on("freezerender",this.refreshFreeze,this),this.parent.on("frozenHeight",this.setFrozenHeight,this),this.parent.on(z,this.enableAfterRender,this)}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("frozenHeight",this.setFrozenHeight),this.parent.off(z,this.enableAfterRender))}},{key:"renderTable",value:function(){Object(m.W)()?(this.setTable(this.createTable(this.getFrozenHeader().querySelector(".e-table"))),this.parent.notify(q,{rows:this.rows,args:{isFrozen:!0}}),this.createTable(this.getMovableHeader().querySelector(".e-table"))):i(o(r.prototype),"renderTable",this).call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(q,{rows:this.rows,args:{isFrozen:!1}})}},{key:"renderPanel",value:function(){var e=this.parent.element.querySelector(".e-frozenheader"),t=this.parent.element.querySelector(".e-movableheader");i(o(r.prototype),"renderPanel",this).call(this),Object(m.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozenheader e-frozen-left-header"}),t=this.parent.createElement("div",{className:"e-movableheader"}),this.getPanel().querySelector(".e-headercontent").appendChild(e),this.getPanel().querySelector(".e-headercontent").appendChild(t)),this.setFrozenHeader(e),this.setMovableHeader(t)}},{key:"renderFrozenRightPanel",value:function(){i(o(r.prototype),"renderPanel",this).call(this)}},{key:"renderFrozenRightTable",value:function(){i(o(r.prototype),"renderTable",this).call(this)}},{key:"refreshUI",value:function(){if(Object(m.W)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows)this.parent.getFrozenColumns()&&this.freezeReorder&&(i(o(r.prototype),"refreshUI",this).call(this),this.freezeReorder=!1,i(o(r.prototype),"refreshUI",this).call(this)),this.rfshMovable();else{var e=this.getMovableHeader().querySelector("tbody");Object(m.hb)(this.getMovableHeader().querySelector("table")),i(o(r.prototype),"refreshUI",this).call(this),this.rfshMovable(),this.getMovableHeader().querySelector("tbody").innerHTML=e.innerHTML}Object(m.W)()&&0!==this.parent.frozenRows||this.updateColgroup(),this.parent.enableVirtualization||this.widthService.setWidthToTable(),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&hi([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor(),Object(m.W)()&&0!==this.parent.frozenRows||ki(this.parent.getContentTable().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent),this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(q,{rows:this.rows,args:{isFrozen:!1}})}},{key:"refreshFrozenLeftUI",value:function(){i(o(r.prototype),"refreshUI",this).call(this)}},{key:"rfshMovable",value:function(){Object(m.W)()&&0!==this.parent.frozenRows||(this.getFrozenHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createTable())),this.refreshStackedHdrHgt(),this.addMovableFirstCls()}},{key:"addMovableFirstCls",value:function(){if(this.parent.getVisibleFrozenColumns())for(var e=this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll(".e-columnheader"),t=e.length,i=0;i<t;i++){var n=e[i].cells[0];n&&(Object(m.v)([n],["e-movablefirst"]),e[i].cells[0].rowSpan>1&&(i+=e[i].cells[0].rowSpan-1))}}},{key:"refreshFreeze",value:function(e){if("filter"===e.case){var t=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&t&&this.getMovableHeader().querySelector("thead")){this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(t,this.parent.getFrozenColumns()));var i,n=c([].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input")));try{for(n.s();!(i=n.n()).done;){var r=i.value;C.c.bindInitialEvent({element:r,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}})}}catch(s){n.e(s)}finally{n.f()}}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())}},{key:"refreshHeight",value:function(e){var t,i,n=this.getFrozenHeader(),r=this.getMovableHeader(),s=this.parent.getContent(),a=this.parent.textWrapSettings.wrapMode,l=this.parent.getHeaderContent().querySelector(".e-headercontent").classList;"textwrap"===e.case?(("Header"!==a||e.isModeChg)&&(t=s.querySelector(".e-frozencontent").querySelectorAll("tr"),i=s.querySelector(".e-movablecontent").querySelectorAll("tr"),this.setWrapHeight(t,i,e.isModeChg,!0)),"Content"===a&&this.parent.allowTextWrap?l.add("e-wrap"):l.remove("e-wrap"),"Both"===a||e.isModeChg?(t=n.querySelectorAll("tr"),i=r.querySelectorAll("tr")):(i=r.querySelector("Content"===a?"tbody":"thead").querySelectorAll("tr"),t=n.querySelector("Content"===a?"tbody":"thead").querySelectorAll("tr")),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(t,i,e.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(this.setWrapHeight(s.querySelector(".e-frozencontent").querySelectorAll("tr"),s.querySelector(".e-movablecontent").querySelectorAll("tr"),e.isModeChg),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(n.querySelectorAll("tr"),r.querySelectorAll("tr"),e.isModeChg))}},{key:"enableAfterRender",value:function(e){"scroll"===e.module&&this.setFrozenHeight()}},{key:"updateResizeHandler",value:function(){for(var e=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")),t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"}},{key:"setWrapHeight",value:function(e,t,i,n,r){for(var s,a,l=this.parent.allowTextWrap,o=this.parent.textWrapSettings.wrapMode,h=this.parent.getHeaderContent().querySelector("thead"),c=this.parent.getHeaderContent().querySelector("tbody"),u=[],d=[],p=0,g=e.length;p<g;p++)Object(m.X)(e[p])||Object(m.X)(t[p])||(u[p]=e[p].getBoundingClientRect().height,d[p]=t[p].getBoundingClientRect().height);for(var f=0,v=e.length;f<v;f++)(i&&("Header"===o&&n||"Content"===o&&h.contains(e[f])||"Header"===o&&c.contains(e[f]))||r)&&(e[f].style.height=null,t[f].style.height=null),s=u[f],a=d[f],!Object(m.X)(e[f])&&e[f].childElementCount&&(l&&s<a||!l&&s<a||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[f].style.height=a+"px"),t&&!Object(m.X)(t[f])&&t[f].childElementCount&&(l&&s>a||!l&&s>a||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[f].style.height=s+"px");l&&this.setFrozenHeight()}},{key:"setFrozenHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ni(),t=this.parent.element.querySelector(".e-movablecontent").getBoundingClientRect().height,i=this.parent.element.querySelector(".e-movablecontent"),n=this.parent.element.querySelector(".e-frozencontent"),r=this.parent.getContent().scrollWidth,s=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;i.scrollWidth-i.clientWidth?(n.style.height=t-e+"px",n.style.borderBottom=""):(n.style.height=t+"px",(n.scrollHeight<=n.clientHeight||i.scrollHeight<=i.clientHeight)&&r===s&&this.parent.scrollModule.removePadding(),n.style.borderBottom="0px")}},{key:"refreshStackedHdrHgt",value:function(){for(var e,t,i=this.getFrozenHeader().querySelectorAll(".e-columnheader"),n=this.getMovableHeader().querySelectorAll(".e-columnheader"),r=0,s=i.length;r<s;r++)e=this.getRowSpan(i[r]),t=this.getRowSpan(n[r]),e.min>1?this.updateStackedHdrRowHgt(r,e.max,i[r],n):t.min>1&&this.updateStackedHdrRowHgt(r,t.max,n[r],i);this.parent.allowResizing&&this.updateResizeHandler()}},{key:"getRowSpan",value:function(e){for(var t,i,n,r=0,s=e.childElementCount;r<s;r++)0===r&&(i=e.children[0].rowSpan),t=e.children[r].rowSpan,i=Math.min(t,i),n=Math.max(t,i);return{min:i,max:n}}},{key:"updateStackedHdrRowHgt",value:function(e,t,i,n){for(var r=0,s=0;s<t;s++)r+=n[e+s].style.height?parseInt(n[e+s].style.height,10):n[e+s].offsetHeight;i.style.height=r+"px"}},{key:"setFrozenHeader",value:function(e){this.frozenHeader=e}},{key:"setMovableHeader",value:function(e){this.movableHeader=e}},{key:"getFrozenHeader",value:function(){return this.frozenHeader}},{key:"getMovableHeader",value:function(){return this.movableHeader}},{key:"updateColgroup",value:function(){var e=this.getMovableHeader().querySelector("table");Object(m.hb)(this.getMovableHeader().querySelector("colgroup")),e.insertBefore(ki(this.getFrozenHeader().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent),e.querySelector("thead"))}},{key:"filterRenderer",value:function(e,t,i){var n=e.cloneNode(!0);n.innerHTML="";for(var r=i||this.parent.getColumns().length,s=t;s<r;s++)n.appendChild(e.removeChild(e.children[t]));return n}}]),r}(se),rr=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).addEventListener(),n}return f(r,[{key:"addEventListener",value:function(){this.parent.on("freezerender",this.refreshFreeze,this),this.parent.on("refresh-frozen-columns",this.refreshFrozenColumns,this),this.parent.on("set-reorder-destination-element",this.setReorderElement,this),this.parent.on("column-visible-changed",this.setVisible,this)}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("freezerender",this.refreshFreeze),this.parent.off("refresh-frozen-columns",this.refreshFrozenColumns),this.parent.off("set-reorder-destination-element",this.setReorderElement),this.parent.off("column-visible-changed",this.setVisible))}},{key:"setReorderElement",value:function(e){this.destEle=e.ele}},{key:"refreshFrozenColumns",value:function(e){e.parent||this.parent.setProperties({columns:e.columns},!0);var t=Wt(this.destEle,"e-frozen-left-header"),i=Wt(this.destEle,"e-frozen-right-header"),n=this.parent.getFrozenLeftColumnsCount(),r=this.parent.getFrozenRightColumnsCount();e.column.freeze=null,t?e.column.freeze="Left":i&&(e.column.freeze="Right"),this.parent.setFrozenCount(),e.cancel=n!==this.parent.getFrozenLeftColumnsCount()||r!==this.parent.getFrozenRightColumnsCount(),e.cancel&&this.parent.refreshColumns()}},{key:"setWrapHeight",value:function(e,t,i,n,r,s){for(var a,l,o,h=this.parent.allowTextWrap,c=this.parent.getHeaderContent().querySelector("tbody"),u=this.parent.textWrapSettings.wrapMode,d=this.parent.getHeaderContent().querySelector("thead"),p=[],g=[],f=[],v=0,b=e.length;v<b;v++)Object(m.X)(e[v])||Object(m.X)(t[v])||(s&&(f[v]=s[v].getBoundingClientRect().height),g[v]=t[v].getBoundingClientRect().height,p[v]=e[v].getBoundingClientRect().height);for(var y=0,C=e.length;y<C;y++){(i&&("Content"===u&&d.contains(e[y])||"Header"===u&&c.contains(e[y])||"Header"===u&&n)||r)&&(s[y]&&(s[y].style.height=null),e[y].style.height=null,t[y].style.height=null),a=p[y],l=g[y],o=f[y]?f[y]:0;var w=Math.max(a,l,o);!Object(m.X)(e[y])&&e[y].childElementCount&&(h&&a<w||!h&&a<w||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[y].style.height=w+"px"),t&&!Object(m.X)(t[y])&&t[y].childElementCount&&(h&&w>l||!h&&w>l||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[y].style.height=w+"px"),s&&!Object(m.X)(s[y])&&s[y].childElementCount&&(h&&w>o||!h&&w>o||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(s[y].style.height=w+"px")}h&&this.setFrozenHeight()}},{key:"refreshHeight",value:function(e){var t,i,n,r="Left-Right"===this.parent.getFrozenMode(),s=this.getFrozenRightHeader(),a=this.parent.getHeaderContent().querySelector(".e-frozenheader"),l=this.parent.getContent(),o=this.getMovableHeader(),h=this.parent.getHeaderContent().querySelector(".e-headercontent").classList,c=this.parent.textWrapSettings.wrapMode;"textwrap"===e.case?(("Header"!==c||e.isModeChg)&&(r&&(i=l.querySelector(".e-frozen-right-content").querySelectorAll("tr")),n=l.querySelector(".e-movablecontent").querySelectorAll("tr"),t=l.querySelector(".e-frozencontent").querySelectorAll("tr"),this.setWrapHeight(t,n,e.isModeChg,!0,!1,i)),"Content"===c&&this.parent.allowTextWrap?h.add("e-wrap"):h.remove("e-wrap"),"Both"===c||e.isModeChg?(r&&(i=s.querySelectorAll("tr")),t=a.querySelectorAll("tr"),n=o.querySelectorAll("tr")):(r&&(i=s.querySelector("Content"===c?"tbody":"thead").querySelectorAll("tr")),t=a.querySelector("Content"===c?"tbody":"thead").querySelectorAll("tr"),n=o.querySelector("Content"===c?"tbody":"thead").querySelectorAll("tr")),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(t,n,e.isModeChg,!1,this.colDepth>1,i),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(n=l.querySelector(".e-movablecontent").querySelectorAll("tr"),t=l.querySelector(".e-frozencontent").querySelectorAll("tr"),r&&(i=l.querySelector(".e-frozen-right-content").querySelectorAll("tr")),this.setWrapHeight(t,n,e.isModeChg,!1,!1,i),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||(r&&(i=s.querySelectorAll("tr")),t=a.querySelectorAll("tr"),n=o.querySelectorAll("tr"),this.setWrapHeight(t,n,e.isModeChg,!1,!1,i)))}},{key:"setVisible",value:function(e){for(var t,i,n=this.parent,r=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getFrozenRightColumnsCount(),a=this.parent.getMovableColumnsCount(),l=0,o=e.length;l<o;l++){var h=e[l];if(i=n.getNormalizedColumnIndex(h.uid),t=h.visible?"":"none","Left"===h.freeze||"Right"===h.freeze){if(r&&!s){var c=n.getHeaderContent().querySelector(".e-frozen-left-header").querySelector("colgroup");Object(m.ob)(c.children[i],{display:t})}else if(!r&&s){var u=n.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup");Object(m.ob)(u.children[i-a],{display:t})}}else{var d=n.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup");Object(m.ob)(d.children[i-r],{display:t})}}this.refreshUI()}},{key:"filterRenderer",value:function(e,t,n){return i(o(r.prototype),"filterRenderer",this).call(this,e,t,n)}},{key:"refreshUI",value:function(){var e,t=this.getMovableHeader().querySelector("tbody");Object(m.hb)(this.getMovableHeader().querySelector("table")),"Left-Right"===this.parent.getFrozenMode()&&(e=this.getFrozenRightHeader().querySelector("tbody"),Object(m.hb)(this.getFrozenRightHeader().querySelector("table"))),i(o(r.prototype),"refreshFrozenLeftUI",this).call(this),this.rfshMovable(),this.getMovableHeader().querySelector("tbody").innerHTML=t.innerHTML,e&&(this.getFrozenRightHeader().querySelector("tbody").innerHTML=e.innerHTML),this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.notify("colgroup-refresh",{}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&hi([].slice.call(this.getMovableHeader().querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor();var n=this.parent.getContent().querySelector(".e-movablecontent").querySelector(".e-table");Object(m.hb)(n.querySelector("colgroup"));var s=this.getMovableHeader().querySelector("colgroup").cloneNode(!0);if(n.insertBefore(s,n.querySelector("tbody")),e){var a=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(".e-table");Object(m.hb)(a.querySelector("colgroup"));var l=this.getFrozenRightHeader().querySelector("colgroup").cloneNode(!0);a.insertBefore(l,a.querySelector("tbody"))}this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(q,{rows:this.rows,args:{isFrozen:!1}})}},{key:"refreshFreeze",value:function(e){var t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount(),n=this.parent.getMovableColumnsCount();if("filter"===e.case){var r=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&r&&this.getMovableHeader().querySelector("thead")){var s=this.parent.isRowDragable(),a=t?s?t+1:t:0,l=t+n+(t&&s?1:0);if(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(r,a,l)),"Left-Right"===this.parent.getFrozenMode()){var o=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.getFrozenRightHeader().querySelector("thead").appendChild(this.filterRenderer(r,a,a+i)),this.adjudtFilterBarCell(o)}var h=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.adjudtFilterBarCell(h)}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())}},{key:"updateFrozenColGroup",value:function(e,t){e&&!1===e.visible&&Object(m.ob)(t,{display:"none"})}},{key:"adjudtFilterBarCell",value:function(e){var t,i=c(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;C.c.bindInitialEvent({element:n,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}})}}catch(r){i.e(r)}finally{i.f()}}},{key:"renderPanel",value:function(){this.parent.getFrozenLeftColumnsCount()?(i(o(r.prototype),"renderPanel",this).call(this),this.parent.getFrozenRightColumnsCount()&&this.renderLeftWithRightFrozenPanel()):this.renderRightFrozenPanelAlone(),this.getPanel().firstChild.style.display="flex",this.getMovableHeader().style.flex="1"}},{key:"renderTable",value:function(){this.parent.getFrozenLeftColumnsCount()?i(o(r.prototype),"renderTable",this).call(this):this.renderFrozenRightTableAlone()}},{key:"rfshMovable",value:function(){if(this.parent.getFrozenLeftColumnsCount()){if(i(o(r.prototype),"rfshMovable",this).call(this),this.parent.getFrozenRightColumnsCount()){var e=this.rows;this.getFrozenRightHeader().appendChild(this.createTable()),this.refreshStackedHdrHgt(),this.parent.notify(q,{rows:this.rows,args:{renderFrozenRightContent:!0}}),this.rows=e}}else this.getFrozenRightHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createTable()),this.refreshStackedHdrHgt(),this.addMovableFirstCls()}},{key:"refreshStackedHdrHgt",value:function(){this.parent.getFrozenLeftColumnsCount()?(i(o(r.prototype),"refreshStackedHdrHgt",this).call(this),this.parent.getFrozenRightColumnsCount()&&this.refreshFrozenRightStackedHdrHgt()):this.refreshFrozenRightStackedHdrHgt()}},{key:"refreshFrozenRightStackedHdrHgt",value:function(){for(var e,t=this.getFrozenRightHeader().querySelectorAll(".e-columnheader"),i=this.getMovableHeader().querySelectorAll(".e-columnheader"),n=0,r=t.length;n<r;n++)e=this.getRowSpan(t[n]),this.getRowSpan(i[n]),e.min>1&&this.updateStackedHdrRowHgt(n,e.max,t[n],i)}},{key:"updateColgroup",value:function(){this.updateMovableColGroup(),this.parent.getFrozenLeftColumnsCount()&&this.updateFrozenLeftColGroup(),this.parent.getFrozenRightColumnsCount()&&this.updateFrozenRightColGroup()}},{key:"renderRightFrozenPanelAlone",value:function(){var e=this.parent.element.querySelector(".e-movableheader"),t=this.parent.element.querySelector(".e-frozen-right-header");i(o(r.prototype),"renderFrozenRightPanel",this).call(this),Object(m.X)(t)&&(e=this.parent.createElement("div",{className:"e-movableheader"}),t=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector(".e-headercontent").appendChild(e),this.getPanel().querySelector(".e-headercontent").appendChild(t)),i(o(r.prototype),"setMovableHeader",this).call(this,e),this.setFrozenRightHeader(t)}},{key:"renderLeftWithRightFrozenPanel",value:function(){var e=this.parent.element.querySelector(".e-frozen-right-header");i(o(r.prototype),"renderFrozenRightPanel",this).call(this),Object(m.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector(".e-headercontent").appendChild(e)),this.setFrozenRightHeader(e)}},{key:"renderFrozenRightTableAlone",value:function(){i(o(r.prototype),"renderFrozenRightTable",this).call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(q,{rows:this.rows,args:{isFrozen:!1}})}},{key:"updateFrozenLeftColGroup",value:function(){for(var e=this.getFrozenHeader().querySelector("colgroup").children,t=this.parent.isRowDragable()?1:0,i=this.parent.isRowDragable()?this.parent.getFrozenLeftColumnsCount()+1:this.parent.getFrozenLeftColumnsCount(),n=t;n<e.length;n++)n>=i&&(Object(m.hb)(e[n]),n--)}},{key:"updateMovableColGroup",value:function(){var e=this.getMovableHeader().querySelector("colgroup").children;this.parent.isRowDragable()&&Object(m.hb)(e[0]);for(var t=e.length,i=this.parent.getFrozenLeftColumnsCount(),n=this.parent.getMovableColumnsCount(),r=0,s=0;s<t;s++,r++)(s<i||s>=i+n)&&(Object(m.hb)(e[r]),r--)}},{key:"updateFrozenRightColGroup",value:function(){var e=this.parent.isRowDragable(),t=this.parent.getFrozenRightColumns(),i=this.getFrozenRightHeader().querySelector("colgroup").children;"Left-Right"===this.parent.getFrozenMode()&&e&&Object(m.hb)(i[0]);for(var n=i.length,r=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getMovableColumnsCount(),a=0,l=0;l<n;l++)l<r+s?Object(m.hb)(i[0]):(this.updateFrozenColGroup(t[a],i[a]),a++)}},{key:"setFrozenRightHeader",value:function(e){this.frozenRightHeader=e}},{key:"getFrozenRightHeader",value:function(){return this.frozenRightHeader}}]),r}(nr),sr=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).frzCount=0,n.isColGroupRefresh=!1,n.widthService=i.getService("widthService"),n}return f(r,[{key:"renderPanel",value:function(){this.parent.getFrozenLeftColumnsCount()?(i(o(r.prototype),"renderPanel",this).call(this),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightPanel()):this.renderFrozenRightPanelAlone();var e=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=e}},{key:"renderTable",value:function(){if(this.parent.getFrozenLeftColumnsCount()){if(i(o(r.prototype),"renderTable",this).call(this),this.parent.getFrozenRightColumnsCount()){this.renderFrozenLeftWithRightTable();var e=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",e,!0)}}else{this.renderFrozenRightTableAlone();var t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t)}this.getMovableContent().style.flex="1"}},{key:"appendScrollbar",value:function(e,t,i){var n=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});if(this.parent.getFrozenLeftColumnsCount()){if(i)return void this.parent.getContent().querySelector(".e-scrollbar").appendChild(e);n.appendChild(e),n.appendChild(t)}else n.appendChild(t),n.appendChild(e);this.parent.getContent().appendChild(n)}},{key:"renderFrozenRightPanelAlone",value:function(){this.renderFrozenRigthPanel();var e=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozen-right-content");Object(m.X)(t)&&(e=this.parent.createElement("div",{className:"e-movablecontent"}),t=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector(".e-content").appendChild(e),this.getPanel().querySelector(".e-content").appendChild(t)),i(o(r.prototype),"setMovableContent",this).call(this,e),this.setFrozenRightContent(t)}},{key:"renderFrozenLeftWithRightPanel",value:function(){this.renderFrozenRigthPanel();var e=this.parent.element.querySelector(".e-frozen-right-content");Object(m.X)(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector(".e-content").appendChild(e)),this.setFrozenRightContent(e)}},{key:"renderFrozenRightTableAlone",value:function(){var e;null==this.getFrozenRightContent().querySelector(".e-table")?(i(o(r.prototype),"renderFrozenRightTable",this).call(this),this.getFrozenRightContent().appendChild(this.getTable()),e=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(e)):(this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"),this.setTable(this.getFrozenRightContent().querySelector(".e-table")),this.setColGroup(this.getFrozenRightHeaderColGroup()),e=this.getMovableContent().querySelector(".e-table"),this.getFrozenRightContent().querySelector(".e-table").appendChild(this.getColGroup())),this.getMovableContent().querySelector("colgroup")&&Object(m.hb)(this.getMovableContent().querySelector("colgroup"));var t=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);e.insertBefore(t,e.querySelector("tbody"))}},{key:"renderFrozenLeftWithRightTable",value:function(){var e=this.getTable().cloneNode(!0);this.getFrozenRightContent().appendChild(e);var t=this.getFrozenRightContent().querySelector("colgroup");t&&Object(m.hb)(t);var i=this.getFrozenRightContent().querySelector(".e-table");i.insertBefore(this.getFrozenRightHeaderColGroup(),i.querySelector("tbody"))}},{key:"renderFrozenRightEmptyRowAlone",value:function(e){i(o(r.prototype),"renderFrozenRightEmpty",this).call(this,e),this.getMovableContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(m.v)([this.parent.getMovableContentTbody().querySelector("tr")],["e-emptyrow"]),this.getFrozenRightContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenRightCount(),this.parent.frozenRows&&(this.parent.getFrozenRightHeaderTbody().innerHTML="",this.parent.getMovableHeaderTbody().innerHTML="")}},{key:"getFrozenHeader",value:function(e){return"frozen-left"===e?this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelector("tbody"):"movable"===e?this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody")}},{key:"renderFrozenLeftWithRightEmptyRow",value:function(){this.getFrozenRightContent().querySelector("tbody").innerHTML="<tr><td></td></tr>",Object(m.v)([this.getFrozenRightContent().querySelector("tbody").querySelector("tr")],["e-emptyrow"]),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody").innerHTML="")}},{key:"setFrozenRightContent",value:function(e){this.frozenRigthContent=e}},{key:"getFrozenRightContent",value:function(){return this.frozenRigthContent}},{key:"getHeaderColGroup",value:function(){var e=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);if(!this.parent.getFrozenLeftColumnsCount()){var t=this.getFrozenRightHeaderColGroup();e=t&&this.frzCount?t.cloneNode(!0):e,this.frzCount++,this.isColGroupRefresh=!0}return e}},{key:"getFrozenRightHeaderColGroup",value:function(){var e=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("colgroup");return e||(e=this.parent.getHeaderContent().querySelector("colgroup")),e.cloneNode(!0)}},{key:"setColGroup",value:function(e){return this.parent.getFrozenLeftColumnsCount()?i(o(r.prototype),"setColGroup",this).call(this,e):(e=this.isColGroupRefresh?e:this.getFrozenRightHeaderColGroup(),Object(m.X)(e)||(e.id="content-"+e.id),this.isColGroupRefresh=!1,2===this.frzCount&&(this.frzCount=0),this.colgroup=e)}},{key:"renderEmpty",value:function(e){this.parent.getFrozenLeftColumnsCount()?(i(o(r.prototype),"renderEmpty",this).call(this,e),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenLeftCount(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightEmptyRow()):this.renderFrozenRightEmptyRowAlone(e),this.parent.notify("freezerender",{case:"refreshHeight"})}},{key:"setHeightToContent",value:function(e){this.parent.getFrozenRightColumnsCount()&&(this.getFrozenRightContent().style.height=e.toString()+"px"),this.parent.getFrozenLeftColumnsCount()&&(this.getFrozenContent().style.height=e.toString()+"px"),this.getMovableContent().style.height=e.toString()+"px"}},{key:"actionComplete",value:function(e){i(o(r.prototype),"actionComplete",this).call(this,e)}},{key:"batchAdd",value:function(e){i(o(r.prototype),"batchAdd",this).call(this,e)}},{key:"getTbody",value:function(e){var t;return"frozen-left"===e?t=this.parent.getFrozenLeftContentTbody():"movable"===e?t=this.parent.getMovableContentTbody():"frozen-right"===e&&(t=this.parent.getFrozenRightContentTbody()),t}},{key:"setIsFrozen",value:function(e,t){e.isFrozen="frozen-left"===t||"Right"===this.parent.getFrozenMode()&&"frozen-right"===t,e.renderFrozenRightContent="Left-Right"===this.parent.getFrozenMode()&&"frozen-right"===t,e.renderMovableContent="movable"===t}},{key:"appendContent",value:function(e,t,i,n){!Object(m.X)(this.parent.rowTemplate)&&this.parent.isReact?e=t:e.appendChild(t),"Left"===this.parent.getFrozenMode()?"frozen-left"===n?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(m.K)({},i))):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):"Right"===this.parent.getFrozenMode()?"movable"===n?(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):(this.isLoaded=!1,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(m.K)({},i))):"Left-Right"===this.parent.getFrozenMode()&&("frozen-left"===n?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(m.K)({},i))):"movable"===n?(this.refreshTbody(e),this.isLoaded=!1,this.getMovableContent().querySelector("table").appendChild(e),this.refreshContentRows(Object(m.K)({},i))):(this.isLoaded=!0,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset())),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1),this.widthService.refreshFrozenScrollbar()}},{key:"refreshHeight",value:function(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"})}},{key:"splitRows",value:function(e){var t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount();t&&!i?"frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows:!t&&i?"movable"===e?this.movableRows=this.rows:(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):t&&i&&("frozen-left"===e?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):"movable"===e?(this.movableRows=this.rows,this.movableRowElements=this.rowElements):(this.frozenRightRows=this.rows,this.frozenRightRowElements=this.rowElements))}},{key:"getMovableRowElements",value:function(){return 2===this.parent.getTablesCount()?this.rowElements:this.movableRowElements}},{key:"getFrozenRightRowElements",value:function(){return 2===this.parent.getTablesCount()?this.freezeRowElements:this.frozenRightRowElements}},{key:"getFrozenRightRows",value:function(){return"Left-Right"===this.parent.getFrozenMode()?this.parent.enableInfiniteScrolling?this.rightFreezeRows:this.frozenRightRows:this.getRows()}},{key:"getFrozenRightRowByIndex",value:function(e){return this.parent.getFrozenRightDataRows()[e]}},{key:"getRows",value:function(){var e=this.getInfiniteRows();return e.length?e:this.freezeRows}},{key:"getRowElements",value:function(){return this.freezeRowElements}}]),r}(ir),ar=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).frzRows=[],n.mvblRows=[],n.frRows=[],n.serviceLoc=i,n.eventListener("on"),n.rowModelGenerator=new $(n.parent),n}return f(r,[{key:"eventListener",value:function(e){this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent.addEventListener(E,this.actionComplete.bind(this))}},{key:"actionComplete",value:function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++)wr(this,t)}},{key:"refreshVirtualFrozenRows",value:function(e){var t=this,i=this.parent;if("delete"===e.requestType&&i.frozenRows){e.isFrozenRowsRender=!0;var n=i.getSelectedRowIndexes(),r=i.renderModule.data.generateQuery(!0).clone();r.page(1,i.pageSettings.pageSize),i.renderModule.data.getData({},r).then((function(r){or(e,r.result,n,i,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)}))}}},{key:"getVirtualData",value:function(e){this.virtualRenderer.getVirtualData(e)}},{key:"setFreezeSelection",value:function(e){ur(e,this.virtualRenderer)}},{key:"renderTable",value:function(){this.freezeRowGenerator=new tr(this.parent),this.virtualRenderer=new In(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(U.Header).virtualHdrRenderer,i(o(r.prototype),"renderTable",this).call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var e=this.getFrozenContent(),t=this.getMovableContent(),n=this.parent.height;if(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(n),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization){this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector(".e-movablecontent"),this.virtualRenderer.virtualEle.renderMovableWrapper(n),this.virtualRenderer.virtualEle.renderMovablePlaceHolder();var s=t.querySelector("table");this.virtualRenderer.virtualEle.movableTable=s,this.virtualRenderer.virtualEle.movableWrapper.appendChild(s),t.appendChild(this.virtualRenderer.virtualEle.movableWrapper),t.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder)}this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.table=this.getTable(),kr(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())}},{key:"appendContent",value:function(e,t,i){pr(this.virtualRenderer,this.widthService,e,t,i)}},{key:"generateRows",value:function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),gr(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)}},{key:"getRowByIndex",value:function(e){return this.virtualRenderer.getRowByIndex(e)}},{key:"getMovableRowByIndex",value:function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)}},{key:"collectRows",value:function(e){return cr(e,this.virtualRenderer,this.parent)}},{key:"getMovableRows",value:function(){return this.collectRows("movable")}},{key:"getRows",value:function(){return this.collectRows("frozen-left")}},{key:"getColGroup",value:function(){var e=this.parent.getMovableVirtualContent();return this.isXaxis()?e.querySelector("colgroup"):this.colgroup}},{key:"getReorderedFrozenRows",value:function(e){return fr(e,this.virtualRenderer,this.parent,0,this.firstPageRecords)}},{key:"isXaxis",value:function(){return mr(this.virtualRenderer)}},{key:"getHeaderCells",value:function(){return vr(this.virtualRenderer,this.parent)}},{key:"getVirtualFreezeHeader",value:function(){return br(this.virtualRenderer,this.parent)}},{key:"ensureFrozenCols",value:function(e){return yr(e,this.parent)}},{key:"getRowObjectByIndex",value:function(e){return this.virtualRenderer.getRowObjectByIndex(e)}},{key:"setColGroup",value:function(e){return Cr(e,this.virtualRenderer,this)}}]),r}(ir),lr=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).serviceLoc=i,n}return f(r,[{key:"renderTable",value:function(){this.virtualHdrRenderer=new Mn(this.parent,this.serviceLoc),this.virtualHdrRenderer.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.virtualHdrRenderer.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent"))),this.virtualHdrRenderer.virtualEle.content=this.getPanel().querySelector(".e-headercontent"),this.virtualHdrRenderer.virtualEle.renderFrozenWrapper(),this.virtualHdrRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization&&(this.virtualHdrRenderer.virtualEle.movableContent=this.getPanel().querySelector(".e-movableheader"),this.virtualHdrRenderer.virtualEle.renderMovableWrapper(),this.virtualHdrRenderer.virtualEle.renderMovablePlaceHolder()),i(o(r.prototype),"renderTable",this).call(this),this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent())}},{key:"rfshMovable",value:function(){this.getFrozenHeader().appendChild(this.getTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getFrozenHeader()),this.parent.enableColumnVirtualization?this.virtualHdrRenderer.virtualEle.movableWrapper.appendChild(this.createTable()):this.getMovableHeader().appendChild(this.createTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getMovableHeader())}}]),r}(nr);function or(e,t,i,n,r,s,a,l){n.clearSelection(),e.startIndex=0;var o=new Z(s,null,n),h=r.generateRows(t,e);e.renderMovableContent?(a.vgenerator.movableCache[1]=h,h=n.getMovableRowsObject()):e.renderFrozenRightContent||e.renderMovableContent?e.renderFrozenRightContent&&(a.vgenerator.frozenRightCache[1]=h,h=n.getFrozenRightRowsObject()):(a.vgenerator.cache[1]=h,h=n.getRowsObject());var c=e.renderMovableContent||e.renderFrozenRightContent?e.renderMovableContent?n.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):n.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("tbody"):n.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody");c.innerHTML="";for(var u=0;u<n.frozenRows;u++)if(c.appendChild(o.render(h[u],n.getColumns())),i.indexOf(u)>-1){h[u].isSelected=!0;for(var d=0;d<h[u].cells.length;d++)h[u].cells[d].isSelected=!0}e.renderMovableContent?l.mvblRows=a.vgenerator.movableCache[1]:e.renderMovableContent||e.renderFrozenRightContent?e.renderFrozenRightContent&&(l.frRows=a.vgenerator.frozenRightCache[1]):l.frzRows=a.vgenerator.cache[1],e.renderMovableContent=!e.renderMovableContent&&!e.renderFrozenRightContent,e.renderFrozenRightContent="Left-Right"===n.getFrozenMode()&&!e.renderMovableContent&&!e.renderFrozenRightContent,(e.renderMovableContent||e.renderFrozenRightContent)&&(or(e,t,i,n,r,s,a,l),e.renderMovableContent||e.renderFrozenRightContent||(e.isFrozenRowsRender=!1))}function hr(e,t,i){for(var n=[],r=0;r<e.length;r++)n.push(Object(m.K)({},e[r])),n[r].cells=Wi(i,n[r].cells,t);return n}function cr(e,t,i){var n,r=[];"frozen-left"===e?n=t.vgenerator.cache:"movable"===e?n=t.vgenerator.movableCache:"frozen-right"===e&&(n="Right"===i.getFrozenMode()?t.vgenerator.cache:t.vgenerator.frozenRightCache);for(var s=Object.keys(n),a=0;a<s.length;a++)r=[].concat(h(r),h(hr(n[s[a]],e,i)));return r}function ur(e,t){for(var i=Object.keys(t.vgenerator.cache),n=Object.keys(t.vgenerator.movableCache),r=Object.keys(t.vgenerator.frozenRightCache),s=0;s<i.length;s++)dr(e,t.vgenerator.cache[i[s]]);for(var a=0;a<n.length;a++)dr(e,t.vgenerator.movableCache[n[a]]);for(var l=0;l<r.length;l++)dr(e,t.vgenerator.frozenRightCache[r[l]])}function dr(e,t){for(var i=t.filter((function(t){return e.clearAll||e.uid===t.uid})),n=0;n<i.length;n++){i[n].isSelected=e.set;for(var r=i[n].cells,s=0;s<r.length;s++)r[s].isSelected=e.set}}function pr(e,t,i,n,r){e.appendContent(i,n,r),t.refreshFrozenScrollbar()}function gr(e,t,i,n,r){var s;s=e.vgenerator.generateRows(t,i).map((function(e){return Object(m.K)({},e)}));var a=n.generateRows(t,i,s);return r.frozenRows&&"delete"===i.requestType&&1===r.pageSettings.currentPage&&(a=a.slice(r.frozenRows)),a}function fr(e,t,i,n,r){var s,a=e.virtualInfo.blockIndexes,l=e.virtualInfo.columnIndexes,o=e.virtualInfo.page;return e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]),s=function(e,t,i){for(var n=Ni(t,t.tableIndex),r=0,s=e.length;r<s;r++)e[r].cells=Wi(t,e[r].cells,n);return e}(t.vgenerator.generateRows(r,e),i),e.virtualInfo.blockIndexes=a,e.virtualInfo.columnIndexes=l,e.virtualInfo.page=o,s.splice(0,i.frozenRows)}function mr(e){var t=!1;return e&&(t="virtualscroll"===e.requestType&&"X"===e.currentInfo.sentinelInfo.axis),t}function vr(e,t){var i=mr(e)?t.getMovableVirtualHeader():t.getHeaderContent();return i?[].slice.call(i.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]}function br(e,t){return mr(e)?t.getMovableVirtualHeader().querySelector(".e-table"):t.getFrozenVirtualHeader().querySelector(".e-table")}function yr(e,t){return t.columns.slice(0,t.getFrozenColumns()).concat(e)}function Cr(e,t,i){return mr(t)||(Object(m.X)(e)||(e.id="content-"+e.id),i.colgroup=e),i.colgroup}function wr(e,t){e.virtualRenderer.vgenerator.cache[1]?e.virtualRenderer.vgenerator.cache[1][t]=e.frzRows[t]:e.virtualRenderer.vgenerator.cache[1]=e.frzRows,e.virtualRenderer.vgenerator.movableCache[1]?e.virtualRenderer.vgenerator.movableCache[1][t]=e.mvblRows[t]:e.virtualRenderer.vgenerator.movableCache[1]=e.mvblRows}function kr(e,t,i,n){var r=e.dataSource instanceof v.a&&!e.dataSource.dataSource.offline,s={container:t.content,pageHeight:2*t.getBlockHeight(),debounceEvent:r,axes:e.enableColumnVirtualization?["X","Y"]:["Y"],scrollbar:i,movableContainer:n};t.observer=new Dn(t.virtualEle.wrapper,s,t.virtualEle.movableWrapper)}var Sr,Or,xr,jr,Rr,Dr,Er,Ir,Mr,Fr,Tr,Ar,zr=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).frRows=[],n.frzRows=[],n.mvblRows=[],n.serviceLoc=i,n.eventListener("on"),n.rowModelGenerator=new $(n.parent),n}return f(r,[{key:"actionComplete",value:function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++){if(!this.virtualRenderer.vgenerator.frozenRightCache[1]){this.virtualRenderer.vgenerator.frozenRightCache[1]=this.frRows.length?this.frRows:this.frzRows;break}this.virtualRenderer.vgenerator.frozenRightCache[1][t]=this.frRows.length?this.frRows[t]:this.frzRows[t],wr(this,t)}}},{key:"eventListener",value:function(e){this.parent.addEventListener(E,this.actionComplete.bind(this)),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent[e]("get-virtual-data",this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this)}},{key:"refreshVirtualFrozenRows",value:function(e){var t=this;if("delete"===e.requestType&&this.parent.frozenRows){e.isFrozenRowsRender=!0;var i=this.parent.renderModule.data.generateQuery(!0).clone();i.page(1,this.parent.pageSettings.pageSize);var n=this.parent.getSelectedRowIndexes();this.parent.renderModule.data.getData({},i).then((function(i){or(e,i.result,n,t.parent,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)}))}}},{key:"setFreezeSelection",value:function(e){ur(e,this.virtualRenderer)}},{key:"getVirtualData",value:function(e){this.virtualRenderer.getVirtualData(e)}},{key:"renderNextFrozentPart",value:function(e){"Left"!==this.parent.getFrozenMode()&&"Right"!==this.parent.getFrozenMode()||1===this.parent.tableIndex&&(e.renderMovableContent=!0,this.refreshContentRows(Object(m.K)({},e))),"Left-Right"===this.parent.getFrozenMode()&&(1!==this.parent.tableIndex&&2!==this.parent.tableIndex||(e.renderMovableContent=1===this.parent.tableIndex,e.renderFrozenRightContent=2===this.parent.tableIndex,this.refreshContentRows(Object(m.K)({},e))))}},{key:"renderTable",value:function(){this.virtualRenderer=new In(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(U.Header).virtualHdrRenderer,this.freezeRowGenerator=new tr(this.parent),i(o(r.prototype),"renderTable",this).call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var e=this.getFrozenRightContent(),t=this.getFrozenContent(),n=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(t=e),this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(this.parent.height),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.renderVirtualFrozenLeft(t,n),this.renderVirtualFrozenRight(t,n),this.renderVirtualFrozenLeftRight(t,n,e),this.virtualRenderer.virtualEle.table=this.getTable(),kr(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())}},{key:"renderVirtualFrozenLeft",value:function(e,t){"Left"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t))}},{key:"renderVirtualFrozenRight",value:function(e,t){"Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(e))}},{key:"renderVirtualFrozenLeftRight",value:function(e,t,i){"Left-Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(i))}},{key:"appendContent",value:function(e,t,i){pr(this.virtualRenderer,this.widthService,e,t,i),this.refreshScrollOffset()}},{key:"generateRows",value:function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),gr(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)}},{key:"getRowByIndex",value:function(e){return this.virtualRenderer.getRowByIndex(e)}},{key:"getFrozenRightRowByIndex",value:function(e){return this.virtualRenderer.getFrozenRightVirtualRowByIndex(e)}},{key:"collectRows",value:function(e){return cr(e,this.virtualRenderer,this.parent)}},{key:"getMovableRowByIndex",value:function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)}},{key:"getFrozenRightRows",value:function(){return this.collectRows("frozen-right")}},{key:"getMovableRows",value:function(){return this.collectRows("movable")}},{key:"getColGroup",value:function(){var e=this.parent.getMovableVirtualContent();return mr(this.virtualRenderer)?e.querySelector("colgroup"):this.colgroup}},{key:"getRows",value:function(){return this.collectRows("Right"===this.parent.getFrozenMode()?"frozen-right":"frozen-left")}},{key:"getReorderedFrozenRows",value:function(e){return fr(e,this.virtualRenderer,this.parent,0,this.firstPageRecords)}},{key:"getHeaderCells",value:function(){return vr(this.virtualRenderer,this.parent)}},{key:"isXaxis",value:function(){return mr(this.virtualRenderer)}},{key:"getVirtualFreezeHeader",value:function(){return br(this.virtualRenderer,this.parent)}},{key:"getRowObjectByIndex",value:function(e){return this.virtualRenderer.getRowObjectByIndex(e)}},{key:"ensureFrozenCols",value:function(e){return yr(e,this.parent)}},{key:"setColGroup",value:function(e){return Cr(e,this.virtualRenderer,this)}}]),r}(sr),Lr=function(e){n(i,e);var t=s(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).childCount=0,r.scrollData=[],r.isFirstChildRow=!1,r.groupCache={},r.startIndexes={},r.captionCounts={},r.rowsByUid={},r.objIdxByUid={},r.initialGroupCaptions={},r.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete"],r.cacheMode=!1,r.cacheBlockSize=5,r.ignoreAccent=!!r.parent.allowFiltering&&r.parent.filterSettings.ignoreAccent,r.allowCaseSensitive=!1,r.locator=n,r.groupGenerator=new ne(r.parent),r.summaryModelGen=new te(r.parent),r.captionModelGen=new ie(r.parent),r.rowRenderer=new Z(r.locator,null,r.parent),r.eventListener(),r}return f(i,[{key:"eventListener",value:function(){this.parent.addEventListener(D,this.actionBegin.bind(this)),this.parent.addEventListener(E,this.actionComplete.bind(this)),this.parent.on(F,this.setLazyLoadPageSize,this),this.parent.on("group-cache",this.setCache,this),this.parent.on("lazy-load-scroll-handler",this.scrollHandler,this),this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("group-collapse",this.collapseShortcut,this)}},{key:"captionExpand",value:function(e){var t=this,i=this.parent.pageSettings.currentPage,n=this.groupCache[i],r=e.getAttribute("data-uid"),s=this.getRowObjectIndexByUid(r),a=!!n[s+1]&&n[s].indent<n[s+1].indent,l=n[s],o=this.getGroupKeysAndFields(s,n);this.parent.trigger("lazyLoadGroupExpand",{captionRowElement:e,groupInfo:l,enableCaching:!0,cancel:!1},(function(n){n.cancel||(n.keys=o.keys,n.fields=o.fields,n.rowIndex=e.rowIndex,n.makeRequest=!n.enableCaching||!a,!n.enableCaching&&a&&t.clearCache([r]),n.skip=0,n.take=t.pageSize,l.isExpand=t.rowsByUid[i][l.uid].isExpand=!0,t.captionRowExpand(n))}))}},{key:"captionCollapse",value:function(e){var t=this,i=this.groupCache[this.parent.pageSettings.currentPage],n=e.rowIndex,r=e.getAttribute("data-uid"),s=this.getRowObjectIndexByUid(r);this.parent.trigger("lazyLoadGroupCollapse",{captionRowElement:e,groupInfo:i[s],cancel:!1},(function(e){e.cancel||(e.isExpand=!1,t.removeRows(s,n))}))}},{key:"setLazyLoadPageSize",value:function(){var e=this.parent.getContent().firstElementChild,t=Math.floor(e.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t,this.blockSize=Math.ceil(this.pageSize/2)}},{key:"clearLazyGroupCache",value:function(){this.clearCache()}},{key:"clearCache",value:function(e){e=e||this.getInitialCaptionIndexes();var t=this.groupCache[this.parent.pageSettings.currentPage];if(e.length)for(var i=0;i<e.length;i++){var n=this.getRowObjectIndexByUid(e[i]),r=t[n];if(r){if(this.captionCounts[this.parent.pageSettings.currentPage][r.uid])for(var s=n+1;s<t.length;s++){if(t[s].indent===r.indent||t[s].indent<r.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][r.uid];break}t[s].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[s].uid]}if(r.isExpand){var a=this.parent.getRowElementByUID(r.uid);if(!a)return;this.parent.groupModule.expandCollapseRows(a.querySelector(".e-recordplusexpand"))}var l=this.getNextChilds(n);if(l.length){var o=[];l[l.length-1].isCaptionRow&&(o=this.getChildRowsByParentIndex(t.indexOf(l[l.length-1]),!1,!1,null,!0,!0));var h=t.indexOf(l[0]),c=t.indexOf(o.length?o[o.length-1]:l[l.length-1]);t.splice(h,c-(h-1)),this.refreshCaches()}}}}},{key:"refreshCaches",value:function(){var e=this.groupCache[this.parent.pageSettings.currentPage];this.rowsByUid={},this.objIdxByUid={};for(var t=0;t<e.length;t++)this.maintainRows(e[t],t)}},{key:"getInitialCaptionIndexes",value:function(){for(var e=this.parent.pageSettings.currentPage,t=[],i=0;i<this.initialGroupCaptions[e].length;i++)t.push(this.initialGroupCaptions[e][i].uid);return t}},{key:"getRowObjectIndexByUid",value:function(e){return this.objIdxByUid[this.parent.pageSettings.currentPage][e]}},{key:"collapseShortcut",value:function(e){if(this.parent.groupSettings.columns.length&&e.target&&Wt(e.target,"e-content")&&"TR"===e.target.parentElement.tagName){if(!e.collapse&&Wt(e.target,"e-row"))return;var t=e.target.parentElement.getAttribute("data-uid");if(e.collapse){var i=this.getRowByUid(t),n=this.getRowByUid(i.parentUid);if(n.isCaptionRow&&n.isExpand){var r=this.getRowElementByUid(i.parentUid);this.parent.groupModule.expandCollapseRows(r.cells[i.indent-1])}}else{var s=this.getRowByUid(t);if(s.isCaptionRow&&!s.isExpand){var a=this.getRowElementByUid(t);this.parent.groupModule.expandCollapseRows(a.cells[s.indent])}}}}},{key:"getRowByUid",value:function(e){return this.rowsByUid[this.parent.pageSettings.currentPage][e]}},{key:"actionBegin",value:function(e){if(!e.cancel){if(this.requestType.some((function(t){return t===e.requestType}))||(this.groupCache={},this.resetRowMaintenance()),"reorder"===e.requestType&&this.parent.groupSettings.columns.length)for(var t=Object.keys(this.groupCache),i=0;i<t.length;i++)for(var n=this.groupCache[t[i]],r=0;r<n.length;r++)n[r].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(n[r],null,t[i]),n[r].isDataRow&&this.moveCells(n[r].cells,e.fromIndex+n[r].indent,e.toIndex+n[r].indent);("delete"===e.requestType||"add"===e.action&&"save"===e.requestType)&&(this.groupCache={},this.resetRowMaintenance())}}},{key:"actionComplete",value:function(e){e.cancel||"columnstate"===e.requestType||"beginEdit"===e.requestType||"delete"===e.requestType||"save"===e.requestType||"reorder"===e.requestType||this.scrollReset()}},{key:"resetRowMaintenance",value:function(){this.startIndexes={},this.captionCounts={},this.rowsByUid={},this.objIdxByUid={},this.initialGroupCaptions={}}},{key:"moveCells",value:function(e,t,i){if(t>=e.length)for(var n=t-e.length;1+n--;)e.push(void 0);e.splice(t,0,e.splice(i,1)[0])}},{key:"removeRows",value:function(e,t){var i,n=this.parent.pageSettings.currentPage,r=this.groupCache[n],s=[].slice.call(this.parent.getContent().querySelectorAll("tr"));if(this.parent.aggregates.length){var a=this.getAggregateByCaptionIndex(e);i=a.length?a[a.length-1].uid:void 0}var l,o=r[e].indent;this.addClass(this.getNextChilds(e)),r[e].isExpand=this.rowsByUid[n][r[e].uid].isExpand=!1;for(var h=e+1;h<r.length;h++){if(r[h].indent===o||r[h].indent<o){l=r[h].uid;break}r[h].isCaptionRow&&r[h].isExpand&&this.addClass(this.getNextChilds(h))}for(var c=t+1;c<s.length&&s[c].getAttribute("data-uid")!==l;c++){if(s[c].getAttribute("data-uid")===i){Object(m.hb)(s[c]);break}Object(m.hb)(s[c])}}},{key:"addClass",value:function(e){var t=e[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")}},{key:"getNextChilds",value:function(e,t){for(var i=this.groupCache[this.parent.pageSettings.currentPage],n=t||i,r=i[e].indent+1,s=[],a=t?0:e+1;a<n.length&&!(n[a].indent<r);a++)n[a].indent===r&&s.push(n[a]);return s}},{key:"lazyLoadHandler",value:function(e){this.setStartIndexes();var t=this.parent.getContent().querySelectorAll("tr")[e.index].getAttribute("data-uid"),i=this.getRowObjectIndexByUid(t),n=this.groupCache[this.parent.pageSettings.currentPage][i],r=e.isRowExist?e.isScroll?this.scrollData:this.getChildRowsByParentIndex(i,!0,!0,null,!0):[];if(this.scrollData=[],!e.isRowExist)if(this.setRowIndexes(i,n),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][i],e.count),-1!==Object.keys(e.data).indexOf("GroupGuid"))for(var s=0;s<e.data.length;s++){var a=this.groupGenerator.generateCaptionRow(e.data[s],e.level,n.parentGid,void 0,0,n.uid);r.push(a),this.parent.aggregates.length&&(r=r.concat(this.summaryModelGen.generateRows(e.data[s],{level:e.level+1,parentUid:a.uid})))}else this.groupGenerator.index=this.getStartIndex(i,e.isScroll),r=this.groupGenerator.generateDataRows(e.data,e.level,n.parentGid,0,n.uid);var l=e.isScroll?this.rowIndex:e.index,o=this.getNextChilds(i,r),h=!!e.up||this.hasLastChildRow(e.isScroll,e.count,o.length);e.isRowExist||h||(o[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down"),h||(o[o.length-1].lazyLoadCssClass="e-not-lazyload-end");var c=e.isScroll||e.isRowExist?[]:this.getAggregateByCaptionIndex(i);e.up||e.isRowExist||this.refreshRowObjects(r,e.isScroll?this.rowObjectIndex:i),this.render(l,r,h,c),this.isFirstChildRow&&!e.up&&(this.parent.getContent().firstElementChild.scrollTop=r.length*this.parent.getRowHeight()),this.isFirstChildRow=!1,this.rowIndex=void 0,this.rowObjectIndex=void 0,this.childCount=0}},{key:"setRowIndexes",value:function(e,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={}),t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)}},{key:"getStartIndex",value:function(e,t){var i=this.parent.pageSettings.currentPage,n=this.groupCache[i];if(t)return n[this.rowObjectIndex].index+1;var r=0,s=0,a=this.getRowByUid(n[e].parentUid);if(a&&(s=this.prevCaptionCount(a)),n[e].indent>0)for(var l=e-1;l>=0&&!(n[l].indent<n[e].indent);l--)n[l].isCaptionRow&&n[l].indent===n[e].indent&&(r+=n[l].data.count);return r+s+this.startIndexes[i][n[e].parentGid]}},{key:"prevCaptionCount",value:function(e){for(var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],n=0,r=i.indexOf(e)-1;r>=0&&0!==i[r].indent&&!(i[r].indent<e.indent);r--)i[r].isCaptionRow&&i[r].indent===e.indent&&(n+=this.captionCounts[t][i[r].uid]||i[r].data.count);var s=this.getRowByUid(e.parentUid);return s&&(n+=this.prevCaptionCount(s)),n}},{key:"setStartIndexes",value:function(){var e=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){for(var t,i=[],n=0;n<e.length;n++)e[n].isCaptionRow&&(i.push(i.length?e[t].data.count+i[i.length-1]:0),t=n);this.startIndexes[this.parent.pageSettings.currentPage]=i}}},{key:"hasLastChildRow",value:function(e,t,i){return e?t===this.childCount+i:t===i}},{key:"refreshCaptionRowCount",value:function(e,t){e.data.count=t}},{key:"render",value:function(e,t,i,n){var r=this.parent.getContent().querySelectorAll("tr")[e];if(r&&n.length)for(var s=n.length-1;s>=0;s--)r.insertAdjacentElement("afterend",this.rowRenderer.render(n[s],this.parent.getColumns()));if(r&&t.length)for(var a=t.length-1;a>=0;a--)this.confirmRowRendering(t[a])&&r.insertAdjacentElement("afterend",this.rowRenderer.render(t[a],this.parent.getColumns()))}},{key:"maintainRows",value:function(e,t){var i=this.parent.pageSettings.currentPage;this.rowsByUid[i]||(this.rowsByUid[i]={},this.objIdxByUid[i]={}),e.uid&&(this.rowsByUid[i][e.uid]=e),this.objIdxByUid[i][e.uid]=t}},{key:"confirmRowRendering",value:function(e){var t=!0;if(Object(m.X)(e.indent)&&!e.isDataRow&&!e.isCaptionRow){var i=this.getRowByUid(e.parentUid);i.isCaptionRow&&!i.isExpand&&(t=!1)}return t}},{key:"refreshRowObjects",value:function(e,t){var i=this.parent.pageSettings.currentPage,n=this.groupCache[i];this.rowsByUid[i]={},this.objIdxByUid[i]={};for(var r=[],s=0,a=0;a<n.length;a++)if(a===t){this.maintainRows(n[a],s),r.push(n[a]),s++;for(var l=0;l<e.length;l++)this.maintainRows(e[l],s),r.push(e[l]),s++}else this.maintainRows(n[a],s),r.push(n[a]),s++;this.groupCache[this.parent.pageSettings.currentPage]=Object(m.K)([],r),this.updateCurrentViewData()}},{key:"getAggregateByCaptionIndex",value:function(e){for(var t=this.groupCache[this.parent.pageSettings.currentPage],i=t[e],n=i.indent,r=i.uid,s=[],a=e+1;a<t.length&&t[a].indent!==n;a++)Object(m.X)(t[a].indent)&&t[a].parentUid===r&&s.push(t[a]);return s}},{key:"getChildRowsByParentIndex",value:function(e,t,i,n,r,s){var a=n||this.groupCache[this.parent.pageSettings.currentPage],l=a[e],o=[];if(!l.isCaptionRow||l.isCaptionRow&&!l.isExpand&&!s)return[];r&&this.parent.aggregates.length&&(o=this.getAggregateByCaptionIndex(e));for(var h=l.indent,c=l.uid,u=[],d=0,p=e+1;p<a.length;p++){if(a[p].parentUid===c){if(Object(m.X)(a[p].indent))continue;if(d++,u.push(a[p]),t&&a[p].isCaptionRow&&(u=u.concat(this.getChildRowsByParentIndex(p,t,i,n,r))),i&&d===this.pageSize)break}if(a[p].indent===h)break}return u.concat(o)}},{key:"initialGroupRows",value:function(e){var t=[],i=this.groupCache[this.parent.pageSettings.currentPage];if(e)return this.getRenderedRowsObject();for(var n=0;n<i.length;n++)0===i[n].indent&&(t.push(i[n]),t=t.concat(this.getChildRowsByParentIndex(n,!0,!0,i,!0)));return t}},{key:"getRenderedRowsObject",value:function(){for(var e=[],t=[].slice.call(this.parent.getContent().querySelectorAll("tr")),i=0;i<t.length;i++)e.push(this.getRowByUid(t[i].getAttribute("data-uid")));return e}},{key:"getCacheRowsOnDownScroll",value:function(e){for(var t=[],i=this.groupCache[this.parent.pageSettings.currentPage],n=e,r=0;r<this.pageSize&&i[n]&&!(i[n].indent<i[e].indent);r++)i[n].indent===i[e].indent&&(t.push(i[n]),i[n].isCaptionRow&&i[n].isExpand&&(t=t.concat(this.getChildRowsByParentIndex(n,!0,!0,null,!0)))),(i[n].indent>i[e].indent||Object(m.X)(i[n].indent))&&r--,n++;return t}},{key:"getCacheRowsOnUpScroll",value:function(e,t,i){for(var n=[],r=this.groupCache[this.parent.pageSettings.currentPage],s=!1,a=0;a<r.length&&(!s||r[a]&&!(r[a].indent<r[i].indent)&&r[a].uid!==t);a++)s||r[a].uid!==e||(s=!0),s&&r[a].indent===r[i].indent&&(n.push(r[a]),r[a].isCaptionRow&&r[a].isExpand&&(n=n.concat(this.getChildRowsByParentIndex(a,!0,!0,null,!0))));return n}},{key:"scrollHandler",value:function(e){if(!this.parent.isDestroyed&&!this.childCount){var t,i=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-down")),n=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-up")),r=[].slice.call(this.parent.getContent().querySelectorAll(".e-not-lazyload-end")),s=!1,a=!1,l=!1;if(e.scrollDown&&i.length){var o=this.findRowElements(i);t=o.tr,s=o.entered}if(!e.scrollDown&&r)for(var h=0;h<r.length;h++){var c=r[h].getBoundingClientRect().top,u=this.parent.getContent().scrollHeight;if(c>0&&c<u){t=r[h],l=!0,this.rowIndex=t.rowIndex;break}}if(!e.scrollDown&&n.length&&!l){var d=this.findRowElements(n);t=d.tr,a=d.entered}t&&(s&&e.scrollDown&&s&&t&&this.scrollDownHandler(t),!e.scrollDown&&l&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!e.scrollDown&&!l&&a&&t&&this.scrollUpHandler(t))}}},{key:"scrollUpEndRowHandler",value:function(e){var t=this.groupCache[this.parent.pageSettings.currentPage],i=e.getAttribute("data-uid"),n=this.rowObjectIndex=this.getRowObjectIndexByUid(i),r=n,s=t[n],a=this.getRowByUid(s.parentUid),l=this.getRowObjectIndexByUid(a.uid),o=this.parent.getContent().querySelector("tr[data-uid="+a.uid+"]").rowIndex,h=this.getChildRowsByParentIndex(l).indexOf(s),c=Math.ceil(h/this.pageSize);if(1!==c)if(this.childCount=c*this.pageSize,n=this.getCurrentBlockEndIndex(s,n),this.childCount<a.data.count){e.classList.remove("e-not-lazyload-end"),s.lazyLoadCssClass="";var u=!!t[n+1]&&s.indent===t[n+1].indent;this.scrollData=u?this.getCacheRowsOnDownScroll(n+1):[];var d=this.getGroupKeysAndFields(l,t),p={rowIndex:o,makeRequest:!u,groupInfo:a,fields:d.fields,keys:d.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize){var g=this.getChildRowsByParentIndex(l),f=Math.ceil(g.indexOf(t[r])/this.pageSize)-(this.cacheBlockSize-1);this.removeBlock(i,u,f,g),p.cachedRowIndex=f*this.pageSize}this.captionRowExpand(p)}else this.childCount=0}},{key:"scrollDownHandler",value:function(e){var t=this.groupCache[this.parent.pageSettings.currentPage],i=e.getAttribute("data-uid"),n=this.getRowObjectIndexByUid(i),r=n,s=t[n],a=this.getRowByUid(s.parentUid),l=this.getRowObjectIndexByUid(a.uid),o=this.getRowElementByUid(a.uid).rowIndex,h=this.getChildRowsByParentIndex(l),c=h.indexOf(s),u=Math.ceil(c/this.pageSize);this.childCount=u*this.pageSize;var d=t[n=this.rowObjectIndex=this.getRowObjectIndexByUid(h[this.childCount-1].uid)],p=this.getRowElementByUid(d.uid);if(this.rowIndex=p.rowIndex,n=this.getCurrentBlockEndIndex(d,n),this.childCount<a.data.count){var g=!!t[n+1]&&s.indent===t[n+1].indent;if(g&&!Object(m.X)(this.getRowElementByUid(t[n+1].uid)))return void(this.childCount=0);(u>1||!this.cacheMode)&&(e.classList.remove("e-lazyload-middle-down"),p.classList.remove("e-not-lazyload-end"),d.lazyLoadCssClass=""),this.scrollData=g?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];var f=this.getGroupKeysAndFields(l,t),v={rowIndex:o,makeRequest:!g,groupInfo:a,fields:f.fields,keys:f.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize){var b=this.getChildRowsByParentIndex(l),y=Math.ceil(b.indexOf(t[r])/this.pageSize)-1-(this.cacheBlockSize-1)+1;this.removeBlock(i,g,y,b,d),v.cachedRowIndex=y*this.pageSize}this.captionRowExpand(v)}else this.childCount=0}},{key:"getCurrentBlockEndIndex",value:function(e,t){var i=this.groupCache[this.parent.pageSettings.currentPage];if(e.isCaptionRow){if(e.isExpand){var n=this.getChildRowsByParentIndex(t,!0).length;this.rowIndex=this.rowIndex+n}var r=this.getAggregateByCaptionIndex(t);this.rowObjectIndex=this.rowObjectIndex+r.length;for(var s=t,a=s+1;a<i.length;a++){if(i[a].indent===i[t].indent||i[a].indent<i[t].indent){t=s;break}s++}}return t}},{key:"removeBlock",value:function(e,t,i,n,r){var s=n[(i+1)*this.pageSize-1-this.blockSize].uid,a=n[i*this.pageSize-this.pageSize].uid,l=n[i*this.pageSize].uid;this.groupCache[this.parent.pageSettings.currentPage][this.getRowObjectIndexByUid(s)].lazyLoadCssClass="e-lazyload-middle-up",this.getRowElementByUid(s).classList.add("e-lazyload-middle-up"),r&&(this.getRowElementByUid(l).classList.add("e-not-lazyload-first"),this.getRowByUid(l).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(a).lazyLoadCssClass=""),t?this.removeTopRows(r?r.uid:e,a,l):(this.uid1=a,this.uid2=l,this.uid3=r?r.uid:e)}},{key:"scrollUpHandler",value:function(e){var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],n=e.getAttribute("data-uid"),r=this.getRowByUid(n),s=this.rowObjectIndex=this.getRowObjectIndexByUid(n),a=this.getRowByUid(r.parentUid),l=this.rowIndex=this.getRowObjectIndexByUid(a.uid),o=this.parent.getRowElementByUID(a.uid).rowIndex,h=this.getChildRowsByParentIndex(l),c=h.indexOf(i[s]),u=Math.floor(c/this.pageSize),d=this.blockSize;2*this.blockSize>this.pageSize&&(d=2*this.blockSize-this.pageSize,d=this.blockSize-d);var p=h[c-(d-1)-this.pageSize].uid,g=h[c-(d-1)].uid;this.scrollData=this.getCacheRowsOnUpScroll(p,g,s-(d-1)),this.isFirstChildRow=u>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(g).lazyLoadCssClass="",this.getRowElementByUid(g).classList.remove("e-not-lazyload-first");var f=u+this.cacheBlockSize;if(h.length!==a.data.count&&f*this.pageSize>h.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(g).classList.add("e-not-lazyload-first");var v=f*this.pageSize>a.data.count?a.data.count:f*this.pageSize,b=f*this.pageSize>a.data.count?this.pageSize-(this.pageSize*f-a.data.count):this.pageSize,y=this.getChildRowsByParentIndex(i.indexOf(h[v-1]),!0,!1,null,!0),C=y.length?y[y.length-1].uid:h[v-1].uid,w=h[v-b].uid,k=h[v-b-1].uid,S=this.objIdxByUid[t][w]-d;if("e-lazyload-middle-down"===i[S].lazyLoadCssClass){var O=this.getRowElementByUid(i[S].uid);O&&O.classList.add("e-lazyload-middle-down")}if(this.getRowByUid(C).lazyLoadCssClass="",this.getRowByUid(k).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(k).classList.add("e-not-lazyload-end"),this.removeBottomRows(C,w,k),this.rowIndex=e.rowIndex-d,e.classList.length>1?e.classList.remove("e-lazyload-middle-up"):e.removeAttribute("class"),!Object(m.X)(this.getRowElementByUid(p)))return this.childCount=0,void(this.scrollData=[]);var x=this.getGroupKeysAndFields(this.getRowObjectIndexByUid(a.uid),i);this.captionRowExpand({rowIndex:o,makeRequest:!1,groupInfo:a,fields:x.fields,keys:x.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0})}},{key:"findRowElements",value:function(e){for(var t,i,n,r,s,a=!1,l=0;l<e.length;l++){var o=e[l].rowIndex;if(i=o,n=this.parent,r=void 0,s=void 0,r=n.getRowHeight(),s=n.getContent().firstElementChild.scrollTop/r,i<s+n.getContent().firstElementChild.offsetHeight/r&&i>s){a=!0,this.rowIndex=o,t=e[l];break}}return{entered:a,tr:t}}},{key:"getRowElementByUid",value:function(e){return this.parent.getContent().querySelector("tr[data-uid="+e+"]")}},{key:"removeTopRows",value:function(e,t,i){for(var n=[].slice.call(this.parent.getContent().querySelectorAll("tr")),r=!1,s=0;s<n.length;s++){if(n[s].getAttribute("data-uid")===i){var a=this.parent.getContent().querySelector("tr[data-uid="+e+"]");a&&(this.rowIndex=a.rowIndex);break}n[s].getAttribute("data-uid")===t&&(r=!0),r&&Object(m.hb)(n[s])}}},{key:"removeBottomRows",value:function(e,t,i){for(var n=[].slice.call(this.parent.getContent().querySelectorAll("tr")),r=!1,s=0;s<n.length&&(n[s].getAttribute("data-uid")===t&&(r=!0),!r||(Object(m.hb)(n[s]),n[s].getAttribute("data-uid")!==e));s++);}},{key:"setCache",value:function(e){var t=this.parent.pageSettings.currentPage;this.groupCache[t]=this.initialGroupCaptions[t]=Object(m.K)([],e.data)}},{key:"getGroupKeysAndFields",value:function(e,t){for(var i=[],n=[],r=e;r>=0&&(!t[r].isCaptionRow||-1!==i.indexOf(t[r].data.field)||!(t[r].indent<t[e].indent||r===e)||(i.push(t[r].data.field),n.push(t[r].data.key),0!==t[r].indent));r--);return{fields:i,keys:n}}},{key:"generateExpandPredicates",value:function(e,t){for(var i=[],n=0;n<e.length;n++){var r=this.parent.getColumnByField(e[n]),s="null"===t[n]?null:t[n],a={field:e[n],predicate:"or",uid:r.uid,operator:"equal",type:r.type,matchCase:this.allowCaseSensitive,ignoreAccent:this.ignoreAccent};""===s||Object(m.X)(s)?i=i.concat(nn.generateNullValuePredicates(a)):i.push(Object(m.K)({},{value:s},a))}return nn.getPredicate(i)}},{key:"getPredicates",value:function(e){for(var t=[],i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];t.push(e[r])}return t}},{key:"captionRowExpand",value:function(e){var t=this,i=this.parent.groupSettings.columns.indexOf(e.groupInfo.data.field)+1,n=this.generateExpandPredicates(e.fields,e.keys),r=this.getPredicates(n),s={level:i,skip:e.skip,take:e.take,where:r};if(e.makeRequest){var a=this.parent.renderModule.data.generateQuery(!0);a.isCountRequired||(a.isCountRequired=!0),a.lazyLoad.push({key:"onDemandGroupInfo",value:s}),this.parent.showSpinner(),this.parent.renderModule.data.getData({},a).then((function(n){t.parent.hideSpinner(),0!==n.result.length&&(t.cacheMode&&t.uid1&&t.uid2&&(t.removeTopRows(t.uid3,t.uid1,t.uid2),t.uid1=t.uid2=t.uid3=void 0),t.lazyLoadHandler({data:n.result,count:n.count,level:i,index:e.rowIndex,isRowExist:!1,isScroll:e.isScroll,up:!1,rowIndex:e.cachedRowIndex}))})).catch((function(e){return t.parent.renderModule.dataManagerFailure(e,{requestType:"grouping"})}))}else this.lazyLoadHandler({data:null,count:e.groupInfo.data.count,level:i,index:e.rowIndex,isRowExist:!0,isScroll:e.isScroll,up:e.scrollUp,rowIndex:e.cachedRowIndex})}},{key:"scrollReset",value:function(e){this.parent.getContent().firstElementChild.scrollTop=e?this.parent.getContent().firstElementChild.scrollTop+e:0}},{key:"updateCurrentViewData",value:function(){var e=[];this.getRows().filter((function(t){t.isDataRow&&(e[t.index]=t.data)})),this.parent.currentViewData=e.length?e:this.parent.currentViewData}},{key:"getGroupCache",value:function(){return this.groupCache}},{key:"getRows",value:function(){return this.groupCache[this.parent.pageSettings.currentPage]||[]}},{key:"getRowElements",value:function(){return[].slice.call(this.parent.getContent().querySelectorAll(".e-row"))}},{key:"getRowByIndex",value:function(e){for(var t,i=[].slice.call(this.parent.getContent().querySelectorAll(".e-row")),n=0;!Object(m.X)(e)&&n<i.length;n++)if(i[n].getAttribute("aria-rowindex")===e.toString()){t=i[n];break}return t}},{key:"setVisible",value:function(e){var t,i=this.parent;this.getRows().some((function(e){return e.isDataRow&&(t=e),e.isDataRow}));for(var n=this.getRows().filter((function(e){return!e.isDetailRow})),r=0;r<e.length;r++){var s=e[r],a=this.parent.getNormalizedColumnIndex(s.uid),l=this.parent.getColumnIndexByUid(s.uid),o=!0===s.visible?"":"none";-1!==a&&t&&a<t.cells.length&&Object(m.ob)(this.getColGroup().childNodes[a],{display:o}),this.setDisplayNone(i.getDataRows(),l,o,n,a),!this.parent.invokedFromMedia&&s.hideAtMedia&&this.parent.updateMediaColumns(s),this.parent.invokedFromMedia=!1}}},{key:"setDisplayNone",value:function(e,t,i,n,r){var s=Object.keys(e);if(this.parent.groupSettings.columns.length)for(var a=Object.keys(this.groupCache),l=0;l<a.length;l++)for(var o=this.rowsByUid[a[l]],h=Object.keys(o),c=0;c<h.length;c++){var u=this.parent.getContent().querySelector("tr[data-uid="+h[c]+"]"),d=o[h[c]];d.isCaptionRow&&(this.captionModelGen.isEmpty()?(d.cells[d.indent+1].colSpan=""===i?d.cells[d.indent+1].colSpan+1:d.cells[d.indent+1].colSpan-1,u&&(u.cells[d.indent+1].colSpan=d.cells[d.indent+1].colSpan)):this.changeCaptionRow(d,u,a[l])),d.isDataRow&&(this.showAndHideCells(u,t,i,!1),d.cells[r].visible=""===i),d.isCaptionRow||d.isDataRow||!Object(m.X)(d.indent)||(d.cells[r].visible=""===i,d.visible=d.cells.some((function(e){return e.isDataCell&&e.visible})),this.showAndHideCells(u,t,i,!0,d))}else for(var p=0;p<s.length;p++){var g=e[s[p]].querySelectorAll("td.e-rowcell")[t];e[s[p]].querySelectorAll("td.e-rowcell").length&&g&&(Object(m.ob)(e[s[p]].querySelectorAll("td.e-rowcell")[t],{display:i}),e[s[p]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(m.ib)([e[s[p]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),n[s[p]].cells[t].visible=""===i)}}},{key:"changeCaptionRow",value:function(e,t,i){var n=this.groupGenerator.generateCaptionRow(e.data,e.indent,e.parentGid,void 0,e.tIndex,e.parentUid);n.uid=e.uid,n.isExpand=e.isExpand,n.lazyLoadCssClass=e.lazyLoadCssClass,this.rowsByUid[i][e.uid]=n,this.groupCache[i][this.objIdxByUid[i][e.uid]]=n,t&&this.parent.getContentTable().querySelector("tbody").replaceChild(this.rowRenderer.render(n,this.parent.getColumns()),t)}},{key:"showAndHideCells",value:function(e,t,i,n,r){if(e){var s=n?"td.e-summarycell":"td.e-rowcell";Object(m.ob)(e.querySelectorAll(s)[t],{display:i}),e.querySelectorAll(s)[t].classList.contains("e-hide")&&Object(m.ib)([e.querySelectorAll(s)[t]],["e-hide"]),n&&(r.visible&&e.classList.contains("e-hide")?Object(m.ib)([e],["e-hide"]):r.visible||Object(m.v)([e],["e-hide"]))}}}]),i}(re),Br=u("ofXK"),Pr=["template"],qr=["headerTemplate"],Vr=["commandsTemplate"],Hr=["filterItemTemplate"],Nr=["editTemplate"],Wr=["filterTemplate"],Xr=["footerTemplate"],Gr=["groupFooterTemplate"],Kr=["groupCaptionTemplate"],Ur=["rowTemplate"],Yr=["detailTemplate"],_r=["toolbarTemplate"],Qr=["pagerTemplate"],Jr=["editSettingsTemplate"],Zr=["groupSettingsCaptionTemplate"],$r=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},es=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ts=["allowEditing","allowFiltering","allowGrouping","allowReordering","allowResizing","allowSearching","allowSorting","autoFit","clipMode","columns","commands","customAttributes","dataSource","defaultValue","disableHtmlEncode","displayAsCheckBox","edit","editTemplate","editType","enableGroupByFormat","field","filter","filterBarTemplate","filterTemplate","foreignKeyField","foreignKeyValue","format","formatter","freeze","headerTemplate","headerText","headerTextAlign","headerValueAccessor","hideAtMedia","index","isFrozen","isIdentity","isPrimaryKey","lockColumn","maxWidth","minWidth","showColumnMenu","showInColumnChooser","sortComparer","template","textAlign","type","uid","validationRules","valueAccessor","visible","width"],is=[],ns=((Or=function(e){n(i,e);var t=s(i);function i(e){var n;return p(this,i),(n=t.call(this)).viewContainerRef=e,Object(g.g)("currentInstance",l(n),n.viewContainerRef),n.registerEvents(is),n.directivePropList=ts,n}return i}(g.b)).\u0275fac=function(e){return new(e||Or)(d.Nb(d.O))},Or.\u0275dir=d.Ib({type:Or,selectors:[["e-column"]],contentQueries:function(e,t,i){var n;1&e&&(d.Gb(i,Pr,!0),d.Gb(i,qr,!0),d.Gb(i,Vr,!0),d.Gb(i,Hr,!0),d.Gb(i,Nr,!0),d.Gb(i,Wr,!0)),2&e&&(d.xc(n=d.fc())&&(t.template=n.first),d.xc(n=d.fc())&&(t.headerTemplate=n.first),d.xc(n=d.fc())&&(t.commandsTemplate=n.first),d.xc(n=d.fc())&&(t.filter_itemTemplate=n.first),d.xc(n=d.fc())&&(t.editTemplate=n.first),d.xc(n=d.fc())&&(t.filterTemplate=n.first))},inputs:{allowEditing:"allowEditing",allowFiltering:"allowFiltering",allowGrouping:"allowGrouping",allowReordering:"allowReordering",allowResizing:"allowResizing",allowSearching:"allowSearching",allowSorting:"allowSorting",autoFit:"autoFit",clipMode:"clipMode",columns:"columns",commands:"commands",customAttributes:"customAttributes",dataSource:"dataSource",defaultValue:"defaultValue",disableHtmlEncode:"disableHtmlEncode",displayAsCheckBox:"displayAsCheckBox",edit:"edit",editTemplate:"editTemplate",editType:"editType",enableGroupByFormat:"enableGroupByFormat",field:"field",filter:"filter",filterBarTemplate:"filterBarTemplate",filterTemplate:"filterTemplate",foreignKeyField:"foreignKeyField",foreignKeyValue:"foreignKeyValue",format:"format",formatter:"formatter",freeze:"freeze",headerTemplate:"headerTemplate",headerText:"headerText",headerTextAlign:"headerTextAlign",headerValueAccessor:"headerValueAccessor",hideAtMedia:"hideAtMedia",index:"index",isFrozen:"isFrozen",isIdentity:"isIdentity",isPrimaryKey:"isPrimaryKey",lockColumn:"lockColumn",maxWidth:"maxWidth",minWidth:"minWidth",showColumnMenu:"showColumnMenu",showInColumnChooser:"showInColumnChooser",sortComparer:"sortComparer",template:"template",textAlign:"textAlign",type:"type",uid:"uid",validationRules:"validationRules",valueAccessor:"valueAccessor",visible:"visible",width:"width"},features:[d.ub]}),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"template",void 0),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"headerTemplate",void 0),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"commandsTemplate",void 0),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"filter_itemTemplate",void 0),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"editTemplate",void 0),$r([Object(g.f)(),es("design:type",Object)],Or.prototype,"filterTemplate",void 0),Or),rs=((Sr=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.call(this,"columns")}return i}(g.a)).\u0275fac=function(e){return new(e||Sr)},Sr.\u0275dir=d.Ib({type:Sr,selectors:[["e-columns"]],contentQueries:function(e,t,i){var n;1&e&&d.Gb(i,ns,!1),2&e&&d.xc(n=d.fc())&&(t.children=n)},features:[d.ub]}),Sr),ss=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},as=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ls=["columnName","customAggregate","field","footerTemplate","format","groupCaptionTemplate","groupFooterTemplate","type"],os=[],hs=((Dr=function(e){n(i,e);var t=s(i);function i(e){var n;return p(this,i),(n=t.call(this)).viewContainerRef=e,Object(g.g)("currentInstance",l(n),n.viewContainerRef),n.registerEvents(os),n.directivePropList=ls,n}return i}(g.b)).\u0275fac=function(e){return new(e||Dr)(d.Nb(d.O))},Dr.\u0275dir=d.Ib({type:Dr,selectors:[["e-column"]],contentQueries:function(e,t,i){var n;1&e&&(d.Gb(i,Xr,!0),d.Gb(i,Gr,!0),d.Gb(i,Kr,!0)),2&e&&(d.xc(n=d.fc())&&(t.footerTemplate=n.first),d.xc(n=d.fc())&&(t.groupFooterTemplate=n.first),d.xc(n=d.fc())&&(t.groupCaptionTemplate=n.first))},inputs:{columnName:"columnName",customAggregate:"customAggregate",field:"field",footerTemplate:"footerTemplate",format:"format",groupCaptionTemplate:"groupCaptionTemplate",groupFooterTemplate:"groupFooterTemplate",type:"type"},features:[d.ub]}),ss([Object(g.f)(),as("design:type",Object)],Dr.prototype,"footerTemplate",void 0),ss([Object(g.f)(),as("design:type",Object)],Dr.prototype,"groupFooterTemplate",void 0),ss([Object(g.f)(),as("design:type",Object)],Dr.prototype,"groupCaptionTemplate",void 0),Dr),cs=((Rr=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.call(this,"columns")}return i}(g.a)).\u0275fac=function(e){return new(e||Rr)},Rr.\u0275dir=d.Ib({type:Rr,selectors:[["e-columns"]],contentQueries:function(e,t,i){var n;1&e&&d.Gb(i,hs,!1),2&e&&d.xc(n=d.fc())&&(t.children=n)},features:[d.ub]}),Rr),us=["columns"],ds=[],ps=((jr=function(e){n(i,e);var t=s(i);function i(e){var n;return p(this,i),(n=t.call(this)).viewContainerRef=e,n.tags=["columns"],Object(g.g)("currentInstance",l(n),n.viewContainerRef),n.registerEvents(ds),n.directivePropList=us,n}return i}(g.b)).\u0275fac=function(e){return new(e||jr)(d.Nb(d.O))},jr.\u0275dir=d.Ib({type:jr,selectors:[["e-aggregate"]],contentQueries:function(e,t,i){var n;1&e&&d.Gb(i,cs,!0),2&e&&d.xc(n=d.fc())&&(t.childColumns=n.first)},inputs:{columns:"columns"},features:[d.ub]}),jr),gs=((xr=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.call(this,"aggregates")}return i}(g.a)).\u0275fac=function(e){return new(e||xr)},xr.\u0275dir=d.Ib({type:xr,selectors:[["e-aggregates"]],contentQueries:function(e,t,i){var n;1&e&&d.Gb(i,ps,!1),2&e&&d.xc(n=d.fc())&&(t.children=n)},features:[d.ub]}),xr),fs=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ms=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vs=["actionBegin","actionComplete","actionFailure","batchAdd","batchCancel","batchDelete","beforeAutoFill","beforeBatchAdd","beforeBatchDelete","beforeBatchSave","beforeCopy","beforeDataBound","beforeExcelExport","beforeOpenColumnChooser","beforePaste","beforePdfExport","beforePrint","beginEdit","cellDeselected","cellDeselecting","cellEdit","cellSave","cellSaved","cellSelected","cellSelecting","checkBoxChange","columnDataStateChange","columnDeselected","columnDeselecting","columnDrag","columnDragStart","columnDrop","columnMenuClick","columnMenuOpen","columnSelected","columnSelecting","commandClick","contextMenuClick","contextMenuOpen","created","dataBound","dataSourceChanged","dataStateChange","destroyed","detailDataBound","excelAggregateQueryCellInfo","excelExportComplete","excelHeaderQueryCellInfo","excelQueryCellInfo","exportDetailDataBound","exportGroupCaption","headerCellInfo","keyPressed","lazyLoadGroupCollapse","lazyLoadGroupExpand","load","pdfAggregateQueryCellInfo","pdfExportComplete","pdfHeaderQueryCellInfo","pdfQueryCellInfo","printComplete","queryCellInfo","recordClick","recordDoubleClick","resizeStart","resizeStop","resizing","rowDataBound","rowDeselected","rowDeselecting","rowDrag","rowDragStart","rowDragStartHelper","rowDrop","rowSelected","rowSelecting","toolbarClick","dataSourceChange"],bs=["dataSource"],ys=((Ir=function(e){n(i,e);var t=s(i);function i(e,n,r,s){var a;p(this,i),(a=t.call(this)).ngEle=e,a.srenderer=n,a.viewContainerRef=r,a.injector=s,a.tags=["columns","aggregates"],a.element=a.ngEle.nativeElement,a.injectedModules=a.injectedModules||[];try{var o=a.injector.get("GridsFilter");-1===a.injectedModules.indexOf(o)&&a.injectedModules.push(o)}catch(z){}try{var h=a.injector.get("GridsPage");-1===a.injectedModules.indexOf(h)&&a.injectedModules.push(h)}catch(L){}try{var c=a.injector.get("GridsSelection");-1===a.injectedModules.indexOf(c)&&a.injectedModules.push(c)}catch(B){}try{var u=a.injector.get("GridsSort");-1===a.injectedModules.indexOf(u)&&a.injectedModules.push(u)}catch(P){}try{var d=a.injector.get("GridsGroup");-1===a.injectedModules.indexOf(d)&&a.injectedModules.push(d)}catch(q){}try{var f=a.injector.get("GridsReorder");-1===a.injectedModules.indexOf(f)&&a.injectedModules.push(f)}catch(V){}try{var m=a.injector.get("GridsRowDD");-1===a.injectedModules.indexOf(m)&&a.injectedModules.push(m)}catch(H){}try{var v=a.injector.get("GridsDetailRow");-1===a.injectedModules.indexOf(v)&&a.injectedModules.push(v)}catch(N){}try{var b=a.injector.get("GridsToolbar");-1===a.injectedModules.indexOf(b)&&a.injectedModules.push(b)}catch(W){}try{var y=a.injector.get("GridsAggregate");-1===a.injectedModules.indexOf(y)&&a.injectedModules.push(y)}catch(X){}try{var C=a.injector.get("GridsSearch");-1===a.injectedModules.indexOf(C)&&a.injectedModules.push(C)}catch(G){}try{var w=a.injector.get("GridsVirtualScroll");-1===a.injectedModules.indexOf(w)&&a.injectedModules.push(w)}catch(K){}try{var k=a.injector.get("GridsEdit");-1===a.injectedModules.indexOf(k)&&a.injectedModules.push(k)}catch(U){}try{var S=a.injector.get("GridsResize");-1===a.injectedModules.indexOf(S)&&a.injectedModules.push(S)}catch(Y){}try{var O=a.injector.get("GridsExcelExport");-1===a.injectedModules.indexOf(O)&&a.injectedModules.push(O)}catch(_){}try{var x=a.injector.get("GridsPdfExport");-1===a.injectedModules.indexOf(x)&&a.injectedModules.push(x)}catch(Q){}try{var j=a.injector.get("GridsCommandColumn");-1===a.injectedModules.indexOf(j)&&a.injectedModules.push(j)}catch(J){}try{var R=a.injector.get("GridsContextMenu");-1===a.injectedModules.indexOf(R)&&a.injectedModules.push(R)}catch(Z){}try{var D=a.injector.get("GridsFreeze");-1===a.injectedModules.indexOf(D)&&a.injectedModules.push(D)}catch($){}try{var E=a.injector.get("GridsColumnMenu");-1===a.injectedModules.indexOf(E)&&a.injectedModules.push(E)}catch(ee){}try{var I=a.injector.get("GridsColumnChooser");-1===a.injectedModules.indexOf(I)&&a.injectedModules.push(I)}catch(te){}try{var M=a.injector.get("GridsForeignKey");-1===a.injectedModules.indexOf(M)&&a.injectedModules.push(M)}catch(ie){}try{var F=a.injector.get("GridsBlazorAction");-1===a.injectedModules.indexOf(F)&&a.injectedModules.push(F)}catch(ne){}try{var T=a.injector.get("GridsInfiniteScroll");-1===a.injectedModules.indexOf(T)&&a.injectedModules.push(T)}catch(re){}try{var A=a.injector.get("GridsLazyLoadGroup");-1===a.injectedModules.indexOf(A)&&a.injectedModules.push(A)}catch(se){}return a.registerEvents(vs),a.addTwoWay.call(l(a),bs),Object(g.g)("currentInstance",l(a),a.viewContainerRef),a.context=new g.c,a}return f(i,[{key:"ngOnInit",value:function(){this.context.ngOnInit(this)}},{key:"ngAfterViewInit",value:function(){this.context.ngAfterViewInit(this)}},{key:"ngOnDestroy",value:function(){this.context.ngOnDestroy(this)}},{key:"ngAfterContentChecked",value:function(){this.tagObjects[0].instance=this.childColumns,this.childAggregates&&(this.tagObjects[1].instance=this.childAggregates),this.context.ngAfterContentChecked(this)}}]),i}(Ot)).\u0275fac=function(e){return new(e||Ir)(d.Nb(d.l),d.Nb(d.D),d.Nb(d.O),d.Nb(d.r))},Ir.\u0275cmp=d.Hb({type:Ir,selectors:[["ejs-grid"]],contentQueries:function(e,t,i){var n;1&e&&(d.Gb(i,Ur,!0),d.Gb(i,Yr,!0),d.Gb(i,_r,!0),d.Gb(i,Qr,!0),d.Gb(i,Jr,!0),d.Gb(i,Zr,!0),d.Gb(i,rs,!0),d.Gb(i,gs,!0)),2&e&&(d.xc(n=d.fc())&&(t.rowTemplate=n.first),d.xc(n=d.fc())&&(t.detailTemplate=n.first),d.xc(n=d.fc())&&(t.toolbarTemplate=n.first),d.xc(n=d.fc())&&(t.pagerTemplate=n.first),d.xc(n=d.fc())&&(t.editSettings_template=n.first),d.xc(n=d.fc())&&(t.groupSettings_captionTemplate=n.first),d.xc(n=d.fc())&&(t.childColumns=n.first),d.xc(n=d.fc())&&(t.childAggregates=n.first))},inputs:{aggregates:"aggregates",allowExcelExport:"allowExcelExport",allowFiltering:"allowFiltering",allowGrouping:"allowGrouping",allowKeyboard:"allowKeyboard",allowMultiSorting:"allowMultiSorting",allowPaging:"allowPaging",allowPdfExport:"allowPdfExport",allowReordering:"allowReordering",allowResizing:"allowResizing",allowRowDragAndDrop:"allowRowDragAndDrop",allowSelection:"allowSelection",allowSorting:"allowSorting",allowTextWrap:"allowTextWrap",childGrid:"childGrid",clipMode:"clipMode",columnChooserSettings:"columnChooserSettings",columnMenuItems:"columnMenuItems",columnQueryMode:"columnQueryMode",columns:"columns",contextMenuItems:"contextMenuItems",currencyCode:"currencyCode",currentAction:"currentAction",dataSource:"dataSource",detailTemplate:"detailTemplate",editSettings:"editSettings",ej2StatePersistenceVersion:"ej2StatePersistenceVersion",enableAltRow:"enableAltRow",enableAutoFill:"enableAutoFill",enableColumnVirtualization:"enableColumnVirtualization",enableHeaderFocus:"enableHeaderFocus",enableHover:"enableHover",enableImmutableMode:"enableImmutableMode",enableInfiniteScrolling:"enableInfiniteScrolling",enablePersistence:"enablePersistence",enableRtl:"enableRtl",enableVirtualization:"enableVirtualization",filterSettings:"filterSettings",frozenColumns:"frozenColumns",frozenRows:"frozenRows",gridLines:"gridLines",groupSettings:"groupSettings",height:"height",hierarchyPrintMode:"hierarchyPrintMode",infiniteScrollSettings:"infiniteScrollSettings",locale:"locale",pageSettings:"pageSettings",pagerTemplate:"pagerTemplate",parentDetails:"parentDetails",printMode:"printMode",query:"query",queryString:"queryString",resizeSettings:"resizeSettings",rowDropSettings:"rowDropSettings",rowHeight:"rowHeight",rowTemplate:"rowTemplate",searchSettings:"searchSettings",selectedRowIndex:"selectedRowIndex",selectionSettings:"selectionSettings",showColumnChooser:"showColumnChooser",showColumnMenu:"showColumnMenu",sortSettings:"sortSettings",textWrapSettings:"textWrapSettings",toolbar:"toolbar",toolbarTemplate:"toolbarTemplate",width:"width"},outputs:{actionBegin:"actionBegin",actionComplete:"actionComplete",actionFailure:"actionFailure",batchAdd:"batchAdd",batchCancel:"batchCancel",batchDelete:"batchDelete",beforeAutoFill:"beforeAutoFill",beforeBatchAdd:"beforeBatchAdd",beforeBatchDelete:"beforeBatchDelete",beforeBatchSave:"beforeBatchSave",beforeCopy:"beforeCopy",beforeDataBound:"beforeDataBound",beforeExcelExport:"beforeExcelExport",beforeOpenColumnChooser:"beforeOpenColumnChooser",beforePaste:"beforePaste",beforePdfExport:"beforePdfExport",beforePrint:"beforePrint",beginEdit:"beginEdit",cellDeselected:"cellDeselected",cellDeselecting:"cellDeselecting",cellEdit:"cellEdit",cellSave:"cellSave",cellSaved:"cellSaved",cellSelected:"cellSelected",cellSelecting:"cellSelecting",checkBoxChange:"checkBoxChange",columnDataStateChange:"columnDataStateChange",columnDeselected:"columnDeselected",columnDeselecting:"columnDeselecting",columnDrag:"columnDrag",columnDragStart:"columnDragStart",columnDrop:"columnDrop",columnMenuClick:"columnMenuClick",columnMenuOpen:"columnMenuOpen",columnSelected:"columnSelected",columnSelecting:"columnSelecting",commandClick:"commandClick",contextMenuClick:"contextMenuClick",contextMenuOpen:"contextMenuOpen",created:"created",dataBound:"dataBound",dataSourceChanged:"dataSourceChanged",dataStateChange:"dataStateChange",destroyed:"destroyed",detailDataBound:"detailDataBound",excelAggregateQueryCellInfo:"excelAggregateQueryCellInfo",excelExportComplete:"excelExportComplete",excelHeaderQueryCellInfo:"excelHeaderQueryCellInfo",excelQueryCellInfo:"excelQueryCellInfo",exportDetailDataBound:"exportDetailDataBound",exportGroupCaption:"exportGroupCaption",headerCellInfo:"headerCellInfo",keyPressed:"keyPressed",lazyLoadGroupCollapse:"lazyLoadGroupCollapse",lazyLoadGroupExpand:"lazyLoadGroupExpand",load:"load",pdfAggregateQueryCellInfo:"pdfAggregateQueryCellInfo",pdfExportComplete:"pdfExportComplete",pdfHeaderQueryCellInfo:"pdfHeaderQueryCellInfo",pdfQueryCellInfo:"pdfQueryCellInfo",printComplete:"printComplete",queryCellInfo:"queryCellInfo",recordClick:"recordClick",recordDoubleClick:"recordDoubleClick",resizeStart:"resizeStart",resizeStop:"resizeStop",resizing:"resizing",rowDataBound:"rowDataBound",rowDeselected:"rowDeselected",rowDeselecting:"rowDeselecting",rowDrag:"rowDrag",rowDragStart:"rowDragStart",rowDragStartHelper:"rowDragStartHelper",rowDrop:"rowDrop",rowSelected:"rowSelected",rowSelecting:"rowSelecting",toolbarClick:"toolbarClick",dataSourceChange:"dataSourceChange"},features:[d.ub],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"rowTemplate",void 0),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"detailTemplate",void 0),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"toolbarTemplate",void 0),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"pagerTemplate",void 0),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"editSettings_template",void 0),fs([Object(g.f)(),ms("design:type",Object)],Ir.prototype,"groupSettings_captionTemplate",void 0),Ir=fs([Object(g.d)([g.c]),ms("design:paramtypes",[d.l,d.D,d.O,d.r])],Ir)),Cs=((Er=function e(){p(this,e)}).\u0275mod=d.Lb({type:Er}),Er.\u0275inj=d.Kb({factory:function(e){return new(e||Er)},imports:[[Br.b]]}),Er),ws={provide:"GridsFilter",useValue:Sn},ks={provide:"GridsPage",useValue:dn},Ss={provide:"GridsSelection",useValue:it},Os={provide:"GridsSort",useValue:sn},xs={provide:"GridsGroup",useValue:xn},js={provide:"GridsReorder",useValue:function(){function e(t){p(this,e),this.parent=t,this.parent.isDestroyed||(this.parent.on("header-drop",this.headerDrop,this),this.parent.on(z,this.enableAfterRender,this),this.parent.on("reorder-complete",this.onActionComplete,this),this.parent.on("columnDrag",this.drag,this),this.parent.on("columnDragStart",this.dragStart,this),this.parent.on("column-drag-stop",this.dragStop,this),this.parent.on("header-drop",this.headerDrop,this),this.parent.on(q,this.createReorderElement,this),this.parent.on(V,this.keyPressHandler,this))}return f(e,[{key:"chkDropPosition",value:function(e,t){var i=this.parent.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),n=!i||!i.lockColumn;return(e.parentElement.isEqualNode(t.parentElement)||this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()&&Array.prototype.indexOf.call(Object(m.C)(e,"thead").children,e.parentElement)===Array.prototype.indexOf.call(Object(m.C)(t,"thead").children,t.parentElement))&&this.targetParentContainerIndex(e,t)>-1&&n}},{key:"chkDropAllCols",value:function(e,t){for(var i,n=this.getHeaderCells();!i&&n.length>0;)i=e!==n.pop()&&this.targetParentContainerIndex(e,t)>-1;return i}},{key:"findColParent",value:function(e,t,i){i=i;for(var n=0,r=t.length;n<r;n++){if(e===t[n])return!0;if(t[n].columns){var s=i.length;if(i.push(t[n]),this.findColParent(e,t[n].columns,i))return!0;i.splice(s,i.length-s)}}return!1}},{key:"getColumnsModel",value:function(e){var t=[],i=[];if(!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid())return this.parent.getColumns();for(var n=0,r=e.length;n<r;n++)t.push(e[n]),e[n].columns&&(i=i.concat(e[n].columns));return i.length&&(t=t.concat(this.getColumnsModel(i))),t}},{key:"headerDrop",value:function(e){var t=this.parent,i=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),n=t.getColumnByUid(i);if(Object(m.C)(e.target,"th")&&(Object(m.X)(n)||n.allowReordering&&!n.lockColumn)){var r=Object(m.C)(e.target,".e-headercell"),s=(r.querySelector(".e-headercelldiv")||r.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");if(!Object(m.X)(s)){var a=t.getColumnByUid(s);if(Object(m.X)(a)||!a.allowReordering||a.lockColumn)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:n,destColumn:a})}if(r&&this.chkDropPosition(this.element,r)&&this.chkDropAllCols(this.element,r))if(this.parent.enableColumnVirtualization){var l=this.parent.columns,o=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),h=this.parent.columns.filter((function(e){return e.uid===o})),c=null,u=h[0],d=r.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");l.some((function(e,t){return e.uid===d&&(c=t,e.uid===d)})),Object(m.X)(c)||this.moveColumns(c,u)}else{var p=this.targetParentContainerIndex(this.element,r),g=this.element.firstElementChild.getAttribute("e-mappinguid");if(this.destElement=r,this.parent.notify("set-reorder-destination-element",{ele:r}),g)this.moveColumns(p,this.parent.getColumnByUid(g));else{var f=this.getHeaderCells(),v=Xt(this.element,f),b=this.getColumnsModel(this.parent.columns);this.moveColumns(p,b[v])}}}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:n})}},{key:"isActionPrevent",value:function(e){return oi(e)}},{key:"moveColumns",value:function(e,t,i,n){var r=this.parent;if(this.isActionPrevent(r))r.notify(G,{instance:this,handler:this.moveColumns,arg1:e,arg2:t});else{var s=!r.getFrozenColumns()&&r.isFrozenGrid(),a=this.getColParent(t,this.parent.columns),l=a?a.columns:s?this.parent.getColumns():this.parent.columns,o=Gt(t,l);if((this.parent.isFrozenGrid()&&a||this.parent.lockcolPositionCount)&&!i){for(var h=0;h<l.length;h++)if(l[h].field===t.field){o=h;break}var c=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid"));if(c){for(var u=0;u<l.length;u++)if(l[u].field===c.field){e=u;break}}else for(var d=0;d<l.length;d++)l[d].headerText===this.destElement.innerText.trim()&&(e=d)}if(r.allowReordering&&o!==e&&-1!==o&&-1!==e){l.splice(e,0,l.splice(o,1)[0]);var p={column:t,destIndex:e,columns:l,parent:a,cancel:!1};r.notify("refresh-frozen-columns",p),p.cancel||(r.getColumns(!0),r.notify("column-position-changed",{fromIndex:e,toIndex:o}),!1!==n&&r.notify(P,{type:D,requestType:"reorder",fromIndex:e,toIndex:o,toColumnUid:t.uid}))}}}},{key:"targetParentContainerIndex",value:function(e,t){var i=!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid()?this.parent.getColumns():this.parent.columns,n=this.getHeaderCells(),r=this.getColumnsModel(i),s=this.getColParent(r[Xt(e,n)],i);return i=s?s.columns:i,Gt(r[Xt(t,n)],i)}},{key:"getHeaderCells",value:function(){var e=this.parent.getFrozenColumns();if(e||this.parent.lockcolPositionCount){var t,i,n=[],r=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-columnheader"));if(e)for(var s=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll(".e-columnheader")),a=0;a<r.length;a++){var l=void 0;t=[].slice.call(r[a].getElementsByClassName("e-headercell")),i=[].slice.call(s[a].getElementsByClassName("e-headercell"));for(var o=0;o<t.length;o++){for(var h=0;h<i.length;h++)if(i[h].innerText===t[o].innerText){l=!0;break}l||(n=n.concat([t[o]]))}for(var c=0;c<i.length;c++)n.push(i[c])}else for(var u=0;u<r.length;u++){i=[].slice.call(r[u].getElementsByClassName("e-headercell"));for(var d=0;d<i.length;d++){for(var p=void 0,g=d+1;g<i.length;g++)if(i[g].innerText===i[d].innerText){p=!0;break}p||(n=n.concat([i[d]]))}}return n}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))}},{key:"getColParent",value:function(e,t){var i=[];return this.findColParent(e,t,i),i[i.length-1]}},{key:"reorderSingleColumn",value:function(e,t){var i=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(t){return t.field===e}))[0]:this.parent.getColumnByField(e),n=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(e){return e.field===t}))[0]:this.parent.getColumnByField(t);if((Object(m.X)(i)||i.allowReordering&&!i.lockColumn)&&(Object(m.X)(n)||n.allowReordering&&!i.lockColumn)){var r=n,s=this.getColParent(r,this.parent.columns),a=Gt(r,s?s.columns:this.parent.columns);a>-1&&this.moveColumns(a,i,!0)}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:n})}},{key:"reorderMultipleColumns",value:function(e,t){var i=this.parent.getColumnIndexByField(t),n=this.parent.getColumnByField(t);if(!(i<0)&&(Object(m.X)(n)||n.allowReordering&&!n.lockColumn)){for(var r=0;r<e.length;r++){var s=this.parent.getColumnByField(e[r]);if(!Object(m.X)(s)&&(!s.allowReordering||s.lockColumn))return}for(var a=0;a<e.length;a++){var l=this.parent.getColumnByIndex(i),o=this.getColParent(l,this.parent.columns),h=Gt(l,o?o.columns:this.parent.columns);h>-1&&this.moveColumns(h,this.parent.getColumnByField(e[a]),!0,!(Object(m.W)()&&!this.parent.isJsComponent)),this.parent.getColumnIndexByField(e[a+1])>=h&&i++}if(Object(m.W)()&&!this.parent.isJsComponent){var c=this.parent.getColumns();this.parent.notify(P,{fromColumnUid:e.map((function(e){return c.filter((function(t){return t.field===e}))[0].uid})),toColumnUid:n.uid,isMultipleReorder:!0,requestType:"reorder",type:"actionBegin"})}}}},{key:"moveTargetColumn",value:function(e,t){t>-1&&this.moveColumns(t,e,!0)}},{key:"reorderSingleColumnByTarget",value:function(e,t){var i=this.parent.getColumnByField(e);this.moveTargetColumn(i,t)}},{key:"reorderMultipleColumnByTarget",value:function(e,t){for(var i=0;i<e.length;i++)this.reorderSingleColumnByTarget(e[i],t)}},{key:"reorderColumns",value:function(e,t){"string"==typeof e?(this.reorderSingleColumn(e,t),this.fromCol=e):(this.reorderMultipleColumns(e,t),this.fromCol=e[0])}},{key:"reorderColumnByIndex",value:function(e,t){var i=this.parent.getColumnByIndex(e);this.moveTargetColumn(i,t)}},{key:"reorderColumnByTargetIndex",value:function(e,t){"string"==typeof e?this.reorderSingleColumnByTarget(e,t):this.reorderMultipleColumnByTarget(e,t)}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&this.createReorderElement()}},{key:"createReorderElement",value:function(e){e&&e.args.isXaxis&&this.setDisplay("none");var t=this.parent.element.querySelector(".e-headercontent");this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}})),this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))}},{key:"onActionComplete",value:function(e){Object(m.W)()&&!this.parent.isJsComponent&&(e.rows=null),this.parent.trigger(E,Object(m.K)(e,{type:E}));var t=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);t&&this.parent.focusModule.onClick({target:t},!0)}},{key:"destroy",value:function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(Object(m.hb)(this.upArrow),Object(m.hb)(this.downArrow),this.parent.off("header-drop",this.headerDrop),this.parent.off(z,this.enableAfterRender),this.parent.off("reorder-complete",this.onActionComplete),this.parent.off("columnDrag",this.drag),this.parent.off("columnDragStart",this.dragStart),this.parent.off("column-drag-stop",this.dragStop),this.parent.off(q,this.createReorderElement),this.parent.off(V,this.keyPressHandler))}},{key:"keyPressHandler",value:function(e){var t=this.parent;switch(e.action){case"ctrlLeftArrow":case"ctrlRightArrow":var i=t.focusModule.currentInfo.element;if(i&&i.classList.contains("e-headercell")){var n=t.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid")),r=t.getVisibleColumns(),s=r.indexOf(n),a="ctrlLeftArrow"===e.action?r[s-1]:r[s+1];a&&a.field&&n.field&&this.reorderColumns(n.field,a.field)}}}},{key:"drag",value:function(e){var t=this.parent,i=e.target;if(e.column.allowReordering&&!e.column.lockColumn){var n=Object(m.C)(i,".e-headercell:not(.e-stackedHeaderCell)"),r=t.element.querySelector(".e-cloneproperties"),s=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild,a=this.x>Yt(e.event).x+s.scrollLeft;Object(m.ib)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"]),this.setDisplay("none"),this.stopTimer(),Object(m.A)(r,["e-defaultcur"],["e-notallowedcur"]),this.updateScrollPostion(e.event),n&&!n.isEqualNode(this.element)&&(i=n,this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i)?(this.updateArrowPosition(i,a),Object(m.A)(i,["e-allowDrop","e-reorderindicate"],[])):t.allowGrouping&&Wt(e.target,"e-groupdroparea")||Object(m.A)(r,["e-notallowedcur"],["e-defaultcur"])),t.trigger("columnDrag",{target:i,draggableType:"headercell",column:e.column})}}},{key:"updateScrollPostion",value:function(e){var t=this,i=Yt(e).x,n=this.parent.element.getBoundingClientRect(),r=n.right;if(this.parent.isFrozenGrid())this.updateFrozenScrollPosition(i,n);else{var s=n.left,a=this.parent.getContent().firstElementChild;i>s&&i<s+35?this.timer=window.setInterval((function(){t.setScrollLeft(a,!0)}),50):i<r&&i>r-35&&(this.timer=window.setInterval((function(){t.setScrollLeft(a,!1)}),50))}}},{key:"updateFrozenScrollPosition",value:function(e,t){var i=this,n=this.parent.getContent().querySelector(".e-movablecontent"),r=this.parent.element.querySelector(".e-movableheader").getBoundingClientRect(),s=this.parent.getFrozenLeftCount(),a=this.parent.getFrozenRightColumnsCount()?r.right:t.right,l=s?r.left:t.left;e>l&&e<l+35?this.timer=window.setInterval((function(){i.setScrollLeft(n,!0)}),50):e<a&&e>a-35&&(this.timer=window.setInterval((function(){i.setScrollLeft(n,!1)}),50))}},{key:"setScrollLeft",value:function(e,t){var i=e.scrollLeft;e.scrollLeft=e.scrollLeft+(t?-5:5),i!==e.scrollLeft&&this.setDisplay("none")}},{key:"stopTimer",value:function(){window.clearInterval(this.timer)}},{key:"updateArrowPosition",value:function(e,t){var i=e.getBoundingClientRect(),n=this.parent.element.getBoundingClientRect();if(!(t&&i.left<n.left||!t&&i.right>n.right)){if(this.parent.isFrozenGrid()&&e.classList.contains("e-headercell")){var r=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount(),a=this.element.querySelector(".e-headercelldiv"),l=a?this.parent.getColumnByUid(a.getAttribute("data-uid")):null,o=this.parent.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid")),h=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),c=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(o){if(r&&!s&&this.parent.getNormalizedColumnIndex(o.uid)>=r&&(t&&Math.round(i.left)<h||!t&&c<i.right))return;if(!r&&s&&l&&l.getFreezeTableName()!==o.getFreezeTableName()&&!t&&Math.round(i.right)<h)return}}this.upArrow.style.top=i.top+i.height-n.top+"px",this.downArrow.style.top=i.top-n.top-4+"px",this.upArrow.style.left=this.downArrow.style.left=(t?i.left:i.right)-n.left-4+"px",this.setDisplay("")}}},{key:"dragStart",value:function(e){var t=this.parent,i=e.target;if(this.element=i.classList.contains("e-headercell")?i:Wt(i,"e-headercell"),e.column.allowReordering&&!e.column.lockColumn){var n=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild;this.x=Yt(e.event).x+n.scrollLeft,t.trigger("columnDragStart",{target:i,draggableType:"headercell",column:e.column})}}},{key:"dragStop",value:function(e){var t=this.parent;this.setDisplay("none"),this.stopTimer(),e.cancel||t.trigger("columnDrop",{target:e.target,draggableType:"headercell",column:e.column}),Object(m.ib)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"])}},{key:"setDisplay",value:function(e){this.upArrow.style.display=e,this.downArrow.style.display=e}},{key:"getModuleName",value:function(){return"reorder"}}]),e}()},Rs={provide:"GridsRowDD",useValue:function(){function e(t){var i=this;p(this,e),this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.isReplaceDragEle=!0,this.helper=function(e){var t=i.parent,n=i.draggable.currentStateTarget,r=i.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+t.element.offsetWidth}),s=i.parent.createElement("table",{styles:"width:"+t.element.offsetWidth}),a=i.parent.createElement("tbody");if(document.getElementsByClassName("e-griddragarea").length||t.rowDropSettings.targetID&&!n.classList.contains("e-selectionbackground")&&"Single"!==t.selectionSettings.type||!t.rowDropSettings.targetID&&!Wt(e.sender.target,"e-rowdragdrop"))return!1;t.rowDropSettings.targetID&&"Row"===t.selectionSettings.mode&&"Single"===t.selectionSettings.type&&t.selectRow(parseInt(i.draggable.currentStateTarget.parentElement.getAttribute("aria-rowindex"),10)),i.startedRow=Object(m.C)(n,"tr").cloneNode(!0);var l=i.parent.isFrozenGrid();if(l){var o=parseInt(Object(m.C)(n,"tr").getAttribute("aria-rowindex"),10),h=Ki(i.parent);i.startedRow.innerHTML="",Xi(i.parent,(function(e,t){i.startedRow.innerHTML+=t[o].innerHTML}),h)}i.processArgs(n);var c={selectedRow:i.rows,dragelement:n,cloneElement:r,cancel:!1,data:i.rowData},u=t.getSelectedRows();if(t.trigger("rowDragStartHelper",c),c.cancel)return!1;Ut(i.startedRow,".e-indentcell"),Ut(i.startedRow,".e-detailrowcollapse"),Ut(i.startedRow,".e-detailrowexpand"),i.removeCell(i.startedRow,"e-gridchkbox");var d=new RegExp("e-active","g");if(i.startedRow.innerHTML=i.startedRow.innerHTML.replace(d,""),a.appendChild(i.startedRow),t.getSelectedRowIndexes().length>1&&i.startedRow.hasAttribute("aria-selected")){var p="Left-Right"===t.getFrozenMode()?3:2,g=i.parent.createElement("span",{className:"e-dropitemscount",innerHTML:l?""+u.length/p:""+u.length});r.appendChild(g)}var f=Object(m.C)(n,"tr").querySelector(".e-icon-rowdragicon");return f&&f.classList.add("e-dragstartrow"),s.appendChild(a),r.appendChild(s),t.element.appendChild(r),r},this.dragStart=function(e){var t=i.parent;if(!document.getElementsByClassName("e-griddragarea").length){var n=e.target,r=i.parent.element.querySelector(".e-dropitemscount");i.parent.getSelectedRecords().length>1&&r&&(r.style.left=i.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),i.processArgs(n),t.trigger("rowDragStart",{rows:Object(m.W)()?null:i.rows,target:Object(m.W)()?null:e.target,draggableType:"rows",fromIndex:parseInt(i.rows[0].getAttribute("aria-rowindex"),10),data:Object.keys(i.rowData[0]).length>0?i.rowData:i.currentViewData()}),Object(m.W)()&&e.bindEvents(e.dragElement),i.dragStartData=i.rowData;var s=document.getElementById(t.rowDropSettings.targetID);t.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.add("e-allowRowDrop")}},this.drag=function(e){var t=i.parent,n=i.parent.element.querySelector(".e-cloneproperties"),r=i.getElementFromPosition(n,e.event);Object(m.A)(n,["e-defaultcur"],["e-notallowedcur","e-movecur"]),i.isOverflowBorder=!0,i.hoverState=t.enableHover;var s=Wt(r,"e-grid")?Object(m.C)(e.target,"tr"):null;if(t.enableHover=!1,e.target){i.processArgs(r);var a={rows:i.rows,target:r,draggableType:"rows",data:i.rowData,originalEvent:e,cancel:!1};if(t.trigger("rowDrag",a),i.stopTimer(),!a.cancel){if(t.element.classList.add("e-rowdrag"),i.dragTarget=s&&Wt(r,"e-grid").id===n.parentElement.id?parseInt(s.getAttribute("aria-rowindex"),10):parseInt(i.startedRow.getAttribute("aria-rowindex"),10),t.rowDropSettings.targetID)Wt(r,"e-grid")&&Wt(n.parentElement,"e-grid").id!==Wt(r,"e-grid").id?Object(m.A)(n,["e-defaultcur"],["e-notallowedcur"]):Object(m.A)(n,["e-notallowedcur"],["e-defaultcur"]);else{var l=Wt(r,"e-grid");l&&l.id===n.parentElement.id?Object(m.A)(n,["e-movecur"],["e-defaultcur"]):Object(m.A)(n,["e-notallowedcur"],["e-movecur"])}if(!t.rowDropSettings.targetID&&(!t.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground")))if(Wt(r,"e-grid")&&i.updateScrollPostion(e.event,r),(i.isOverflowBorder||i.parent.frozenRows>i.dragTarget)&&parseInt(i.startedRow.getAttribute("aria-rowindex"),10)!==i.dragTarget)i.moveDragRows(e,i.startedRow,s);else{if(s&&i.parent.getRowByIndex(i.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")===s.getAttribute("data-uid")){var o=i.parent.createElement("div",{className:"e-lastrow-dragborder"}),h=i.parent.getContent();o.style.width=i.parent.element.offsetWidth-i.getScrollWidth()+"px",h.querySelectorAll(".e-lastrow-dragborder").length||(h.classList.add("e-grid-relative"),h.appendChild(o),o.style.bottom=i.getScrollWidth()+"px")}i.removeBorder(s)}}}},this.dragStop=function(e){oi(i.parent)?i.parent.notify(G,{instance:i,handler:i.processDragStop,arg1:e}):i.processDragStop(e)},this.processDragStop=function(e){var t=i.parent;if(!i.parent.isDestroyed){var n=i.getElementFromPosition(e.helper,e.event),r=n&&!n.classList.contains("e-dlg-overlay")?n:e.target;i.parent.element.querySelector(".e-cloneproperties"),t.element.classList.remove("e-rowdrag");var s=document.getElementById(t.rowDropSettings.targetID);if(t.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),t.isRowDragable()){i.stopTimer(),t.enableHover=i.hoverState,i.parent.getContent().classList.remove("e-grid-relative"),i.removeBorder(n);var a=t.element.querySelector(".e-dragstartrow");a&&a.classList.remove("e-dragstartrow")}i.processArgs(r);var l={target:Object(m.W)()?null:r,draggableType:"rows",cancel:!1,fromIndex:parseInt(i.rows[0].getAttribute("aria-rowindex"),10),dropIndex:i.dragTarget,rows:Object(m.W)()?null:i.rows,data:Object.keys(i.dragStartData[0]).length>0?i.dragStartData:i.currentViewData()};t.trigger("rowDrop",l,(function(){if(!Wt(r,"e-row")&&!Wt(r,"e-emptyrow")||l.cancel)return i.dragTarget=null,void Object(m.hb)(e.helper);i.isRefresh=!1;var n=i.parent.getSelectedRowIndexes();if(t.isRowDragable()){if(Object(m.W)()){var s=i.parent.getSelectedRecords().length?i.parent.getSelectedRecords():i.currentViewData(),a={addedRecords:[],deletedRecords:s,changedRecords:[]},o=i.dragTarget?i.dragTarget:l.dropIndex,h=new v.g;h.dragDropDestinationIndex=o,i.saveChange(a,h),a.deletedRecords=[],a.addedRecords=s,i.saveChange(a,h)}else!i.parent.rowDropSettings.targetID&&i.startedRow.querySelector("td.e-selectionbackground")&&n.length>1&&n.length!==i.parent.getCurrentViewRecords().length?i.reorderRows(n,l.dropIndex):i.reorderRows([parseInt(i.startedRow.getAttribute("aria-rowindex"),10)],i.dragTarget);i.dragTarget=null,t.rowDropSettings.targetID||(Object(m.hb)(e.helper),i.rowOrder(l))}i.isRefresh=!0}))}},this.removeCell=function(e,t){return[].slice.call(e.querySelectorAll("td")).filter((function(i){i.classList.contains(t)&&e.deleteCell(i.cellIndex)}))},this.parent=t,this.parent.isDestroyed||(this.parent.on(F,this.initializeDrag,this),this.parent.on("columnDrop",this.columnDrop,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(I,this.onDataBoundFn),this.parent.on(z,this.enableAfterRender,this))}return f(e,[{key:"refreshRow",value:function(e,t,i,n){var r,s,a,l,o,h,c,u=this,d=this.parent,p=d.isFrozenGrid(),g="Left-Right"===d.getFrozenMode(),f=d.getContentTable().querySelector("tbody"),m=d.getHeaderTable().querySelector("tbody");p&&(l=d.getMovableHeaderTbody(),o=d.getMovableContentTbody(),g&&(h=d.getFrozenRightHeaderTbody(),c=d.getFrozenRightContentTbody()));var v=parseInt(e.target.parentElement.getAttribute("aria-rowindex"),10);(e.fromIndex<e.dropIndex||e.fromIndex===e.dropIndex)&&(v+=1),r=t.querySelectorAll(".e-row")[v],p&&(s=i.querySelectorAll(".e-row")[v],g&&(a=n.querySelectorAll(".e-row")[v]));for(var b="Left-Right"===d.getFrozenMode()?3:2,y=0,C=e.rows.length;y<C;y++)p?1===e.rows.length?(e.rows[y]=t.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)],e.rows[y+1]=i.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)],g&&(e.rows[y+2]=n.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)])):y%b==0?e.rows[y]=t.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)]:y%b==1?e.rows[y]=i.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)]:g&&y%b==2&&(e.rows[y]=n.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)]):e.rows[y]=t.children[parseInt(e.rows[y].getAttribute("aria-rowindex"),10)];for(var w=0,k=e.rows.length;w<k;w++)p?w%b==0?t.insertBefore(e.rows[w],r):w%b==1?i.insertBefore(e.rows[w],s):n.insertBefore(e.rows[w],a):t.insertBefore(e.rows[w],r);var S,O,x=[].slice.call(t.querySelectorAll(".e-row"));if(p&&(S=[].slice.call(i.querySelectorAll(".e-row")),g&&(O=[].slice.call(n.querySelectorAll(".e-row")))),this.refreshData(x,S,O),this.parent.frozenRows)for(var j=function(e,t){e<u.parent.frozenRows?$i(m,l,h,x,S,O,(function(t,i){t.appendChild(i[e])})):$i(f,o,c,x,S,O,(function(t,i){t.appendChild(i[e])}))},R=0,D=x.length;R<D;R++)j(R)}},{key:"updateFrozenRowreOrder",value:function(e){var t,i,n,r,s=this.parent,a=this.parent.isFrozenGrid(),l="Left-Right"===s.getFrozenMode(),o=s.getContentTable().querySelector("tbody"),h=s.getHeaderTable().querySelector("tbody");a&&(t=s.getMovableHeaderTbody(),i=s.getMovableContentTbody(),l&&(n=s.getFrozenRightHeaderTbody(),r=s.getFrozenRightContentTbody()));var c,u,d=[].slice.call(h.querySelectorAll(".e-row")).concat([].slice.call(o.querySelectorAll(".e-row")));a&&(c=[].slice.call(t.querySelectorAll(".e-row")).concat([].slice.call(i.querySelectorAll(".e-row"))),l&&(u=[].slice.call(n.querySelectorAll(".e-row")).concat([].slice.call(r.querySelectorAll(".e-row")))));var p=s.createElement("tbody"),g=s.createElement("tbody"),f=s.createElement("tbody");this.parent.clearSelection();for(var m=0,v=d.length;m<v;m++)p.appendChild(d[m]),a&&(g.appendChild(c[m]),l&&f.appendChild(u[m]));this.refreshRow(e,p,g,f)}},{key:"updateFrozenColumnreOrder",value:function(e){var t,i,n=this.parent,r=this.parent.isFrozenGrid(),s=n.getContentTable().querySelector("tbody");r&&(t=n.getMovableContentTbody(),"Left-Right"===n.getFrozenMode()&&(i=n.getFrozenRightContentTbody())),this.parent.clearSelection(),this.refreshRow(e,s,t,i)}},{key:"refreshData",value:function(e,t,i){for(var n={},r={},s={},a={},l=0,o=e.length;l<o;l++){var h=parseInt(e[l].getAttribute("aria-rowindex"),10);n[l]=this.parent.getRowsObject()[h],a[l]=this.parent.getCurrentViewRecords()[h],this.parent.isFrozenGrid()&&(r[l]=this.parent.getMovableRowsObject()[h],i&&(s[l]=this.parent.getFrozenRightRowsObject()[h]))}for(var c=0,u=e.length;c<u;c++)e[c].setAttribute("aria-rowindex",c.toString()),e[c].setAttribute("data-uid","grid-row"+c.toString()),this.parent.getRows()[c]=e[c],this.parent.getRowsObject()[c]=n[c],this.parent.getRowsObject()[c].uid="grid-row"+c.toString(),this.parent.getRowsObject()[c].index=c,this.parent.getCurrentViewRecords()[c]=a[c],this.parent.isFrozenGrid()&&(t[c].setAttribute("aria-rowindex",c.toString()),t[c].setAttribute("data-uid","grid-row"+(c+e.length).toString()),this.parent.getMovableRows()[c]=t[c],this.parent.getMovableRowsObject()[c]=r[c],this.parent.getMovableRowsObject()[c].uid="grid-row"+(c+e.length).toString(),this.parent.getMovableRowsObject()[c].index=c,i&&(i[c].setAttribute("aria-rowindex",c.toString()),i[c].setAttribute("data-uid","grid-row"+(c+e.length).toString()),this.parent.getFrozenRightRows()[c]=i[c],this.parent.getFrozenRightRowsObject()[c]=s[c],this.parent.getFrozenRightRowsObject()[c].uid="grid-row"+(c+e.length).toString(),this.parent.getFrozenRightRowsObject()[c].index=c))}},{key:"rowOrder",value:function(e){e.target.classList.contains("e-rowcelldrag")&&(e.target=e.target.parentElement),this.parent.frozenRows?this.updateFrozenRowreOrder(e):this.updateFrozenColumnreOrder(e),this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])}},{key:"currentViewData",value:function(){for(var e=this.parent.getSelectedRowIndexes(),t=[],i=parseInt(this.startedRow.getAttribute("aria-rowindex"),10),n=0,r=e.length;n<r;n++)t[n]=this.parent.currentViewData[e[n]];return this.parent.rowDropSettings.targetID||0!==e.length||(t[0]=this.parent.currentViewData[i]),t}},{key:"saveChange",value:function(e,t){var i=this;this.parent.getDataModule().saveChanges(e,this.parent.getPrimaryKeyFieldNames()[0],{},t).then((function(){i.parent.notify(P,{type:D,requestType:"rowdraganddrop"})})).catch((function(e){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message),i.parent.trigger("actionFailure",e)}))}},{key:"reorderRows",value:function(e,t){for(var i=this.parent.getSelectedRowIndexes(),n=[],r=[],s=this.parent.renderModule.data.dataManager.dataSource.json,a=t,l=e[0],o=0,h=e.length;o<h;o++)r[o]=s[e[o]];for(var c=0,u=i.length;c<u;c++)n[c]=s[i[c]];for(var d=0,p=r.length;d<p;d++){if(0!==d){for(var g=0,f=s.length;g<f;g++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[g])===JSON.stringify(r[d])){l=g;break}for(var m=0,v=s.length;m<v;m++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[m])===JSON.stringify(r[d-1])){l>m&&(a=m+1);break}}this.reorderRow(l,a)}this.isRefresh&&this.parent.notify(P,{type:D,requestType:"rowdraganddrop"});for(var b=0,y=n.length;b<y;b++)for(var C=0,w=s.length;C<w;C++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[C])===JSON.stringify(n[b])){i[b]=C;break}this.selectedRowColls=i}},{key:"stopTimer",value:function(){window.clearInterval(this.timer)}},{key:"initializeDrag",value:function(){this.draggable=new m.i(this.parent.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle})}},{key:"updateScrollPostion",value:function(e,t){var i=this,n=Yt(e).y,r=this.parent.getContent().getBoundingClientRect(),s=this.parent.getRowHeight()-15,a=this.parent.getContent().firstElementChild;if(r.top+s>=n){var l=-this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval((function(){i.setScrollDown(a,l,!0)}),200)}else if(r.top+this.parent.getContent().clientHeight-s-33<=n){var o=this.parent.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval((function(){i.setScrollDown(a,o,!0)}),200)}}},{key:"setScrollDown",value:function(e,t,i){e.scrollTop=e.scrollTop+t}},{key:"moveDragRows",value:function(e,t,i){var n=this.parent.element.querySelector(".e-cloneproperties"),r=Object(m.C)(e.target,"tr");Wt(r,"e-grid")&&Wt(n.parentElement,"e-grid").id===Wt(r,"e-grid").id&&this.setBorder(r||this.startedRow,e.event,t,i)}},{key:"setBorder",value:function(e,t,i,n){var r=this.parent.element,s=this.parent.element.querySelector(".e-cloneproperties");if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),Wt(e,"e-grid")&&Wt(s.parentElement,"e-grid").id===Wt(e,"e-grid").id){Object(m.ib)(r.querySelectorAll(".e-rowcell,.e-rowdragdrop"),["e-dragborder"]);var a=[],l=parseInt(n.getAttribute("aria-rowindex"),10);if(n&&0===l){var o=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),h=this.parent.getHeaderContent();h.classList.add("e-grid-relative"),o.style.width=r.offsetWidth-this.getScrollWidth()+"px",h.querySelectorAll(".e-firstrow-dragborder").length||h.appendChild(o)}else n&&parseInt(i.getAttribute("aria-rowindex"),10)>l?(e=this.parent.getRowByIndex(l-1),a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));var c=this.parent.isFrozenGrid();if(n&&0!==l&&c){var u=parseInt(e.getAttribute("aria-rowindex"),10);a=[],Xi(this.parent,(function(e,t){a=a.concat([].slice.call(t[u].querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")))}),Ki(this.parent))}a.length>0&&ui(a,!0,"e-dragborder")}}},{key:"getScrollWidth",value:function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?st.getScrollBarWidth():0}},{key:"removeFirstRowBorder",value:function(e){this.parent.element.getElementsByClassName("e-firstrow-dragborder").length>0&&e&&0!==e.rowIndex&&Object(m.hb)(this.parent.element.getElementsByClassName("e-firstrow-dragborder")[0])}},{key:"removeLastRowBorder",value:function(e){var t=e&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid");this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&e&&t&&Object(m.hb)(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])}},{key:"removeBorder",value:function(e){if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),e=this.parent.getRows().filter((function(e){return e.querySelector("td.e-dragborder")}))[0]){var t=[].slice.call(e.querySelectorAll(".e-dragborder"));if(this.parent.isFrozenGrid()){var i=parseInt(e.getAttribute("aria-rowindex"),10);t=[],Xi(this.parent,(function(e,n){t=t.concat([].slice.call(n[i].querySelectorAll(".e-dragborder")))}),Ki(this.parent))}ui(t,!1,"e-dragborder")}}},{key:"getElementFromPosition",value:function(e,t){var i,n=Yt(t);return e.style.display="none",i=document.elementFromPoint(n.x,n.y),e.style.display="",i}},{key:"onDataBound",value:function(e){this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])}},{key:"getTargetIdx",value:function(e){return e?parseInt(e.getAttribute("aria-rowindex"),10):0}},{key:"singleRowDrop",value:function(e){var t,i,n=Object(m.C)(e.target,"tr");i=e.droppedElement.parentElement.ej2_instances[0],t=n?n.rowIndex:i.currentViewData.length-1,this.reorderRow(this.startedRowIndex,t)}},{key:"columnDrop",value:function(e){var t=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")&&(Wt(e.target,"e-row")||Wt(e.target,"e-emptyrow"))){var i,n=Object(m.C)(e.target,"tr");if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id===t.element.id||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==t.element.id)return;if(e.droppedElement.parentElement.id!==t.element.id)i=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(i.element.id!==t.element.id&&i.rowDropSettings.targetID!==t.element.id)return;var r=i.getSelectedRecords(),s=this.getTargetIdx(n);if(isNaN(s)&&(s=0),t.allowPaging&&(s=s+t.pageSettings.currentPage*t.pageSettings.pageSize-t.pageSettings.pageSize),Object(m.W)()){for(var a=[],l=i.getSelectedRowIndexes(),o=0;o<l.length;o++)a[o]=i.currentViewData[l[o]];var h={addedRecords:r=a,deletedRecords:[],changedRecords:[]},c=new v.g;c.dragDropDestinationIndex=s,t.getDataModule().saveChanges(h,t.getPrimaryKeyFieldNames()[0],{},c).then((function(){t.notify(P,{type:D,requestType:"rowdraganddrop"})})).catch((function(e){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message),t.trigger("actionFailure",e)})),h.deletedRecords=r,h.addedRecords=[],i.getDataModule().saveChanges(h,i.getPrimaryKeyFieldNames()[0],{},c).then((function(){i.notify(P,{type:D,requestType:"rowdraganddrop"})})).catch((function(e){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message),i.trigger("actionFailure",e)}))}else{t.notify("rows-added",{toIndex:s,records:r}),t.notify(P,{type:D,requestType:"rowdraganddrop"});var u=i.getSelectedRowIndexes(),d=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;this.selectedRows=[];for(var p=0,g=r.length;p<g;p++)this.selectedRows.push(d+u[p]);i.notify("rows-removed",{indexes:this.selectedRows,records:r}),i.notify(P,{type:D,requestType:"rowdraganddrop"})}}}},{key:"reorderRow",value:function(e,t){var i=this.parent;if(!i.sortSettings.columns.length&&!i.groupSettings.columns.length&&!i.filterSettings.columns.length){var n=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;t+=n,this.selectedRows=i.getSelectedRowIndexes(),i.notify("row-position-changed",{fromIndex:e+n,toIndex:t})}}},{key:"enableAfterRender",value:function(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()}},{key:"destroy",value:function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.draggable.destroy(),this.parent.off(F,this.initializeDrag),this.parent.off("columnDrop",this.columnDrop),this.parent.removeEventListener(I,this.onDataBoundFn),this.parent.off(z,this.enableAfterRender))}},{key:"getModuleName",value:function(){return"rowDragAndDrop"}},{key:"processArgs",value:function(e){var t=this.parent;t.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===t.getSelectedRecords().length?(this.rows=[this.startedRow],this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector(".e-rowcell")).rowData]):(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())}}]),e}()},Ds={provide:"GridsDetailRow",useValue:function(){function e(t,i){p(this,e),this.aria=new le,this.parent=t,this.parent.isDestroyed||(this.focus=i.getService("focus"),this.parent.on(H,this.clickHandler,this),this.parent.on(N,this.destroy,this),this.parent.on(V,this.keyPressHandler,this),this.parent.on("expandchildgrid",this.expand,this),this.parent.on("column-visible-changed",this.refreshColSpan,this))}return f(e,[{key:"clickHandler",value:function(e){this.toogleExpandcollapse(Object(m.C)(e.target,"td"))}},{key:"toogleExpandcollapse",value:function(e){var t,i=this.parent,n=this.parent.getContentTable(),r=this.parent.getCurrentViewRecords().length-1,s=e&&e.classList.contains("e-detailrowcollapse");if(e&&(e.classList.contains("e-detailrowcollapse")||e.classList.contains("e-detailrowexpand")))if(Object(m.W)()&&this.parent.isServerRendered)this.parent.notify("detailclick",e);else{var a=e.parentElement,l=a.getAttribute("data-uid"),o=i.getRowObjectFromUID(l),h=this.parent.getContentTable().querySelector("tbody").children[a.rowIndex+1];if(e.classList.contains("e-detailrowcollapse")){var c=o.data;if(this.isDetailRow(h))h.style.display="",i.notify("detail-state-change",{data:c,childGrid:i.childGrid,detailElement:e,isExpanded:s});else if(i.getDetailTemplate()||i.childGrid){var u=Qt("grid-row"),d=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":u}}),p=this.parent.createElement("td",{className:"e-detailcell"}),g=this.parent.getVisibleColumns().length;this.parent.allowRowDragAndDrop&&g++,p.setAttribute("colspan",g.toString());for(var f=new _({isDataRow:!0,isExpand:!0,uid:u,isDetailRow:!0,cells:[new Q({cellType:K.Indent}),new Q({isDataCell:!0,visible:!0})]}),v=0,b=i.groupSettings.columns.length;v<b;v++)d.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),f.cells.unshift(new Q({cellType:K.Indent}));if(d.appendChild(this.parent.createElement("td",{className:"e-detailindentcell"})),d.appendChild(p),a.parentNode.insertBefore(d,a.nextSibling),i.detailTemplate){var y=i.element.id+"detailTemplate";this.parent.isReact&&"string"!=typeof i.detailTemplate?(i.getDetailTemplate()(c,i,"detailTemplate",y,null,null,p),this.parent.renderTemplates()):Jt(p,i.getDetailTemplate()(c,i,"detailTemplate",y)),Object(m.W)()&&Object(m.sb)(y,"DetailTemplate",i,!1)}else{(t=new Ot(this.getGridModel(i,o,i.printMode))).query&&(t.query=t.query.clone()),t.parentDetails={parentID:i.element.id,parentPrimaryKeys:i.getPrimaryKeyFieldNames(),parentKeyField:i.childGrid.queryString,parentKeyFieldValue:c[i.childGrid.queryString],parentRowData:c},t.isLegacyTemplate=i.isReact||i.isLegacyTemplate,i.isPrinting&&(t.isPrinting=!0,t.on(A,this.promiseResolve(t),this),t.on(L,this.promiseResolve(t),this)),o.childGrid=t;var C=t.getInjectedModules(),w=i.getInjectedModules();C&&C.length===w.length||t.setInjectedModules(w);var k=this.parent.createElement("div",{id:"child"+Zt(a,"e-grid").length+"_grid"+a.rowIndex+Qt("")});p.appendChild(k),t.appendTo(k)}d.appendChild(p),a.nextSibling?a.parentNode.insertBefore(d,a.nextSibling):a.parentNode.appendChild(d),i.getRows().splice(a.rowIndex+1,0,d),i.getRowsObject().splice(o.index+1,0,f),i.trigger("detailDataBound",{detailElement:p,data:c,childGrid:t}),i.notify("detailDataBound",{rows:i.getRowsObject()})}if(Object(m.A)(e,["e-detailrowexpand"],["e-detailrowcollapse"]),Object(m.A)(e.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),o.isExpand=!0,e.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>n.scrollHeight){Object(m.ib)(e.parentElement.querySelectorAll("td"),"e-lastrowcell");var S=n.querySelector("tbody").querySelectorAll(".e-detailrow").length-1;Object(m.v)(n.querySelector("tbody").querySelectorAll(".e-detailrow")[S].childNodes,["e-lastrowcell"]),this.lastrowcell=!0}this.aria.setExpand(e,!0)}else this.isDetailRow(h)&&(h.style.display="none",i.notify("detail-state-change",{data:o.data,childGrid:i.childGrid,detailElement:e,isExpanded:s})),Object(m.A)(e,["e-detailrowcollapse"],["e-detailrowexpand"]),Object(m.A)(e.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(a.getAttribute("aria-rowindex"),10)===r&&this.lastrowcell&&(Object(m.v)(e.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),o.isExpand=!1,this.aria.setExpand(e,!1)}}},{key:"getGridModel",value:function(e,t,i){var n;return e.isPrinting&&t.isExpand&&e.expandedRows&&e.expandedRows[t.index]&&e.expandedRows[t.index].gridModel?(e.expandedRows[t.index].gridModel.hierarchyPrintMode=e.childGrid.hierarchyPrintMode,n=e.expandedRows[t.index].gridModel):e.isPrinting&&e.childGrid.allowPaging?(e.childGrid.allowPaging="CurrentPage"===i,n=e.childGrid):n=e.childGrid,n}},{key:"promiseResolve",value:function(e){var t=this;return function(){e.off(A,t.promiseResolve),e.off(L,t.promiseResolve),e.notify("hierarchyprint",{})}}},{key:"isDetailRow",value:function(e){return e&&e.classList.contains("e-detailrow")}},{key:"destroy",value:function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.parent.off(H,this.clickHandler),this.parent.off(N,this.destroy),this.parent.off(V,this.keyPressHandler),this.parent.off("expandchildgrid",this.expand),this.parent.off("column-visible-changed",this.refreshColSpan))}},{key:"getTDfromIndex",value:function(e,t){var i=this.parent.getDataRows()[e];return i&&i.querySelector(t)?i.querySelector(t):null}},{key:"expand",value:function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowcollapse")),e&&e.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(e)}},{key:"collapse",value:function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowexpand")),e&&e.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(e)}},{key:"expandAll",value:function(){this.expandCollapse(!0),this.parent.trigger(E,{requestType:"expandAllComplete",type:E,moduleObj:this})}},{key:"collapseAll",value:function(){this.expandCollapse(!1),this.parent.trigger(E,{requestType:"collapseAllComplete",type:E,moduleObj:this})}},{key:"expandCollapse",value:function(e){for(var t,i=this.parent.getDataRows(),n=0,r=i.length;n<r;n++)t=i[n].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),e?this.expand(t):this.collapse(t)}},{key:"keyPressHandler",value:function(e){var t=this.parent;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":var i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){var n=t.getDataRows()[i[i.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand");"altDownArrow"===e.action?this.expand(n):this.collapse(n)}break;case"enter":if(this.parent.isEdit)return;var r=this.focus.getFocusedElement();if(!e.target.classList.contains("e-detailrowcollapse")&&!e.target.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(r)}}},{key:"refreshColSpan",value:function(){for(var e=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),t=this.parent.getVisibleColumns().length,i=0;i<e.length;i++)e[i].querySelector(".e-detailcell").setAttribute("colspan",t+"")}},{key:"getModuleName",value:function(){return"detailRow"}}]),e}()},Es={provide:"GridsToolbar",useValue:function(){function e(t,i){p(this,e),this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=t,this.gridID=t.element.id,this.serviceLocator=i,this.addEventListener()}return f(e,[{key:"render",value:function(){this.l10n=this.serviceLocator.getService("localization");for(var e=0,t=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];e<t.length;e++){var i=t[e],n=i.toLowerCase(),r=n[0].toUpperCase()+n.slice(1);this.predefinedItems[i]={id:this.gridID+"_"+n,prefixIcon:"e-"+n,text:this.l10n.getConstant(r),tooltipText:this.l10n.getConstant(r)}}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},this.createToolbar()}},{key:"getToolbar",value:function(){return this.toolbar.element}},{key:"destroy",value:function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),Object(m.hb)(this.element))}},{key:"bindSearchEvents",value:function(){this.searchElement=Object(m.lb)("#"+this.gridID+"_searchbar",this.element),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()}},{key:"toolbarCreated",value:function(){this.element.querySelector(".e-search-wrapper")&&(this.element.querySelector(".e-search-wrapper").innerHTML='<div class="e-input-group e-search" role="search">        <input id="'+this.gridID+'_searchbar" class="e-input" name="input" type="search"         placeholder= "'+this.l10n.getConstant("Search")+'"/>        <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"         tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>         </div>'),this.bindSearchEvents()}},{key:"createToolbar",value:function(){var e=this.getItems();this.toolbar=new S.b({items:e,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this)}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this),this.toolbar.isStringTemplate=!0;var t="viewContainerRef";if(this.parent[t]&&(this.toolbar.registeredTemplate={},this.toolbar[t]=this.parent[t]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.toolbarTemplate)if(Object(m.W)()||"string"!=typeof this.parent.toolbarTemplate)if(Object(m.W)()){var i=this.parent.element.id+"toolbarTemplate",n=Jt(this.element,Lt(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",i)),r=this.getItem(n);this.toolbar.items.push(r),this.toolbar.appendTo(this.element),Object(m.sb)(this.parent.element.id+"toolbarTemplate","ToolbarTemplate",this.parent)}else{var s=this.parent.element.id+"toolbarTemplate";this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate?(Lt(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",s,null,null,this.element),this.parent.renderTemplates()):Jt(this.element,Lt(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}else this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent())}},{key:"addReactToolbarPortals",value:function(e){this.parent.isReact&&e&&(this.parent.portals=this.parent.portals.concat(e),this.parent.renderTemplates())}},{key:"refreshToolbarItems",value:function(e){var t=this.parent,i=[],n=[],r=t.editSettings,s=t.currentViewData&&t.currentViewData.length;r.allowAdding?i.push(this.gridID+"_add"):n.push(this.gridID+"_add"),r.allowEditing&&s?i.push(this.gridID+"_edit"):n.push(this.gridID+"_edit"),r.allowDeleting&&s?i.push(this.gridID+"_delete"):n.push(this.gridID+"_delete"),"Batch"===t.editSettings.mode?t.element.querySelectorAll(".e-updatedtd").length&&(r.allowAdding||r.allowEditing)?(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")):t.isEdit&&(r.allowAdding||r.allowEditing)?(i=[this.gridID+"_update",this.gridID+"_cancel"],n=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")),this.enableItems(i,!0),this.enableItems(n,!1)}},{key:"getItems",value:function(){var e=[],t=this.parent.toolbar||[];if("string"==typeof this.parent.toolbar)return[];var i,n=c(t);try{for(n.s();!(i=n.n()).done;){var r=i.value;switch(typeof r){case"number":e.push(this.getItemObject(this.items[r]));break;case"string":e.push(this.getItemObject(r));break;default:e.push(this.getItem(r))}}}catch(s){n.e(s)}finally{n.f()}return e}},{key:"getItem",value:function(e){var t=this.predefinedItems[e.text];return t?Object(m.K)(t,t,e):e}},{key:"getItemObject",value:function(e){return this.predefinedItems[e]||{text:e,id:this.gridID+"_"+e}}},{key:"enableItems",value:function(e,t){var i,n=c(e);try{for(n.s();!(i=n.n()).done;){var r=i.value,s=Object(m.lb)("#"+r,this.element);s&&this.toolbar.enableItems(s.parentElement,t)}}catch(a){n.e(a)}finally{n.f()}}},{key:"toolbarClickHandler",value:function(e){var t=this,i=this.parent,n=this.gridID;Object(m.K)(e,{cancel:!1});var r=!Object(m.W)()||this.parent.isJsComponent?e:{item:e.item,cancel:e.cancel,name:e.name},s=e.originalEvent;i.trigger("toolbarClick",r,(function(e){if(e.originalEvent=e.originalEvent?e.originalEvent:s,!e.cancel)switch(!Object(m.X)(e.item)&&e.item.id){case n+"_print":i.print();break;case n+"_edit":i.startEdit();break;case n+"_update":i.endEdit();break;case n+"_cancel":i.closeEdit();break;case n+"_add":i.addRecord();break;case n+"_delete":i.deleteRecord();break;case n+"_search":e.originalEvent.target.id===n+"_searchbutton"&&t.search();break;case n+"_columnchooser":var r=t.parent.element.querySelector(".e-ccdiv"),a=r.getBoundingClientRect().top,l=r.getBoundingClientRect().left,o=e.originalEvent.target;a=r.getBoundingClientRect().top+r.offsetTop,i.createColumnchooser(l,a,o);break;case"copy":Object(m.W)()&&i.copy();break;case"copyheader":case"copyHeader":Object(m.W)()&&i.copy(!0)}}))}},{key:"modelChanged",value:function(e){"edit"===e.module&&this.refreshToolbarItems()}},{key:"onPropertyChanged",value:function(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&Object(m.hb)(this.element),this.render())}},{key:"keyUpHandler",value:function(e){13===e.keyCode&&this.search()}},{key:"search",value:function(){this.parent.search(this.searchElement.value)}},{key:"updateSearchBox",value:function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)}},{key:"wireEvent",value:function(){this.searchElement&&(this.searchBoxObj=new Qe(this.searchElement),m.l.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent())}},{key:"unWireEvent",value:function(){this.searchElement&&(m.l.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent())}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(F,this.render,this),this.parent.on(z,this.onPropertyChanged,this),this.parent.on(B,this.updateSearchBox.bind(this)),this.parent.on(P,this.refreshToolbarItems,this),this.parent.on(W,this.refreshToolbarItems,this),this.parent.on(B,this.modelChanged,this),this.parent.on(I,this.refreshToolbarItems,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(F,this.render),this.parent.off(z,this.onPropertyChanged),this.parent.off(B,this.updateSearchBox),this.parent.off(P,this.refreshToolbarItems),this.parent.off(W,this.refreshToolbarItems),this.parent.off(B,this.modelChanged),this.parent.off(I,this.refreshToolbarItems))}},{key:"getModuleName",value:function(){return"toolbar"}}]),e}()},Is={provide:"GridsAggregate",useValue:function(){function e(t,i){p(this,e),this.parent=t,this.locator=i,this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"aggregate"}},{key:"initiateRender",value:function(){for(var e=this,t=this.locator.getService("cellRendererFactory"),i=new Rn(this.parent,this.locator),n=[K.Summary,K.CaptionSummary,K.GroupSummary],r=0;r<n.length;r++)t.addCellRenderer(n[r],i);this.footerRenderer=new jn(this.parent,this.locator),this.footerRenderer.renderPanel(),this.footerRenderer.renderTable();var s=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&s&&Object(m.v)([s],["e-footerpadding"]),this.locator.register("footerRenderer",this.footerRenderer);this.parent.on(T,(function t(){e.prepareSummaryInfo(),e.parent.off(T,t)}),this),this.parent.on(T,this.footerRenderer.refresh,this.footerRenderer)}},{key:"prepareSummaryInfo",value:function(){var e=this;if(function(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<e[i].columns.length;n++)t(e[i].columns[n])}(this.parent.aggregates,(function(t){if(e.parent.getColumnByField(t.field),Object(m.X)(t.customFormat)||t.setPropertiesSilent({format:t.customFormat}),"object"==typeof t.format){var i=new j;t.setFormatter(i.getFormatFunction(Object(m.K)({},t.format)))}else if("string"==typeof t.format){var n=e.locator.getService("valueFormatter");t.setFormatter(n.getFormatFunction({format:t.format}))}t.setPropertiesSilent({columnName:t.columnName||t.field})})),Object(m.W)()&&this.parent.isServerRendered)for(var t=Object.keys(this.parent.bulkChanges),i=0;i<t.length;i++)t[i].startsWith("aggregates")&&delete this.parent.bulkChanges[t[i]]}},{key:"onPropertyChanged",value:function(e){if(e.module===this.getModuleName()){Object(m.X)(this.footerRenderer)&&this.initiateRender(),this.prepareSummaryInfo(),this.footerRenderer.refresh();var t=new ie(this.parent);0===new te(this.parent).getData().length&&t.isEmpty()||this.parent.notify(P,{})}}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(F,this.initiateRender,this),this.parent.on(z,this.onPropertyChanged,this),this.parent.on("refresh-aggregates",this.refresh,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(F,this.initiateRender),this.parent.off(T,this.footerRenderer.refresh),this.parent.off(z,this.onPropertyChanged),this.parent.off("refresh-aggregates",this.refresh))}},{key:"destroy",value:function(){this.removeEventListener(),Object(m.hb)(this.parent.element.querySelector(".e-gridfooter"))}},{key:"refresh",value:function(e){var t=e instanceof Array?e:[e];this.parent.notify("refresh-footer-rendered",t),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",t)}}]),e}()},Ms={provide:"GridsSearch",useValue:nt},Fs={provide:"GridsVirtualScroll",useValue:function(){function e(t,i){p(this,e),this.parent=t,this.locator=i,this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"virtualscroll"}},{key:"instantiateRenderer",value:function(){this.parent.log(["limitation","virtual_height"],"virtualization");var e=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&e.addRenderer(U.Header,new Mn(this.parent,this.locator)),e.addRenderer(U.Content,new In(this.parent,this.locator))),this.ensurePageSize()}},{key:"ensurePageSize",value:function(){var e=this.parent.getRowHeight(),t=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height;this.blockSize=~~(t/e);var i=2*this.blockSize,n=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:n<i?i:n}},!0),Object(m.W)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{})}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(M,this.instantiateRenderer,this),this.parent.on("column-width-changed",this.refreshVirtualElement,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(M,this.instantiateRenderer),this.parent.off("column-width-changed",this.refreshVirtualElement))}},{key:"refreshVirtualElement",value:function(e){this.parent.enableColumnVirtualization&&"resize"===e.module&&this.locator.getService("rendererFactory").getRenderer(U.Content).refreshVirtualElement()}},{key:"destroy",value:function(){this.removeEventListener()}}]),e}()},Ts={provide:"GridsEdit",useValue:_n},As={provide:"GridsResize",useValue:On},zs={provide:"GridsExcelExport",useValue:Zn},Ls={provide:"GridsPdfExport",useValue:$n},Bs={provide:"GridsCommandColumn",useValue:function(){function e(t,i){p(this,e),this.parent=t,this.locator=i,this.initiateRender(),this.addEventListener()}return f(e,[{key:"initiateRender",value:function(){this.locator.getService("cellRendererFactory").addCellRenderer(K.CommandColumn,new er(this.parent,this.locator))}},{key:"commandClickHandler",value:function(e){var t=this.parent,i=Object(m.C)(e.target,"button");if(i&&Object(m.C)(e.target,".e-unboundcell")){for(var n,r=i.ej2_instances[0],s=r.commandType,a=i.getAttribute("data-uid"),l=t.getRowObjectFromUID(Object(m.C)(i,".e-row").getAttribute("data-uid")),o=this.parent.columnModel,h=0;h<o.length;h++)if(o[h].commands)for(var c=o[h].commands,u=0;u<c.length;u++){Object(m.W)()&&!t.isJsComponent&&c[u].uid===a?(n=c[u],s=c[u].type):c[u].uid===a&&c[u].type===s&&(n=c[u])}var d={cancel:!1,target:i,commandColumn:n,rowData:Object(m.X)(l)?void 0:l.data};this.parent.trigger("commandClick",d,(function(e){if(!r.disabled&&t.editModule&&!e.cancel)switch(s){case"Edit":t.editModule.endEdit(),t.editModule.startEdit(Object(m.C)(i,"tr"));break;case"Cancel":t.editModule.closeEdit();break;case"Save":t.editModule.endEdit();break;case"Delete":"Batch"!==t.editSettings.mode&&t.editModule.endEdit(),t.commandDelIndex=parseInt(Object(m.C)(i,"tr").getAttribute("aria-rowindex"),10),t.clearSelection(),t.selectRow(t.commandDelIndex,!1),t.editModule.deleteRecord(),t.commandDelIndex=void 0}}))}}},{key:"getModuleName",value:function(){return"commandColumn"}},{key:"destroy",value:function(){this.parent.isDestroyed||this.removeEventListener()}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(H,this.commandClickHandler),this.parent.off(V,this.keyPressHandler),this.parent.off(F,this.load))}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(H,this.commandClickHandler,this),this.parent.on(V,this.keyPressHandler,this),this.parent.on(F,this.load,this))}},{key:"keyPressHandler",value:function(e){"enter"===e.action&&Object(m.C)(e.target,".e-unboundcelldiv")&&(this.commandClickHandler(e),e.preventDefault())}},{key:"load",value:function(){if(!Object(m.W)()||this.parent.isJsComponent)for(var e=this.parent.columnModel,t=0;t<e.length;t++)if(e[t].commands)for(var i=e[t].commands,n=0;n<i.length;n++)i[n].uid=Qt("gridcommand")}}]),e}()},Ps={provide:"GridsContextMenu",useValue:function(){function e(t,i){p(this,e),this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=t,this.gridID=t.element.id,this.serviceLocator=i,this.addEventListener()}return f(e,[{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(z,this.enableAfterRenderMenu,this),this.parent.on(M,this.render,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(M,this.render),this.parent.off(z,this.enableAfterRenderMenu),m.l.remove(this.element,"keydown",this.keyDownHandler.bind(this)))}},{key:"keyDownHandler",value:function(e){"Tab"!==e.code&&9!==e.which||this.contextMenu.close(),"Escape"===e.code&&(this.contextMenu.close(),this.parent.notify("restore-Focus",{}))}},{key:"render",value:function(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),m.l.add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);var e="#"+this.gridID;this.contextMenu=new S.a({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:e,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)}},{key:"enableAfterRenderMenu",value:function(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),Object(m.hb)(this.element),this.parent.element.classList.remove("e-noselect")),this.render())}},{key:"getMenuItems",value:function(){var e,t=[],i=[],n=c(this.parent.contextMenuItems);try{for(n.s();!(e=n.n()).done;){var r=e.value;"string"==typeof r&&-1!==this.getDefaultItems().indexOf(r)?-1!==r.toLocaleLowerCase().indexOf("export")?i.push(this.buildDefaultItems(r)):t.push(this.buildDefaultItems(r)):"string"!=typeof r&&t.push(r)}}catch(a){n.e(a)}finally{n.f()}if(i.length>0){var s=this.buildDefaultItems("export");s.items=i,t.push(s)}return t}},{key:"getLastPage",value:function(){var e=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(e+=1),e}},{key:"contextMenuOpen",value:function(){this.isOpen=!0}},{key:"contextMenuItemClick",value:function(e){switch(this.getKeyFromId(e.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute("aria-colindex"),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(this.cell.getAttribute("aria-colindex"),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}e.column=this.targetColumn,e.rowInfo=this.targetRowdata,Object(m.W)()?this.parent.trigger("contextMenuClick",e.rowInfo.row?{element:e.element,item:e.item,event:e.event,column:this.targetColumn,rowInfo:{rowData:this.targetRowdata.rowData,rowIndex:this.targetRowdata.rowIndex,cellIndex:this.targetRowdata.cellIndex}}:this.targetColumn?{element:e.element,item:e.item,event:e.event,column:this.targetColumn}:{element:e.element,item:e.item,event:e.event}):this.parent.trigger("contextMenuClick",e)}},{key:"contextMenuOnClose",value:function(e){e.items.length>0&&e.items[0].parentObj instanceof S.a&&this.updateItemStatus()}},{key:"getLocaleText",value:function(e){return this.l10n.getConstant(this.localeText[e])}},{key:"updateItemStatus",value:function(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1}},{key:"contextMenuBeforeOpen",value:function(e){var t=Object(m.C)(e.event.target,".e-grid");if(e.event&&t&&t!==this.parent.element)e.cancel=!0;else if(e.event&&(Object(m.C)(e.event.target,".e-groupdroparea")||Object(m.C)(e.event.target,".e-gridpopup")||Object(m.C)(e.event.target,".e-summarycell")||Object(m.C)(e.event.target,".e-groupcaption")||Object(m.C)(e.event.target,".e-filterbarcell")))e.cancel=!0;else{this.targetColumn=this.getColumn(e.event),this.targetRowdata=this.parent.getRowInfo(e.event.target),Object(m.X)(e.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&this.selectRow(e.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type);var i,n=[],r=[],s=c(e.items);try{for(s.s();!(i=s.n()).done;){var a=i.value,l=this.getKeyFromId(a.id),o=this.defaultItems[l];if(-1!==this.getDefaultItems().indexOf(l))if(this.ensureDisabledStatus(l)&&this.disableItems.push(a.text),e.event&&(this.ensureTarget(e.event.target,".e-inline-edit")||this.ensureTarget(e.event.target,".e-editedbatchcell")))"Save"!==l&&"Cancel"!==l&&this.hiddenItems.push(a.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(Object(m.C)(e.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===l||"Cancel"===l))continue;Object(m.X)(e.parentItem)&&e.event&&!this.ensureTarget(e.event.target,o.target)&&this.hiddenItems.push(a.text)}else a.target&&e.event&&!this.ensureTarget(e.event.target,a.target)?a.separator?n.push(a.id):this.hiddenItems.push(a.text):this.ensureTarget(e.event.target,a.target)&&a.separator&&r.push(a.id)}}catch(h){s.e(h)}finally{s.f()}r.length>0&&this.contextMenu.showItems(r,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),n.length>0&&this.contextMenu.hideItems(n,!0),this.eventArgs=e.event,e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuOpen",e),(e.cancel||this.hiddenItems.length===e.items.length&&!e.parentItem)&&(this.updateItemStatus(),e.cancel=!0)}Mi(this.parent.element,this.contextMenu.element.parentElement)}},{key:"ensureTarget",value:function(e,t){var i;return(i=!this.ensureFrozenHeader(e)||".e-gridheader"!==t&&".e-gridcontent"!==t?".e-gridcontent"===t||".e-gridheader"===t?Wt(Object(m.C)(e,".e-table"),t.substr(1,t.length)):Object(m.C)(e,t):Object(m.C)(e,".e-gridheader"===t?"thead":"tbody"))&&Wt(i,"e-grid")===this.parent.element}},{key:"ensureFrozenHeader",value:function(e){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!Object(m.C)(e,".e-gridheader"))}},{key:"ensureDisabledStatus",value:function(e){var t=!1;switch(e){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(On)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===e;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(xn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(xn)||this.parent.ensureModuleInjected(xn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":0!==this.parent.getSelectedRowIndexes().length&&0!==this.parent.getCurrentViewRecords().length||(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected($n)||this.parent.ensureModuleInjected(Zn))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected($n)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(Zn)||(t=!0);break;case"SortAscending":case"SortDescending":if(!this.parent.allowSorting||!this.parent.ensureModuleInjected(sn)||this.targetColumn&&!this.targetColumn.field)t=!0;else if(this.parent.ensureModuleInjected(sn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(var i=this.parent.sortSettings.columns,n=0;n<i.length;n++)i[n].field===this.targetColumn.field&&i[n].direction.toLowerCase()===e.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0);break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(dn)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(dn)&&1===this.parent.pageSettings.currentPage)&&(t=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(dn)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(dn)&&this.parent.pageSettings.currentPage===this.getLastPage())&&(t=!0)}return t}},{key:"getContextMenu",value:function(){return this.element}},{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.contextMenu.destroy(),Object(m.hb)(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))}},{key:"getModuleName",value:function(){return"contextMenu"}},{key:"generateID",value:function(e){return this.gridID+"_cmenu_"+e}},{key:"getKeyFromId",value:function(e){return e.replace(this.gridID+"_cmenu_","")}},{key:"buildDefaultItems",value:function(e){var t;switch(e){case"AutoFitAll":case"AutoFit":t={target:".e-gridheader"};break;case"Group":t={target:".e-gridheader",iconCss:"e-icon-group"};break;case"Ungroup":t={target:".e-gridheader",iconCss:"e-icon-ungroup"};break;case"Edit":t={target:".e-gridcontent",iconCss:"e-edit"};break;case"Delete":t={target:".e-gridcontent",iconCss:"e-delete"};break;case"Save":t={target:".e-inline-edit",iconCss:"e-save"};break;case"Cancel":t={target:".e-inline-edit",iconCss:"e-cancel"};break;case"Copy":t={target:".e-gridcontent",iconCss:"e-copy"};break;case"export":t={target:".e-gridcontent"};break;case"PdfExport":t={target:".e-gridcontent",iconCss:"e-pdfexport"};break;case"ExcelExport":t={target:".e-gridcontent",iconCss:"e-excelexport"};break;case"CsvExport":t={target:".e-gridcontent",iconCss:"e-csvexport"};break;case"SortAscending":t={target:".e-gridheader",iconCss:"e-icon-ascending"};break;case"SortDescending":t={target:".e-gridheader",iconCss:"e-icon-descending"};break;case"FirstPage":t={target:".e-gridpager",iconCss:"e-icon-first"};break;case"PrevPage":t={target:".e-gridpager",iconCss:"e-icon-prev"};break;case"LastPage":t={target:".e-gridpager",iconCss:"e-icon-last"};break;case"NextPage":t={target:".e-gridpager",iconCss:"e-icon-next"}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[e]}},{key:"getDefaultItems",value:function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]}},{key:"setLocaleKey",value:function(){var e={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"};return Object(m.W)()&&(e.AutoFitAll="AutoFitAll",e.AutoFit="AutoFit"),e}},{key:"getColumn",value:function(e){var t=Object(m.C)(e.target,"th.e-headercell");if(t){var i=t.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}return this.parent.getRowInfo(e.target).column||null}},{key:"selectRow",value:function(e,t){this.cell=e.target,this.row=Object(m.C)(e.target,"tr.e-row")||this.row,this.row&&t&&!Wt(e.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute("aria-rowindex"),10))}}]),e}()},qs={provide:"GridsFreeze",useValue:function(){function e(t,i){p(this,e),this.parent=t,this.locator=i,this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"freeze"}},{key:"addEventListener",value:function(){this.parent.isDestroyed||this.parent.on(M,this.instantiateRenderer,this)}},{key:"instantiateRenderer",value:function(){this.parent.log("limitation",this.getModuleName());var e=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(e.addRenderer(U.Header,this.parent.enableColumnVirtualization?new lr(this.parent,this.locator):new nr(this.parent,this.locator)),e.addRenderer(U.Content,this.parent.enableVirtualization?new ar(this.parent,this.locator):new ir(this.parent,this.locator))),(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(e.addRenderer(U.Header,new rr(this.parent,this.locator)),e.addRenderer(U.Content,this.parent.enableVirtualization?new zr(this.parent,this.locator):new sr(this.parent,this.locator)))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||this.parent.off(M,this.instantiateRenderer)}},{key:"destroy",value:function(){this.removeEventListener()}}]),e}()},Vs={provide:"GridsColumnMenu",useValue:function(){function e(t,i){p(this,e),this.defaultItems={},this.localeText=this.setLocaleKey(),this.disableItems=[],this.hiddenItems=[],this.isOpen=!1,this.GROUP="e-icon-group",this.UNGROUP="e-icon-ungroup",this.ASCENDING="e-icon-ascending",this.DESCENDING="e-icon-descending",this.ROOT="e-columnmenu",this.FILTER="e-icon-filter",this.POP="e-filter-popup",this.WRAP="e-col-menu",this.CHOOSER="_chooser_",this.parent=t,this.gridID=t.element.id,this.serviceLocator=i,this.addEventListener()}return f(e,[{key:"wireEvents",value:function(){for(var e=this.getColumnMenuHandlers(),t=0;t<e.length;t++)m.l.add(e[t],"mousedown",this.columnMenuHandlerDown,this)}},{key:"unwireEvents",value:function(){for(var e=this.getColumnMenuHandlers(),t=0;t<e.length;t++)m.l.remove(e[t],"mousedown",this.columnMenuHandlerDown)}},{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),Object(m.hb)(this.element))}},{key:"columnMenuHandlerClick",value:function(e){e.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(e)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(e)):this.isOpen?this.columnMenu.close():this.openColumnMenu(e))}},{key:"openColumnMenuByField",value:function(e){this.openColumnMenu({target:this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu")})}},{key:"openColumnMenu",value:function(e){var t={top:0,left:0};this.element.style.cssText="display:block;visibility:hidden";var i=this.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible",this.headerCell=this.getHeaderCell(e),m.d.isDevice?(t.top=window.innerHeight/2-i.height/2,t.left=window.innerWidth/2-i.width/2):this.parent.enableRtl?t=Object(b.e)(this.headerCell,"left","bottom"):(t=Object(b.e)(this.headerCell,"right","bottom")).left-=i.width,this.columnMenu.open(t.top,t.left),e.preventDefault&&e.preventDefault(),Mi(this.parent.element,this.columnMenu.element.parentElement)}},{key:"columnMenuHandlerDown",value:function(e){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)}},{key:"getColumnMenuHandlers",value:function(){return[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+this.ROOT))}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on(q,this.wireEvents,this),this.parent.on(z,this.enableAfterRenderMenu,this),this.parent.on(F,this.render,this),this.isFilterItemAdded()&&this.parent.on("filterDialogCreated",this.filterPosition,this),this.parent.on(H,this.columnMenuHandlerClick,this),this.parent.on(V,this.keyPressHandler,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(q,this.unwireEvents),this.parent.off(z,this.enableAfterRenderMenu),this.parent.off(F,this.render),this.isFilterItemAdded()&&this.parent.off("filterDialogCreated",this.filterPosition),this.parent.off(H,this.columnMenuHandlerClick),this.parent.off(V,this.keyPressHandler))}},{key:"keyPressHandler",value:function(e){var t=this.parent;if("altDownArrow"===e.action){var i=t.focusModule.currentInfo.element;if(i&&i.classList.contains("e-headercell")){var n=t.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid"));this.openColumnMenuByField(n.field)}}}},{key:"enableAfterRenderMenu",value:function(e){e.module===this.getModuleName()&&e.enable&&(this.columnMenu&&(this.columnMenu.destroy(),Object(m.hb)(this.element)),this.render())}},{key:"render",value:function(){this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"}),this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA")),this.parent.element.appendChild(this.element),this.columnMenu=new S.a({cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)}),this.columnMenu.appendTo(this.element),this.wireFilterEvents()}},{key:"wireFilterEvents",value:function(){!m.d.isDevice&&this.isFilterItemAdded()&&m.l.add(this.element,"mouseover",this.appendFilter,this)}},{key:"unwireFilterEvents",value:function(){!m.d.isDevice&&this.isFilterItemAdded()&&m.l.remove(this.element,"mouseover",this.appendFilter)}},{key:"beforeMenuItemRender",value:function(e){if(this.isChooserItem(e.item)){var t=this.getKeyFromId(e.item.id,this.CHOOSER),i=this.parent.columnModel.filter((function(e){return e.field===t})),n=Object(y.f)(this.parent.createElement,!1,{label:e.item.text,checked:i[0].visible});this.parent.enableRtl&&n.classList.add("e-rtl"),e.element.innerHTML="",e.element.appendChild(n)}else e.item.id&&"Filter"===this.getKeyFromId(e.item.id)&&(e.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),e.element.className+="e-filter-item e-menu-caret-icon")}},{key:"columnMenuBeforeClose",value:function(e){var t=e.event?Object(m.C)(e.event.target,".e-menu-item"):null;(!Object(m.X)(e.parentItem)&&"ColumnChooser"===this.getKeyFromId(e.parentItem.id)&&t&&this.isChooserItem(t)||e.event&&(Object(m.C)(e.event.target,"."+this.POP)||e.event.currentTarget&&e.event.currentTarget.activeElement&&Wt(e.event.currentTarget.activeElement,"e-filter-popup")||Wt(e.event.target,"e-popup")||Wt(e.event.target,"e-popup-wrapper"))&&!m.d.isDevice)&&(e.cancel=!0)}},{key:"isChooserItem",value:function(e){return e.id&&e.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(e.id,this.CHOOSER).indexOf("_colmenu_")}},{key:"columnMenuBeforeOpen",value:function(e){e.column=this.targetColumn=this.getColumn(),this.parent.trigger("columnMenuOpen",e);var t,i=c(e.items);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=this.getKeyFromId(n.id),s=this.defaultItems[r];-1!==this.getDefaultItems().indexOf(r)&&this.ensureDisabledStatus(r)&&!s.hide&&this.disableItems.push(n.text),n.hide&&this.hiddenItems.push(n.text)}}catch(a){i.e(a)}finally{i.f()}this.columnMenu.enableItems(this.disableItems,!1),this.columnMenu.hideItems(this.hiddenItems)}},{key:"columnMenuOnOpen",value:function(e){"e-menu-parent e-ul "===e.element.className&&(e.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(e.element.style.maxHeight=.8*window.innerHeight+"px",e.element.style.overflowY="auto")}},{key:"ensureDisabledStatus",value:function(e){var t=!1;switch(e){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(xn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(On);break;case"Ungroup":(!this.parent.ensureModuleInjected(xn)||this.parent.ensureModuleInjected(xn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(sn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting)for(var i=this.parent.sortSettings.columns,n=0;n<i.length;n++)i[n].field===this.targetColumn.field&&i[n].direction.toLocaleLowerCase()===e.toLocaleLowerCase().replace("sort","")&&(t=!0);else(!this.parent.allowSorting||!this.parent.ensureModuleInjected(sn)||this.parent.allowSorting&&this.targetColumn&&!this.targetColumn.allowSorting)&&(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Sn)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(Sn)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t}},{key:"columnMenuItemClick",value:function(e){switch(this.isChooserItem(e.item)?"ColumnChooser":this.getKeyFromId(e.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":var t=this.getKeyFromId(e.item.id,this.CHOOSER),i=e.element.querySelector(".e-checkbox-wrapper .e-frame");i&&i.classList.contains("e-check")?(i.classList.remove("e-check"),this.parent.hideColumns(t,"field")):i&&(this.parent.showColumns(t,"field"),i.classList.add("e-check"));break;case"Filter":this.getFilter(e.element,e.item.id)}e.column=this.targetColumn,this.parent.trigger("columnMenuClick",e)}},{key:"columnMenuOnClose",value:function(e){e.items.length>0&&e.items[0].parentObj instanceof S.a&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(e.element,e.element.id,!0)),this.parent.isFrozenGrid()||this.parent.notify("restore-Focus",{})}},{key:"getDefaultItems",value:function(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]}},{key:"getItems",value:function(){var e,t=[],i=c(this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault());try{for(i.s();!(e=i.n()).done;){var n=e.value;if("string"==typeof n)if("ColumnChooser"===n){var r=this.getDefaultItem(n);r.items=this.createChooserItems(),t.push(r)}else t.push(this.getDefaultItem(n));else t.push(n)}}catch(s){i.e(s)}finally{i.f()}return t}},{key:"getDefaultItem",value:function(e){var t={};switch(e){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[e]}},{key:"getLocaleText",value:function(e){return this.l10n.getConstant(this.localeText[e])}},{key:"generateID",value:function(e,t){return this.gridID+"_colmenu_"+(t?t+e:e)}},{key:"getKeyFromId",value:function(e,t){return e.indexOf("_colmenu_")>0&&e.replace(this.gridID+"_colmenu_"+(t||""),"")}},{key:"getColumnMenu",value:function(){return this.element}},{key:"getModuleName",value:function(){return"columnMenu"}},{key:"setLocaleKey",value:function(){var e={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"};return Object(m.W)()&&(e.AutoFitAll="AutoFitAll",e.AutoFit="AutoFit"),e}},{key:"getHeaderCell",value:function(e){return Object(m.C)(e.target,"th.e-headercell")}},{key:"getColumn",value:function(){if(this.headerCell){var e=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(e)}return null}},{key:"createChooserItems",value:function(){var e,t=[],i=c(this.parent.columnModel);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.showInColumnChooser&&n.field&&t.push({id:this.generateID(n.field,this.CHOOSER),text:n.headerText?n.headerText:n.field})}}catch(r){i.e(r)}finally{i.f()}return t}},{key:"appendFilter",value:function(e){if(this.defaultItems.Filter){var t=this.defaultItems.Filter.id;Object(m.C)(e.target,"#"+t)&&!this.isFilterPopupOpen()?this.getFilter(e.target,t):!Object(m.C)(e.target,"#"+t)&&this.isFilterPopupOpen()&&this.getFilter(e.target,t,!0)}}},{key:"getFilter",value:function(e,t,i){var n=this.getFilterPop();n?n.style.display=!m.d.isDevice&&i?"none":"block":this.parent.notify("filterOpen",{col:this.targetColumn,target:e,isClose:i,id:t})}},{key:"setPosition",value:function(e,t){var i=this.parent.element.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.left-i.left,s=n.top-i.top;i.height<s?s=s-t.offsetHeight+n.height:i.height<s+t.offsetHeight&&(s=i.height-t.offsetHeight),window.innerHeight<t.offsetHeight+s+i.top&&(s=window.innerHeight-t.offsetHeight-i.top),r+=this.parent.enableRtl?-t.offsetWidth:n.width,i.width<=r+t.offsetWidth?r-=n.width+t.offsetWidth:r<0&&(r+=t.offsetWidth+n.width),t.style.top=s+"px",t.style.left=r+"px"}},{key:"filterPosition",value:function(e){var t=this.getFilterPop();if(t.classList.add(this.WRAP),!m.d.isDevice){var i=t.style.display;t.style.cssText+="display:block;visibility:hidden";var n=this.element.querySelector("."+this.FILTER);n&&(this.setPosition(n.parentElement,t),t.style.cssText+="display:"+i+";visibility:visible")}}},{key:"getDefault",value:function(){var e=[];return this.parent.ensureModuleInjected(On)&&(e.push("AutoFitAll"),e.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(xn)&&(e.push("Group"),e.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(sn)&&(e.push("SortAscending"),e.push("SortDescending")),e.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Sn)&&e.push("Filter"),e}},{key:"isFilterPopupOpen",value:function(){var e=this.getFilterPop();return e&&"none"!==e.style.display}},{key:"getFilterPop",value:function(){return m.d.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)}},{key:"isFilterItemAdded",value:function(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems}}]),e}()},Hs={provide:"GridsColumnChooser",useValue:function(){function e(t,i){p(this,e),this.showColumn=[],this.hideColumn=[],this.changedColumns=[],this.unchangedColumns=[],this.isDlgOpen=!1,this.dlghide=!1,this.initialOpenDlg=!0,this.stateChangeColumns=[],this.changedStateColumns=[],this.isInitialOpen=!1,this.isCustomizeOpenCC=!1,this.searchOperator="startswith",this.prevShowedCols=[],this.parent=t,this.serviceLocator=i,this.addEventListener(),this.cBoxTrue=Object(y.f)(this.parent.createElement,!0,{checked:!0,label:" "}),this.cBoxFalse=Object(y.f)(this.parent.createElement,!0,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Object(m.v)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return f(e,[{key:"destroy",value:function(){var e=this.parent.element;e&&(e.querySelector(".e-gridheader")||e.querySelector(".e-gridcontent"))&&(this.removeEventListener(),this.unWireEvents(),Object(m.X)(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())}},{key:"rtlUpdate",value:function(){this.parent.enableRtl?Object(m.v)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"]):Object(m.ib)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"])}},{key:"addEventListener",value:function(){this.parent.isDestroyed||(m.l.add(document,"click",this.clickHandler,this),this.parent.on(z,this.enableAfterRenderEle,this),this.parent.on(F,this.render,this),this.parent.addEventListener(I,this.hideDialog.bind(this)),this.parent.on(N,this.destroy,this),this.parent.on("rtl-updated",this.rtlUpdate,this),this.parent.on(V,this.keyUpHandler,this),this.parent.on("reset-columns",this.onResetColumns,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(m.l.remove(document,"click",this.clickHandler),this.parent.off(F,this.render),this.parent.off(N,this.destroy),this.parent.off(z,this.enableAfterRenderEle),this.parent.off("rtl-updated",this.rtlUpdate),this.parent.on(V,this.keyUpHandler,this),this.parent.off("reset-columns",this.onResetColumns))}},{key:"render",value:function(){this.l10n=this.serviceLocator.getService("localization"),this.renderDlgContent(),this.getShowHideService=this.serviceLocator.getService("showHideService")}},{key:"clickHandler",value:function(e){var t=e.target;if(!this.isCustomizeOpenCC){if(Object(m.X)(Object(m.C)(t,".e-cc"))&&Object(m.X)(Object(m.C)(t,".e-cc-toolbar")))Object(m.X)(this.dlgObj)||!this.dlgObj.visible||t.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(t.classList.contains("e-columnchooser-btn")||t.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else t.classList.contains("e-cc-cancel")&&(t.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=e.target)}this.isCustomizeOpenCC&&e.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState(),this.rtlUpdate()}},{key:"hideDialog",value:function(){!Object(m.X)(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)}},{key:"renderColumnChooser",value:function(e,t,i){if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;i&&(this.targetdlg=i),this.refreshCheckboxState(),this.dlgObj.dataBind(),this.dlgObj.element.style.maxHeight="430px";var n=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";var r=Object(b.f)(Object(m.C)(i,".e-toolbar-item"),this.dlgObj.element);this.dlgObj.element.style.display=n,this.dlgObj.element.style.top=r.top+Object(m.C)(i,".e-cc-toolbar").getBoundingClientRect().height+"px";Object(m.X)(Object(m.C)(i,".e-bigger"))||(this.dlgObj.width=258),m.d.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.dlgObj.element.style.left=this.parent.enableRtl?i.offsetLeft+"px":r.left-250+Object(m.C)(i,".e-cc-toolbar").clientWidth+2+"px",this.removeCancelIcon(),this.dlgObj.show(),this.parent.notify("columnChooserOpened",{dialog:this.dlgObj})}this.rtlUpdate()}},{key:"openColumnChooser",value:function(e,t){this.isCustomizeOpenCC=!0,this.dlgObj.visible?this.hideDialog():this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},Object(m.X)(e)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=t+"px",this.dlgObj.element.style.left=e+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))}},{key:"enableAfterRenderEle",value:function(e){e.module===this.getModuleName()&&e.enable&&this.render()}},{key:"keyUpHandler",value:function(e){"escape"===e.action&&this.hideDialog()}},{key:"customDialogOpen",value:function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");m.l.add(e,"keyup",this.columnChooserManualSearch,this)}},{key:"customDialogClose",value:function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");m.l.remove(e,"keyup",this.columnChooserManualSearch)}},{key:"getColumns",value:function(){return this.parent.getColumns().filter((function(e){return"checkbox"!==e.type&&!0===e.showInColumnChooser||"checkbox"===e.type&&void 0!==e.field}))}},{key:"renderDlgContent",value:function(){this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.parent.element.getBoundingClientRect();var e=this.parent.element.querySelector(".e-ccdiv");Object(m.X)(e)||e.getBoundingClientRect().top,this.dlgObj=new b.a({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:"e-cc",animationSettings:{effect:"None"}}),this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv),this.wireEvents()}},{key:"renderChooserList",value:function(){this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});var e=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search")}}),i=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),n=this.parent.createElement("div",{className:"e-cc-contentdiv"});this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),e.appendChild(t),e.appendChild(i),this.searchBoxObj=new Qe(t);var r=this.refreshCheckboxList(this.parent.getColumns());return this.innerDiv.appendChild(r),n.appendChild(this.innerDiv),this.mainDiv.appendChild(e),this.mainDiv.appendChild(n),this.mainDiv}},{key:"confirmDlgBtnClick",value:function(e){this.stateChangeColumns=[],this.changedStateColumns=[],this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns,this.changedColumnState(this.changedColumns);var t=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;!Object(m.X)(e)&&t<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify("tooltip-destroy",{module:"edit"}),0===this.parent.getCurrentViewRecords().length)&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString())}},{key:"onResetColumns",value:function(e){if("columnstate"===e.requestType)return this.showColumn=[],this.hideColumn=[],void this.hideDialog()}},{key:"resetColumnState",value:function(){this.showColumn=[],this.hideColumn=[],this.hideDialog()}},{key:"changedColumnState",value:function(e){for(var t=0;t<e.length;t++){var i=this.parent.getColumnByUid(e[t]);Object(m.W)()?this.changedStateColumns.push(JSON.parse(JSON.stringify(i))):this.changedStateColumns.push(i)}}},{key:"columnStateChange",value:function(e,t){for(var i=0;i<e.length;i++){var n=this.parent.getColumnByUid(e[i]);"checkbox"!==n.type&&(n.visible=t),Object(m.W)()?this.stateChangeColumns.push(JSON.parse(JSON.stringify(n))):this.stateChangeColumns.push(n)}}},{key:"clearActions",value:function(){this.hideColumn=[],this.showColumn=[],this.hideDialog(),this.addcancelIcon()}},{key:"clearBtnClick",value:function(){this.clearActions(),this.parent.notify("columnChooserCancelBtnClick",{dialog:this.dlgObj})}},{key:"checkstatecolumn",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1===this.showColumn.indexOf(t)&&this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&this.hideColumn.push(t)),i?e?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)}},{key:"columnChooserSearch",value:function(e){var t,i,n=!1,r=this.dlgDiv.querySelector(".e-footer-content"),s=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length;if(this.isInitialOpen=!0,r&&(i=r.querySelector(".e-btn").ej2_instances[0]),""===e?(this.removeCancelIcon(),t=this.getColumns(),n=!0):t=new v.a(this.getColumns()).executeLocal((new v.g).where("headerText",this.searchOperator,e,!0)),t.length)this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(t,e)),n?i&&s&&(i.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton());else{var a=this.parent.createElement("span",{className:"e-cc e-nmatch"});a.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(a),this.innerDiv.classList.add("e-ccnmdiv"),i&&(i.disabled=!0)}this.flag=!0,this.stopTimer()}},{key:"wireEvents",value:function(){m.l.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this),m.l.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this),this.searchBoxObj.wireEvent()}},{key:"unWireEvents",value:function(){this.parent.isDestroyed||(this.dlgObj.element&&m.l.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),m.l.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())}},{key:"checkBoxClickHandler",value:function(e){var t,i=Wt(e.target,"e-checkbox-wrapper");if(i){if(i.querySelector(".e-selectall")?this.updateSelectAll(!i.querySelector(".e-check")):gi(i.parentElement),i.querySelector(".e-chk-hidden").focus(),i.querySelector(".e-check"))t=!0;else{if(!i.querySelector(".e-uncheck"))return;t=!1}this.updateIntermediateBtn();var n=Wt(i,"e-ccheck").getAttribute("uid"),r=this.parent.getColumns();if("grid-selectAll"===n){this.changedColumns=[],this.unchangedColumns=[];for(var s=0;s<r.length;s++)r[s].showInColumnChooser&&this.checkstatecolumn(t,r[s].uid,!0)}else this.checkstatecolumn(t,n);this.refreshCheckboxButton()}}},{key:"updateIntermediateBtn",value:function(){var e=this.ulElement.children.length-1,t=[],i=this.ulElement.children[0].querySelector(".e-frame"),n=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,r=this.dlgObj.btnObj[0];r.disabled=!1,e===n?t=["e-check"]:n?t=["e-stop"]:(t=["e-uncheck"],r.disabled=!0),r.dataBind(),Object(m.ib)([i],["e-check","e-stop","e-uncheck"]),Object(m.v)([i],t)}},{key:"updateSelectAll",value:function(e){var t,i=c([].slice.call(this.ulElement.querySelectorAll(".e-frame")));try{for(i.s();!(t=i.n()).done;){vi(t.value,e)}}catch(n){i.e(n)}finally{i.f()}}},{key:"refreshCheckboxButton",value:function(){this.dlgObj.element.querySelector(".e-cc.e-input");for(var e,t=this.parent.getVisibleColumns(),i=0;i<t.length;i++){var n=t[i].uid;-1===this.prevShowedCols.indexOf(n)&&this.prevShowedCols.push(n)}for(var r=0;r<this.hideColumn.length;r++){var s=this.prevShowedCols.indexOf(this.hideColumn[r]);-1!==s&&this.prevShowedCols.splice(s,1)}e=0!==this.showColumn.length?1:this.prevShowedCols.length;var a=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];a.disabled=!1;for(var l=[],o=this.parent.element.querySelectorAll(".e-cc-chbox"),h=0,c=o.length;h<c;h++){var u=Wt(o[h],"e-ccheck").getAttribute("uid");l.push(u)}var d=this.showColumn.filter((function(e){return-1!==l.indexOf(e)}));0===e&&0===d.length&&(a.disabled=!0),a.dataBind()}},{key:"refreshCheckboxList",value:function(e,t){this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});var i=this.l10n.getConstant("SelectAll"),n=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),r=this.createCheckBox(i,!1,"grid-selectAll");e.length&&(r.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),r.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(r.querySelector(".e-icons"),!0),n.appendChild(r),this.ulElement.appendChild(n));for(var s=0;s<e.length;s++)this.renderCheckbox(e[s]);return this.ulElement}},{key:"refreshCheckboxState",value:function(){this.dlgObj.element.querySelector(".e-cc.e-input").value="",this.columnChooserSearch("");for(var e=this.parent,t=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)"),i=0,n=t.length;i<n;i++){var r,s=t[i];r=this.parent.childGrid||this.parent.detailTemplate?Wt(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[i],"e-ccheck").getAttribute("uid"):Wt(s,"e-ccheck").getAttribute("uid");var a=e.getColumnByUid(r),l=s.parentElement.querySelectorAll(".e-uncheck");a.visible&&!l.length?(s.checked=!0,this.checkState(s.parentElement.querySelector(".e-icons"),!0)):(s.checked=!1,this.checkState(s.parentElement.querySelector(".e-icons"),!1))}}},{key:"checkState",value:function(e,t){t?Object(m.A)(e,["e-check"],["e-uncheck"]):Object(m.A)(e,["e-uncheck"],["e-check"])}},{key:"createCheckBox",value:function(e,t,i){var n=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return n.querySelector(".e-label").innerHTML=e,mi(i,n,"e-ccheck")}},{key:"renderCheckbox",value:function(e){var t,i,n;if(e.showInColumnChooser){t=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+e.uid}),i=-1!==this.hideColumn.indexOf(e.uid),n=-1!==this.showColumn.indexOf(e.uid);var r=this.createCheckBox(e.headerText,e.visible&&!i||n,e.uid);t.appendChild(r),this.ulElement.appendChild(t)}this.isInitialOpen&&this.updateIntermediateBtn()}},{key:"columnChooserManualSearch",value:function(e){this.addcancelIcon(),this.searchValue=e.target.value,this.stopTimer(),this.startTimer(e)}},{key:"startTimer",value:function(e){var t=this;this.timer=window.setInterval((function(){t.columnChooserSearch(t.searchValue)}),t.flag||13===e.keyCode?0:500)}},{key:"stopTimer",value:function(){window.clearInterval(this.timer)}},{key:"addcancelIcon",value:function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel")}},{key:"removeCancelIcon",value:function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel")}},{key:"mOpenDlg",value:function(){m.d.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())}},{key:"getModuleName",value:function(){return"columnChooser"}},{key:"hideOpenedDialog",value:function(){for(var e=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter((function(e){return e.classList.contains("e-popup-open")})),t=0,i=e.length;t<i;t++)(e[t].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==e[t].id)&&e[t].ej2_instances[0].hide()}},{key:"beforeOpenColumnChooserEvent",value:function(){Object(m.W)()&&this.parent.isServerRendered&&"none"===this.parent.columnChooserSettings.operator&&(this.parent.columnChooserSettings.operator="startsWith");var e={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return Object(m.W)()&&!this.parent.isJsComponent&&(e={requestType:"beforeOpenColumnChooser",cancel:!1,searchOperator:this.parent.columnChooserSettings.operator}),this.parent.trigger("beforeOpenColumnChooser",e),this.searchOperator=e.searchOperator,e}}]),e}()},Ns={provide:"GridsForeignKey",useValue:function(e){n(i,e);var t=s(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).parent=e,r.serviceLocator=n,r.initEvent(),r}return f(i,[{key:"initEvent",value:function(){this.parent.isDestroyed||(this.parent.on("initForeignKeyColumn",this.initForeignKeyColumns,this),this.parent.on("getForeignKeyData",this.getForeignKeyData,this),this.parent.on("generateQuery",this.generateQueryFormData,this))}},{key:"initForeignKeyColumns",value:function(e){for(var t=0;t<e.length;t++)e[t].dataSource=e[t].dataSource instanceof v.a?e[t].dataSource:Object(m.X)(e[t].dataSource)?new v.a:"result"in e[t].dataSource?e[t].dataSource:new v.a(e[t].dataSource)}},{key:"eventfPromise",value:function(e,t,i,n){var r=this.getStateEventArgument(t),s=new v.c,a=new v.c;r.action=e.action;var l=this.parent.getDataModule();return!Object(m.X)(e.action)&&e.action.requestType&&!1!==l.foreignKeyDataState.isDataChanged?(l.setForeignKeyDataState({isPending:!0,resolver:a.resolve}),a.promise.then((function(){s.resolve(n.dataSource)})),r.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger("columnDataStateChange",r)):(l.setForeignKeyDataState({}),s.resolve(i)),s}},{key:"getForeignKeyData",value:function(e){for(var t=this,i=e.column?[e.column]:this.parent.getForeignKeyColumns(),n=[],r=function(r){var s,a=e.isComplex?t.genarateColumnQuery(i[r]):t.genarateQuery(i[r],e.result.result,!1,!0);a.params=t.parent.query.params;var l=i[r].dataSource;s=l&&"result"in l?t.eventfPromise(e,a,l,i[r]).promise:!l.ready||l.dataSource.offline?l.executeQuery(a):l.ready.then((function(){return l.executeQuery(a)})),n.push(s)},s=0;s<i.length;s++)r(s);Promise.all(n).then((function(t){for(var n=0;n<t.length;n++)i[n].columnData=t[n].result,"dropdownedit"===i[n].editType&&"result"in i[n].dataSource&&(i[n].edit.params=Object(m.K)(i[n].edit.params,{dataSource:t[n].result,query:new v.g,fields:{value:i[n].foreignKeyField||i[n].field,text:i[n].foreignKeyValue}}));e.promise.resolve(e.result)})).catch((function(i){return t.parent.log(["actionfailure","foreign_key_failure"]),e.promise&&e.promise.reject&&e.promise.reject(i),i}))}},{key:"generateQueryFormData",value:function(e){e.predicate.predicate=this.genarateQuery(e.column,e.column.columnData,!0)}},{key:"genarateQuery",value:function(e,t,i,n){var r=this.parent,s=[],a=new v.g,l=i?e.foreignKeyField:e.field;if(r.allowPaging||r.enableVirtualization||i){t=new v.a(r.allowGrouping&&r.groupSettings.columns.length&&!i?t.records:t).executeLocal((new v.g).select(l));var o=v.b.distinct(t,l,!1);l=i?e.field:e.foreignKeyField;for(var h=0;h<o.length;h++)s.push(o[h]&&o[h].getDay?wi({field:l,operator:"equal",value:o[h],matchCase:!1}):new v.f(l,"equal",o[h],!1))}return n?s.length?a.where(v.f.or(s)):a:s.length?v.f.or(s):{predicates:[]}}},{key:"genarateColumnQuery",value:function(e){var t=this.parent,i=new v.g,n=this.isFiltered(e);if(n.isTrue&&(i=this.filterQuery(i,n.column,!0)),t.searchSettings.key.length){var r=t.searchSettings;e.dataSource instanceof v.a&&e.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===e.dataSource.adaptor.getModuleName()?i=this.searchQuery(i,e,!0):i.search(r.key,e.foreignKeyValue,r.operator,r.ignoreCase)}return i}},{key:"isFiltered",value:function(e){var t=this.parent.filterSettings.columns.filter((function(t){return t.field===e.foreignKeyValue&&t.uid===e.uid}));return{column:t,isTrue:!!t.length}}},{key:"getModuleName",value:function(){return"foreignKey"}},{key:"destroy",value:function(){this.destroyEvent()}},{key:"destroyEvent",value:function(){this.parent.isDestroyed||(this.parent.off("initForeignKeyColumn",this.initForeignKeyColumns),this.parent.off("getForeignKeyData",this.getForeignKeyData),this.parent.off("generateQuery",this.generateQueryFormData))}}]),i}(Y)},Ws={provide:"GridsBlazorAction",useValue:function(){function e(t){p(this,e),this.aria=new le,this.actionArgs={},this.virtualHeight=0,this.parent=t,this.addEventListener()}return f(e,[{key:"addEventListener",value:function(){this.parent.isDestroyed||(this.parent.on("detailclick",this.onDetailRowClick,this),this.parent.on("add-delete-success",this.addDeleteSuccess,this),this.parent.on("editsuccess",this.editSuccess,this),this.parent.on("setvisibility",this.setColumnVisibility,this),this.parent.on("offset",this.setServerOffSet,this),this.parent.on("updateaction",this.modelChanged,this),this.parent.on(P,this.modelChanged,this),this.parent.on("group-expand-collapse",this.onGroupClick,this),this.parent.on("setcolumnstyles",this.setColVTableWidthAndTranslate,this),this.parent.on("refresh-virtual-indices",this.invokeServerDataBind,this),this.parent.on("contentcolgroup",this.contentColGroup,this),this.parent.on("datasource-modified",this.dataSourceModified,this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off("detailclick",this.onDetailRowClick),this.parent.off("add-delete-success",this.addDeleteSuccess),this.parent.off("editsuccess",this.editSuccess),this.parent.off("setvisibility",this.setColumnVisibility),this.parent.off("offset",this.setServerOffSet),this.parent.off("updateaction",this.modelChanged),this.parent.off(P,this.modelChanged),this.parent.off("group-expand-collapse",this.onGroupClick),this.parent.off("setcolumnstyles",this.setColVTableWidthAndTranslate),this.parent.off("refresh-virtual-indices",this.invokeServerDataBind),this.parent.off("contentcolgroup",this.contentColGroup),this.parent.off("datasource-modified",this.dataSourceModified))}},{key:"getModuleName",value:function(){return"blazor"}},{key:"modelChanged",value:function(e){this.actionArgs=e,this.parent.currentAction=e}},{key:"addDeleteSuccess",value:function(e){var t,i=this;t={requestType:e.requestType,data:e.data,action:e.action},Object(m.X)(e.index)||(t.index=e.index),e.promise.then((function(e){return i.editSuccess(t)})).catch((function(e){if(Object(m.W)()&&i.parent.isServerRendered){Object(m.X)(e.error)||Object(m.X)(e.error.message)||(e.error=e.error.message)}i.parent.trigger("actionFailure",Object(m.W)()&&e instanceof Array?e[0]:e),i.parent.hideSpinner(),i.parent.log("actionfailure",{error:e})}))}},{key:"editSuccess",value:function(e){this.parent.renderModule.resetTemplates(),this.invokeServerDataBind(e)}},{key:"invokeServerDataBind",value:function(e){this.actionArgs=e,this.parent.currentAction=e,this.parent.allowServerDataBinding=!0,this.parent.serverDataBind(),this.parent.allowServerDataBinding=!1}},{key:"onDetailRowClick",value:function(e){var t=this.parent,i=e.parentElement,n=i.getAttribute("data-uid"),r=t.getRowObjectFromUID(n),s={uid:n,classList:e.classList[0],index:i.getAttribute("aria-rowindex"),rowIndex:t.getRowsObject().indexOf(r),colSpan:this.parent.getVisibleColumns().length};if(t.interopAdaptor.invokeMethodAsync("OnDetailClick",s),e.classList.contains("e-detailrowcollapse")){for(var a=t.getRowsObject(),l=r.data,o=this.parent.getRowUid("grid-row"),h=t.groupSettings.columns.length,c=new _({isDataRow:!0,isExpand:!0,uid:o,isDetailRow:!0,cells:[new Q({cellType:K.Indent}),new Q({isDataCell:!0,visible:!0})]}),u=0;u<h;u++)c.cells.unshift(new Q({cellType:K.Indent}));a.splice(s.rowIndex+1,0,c),t.trigger("detailDataBound",{data:l}),t.notify("detailDataBound",{rows:t.getRowsObject()}),r.isExpand=!0,this.aria.setExpand(e,!0)}else t.getRowsObject().splice(s.rowIndex+1,1),t.notify("detailDataBound",{rows:t.getRowsObject()}),r.isExpand=!1,this.aria.setExpand(e,!1)}},{key:"setColumnVisibility",value:function(e){for(var t={},i=0;i<e.length;i++)t[e[i].uid]=e[i].visible;this.parent.interopAdaptor.invokeMethodAsync("setColumnVisibility",{visible:t})}},{key:"dataSuccess",value:function(e){if(this.parent.enableVirtualization&&0===Object.keys(this.actionArgs).length&&(this.actionArgs.requestType="virtualscroll"),this.actionArgs.startIndex=e.startIndex,this.actionArgs.endIndex=e.endIndex,this.parent.enableVirtualization){if(this.virtualContentModule=this.parent.contentModule,"downArrow"===this.virtualContentModule.activeKey||"upArrow"===this.virtualContentModule.activeKey){var t=this.parent.getRowByIndex(this.virtualContentModule.blzRowIndex);t&&(this.parent.selectRow(parseInt(t.getAttribute("aria-rowindex"),10)),t.cells[0].focus({preventScroll:!0}))}this.virtualContentModule.blazorDataLoad=!1}if(e.foreignColumnsData)for(var i=this.parent.getColumns(),n=0;n<i.length;n++)e.foreignColumnsData[i[n].field]&&(i[n].columnData=e.foreignColumnsData[i[n].field]);if(this.parent.allowGrouping&&this.parent.groupSettings.columns){for(var r,s,a=[],l=this.parent.aggregates,o=0;o<l.length;o++)for(var h=l[o],c=0;c<h.columns.length;c++){var u;u={type:h.columns[c].type.toString().toLowerCase(),field:h.columns[c].field},a.push(u)}for(var d=this.parent.groupSettings.columns,p=0;p<d.length;p++)s=r||e.result,r=v.b.group(s,d[p],a,null,null);e.result=r||e.result}var g="offset";if(this.parent.rowUid=e.rowUid,e[g]=1===Math.sign(e[g])?-Math.abs(e[g]):Math.abs(e[g]),this.parent.offsetTime=e[g],this.parent.offsetTime!==(new Date).getTimezoneOffset()/60)if("Batch"!==this.parent.editSettings.mode){"edit"===this.actionArgs.action?this.setClientOffSet(e,this.actionArgs.rowIndex):"add"===this.actionArgs.action&&this.setClientOffSet(e,this.actionArgs.index)}else if("Batch"===this.parent.editSettings.mode){for(var f=this.parent.getPrimaryKeyFieldNames()[0],m=this.actionArgs.changes||{changedRecords:[],addedRecords:[]},b=0;b<m.changedRecords.length;b++)for(var y=0;y<e.result.length;y++)m.changedRecords[b][f]===e.result[y][f]&&this.setClientOffSet(e,y);for(var C=0;C<m.addedRecords.length;C++)for(var w=0;w<e.result.length;w++)m.addedRecords[C][f]===e.result[w][f]&&this.setClientOffSet(e,w)}this.parent.renderModule.dataManagerSuccess(e,this.actionArgs),this.parent.getMediaColumns(),this.parent.enableVirtualization&&(this.virtualContentModule=this.parent.contentModule,this.setColVTableWidthAndTranslate(),this.parent.groupSettings.columns.length&&this.virtualContentModule.setVirtualHeight(this.virtualHeight)),this.actionArgs=this.parent.currentAction={}}},{key:"removeDisplayNone",value:function(){for(var e=this.parent.getContentTable().querySelectorAll("tr"),t=0;t<e.length;t++)for(var i=e[t].querySelectorAll("td"),n=0;n<i.length;n++)i[n].style.display=""}},{key:"setVirtualTrackHeight",value:function(e){this.virtualHeight=e.VisibleGroupedRowsCount*this.parent.getRowHeight(),this.virtualContentModule.setVirtualHeight(this.virtualHeight)}},{key:"setColVTableWidthAndTranslate",value:function(e){if(this.parent.enableColumnVirtualization&&this.virtualContentModule.prevInfo&&JSON.stringify(this.virtualContentModule.currentInfo.columnIndexes)!==JSON.stringify(this.virtualContentModule.prevInfo.columnIndexes)||e&&e.refresh){var t=this.virtualContentModule.getColumnOffset(this.virtualContentModule.startColIndex-1),i=this.virtualContentModule.getColumnOffset(this.virtualContentModule.endColIndex-1)-t+"";this.virtualContentModule.header.virtualEle.setWrapperWidth(i),this.virtualContentModule.virtualEle.setWrapperWidth(i),this.virtualContentModule.header.virtualEle.adjustTable(t,0),this.parent.getContentTable().parentElement.style.width=i+"px"}this.dataSourceChanged&&(this.virtualContentModule.getPanel().firstElementChild.scrollTop=0,this.virtualContentModule.getPanel().firstElementChild.scrollLeft=0,this.virtualContentModule.header.virtualEle&&this.virtualContentModule.header.virtualEle.adjustTable(0,0),this.parent.getContentTable().parentElement.style.transform="translate(0px,0px)",this.virtualContentModule.refreshOffsets(),this.virtualContentModule.refreshVirtualElement(),this.dataSourceChanged=!1)}},{key:"dataSourceModified",value:function(){this.dataSourceChanged=!0}},{key:"setClientOffSet",value:function(e,t){var i=v.b.serverTimezoneOffset;v.b.serverTimezoneOffset=0,e.result[t]=v.b.parse.parseJson(JSON.stringify(e.result[t])),v.b.serverTimezoneOffset=i}},{key:"setServerOffSet",value:function(e){var t=v.b.serverTimezoneOffset,i=(new Date).getTimezoneOffset()/60*2+this.parent.offsetTime;v.b.serverTimezoneOffset=i,e.data=v.b.parse.parseJson(JSON.stringify(e.data)),v.b.serverTimezoneOffset=t}},{key:"onGroupClick",value:function(e){var t=this;e.exactTopIndex=Math.round(this.parent.element.querySelector(".e-content").scrollTop/this.parent.getRowHeight()),e.rowHeight=this.parent.getRowHeight(),this.parent.interopAdaptor.invokeMethodAsync("OnGroupExpandClick",e).then((function(){t.parent.contentModule.rowElements=[].slice.call(t.parent.getContentTable().querySelectorAll("tr.e-row[data-uid]"))}))}},{key:"setPersistData",value:function(e){var t=this.parent;t.mergePersistGridData(e),t.bulkChanges.columns&&delete t.bulkChanges.columns,t.headerModule.refreshUI(),t.notify("persist-data-changed",{}),t.notify("column-visible-changed",t.getColumns())}},{key:"resetPersistData",value:function(e){var t=this.parent,i=JSON.parse(e),n={filterSettings:i.filterSettings,groupSettings:i.groupSettings,pageSettings:i.pageSettings,sortSettings:i.sortSettings,searchSettings:i.searchSettings,columns:i.columns};n.sortSettings.columns||(n.sortSettings.columns=[]),n.groupSettings.columns||(n.groupSettings.columns=[]),n.pageSettings.currentPage||(t.pageSettings.currentPage=1);for(var r=0;r<t.columns.length;r++)t.groupSettings.columns.indexOf(t.columns[r].field)>-1&&(t.columns[r].visible=!0);t.mergePersistGridData(n),t.notify("persist-data-changed",{}),t.bulkChanges.columns&&delete t.bulkChanges.columns,t.headerModule.refreshUI();for(var s=0;s<t.columns.length;s++)t.columns[s].editType=t.columns[s].editType.toLowerCase();t.setProperties({filterSettings:{columns:[]}},!0)}},{key:"contentColGroup",value:function(){var e=this.parent,t=e.getContent().querySelector(".e-table");if(t.insertBefore(t.querySelector("#content-".concat(e.element.id,"colGroup")),t.querySelector("tbody")),e.frozenRows){var i=e.getHeaderContent().querySelector(".e-table");i.insertBefore(i.querySelector("#".concat(e.element.id,"colGroup")),i.querySelector("tbody"))}if(0!==e.getFrozenColumns()){var n=e.getContent().querySelector(".e-movablecontent").querySelector(".e-table");if(n.insertBefore(n.querySelector("#".concat(e.element.id,"colGroup")),n.querySelector("tbody")),e.frozenRows){var r=e.getHeaderContent().querySelector(".e-movableheader").querySelector(".e-table");r.insertBefore(r.querySelector("#".concat(e.element.id,"colGroup")),r.querySelector("tbody"))}}}},{key:"dataFailure",value:function(e){this.parent.renderModule.dataManagerFailure(e,this.actionArgs),this.actionArgs=this.parent.currentAction={}}},{key:"destroy",value:function(){this.removeEventListener()}}]),e}()},Xs={provide:"GridsInfiniteScroll",useValue:function(){function e(t,i){p(this,e),this.infiniteCache={},this.infiniteCurrentViewData={},this.infiniteFrozenCache={},this.isDownScroll=!1,this.isUpScroll=!1,this.isScroll=!0,this.enableContinuousScroll=!1,this.initialRender=!0,this.isRemove=!1,this.isInitialCollapse=!1,this.prevScrollTop=0,this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting"],this.keys=["downArrow","upArrow","PageUp","PageDown"],this.rowTop=0,this.isInitialMovableRender=!0,this.virtualInfiniteData={},this.isCancel=!1,this.emptyRowData={},this.isNormaledit=!1,this.isInfiniteScroll=!1,this.isLastPage=!1,this.isInitialRender=!0,this.parent=t,this.serviceLocator=i,this.isNormaledit="Normal"===this.parent.editSettings.mode,this.addEventListener(),this.widthService=i.getService("widthService"),this.rowModelGenerator=this.parent.isFrozenGrid()?new tr(this.parent):new $(this.parent)}return f(e,[{key:"getModuleName",value:function(){return"infiniteScroll"}},{key:"addEventListener",value:function(){this.parent.on(T,this.onDataReady,this),this.parent.on("datasource-modified",this.dataSourceModified,this),this.parent.on("infinite-page-query",this.infinitePageQuery,this),this.parent.on("infinite-scroll-handler",this.infiniteScrollHandler,this),this.parent.on("beforecellfocused",this.infiniteCellFocus,this),this.parent.on("append-infinite-content",this.appendInfiniteRows,this),this.parent.on("remove-infinite-rows",this.removeInfiniteCacheRows,this),this.parent.on("reset-infinite-blocks",this.resetInfiniteBlocks,this),this.parent.on("set-infinite-cache",this.setCache,this),this.parent.on("initial-collapse",this.ensureIntialCollapse,this),this.parent.on(V,this.infiniteCellFocus,this),this.parent.on("infinite-show-hide",this.setDisplayNone,this),this.parent.on("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent.on("get-virtual-data",this.getVirtualInfiniteData,this),this.parent.on("edit-reset",this.resetInfiniteEdit,this),this.parent.on("virtual-scroll-edit-success",this.infiniteEditSuccess,this),this.parent.on("refresh-virtual-cache",this.refreshInfiniteCache,this),this.parent.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.on("virtual-scroll-add-action-begin",this.infiniteAddActionBegin,this),this.parent.on(P,this.modelChanged,this),this.parent.on("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData,this),this.parent.on("delete-complete",this.deleteComplate,this),this.parent.addEventListener(D,this.actionBegin.bind(this)),this.parent.addEventListener(E,this.actionComplete.bind(this))}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||(this.parent.off(T,this.onDataReady),this.parent.off("datasource-modified",this.dataSourceModified),this.parent.off("infinite-page-query",this.infinitePageQuery),this.parent.off("infinite-scroll-handler",this.infiniteScrollHandler),this.parent.off("beforecellfocused",this.infiniteCellFocus),this.parent.off("append-infinite-content",this.appendInfiniteRows),this.parent.off("remove-infinite-rows",this.removeInfiniteCacheRows),this.parent.off("reset-infinite-blocks",this.resetInfiniteBlocks),this.parent.off("set-infinite-cache",this.setCache),this.parent.off("initial-collapse",this.ensureIntialCollapse),this.parent.off(V,this.infiniteCellFocus),this.parent.off("infinite-show-hide",this.setDisplayNone),this.parent.off("virtual-scroll-edit-action-begin",this.editActionBegin),this.parent.off("get-virtual-data",this.getVirtualInfiniteData),this.parent.off("edit-reset",this.resetInfiniteEdit),this.parent.off("virtual-scroll-edit-success",this.infiniteEditSuccess),this.parent.off("refresh-virtual-cache",this.refreshInfiniteCache),this.parent.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off("virtual-scroll-add-action-begin",this.infiniteAddActionBegin),this.parent.off(P,this.modelChanged),this.parent.off("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData),this.parent.removeEventListener(D,this.actionBegin.bind(this)),this.parent.removeEventListener(E,this.actionComplete.bind(this)))}},{key:"updateCurrentViewData",value:function(){var e=this.parent;if(!e.groupSettings.columns.length){var t=Object.keys(this.infiniteCurrentViewData);e.currentViewData=[];for(var i=e.pageSettings.currentPage,n=e.infiniteScrollSettings.enableCache,r=e.infiniteScrollSettings.maxBlocks,s=n&&(i>r||this.isUpScroll&&i>1),a=s?this.isUpScroll?i:i-r+1:1,l=s?a+r-1:n?r:t.length,o=a;o<=l;o++)this.infiniteCurrentViewData[o]&&(e.currentViewData=e.currentViewData.concat(this.infiniteCurrentViewData[o]))}}},{key:"refreshInfiniteCurrentViewData",value:function(e){var t=this.parent.pageSettings.currentPage,i=this.parent.pageSettings.pageSize,n=this.parent.infiniteScrollSettings.initialBlocks,r=Object.keys(this.infiniteCurrentViewData),s=this.parent.infiniteScrollSettings.enableCache;if(!this.parent.groupSettings.columns.length){var a="save"===e.args.requestType,l="delete"===e.args.requestType;s||!a&&!l?e.data.length===n*i?this.setInitialCache(e.data.slice(),{},s&&"delete"===e.args.requestType,!0):this.infiniteCurrentViewData[t]=e.data.slice():a?this.infiniteCurrentViewData[1]=e.data.concat(this.infiniteCurrentViewData[1]):this.infiniteCurrentViewData[r[r.length-1]].push(e.data[0])}}},{key:"deleteComplate",value:function(){this.parent.isFrozenGrid()&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.contentModule.refreshScrollOffset()}},{key:"modelChanged",value:function(e){if("infiniteScroll"!==e.requestType&&("delete"===e.requestType||"add"===this.requestType)){var t=this.parent.getRows();if(this.firstIndex=parseInt(t[0].getAttribute("aria-rowindex"),10),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=parseInt(t[t.length-1].getAttribute("aria-rowindex"),10),"delete"===e.requestType){var i=this.parent.getRowsObject();e.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:i[i.length-1].index}else e.startIndex=this.firstIndex;this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==e.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1)}}},{key:"infiniteAddActionBegin",value:function(e){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(e.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))}},{key:"infiniteEditHandler",value:function(e){if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===e.e.requestType||"save"===e.e.requestType&&"add"===this.requestType)){var t=this.parent.isFrozenGrid(),i=this.parent.getRows(),n=this.parent.getRowsObject();if(this.ensureRowAvailability(n,e.result[0])){if(this.resetRowIndex(n,e.e,i,"add"===this.requestType,!0),t){var r=this.parent.getMovableRowsObject();if(this.resetRowIndex(r,e.e,this.parent.getMovableDataRows(),"add"===this.requestType),"Left-Right"===this.parent.getFrozenMode()){var s=this.parent.getFrozenRightRowsObject();this.resetRowIndex(s,e.e,this.parent.getFrozenRightRows(),"add"===this.requestType)}}if(this.isLastPage){if(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows){if(Object(m.hb)(i[this.parent.frozenRows-1]),this.createRow([n[this.parent.frozenRows-1]],e,!1,!0),t){var a=this.parent.getMovableDataRows();if(Object(m.hb)(a[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],e,!0,!0),"Left-Right"===this.parent.getFrozenMode()){var l=this.parent.getFrozenRightDataRows();Object(m.hb)(l[this.parent.frozenRows]),this.createRow([this.parent.getFrozenRightRowsObject()[this.parent.frozenRows-1]],e,!1,!0,!0)}}Vi(this.parent)}}else this.createRow(n,e)}this.parent.hideSpinner(),this.parent.notify("delete"===this.requestType?"delete-complete":"save-complete",e.e)}this.parent.notify("freezerender",{case:"refreshHeight"})}},{key:"createRow",value:function(e,t,i,n,r){var s,a=n?e:this.generateRows(t.result,t.e),l=new Z(this.serviceLocator,null,this.parent);s=r?this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody"):this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualContent().querySelector("tbody"):this.parent.getFrozenVirtualContent().querySelector("tbody"):this.parent.getContent().querySelector("tbody"),this.parent.frozenRows&&(s=n&&"add"!==this.requestType||!n&&"add"===this.requestType?this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualHeader().querySelector("tbody"):r?this.parent.element.querySelector(".e-frozen-right-header").querySelector("tbody"):this.parent.getFrozenVirtualHeader().querySelector("tbody"):this.parent.getHeaderContent().querySelector("tbody"):s);for(var o=a.length-1;o>=0;o--)"delete"===this.requestType?s.appendChild(l.render(a[o],this.parent.getColumns())):s.insertBefore(l.render(a[o],this.parent.getColumns()),s.firstElementChild);if(!n&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)){var h=i?this.parent.getMovableDataRows():r?this.parent.getFrozenRightDataRows():this.parent.getRows(),c=(i||r)&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1;Object(m.hb)(h[c]),this.createRow([e[this.parent.frozenRows-1]],t,i,!0,r)}this.parent.infiniteScrollSettings.enableCache||n||(r?(Vi(this.parent),this.parent.contentModule.rightFreezeRows="add"===this.requestType?a.concat(e):e.concat(a)):!this.parent.isFrozenGrid()||i?(Vi(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?a.concat(e):e.concat(a),"Left-Right"===this.parent.getFrozenMode()&&this.createRow(this.parent.getFrozenRightRowsObject(),t,!1,!1,!0)):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?a.concat(e):e.concat(a),this.createRow(this.parent.getMovableRowsObject(),t,!0)))}},{key:"ensureRowAvailability",value:function(e,t){var i=!0;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType)for(var n=this.parent.getPrimaryKeyFieldNames()[0],r=0;r<e.length;r++)if(e[r].data[n]===t[n]){i=!1;break}return i}},{key:"generateRows",value:function(e,t){return this.rowModelGenerator.generateRows(e,t)}},{key:"resetRowIndex",value:function(e,t,i,n,r){var s=this,a=this.parent.getPrimaryKeyFieldNames()[0];n?!(i.length%this.parent.pageSettings.pageSize)&&(r&&!this.parent.groupSettings.columns.length&&this.swapCurrentViewData(1,!0),Object(m.hb)(i[e.length-1]),i.splice(e.length-1,1),e.splice(e.length-1,1)):e.filter((function(n,l){if(n.data[a]===t.data[0][a]){if(r&&!s.parent.groupSettings.columns.length){var o=Math.ceil((l+1)/s.parent.pageSettings.pageSize);s.resetInfiniteCurrentViewData(o,l)}e.splice(l,1),Object(m.hb)(i[l]),i.splice(l,1)}})),Pi(this.parent,e,i,n?1:0)}},{key:"resetInfiniteCurrentViewData",value:function(e,t){this.infiniteCurrentViewData[e].splice(t-=(e-1)*this.parent.pageSettings.pageSize,1),this.swapCurrentViewData(e,!1)}},{key:"swapCurrentViewData",value:function(e,t){for(var i=Object.keys(this.infiniteCurrentViewData),n=t?i.length+1:i.length,r=e;r<n;r++)if(this.infiniteCurrentViewData[r+1]){var s=this.infiniteCurrentViewData[t?r:r+1].splice(t?this.infiniteCurrentViewData[r].length-1:0,1);t?(this.infiniteCurrentViewData[r+1]=s.concat(this.infiniteCurrentViewData[r+1]),r+1===n-1&&this.infiniteCurrentViewData[r+1].splice(this.infiniteCurrentViewData[r+1].length-1,1)):this.infiniteCurrentViewData[r].push(s[0])}this.updateCurrentViewData()}},{key:"setDisplayNone",value:function(e){if(this.parent.infiniteScrollSettings.enableCache){for(var t=this.parent.isFrozenGrid(),i=Object.keys(t?this.infiniteFrozenCache:this.infiniteCache),n=1;n<=i.length;n++)(t?e.isFreeze?this.infiniteFrozenCache[n][0]:this.infiniteFrozenCache[n][1]:this.infiniteCache[n]).filter((function(t){t.cells[e.index].visible=""===e.visible}));this.resetContentModuleCache(t?this.infiniteFrozenCache:this.infiniteCache)}}},{key:"refreshInfiniteCache",value:function(e){this.getEditedRowObject().data=e}},{key:"getEditedRowObject",value:function(){for(var e,t=this.parent.getRowsObject(),i=0;i<t.length;i++)t[i].index===this.editRowIndex&&(e=t[i]);return e}},{key:"infiniteEditSuccess",value:function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewRecords(e.data),this.isAdd=!1)}},{key:"updateCurrentViewRecords",value:function(e){var t=zi(this.parent,e);Object(m.X)(t)||(this.parent.getCurrentViewRecords()[t]=e)}},{key:"actionBegin",value:function(e){"add"!==e.requestType&&"delete"!==e.requestType||(this.requestType=e.requestType),(this.parent.isFrozenGrid()&&!e.cancel&&"searching"===e.requestType||"sorting"===e.requestType||"filtering"===e.requestType)&&(this.isInitialRender=!0)}},{key:"actionComplete",value:function(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.requestType=this.empty,this.isCancel="cancel"===e.requestType||"save"===e.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))}},{key:"resetInfiniteEdit",value:function(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)}},{key:"getVirtualInfiniteData",value:function(e){e.virtualData=this.virtualInfiniteData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}},{key:"editActionBegin",value:function(e){this.isEdit=!0,this.editRowIndex=e.index;var t=Object(m.K)({},this.getEditedRowObject().data);e.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:t}},{key:"dataSourceModified",value:function(){this.resetInfiniteBlocks({requestType:this.empty},!0)}},{key:"onDataReady",value:function(e){Object(m.X)(e.count)||(this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize))}},{key:"ensureIntialCollapse",value:function(e){this.isInitialCollapse=!e}},{key:"infiniteScrollHandler",value:function(e){var t=this;this.restoreInfiniteEdit(),this.restoreInfiniteAdd();var i=e.target;if(i.classList.contains("e-content")&&this.parent.enableInfiniteScrolling){var n=this.parent.getContent().firstElementChild;this.prevScrollTop=n.scrollTop;var r,s=this.parent.getRows(),a=parseInt(s[s.length-1].getAttribute("aria-rowindex"),10)+1,l=this.parent.pageSettings.currentPage,o=i.scrollHeight-i.scrollTop,h=Math.round(i.scrollHeight-i.scrollTop),c=(o<i.clientHeight?Math.ceil(o):Math.floor(o))===i.clientHeight||h===i.clientHeight;if(this.isScroll&&c&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0,setTimeout((function(){t.isScroll=!0}),600));var u=[].slice.call(n.querySelectorAll(".e-row:not(.e-addedrow)")),d=parseInt(u[u.length-1].getAttribute("aria-rowindex"),10);this.parent.pageSettings.currentPage=Math.ceil(d/this.parent.pageSettings.pageSize)+1,r={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:a,direction:"down"},this.makeRequest(r)}if(this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===i.scrollTop&&1!==this.parent.pageSettings.currentPage){this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0,setTimeout((function(){t.isScroll=!0}),600));var p=[].slice.call(n.querySelectorAll(".e-row")),g=parseInt(p[this.parent.pageSettings.pageSize-1].getAttribute("aria-rowindex"),10),f=parseInt(p[0].getAttribute("aria-rowindex"),10)-this.parent.pageSettings.pageSize;this.parent.pageSettings.currentPage=Math.ceil(g/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(r={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:f,direction:"up"},this.makeRequest(r))}this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&Object(m.X)(r)&&(this.isDownScroll||this.isUpScroll)&&(n.scrollTop=this.top)}}},{key:"makeRequest",value:function(e){var t=this;this.parent.pageSettings.currentPage!==e.prevPage&&(this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,Object(m.X)(this.infiniteCache[e.currentPage])?setTimeout((function(){t.getVirtualInfiniteEditedData(),t.parent.notify("model-changed",e)}),100):setTimeout((function(){t.getVirtualInfiniteEditedData(),t.parent.notify("refresh-infinite-mode-blocks",e)}),100)):this.parent.pageSettings.currentPage=this.maxPage)}},{key:"infinitePageQuery",value:function(e){this.initialRender?(this.initialRender=!1,this.intialPageQuery(e)):this.isInfiniteScroll||"delete"!==this.requestType&&"add"!==this.requestType?e.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(e)}},{key:"editPageQuery",value:function(e){var t=this.parent.infiniteScrollSettings.initialBlocks;this.parent.infiniteScrollSettings.enableCache?(this.infiniteCache={},this.infiniteFrozenCache={},this.infiniteCurrentViewData={},e.skip(this.firstIndex),e.take(t*this.parent.pageSettings.pageSize)):("Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection(),e.skip("delete"===this.requestType?this.lastIndex:this.firstIndex),e.take(1))}},{key:"intialPageQuery",value:function(e){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks),e.page(1,this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks)}},{key:"infiniteCellFocus",value:function(e){if(!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action)"PageDown"!==e.key&&"PageUp"!==e.key||(this.pressedKey=e.key);else{this.pressedKey=e.keyArgs.action;var t=document.activeElement,i=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),n=this.parent.getContent().firstElementChild;this.rowIndex="downArrow"===e.keyArgs.action?i+1:i-1,this.cellIndex=parseInt(t.getAttribute("aria-colindex"),10);var r=this.parent.getRowByIndex(i),s=Math.floor(n.offsetHeight/this.parent.getRowHeight());if(!r||Ti(r,this.parent)||Ai(r,this.rowTop)){var a=r?r.getBoundingClientRect().height:this.parent.getRowHeight();if(!this.parent.infiniteScrollSettings.enableCache){if("downArrow"===e.keyArgs.action&&(Ti(r,this.parent)||!r)){var l=(this.rowIndex-s)*a,o=n.scrollTop+this.parent.getRowHeight();n.scrollTop=l<o?o:l}"upArrow"===e.keyArgs.action&&Ai(r,this.rowTop)&&(n.scrollTop=this.rowIndex*a)}}else this.pressedKey=this.empty}}},{key:"createEmptyRowdata",value:function(){var e=this;this.parent.getColumns().filter((function(t){e.emptyRowData[t.field]=e.empty}))}},{key:"getVirtualInfiniteEditedData",value:function(){var e=this.parent.element.querySelector(".e-editedrow"),t=this.parent.element.querySelector(".e-addedrow"),i=this.parent.element.querySelector(".e-gridform");if(this.parent.infiniteScrollSettings.enableCache&&(e||t)){var n=e?Object(m.K)({},this.getEditedRowObject().data):Object(m.K)({},this.emptyRowData);this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(i,n),this.parent.isFrozenGrid()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),n))}}},{key:"restoreInfiniteEdit",value:function(){var e=this.parent.getContent().firstElementChild;if(this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&(!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows)&&this.parent.editSettings.allowEditing&&!Object(m.X)(this.editRowIndex)){var t=this.parent.getRowByIndex(this.editRowIndex);if(Object.keys(this.virtualInfiniteData).length&&t&&!this.parent.getContent().querySelector(".e-editedrow")){var i=t.getBoundingClientRect().top;i<e.offsetHeight&&i>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(t))}}}},{key:"restoreInfiniteAdd",value:function(){var e=this.parent.getContent().firstElementChild;this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!e.querySelector(".e-addedrow")&&e.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord())}},{key:"appendInfiniteRows",value:function(e){document;var t,i=this.parent.isFrozenGrid(),n=this.parent.getContent().firstElementChild,r=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType,s="Left-Right"===this.parent.getFrozenMode()&&"movable"===e.tableName;if((!r||e.args.isFrozen||s)&&r||(r&&"up"===e.args.direction?e.tbody.insertBefore(e.frag,e.tbody.firstElementChild):e.tbody.appendChild(e.frag)),i)if(r)if("frozen-left"===e.tableName||"Right"===this.parent.getFrozenMode()&&"frozen-right"===e.tableName)this.frozenFrag=e.frag;else if("Left-Right"===this.parent.getFrozenMode()&&"movable"===e.tableName)this.movableFrag=e.frag;else{var a=this.parent.getFrozenVirtualContent().querySelector("tbody");"up"===e.args.direction?a.insertBefore(this.frozenFrag,a.firstElementChild):a.appendChild(this.frozenFrag),"frozen-right"===e.tableName?(this.parent.getMovableVirtualContent().querySelector("tbody").appendChild(this.movableFrag),this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody").appendChild(e.frag)):this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(e.tbody),this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData()}else"frozen-left"===e.tableName?t=this.parent.getFrozenVirtualContent().querySelector(".e-table"):"movable"===e.tableName?(t=this.parent.getMovableVirtualContent().querySelector(".e-table"),"Left-Right"!==this.parent.getFrozenMode()&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())):(t=this.parent.element.querySelector(".e-frozen-right-content").querySelector(".e-table"),"Left-Right"===this.parent.getFrozenMode()&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())),t.appendChild(e.tbody),this.widthService.refreshFrozenScrollbar();else this.parent.contentModule.getTable().appendChild(e.tbody),this.updateCurrentViewData();this.isInitialRender&&!e.args.isFrozen&&(this.isInitialRender=!1,this.parent.scrollModule.setHeight()),e.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,r&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(n.scrollTop=this.top),Vi(this.parent),this.selectNewRow(e.tbody,e.args.startIndex),this.pressedKey=void 0),this.restoreInfiniteAdd()),this.isInfiniteScroll=!1}},{key:"selectNewRow",value:function(e,t){var i=this,n=this.parent.getRowByIndex(this.rowIndex);if(this.keys.some((function(e){return e===i.pressedKey}))){if(("downArrow"===this.pressedKey||this.parent.infiniteScrollSettings.enableCache&&"upArrow"===this.pressedKey)&&setTimeout((function(){n.cells[0].focus({preventScroll:!0}),i.parent.selectRow(i.rowIndex),i.parent.getContent().firstElementChild.scrollTop+=i.parent.getRowHeight()}),0),"PageDown"===this.pressedKey){var r=this.parent.getRowByIndex(t);r&&r.cells[0].focus()}"PageUp"===this.pressedKey&&e.querySelector(".e-row").cells[0].focus()}}},{key:"removeInfiniteCacheRows",value:function(e){if(!e.args.isFrozen&&this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove){var t=[].slice.call(this.parent.getContentTable().querySelectorAll(".e-row"));if("down"===e.args.direction){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){var i=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(i,e.args)}var n=this.parent.element.querySelector(".e-addedrow")?0:1;this.removeTopRows(t,this.parent.pageSettings.pageSize-n)}if("up"===e.args.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){var r=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(r,e.args)}else this.removeBottomRows(t,t.length-1,e.args);this.isScroll=!1,this.top=this.calculateScrollTop(e.args)}}},{key:"calculateScrollTop",value:function(e){var t=0,i=this.parent.getContent().firstElementChild;if("down"===e.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(t=this.captionRowHeight());var n=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)")),r=0;this.isInitialCollapse&&!Object(m.X)(n)&&(r=Math.round((n.length-1)/this.parent.groupSettings.columns.length));for(var s=r||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),a=0,l=0;a<i.clientHeight;)a=++l*this.parent.getRowHeight();t+=(s-(l-=1))*this.parent.getRowHeight()}if("up"===e.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)t=this.infiniteCache[this.parent.pageSettings.currentPage].length*this.parent.getRowHeight();else if(this.isInitialCollapse){for(var o=this.infiniteCache[this.parent.pageSettings.currentPage],h=0,c=0;c<o.length;c++)o[c].isCaptionRow&&h++;t+=Math.round(h/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else t+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+ni();return t}},{key:"captionRowHeight",value:function(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()}},{key:"removeTopRows",value:function(e,t){for(var i=this.parent.isFrozenGrid(),n="Left-Right"===this.parent.getFrozenMode()?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").querySelectorAll(".e-row")):null,r=i?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null,s=0;s<=t;s++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&s>t-this.parent.frozenRows||(Object(m.hb)(e[s]),r&&Object(m.hb)(r[s]),n&&Object(m.hb)(n[s]))}},{key:"removeBottomRows",value:function(e,t,i){var n=0,r=this.parent.isFrozenGrid(),s=r?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null,a="Left-Right"===this.parent.getFrozenMode()?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").querySelectorAll(".e-row")):null,l=this.parent.pageSettings.pageSize;!r&&this.infiniteCache[i.prevPage].length<l&&(n=this.parent.pageSettings.pageSize-this.infiniteCache[i.prevPage].length),r&&this.infiniteFrozenCache[i.prevPage][1].length<l&&(n=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[i.prevPage][1].length);for(var o=t;n<l;o--)n++,Object(m.hb)(e[o]),s&&Object(m.hb)(s[o]),a&&Object(m.hb)(a[o])}},{key:"removeCaptionRows",value:function(e,t){if("down"===t.direction)for(var i=this.parent.getRows()[this.parent.pageSettings.pageSize],n=parseInt(i.getAttribute("aria-rowindex"),10)-1,r=0,s=0;r<n;s++)e[s].classList.contains("e-row")?r=parseInt(e[s].getAttribute("aria-rowindex"),10):Object(m.hb)(e[s]);if("up"===t.direction){for(var a=[].slice.call(this.parent.getContent().querySelectorAll(".e-row")),l=parseInt(a[a.length-1].getAttribute("aria-rowindex"),10),o=Math.ceil(l/this.parent.pageSettings.pageSize),h=0,c=this.parent.pageSettings.currentPage+1;c<o;c++)h+=this.infiniteCache[c].length;for(var u=h;u<e.length;u++)Object(m.hb)(e[u])}}},{key:"resetInfiniteBlocks",value:function(e,t){var i=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==e.requestType;if(!this.initialRender&&!Object(m.X)(this.parent.infiniteScrollModule)&&i&&(this.actions.some((function(t){return t===e.requestType}))||t)){var n=this.parent.getContent().firstElementChild;this.initialRender=!0,n.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.infiniteCurrentViewData={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[]}}},{key:"setCache",value:function(e){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){var t=this.parent.isFrozenGrid(),i=e.args.isFrozen?1:0,n="infiniteScroll"!==e.args.requestType&&("delete"===this.requestType||"add"===this.requestType),r=this.parent.pageSettings.currentPage;(t&&this.isInitialMovableRender||!t&&!Object.keys(this.infiniteCache).length||n)&&(this.isInitialMovableRender=!e.args.isFrozen,this.setInitialCache(e.modelData,e.args,n)),!t&&Object(m.X)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=e.modelData,this.resetContentModuleCache(this.infiniteCache)),t&&(0===i&&Object(m.X)(this.infiniteFrozenCache[r])||!this.infiniteFrozenCache[r][i].length)&&(this.createFrozenCache(r),this.infiniteFrozenCache[r][i]=e.modelData,1===i&&this.resetContentModuleCache(this.infiniteFrozenCache)),e.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(r-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}}},{key:"setInitialCache",value:function(e,t,i,n){for(var r=this.parent.isFrozenGrid(),s=t.isFrozen?1:0,a=i?this.firstBlock:1,l=1;l<=this.parent.infiniteScrollSettings.initialBlocks;l++){var o=(l-1)*this.parent.pageSettings.pageSize,h=l*this.parent.pageSettings.pageSize;this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!n?this.setInitialGroupCache(e,a,o,h):n?this.infiniteCurrentViewData[a]=e.slice(o,h):r?(this.createFrozenCache(a),this.infiniteFrozenCache[a][s]=e.slice(o,h),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[a]=e.slice(o,h),this.resetContentModuleCache(this.infiniteCache)),a++}}},{key:"createFrozenCache",value:function(e){this.infiniteFrozenCache[e]||(this.infiniteFrozenCache[e]=[[],[]])}},{key:"setInitialGroupCache",value:function(e,t,i,n){for(var r=[],s=0,a=1;a<=Object.keys(this.infiniteCache).length;a++)s+=this.infiniteCache[a].length;for(var l=i,o=s;o<e.length&&l<n&&((e[o].index<n||e[o].isCaptionRow)&&(l=e[o].isCaptionRow?l:e[o].index,r.push(e[o])),!(e[o].index>=n||e[o].index===n-1));o++);this.infiniteCache[t]=r,this.resetContentModuleCache(this.infiniteCache)}},{key:"resetContentModuleCache",value:function(e){this.parent.contentModule.infiniteCache=e}},{key:"destroy",value:function(){this.removeEventListener()}}]),e}()},Gs={provide:"GridsLazyLoadGroup",useValue:function(){function e(t,i){p(this,e),this.parent=t,this.serviceLocator=i,this.addEventListener()}return f(e,[{key:"getModuleName",value:function(){return"lazyLoadGroup"}},{key:"addEventListener",value:function(){this.parent.isDestroyed||this.parent.on(M,this.instantiateRenderer,this)}},{key:"removeEventListener",value:function(){this.parent.isDestroyed||this.parent.off(M,this.instantiateRenderer)}},{key:"instantiateRenderer",value:function(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());var e=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&e.addRenderer(U.Content,new Lr(this.parent,this.serviceLocator))}},{key:"destroy",value:function(){this.removeEventListener()}}]),e}()},Ks=((Mr=function e(){p(this,e)}).\u0275mod=d.Lb({type:Mr}),Mr.\u0275inj=d.Kb({factory:function(e){return new(e||Mr)},providers:[ws,ks,Ss,Os,xs,js,Rs,Ds,Es,Is,Ms,Fs,Ts,As,zs,Ls,Bs,Ps,qs,Vs,Hs,Ns,Ws,Xs,Gs],imports:[[Br.b,Cs],Cs]}),Mr),Us=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Ys=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_s=["click","created","dropDownChanged"],Qs=[],Js=((Ar=function(e){n(i,e);var t=s(i);function i(e,n,r,s){var a;return p(this,i),(a=t.call(this)).ngEle=e,a.srenderer=n,a.viewContainerRef=r,a.injector=s,a.element=a.ngEle.nativeElement,a.injectedModules=a.injectedModules||[],a.registerEvents(_s),a.addTwoWay.call(l(a),Qs),Object(g.g)("currentInstance",l(a),a.viewContainerRef),a.context=new g.c,a}return f(i,[{key:"ngOnInit",value:function(){this.context.ngOnInit(this)}},{key:"ngAfterViewInit",value:function(){this.context.ngAfterViewInit(this)}},{key:"ngOnDestroy",value:function(){this.context.ngOnDestroy(this)}},{key:"ngAfterContentChecked",value:function(){this.context.ngAfterContentChecked(this)}}]),i}(hn)).\u0275fac=function(e){return new(e||Ar)(d.Nb(d.l),d.Nb(d.D),d.Nb(d.O),d.Nb(d.r))},Ar.\u0275cmp=d.Hb({type:Ar,selectors:[["ejs-pager"]],contentQueries:function(e,t,i){var n;1&e&&d.Gb(i,Pr,!0),2&e&&d.xc(n=d.fc())&&(t.template=n.first)},inputs:{currentPage:"currentPage",customText:"customText",enableExternalMessage:"enableExternalMessage",enablePagerMessage:"enablePagerMessage",enablePersistence:"enablePersistence",enableQueryString:"enableQueryString",enableRtl:"enableRtl",externalMessage:"externalMessage",locale:"locale",pageCount:"pageCount",pageSize:"pageSize",pageSizes:"pageSizes",template:"template",totalRecordsCount:"totalRecordsCount"},outputs:{click:"click",created:"created",dropDownChanged:"dropDownChanged"},features:[d.ub],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),Us([Object(g.f)(),Ys("design:type",Object)],Ar.prototype,"template",void 0),Ar=Us([Object(g.d)([g.c]),Ys("design:paramtypes",[d.l,d.D,d.O,d.r])],Ar)),Zs=((Tr=function e(){p(this,e)}).\u0275mod=d.Lb({type:Tr}),Tr.\u0275inj=d.Kb({factory:function(e){return new(e||Tr)},imports:[[Br.b]]}),Tr),$s=((Fr=function e(){p(this,e)}).\u0275mod=d.Lb({type:Fr}),Fr.\u0275inj=d.Kb({factory:function(e){return new(e||Fr)},providers:[],imports:[[Br.b,Zs],Zs]}),Fr)},gnsf:function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"e",(function(){return x})),r.d(t,"b",(function(){return E})),r.d(t,"c",(function(){return _})),r.d(t,"f",(function(){return ne})),r.d(t,"d",(function(){return pe}));var a,l=r("4SUy"),h=r("Naoh"),u=r("ngVE"),d=r("TF3C"),g=r("72GX"),m=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},v="e-other-month",b="e-calendar",y="e-disabled",C="e-overlay",w="e-selected",k="e-focused-date",S=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).effect="",n.isPopupClicked=!1,n.isDateSelected=!0,n.isTodayClicked=!1,n.preventChange=!1,n.isAngular=!1,n}return f(r,[{key:"render",value:function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),"Islamic"===this.calendarMode&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new l.n(this.locale),(Object(l.X)(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date((new Date).setHours(0,0,0,0)),"calendar"===this.getModuleName()?(this.element.classList.add(b),this.enableRtl&&this.element.classList.add("e-rtl"),l.d.isDevice&&this.element.classList.add("e-device"),Object(l.x)(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(b),this.enableRtl&&this.calendarElement.classList.add("e-rtl"),l.d.isDevice&&this.calendarElement.classList.add("e-device"),Object(l.x)(this.calendarElement,{role:"calendar"})),this.createHeader(),this.createContent(),this.wireEvents()}},{key:"rangeValidation",value:function(e,t){Object(l.X)(e)&&this.setProperties({min:new Date(1900,0,1)},!0),Object(l.X)(t)&&this.setProperties({max:new Date(2099,11,31)},!0)}},{key:"getDefaultKeyConfig",value:function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs}},{key:"validateDate",value:function(e){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date((new Date).setHours(0,0,0,0)),!Object(l.X)(e)&&this.min<=this.max&&e>=this.min&&e<=this.max&&(this.currentDate=new Date(this.checkValue(e)))}},{key:"setOverlayIndex",value:function(e,t,i,n){if(n&&!Object(l.X)(t)&&!Object(l.X)(i)&&!Object(l.X)(e)){var r=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(r-1).toString(),e.style.zIndex=r.toString()}}},{key:"minMaxUpdate",value:function(e){+this.min<=+this.max?Object(l.ib)([this.element],C):(this.setProperties({min:this.min},!0),Object(l.v)([this.element],C)),this.min=Object(l.X)(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=Object(l.X)(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&e&&+e<=+this.max&&+e>=+this.min?this.currentDate=new Date(this.checkValue(e)):+this.min<=+this.max&&!e&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))}},{key:"createHeader",value:function(){this.headerElement=this.createElement("div",{className:"e-header"});var e=this.createElement("div",{className:"e-icon-container"});this.previousIcon=this.createElement("button",{className:"e-prev",attrs:{type:"button"}}),Object(l.kb)(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),Object(l.x)(this.previousIcon,{"aria-disabled":"false","aria-label":"previous month"}),this.nextIcon=this.createElement("button",{className:"e-next",attrs:{type:"button"}}),Object(l.kb)(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),Object(l.x)(this.nextIcon,{"aria-disabled":"false","aria-label":"next month"}),this.headerTitleElement=this.createElement("div",{className:"e-day e-title"}),Object(l.x)(this.headerTitleElement,{"aria-atomic":"true","aria-live":"assertive","aria-label":"title"}),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:"e-date-icon-prev e-icons"})),this.nextIcon.appendChild(this.createElement("span",{className:"e-date-icon-next  e-icons"})),e.appendChild(this.previousIcon),e.appendChild(this.nextIcon),this.headerElement.appendChild(e),"calendar"===this.getModuleName()?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()}},{key:"createContent",value:function(){this.contentElement=this.createElement("div",{className:"e-content"}),this.table=this.createElement("table",{attrs:{tabIndex:"0",role:"grid","aria-activedescendant":""}}),"calendar"===this.getModuleName()?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter()}},{key:"getCultureValues",value:function(){var e,t=[],i=(Object(l.W)()?"days.":"days.stand-alone.")+this.dayHeaderFormat.toLowerCase();e="en"===this.locale||"en-US"===this.locale?Object(l.V)(i,Object(l.N)()):this.getCultureObjects(l.B,""+this.locale);for(var n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];t.push(Object(l.V)(s,e))}return t}},{key:"toCapitalize",value:function(e){return!Object(l.X)(e)&&e.length?e[0].toUpperCase()+e.slice(1):e}},{key:"createContentHeader",value:function(){"calendar"===this.getModuleName()?Object(l.X)(this.element.querySelectorAll(".e-content .e-week-header")[0])||Object(l.I)(this.element.querySelectorAll(".e-content .e-week-header")[0]):Object(l.X)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||Object(l.I)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var e,t="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:"e-week-header"}),this.weekNumber&&(t+='<th class="e-week-number"></th>',"calendar"===this.getModuleName()?Object(l.v)([this.element],"e-week-number"):Object(l.v)([this.calendarElement],"e-week-number")),e=this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek);for(var i=0;i<=6;i++)t+='<th  class="">'+this.toCapitalize(e[i])+"</th>";t="<tr>"+t+"</tr>",this.tableHeadElement.innerHTML=t,this.table.appendChild(this.tableHeadElement)}},{key:"createContentBody",value:function(){switch("calendar"===this.getModuleName()?Object(l.X)(this.element.querySelectorAll(".e-content tbody")[0])||Object(l.I)(this.element.querySelectorAll(".e-content tbody")[0]):Object(l.X)(this.calendarElement.querySelectorAll(".e-content tbody")[0])||Object(l.I)(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}}},{key:"updateFooter",value:function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today"))}},{key:"createContentFooter",value:function(){if(this.showTodayButton){var e=new Date(+this.min),t=new Date(+this.max);this.globalize=new l.n(this.locale),this.l10=new l.p(this.getModuleName(),{today:"Today"},this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),Object(l.kb)(this.todayElement),this.updateFooter(),Object(l.v)([this.todayElement],["e-btn","e-today","e-flat","e-primary","e-css"]),+new Date(e.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(t.setHours(0,0,0,0))&&!this.todayDisabled||Object(l.v)([this.todayElement],y),this.footer=this.createElement("div",{className:"e-footer-container"}),this.footer.appendChild(this.todayElement),"calendar"===this.getModuleName()&&this.element.appendChild(this.footer),"datepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),"datetimepicker"===this.getModuleName()&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(y)||l.l.add(this.todayElement,"click",this.todayButtonClick,this)}}},{key:"wireEvents",value:function(e,t,i,n){Object(l.W)()&&t?(this.element=document.getElementById(e),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,i),this.blazorRef=t,this.serverModuleName=n):(l.l.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,this.keyConfigs)),this.keyboardModule="calendar"===this.getModuleName()?new l.o(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):new l.o(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}},{key:"dateWireEvents",value:function(e,t,i,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,i),this.blazorRef=t,this.serverModuleName=n}},{key:"todayButtonClick",value:function(e,t,i){this.showTodayButton&&(this.effect=this.currentView()===this.depth?"":"e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(t)),i):this.navigateTo("Month",new Date(this.checkValue(t)),i))}},{key:"checkDeviceMode",value:function(e){l.d.isDevice&&Object(l.W)()&&e&&e.invokeMethodAsync("OnDevice",!0)}},{key:"keyActionHandle",value:function(e,t,i){Object(l.W)()&&this.blazorRef&&(e.preventDefault(),this.tableBodyElement||(this.element=Object(l.C)(e.target,".e-calendar"),this.tableBodyElement=this.element.querySelector("tbody")),i=!1);var n,r=this.tableBodyElement.querySelector("tr td.e-focused-date");if(n=i?Object(l.X)(r)||+t!==parseInt(r.getAttribute("id").split("_")[0],10)?this.tableBodyElement.querySelector("tr td.e-selected"):r:this.tableBodyElement.querySelector("tr td.e-selected"),Object(l.W)()&&this.blazorRef){this.tableBodyElement.focus();var s=e.target,a={Action:e.action,Key:e.key,Events:e,SelectDate:n?n.id:null,FocusedDate:r?r.id:null,classList:n?n.classList.toString():r?r.classList.toString():"e-cell",Id:r?r.id:n?n.id:null,TargetClassList:s.classList.toString()};this.blazorRef.invokeMethodAsync("OnCalendarKeyboardEvent",a),s.classList.contains("e-today")&&(s.blur(),this.tableBodyElement.focus()),"sf.calendars.Calendar"===this.serverModuleName&&(this.tableBodyElement=null)}else{var o=this.getViewNumber(this.currentView()),h=this.getViewNumber(this.depth),c=o===h&&this.getViewNumber(this.start)>=h;switch(this.effect="",e.action){case"moveLeft":this.KeyboardNavigate(-1,o,e,this.max,this.min),e.preventDefault();break;case"moveRight":this.KeyboardNavigate(1,o,e,this.max,this.min),e.preventDefault();break;case"moveUp":this.KeyboardNavigate(0===o?-7:-4,o,e,this.max,this.min),e.preventDefault();break;case"moveDown":this.KeyboardNavigate(0===o?7:4,o,e,this.max,this.min),e.preventDefault();break;case"select":if(e.target===this.todayElement)this.todayButtonClick(e,t);else{var u=Object(l.X)(r)?n:r;if(!Object(l.X)(u)&&!u.classList.contains(y))if(c){var d=new Date(parseInt(""+u.id,0));this.selectDate(e,d,u)}else this.contentClick(null,--o,u,t)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":Object(l.X)(r)&&(Object(l.X)(n)||c)||this.contentClick(null,--o,r||n,t),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),Object(l.I)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,o),Object(l.I)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault()}"calendar"===this.getModuleName()&&this.table.focus()}}},{key:"KeyboardNavigate",value:function(e,t,i,n,r){var s=new Date(this.checkValue(this.currentDate));switch(t){case 2:this.addYears(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(Object(l.I)(this.tableBodyElement),this.renderDecades(i)):this.currentDate=s;break;case 1:this.addMonths(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(Object(l.I)(this.tableBodyElement),this.renderYears(i)):this.currentDate=s;break;case 0:this.addDay(this.currentDate,e,i,n,r),this.isMinMaxRange(this.currentDate)?(Object(l.I)(this.tableBodyElement),this.renderMonths(i)):this.currentDate=s}}},{key:"preRender",value:function(e){var t=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(e){t.triggerNavigate(e)}}},{key:"minMaxDate",value:function(e){var t=new Date(new Date(+e).setHours(0,0,0,0)),i=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return+t!=+i&&+t!=+n||(+e<+this.min&&(e=new Date(+this.min)),+e>+this.max&&(e=new Date(+this.max))),e}},{key:"renderMonths",value:function(e,t,i){var n,r=this.weekNumber?8:7;n="Gregorian"===this.calendarMode?this.renderDays(this.currentDate,t,null,null,i):this.islamicModule.islamicRenderDays(this.currentDate,t),this.createContentHeader(),"Gregorian"===this.calendarMode?this.renderTemplate(n,r,"e-month",e,t):this.islamicModule.islamicRenderTemplate(n,r,"e-month",e,t)}},{key:"renderDays",value:function(e,t,i,n,r){var s,a=[],o=r?new Date(+e):new Date,h=new Date(this.checkValue(e)),c=h.getMonth();this.titleUpdate(e,"days");var u=h;for(h=new Date(u.getFullYear(),u.getMonth(),0,u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds());h.getDay()!==this.firstDayOfWeek;)this.setStartDate(h,-864e5);for(var d=0;d<42;++d){var p=this.createElement("td",{className:"e-cell"}),g=this.createElement("span");if(d%7==0&&this.weekNumber){var f;f="FirstDay"===this.weekRule?6:"FirstFourDayWeek"===this.weekRule?3:0;var m=new Date(h.getFullYear(),h.getMonth(),h.getDate()+f);g.textContent=""+this.getWeek(m),p.appendChild(g),Object(l.v)([p],"e-week-number"),a.push(p)}s=new Date(+h),h=this.minMaxDate(h);var b={type:"dateTime",skeleton:Object(l.W)()?"D":"full"},k=this.globalize.parseDate(this.globalize.formatDate(h,b),b),S=this.dayCell(h),O=this.globalize.formatDate(h,{type:"date",skeleton:Object(l.W)()?"D":"full"}),x=this.createElement("span");x.textContent=this.globalize.formatDate(h,{format:"d",type:"date",skeleton:Object(l.W)()?"d":"yMd"});var j=this.min>h||this.max<h;j?(Object(l.v)([S],y),Object(l.v)([S],C)):x.setAttribute("title",""+O),c!==h.getMonth()&&Object(l.v)([S],v),0!==h.getDay()&&6!==h.getDay()||Object(l.v)([S],"e-weekend"),S.appendChild(x),this.renderDayCellArgs={date:h,isDisabled:!1,element:S,isOutOfRange:j};var R=this.renderDayCellArgs;if(this.renderDayCellEvent(R),R.isDisabled){var D=new Date(this.checkValue(t)),E=new Date(this.checkValue(R.date));if(i){if(!Object(l.X)(n)&&n.length>0)for(var I=0;I<n.length;I++)+new Date(this.globalize.formatDate(R.date,{type:"date",skeleton:Object(l.W)()?"d":"yMd"}))==+new Date(this.globalize.formatDate(n[I],{type:"date",skeleton:Object(l.W)()?"d":"yMd"}))&&(n.splice(I,1),I=-1)}else D&&+D==+E&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!S.classList.contains(w)&&(Object(l.v)([S],y),Object(l.v)([S],C),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var M=S.classList.contains(v),F=S.classList.contains(y);if(F||l.l.add(S,"click",this.clickHandler,this),!i||Object(l.X)(n)||F)!F&&this.getDateVal(h,t)?Object(l.v)([S],w):this.updateFocus(M,F,h,S,e);else{for(var T=0;T<n.length;T++){var A="Gregorian"===this.calendarMode?"gregorian":"islamic",z={format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:A};this.globalize.formatDate(h,z)===this.globalize.formatDate(n[T],z)&&this.getDateVal(h,n[T])||this.getDateVal(h,t)?Object(l.v)([S],w):this.updateFocus(M,F,h,S,e)}n.length<=0&&this.updateFocus(M,F,h,S,e)}k.getFullYear()===o.getFullYear()&&k.getMonth()===o.getMonth()&&k.getDate()===o.getDate()&&Object(l.v)([S],"e-today"),a.push(this.renderDayCellArgs.element),h=new Date(+s),this.addDay(h,1,null,this.max,this.min)}return a}},{key:"updateFocus",value:function(e,t,i,n,r){r.getDate()!==i.getDate()||e||t?(r>=this.max&&parseInt(n.id,0)===+this.max&&!e&&!t&&Object(l.v)([n],k),r<=this.min&&parseInt(n.id,0)===+this.min&&!e&&!t&&Object(l.v)([n],k)):Object(l.v)([n],k)}},{key:"renderYears",value:function(e,t){this.removeTableHeadElement();var i=[],n=Object(l.X)(t),r=new Date(this.checkValue(this.currentDate)),s=r.getMonth(),a=r.getFullYear(),o=r,h=o.getFullYear(),c=new Date(this.checkValue(this.min)).getFullYear(),u=new Date(this.checkValue(this.min)).getMonth(),d=new Date(this.checkValue(this.max)).getFullYear(),p=new Date(this.checkValue(this.max)).getMonth();o.setMonth(0),this.titleUpdate(this.currentDate,"months"),o.setDate(1);for(var g=0;g<12;++g){var f=this.dayCell(o),m=this.createElement("span"),v=t&&t.getMonth()===o.getMonth(),b=t&&t.getFullYear()===a&&v;m.textContent=this.toCapitalize(this.globalize.formatDate(o,{format:Object(l.W)()?"MMM":null,type:"dateTime",skeleton:"MMM"})),this.min&&(h<c||g<u&&h===c)||this.max&&(h>d||g>p&&h>=d)?Object(l.v)([f],y):!n&&b?Object(l.v)([f],w):o.getMonth()===s&&this.currentDate.getMonth()===s&&Object(l.v)([f],k),o.setDate(1),o.setMonth(o.getMonth()+1),f.classList.contains(y)||l.l.add(f,"click",this.clickHandler,this),f.appendChild(m),i.push(f)}this.renderTemplate(i,4,"e-year",e,t)}},{key:"renderDecades",value:function(e,t){this.removeTableHeadElement();var i=[],n=new Date(this.checkValue(this.currentDate));n.setMonth(0),n.setDate(1);var r=n.getFullYear(),s=new Date(n.setFullYear(r-r%10)),a=new Date(n.setFullYear(r-r%10+9)),o=s.getFullYear(),h=a.getFullYear(),c=this.globalize.formatDate(s,{format:Object(l.W)()?"yyyy":null,type:"dateTime",skeleton:"y"}),u=this.globalize.formatDate(a,{format:Object(l.W)()?"yyyy":null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=c+" - "+u;for(var d=new Date(r-r%10-1,0,1).getFullYear(),p=0;p<12;++p){var g=d+p;n.setFullYear(g);var f=this.dayCell(n);Object(l.x)(f,{role:"gridcell"});var m=this.createElement("span");m.textContent=this.globalize.formatDate(n,{format:Object(l.W)()?"yyyy":null,type:"dateTime",skeleton:"y"}),g<o||g>h?(Object(l.v)([f],"e-other-year"),Object(l.X)(t)||n.getFullYear()!==t.getFullYear()||Object(l.v)([f],w),(g<new Date(this.checkValue(this.min)).getFullYear()||g>new Date(this.checkValue(this.max)).getFullYear())&&Object(l.v)([f],y)):g<new Date(this.checkValue(this.min)).getFullYear()||g>new Date(this.checkValue(this.max)).getFullYear()?Object(l.v)([f],y):Object(l.X)(t)||n.getFullYear()!==t.getFullYear()?n.getFullYear()!==this.currentDate.getFullYear()||f.classList.contains(y)||Object(l.v)([f],k):Object(l.v)([f],w),f.classList.contains(y)||l.l.add(f,"click",this.clickHandler,this),f.appendChild(m),i.push(f)}this.renderTemplate(i,4,"e-decade",e,t)}},{key:"dayCell",value:function(e){var t="Gregorian"===this.calendarMode?"gregorian":"islamic",i={skeleton:Object(l.W)()?"F":"full",type:"dateTime",calendar:t},n=this.globalize.parseDate(this.globalize.formatDate(e,i),i).valueOf(),r={className:"e-cell",attrs:{id:""+Object(l.U)(""+n),"aria-selected":"false",role:"gridcell"}};return this.createElement("td",r)}},{key:"firstDay",value:function(e){var t="Decade"!==this.currentView()?this.tableBodyElement.querySelectorAll("td:not(."+v):this.tableBodyElement.querySelectorAll("td:not(.e-other-year");if(t.length)for(var i=0;i<t.length;i++)if(!t[i].classList.contains(y)){e=new Date(parseInt(t[i].id,0));break}return e}},{key:"lastDay",value:function(e,t){var i=new Date(e.getFullYear(),e.getMonth()+1,0);if(2!==t){var n=Math.abs(i.getTimezoneOffset()-this.firstDay(e).getTimezoneOffset());return n&&i.setHours(this.firstDay(e).getHours()+n/60),this.findLastDay(i)}return this.findLastDay(this.firstDay(i))}},{key:"checkDateValue",value:function(e){return!Object(l.X)(e)&&e instanceof Date&&!isNaN(+e)?e:null}},{key:"findLastDay",value:function(e){var t="Decade"===this.currentView()?this.tableBodyElement.querySelectorAll("td:not(.e-other-year"):this.tableBodyElement.querySelectorAll("td:not(."+v);if(t.length)for(var i=t.length-1;i>=0;i--)if(!t[i].classList.contains(y)){e=new Date(parseInt(t[i].id,0));break}return e}},{key:"removeTableHeadElement",value:function(){"calendar"===this.getModuleName()?Object(l.X)(this.element.querySelectorAll(".e-content table thead")[0])||Object(l.I)(this.tableHeadElement):Object(l.X)(this.calendarElement.querySelectorAll(".e-content table thead")[0])||Object(l.I)(this.tableHeadElement)}},{key:"renderTemplate",value:function(e,t,i,n,r){var s,a=this.getViewNumber(this.currentView());this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),Object(l.ib)([this.contentElement,this.headerElement],["e-month","e-decade","e-year"]),Object(l.v)([this.contentElement,this.headerElement],[i]);for(var o=t,h=0,c=0;c<e.length/t;++c){for(s=this.createElement("tr",{attrs:{role:"row"}}),h=0+h;h<o;h++)e[h].classList.contains("e-week-number")||Object(l.X)(e[h].children[0])||(Object(l.v)([e[h].children[0]],["e-day"]),Object(l.kb)(e[h].children[0],{duration:600,isCenterRipple:!0})),s.appendChild(e[h]),this.weekNumber&&7===h&&e[7].classList.contains(v)&&Object(l.v)([s],"e-month-hide"),!this.weekNumber&&6===h&&e[6].classList.contains(v)&&Object(l.v)([s],"e-month-hide"),this.weekNumber?41===h&&e[41].classList.contains(v)&&Object(l.v)([s],"e-month-hide"):35===h&&e[35].classList.contains(v)&&Object(l.v)([s],"e-month-hide");o+=t,h+=0,this.tableBodyElement.appendChild(s)}this.table.querySelector("tbody").className=this.effect,"Gregorian"===this.calendarMode?this.iconHandler():this.islamicModule.islamicIconHandler(),(a!==this.getViewNumber(this.currentView())||0===a&&a!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()}},{key:"clickHandler",value:function(e,t){this.clickEventEmitter(e);var i=e.currentTarget,n=this.getViewNumber(this.currentView());i.classList.contains(v)?this.contentClick(e,0,null,t):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)||2===n?this.contentClick(e,1,null,t):i.classList.contains(v)||0!==n?this.contentClick(e,0,i,t):this.selectDate(e,this.getIdValue(e,null),null),"calendar"===this.getModuleName()&&this.table.focus()}},{key:"clickEventEmitter",value:function(e){e.preventDefault()}},{key:"contentClick",value:function(e,t,i,n){var r=this.getViewNumber(this.currentView()),s=this.getIdValue(e,i);switch(t){case 0:r===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(Object(l.I)(this.tableBodyElement),this.currentDate=s,this.effect="e-zoomin",this.renderMonths(e)):("Gregorian"===this.calendarMode?(this.currentDate.setMonth(s.getMonth()),s.getMonth()>0&&this.currentDate.getMonth()!==s.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(s.getFullYear())):this.currentDate=s,this.effect="e-zoomin",Object(l.I)(this.tableBodyElement),this.renderMonths(e));break;case 1:if(r===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,s,null);else{if("Gregorian"===this.calendarMode)this.currentDate.setFullYear(s.getFullYear());else{var a=this.islamicModule.getIslamicDate(s);this.currentDate=this.islamicModule.toGregorian(a.year,a.month,1)}this.effect="e-zoomin",Object(l.I)(this.tableBodyElement),this.renderYears(e)}}}},{key:"switchView",value:function(e,t,i,n){switch(e){case 0:Object(l.I)(this.tableBodyElement),this.renderMonths(t,null,n),i&&!Object(l.X)(this.tableBodyElement.querySelectorAll("."+k)[0])&&this.tableBodyElement.querySelectorAll("."+k)[0].classList.remove(k);break;case 1:Object(l.I)(this.tableBodyElement),this.renderYears(t);break;case 2:Object(l.I)(this.tableBodyElement),this.renderDecades(t)}}},{key:"getModuleName",value:function(){return"calendar"}},{key:"requiredModules",value:function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),e}},{key:"getPersistData",value:function(){return this.addOnPersist(["value"])}},{key:"onPropertyChanged",value:function(e,t,i,n){this.effect="";for(var r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];switch(a){case"enableRtl":e.enableRtl?"calendar"===this.getModuleName()?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):"calendar"===this.getModuleName()?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),this.setProperties("min"===a?{min:this.checkDateValue(new Date(this.checkValue(e.min)))}:{max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.setProperties({start:this.currentView()},!0),Object(l.I)(this.tableBodyElement),this.minMaxUpdate(),i&&this.validateValues(i,n),this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(Object(l.I)(this.todayElement),Object(l.I)(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(Object(l.ib)([this.todayElement],y),Object(l.I)(this.todayElement),Object(l.I)(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.createContentHeader(),this.createContentBody();break;case"locale":this.globalize=new l.n(this.locale),this.createContentHeader(),this.createContentBody(),this.l10.setLocale(this.locale),this.updateFooter();break;case"showTodayButton":e.showTodayButton?this.createContentFooter():Object(l.X)(this.todayElement)||Object(l.X)(this.footer)||(Object(l.I)(this.todayElement),Object(l.I)(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:e.showTodayButton},!0)}}}},{key:"validateValues",value:function(e,t){if(e&&!Object(l.X)(t)&&t.length>0){for(var i=this.copyValues(t),n=0;n<i.length;n++){var r,s="Gregorian"===this.calendarMode?"gregorian":"islamic";r=this.globalize.formatDate(i[n],"Gregorian"===this.calendarMode?{type:"date",skeleton:Object(l.W)()?"d":"yMd"}:{type:"dateTime",skeleton:"full",calendar:"islamic"});var a={type:"date",skeleton:Object(l.W)()?"d":"yMd",calendar:s},o=this.globalize.formatDate(this.min,a),h={type:"date",skeleton:Object(l.W)()?"d":"yMd",calendar:s},c=this.globalize.formatDate(this.max,h);(+new Date(r)<+new Date(o)||+new Date(r)>+new Date(c))&&(i.splice(n,1),n=-1)}this.setProperties({values:i},!0)}}},{key:"setValueUpdate",value:function(){Object(l.X)(this.tableBodyElement)||(Object(l.I)(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())}},{key:"copyValues",value:function(e){var t=[];if(!Object(l.X)(e)&&e.length>0)for(var i=0;i<e.length;i++)t.push(new Date(+e[i]));return t}},{key:"titleUpdate",value:function(e,t){var i,n,r=new l.n(this.locale),s="Gregorian"===this.calendarMode?"gregorian":"islamic";switch("Gregorian"===this.calendarMode?(i=r.formatDate(e,{type:"dateTime",skeleton:Object(l.W)()?"y":"yMMMM",calendar:s}),n=r.formatDate(e,{format:Object(l.W)()?"yyyy":null,type:"dateTime",skeleton:"y",calendar:s})):(i=r.formatDate(e,{type:"dateTime",format:"MMMM y",calendar:s}),n=r.formatDate(e,{type:"dateTime",format:"y",calendar:s})),t){case"days":this.headerTitleElement.textContent=this.toCapitalize(i);break;case"months":this.headerTitleElement.textContent=n}}},{key:"setActiveDescendant",value:function(){var e,t,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),n=this.tableBodyElement.querySelector("tr td.e-selected"),r="Gregorian"===this.calendarMode?"gregorian":"islamic",s=this.currentView();return t=this.globalize.formatDate(this.currentDate,"Month"===s?{type:"date",skeleton:Object(l.W)()?"D":"full",calendar:r}:"Year"===s?"islamic"!==r?{type:"date",skeleton:Object(l.W)()?"y":"yMMMM",calendar:r}:{type:"date",skeleton:"GyMMM",calendar:r}:{format:Object(l.W)()?"yyyy":null,type:"date",skeleton:"y",calendar:r}),(n||i)&&(Object(l.X)(n)||n.setAttribute("aria-selected","true"),(i||n).setAttribute("aria-label",t),e=(i||n).getAttribute("id")),e}},{key:"iconHandler",value:function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}}},{key:"destroy",value:function(){("calendar"===this.getModuleName()||this.calendarElement)&&Object(l.ib)([this.element],[b]),"calendar"===this.getModuleName()&&(l.l.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&l.l.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),Object(l.X)(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element.innerHTML="",i(o(r.prototype),"destroy",this).call(this)}},{key:"title",value:function(e){var t=this.getViewNumber(this.currentView());this.effect="e-zoomin",this.switchView(++t,e)}},{key:"getViewNumber",value:function(e){return"Month"===e?0:"Year"===e?1:2}},{key:"navigateTitle",value:function(e){e.preventDefault(),this.title(e),"calendar"===this.getModuleName()&&this.table.focus()}},{key:"previous",value:function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(e)}}},{key:"navigatePrevious",value:function(e){e.preventDefault(),"Gregorian"===this.calendarMode?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e),"calendar"===this.getModuleName()&&this.table.focus()}},{key:"next",value:function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(e)}}},{key:"navigateNext",value:function(e){e.preventDefault(),"Gregorian"===this.calendarMode?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(e),"calendar"===this.getModuleName()&&this.table.focus()}},{key:"navigateTo",value:function(e,t,i){+t>=+this.min&&+t<=+this.max&&(this.currentDate=t),+t<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+t>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(e)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(e))&&(e=this.depth),this.switchView(this.getViewNumber(e),null,null,i)}},{key:"currentView",value:function(){return this.contentElement.classList.contains("e-year")?"Year":this.contentElement.classList.contains("e-decade")?"Decade":"Month"}},{key:"getDateVal",value:function(e,t){return!Object(l.X)(t)&&e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},{key:"getCultureObjects",value:function(e,t){var i=(Object(l.W)()?".dates.days.":".dates.calendars.gregorian.days.format.")+this.dayHeaderFormat.toLowerCase(),n=(Object(l.W)()?".dates.days.":".dates.calendars.islamic.days.format.")+this.dayHeaderFormat.toLowerCase(),r=Object(l.W)()?"":"main.";return"Gregorian"===this.calendarMode?Object(l.V)(r+""+this.locale+i,e):Object(l.V)("main."+this.locale+n,e)}},{key:"getWeek",value:function(e){var t=new Date(this.checkValue(e)).valueOf(),i=new Date(e.getFullYear(),0,1).valueOf();return Math.ceil((t-i+864e5)/864e5/7)}},{key:"setStartDate",value:function(e,t){var i=e.getTimezoneOffset(),n=new Date(e.getTime()+t),r=n.getTimezoneOffset()-i;e.setTime(n.getTime()+6e4*r)}},{key:"addMonths",value:function(e,t){if("Gregorian"===this.calendarMode){var i=e.getDate();e.setDate(1),e.setMonth(e.getMonth()+t),e.setDate(Math.min(i,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+t,1)}}},{key:"addYears",value:function(e,t){if("Gregorian"===this.calendarMode){var i=e.getDate();e.setDate(1),e.setFullYear(e.getFullYear()+t),e.setDate(Math.min(i,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year+t,n.month,1)}}},{key:"getIdValue",value:function(e,t){var i;i=e?e.currentTarget:t;var n="Gregorian"===this.calendarMode?"gregorian":"islamic",r={type:"dateTime",skeleton:Object(l.W)()?"F":"full",calendar:n},s=this.globalize.formatDate(new Date(parseInt(""+i.getAttribute("id"),0)),r),a=this.globalize.parseDate(s,r),o=a.valueOf()-a.valueOf()%1e3;return new Date(o)}},{key:"adjustLongHeaderSize",value:function(){Object(l.ib)([this.element],"e-calendar-day-header-lg"),"Wide"===this.dayHeaderFormat&&Object(l.v)(["calendar"===this.getModuleName()?this.element:this.calendarElement],"e-calendar-day-header-lg")}},{key:"selectDate",value:function(e,t,i,n,r){var s=i||e.currentTarget;if(this.isDateSelected=!1,"Decade"===this.currentView())this.setDateDecade(this.currentDate,t.getFullYear());else if("Year"===this.currentView())this.setDateYear(this.currentDate,t);else{if(n&&!this.checkPresentDate(t,r)){var a=this.copyValues(r);!Object(l.X)(r)&&a.length>0?(a.push(new Date(this.checkValue(t))),this.setProperties({values:a},!0),this.setProperties({value:r[r.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(t))]},!0)}else this.setProperties({value:new Date(this.checkValue(t))},!0);this.currentDate=new Date(this.checkValue(t))}var o=Object(l.C)(s,"."+b);if(Object(l.X)(o)&&(o=this.tableBodyElement),n||Object(l.X)(o.querySelector("."+w))||Object(l.ib)([o.querySelector("."+w)],w),n||Object(l.X)(o.querySelector("."+k))||Object(l.ib)([o.querySelector("."+k)],k),n){for(var h=this.copyValues(r),c=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),u=0;u<c.length;u++){var d=o.querySelectorAll("td."+k)[0],p=o.querySelectorAll("td."+w)[0];c[u]===d&&Object(l.ib)([c[u]],k),c[u]!==p||this.checkPresentDate(new Date(parseInt(p.getAttribute("id").split("_")[0],10)),r)||Object(l.ib)([c[u]],w)}if(s.classList.contains(w)){Object(l.ib)([s],w);for(var g=0;g<h.length;g++){var f="Gregorian"===this.calendarMode?"gregorian":"islamic",m={format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:f};if(this.globalize.formatDate(t,m)===this.globalize.formatDate(h[g],m)){var v=h.indexOf(h[g]);h.splice(v,1),Object(l.v)([s],k)}}this.setProperties({values:h},!0)}else Object(l.v)([s],w)}else Object(l.v)([s],w);this.isDateSelected=!0}},{key:"getFromatStringValue",value:function(){return Object(l.W)()?"M"+Object(l.N)().dateSeperator+"d"+Object(l.N)().dateSeperator+"yy":null}},{key:"checkPresentDate",value:function(e,t){var i=!1;if(!Object(l.X)(t))for(var n=0;n<t.length;n++){var r="Gregorian"===this.calendarMode?"gregorian":"islamic";this.globalize.formatDate(e,{format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:r})===this.globalize.formatDate(t[n],{format:this.getFromatStringValue(),type:"date",skeleton:"short",calendar:r})&&(i=!0)}return i}},{key:"setAriaActiveDescendant",value:function(){Object(l.x)(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})}},{key:"previousIconHandler",value:function(e){e?(l.l.remove(this.previousIcon,"click",this.navigatePreviousHandler),Object(l.v)([this.previousIcon],""+y),Object(l.v)([this.previousIcon],""+C),this.previousIcon.setAttribute("aria-disabled","true")):(l.l.add(this.previousIcon,"click",this.navigatePreviousHandler),Object(l.ib)([this.previousIcon],""+y),Object(l.ib)([this.previousIcon],""+C),this.previousIcon.setAttribute("aria-disabled","false"))}},{key:"renderDayCellEvent",value:function(e){Object(l.K)(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)}},{key:"navigatedEvent",value:function(e){Object(l.K)(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)}},{key:"triggerNavigate",value:function(e){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(e)}},{key:"nextIconHandler",value:function(e){e?(l.l.remove(this.nextIcon,"click",this.navigateNextHandler),Object(l.v)([this.nextIcon],y),Object(l.v)([this.nextIcon],C),this.nextIcon.setAttribute("aria-disabled","true")):(l.l.add(this.nextIcon,"click",this.navigateNextHandler),Object(l.ib)([this.nextIcon],y),Object(l.ib)([this.nextIcon],C),this.nextIcon.setAttribute("aria-disabled","false"))}},{key:"compare",value:function(e,t,i){var n,r,s=t.getFullYear();return n=s,r=0,i&&(n=(s-=s%i)-s%i+i-1),e.getFullYear()>n?r=1:e.getFullYear()<s&&(r=-1),r}},{key:"isMinMaxRange",value:function(e){return+e>=+this.min&&+e<=+this.max}},{key:"isMonthYearRange",value:function(e){if("Gregorian"===this.calendarMode)return e.getMonth()>=this.min.getMonth()&&e.getFullYear()>=this.min.getFullYear()&&e.getMonth()<=this.max.getMonth()&&e.getFullYear()<=this.max.getFullYear();var t=this.islamicModule.getIslamicDate(e);return t.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&t.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&t.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&t.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year}},{key:"compareYear",value:function(e,t){return this.compare(e,t,0)}},{key:"compareDecade",value:function(e,t){return this.compare(e,t,10)}},{key:"shiftArray",value:function(e,t){return e.slice(t).concat(e.slice(0,t))}},{key:"addDay",value:function(e,t,i,n,r){var s=t,a=new Date(+e);if(!Object(l.X)(this.tableBodyElement)&&!Object(l.X)(i)){for(;this.findNextTD(new Date(+e),s,n,r);)s+=t;var o=new Date(a.setDate(a.getDate()+s));s=+o>+n||+o<+r?s===t?t-t:t:s}e.setDate(e.getDate()+s)}},{key:"findNextTD",value:function(e,t,i,n){var r=new Date(e.setDate(e.getDate()+t)),s=[],a=!1;(!Object(l.X)(r)&&r.getMonth())===(!Object(l.X)(this.currentDate)&&this.currentDate.getMonth())?s=("Gregorian"===this.calendarMode?this.renderDays(r):this.islamicModule.islamicRenderDays(this.currentDate,r)).filter((function(e){return e.classList.contains(y)})):s=this.tableBodyElement.querySelectorAll("td."+y);if(+r<=+i&&+r>=+n&&s.length)for(var o=0;o<s.length&&!(a=+r==+new Date(parseInt(s[o].id,0)));o++);return a}},{key:"getMaxDays",value:function(e){var t,i,n=new Date(this.checkValue(e));for(t=28,i=n.getMonth();n.getMonth()===i;)++t,n.setDate(t);return t-1}},{key:"setDateDecade",value:function(e,t){e.setFullYear(t),this.setProperties({value:new Date(this.checkValue(e))},!0)}},{key:"setDateYear",value:function(e,t){e.setFullYear(t.getFullYear(),t.getMonth(),e.getDate()),t.getMonth()!==e.getMonth()&&(e.setDate(0),this.currentDate=new Date(this.checkValue(t))),this.setProperties({value:new Date(this.checkValue(e))},!0)}},{key:"compareMonth",value:function(e,t){return e.getFullYear()>t.getFullYear()?1:e.getFullYear()<t.getFullYear()?-1:e.getMonth()===t.getMonth()?0:e.getMonth()>t.getMonth()?1:-1}},{key:"checkValue",value:function(e){return e instanceof Date?e.toUTCString():""+e}},{key:"checkView",value:function(){"Decade"!==this.start&&"Year"!==this.start&&this.setProperties({start:"Month"},!0),"Decade"!==this.depth&&"Year"!==this.depth&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)}}]),r}(l.h);return m([Object(l.s)(new Date(1900,0,1))],e.prototype,"min",void 0),m([Object(l.s)(new Date(2099,11,31))],e.prototype,"max",void 0),m([Object(l.s)(null)],e.prototype,"firstDayOfWeek",void 0),m([Object(l.s)("Gregorian")],e.prototype,"calendarMode",void 0),m([Object(l.s)("Month")],e.prototype,"start",void 0),m([Object(l.s)("Month")],e.prototype,"depth",void 0),m([Object(l.s)(!1)],e.prototype,"weekNumber",void 0),m([Object(l.s)("FirstDay")],e.prototype,"weekRule",void 0),m([Object(l.s)(!0)],e.prototype,"showTodayButton",void 0),m([Object(l.s)("Short")],e.prototype,"dayHeaderFormat",void 0),m([Object(l.s)(!1)],e.prototype,"enablePersistence",void 0),m([Object(l.s)(null)],e.prototype,"keyConfigs",void 0),m([Object(l.s)(null)],e.prototype,"serverTimezoneOffset",void 0),m([Object(l.k)()],e.prototype,"created",void 0),m([Object(l.k)()],e.prototype,"destroyed",void 0),m([Object(l.k)()],e.prototype,"navigated",void 0),m([Object(l.k)()],e.prototype,"renderDayCell",void 0),e=m([l.q],e)}(),O=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){return p(this,r),t.call(this,e,i)}return f(r,[{key:"render",value:function(){if("Islamic"===this.calendarMode&&void 0===this.islamicModule&&Object(l.rb)("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&"object"==typeof this.values&&!Object(l.X)(this.values)&&this.values.length>0){for(var e=[],t=[],n=0;n<this.values.length;n++)-1===e.indexOf(+this.values[n])&&(e.push(+this.values[n]),t.push(this.values[n]));this.setProperties({values:t},!0);for(var s=0;s<this.values.length;s++)if(!this.checkDateValue(this.values[s]))if("string"==typeof this.values[s]&&this.checkDateValue(new Date(this.checkValue(this.values[s])))){var a=new Date(this.checkValue(this.values[s]));this.values.splice(s,1),this.values.splice(s,0,a)}else this.values.splice(s,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),i(o(r.prototype),"render",this).call(this),"calendar"===this.getModuleName()){var h=Object(l.C)(this.element,"form");h&&l.l.add(h,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()}},{key:"isDayLightSaving",value:function(){var e=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),t=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(t,e)}},{key:"setTimeZone",value:function(e){if(!Object(l.X)(this.serverTimezoneOffset)&&this.value){var t=e+(new Date).getTimezoneOffset()/60;t=this.isDayLightSaving()?t--:t,this.value=new Date(this.value.getTime()+60*t*60*1e3)}}},{key:"formResetHandler",value:function(){this.setProperties({value:null},!0)}},{key:"validateDate",value:function(){"string"==typeof this.value&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),i(o(r.prototype),"validateDate",this).call(this,this.value),!Object(l.X)(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)}},{key:"minMaxUpdate",value:function(){"calendar"===this.getModuleName()&&(!Object(l.X)(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!Object(l.X)(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),"calendar"===this.getModuleName()||Object(l.X)(this.value)?i(o(r.prototype),"minMaxUpdate",this).call(this,this.value):!Object(l.X)(this.value)&&this.value<this.min&&this.min<=this.max?i(o(r.prototype),"minMaxUpdate",this).call(this,this.min):!Object(l.X)(this.value)&&this.value>this.max&&this.min<=this.max&&i(o(r.prototype),"minMaxUpdate",this).call(this,this.max)}},{key:"generateTodayVal",value:function(e){var t=new Date;return e?(t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds()),t.setMilliseconds(e.getMilliseconds())):t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),t}},{key:"todayButtonClick",value:function(e){if(this.showTodayButton){var t=this.generateTodayVal(this.value);if(this.setProperties({value:t},!0),this.isTodayClicked=!0,this.todayButtonEvent=e,this.isMultiSelection){var n=this.copyValues(this.values);i(o(r.prototype),"checkPresentDate",this).call(this,t,this.values)||(n.push(t),this.setProperties({values:n}))}i(o(r.prototype),"todayButtonClick",this).call(this,e,new Date(+this.value))}}},{key:"keyActionHandle",value:function(e){i(o(r.prototype),"keyActionHandle",this).call(this,e,this.value,this.isMultiSelection)}},{key:"preRender",value:function(){var e=this;this.changeHandler=function(t){e.triggerChange(t)},this.checkView(),i(o(r.prototype),"preRender",this).call(this,this.value)}},{key:"createContent",value:function(){this.previousDate=this.value,this.previousDateTime=this.value,i(o(r.prototype),"createContent",this).call(this)}},{key:"minMaxDate",value:function(e){return i(o(r.prototype),"minMaxDate",this).call(this,e)}},{key:"renderMonths",value:function(e,t,n){i(o(r.prototype),"renderMonths",this).call(this,e,this.value,n)}},{key:"renderDays",value:function(e,t,n,s,a){var l=i(o(r.prototype),"renderDays",this).call(this,e,this.value,this.isMultiSelection,this.values,a);return this.isMultiSelection&&i(o(r.prototype),"validateValues",this).call(this,this.isMultiSelection,this.values),l}},{key:"renderYears",value:function(e){"Gregorian"===this.calendarMode?i(o(r.prototype),"renderYears",this).call(this,e,this.value):this.islamicModule.islamicRenderYears(e,this.value)}},{key:"renderDecades",value:function(e){"Gregorian"===this.calendarMode?i(o(r.prototype),"renderDecades",this).call(this,e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)}},{key:"renderTemplate",value:function(e,t,n,s){"Gregorian"===this.calendarMode?i(o(r.prototype),"renderTemplate",this).call(this,e,t,n,s,this.value):this.islamicModule.islamicRenderTemplate(e,t,n,s,this.value),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},{key:"clickHandler",value:function(e){var t=e.currentTarget;if(this.isPopupClicked=!0,t.classList.contains(v))if(this.isMultiSelection){var n=this.copyValues(this.values);n.push(this.getIdValue(e,null)),this.setProperties({values:n},!0),this.setProperties({value:this.values[this.values.length-1]},!0)}else this.setProperties({value:this.getIdValue(e,null)},!0);var s=this.currentView();i(o(r.prototype),"clickHandler",this).call(this,e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!Object(l.X)(this.tableBodyElement.querySelectorAll("."+k)[0])&&"Year"===s&&this.tableBodyElement.querySelectorAll("."+k)[0].classList.remove(k)}},{key:"switchView",value:function(e,t,n,s){i(o(r.prototype),"switchView",this).call(this,e,t,this.isMultiSelection,s)}},{key:"getModuleName",value:function(){return i(o(r.prototype),"getModuleName",this).call(this),"calendar"}},{key:"getPersistData",value:function(){return i(o(r.prototype),"getPersistData",this).call(this),this.addOnPersist(["value","values"])}},{key:"onPropertyChanged",value:function(e,t){this.effect="",this.rangeValidation(this.min,this.max);for(var n=0,s=Object.keys(e);n<s.length;n++){switch(s[n]){case"value":this.isDateSelected&&("string"==typeof e.value?this.setProperties({value:new Date(this.checkValue(e.value))},!0):e.value=new Date(this.checkValue(e.value)),isNaN(+this.value)&&this.setProperties({value:t.value},!0),this.update());break;case"values":if(this.isDateSelected){if("string"==typeof e.values||"number"==typeof e.values)this.setProperties({values:null},!0);else{for(var a=this.copyValues(this.values),l=0;l<a.length;l++){var h=a[l];this.checkDateValue(h)&&!i(o(r.prototype),"checkPresentDate",this).call(this,h,a)&&a.push(h)}this.setProperties({values:a},!0),this.values.length>0&&this.setProperties({value:e.values[e.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:e.isMultiSelection},!0),this.update());break;default:i(o(r.prototype),"onPropertyChanged",this).call(this,e,t,this.isMultiSelection,this.values)}}}},{key:"destroy",value:function(){if(i(o(r.prototype),"destroy",this).call(this),"calendar"===this.getModuleName()){var e=Object(l.C)(this.element,"form");e&&l.l.remove(e,"reset",this.formResetHandler.bind(this))}}},{key:"navigateTo",value:function(e,t,n){this.minMaxUpdate(),i(o(r.prototype),"navigateTo",this).call(this,e,t,n)}},{key:"currentView",value:function(){return i(o(r.prototype),"currentView",this).call(this)}},{key:"addDate",value:function(e){if("string"!=typeof e&&"number"!=typeof e){var t=this.copyValues(this.values);if("object"==typeof e&&e.length>0)for(var n=e,s=0;s<n.length;s++)this.checkDateValue(n[s])&&!i(o(r.prototype),"checkPresentDate",this).call(this,n[s],t)&&(!Object(l.X)(t)&&t.length>0?t.push(n[s]):t=[new Date(+n[s])]);else this.checkDateValue(e)&&!i(o(r.prototype),"checkPresentDate",this).call(this,e,t)&&(!Object(l.X)(t)&&t.length>0?t.push(e):t=[new Date(+e)]);this.setProperties({values:t},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,t),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}},{key:"removeDate",value:function(e){if("string"!=typeof e&&"number"!=typeof e&&!Object(l.X)(this.values)&&this.values.length>0){var t=this.copyValues(this.values);if("object"==typeof e&&e.length>0)for(var i=e,n=0;n<i.length;n++)for(var r=0;r<t.length;r++)+t[r]==+i[n]&&t.splice(r,1);else for(var s=0;s<t.length;s++)+t[s]==+e&&t.splice(s,1);this.setProperties({values:t},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}}},{key:"setTodayDate",value:function(e){var t=new Date(+e);this.setProperties({value:t},!0),i(o(r.prototype),"todayButtonClick",this).call(this,null,t,!0)}},{key:"update",value:function(){this.validateDate(),this.minMaxUpdate(),i(o(r.prototype),"setValueUpdate",this).call(this)}},{key:"selectDate",value:function(e,t,n){i(o(r.prototype),"selectDate",this).call(this,e,t,n,this.isMultiSelection,this.values),this.isMultiSelection&&!Object(l.X)(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)}},{key:"changeEvent",value:function(e){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))}},{key:"triggerChange",value:function(e){!Object(l.X)(this.todayButtonEvent)&&this.isTodayClicked&&(e=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=e||null,this.changedArgs.isInteracted=!Object(l.X)(e),Object(l.X)(this.value)||this.setProperties({value:this.value},!0),this.isMultiSelection||+this.value===Number.NaN||+this.value==+this.previousDate&&(null!=this.previousDate||isNaN(+this.value))?Object(l.X)(this.values)||this.previousValues===this.values.length||(this.changeEvent(e),this.previousValues=this.values.length):this.changeEvent(e)}}]),r}(S);return m([Object(l.s)(null)],e.prototype,"value",void 0),m([Object(l.s)(null)],e.prototype,"values",void 0),m([Object(l.s)(!1)],e.prototype,"isMultiSelection",void 0),m([Object(l.k)()],e.prototype,"change",void 0),e=m([l.q],e)}(),x=function(){function e(t){p(this,e),this.calendarInstance=t}return f(e,[{key:"getModuleName",value:function(){return"islamic"}},{key:"islamicTitleUpdate",value:function(e,t){var i=new l.n(this.calendarInstance.locale);switch(t){case"days":this.calendarInstance.headerTitleElement.textContent=i.formatDate(e,{type:"dateTime",format:"MMMMyyyy",calendar:"islamic"});break;case"months":this.calendarInstance.headerTitleElement.textContent=i.formatDate(e,{type:"dateTime",format:"yyyy",calendar:"islamic"})}}},{key:"islamicRenderDays",value:function(e,t,i,n){var r,s=[],a=new Date(this.islamicInValue(e));this.islamicTitleUpdate(e,"days");var o=this.getIslamicDate(a),h=this.toGregorian(o.year,o.month,1),c=o.month;for(a=h;a.getDay()!==this.calendarInstance.firstDayOfWeek;)this.calendarInstance.setStartDate(a,-864e5);for(var u=0;u<42;++u){var d=this.calendarInstance.createElement("td",{className:"e-cell"}),p=this.calendarInstance.createElement("span");u%7==0&&this.calendarInstance.weekNumber&&(p.textContent=""+this.calendarInstance.getWeek(a),d.appendChild(p),Object(l.v)([d],"e-week-number"),s.push(d)),r=new Date(+a),a=this.calendarInstance.minMaxDate(a);var g={type:"dateTime",skeleton:"full",calendar:"islamic"},f=this.calendarInstance.globalize.parseDate(this.calendarInstance.globalize.formatDate(a,g),g),m=this.islamicDayCell(a),v=this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"full",calendar:"islamic"}),b=this.calendarInstance.createElement("span");b.textContent=this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"d",calendar:"islamic"});var y=this.calendarInstance.min>a||this.calendarInstance.max<a;y?(Object(l.v)([m],"e-disabled"),Object(l.v)([m],"e-overlay")):b.setAttribute("title",""+v),c!==this.getIslamicDate(a).month&&Object(l.v)([m],"e-other-month"),0!==a.getDay()&&6!==a.getDay()||Object(l.v)([m],"e-weekend"),m.appendChild(b),this.calendarInstance.renderDayCellArgs={date:a,isDisabled:!1,element:m,isOutOfRange:y};var C=this.calendarInstance.renderDayCellArgs;if(this.calendarInstance.renderDayCellEvent(C),C.isDisabled)if(this.calendarInstance.isMultiSelection){if(!Object(l.X)(this.calendarInstance.values)&&this.calendarInstance.values.length>0)for(var w=0;w<n.length;w++)+new Date(this.calendarInstance.globalize.formatDate(C.date,{type:"date",skeleton:"yMd",calendar:"islamic"}))==+new Date(this.calendarInstance.globalize.formatDate(this.calendarInstance.values[w],{type:"date",skeleton:"yMd",calendar:"islamic"}))&&(this.calendarInstance.values.splice(w,1),w=-1)}else t&&+t==+C.date&&this.calendarInstance.setProperties({value:null},!0);this.calendarInstance.renderDayCellArgs.isDisabled&&!m.classList.contains("e-selected")&&(Object(l.v)([m],"e-disabled"),Object(l.v)([m],"e-overlay"),+this.calendarInstance.renderDayCellArgs.date==+this.calendarInstance.todayDate&&(this.calendarInstance.todayDisabled=!0));var k=m.classList.contains("e-other-month"),S=m.classList.contains("e-disabled");if(S||l.l.add(m,"click",this.calendarInstance.clickHandler,this.calendarInstance),!this.calendarInstance.isMultiSelection||Object(l.X)(this.calendarInstance.values)||k||S)k||S||!this.calendarInstance.getDateVal(a,t)?this.calendarInstance.updateFocus(k,S,a,m,e):Object(l.v)([m],"e-selected");else{for(var O=0;O<this.calendarInstance.values.length;O++)this.calendarInstance.globalize.formatDate(a,{type:"date",skeleton:"short",calendar:"islamic"})===this.calendarInstance.globalize.formatDate(this.calendarInstance.values[O],{type:"date",skeleton:"short",calendar:"islamic"})&&this.calendarInstance.getDateVal(a,this.calendarInstance.values[O])?Object(l.v)([m],"e-selected"):this.calendarInstance.updateFocus(k,S,a,m,e);this.calendarInstance.values.length<=0&&this.calendarInstance.updateFocus(k,S,a,m,e)}f.getDate()===(new Date).getDate()&&f.getMonth()===(new Date).getMonth()&&f.getFullYear()===(new Date).getFullYear()&&Object(l.v)([m],"e-today"),a=new Date(+r),s.push(this.calendarInstance.renderDayCellArgs.element),this.calendarInstance.addDay(a,1,null,this.calendarInstance.max,this.calendarInstance.min)}return s}},{key:"islamicIconHandler",value:function(){new Date(this.islamicInValue(this.calendarInstance.currentDate)).setDate(1);var e=new Date(this.islamicInValue(this.calendarInstance.currentDate));switch(this.calendarInstance.currentView()){case"Month":var t=this.islamicCompareMonth(e,this.calendarInstance.min)<1,i=this.islamicCompareMonth(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(t),this.calendarInstance.nextIconHandler(i);break;case"Year":var n=this.hijriCompareYear(e,this.calendarInstance.min)<1,r=this.hijriCompareYear(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(n),this.calendarInstance.nextIconHandler(r);break;case"Decade":var s=this.hijriCompareDecade(e,this.calendarInstance.min)<1,a=this.hijriCompareDecade(e,this.calendarInstance.max)>-1;this.calendarInstance.previousIconHandler(s),this.calendarInstance.nextIconHandler(a)}}},{key:"islamicNext",value:function(){this.calendarInstance.effect="";var e=this.calendarInstance.getViewNumber(this.calendarInstance.currentView()),t=this.getIslamicDate(this.calendarInstance.currentDate);switch(this.calendarInstance.currentView()){case"Year":this.calendarInstance.currentDate=this.toGregorian(t.year+1,t.month,1),this.calendarInstance.switchView(e);break;case"Month":this.calendarInstance.currentDate=this.toGregorian(t.year,t.month+1,1),this.calendarInstance.switchView(e);break;case"Decade":this.calendarInstance.currentDate=this.toGregorian(t.year+10,t.month,1),this.calendarInstance.switchView(e)}}},{key:"islamicPrevious",value:function(){var e=this.calendarInstance.getViewNumber(this.calendarInstance.currentView());this.calendarInstance.effect="";var t=this.getIslamicDate(this.calendarInstance.currentDate);switch(this.calendarInstance.currentView()){case"Month":this.calendarInstance.currentDate=this.toGregorian(t.year,t.month-1,1),this.calendarInstance.switchView(e);break;case"Year":this.calendarInstance.currentDate=this.toGregorian(t.year-1,t.month,1),this.calendarInstance.switchView(e);break;case"Decade":this.calendarInstance.currentDate=this.toGregorian(t.year-10,t.month-1,1),this.calendarInstance.switchView(e)}}},{key:"islamicRenderYears",value:function(e,t){this.calendarInstance.removeTableHeadElement();var i=[],n=Object(l.X)(t),r=new Date(this.islamicInValue(this.calendarInstance.currentDate)),s=this.getIslamicDate(r);r=l.m.toGregorian(s.year,1,1);var a=s.month,o=s.year,h=s.year,c=this.getIslamicDate(this.calendarInstance.min).year,u=this.getIslamicDate(this.calendarInstance.min).month,d=this.getIslamicDate(this.calendarInstance.max).year,p=this.getIslamicDate(this.calendarInstance.max).month;this.islamicTitleUpdate(this.calendarInstance.currentDate,"months");for(var g=1;g<=12;++g){var f=this.getIslamicDate(r);r=l.m.toGregorian(f.year,g,1);var m=this.islamicDayCell(r),v=this.calendarInstance.createElement("span"),b=t&&this.getIslamicDate(t).month===this.getIslamicDate(r).month,y=t&&this.getIslamicDate(t).year===o&&b;v.textContent=this.calendarInstance.globalize.formatDate(r,{type:"dateTime",format:"MMM",calendar:"islamic"}),this.calendarInstance.min&&(h<c||g<u&&h===c)||this.calendarInstance.max&&(h>d||g>p&&h>=d)?Object(l.v)([m],"e-disabled"):!n&&y?Object(l.v)([m],"e-selected"):this.getIslamicDate(r).month===a&&this.getIslamicDate(this.calendarInstance.currentDate).month===a&&Object(l.v)([m],"e-focused-date"),m.classList.contains("e-disabled")||l.l.add(m,"click",this.calendarInstance.clickHandler,this.calendarInstance),m.appendChild(v),i.push(m)}this.islamicRenderTemplate(i,4,"e-year",e,t)}},{key:"islamicRenderDecade",value:function(e,t){this.calendarInstance.removeTableHeadElement();var i=[],n=new Date(this.islamicInValue(this.calendarInstance.currentDate)),r=this.getIslamicDate(n),s=(n=l.m.toGregorian(r.year,1,1)).getFullYear(),a=new Date(this.islamicInValue(s-s%10)),o=new Date(this.islamicInValue(s-s%10+9)),h=a.getFullYear(),c=o.getFullYear(),u=this.calendarInstance.globalize.formatDate(a,{type:"dateTime",format:"y",calendar:"islamic"}),d=this.calendarInstance.globalize.formatDate(o,{type:"dateTime",format:"y",calendar:"islamic"});this.calendarInstance.headerTitleElement.textContent=u+" - "+d;for(var p=new Date(s-s%10-2,0,1).getFullYear(),g=1;g<=12;++g){var f=p+g;n.setFullYear(f),n.setDate(1),n.setMonth(0);var m=this.getIslamicDate(n);n=l.m.toGregorian(m.year,1,1);var v=this.islamicDayCell(n);Object(l.x)(v,{role:"gridcell"});var b=this.calendarInstance.createElement("span");b.textContent=this.calendarInstance.globalize.formatDate(n,{type:"dateTime",format:"y",calendar:"islamic"}),f<h||f>c?Object(l.v)([v],"e-other-month"):f<new Date(this.islamicInValue(this.calendarInstance.min)).getFullYear()||f>new Date(this.islamicInValue(this.calendarInstance.max)).getFullYear()?Object(l.v)([v],"e-disabled"):Object(l.X)(t)||this.getIslamicDate(n).year!==this.getIslamicDate(t).year?n.getFullYear()!==this.calendarInstance.currentDate.getFullYear()||v.classList.contains("e-disabled")||Object(l.v)([v],"e-focused-date"):Object(l.v)([v],"e-selected"),v.classList.contains("e-disabled")||l.l.add(v,"click",this.calendarInstance.clickHandler,this.calendarInstance),v.appendChild(b),i.push(v)}this.islamicRenderTemplate(i,4,"e-decade",e,t)}},{key:"islamicDayCell",value:function(e){var t={skeleton:"full",type:"dateTime",calendar:"islamic"},i=this.calendarInstance.globalize.formatDate(e,t),n=this.calendarInstance.globalize.parseDate(i,t).valueOf(),r={className:"e-cell",attrs:{id:""+Object(l.U)(""+n),"aria-selected":"false",role:"gridcell"}};return this.calendarInstance.createElement("td",r)}},{key:"islamicRenderTemplate",value:function(e,t,i,n,r){var s,a=this.calendarInstance.getViewNumber(this.calendarInstance.currentView());this.calendarInstance.tableBodyElement=this.calendarInstance.createElement("tbody"),this.calendarInstance.table.appendChild(this.calendarInstance.tableBodyElement),Object(l.ib)([this.calendarInstance.contentElement,this.calendarInstance.headerElement],["e-month","e-decade","e-year"]),Object(l.v)([this.calendarInstance.contentElement,this.calendarInstance.headerElement],[i]);for(var o=t,h=0,c=0;c<e.length/t;++c){for(s=this.calendarInstance.createElement("tr",{attrs:{role:"row"}}),h=0+h;h<o;h++)e[h].classList.contains("e-week-number")||Object(l.X)(e[h].children[0])||(Object(l.v)([e[h].children[0]],["e-day"]),Object(l.kb)(e[h].children[0],{duration:600,isCenterRipple:!0})),s.appendChild(e[h]),this.calendarInstance.weekNumber&&7===h&&e[7].classList.contains("e-other-month")&&Object(l.v)([s],"e-month-hide"),!this.calendarInstance.weekNumber&&6===h&&e[6].classList.contains("e-other-month")&&Object(l.v)([s],"e-month-hide"),this.calendarInstance.weekNumber?41===h&&e[41].classList.contains("e-other-month")&&Object(l.v)([s],"e-month-hide"):35===h&&e[35].classList.contains("e-other-month")&&Object(l.v)([s],"e-month-hide");o+=t,h+=0,this.calendarInstance.tableBodyElement.appendChild(s)}this.calendarInstance.table.querySelector("tbody").className=this.calendarInstance.effect,this.islamicIconHandler(),(a!==this.calendarInstance.getViewNumber(this.calendarInstance.currentView())||0===a&&a!==this.calendarInstance.getViewNumber(this.calendarInstance.currentView()))&&this.calendarInstance.navigateHandler(n),this.calendarInstance.setAriaActiveDescendant(),this.calendarInstance.changedArgs={value:this.calendarInstance.value,values:this.calendarInstance.values},this.calendarInstance.changeHandler()}},{key:"islamicCompareMonth",value:function(e,t){var i=this.getIslamicDate(e),n=this.getIslamicDate(t);return i.year>n.year?1:i.year<n.year?-1:i.month===n.month?0:i.month>n.month?1:-1}},{key:"islamicCompare",value:function(e,t,i){var n,r,s=this.getIslamicDate(e),a=this.getIslamicDate(t).year;return n=a,r=0,i&&(n=(a-=a%i)-a%i+i-1),s.year>n?r=1:("Decade"===this.calendarInstance.currentView()&&s.year<a&&!(e.getFullYear()>=2060&&e.getFullYear()<=2069)||s.year<a&&"Year"===this.calendarInstance.currentView())&&(r=-1),r}},{key:"getIslamicDate",value:function(e){return l.m.getHijriDate(e)}},{key:"toGregorian",value:function(e,t,i){return l.m.toGregorian(e,t,i)}},{key:"hijriCompareYear",value:function(e,t){return this.islamicCompare(e,t,0)}},{key:"hijriCompareDecade",value:function(e,t){return this.islamicCompare(e,t,10)}},{key:"destroy",value:function(){this.calendarInstance=null}},{key:"islamicInValue",value:function(e){return e instanceof Date?e.toUTCString():""+e}}]),e}(),j=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},R="e-datepicker",D=["title","class","style"],E=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).previousElementValue="",n.isDateIconClicked=!1,n.isAltKeyPressed=!1,n.isInteracted=!0,n.isBlazorServer=!1,n.invalidValueString=null,n.checkPreviousValue=null,n.isAngular=!1,n.preventChange=!1,n.isIconClicked=!1,n.datepickerOptions=e,n}return f(r,[{key:"render",value:function(){this.initialize(),this.bindEvents(),this.renderComplete(),this.isBlazorServer||this.setTimeZone(this.serverTimezoneOffset)}},{key:"setTimeZone",value:function(e){if(!Object(l.X)(this.serverTimezoneOffset)&&this.value){var t=e+(new Date).getTimezoneOffset()/60;t=this.isDayLightSaving()?t--:t,this.value=new Date(this.value.getTime()+60*t*60*1e3),this.updateInput()}}},{key:"isDayLightSaving",value:function(){var e=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),t=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(e,t)}},{key:"setAllowEdit",value:function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(l.x)(this.inputElement,{readonly:""}),this.updateIconState()}},{key:"updateIconState",value:function(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):Object(l.v)([this.inputWrapper.container],["e-non-edit"])}},{key:"initialize",value:function(){if(this.isBlazorServer){var e=this.element.parentElement;this.inputWrapper={container:e,clearButton:e.querySelector(".e-clear-icon"),buttons:[e.querySelector(".e-date-icon")]},u.c.bindInitialEvent({element:this.inputElement,floatLabelType:this.floatLabelType}),this.showClearButton&&this.inputWrapper.clearButton&&u.c.wireClearBtnEvents(this.inputElement,this.inputWrapper.clearButton,this.inputWrapper.container),this.setAllowEdit()}else this.checkInvalidValue(this.value),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.updateInput();this.previousElementValue=this.inputElement.value,this.previousDate=Object(l.X)(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value}},{key:"createInput",value:function(){var e={"aria-live":"assertive","aria-atomic":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if("datepicker"===this.getModuleName()){var t={placeholder:this.placeholder};this.globalize=new l.n(this.locale),this.l10n=new l.p("datepicker",t,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}var i=this.cssClass;Object(l.X)(this.cssClass)||""===this.cssClass||(i=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=u.c.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:i,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:["e-input-group-icon e-date-icon e-icons"]},this.createElement),this.setWidth(this.width),this.inputElement.setAttribute("name",""!==this.inputElement.name?""+this.inputElement.getAttribute("name"):""+this.element.id),Object(l.x)(this.inputElement,e),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),u.c.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),Object(l.v)([this.inputWrapper.container],"e-date-wrapper")}},{key:"updateInput",value:function(){var e;if(this.value&&!this.isCalendar()&&(this.isBlazorServer||this.disabledDates()),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(i(o(r.prototype),"validateDate",this).call(this),this.minMaxUpdates(),i(o(r.prototype),"minMaxUpdate",this).call(this)),!Object(l.X)(this.value)){var t,n=this.value,s=Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString;if("datetimepicker"===this.getModuleName()?t=this.globalize.formatDate(this.value,"Gregorian"===this.calendarMode?{format:s,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:s,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(e="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.value,e)),+n<=+this.max&&+n>=+this.min)this.updateInputValue(t);else{var a=+n>=+this.max||!+this.value||!+this.value||+n<=+this.min;!this.strictMode&&a&&this.updateInputValue(t)}}Object(l.X)(this.value)&&this.strictMode&&this.updateInputValue(""),!this.strictMode&&Object(l.X)(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()}},{key:"minMaxUpdates",value:function(){!Object(l.X)(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!Object(l.X)(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})}},{key:"checkStringValue",value:function(e){var t=null,i=null,n=null;if("datetimepicker"===this.getModuleName()){var r=new l.n(this.locale);"Gregorian"===this.calendarMode?(i={format:this.dateTimeFormat,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"},n={format:r.getDatePattern({skeleton:Object(l.W)()?"d":"yMd"}),type:"dateTime"}):(i={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:r.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else i="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return t=this.checkDateValue(this.globalize.parseDate(e,i)),Object(l.X)(t)&&"datetimepicker"===this.getModuleName()&&(t=this.checkDateValue(this.globalize.parseDate(e,n))),t}},{key:"checkInvalidValue",value:function(e){if(!(e instanceof Date||Object(l.X)(e))){var t=null,i=e;"number"==typeof e&&(i=e.toString());if("datetimepicker"===this.getModuleName()){var n=new l.n(this.locale);"Gregorian"===this.calendarMode?({format:this.dateTimeFormat,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"},{format:n.getDatePattern({skeleton:Object(l.W)()?"d":"yMd"}),type:"dateTime"}):({format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},{format:n.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else"Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};var r=!1;if("string"!=typeof i)i=null,r=!0;else if("string"==typeof i&&(i=i.trim()),!(t=this.checkStringValue(i))){var s=null;s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/.test(i)&&!s.test(i)||/^[a-zA-Z0-9- ]*$/.test(i)||isNaN(+new Date(this.checkValue(i)))?r=!0:t=new Date(i)}r?(this.strictMode||(this.invalidValueString=i),this.setProperties({value:null},!0)):this.setProperties({value:t},!0)}}},{key:"bindInputEvent",value:function(){Object(l.X)(this.formatString)||(-1===this.formatString.indexOf("y")?l.l.add(this.inputElement,"input",this.inputHandler,this):l.l.remove(this.inputElement,"input",this.inputHandler))}},{key:"bindEvents",value:function(){l.l.add(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.dateIconHandler,this),l.l.add(this.inputElement,"focus",this.inputFocusHandler,this),l.l.add(this.inputElement,"blur",this.inputBlurHandler,this),this.bindInputEvent(),l.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&(this.inputWrapper.clearButton||this.isBlazorServer)&&l.l.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&l.l.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new l.o(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})}},{key:"unBindEvents",value:function(){l.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.dateIconHandler),l.l.remove(this.inputElement,"focus",this.inputFocusHandler),l.l.remove(this.inputElement,"blur",this.inputBlurHandler),l.l.remove(this.inputElement,"change",this.inputChangeHandler),this.showClearButton&&(this.inputWrapper.clearButton||this.isBlazorServer)&&l.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&l.l.remove(this.formElement,"reset",this.resetFormHandler)}},{key:"resetFormHandler",value:function(){if(this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value");"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(e="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.isBlazorServer||(this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(e),this.errorClass()))}}},{key:"restoreValue",value:function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=Object(l.X)(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"})}},{key:"inputChangeHandler",value:function(e){this.enabled&&e.stopPropagation()}},{key:"bindClearEvent",value:function(){this.showClearButton&&this.inputWrapper.clearButton&&l.l.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)}},{key:"resetHandler",value:function(e){this.enabled&&(e.preventDefault(),this.clear(e))}},{key:"clear",value:function(e){this.isBlazorServer||this.setProperties({value:null},!0),this.updateInputValue(""),this.trigger("cleared",{event:e}),this.invalidValueString="",this.isBlazorServer||(this.updateInput(),this.popupUpdate(),this.changeEvent(e)),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnValueCleared")}},{key:"preventEventBubbling",value:function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")}},{key:"updateInputValue",value:function(e){u.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)}},{key:"dateIconHandler",value:function(e){this.enabled&&(this.isIconClicked=!0,l.d.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),this.isBlazorServer||e.preventDefault(),this.readonly||(this.isCalendar()&&!this.isBlazorServer?this.hide(e):(!this.isBlazorServer||this.isBlazorServer&&this.inputWrapper.container.nextElementSibling)&&(this.isDateIconClicked=!0,this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus(),this.inputElement.focus(),Object(l.v)([this.inputWrapper.container],["e-input-focus"]),Object(l.v)(this.inputWrapper.buttons,"e-active"))),this.isIconClicked=!1)}},{key:"updateHtmlAttributeToWrapper",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];if(!Object(l.X)(this.htmlAttributes[i])&&D.indexOf(i)>-1)if("class"===i){var n=this.htmlAttributes[i].replace(/\s+/g," ").trim();""!==n&&Object(l.v)([this.inputWrapper.container],n.split(" "))}else if("style"===i){var r=this.inputWrapper.container.getAttribute(i);Object(l.X)(r)?r=this.htmlAttributes[i]:";"===r.charAt(r.length-1)?r+=this.htmlAttributes[i]:r=r+";"+this.htmlAttributes[i],this.inputWrapper.container.setAttribute(i,r)}else this.inputWrapper.container.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateHtmlAttributeToElement",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];D.indexOf(i)<0&&this.inputElement.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateCssClass",value:function(e,t){Object(l.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(l.X)(e)||(e=e.replace(/\s+/g," ").trim()),u.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&u.c.setCssClass(e,[this.popupWrapper],t)}},{key:"CalendarKeyActionHandle",value:function(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value==+this.currentDate||this.isCalendar()||this.inputWrapper.container.children[this.index].focus():this.show(null,e),"datetimepicker"===this.getModuleName()&&this.inputElement.focus();break;case"tab":this.hide(e)}}},{key:"inputFocusHandler",value:function(){if(this.enabled){var e={model:Object(l.W)()&&this.isServerRendered?null:this};this.isDateIconClicked=!1,this.trigger("focus",e),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}}},{key:"inputHandler",value:function(e){this.isPopupClicked=!1}},{key:"inputBlurHandler",value:function(e){if(this.enabled){if(this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),""===this.inputElement.value&&Object(l.X)(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),"datepicker"===this.getModuleName()){var t={model:Object(l.W)()&&this.isServerRendered?null:this};this.trigger("blur",t)}this.isCalendar()&&(this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new l.o(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.CalendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}}},{key:"documentHandler",value:function(e){!Object(l.X)(this.popupObj)&&(this.inputWrapper.container.contains(e.target)||this.popupObj.element&&this.popupObj.element.contains(e.target))&&"touchstart"!==e.type&&e.preventDefault();var t=e.target;Object(l.C)(t,".e-datepicker.e-popup-wrapper")||Object(l.C)(t,".e-input-group")===this.inputWrapper.container||t.classList.contains("e-day")?Object(l.C)(t,".e-datepicker.e-popup-wrapper")&&(t.classList.contains("e-day")&&!Object(l.X)(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&Object(l.C)(t,".e-content")&&Object(l.C)(t,".e-content").classList.contains("e-"+this.depth.toLowerCase())||Object(l.C)(t,".e-footer-container")&&t.classList.contains("e-today")&&t.classList.contains("e-btn")&&+new Date(+this.value)==+i(o(r.prototype),"generateTodayVal",this).call(this,this.value)&&!this.isBlazorServer)&&this.hide(e):(this.hide(e),this.focusOut())}},{key:"inputKeyActionHandle",value:function(e){var t=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e)),"datepicker"===this.getModuleName()&&(this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnPopupHide",!0):this.show(null,e));break;case"escape":this.hide(e);break;case"enter":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.isCalendar()||document.activeElement!==this.inputElement||this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break;case"tab":case"shiftTab":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictModeUpdate",this.inputElement.value):(this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),this.hide(e);break;default:this.defaultAction(e),"select"===e.action&&t===this.depth&&this.hide(e)}}},{key:"defaultAction",value:function(e){this.previousDate=!Object(l.X)(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(i(o(r.prototype),"keyActionHandle",this).call(this,e),this.isBlazorServer||Object(l.x)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))}},{key:"popupUpdate",value:function(){if((Object(l.X)(this.value)&&!Object(l.X)(this.previousDate)||+this.value!=+this.previousDate)&&(this.popupObj&&this.popupObj.element.querySelectorAll(".e-selected").length>0&&Object(l.ib)(this.popupObj.element.querySelectorAll(".e-selected"),["e-selected"]),!Object(l.X)(this.value)&&!this.isBlazorServer&&+this.value>=+this.min&&+this.value<=+this.max)){var e=new Date(this.checkValue(this.value));i(o(r.prototype),"navigateTo",this).call(this,"Month",e)}}},{key:"strictModeUpdate",value:function(){var e,t,i,n;e="datetimepicker"===this.getModuleName()?Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString:Object(l.X)(this.formatString)?this.formatString:this.formatString.replace("dd","d"),Object(l.X)(e)||e.split("M").length-1<3&&(e=e.replace("MM","M")),"datetimepicker"===this.getModuleName()?i="Gregorian"===this.calendarMode?{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:i=t="Gregorian"===this.calendarMode?{format:e,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},"string"==typeof this.inputElement.value&&(this.inputElement.value=this.inputElement.value.trim()),"datetimepicker"===this.getModuleName()?this.checkDateValue(this.globalize.parseDate(this.inputElement.value,i))?n=this.globalize.parseDate(this.inputElement.value,i):(t="Gregorian"===this.calendarMode?{type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{type:"dateTime",skeleton:"yMd",calendar:"islamic"},n=this.globalize.parseDate(this.inputElement.value,t)):(n=this.globalize.parseDate(this.inputElement.value,i),!Object(l.X)(this.formatString)&&""!==this.inputElement.value&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&-1===this.formatString.indexOf("y")&&n.setFullYear(this.value.getFullYear())),"datepicker"===this.getModuleName()&&this.value&&!isNaN(+this.value)&&n&&n.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&n?(this.updateInputValue(this.globalize.formatDate(n,i)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:n},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:n},!0),this.strictMode&&!n&&""===this.inputElement.value&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),Object(l.X)(this.value)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)))}},{key:"createCalendar",value:function(){var e=this;this.isBlazorServer?(this.popupWrapper=this.inputWrapper.container.nextElementSibling,this.calendarElement=this.popupWrapper.firstElementChild,this.tableBodyElement=Object(l.lb)("tbody",this.calendarElement),this.contentElement=Object(l.lb)(".e-content",this.calendarElement)):(this.popupWrapper=this.createElement("div",{className:R+" e-popup-wrapper"}),Object(l.X)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass)),l.d.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=R+" e-date-modal",document.body.className+=" e-date-overflow",this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new h.c(this.popupWrapper,{content:this.isBlazorServer?null:this.calendarElement,relateTo:l.d.isDevice?document.body:this.inputWrapper.container,position:l.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:4,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:l.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:function(){"datetimepicker"!==e.getModuleName()&&document.activeElement!==e.inputElement&&(e.defaultKeyConfigs=Object(l.K)(e.defaultKeyConfigs,e.keyConfigs),e.calendarElement.children[1].firstElementChild.focus(),e.calendarKeyboardModules=new l.o(e.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:e.CalendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}),e.calendarKeyboardModules=new l.o(e.inputWrapper.container.children[e.index],{eventName:"keydown",keyAction:e.CalendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}))},close:function(){e.isDateIconClicked&&e.inputWrapper.container.children[e.index].focus(),e.value&&!e.isBlazorServer&&e.disabledDates(),e.popupObj&&e.popupObj.destroy(),Object(l.I)(e.popupWrapper),e.popupObj=e.popupWrapper=null,e.setAriaAttributes()},targetExitViewport:function(){l.d.isDevice||e.hide()}}),this.isBlazorServer||(this.popupObj.element.className+=" "+this.cssClass),this.setAriaAttributes()}},{key:"setAriaDisabled",value:function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)}},{key:"modelHeader",value:function(){var e,t=this.createElement("div",{className:"e-model-header"}),i=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),r=this.createElement("span",{className:"e-model-day"}),s=this.createElement("span",{className:"e-model-month"});e="Gregorian"===this.calendarMode?{format:"y",skeleton:"dateTime"}:{format:"y",skeleton:"dateTime",calendar:"islamic"},i.textContent=""+this.globalize.formatDate(this.value||new Date,e),e="Gregorian"===this.calendarMode?{format:"E",skeleton:"dateTime"}:{format:"E",skeleton:"dateTime",calendar:"islamic"},r.textContent=this.globalize.formatDate(this.value||new Date,e)+", ",e="Gregorian"===this.calendarMode?{format:"MMM d",skeleton:"dateTime"}:{format:"MMM d",skeleton:"dateTime",calendar:"islamic"},s.textContent=""+this.globalize.formatDate(this.value||new Date,e),t.appendChild(i),n.appendChild(r),n.appendChild(s),t.appendChild(n),this.calendarElement.insertBefore(t,this.calendarElement.firstElementChild)}},{key:"changeTrigger",value:function(e){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.changedArgs.value=this.value,this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!Object(l.X)(e),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0)}},{key:"navigatedEvent",value:function(){this.trigger("navigated",this.navigatedArgs)}},{key:"changeEvent",value:function(e){(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.selectCalendar(e),this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.hide(e),this.previousElementValue=this.inputElement.value,this.errorClass())}},{key:"requiredModules",value:function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),e}},{key:"selectCalendar",value:function(e){var t,i,n;i="datetimepicker"===this.getModuleName()&&Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,this.value&&("datetimepicker"===this.getModuleName()?(n="Gregorian"===this.calendarMode?{format:i,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:i,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.changedArgs.value,n)):(n="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},t=this.globalize.formatDate(this.changedArgs.value,n))),Object(l.X)(t)||this.updateInputValue(t)}},{key:"isCalendar",value:function(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-popup-wrapper"))}},{key:"setWidth",value:function(e){this.inputWrapper.container.style.width="number"==typeof e?Object(l.L)(this.width):"string"==typeof e?e.match(/px|%|em/)?this.width:Object(l.L)(this.width):"100%"}},{key:"show",value:function(e,t){var n=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var s,a=!0;Object(l.X)(this.value)||+this.value>=+this.min&&+this.value<=+this.max?s=this.value||null:(s=new Date(this.checkValue(this.value)),this.isBlazorServer||this.setProperties({value:null},!0)),this.isCalendar()||(this.isBlazorServer||(i(o(r.prototype),"render",this).call(this),this.setProperties({value:s||null},!0)),this.previousDate=s,this.createCalendar()),l.d.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){a=!1},popup:Object(l.W)()&&this.isServerRendered?null:this.popupObj,event:t||null,cancel:!1,appendTo:l.d.isDevice?this.mobilePopupWrapper:document.body},this.trigger("open",this.preventArgs,(function(e){n.preventArgs=e,a&&!n.preventArgs.cancel?(n.isBlazorServer&&(n.popupWrapper.style.visibility="",n.popupWrapper.style.width="auto",n.popupWrapper.style.height="auto"),Object(l.v)(n.inputWrapper.buttons,"e-active"),n.preventArgs.appendTo.appendChild(n.popupWrapper),n.popupObj.refreshPosition(n.inputElement),n.popupObj.show(new l.b({name:"FadeIn",duration:l.d.isDevice?0:300}),1e3===n.zIndex?n.element:null),n.isBlazorServer||i(o(r.prototype),"setOverlayIndex",n).call(n,n.mobilePopupWrapper,n.popupObj.element,n.modal,l.d.isDevice),n.setAriaAttributes()):(n.popupObj.destroy(),n.isBlazorServer&&n.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),n.popupWrapper=n.popupObj=null),Object(l.X)(n.inputElement)||""!==n.inputElement.value||!Object(l.X)(n.tableBodyElement)&&n.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(Object(l.v)([n.tableBodyElement.querySelector("td.e-selected")],"e-focused-date"),Object(l.ib)(n.tableBodyElement.querySelectorAll("td.e-selected"),"e-selected")),l.l.add(document,"mousedown touchstart",n.documentHandler,n)}))}}},{key:"hide",value:function(e){var t=this;if(Object(l.X)(this.popupWrapper))l.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var i=!0;this.preventArgs={preventDefault:function(){i=!1},popup:Object(l.W)()&&this.isServerRendered?null:this.popupObj,event:e||null,cancel:!1},Object(l.ib)(this.inputWrapper.buttons,"e-active"),Object(l.ib)([document.body],"e-date-overflow");var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,(function(e){t.closeEventCallback(i,e)})):this.closeEventCallback(i,n)}}},{key:"closeEventCallback",value:function(e,t){this.preventArgs=t,this.isCalendar()&&e&&!this.preventArgs.cancel&&(this.isBlazorServer?(this.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),this.isAltKeyPressed=!1,this.popupWrapper=this.popupObj=null):(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy()),Object(l.ib)(this.inputWrapper.buttons,"e-active")),this.setAriaAttributes(),l.d.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),l.d.isDevice&&(Object(l.X)(this.mobilePopupWrapper)||(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null)),l.l.remove(document,"mousedown touchstart",this.documentHandler),l.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}},{key:"focusIn",value:function(e){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),Object(l.v)([this.inputWrapper.container],["e-input-focus"]))}},{key:"focusOut",value:function(){document.activeElement===this.inputElement&&(Object(l.ib)([this.inputWrapper.container],["e-input-focus"]),this.inputElement.blur())}},{key:"currentView",value:function(){var e;return this.calendarElement&&(e=i(o(r.prototype),"currentView",this).call(this)),e}},{key:"navigateTo",value:function(e,t){this.calendarElement&&i(o(r.prototype),"navigateTo",this).call(this,e,t)}},{key:"destroy",value:function(){this.unBindEvents(),this.isBlazorServer||(i(o(r.prototype),"destroy",this).call(this),this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains("e-popup")&&i(o(r.prototype),"destroy",this).call(this)),this.inputElement&&(u.c.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-disabled":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},this.inputElement),Object(l.X)(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),l.l.remove(this.inputElement,"blur",this.inputBlurHandler),l.l.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&Object(l.I)(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.isBlazorServer||this.keyboardModule.destroy()),null===this.ngTag&&(this.inputElement&&(this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),Object(l.ib)([this.inputElement],["e-input"])),Object(l.ib)([this.element],[R]),Object(l.I)(this.inputWrapper.container)),this.formElement&&l.l.remove(this.formElement,"reset",this.resetFormHandler)}},{key:"ensureInputAttribute",value:function(){for(var e=[],t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(var i=0;i<e.length;i++)Object(l.X)(this.inputElementCopy.getAttribute(e[i]))?("value"===e[i].toLowerCase()&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[i])):("value"===e[i].toLowerCase()&&(this.inputElement.value=this.inputElementCopy.getAttribute(e[i])),this.inputElement.setAttribute(e[i],this.inputElementCopy.getAttribute(e[i])))}},{key:"preRender",value:function(){this.inputElementCopy=this.element.cloneNode(!0),Object(l.ib)([this.inputElementCopy],[R,"e-control","e-lib"]),this.inputElement=this.element,this.formElement=Object(l.C)(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.isBlazorServer=!(!Object(l.W)()||!this.isServerRendered||"datepicker"!==this.getModuleName()),this.isBlazorServer||(this.ngTag=null,"EJS-DATEPICKER"!==this.element.tagName&&"EJS-DATETIMEPICKER"!==this.element.tagName||(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?null!==this.ngTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):"datetimepicker"===this.getModuleName()?(this.element.id=Object(l.U)("ej2-datetimepicker"),null!==this.ngTag&&Object(l.x)(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=Object(l.U)("ej2-datepicker"),null!==this.ngTag&&Object(l.x)(this.inputElement,{id:this.element.id+"_input"})),null!==this.ngTag&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement()),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.isBlazorServer||(this.element.removeAttribute("tabindex"),i(o(r.prototype),"preRender",this).call(this))}},{key:"getDefaultKeyConfig",value:function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs}},{key:"validationAttribute",value:function(e,t){var i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");for(var n=["required","aria-required","form"],r=0;r<n.length;r++)if(!Object(l.X)(e.getAttribute(n[r]))){var s=e.getAttribute(n[r]);t.setAttribute(n[r],s),e.removeAttribute(n[r])}}},{key:"checkFormat",value:function(){var e=new l.n(this.locale);if(this.format)if("string"==typeof this.format)this.formatString=Object(l.W)()?this.format.replace(/tt/,"a"):this.format;else if(""===this.format.skeleton||Object(l.X)(this.format.skeleton))this.formatString="datetimepicker"===this.getModuleName()?this.dateTimeFormat:null;else{var t=this.format.skeleton;this.formatString="datetimepicker"===this.getModuleName()?e.getDatePattern({skeleton:t,type:"dateTime"}):e.getDatePattern({skeleton:t,type:"date"})}else this.formatString=null}},{key:"checkHtmlAttributes",value:function(e){this.globalize=new l.n(this.locale),this.checkFormat(),this.checkView();var t,i=e?Object(l.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"];t="datetimepicker"===this.getModuleName()?"Gregorian"===this.calendarMode?{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:"Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};var n,r=c(i);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(!Object(l.X)(this.inputElement.getAttribute(s)))switch(s){case"disabled":if((Object(l.X)(this.datepickerOptions)||void 0===this.datepickerOptions.enabled||e)&&!this.isBlazorServer){var a="disabled"!==this.inputElement.getAttribute(s)&&""!==this.inputElement.getAttribute(s)&&"true"!==this.inputElement.getAttribute(s);this.setProperties({enabled:a},!e)}break;case"readonly":if((Object(l.X)(this.datepickerOptions)||void 0===this.datepickerOptions.readonly||e)&&!this.isBlazorServer){var o="readonly"===this.inputElement.getAttribute(s)||""===this.inputElement.getAttribute(s)||"true"===this.inputElement.getAttribute(s);this.setProperties({readonly:o},!e)}break;case"placeholder":!Object(l.X)(this.datepickerOptions)&&void 0!==this.datepickerOptions.placeholder&&!e||this.isBlazorServer||(this.inputElement.getAttribute(s),this.setProperties({placeholder:this.inputElement.getAttribute(s)},!e));break;case"style":this.isBlazorServer||this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(s));break;case"name":this.isBlazorServer||this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(s));break;case"value":if((Object(l.X)(this.datepickerOptions)||void 0===this.datepickerOptions.value||e)&&!this.isBlazorServer){var h=this.inputElement.getAttribute(s);this.setProperties(Object(l.qb)(s,this.globalize.parseDate(h,t),{}),!e)}break;case"min":if(+this.min==+new Date(1900,0,1)||e){var u=this.inputElement.getAttribute(s);this.setProperties(Object(l.qb)(s,this.globalize.parseDate(u),{}),!e)}break;case"max":if(+this.max==+new Date(2099,11,31)||e){var d=this.inputElement.getAttribute(s);this.setProperties(Object(l.qb)(s,this.globalize.parseDate(d),{}),!e)}break;case"type":"text"===this.inputElement.getAttribute(s)||this.isBlazorServer||this.inputElement.setAttribute("type","text")}}}catch(p){r.e(p)}finally{r.f()}}},{key:"getModuleName",value:function(){return"datepicker"}},{key:"disabledDates",value:function(){var e,t;e=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value));var n=this.previousDate;this.minMaxUpdates(),this.isBlazorServer||i(o(r.prototype),"render",this).call(this),this.previousDate=n;var s,a='*[id^="/id"]'.replace("/id",""+(e&&+e));this.strictMode||("string"==typeof this.value||"object"==typeof this.value&&+this.value!=+e)&&this.setProperties({value:e},!0),Object(l.X)(this.calendarElement.querySelectorAll(a)[0])||this.calendarElement.querySelectorAll(a)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date((new Date).setHours(0,0,0,0)))),"datetimepicker"===this.getModuleName()?s=this.globalize.formatDate(e,"Gregorian"===this.calendarMode?{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:Object(l.X)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(t="Gregorian"===this.calendarMode?{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s=this.globalize.formatDate(e,t)),this.popupObj||this.updateInputValue(s)}},{key:"setAriaAttributes",value:function(){if(this.isBlazorServer)if(this.isCalendar()){var e=this.tableBodyElement.querySelector("tr td.e-focused-date"),t=this.tableBodyElement.querySelector("tr td.e-selected"),i=e||t?(e||t).getAttribute("id"):"null";Object(l.x)(this.inputElement,{"aria-activedescendant":""+i})}else Object(l.x)(this.inputElement,{"aria-activedescendant":"null"});else this.isCalendar()?(u.c.addAttributes({"aria-expanded":"true"},this.inputElement),Object(l.x)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(u.c.addAttributes({"aria-expanded":"false"},this.inputElement),Object(l.x)(this.inputElement,{"aria-activedescendant":"null"}))}},{key:"errorClass",value:function(){var e='*[id^="/id"]'.replace("/id",""+ +this.value),t=this.calendarElement&&this.calendarElement.querySelectorAll(e)[0]&&this.calendarElement.querySelectorAll(e)[0].classList.contains("e-disabled");!Object(l.X)(this.value)&&!(+new Date(+this.value).setMilliseconds(0)>=+this.min&&+new Date(+this.value).setMilliseconds(0)<=+this.max)||!this.strictMode&&""!==this.inputElement.value&&Object(l.X)(this.value)||t?(Object(l.v)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"true"})):(Object(l.ib)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"false"}))}},{key:"onPropertyChanged",value:function(e,t){"Gregorian"===this.calendarMode?(this.formatString,Object(l.W)()):this.formatString;for(var n=0,s=Object.keys(e);n<s.length;n++){switch(s[n]){case"value":this.isInteracted=!1,this.invalidValueString=null,this.isBlazorServer||this.checkInvalidValue(e.value),e.value=this.value,this.previousElementValue=this.inputElement.value,this.isBlazorServer||(Object(l.X)(this.value)&&(this.updateInputValue(""),this.currentDate=new Date((new Date).setHours(0,0,0,0))),this.updateInput(),+this.previousDate!=+this.value&&this.changeTrigger(null)),this.isInteracted=!0;break;case"format":this.checkFormat(),this.bindInputEvent(),this.isBlazorServer||this.updateInput();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":u.c.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":u.c.setReadonly(this.readonly,this.inputElement);break;case"enabled":u.c.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new l.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),u.c.setPlaceholder(this.placeholder,this.inputElement),this.isBlazorServer||this.updateInput();break;case"enableRtl":u.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&!this.isBlazorServer&&i(o(r.prototype),"onPropertyChanged",this).call(this,e,t);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"showClearButton":u.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.isBlazorServer||this.updateInput();break;case"width":this.setWidth(e.width);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,u.c.removeFloating(this.inputWrapper),u.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;default:this.calendarElement&&!this.isBlazorServer&&i(o(r.prototype),"onPropertyChanged",this).call(this,e,t)}this.hide(null)}}}]),r}(O);return j([Object(l.s)(null)],e.prototype,"width",void 0),j([Object(l.s)(null)],e.prototype,"value",void 0),j([Object(l.s)(null)],e.prototype,"cssClass",void 0),j([Object(l.s)(!1)],e.prototype,"strictMode",void 0),j([Object(l.s)(null)],e.prototype,"format",void 0),j([Object(l.s)(!0)],e.prototype,"enabled",void 0),j([Object(l.s)({})],e.prototype,"htmlAttributes",void 0),j([Object(l.s)(null)],e.prototype,"values",void 0),j([Object(l.s)(!1)],e.prototype,"isMultiSelection",void 0),j([Object(l.s)(!0)],e.prototype,"showClearButton",void 0),j([Object(l.s)(!0)],e.prototype,"allowEdit",void 0),j([Object(l.s)(null)],e.prototype,"keyConfigs",void 0),j([Object(l.s)(!1)],e.prototype,"enablePersistence",void 0),j([Object(l.s)(1e3)],e.prototype,"zIndex",void 0),j([Object(l.s)(!1)],e.prototype,"readonly",void 0),j([Object(l.s)(null)],e.prototype,"placeholder",void 0),j([Object(l.s)("Never")],e.prototype,"floatLabelType",void 0),j([Object(l.s)(null)],e.prototype,"serverTimezoneOffset",void 0),j([Object(l.s)(!1)],e.prototype,"openOnFocus",void 0),j([Object(l.k)()],e.prototype,"open",void 0),j([Object(l.k)()],e.prototype,"cleared",void 0),j([Object(l.k)()],e.prototype,"close",void 0),j([Object(l.k)()],e.prototype,"blur",void 0),j([Object(l.k)()],e.prototype,"focus",void 0),j([Object(l.k)()],e.prototype,"created",void 0),j([Object(l.k)()],e.prototype,"destroyed",void 0),e=j([l.q],e)}(),I=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},M="e-left-calendar",F="e-right-calendar",T="e-daterangepicker",A="e-active",z="e-start-date",L="e-end-date",B="e-range-hover",P="e-disabled",q="e-calendar",V="e-focused-date",H="e-day-span",N="e-date-disabled",W="e-icon-disabled",X="e-overlay",G="e-list-item",K="e-hover",U=["title","class","style"],Y=function(){var e=function(e){n(i,e);var t=s(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(l.e);return I([Object(l.s)()],e.prototype,"label",void 0),I([Object(l.s)()],e.prototype,"start",void 0),I([Object(l.s)()],e.prototype,"end",void 0),e}(),_=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).isCustomRange=!1,n.isCustomWindow=!1,n.presetsItem=[],n.liCollections=[],n.previousEleValue="",n.isKeyPopup=!1,n.dateDisabled=!1,n.isRangeIconClicked=!1,n.isMaxDaysClicked=!1,n.disabledDays=[],n.preventBlur=!1,n.preventFocus=!1,n.invalidValueString=null,n.isAngular=!1,n.preventChange=!1,n.dateRangeOptions=e,n}return f(r,[{key:"render",value:function(){this.initialize(),this.setProperties({startDate:this.startValue},!0),this.setProperties({endDate:this.endValue},!0),this.setModelValue(),this.setDataAttribute(!1),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),this.renderComplete()}},{key:"preRender",value:function(){if(this.keyInputConfigs={altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",tab:"tab",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow",moveUp:"uparrow",moveDown:"downarrow",spacebar:"space"},this.defaultConstant={placeholder:this.placeholder,startLabel:"Start Date",endLabel:"End Date",customRange:"Custom Range",applyText:"Apply",cancelText:"Cancel",selectedDays:"Selected Days",days:"days"},this.isMobile=window.matchMedia("(max-width:550px)").matches,this.inputElement=this.element,this.angularTag=null,"EJS-DATERANGEPICKER"===this.element.tagName&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.cloneElement=this.element.cloneNode(!0),Object(l.ib)([this.cloneElement],[T,"e-control","e-lib"]),this.updateHtmlAttributeToElement(),this.element.getAttribute("id")?null!==this.angularTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):(this.element.id=Object(l.U)("ej2-datetimepicker"),null!==this.angularTag&&Object(l.x)(this.inputElement,{id:this.element.id+"_input"})),this.checkInvalidRange(this.value),!this.invalidValueString&&"string"==typeof this.value){var e=this.value.split(" "+this.separator+" ");this.value=[new Date(e[0]),new Date(e[1])]}this.initProperty(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),i(o(r.prototype),"preRender",this).call(this),this.navNextFunction=this.navNextMonth.bind(this),this.navPrevFunction=this.navPrevMonth.bind(this),this.deviceNavNextFunction=this.deviceNavNext.bind(this),this.deviceNavPrevFunction=this.deviceNavPrevious.bind(this),this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue),this.formElement=Object(l.C)(this.element,"form")}},{key:"updateValue",value:function(){Object(l.W)(),this.value&&this.value.length>0?(this.value[0]instanceof Date&&!isNaN(+this.value[0])?(this.setProperties({startDate:this.value[0]},!0),this.startValue=this.value[0]):"string"==typeof this.value[0]?0==+this.value[0]||isNaN(+new Date(this.checkValue(this.value[0])))?(this.startValue=null,this.setValue()):(this.setProperties({startDate:new Date(this.checkValue(this.value[0]))},!0),this.startValue=new Date(this.checkValue(this.value[0]))):(this.startValue=null,this.setValue()),this.value[1]instanceof Date&&!isNaN(+this.value[1])?(this.setProperties({endDate:this.value[1]},!0),this.endValue=this.value[1]):"string"==typeof this.value[1]?0==+this.value[0]||isNaN(+new Date(this.checkValue(this.value[0])))?(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue()):(this.setProperties({endDate:new Date(this.checkValue(this.value[1]))},!0),this.endValue=new Date(this.checkValue(this.value[1])),this.setValue()):(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue())):this.value&&this.value.start?(this.value.start instanceof Date&&!isNaN(+this.value.start)?(this.setProperties({startDate:this.value.start},!0),this.startValue=this.value.start):"string"==typeof this.value.start?(this.setProperties({startDate:new Date(this.checkValue(this.value.start))},!0),this.startValue=new Date(this.checkValue(this.value.start))):(this.startValue=null,this.setValue()),this.value.end instanceof Date&&!isNaN(+this.value.end)?(this.setProperties({endDate:this.value.end},!0),this.endValue=this.value.end):"string"==typeof this.value.end?(this.setProperties({endDate:new Date(this.checkValue(this.value.end))},!0),this.endValue=new Date(this.checkValue(this.value.end)),this.setValue()):(this.setProperties({endDate:null},!0),this.endValue=null,this.setValue())):Object(l.X)(this.value)&&(this.endValue=this.checkDateValue(new Date(this.checkValue(this.endDate))),this.startValue=this.checkDateValue(new Date(this.checkValue(this.startDate))),this.setValue())}},{key:"initProperty",value:function(){this.globalize=new l.n(this.locale),this.checkFormat(),this.checkView(),(Object(l.X)(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.updateValue()}},{key:"checkFormat",value:function(){this.formatString=this.format?"string"==typeof this.format?this.format:""===this.format.skeleton||Object(l.X)(this.format.skeleton)?null:this.globalize.getDatePattern({skeleton:this.format.skeleton,type:"date"}):null}},{key:"initialize",value:function(){null!==this.angularTag&&this.validationAttribute(this.element,this.inputElement),this.checkHtmlAttributes(!1),Object(l.db)(this.defaultKeyConfigs,{shiftTab:"shift+tab"});var e=this.checkDateValue(new Date(this.checkValue(this.startValue)));this.setProperties({startDate:e},!0),this.setProperties({endValue:this.checkDateValue(new Date(this.checkValue(this.endValue)))},!0),this.setValue(),this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.l10n=new l.p("daterangepicker",this.defaultConstant,this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.processPresets(),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setRangeAllowEdit(),this.bindEvents()}},{key:"setDataAttribute",value:function(e){var t={};if(e)t=this.htmlAttributes;else for(var i=0;i<this.element.attributes.length;i++)t[this.element.attributes[i].name]=this.element.getAttribute(this.element.attributes[i].name);for(var n=0,r=Object.keys(t);n<r.length;n++){var s=r[n];0===s.indexOf("data")&&(this.firstHiddenChild.setAttribute(s,t[s]),this.secondHiddenChild.setAttribute(s,t[s]))}}},{key:"setRangeAllowEdit",value:function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(l.x)(this.inputElement,{readonly:""}),this.updateClearIconState()}},{key:"updateClearIconState",value:function(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):Object(l.v)([this.inputWrapper.container],["e-non-edit"])}},{key:"validationAttribute",value:function(e,t){var i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");for(var n=["required","aria-required","form"],r=0;r<n.length;r++)if(!Object(l.X)(e.getAttribute(n[r]))){var s=e.getAttribute(n[r]);t.setAttribute(n[r],s),e.removeAttribute(n[r])}}},{key:"updateHtmlAttributeToWrapper",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];if(U.indexOf(i)>-1)if("class"===i){var n=this.htmlAttributes[i].replace(/\s+/g," ").trim();""!==n&&Object(l.v)([this.inputWrapper.container],n.split(" "))}else if("style"===i){var r=this.inputWrapper.container.getAttribute(i);r=Object(l.X)(r)?this.htmlAttributes[i]:r+this.htmlAttributes[i],this.inputWrapper.container.setAttribute(i,r)}else this.inputWrapper.container.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateHtmlAttributeToElement",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];U.indexOf(i)<0&&this.inputElement.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateCssClass",value:function(e,t){Object(l.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(l.X)(e)||(e=e.replace(/\s+/g," ").trim()),u.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&u.c.setCssClass(e,[this.popupWrapper],t)}},{key:"processPresets",value:function(){this.presetsItem=[];var e=0;if(!Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)){var t,i=c(this.presets);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.label.replace(/\s+/g,"")+"_"+ ++e;this.presetsItem.push("string"==typeof n.end?{id:r,text:n.label,end:new Date(this.checkValue(n.end)),start:new Date(this.checkValue(n.start))}:{id:r,text:n.label,start:n.start,end:n.end})}}catch(o){i.e(o)}finally{i.f()}var s=Object(l.X)(this.startValue)?null:new Date(+this.startValue),a=Object(l.X)(this.endValue)?null:new Date(+this.endValue);this.presetsItem.push({id:"custom_range",text:this.l10n.getConstant("customRange"),start:s,end:a}),Object(l.X)(this.startValue)||Object(l.X)(this.endValue)||(this.isCustomRange=!0,this.activeIndex=this.presetsItem.length-1)}}},{key:"bindEvents",value:function(){l.l.add(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler,this),l.l.add(this.inputElement,"focus",this.inputFocusHandler,this),l.l.add(this.inputElement,"blur",this.inputBlurHandler,this),l.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&l.l.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this),this.isMobile||(this.keyInputConfigs=Object(l.K)(this.keyInputConfigs,this.keyConfigs),this.inputKeyboardModule=new l.o(this.inputElement,{eventName:"keydown",keyAction:this.inputHandler.bind(this),keyConfigs:this.keyInputConfigs})),this.formElement&&l.l.add(this.formElement,"reset",this.formResetHandler,this),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1}},{key:"unBindEvents",value:function(){l.l.remove(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler),l.l.remove(this.inputElement,"blur",this.inputBlurHandler),l.l.remove(this.inputElement,"focus",this.inputFocusHandler),l.l.remove(this.inputElement,"change",this.inputChangeHandler),this.showClearButton&&this.inputWrapper.clearButton&&l.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.isMobile||Object(l.X)(this.inputKeyboardModule)||this.inputKeyboardModule.destroy(),this.formElement&&l.l.remove(this.formElement,"reset",this.formResetHandler),this.inputElement.tabIndex=-1}},{key:"updateHiddenInput",value:function(){if(this.firstHiddenChild&&this.secondHiddenChild){var e={type:"datetime",skeleton:Object(l.W)()?"d":"yMd"};"string"==typeof this.startDate&&(this.startDate=this.globalize.parseDate(this.startDate,e)),"string"==typeof this.endDate&&(this.endDate=this.globalize.parseDate(this.endDate,e)),this.firstHiddenChild.value=this.startDate&&this.globalize.formatDate(this.startDate,e)||this.inputElement.value,this.secondHiddenChild.value=this.endDate&&this.globalize.formatDate(this.endDate,e)||this.inputElement.value,this.dispatchEvent(this.firstHiddenChild,"focusout"),this.dispatchEvent(this.firstHiddenChild,"change")}}},{key:"inputChangeHandler",value:function(e){this.enabled&&(e.stopPropagation(),this.updateHiddenInput())}},{key:"bindClearEvent",value:function(){this.showClearButton&&this.inputWrapper.clearButton&&l.l.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)}},{key:"resetHandler",value:function(e){if(this.enabled){this.valueType=this.value,e.preventDefault(),this.clear();var t={event:e};this.setProperties({endDate:this.checkDateValue(this.endValue)},!0),this.setProperties({startDate:this.checkDateValue(this.startValue)},!0),this.trigger("cleared",t),this.changeTrigger(e),this.clearRange(),this.hide(e)}}},{key:"restoreValue",value:function(){this.previousEleValue=this.inputElement.value,this.previousStartValue=this.startValue,this.previousEndValue=this.endValue,this.valueType=null,this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue),this.setValue(),this.setModelValue()}},{key:"formResetHandler",value:function(e){if(this.enabled&&this.formElement&&e.target===this.formElement&&!this.inputElement.disabled){var t=this.inputElement.getAttribute("value");Object(l.X)(this.startCopy)?(this.setProperties({value:null,startDate:null,endDate:null},!0),this.startValue=this.endValue=null):(Object(l.X)(this.value)||Object(l.X)(this.value.start)?(this.setProperties({value:[this.startCopy,this.endCopy]},!0),this.startValue=this.value[0],this.endValue=this.value[1]):(this.setProperties({value:{start:this.startCopy,end:this.endCopy}},!0),this.startValue=this.value.start,this.endValue=this.value.end),this.setProperties({startDate:this.startValue,endDate:this.endValue},!0)),"EJS-DATERANGEPICKER"===this.element.tagName&&(this.setProperties({value:null,startDate:null,endDate:null},!0),t="",this.startValue=this.endValue=null,this.inputElement.setAttribute("value","")),this.restoreValue(),this.inputElement&&(u.c.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton),this.errorClass())}}},{key:"clear",value:function(){null!==this.startValue&&(this.startValue=null),null!==this.endValue&&(this.endValue=null),this.value&&this.value.start&&this.setProperties({value:{start:null,end:null}},!0),null!==this.value&&this.value.length>0&&this.setProperties({value:null},!0),u.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),Object(l.X)(this.applyButton)||(this.applyButton.disabled=this.applyButton.element.disabled=!0),this.removeSelection()}},{key:"rangeIconHandler",value:function(e){this.enabled&&(this.isMobile&&this.inputElement.setAttribute("readonly",""),e.preventDefault(),this.targetElement=null,this.isPopupOpen()&&document.body.contains(this.popupObj.element)?this.applyFunction(e):(this.isRangeIconClicked=!0,this.inputWrapper.container.children[0].focus(),this.show(null,e),this.isMobile||Object(l.X)(this.leftCalendar)||(this.isRangeIconClicked=!1,this.calendarFocus(),this.isRangeIconClicked=!0),Object(l.v)([this.inputWrapper.container],["e-input-focus"])))}},{key:"checkHtmlAttributes",value:function(e){this.globalize=new l.n(this.locale);var t,i=e?Object(l.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["startDate","endDate","minDays","maxDays","min","max","disabled","readonly","style","name","placeholder","type","value"],n={format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"},r=c(i);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(!Object(l.X)(this.inputElement.getAttribute(s)))switch(s){case"disabled":if(Object(l.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.enabled||e){var a="disabled"===this.inputElement.getAttribute(s)||""===this.inputElement.getAttribute(s)||"true"===this.inputElement.getAttribute(s);this.setProperties({enabled:!a},!e)}break;case"readonly":if(Object(l.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.readonly||e){var o="readonly"===this.inputElement.getAttribute(s)||"true"===this.inputElement.getAttribute(s)||""===this.inputElement.getAttribute(s);this.setProperties({readonly:o},!e)}break;case"placeholder":(Object(l.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(s)},!e);break;case"value":if(Object(l.X)(this.dateRangeOptions)||void 0===this.dateRangeOptions.value||e){var h=this.inputElement.getAttribute(s);this.setProperties(Object(l.qb)(s,h,{}),!e)}break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(s));break;case"min":if(Object(l.X)(this.min)||+this.min==+new Date(1900,0,1)||e){var u=this.globalize.parseDate(this.inputElement.getAttribute(s),n);this.setProperties(Object(l.qb)(s,u,{}),!e)}break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(s));break;case"max":if(Object(l.X)(this.max)||+this.max==+new Date(2099,11,31)||e){var d=this.globalize.parseDate(this.inputElement.getAttribute(s),n);this.setProperties(Object(l.qb)(s,d,{}),!e)}break;case"startDate":if(Object(l.X)(this.startDate)){var p=this.globalize.parseDate(this.inputElement.getAttribute(s),n);this.startValue=p,this.setValue()}break;case"endDate":if(Object(l.X)(this.endDate)){var g=this.globalize.parseDate(this.inputElement.getAttribute(s),n);this.endValue=g,this.setValue()}break;case"minDays":Object(l.X)(this.minDays)&&this.setProperties(Object(l.qb)(s,parseInt(this.inputElement.getAttribute(s),10),{}),!0);break;case"maxDays":Object(l.X)(this.maxDays)&&this.setProperties(Object(l.qb)(s,parseInt(this.inputElement.getAttribute(s),10),{}),!0);break;case"type":"text"!==this.inputElement.getAttribute(s)&&this.inputElement.setAttribute("type","text")}}}catch(f){r.e(f)}finally{r.f()}}},{key:"createPopup",value:function(){for(var e=0;e<this.presetsItem.length;e++)e!==this.presetsItem.length-1&&"custom_range"===this.presetsItem[e].id&&this.presetsItem.splice(e,1);this.activeIndex=this.presetsItem.length-1,this.isCustomRange=!0;for(var t=0;t<=this.presetsItem.length-2;t++){var i=this.presetsItem[t].start,n=this.presetsItem[t].end;this.startValue&&this.endValue&&+i.setMilliseconds(0)==+this.startValue.setMilliseconds(0)&&+n.setMilliseconds(0)==+this.endValue.setMilliseconds(0)&&(this.activeIndex=t,this.isCustomRange=!1)}this.popupWrapper=Object(l.F)("div",{id:this.element.id+"_popup",className:T+" e-popup"}),this.adjustLongHeaderWidth();var r=!this.isCustomRange||this.isMobile;!Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)&&r?(this.isCustomWindow=!1,this.createPresets(),this.listRippleEffect(),this.renderPopup()):(this.isCustomWindow=!0,this.renderControl())}},{key:"renderControl",value:function(){this.createControl(),this.bindCalendarEvents(),this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar]),Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||this.disabledDateRender(),this.updateHeader()}},{key:"clearCalendarEvents",value:function(){l.l.clearEvents(this.leftCalPrevIcon),l.l.clearEvents(this.leftCalNextIcon),l.l.clearEvents(this.rightCalPrevIcon),l.l.clearEvents(this.rightCalNextIcon)}},{key:"updateNavIcons",value:function(){i(o(r.prototype),"iconHandler",this).call(this)}},{key:"calendarIconEvent",value:function(){this.clearCalendarEvents(),this.leftCalPrevIcon&&!this.leftCalPrevIcon.classList.contains(P)&&l.l.add(this.leftCalPrevIcon,"mousedown",this.navPrevFunction),this.leftCalNextIcon&&!this.leftCalNextIcon.classList.contains(P)&&l.l.add(this.leftCalNextIcon,"mousedown",this.navNextFunction),this.rightCalPrevIcon&&!this.rightCalPrevIcon.classList.contains(P)&&l.l.add(this.rightCalPrevIcon,"mousedown",this.navPrevFunction),this.rightCalNextIcon&&!this.rightCalNextIcon.classList.contains(P)&&l.l.add(this.rightCalNextIcon,"mousedown",this.navNextFunction)}},{key:"bindCalendarEvents",value:function(){this.isMobile?(this.deviceCalendarEvent(),l.l.add(this.startButton.element,"click",this.deviceHeaderClick,this),l.l.add(this.endButton.element,"click",this.deviceHeaderClick,this)):(this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.headerTitleElement=this.popupObj.element.querySelector(".e-right-calendar .e-header .e-title"),this.headerTitleElement=this.popupObj.element.querySelector(".e-left-calendar .e-header .e-title"),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,this.keyConfigs),this.leftKeyboardModule=new l.o(this.leftCalendar,{eventName:"keydown",keyAction:this.keyInputHandler.bind(this),keyConfigs:this.defaultKeyConfigs}),this.rightKeyboardModule=new l.o(this.rightCalendar,{eventName:"keydown",keyAction:this.keyInputHandler.bind(this),keyConfigs:this.defaultKeyConfigs})),this.start===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate()}},{key:"calendarIconRipple",value:function(){Object(l.kb)(this.leftCalPrevIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(l.kb)(this.leftCalNextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),Object(l.kb)(this.rightCalPrevIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(l.kb)(this.rightCalNextIcon,{selector:".e-next",duration:400,isCenterRipple:!0})}},{key:"deviceCalendarEvent",value:function(){l.l.clearEvents(this.nextIcon),l.l.clearEvents(this.previousIcon),Object(l.kb)(this.nextIcon,{selector:".e-prev",duration:400,isCenterRipple:!0}),Object(l.kb)(this.previousIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.nextIcon&&!this.nextIcon.classList.contains(P)&&l.l.add(this.nextIcon,"mousedown",this.deviceNavNextFunction),this.previousIcon&&!this.previousIcon.classList.contains(P)&&l.l.add(this.previousIcon,"mousedown",this.deviceNavPrevFunction)}},{key:"deviceNavNext",value:function(e){var t=Object(l.C)(e.target,"."+q);this.updateDeviceCalendar(t),this.navigateNext(e),this.deviceNavigation()}},{key:"deviceNavPrevious",value:function(e){var t=Object(l.C)(e.target,"."+q);this.updateDeviceCalendar(t),this.navigatePrevious(e),this.deviceNavigation()}},{key:"updateDeviceCalendar",value:function(e){e&&(this.previousIcon=e.querySelector(".e-prev"),this.nextIcon=e.querySelector(".e-next"),this.calendarElement=e,this.deviceCalendar=e,this.contentElement=e.querySelector(".e-content"),this.tableBodyElement=Object(l.lb)(".e-content tbody",e),this.table=e.querySelector(".e-content").getElementsByTagName("table")[0],this.headerTitleElement=e.querySelector(".e-header .e-title"),this.headerElement=e.querySelector(".e-header"))}},{key:"deviceHeaderClick",value:function(e){if(e.currentTarget.classList.contains("e-start-btn")&&!Object(l.X)(this.startValue)){this.endButton.element.classList.remove(A),this.startButton.element.classList.add(A);var t=this.popupObj.element.querySelector("."+q);this.updateDeviceCalendar(t),Object(l.X)(this.calendarElement.querySelector(".e-start-date:not(.e-other-month)"))&&(this.currentDate=new Date(+this.startValue),Object(l.hb)(this.tableBodyElement),this.createContentBody(),this.deviceNavigation()),this.removeClassDisabled()}else if(!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)){this.startButton.element.classList.remove(A),this.endButton.element.classList.add(A);var i=this.popupObj.element.querySelector("."+q);this.updateDeviceCalendar(i),Object(l.X)(this.calendarElement.querySelector(".e-end-date:not(.e-other-month)"))&&(this.currentDate=new Date(+this.endValue),Object(l.hb)(this.tableBodyElement),this.createContentBody(),this.deviceNavigation()),this.updateMinMaxDays(this.popupObj.element.querySelector("."+q)),this.selectableDates()}}},{key:"inputFocusHandler",value:function(){if(this.enabled){this.preventBlur=!1;var e={model:Object(l.W)()&&this.isServerRendered?null:this};this.preventFocus||(this.preventFocus=!0,this.trigger("focus",e)),this.updateClearIconState(),this.updateHiddenInput(),this.openOnFocus&&this.show()}}},{key:"inputBlurHandler",value:function(e){if(this.enabled){if(!this.preventBlur){var t=this.inputElement.value;if(Object(l.X)(this.presetsItem)||this.presetsItem.length>0&&this.previousEleValue!==this.inputElement.value&&(this.activeIndex=this.presetsItem.length-1,this.isCustomRange=!0),!Object(l.X)(t)&&""!==t.trim()){var i=t.split(" "+this.separator+" ");if(i.length>1){this.invalidValueString=null;var n={format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"},r=this.globalize.parseDate(i[0].trim(),n),s=this.globalize.parseDate(i[1].trim(),n);if(!(Object(l.X)(r)||isNaN(+r)||Object(l.X)(s)||isNaN(+s))){var a=this.startValue;this.startValue=r;var o=this.endValue;if(this.endValue=s,this.setValue(),this.refreshControl(),t!==this.previousEleValue&&this.changeTrigger(e),!this.preventBlur&&document.activeElement!==this.inputElement){this.preventFocus=!1;var h={model:Object(l.W)()&&this.isServerRendered?null:this};this.trigger("blur",h)}return this.updateHiddenInput(),void(this.isMobile&&this.isPopupOpen()&&(this.startValue=a,this.endValue=o))}this.strictMode||(this.startValue=null,this.endValue=null,this.setValue())}else this.strictMode||(this.startValue=null,this.endValue=null,this.setValue())}if(this.strictMode?(Object(l.X)(t)||""!==t.trim()||(this.startValue=null,this.endValue=null),u.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.updateInput()):(Object(l.X)(this.popupObj)&&(this.currentDate=null),this.previousStartValue=this.previousEndValue=null,this.startValue=null,this.endValue=null,this.setValue()),this.errorClass(),this.changeTrigger(e),!this.preventBlur&&document.activeElement!==this.inputElement){this.preventFocus=!1;var c={model:Object(l.W)()&&this.isServerRendered?null:this};this.trigger("blur",c)}}this.updateHiddenInput()}}},{key:"clearRange",value:function(){this.previousStartValue=this.previousEndValue=null,this.currentDate=null}},{key:"errorClass",value:function(){var e=this.inputElement.value.trim();(Object(l.X)(this.endValue)&&Object(l.X)(this.startValue)&&""!==e||!Object(l.X)(this.startValue)&&+this.startValue<+this.min||!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(l.X)(this.endValue)&&+this.endValue>+this.max||this.startValue&&this.isDateDisabled(this.startValue)||this.endValue&&this.isDateDisabled(this.endValue))&&""!==e?(Object(l.v)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"true"})):this.inputWrapper&&(Object(l.ib)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"false"}))}},{key:"keyCalendarUpdate",value:function(e,t){return this.removeFocusedDate(),e?(this.leftCalCurrentDate=new Date(+this.currentDate),t=this.leftCalendar):(this.rightCalCurrentDate=new Date(+this.currentDate),t=this.rightCalendar),this.updateCalendarElement(t),this.table.focus(),t}},{key:"navInCalendar",value:function(e,t,i,n,r){var s,a,o=this.getViewNumber(this.currentView()),h=this.min;switch(a=Object(l.X)(this.maxDays)||!this.isMaxDaysClicked||Object(l.X)(this.startValue)?this.max:new Date(new Date(+this.startValue).setDate(this.startValue.getDate()+(this.maxDays-1))),e.action){case"moveRight":s=new Date(+this.currentDate),this.addDay(s,1,e,a,h),t&&+s==+n&&(r=this.keyCalendarUpdate(!1,r)),this.KeyboardNavigate(1,o,e,a,h),this.keyNavigation(r,e);break;case"moveLeft":s=new Date(+this.currentDate),this.addDay(s,-1,e,a,h),t||+s==+i&&(r=this.keyCalendarUpdate(!0,r)),this.KeyboardNavigate(-1,o,e,a,h),this.keyNavigation(r,e);break;case"moveUp":0===o?(s=new Date(+this.currentDate),this.addDay(s,-7,e,a,h),+s<=+i&&!t&&(r=this.keyCalendarUpdate(!0,r)),this.KeyboardNavigate(-7,o,e,a,h)):this.KeyboardNavigate(-4,o,e,this.max,this.min),this.keyNavigation(r,e);break;case"moveDown":0===o?(s=new Date(+this.currentDate),this.addDay(s,7,e,a,h),t&&+s>=+n&&(r=this.keyCalendarUpdate(!1,r)),this.KeyboardNavigate(7,o,e,a,h)):this.KeyboardNavigate(4,o,e,this.max,this.min),this.keyNavigation(r,e);break;case"home":this.currentDate=this.firstDay(this.currentDate),Object(l.hb)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),this.keyNavigation(r,e);break;case"end":this.currentDate=this.lastDay(this.currentDate,o),Object(l.hb)(this.tableBodyElement),0===o?this.renderMonths(e):1===o?this.renderYears(e):this.renderDecades(e),this.keyNavigation(r,e)}}},{key:"keyInputHandler",value:function(e,t){var n,s=this.getViewNumber(this.currentView()),a=new Date(this.rightCalCurrentDate.getFullYear(),this.rightCalCurrentDate.getMonth(),1),h=new Date(this.leftCalCurrentDate.getFullYear(),this.leftCalCurrentDate.getMonth()+1,0),c=Object(l.C)(e.target,"."+F),u=(c=Object(l.X)(c)?this.leftCalendar:c).classList.contains(M);this.updateCalendarElement(c);var d=this.tableBodyElement.querySelector("tr td.e-selected"),p=c.querySelector("tr td."+V),g=c.querySelector("tr td."+z),f=c.querySelector("tr td."+L),m=this.getViewNumber(this.depth),v=s===m&&this.getViewNumber(this.start)>=m,b=Object(l.C)(e.target,"."+M),y=Object(l.C)(e.target,"."+F),C=Object(l.C)(e.target,".e-presets");switch(Object(l.X)(p)?Object(l.X)(f)||this.dateDisabled?Object(l.X)(g)||this.dateDisabled?this.dateDisabled||this.currentDate.setDate(1):this.currentDate=new Date(+this.startValue):this.currentDate=new Date(+this.endValue):this.currentDate=this.currentDate,this.effect="",e.action){case"altUpArrow":this.isPopupOpen()&&(this.hide(e),this.preventFocus=!0,this.inputElement.focus(),Object(l.v)([this.inputWrapper.container],["e-input-focus"]));break;case"select":if(v){var w=Object(l.X)(p)?g:p;Object(l.X)(w)||w.classList.contains(P)||this.selectRange(null,w)}else(Object(l.X)(d)||v)&&Object(l.X)(p)||(Object(l.X)(this.value)||(t=this.calendarElement.classList.contains(M)?this.startDate:this.endDate),this.controlDown=e,this.contentClick(null,--s,p||d,t));e.preventDefault();break;case"controlHome":var k=new Date(this.currentDate.getFullYear(),0,1);!u&&+k<+h&&(c=this.keyCalendarUpdate(!0,c)),i(o(r.prototype),"navigateTo",this).call(this,"Month",new Date(this.currentDate.getFullYear(),0,1)),this.keyNavigation(c,e);break;case"altRightArrow":Object(l.X)(b)?Object(l.X)(y)?Object(l.X)(C)||this.cancelButton.element.focus():Object(l.X)(this.presetElement)?this.cancelButton.element.focus():(this.presetElement.focus(),this.removeFocusedDate()):this.rightCalendar.children[1].firstElementChild.focus(),e.preventDefault();break;case"altLeftArrow":Object(l.X)(b)?Object(l.X)(y)||this.leftCalendar.children[1].firstElementChild.focus():!0!==this.applyButton.element.disabled?this.applyButton.element.focus():this.cancelButton.element.focus(),e.preventDefault();break;case"controlUp":this.calendarElement.classList.contains(M),this.calendarNavigation(e,this.calendarElement),e.preventDefault();break;case"controlDown":Object(l.X)(d)&&Object(l.X)(p)||v||(Object(l.X)(this.value)||(t=this.calendarElement.classList.contains(M)?this.startDate:this.endDate),this.controlDown=e,this.contentClick(null,--s,d||p,t)),e.preventDefault();break;case"controlEnd":k=new Date(this.currentDate.getFullYear(),11,31),u&&+k>+a&&(c=this.keyCalendarUpdate(!1,c)),i(o(r.prototype),"navigateTo",this).call(this,"Month",new Date(this.currentDate.getFullYear(),11,31)),this.keyNavigation(c,e);break;case"pageUp":n=new Date(+this.currentDate),this.addMonths(n,-1),!u&&+n<=+h&&(c=this.keyCalendarUpdate(!0,c)),this.addMonths(this.currentDate,-1),i(o(r.prototype),"navigateTo",this).call(this,"Month",this.currentDate),this.keyNavigation(c,e);break;case"pageDown":n=new Date(+this.currentDate),this.addMonths(n,1),u&&+n>=+a&&(c=this.keyCalendarUpdate(!1,c)),this.addMonths(this.currentDate,1),i(o(r.prototype),"navigateTo",this).call(this,"Month",this.currentDate),this.keyNavigation(c,e);break;case"shiftPageUp":n=new Date(+this.currentDate),this.addYears(n,-1),!u&&+n<=+h&&(c=this.keyCalendarUpdate(!0,c)),this.addYears(this.currentDate,-1),i(o(r.prototype),"navigateTo",this).call(this,"Month",this.currentDate),this.keyNavigation(c,e);break;case"shiftPageDown":n=new Date(+this.currentDate),this.addYears(n,1),u&&+n>=+a&&(c=this.keyCalendarUpdate(!1,c)),this.addYears(this.currentDate,1),i(o(r.prototype),"navigateTo",this).call(this,"Month",this.currentDate),this.keyNavigation(c,e);break;case"shiftTab":Object(l.X)(this.presetElement)||(this.presetElement.setAttribute("tabindex","0"),this.presetElement.focus(),this.removeFocusedDate()),e.preventDefault();break;case"spacebar":this.applyButton&&!this.applyButton.disabled&&this.applyFunction(e);break;default:this.navInCalendar(e,u,h,a,c),this.checkMinMaxDays()}this.presetHeight()}},{key:"keyNavigation",value:function(e,t){this.bindCalendarCellEvents(e),e.classList.contains(M)?this.leftCalCurrentDate=new Date(+this.currentDate):this.rightCalCurrentDate=new Date(+this.currentDate),this.updateNavIcons(),this.calendarIconEvent(),this.updateRange([e]),this.dateDisabled=this.isDateDisabled(this.currentDate),t.preventDefault()}},{key:"inputHandler",value:function(e){switch(e.action){case"altDownArrow":this.isPopupOpen()||(""===this.inputElement.value&&(this.clear(),this.changeTrigger(e),this.clearRange()),this.show(null,e),this.isRangeIconClicked=!1,this.isMobile||Object(l.X)(this.leftCalendar)||this.calendarFocus(),this.isKeyPopup=!0);break;case"escape":this.isPopupOpen()&&this.hide(e);break;case"enter":document.activeElement===this.inputElement&&(this.inputBlurHandler(e),this.hide(e));break;case"tab":document.activeElement===this.inputElement&&this.isPopupOpen()&&(this.hide(e),e.preventDefault())}}},{key:"bindCalendarCellEvents",value:function(e){var t,i=c(e?e.querySelectorAll(".e-calendar td"):this.popupObj.element.querySelectorAll(".e-calendar td"));try{for(i.s();!(t=i.n()).done;){var n=t.value;l.l.clearEvents(n),n.classList.contains(P)||n.classList.contains(N)||n.classList.contains("e-week-number")||(this.isMobile||l.l.add(n,"mouseover",this.hoverSelection,this),l.l.add(n,"mousedown",this.selectRange,this))}}catch(r){i.e(r)}finally{i.f()}}},{key:"removeFocusedDate",value:function(){var e,t=!Object(l.X)(this.startValue)||!Object(l.X)(this.endValue),i=c(this.popupObj.element.querySelectorAll(".e-calendar ."+V));try{for(i.s();!(e=i.n()).done;){var n=e.value,r=new Date,s=this.getIdValue(null,n);("Month"===this.depth&&"Month"===this.currentView()&&(!n.classList.contains("e-today")||n.classList.contains("e-today")&&t)||"Year"===this.depth&&"Year"===this.currentView()&&(!this.isSameMonth(r,s)&&!this.isSameYear(r,s)||t)||"Decade"===this.depth&&"Decade"===this.currentView()&&(!this.isSameYear(r,s)||t))&&(n.classList.remove(V),n.classList.contains(z)||n.classList.contains(L)||n.removeAttribute("aria-label"))}}catch(a){i.e(a)}finally{i.f()}}},{key:"hoverSelection",value:function(e,t){var i=this.getIdValue(null,t||e.currentTarget);if(!Object(l.X)(this.startValue)&&+this.startValue>=+this.min&&+this.startValue<=+this.max&&(!this.isDateDisabled(this.endValue)&&!this.isDateDisabled(this.startValue)&&Object(l.X)(this.endValue)&&Object(l.X)(this.startValue)||!Object(l.X)(this.startValue)&&Object(l.X)(this.endValue))){var n,r=c(this.popupObj.element.querySelectorAll(".e-calendar td"));try{for(r.s();!(n=r.n()).done;){var s=n.value,a=!s.classList.contains(P)||s.classList.contains(N);if(!s.classList.contains("e-week-number")&&a){var o=this.getIdValue(null,s),h=new Date(+this.startValue);new Date(+o).setHours(0,0,0,0)>=h.setHours(0,0,0,0)&&+o<=+i?Object(l.v)([s],B):Object(l.ib)([s],[B])}}}catch(u){r.e(u)}finally{r.f()}}}},{key:"isSameStartEnd",value:function(e,t){var i=!1;return"Month"===this.depth?e.setHours(0,0,0,0)===t.setHours(0,0,0,0)&&(i=!0):"Year"===this.depth?e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&(i=!0):"Decade"===this.depth&&e.getFullYear()===t.getFullYear()&&(i=!0),i}},{key:"updateRange",value:function(e){if(!Object(l.X)(this.startValue)){var t,i=c(e);try{for(i.s();!(t=i.n()).done;){var n,r=c(t.value.querySelectorAll(".e-calendar td"));try{for(r.s();!(n=r.n()).done;){var s=n.value;if(!s.classList.contains("e-week-number")&&!s.classList.contains(P)){var a=this.getIdValue(null,s),o=this.getIdValue(null,s);if(Object(l.X)(this.endValue)?Object(l.ib)([s],[B]):this.currentView()===this.depth&&+o.setHours(0,0,0,0)>=+new Date(+this.startValue).setHours(0,0,0,0)&&+o.setHours(0,0,0,0)<=+new Date(+this.endValue).setHours(0,0,0,0)&&!this.isSameStartEnd(new Date(+this.startValue),new Date(+this.endValue))&&+new Date(+this.startValue).setHours(0,0,0,0)>=+this.min&&+new Date(+this.endValue).setHours(0,0,0,0)<=+this.max&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&Object(l.v)([s],B),s.classList.contains("e-selected")&&s.classList.contains(L)&&+o!=+this.endValue&&(Object(l.ib)([s],["e-selected"]),Object(l.ib)([s],[L])),s.classList.contains(B)&&+o>+this.endValue&&Object(l.ib)([s],[B]),!s.classList.contains("e-other-month")){var h=new Date(+this.startValue),u=new Date(+a);this.currentView()===this.depth&&+u.setHours(0,0,0,0)==+h.setHours(0,0,0,0)&&+u.setHours(0,0,0,0)>=+h.setHours(0,0,0,0)&&+this.startValue>=+this.min&&!this.inputWrapper.container.classList.contains("e-error")&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&(Object(l.v)([s],[z,"e-selected"]),this.addSelectedAttributes(s,this.startValue,!0));var d=new Date(+this.endValue);"Year"===this.currentView()?u=new Date(u.getFullYear(),u.getMonth()+1,0):"Decade"===this.currentView()&&(u=new Date(u.getFullYear(),11,31)),this.currentView()===this.depth&&!Object(l.X)(this.endValue)&&+u.setHours(0,0,0,0)==+d.setHours(0,0,0,0)&&+u.setHours(0,0,0,0)<=+d.setHours(0,0,0,0)&&+this.startValue>=+this.min&&!this.inputWrapper.container.classList.contains("e-error")&&!this.isDateDisabled(this.startValue)&&!this.isDateDisabled(this.endValue)&&(Object(l.v)([s],[L,"e-selected"]),this.addSelectedAttributes(s,this.startValue,!1)),+a!=+this.startValue||Object(l.X)(this.endValue)||+a!=+this.endValue||this.addSelectedAttributes(s,this.endValue,!1,!0)}}}}catch(p){r.e(p)}finally{r.f()}}}catch(p){i.e(p)}finally{i.f()}}}},{key:"checkMinMaxDays",value:function(){(!Object(l.X)(this.minDays)&&this.minDays>0||!Object(l.X)(this.maxDays)&&this.maxDays>0)&&(this.isMobile?this.updateMinMaxDays(this.popupObj.element.querySelector("."+q)):(this.updateMinMaxDays(this.popupObj.element.querySelector("."+M)),this.updateMinMaxDays(this.popupObj.element.querySelector("."+F))))}},{key:"rangeArgs",value:function(e){var t,i,n=Object(l.X)(this.startValue)?null:this.globalize.formatDate(this.startValue,{format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"}),r=Object(l.X)(this.endValue)?null:this.globalize.formatDate(this.endValue,{format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"});return Object(l.X)(this.endValue)||Object(l.X)(this.startValue)?(t="",i=0):(t=n+" "+this.separator+" "+r,i=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1),{value:this.value,startDate:this.startValue,endDate:this.endValue,daySpan:i,event:e||null,element:this.element,isInteracted:!Object(l.X)(e),text:t}}},{key:"otherMonthSelect",value:function(e,t,i){var n=+this.getIdValue(null,e),r='*[id^="/id"]:not(.e-other-month)'.replace("/id",""+n),s=this.popupObj&&this.popupObj.element.querySelector(r);Object(l.X)(s)||(t?(Object(l.v)([s],[z,"e-selected"]),this.addSelectedAttributes(s,this.startValue,!0)):(Object(l.v)([s],[L,"e-selected"]),this.addSelectedAttributes(s,this.endValue,!0)),i&&this.addSelectedAttributes(e,this.endValue,!1,!0))}},{key:"selectRange",value:function(e,t){var i,n,r;e&&e.preventDefault();var s=(r=Object(l.X)(e)?this.getIdValue(null,t):this.getIdValue(e,null)).getFullYear(),a=r.getMonth(),o=new Date(s,a,1),h=new Date(s,a+1,0),u=new Date(s,0,1),d=new Date(s,11,31);Object(l.X)(this.endValue)||Object(l.X)(this.startValue)?this.isMobile&&this.startButton.element.classList.contains(A)&&this.removeSelection():(!this.isMobile||this.isMobile&&!this.endButton.element.classList.contains(A))&&this.removeSelection();var p=t||e.currentTarget;if(Object(l.X)(this.startValue))Object(l.X)(this.previousStartValue)||(r.setHours(this.previousStartValue.getHours()),r.setMinutes(this.previousStartValue.getMinutes()),r.setSeconds(this.previousStartValue.getSeconds())),this.startValue="Month"===this.depth?new Date(this.checkValue(r)):"Year"===this.depth?o:u,this.endValue=null,this.setValue(),Object(l.v)([p],z),this.addSelectedAttributes(p,this.startValue,!0),p.classList.contains("e-other-month")&&this.otherMonthSelect(p,!0),this.checkMinMaxDays(),this.applyButton.disabled=!0,this.applyButton.element.disabled=!0,this.isMobile&&(this.endButton.element.classList.add(A),this.startButton.element.classList.remove(A),this.endButton.element.removeAttribute("disabled"),this.selectableDates()),this.trigger("select",this.rangeArgs(e));else if(+r==+this.startValue||+r>+this.startValue){if(+r==+this.startValue&&!Object(l.X)(this.minDays)&&this.minDays>1)return;this.endValue=null,this.setValue(),(this.isMobile||t)&&this.hoverSelection(e,t),Object(l.X)(this.previousEndValue)||(r.setHours(this.previousEndValue.getHours()),r.setMinutes(this.previousEndValue.getMinutes()),r.setSeconds(this.previousEndValue.getSeconds())),this.endValue="Month"===this.depth?new Date(this.checkValue(r)):"Year"===this.depth?h:d,this.setValue();var g=this.popupObj.element.querySelectorAll("."+L);if(this.isMobile){this.startButton.element.classList.remove(A),this.endButton.element.classList.add(A);var f,m=c(g);try{for(m.s();!(f=m.n()).done;){var v=f.value;v.removeAttribute("aria-label"),v.classList.contains(z)?(this.addSelectedAttributes(v,this.startValue,!0),Object(l.ib)([v],[L])):(v.setAttribute("aria-selected","false"),Object(l.ib)([v],[L,"e-selected"]))}}catch(w){m.e(w)}finally{m.f()}}Object(l.v)([p],L),+this.endValue==+this.startValue?this.addSelectedAttributes(p,this.endValue,!1,!0):this.addSelectedAttributes(p,this.endValue,!1),p.classList.contains("e-other-month")&&(+this.endValue==+this.startValue?this.otherMonthSelect(p,!1,!0):this.otherMonthSelect(p,!1));var b,y=c(g=this.popupObj.element.querySelectorAll("."+L));try{for(y.s();!(b=y.n()).done;){var C=b.value;C.classList.contains(z)&&Object(l.ib)([C],[B])}}catch(w){y.e(w)}finally{y.f()}this.applyButton.disabled=!1,this.applyButton.element.disabled=!1,this.isMobile||this.removeClassDisabled(),this.disabledDateRender(),this.trigger("select",this.rangeArgs(e))}else+r<+this.startValue&&(this.removeClassDisabled(),this.startValue="Month"===this.depth?new Date(this.checkValue(r)):"Year"===this.depth?o:u,this.setValue(),this.removeSelectedAttributes(),Object(l.ib)(this.popupObj.element.querySelectorAll("."+z),[z,"e-selected"]),Object(l.v)([p],z),this.addSelectedAttributes(p,this.startValue,!0),p.classList.contains("e-other-month")&&this.otherMonthSelect(p,!0),this.checkMinMaxDays());e&&(i=Object(l.C)(e.target,"."+M)),Object(l.X)(i)?(e&&(n=e&&Object(l.C)(e.target,"."+F)),Object(l.X)(n)||this.rightCalendar.children[1].firstElementChild.focus()):this.leftCalendar.children[1].firstElementChild.focus(),Object(l.v)([p],"e-selected"),this.updateHeader(),this.removeFocusedDate()}},{key:"selectableDates",value:function(){if(!Object(l.X)(this.startValue)){var e=this.calendarElement.querySelectorAll(".e-calendar td"),t=!1;if(this.currentView()===this.depth){var i,n=c(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!r.classList.contains(z)&&!r.classList.contains("e-week-number")&&!r.classList.contains(P)){if(+this.getIdValue(null,r)<+this.startValue){Object(l.v)([r],[N,P,X]),l.l.clearEvents(r);continue}break}if(r.classList.contains(z)&&!r.classList.contains("e-other-month")){t=!0;break}}}catch(p){n.e(p)}finally{n.f()}t&&(this.previousIcon.classList.contains(P)||Object(l.v)([this.previousIcon],[W,P,X]))}else{var s,a=c(e);try{for(a.s();!(s=a.n()).done;){var o=s.value,h=this.startValue.getMonth(),u=this.startValue.getFullYear(),d=this.getIdValue(null,o);if(this.startButton.element.classList.contains(A)||!("Year"===this.currentView()&&d.getMonth()<h&&d.getFullYear()<=u||"Decade"===this.currentView()&&d.getMonth()<=h&&d.getFullYear()<u))break;Object(l.v)([o],[P])}}catch(p){a.e(p)}finally{a.f()}e[0].classList.contains(P)?this.previousIconHandler(!0):e[e.length-1].classList.contains(P)&&this.nextIconHandler(!0)}}}},{key:"updateMinMaxDays",value:function(e){if(!Object(l.X)(this.startValue)&&Object(l.X)(this.endValue)||this.isMobile&&this.endButton.element.classList.contains(A)){if(!Object(l.X)(this.minDays)&&this.minDays>0||!Object(l.X)(this.maxDays)&&this.maxDays>0){var t=this.removeTimeValueFromDate(this.startValue),i=new Date(new Date(+t).setDate(t.getDate()+(this.minDays-1))),n=new Date(new Date(+t).setDate(t.getDate()+(this.maxDays-1)));i=!Object(l.X)(this.minDays)&&this.minDays>0?i:null,n=!Object(l.X)(this.maxDays)&&this.maxDays>0?n:null,"Year"===this.currentView()?(i=Object(l.X)(i)?null:new Date(i.getFullYear(),i.getMonth(),0),n=Object(l.X)(n)?null:new Date(n.getFullYear(),n.getMonth(),1)):"Decade"===this.currentView()&&(i=Object(l.X)(i)?null:new Date(i.getFullYear()-1,11,1),n=Object(l.X)(n)?null:new Date(n.getFullYear(),0,1));var r,s,a=c(e.querySelectorAll(".e-calendar td"));try{for(a.s();!(s=a.n()).done;){var o=s.value;if(!o.classList.contains(z)&&!o.classList.contains("e-week-number")){var h=this.getIdValue(null,o);if(h=this.removeTimeValueFromDate(h),!Object(l.X)(i)&&+h==+i&&o.classList.contains(P)&&i.setDate(i.getDate()+1),!o.classList.contains(P)){if(+h<=+t)continue;!Object(l.X)(i)&&+h<+i&&(Object(l.v)([o],[N,P,X]),l.l.clearEvents(o)),!Object(l.X)(n)&&+h>+n&&(Object(l.v)([o],[N,P,X]),this.isMaxDaysClicked=!0,l.l.clearEvents(o),Object(l.X)(r)&&!o.classList.contains("e-other-month")&&(r=o))}}}}catch(d){a.e(d)}finally{a.f()}if(!Object(l.X)(r))if(this.isMobile)this.nextIcon.classList.contains(P)||Object(l.v)([this.nextIcon],[W,P,X]);else{var u=Object(l.C)(r,"."+F);(u=Object(l.X)(u)?this.leftCalendar:u).classList.contains(M)?(this.rightCalNextIcon.classList.contains(P)||Object(l.v)([this.rightCalNextIcon],[W,P,X]),this.leftCalNextIcon.classList.contains(P)||Object(l.v)([this.leftCalNextIcon],[W,P,X]),this.rightCalPrevIcon.classList.contains(P)||Object(l.v)([this.rightCalPrevIcon],[W,P,X])):this.rightCalNextIcon.classList.contains(P)||Object(l.v)([this.rightCalNextIcon],[W,P,X])}}}else this.isMaxDaysClicked=!1}},{key:"removeTimeValueFromDate",value:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}},{key:"removeClassDisabled",value:function(){var e,t=c(this.popupObj.element.querySelectorAll(".e-calendar td."+N));try{for(t.s();!(e=t.n()).done;){var i=e.value;i.classList.contains(N)&&(Object(l.ib)([i],[N,P,X]),l.l.add(i,"click",this.selectRange,this),this.isMobile||l.l.add(i,"mouseover",this.hoverSelection,this))}}catch(n){t.e(n)}finally{t.f()}this.isMobile?(this.nextIcon.classList.contains(W)&&Object(l.ib)([this.nextIcon],[W,P,X]),this.previousIcon.classList.contains(W)&&Object(l.ib)([this.previousIcon],[W,P,X])):(this.rightCalNextIcon.classList.contains(W)&&Object(l.ib)([this.rightCalNextIcon],[W,P,X]),this.rightCalPrevIcon.classList.contains(W)&&Object(l.ib)([this.rightCalPrevIcon],[W,P,X]),this.leftCalNextIcon.classList.contains(W)&&Object(l.ib)([this.leftCalNextIcon],[W,P,X]))}},{key:"updateHeader",value:function(){var e={type:"date",skeleton:Object(l.W)()?"D":"yMMMd"};if(Object(l.X)(this.endValue)||Object(l.X)(this.startValue))this.popupObj.element.querySelector("."+H).textContent=this.l10n.getConstant("selectedDays");else{var t=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1;Object(l.X)(this.disabledDayCnt)||(t-=this.disabledDayCnt,this.disabledDayCnt=null),this.popupObj.element.querySelector("."+H).textContent=t.toString()+" "+this.l10n.getConstant("days")}this.isMobile?(this.startButton.element.textContent=Object(l.X)(this.startValue)?this.l10n.getConstant("startLabel"):this.globalize.formatDate(this.startValue,e),this.endButton.element.textContent=Object(l.X)(this.endValue)||Object(l.X)(this.startValue)?this.l10n.getConstant("endLabel"):this.globalize.formatDate(this.endValue,e)):(Object(l.X)(this.endValue)||Object(l.X)(this.startValue)?this.popupObj.element.querySelector(".e-end-label").textContent=this.l10n.getConstant("endLabel"):this.popupObj.element.querySelector(".e-end-label").textContent=this.globalize.formatDate(this.endValue,e),Object(l.X)(this.startValue)?this.popupObj.element.querySelector(".e-start-label").textContent=this.l10n.getConstant("startLabel"):this.popupObj.element.querySelector(".e-start-label").textContent=this.globalize.formatDate(this.startValue,e)),(this.isDateDisabled(this.startValue)||this.isDateDisabled(this.endValue)||!Object(l.X)(this.startValue)&&+this.startValue<+this.min||!Object(l.X)(this.endValue)&&+this.endValue>+this.max||!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue)&&(this.isMobile?(this.startButton.element.textContent=this.l10n.getConstant("startLabel"),this.endButton.element.textContent=this.l10n.getConstant("endLabel"),this.popupObj.element.querySelector("."+H).textContent=this.l10n.getConstant("selectedDays")):(this.popupObj.element.querySelector("."+H).textContent=this.l10n.getConstant("selectedDays"),this.popupObj.element.querySelector(".e-start-label").textContent=this.l10n.getConstant("startLabel"),this.popupObj.element.querySelector(".e-end-label").textContent=this.l10n.getConstant("endLabel"))),this.popupObj.element.querySelector("#custom_range")&&(this.popupObj.element.querySelector("#custom_range").textContent=""!==this.l10n.getConstant("customRange")?this.l10n.getConstant("customRange"):"Custom Range")}},{key:"removeSelection",value:function(){this.startValue=null,this.endValue=null,this.setValue(),this.removeSelectedAttributes(),this.popupObj&&(this.popupObj.element.querySelectorAll(".e-selected").length>0&&Object(l.ib)(this.popupObj.element.querySelectorAll(".e-selected"),[z,L,"e-selected"]),this.popupObj.element.querySelectorAll("."+V).length>0&&Object(l.ib)(this.popupObj.element.querySelectorAll("."+V),V),this.popupObj.element.querySelectorAll("."+B).length>0&&Object(l.ib)(this.popupObj.element.querySelectorAll("."+B),[B]))}},{key:"addSelectedAttributes",value:function(e,t,i,n){if(e){var r=this.globalize.formatDate(t,{type:"date",skeleton:Object(l.W)()?"D":"full"});!Object(l.X)(n)&&n?e.setAttribute("aria-label","The current start and end date is "+r):e.setAttribute("aria-label","The current "+(i?"start":"end")+" date is "+r),e.setAttribute("aria-selected","true")}}},{key:"removeSelectedAttributes",value:function(){if(this.popupObj){var e,t=c(this.popupObj.element.querySelectorAll("."+z));try{for(t.s();!(e=t.n()).done;){var i=e.value;i.setAttribute("aria-selected","false"),i.removeAttribute("aria-label")}}catch(a){t.e(a)}finally{t.f()}var n,r=c(this.popupObj.element.querySelectorAll("."+L));try{for(r.s();!(n=r.n()).done;){var s=n.value;s.setAttribute("aria-selected","false"),s.removeAttribute("aria-label")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"updateCalendarElement",value:function(e){e.classList.contains(M)?(this.calendarElement=this.leftCalendar,this.currentDate=this.leftCalCurrentDate,this.previousIcon=this.leftCalPrevIcon,this.nextIcon=this.leftCalNextIcon):(this.calendarElement=this.rightCalendar,this.currentDate=this.rightCalCurrentDate,this.previousIcon=this.rightCalPrevIcon,this.nextIcon=this.rightCalNextIcon),this.contentElement=e.querySelector(".e-content"),this.tableBodyElement=Object(l.lb)(".e-content tbody",e),this.table=e.querySelector(".e-content").getElementsByTagName("table")[0],this.headerTitleElement=e.querySelector(".e-header .e-title"),this.headerElement=e.querySelector(".e-header")}},{key:"navPrevMonth",value:function(e){e.preventDefault();var t=Object(l.C)(e.target,"."+M);t=Object(l.X)(t)?Object(l.C)(e.target,"."+F):t,this.updateCalendarElement(t),this.navigatePrevious(e),!Object(l.X)(this.startValue)&&Object(l.X)(this.endValue)&&this.updateMinMaxDays(t),this.updateControl(t)}},{key:"deviceNavigation",value:function(e){this.deviceCalendarEvent(),this.updateRange([this.popupObj.element.querySelector("."+q)]),this.endButton.element.classList.contains(A)&&this.updateMinMaxDays(this.popupObj.element.querySelector("."+q)),this.endButton.element.classList.contains(A)&&this.selectableDates(),this.currentView()===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate()}},{key:"updateControl",value:function(e){e.classList.contains(F)?this.rightCalCurrentDate=new Date(+this.currentDate):this.leftCalCurrentDate=new Date(+this.currentDate),this.calendarIconEvent(),("Month"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-month")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-month")||"Year"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-year")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-year")||"Decade"===this.depth&&this.leftCalendar.querySelector(".e-content").classList.contains("e-decade")&&this.rightCalendar.querySelector(".e-content").classList.contains("e-decade")||this.isMobile)&&this.bindCalendarCellEvents(),this.removeFocusedDate(),this.updateRange([e])}},{key:"navNextMonth",value:function(e){e.preventDefault();var t=Object(l.C)(e.target,"."+M);t=Object(l.X)(t)?Object(l.C)(e.target,"."+F):t,this.updateCalendarElement(t),this.navigateNext(e),!Object(l.X)(this.startValue)&&Object(l.X)(this.endValue)&&this.updateMinMaxDays(t),this.updateControl(t)}},{key:"isPopupOpen",value:function(){return!(Object(l.X)(this.popupObj)||!this.popupObj.element.classList.contains("e-popup"))}},{key:"createRangeHeader",value:function(){var e=this.createElement("div",{className:"e-start-end"});if(this.isMobile){var t=this.createElement("button",{className:"e-end-btn"}),i=this.createElement("button",{className:"e-start-btn"});this.startButton=new d.a({content:this.l10n.getConstant("startLabel")},i),this.endButton=new d.a({content:this.l10n.getConstant("endLabel")},t),e.appendChild(i),e.appendChild(t)}else{var n=this.createElement("a",{className:"e-start-label"}),r=this.createElement("a",{className:"e-end-label"}),s=this.createElement("span",{className:"e-change-icon e-icons"});Object(l.x)(n,{"aria-atomic":"true","aria-live":"assertive","aria-label":"Start Date",role:"button"}),Object(l.x)(r,{"aria-atomic":"true","aria-live":"assertive","aria-label":"End Date",role:"button"}),e.appendChild(n),e.appendChild(s),e.appendChild(r),n.textContent=this.l10n.getConstant("startLabel"),r.textContent=this.l10n.getConstant("endLabel")}return e}},{key:"disableInput",value:function(){this.strictMode?Object(l.X)(this.previousStartValue)||Object(l.X)(this.previousEndValue)||(this.startValue=this.previousStartValue,this.endValue=this.previousEndValue,this.setValue(),this.updateInput()):(this.updateInput(),this.clearRange(),this.setProperties({startDate:null},!0),this.setProperties({endDate:null},!0),this.startValue=null,this.endValue=null,this.setValue(),this.errorClass()),this.setProperties({enabled:!1},!0),u.c.setEnabled(this.enabled,this.inputElement),this.bindEvents()}},{key:"validateMinMax",value:function(){this.min=Object(l.X)(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=Object(l.X)(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,this.min<=this.max?(Object(l.X)(this.minDays)||Object(l.X)(this.maxDays)||this.maxDays>0&&this.minDays>0&&this.minDays>this.maxDays&&(this.maxDays=null),!Object(l.X)(this.minDays)&&this.minDays<0&&(this.minDays=null),!Object(l.X)(this.maxDays)&&this.maxDays<0&&(this.maxDays=null)):this.disableInput()}},{key:"validateRangeStrict",value:function(){Object(l.X)(this.startValue)||(+this.startValue<=+this.min?(this.startValue=this.min,this.setValue()):+this.startValue>=+this.min&&+this.startValue>=+this.max&&(this.startValue=this.max)),Object(l.X)(this.endValue)||(+this.endValue>+this.max?(this.endValue=this.max,this.setValue()):+this.endValue<+this.min&&(this.endValue=this.min,this.setValue())),this.validateMinMaxDays()}},{key:"validateRange",value:function(){this.validateMinMaxDays()}},{key:"validateMinMaxDays",value:function(){if(!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)){var e=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1;if(!Object(l.X)(this.minDays)&&this.minDays>0&&!(e>=this.minDays))if(this.strictMode){var t=new Date(+this.startValue);t.setDate(t.getDate()+(this.minDays-1)),+t>+this.max?(this.endValue=this.max,this.setValue()):(this.endValue=t,this.setValue())}else this.startValue=null,this.endValue=null,this.setValue();Object(l.X)(this.maxDays)||!(this.maxDays>0)||e<=this.maxDays||(this.strictMode?(this.endValue=new Date(+this.startValue),this.endValue.setDate(this.endValue.getDate()+(this.maxDays-1)),this.setValue()):(this.startValue=null,this.endValue=null,this.setValue()))}}},{key:"renderCalendar",value:function(){this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(q),this.enableRtl&&this.calendarElement.classList.add("e-rtl"),Object(l.x)(this.calendarElement,{role:"calendar"}),i(o(r.prototype),"createHeader",this).call(this),i(o(r.prototype),"createContent",this).call(this)}},{key:"isSameMonth",value:function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},{key:"isSameYear",value:function(e,t){return e.getFullYear()===t.getFullYear()}},{key:"isSameDecade",value:function(e,t){var i=e.getFullYear(),n=t.getFullYear();return i-i%10==n-n%10}},{key:"startMonthCurrentDate",value:function(){this.isSameMonth(this.min,this.max)||+this.currentDate>+this.max||this.isSameMonth(this.currentDate,this.max)?(this.currentDate=new Date(+this.max),this.currentDate.setDate(1),this.currentDate.setMonth(this.currentDate.getMonth()-1)):this.currentDate<this.min&&(this.currentDate=new Date(this.checkValue(this.min)))}},{key:"selectNextMonth",value:function(){if(Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||this.isSameMonth(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue))return this.currentDate.setDate(1),void this.currentDate.setMonth(this.currentDate.getMonth()+1);if(this.currentDate=new Date(+this.endValue),!Object(l.X)(this.startValue)&&+this.startValue<+this.min||!Object(l.X)(this.endValue)&&+this.endValue>+this.max||!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue){this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setDate(1);var e=this.currentDate.getMonth()+1;this.currentDate.setMonth(e)}}},{key:"selectNextYear",value:function(){if(Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||this.isSameYear(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue)){this.currentDate.setMonth(0);var e=this.currentDate.getFullYear()+1;this.currentDate.setFullYear(e)}else this.currentDate=new Date(+this.endValue),(!Object(l.X)(this.endValue)&&+this.endValue>+this.max||!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(l.X)(this.startValue)&&+this.startValue<+this.min)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setMonth(0),this.currentDate.setFullYear(this.currentDate.getFullYear()+1))}},{key:"selectNextDecade",value:function(){if(Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||this.isSameDecade(this.endValue,this.currentDate)||this.isDateDisabled(this.endValue)||this.isDateDisabled(this.startValue)){var e=this.currentDate.getFullYear()+10;this.currentDate.setFullYear(e)}else this.currentDate=new Date(+this.endValue),(!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue||!Object(l.X)(this.endValue)&&+this.endValue>+this.max||!Object(l.X)(this.startValue)&&+this.startValue<+this.min)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.currentDate.setFullYear(this.currentDate.getFullYear()+10))}},{key:"selectStartMonth",value:function(){Object(l.X)(this.startValue)?(this.currentDate=new Date((new Date).setHours(0,0,0,0)),this.startMonthCurrentDate()):!Object(l.X)(this.max)&&this.isSameMonth(this.startValue,this.max)?(this.currentDate=new Date(+this.max),this.currentDate.setDate(1),this.currentDate.setMonth(this.currentDate.getMonth()-1)):this.currentDate=this.startValue>=this.min&&this.startValue<=this.max&&!this.isDateDisabled(this.startValue)?new Date(+this.startValue):new Date((new Date).setHours(0,0,0,0)),(!Object(l.X)(this.endValue)&&+this.endValue>+this.max||!Object(l.X)(this.startValue)&&+this.startValue<+this.min||!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue)&&+this.startValue>+this.endValue)&&(this.currentDate=new Date((new Date).setHours(0,0,0,0))),this.startMonthCurrentDate()}},{key:"createCalendar",value:function(){var e=this.createElement("div",{className:"e-calendar-container"});if(this.isMobile){Object(l.X)(this.startValue)||(this.currentDate=new Date(+this.startValue)),i(o(r.prototype),"validateDate",this).call(this),i(o(r.prototype),"minMaxUpdate",this).call(this),i(o(r.prototype),"render",this).call(this);var t=this.calendarElement.querySelector(".e-calendar .e-prev"),n=this.calendarElement.querySelector(".e-calendar .e-next");Object(l.hb)(this.calendarElement.querySelector(".e-calendar .e-icon-container")),this.calendarElement.querySelector(".e-calendar .e-header").appendChild(n),this.calendarElement.querySelector(".e-calendar .e-header").appendChild(t),Object(l.fb)([t],this.calendarElement.querySelector(".e-calendar .e-header")),this.deviceCalendar=this.calendarElement,e.appendChild(this.calendarElement),this.headerTitleElement=this.calendarElement.querySelector(".e-calendar .e-header .e-title")}else{this.selectStartMonth(),this.renderCalendar(),this.leftCalCurrentDate=new Date(+this.currentDate),this.calendarElement.classList.add(M),this.leftCalPrevIcon=this.calendarElement.querySelector(".e-left-calendar .e-prev"),this.leftCalNextIcon=this.calendarElement.querySelector(".e-left-calendar .e-next"),this.leftTitle=this.calendarElement.querySelector(".e-left-calendar .e-title"),Object(l.hb)(this.calendarElement.querySelector(".e-left-calendar .e-icon-container")),this.calendarElement.querySelector(".e-left-calendar .e-header").appendChild(this.leftCalNextIcon),this.calendarElement.querySelector(".e-left-calendar .e-header").appendChild(this.leftCalPrevIcon),Object(l.fb)([this.leftCalPrevIcon],this.calendarElement.querySelector(".e-left-calendar .e-header")),this.leftCalendar=this.calendarElement;var s=this.createElement("div",{className:"e-left-container"}),a=this.createElement("div",{className:"e-right-container"});s.appendChild(this.leftCalendar),e.appendChild(s),this.isMobile||l.l.add(this.leftTitle,"click",this.leftNavTitle,this),"Month"===this.start&&this.selectNextMonth(),"Year"===this.start&&this.selectNextYear(),"Decade"===this.start&&this.selectNextDecade(),this.renderCalendar(),this.rightCalCurrentDate=new Date(+this.currentDate),Object(l.v)([this.calendarElement],F),this.rightCalendar=this.calendarElement,Object(l.ib)([this.leftCalendar&&this.leftCalendar.querySelector(".e-content tbody")],"e-zoomin"),Object(l.ib)([this.rightCalendar&&this.rightCalendar.querySelector(".e-content tbody")],"e-zoomin"),this.rightCalPrevIcon=this.calendarElement.querySelector(".e-right-calendar .e-prev"),this.rightCalNextIcon=this.calendarElement.querySelector(".e-right-calendar .e-next"),this.rightTitle=this.calendarElement.querySelector(".e-right-calendar .e-title"),Object(l.hb)(this.calendarElement.querySelector(".e-right-calendar .e-icon-container")),this.calendarElement.querySelector("table").setAttribute("tabindex","-1"),this.calendarElement.querySelector(".e-right-calendar .e-header").appendChild(this.rightCalNextIcon),this.calendarElement.querySelector(".e-right-calendar .e-header").appendChild(this.rightCalPrevIcon),Object(l.fb)([this.rightCalPrevIcon],this.calendarElement.querySelector(".e-right-calendar .e-header")),a.appendChild(this.rightCalendar),e.appendChild(a),this.isMobile||l.l.add(this.rightTitle,"click",this.rightNavTitle,this)}return e}},{key:"leftNavTitle",value:function(e){this.isPopupOpen()&&(this.calendarElement=this.leftCalendar,this.calendarNavigation(e,this.calendarElement))}},{key:"calendarNavigation",value:function(e,t){this.table=t.querySelector("table"),this.headerTitleElement=t.querySelector(".e-title"),this.tableBodyElement=t.querySelector("tbody"),this.tableHeadElement=t.querySelector("thead"),this.contentElement=t.querySelector(".e-content"),this.updateCalendarElement(t),i(o(r.prototype),"navigateTitle",this).call(this,e),this.updateNavIcons()}},{key:"rightNavTitle",value:function(e){this.isPopupOpen()&&(this.calendarElement=this.rightCalendar,this.calendarNavigation(e,this.calendarElement))}},{key:"clickEventEmitter",value:function(e){this.isMobile||(Object(l.C)(e.target,".e-calendar.e-left-calendar")?(this.calendarElement=this.leftCalendar,this.updateCalendarElement(this.leftCalendar)):(this.calendarElement=this.rightCalendar,this.updateCalendarElement(this.rightCalendar)))}},{key:"currentView",value:function(){return i(o(r.prototype),"currentView",this).call(this)}},{key:"getCalendarView",value:function(e){return"Year"===e?"Year":"Decade"===e?"Decade":"Month"}},{key:"navigatedEvent",value:function(e){if(this.trigger("navigated",this.navigatedArgs),!Object(l.X)(this.popupObj)){var t=this.getCalendarView(this.currentView());this.isMobile?t===this.depth?(this.bindCalendarCellEvents(),this.deviceNavigation(),this.removeFocusedDate(),this.checkMinMaxDays()):this.selectableDates():this.isMobile||t!==this.depth?(this.updateNavIcons(),this.calendarIconEvent()):((this.calendarElement.classList.contains("e-left-calendar")?this.leftCalendar:this.rightCalendar)!==this.leftCalendar||(!e||e.currentTarget.children[0].classList.contains("e-icons"))&&Object(l.X)(this.controlDown)?(e&&!e.currentTarget.children[0].classList.contains("e-icons")||!Object(l.X)(this.controlDown))&&(this.rightCalCurrentDate=new Date(+this.currentDate),this.effect="",this.currentDate=this.rightCalCurrentDate,this.updateCalendarElement(this.rightCalendar),this.updateControl(this.rightCalendar),this.updateCalendarElement(this.leftCalendar),this.startValue&&Object(l.X)(this.endValue)&&("Month"===t&&this.startValue.getMonth()<this.rightCalCurrentDate.getMonth()&&this.startValue.getFullYear()<=this.rightCalCurrentDate.getFullYear()||"Year"===t&&this.startValue.getFullYear()<this.rightCalCurrentDate.getFullYear())?i(o(r.prototype),"navigateTo",this).call(this,t,new Date(+this.startValue)):i(o(r.prototype),"navigateTo",this).call(this,t,this.leftCalCurrentDate),this.updateControl(this.leftCalendar),this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.controlDown=null):(this.leftCalCurrentDate=new Date(+this.currentDate),this.effect="",this.currentDate=this.leftCalCurrentDate,this.updateCalendarElement(this.leftCalendar),this.updateControl(this.leftCalendar),this.updateCalendarElement(this.rightCalendar),i(o(r.prototype),"navigateTo",this).call(this,t,this.rightCalCurrentDate),this.updateControl(this.rightCalendar),this.updateNavIcons(),this.calendarIconEvent(),this.calendarIconRipple(),this.controlDown=null),this.checkMinMaxDays())}}},{key:"createControl",value:function(){var e=this.createElement("div",{className:"e-date-range-container"}),t=this.createElement("div",{className:"e-range-header"}),i=this.createRangeHeader();t.appendChild(i);var n=this.createElement("div",{className:H});Object(l.x)(n,{"aria-label":"Selected Days"}),n.textContent=this.l10n.getConstant("selectedDays"),t.appendChild(n);var r=this.createElement("div",{className:"e-separator"}),s=this.createCalendar();e.appendChild(t),e.appendChild(r),e.appendChild(s);var a=this.createElement("div",{className:"e-footer"}),o=this.createElement("button",{className:"e-cancel e-flat e-css"}),h=this.createElement("button");Object(l.v)([h],["e-apply","e-flat","e-primary","e-css"]),a.appendChild(h),a.appendChild(o);var c=!Object(l.X)(this.startValue)&&!Object(l.X)(this.endValue);this.cancelButton=new d.a({content:this.l10n.getConstant("cancelText")},o),this.applyButton=new d.a({content:this.l10n.getConstant("applyText"),disabled:!c},h),l.l.add(h,"click",this.applyFunction,this),l.l.add(o,"click",this.cancelFunction,this),this.popupWrapper.appendChild(e),this.isMobile||Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||(this.createPresets(),this.listRippleEffect(),Object(l.v)([e],"e-range-border"),Object(l.v)([this.popupWrapper],"e-preset-wrapper"),this.popupWrapper.querySelector(".e-presets").style.height=this.popupWrapper.querySelector(".e-date-range-container").getBoundingClientRect().height+"px"),this.popupWrapper.appendChild(a),this.isMobile&&this.deviceHeaderUpdate(),this.renderPopup()}},{key:"cancelFunction",value:function(e){document.activeElement!==this.inputElement&&(this.preventFocus=!0,this.inputElement.focus(),Object(l.v)([this.inputWrapper.container],["e-input-focus"])),e.preventDefault(),this.isKeyPopup&&(this.inputElement.focus(),this.isKeyPopup=!1),this.startValue=null,this.endValue=null,this.removeSelection(),this.hide(e)}},{key:"deviceHeaderUpdate",value:function(){Object(l.X)(this.startValue)&&Object(l.X)(this.endValue)?(this.endButton.element.setAttribute("disabled",""),this.startButton.element.classList.add(A)):Object(l.X)(this.startValue)||this.startButton.element.classList.add(A)}},{key:"applyFunction",value:function(e){var t=!1;"touchstart"!==e.type&&e.preventDefault(),this.closeEventArgs&&this.closeEventArgs.cancel&&(this.startValue=this.popupWrapper.querySelector(".e-start-date")&&this.getIdValue(null,this.popupWrapper.querySelector(".e-start-date")),this.endValue=this.popupWrapper.querySelector(".e-end-date")&&this.getIdValue(null,this.popupWrapper.querySelector(".e-end-date")),this.setValue()),document.activeElement!==this.inputElement&&(this.preventFocus=!0,this.inputElement.focus(),Object(l.v)([this.inputWrapper.container],["e-input-focus"])),"touchstart"!==e.type&&this.closeEventArgs&&!this.closeEventArgs.cancel&&e.preventDefault(),Object(l.X)(this.startValue)||Object(l.X)(this.endValue)?this.hide(e||null):(this.previousStartValue=new Date(+this.startValue),this.previousEndValue=new Date(+this.endValue),this.previousEleValue=this.inputElement.value,u.c.setValue(this.rangeArgs(e).text,this.inputElement,this.floatLabelType,this.showClearButton),+this.initStartDate==+this.startValue&&+this.initEndDate==+this.endValue||(t=!0),this.changeTrigger(e),this.hide(e||null),this.errorClass(),t=!0),Object(l.C)(e.target,".e-input-group")||t||this.focusOut(),this.isMobile||(this.isKeyPopup=!1,this.isRangeIconClicked&&(this.inputWrapper.container.children[1].focus(),this.keyInputConfigs=Object(l.K)(this.keyInputConfigs,this.keyConfigs),this.popupKeyboardModule=new l.o(this.inputWrapper.container.children[1],{eventName:"keydown",keyConfigs:this.keyInputConfigs,keyAction:this.popupKeyActionHandle.bind(this)})))}},{key:"onMouseClick",value:function(e,t){if("touchstart"!==e.type){var i=t||e.target,n=Object(l.C)(i,"."+G),r=n&&n.classList.contains(A);n&&n.classList.contains(G)&&this.setListSelection(n,e),this.inputElement.focus(),this.isMobile||(this.preventFocus=!0,n&&n.classList.contains(G)&&"custom_range"===n.getAttribute("id")?this.leftCalendar.children[1].firstElementChild.focus():r||"keydown"!==e.type||this.inputElement.focus())}}},{key:"onMouseOver",value:function(e){var t=Object(l.C)(e.target,"."+G);t&&t.classList.contains(G)&&!t.classList.contains(K)&&Object(l.v)([t],K)}},{key:"onMouseLeave",value:function(e){var t=Object(l.C)(e.target,"."+K);Object(l.X)(t)||Object(l.ib)([t],K)}},{key:"setListSelection",value:function(e,t){if(e&&(!e.classList.contains(A)||this.isMobile&&e.classList.contains(A))){if(this.isMobile&&e.classList.contains(A))return this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),"custom_range"===this.presetsItem[this.activeIndex].id?void this.renderCustomPopup():void 0;this.removeListSelection(),this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),Object(l.v)([e],A),e.setAttribute("aria-selected","true");var i=this.presetsItem[this.activeIndex];"custom_range"===i.id?this.renderCustomPopup():this.applyPresetRange(i,t)}}},{key:"removeListSelection",value:function(){var e=this.presetElement.querySelector(".e-active");Object(l.X)(e)||(Object(l.ib)([e],A),e.removeAttribute("aria-selected"))}},{key:"setValue",value:function(){this.modelValue=[this.startValue,this.endValue]}},{key:"applyPresetRange",value:function(e,t){this.hide(null),this.presetsItem[this.presetsItem.length-1].start=null,this.presetsItem[this.presetsItem.length-1].end=null,this.startValue=e.start,this.endValue=e.end,this.setValue(),this.refreshControl(),this.trigger("select",this.rangeArgs(t)),this.changeTrigger(t),this.previousEleValue=this.inputElement.value,this.isCustomRange=!1,this.leftCalendar=this.rightCalendar=null,this.isKeyPopup&&(this.isRangeIconClicked=!1,this.inputElement.focus())}},{key:"showPopup",value:function(e,t){this.presetHeight(),this.popupObj.show(null,1e3===this.zIndex?this.element:null),this.isMobile&&this.popupObj.refreshPosition()}},{key:"renderCustomPopup",value:function(){this.isCustomWindow=!0,this.popupObj.hide(),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:T+" e-popup"}),this.renderControl(),this.openEventArgs.appendTo.appendChild(this.popupWrapper),this.showPopup(),this.isCustomRange=!0,this.isMobile||this.calendarFocus()}},{key:"listRippleEffect",value:function(){var e,t=c(this.liCollections);try{for(t.s();!(e=t.n()).done;){var i=e.value;Object(l.kb)(i)}}catch(n){t.e(n)}finally{t.f()}}},{key:"createPresets",value:function(){if(!Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)){this.presetElement=this.createElement("div",{className:"e-presets",attrs:{tabindex:"0"}});var e=g.a.createList(this.createElement,this.presetsItem,null,!0);Object(l.x)(e,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),this.presetElement.appendChild(e),this.popupWrapper.appendChild(this.presetElement);var t=this.presetElement.querySelector("#custom_range");Object(l.X)(t)||(t.textContent=""!==this.l10n.getConstant("customRange")?this.l10n.getConstant("customRange"):"Custom Range"),this.liCollections=this.presetElement.querySelectorAll("."+G),this.wireListEvents(),this.isMobile&&(this.presetElement.style.width=this.inputWrapper.container.getBoundingClientRect().width+"px"),!Object(l.X)(this.activeIndex)&&this.activeIndex>-1&&Object(l.v)([this.liCollections[this.activeIndex]],A)}}},{key:"wireListEvents",value:function(){l.l.add(this.presetElement,"click",this.onMouseClick,this),this.isMobile||(l.l.add(this.presetElement,"mouseover",this.onMouseOver,this),l.l.add(this.presetElement,"mouseout",this.onMouseLeave,this))}},{key:"unWireListEvents",value:function(){Object(l.X)(this.presetElement)||(l.l.remove(this.presetElement,"click touchstart",this.onMouseClick),this.isMobile||(l.l.remove(this.presetElement,"mouseover",this.onMouseOver),l.l.remove(this.presetElement,"mouseout",this.onMouseLeave)))}},{key:"renderPopup",value:function(){var e=this;this.popupWrapper.classList.add("e-control");var t=this.popupWrapper.getBoundingClientRect().width;Object(l.X)(this.cssClass)||""===this.cssClass.trim()||(this.popupWrapper.className+=" "+this.cssClass),this.isMobile&&this.isCustomWindow&&(this.modal=this.createElement("div"),document.body.appendChild(this.modal)),this.popupObj=new h.c(this.popupWrapper,{relateTo:this.isMobile&&this.isCustomWindow?document.body:Object(l.X)(this.targetElement)?this.inputWrapper.container:this.targetElement,position:this.isMobile?Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||this.isCustomWindow?{X:"center",Y:"center"}:{X:"left",Y:"bottom"}:this.enableRtl?{X:"left",Y:"bottom"}:{X:"right",Y:"bottom"},offsetX:this.isMobile||this.enableRtl?0:-t,offsetY:4,collision:this.isMobile?Object(l.ab)(this.presets[0].start&&this.presets[0].end&&this.presets[0].label)||this.isCustomWindow?{X:"fit",Y:"fit"}:{X:"fit"}:{X:"fit",Y:"flip"},targetType:this.isMobile&&this.isCustomWindow?"container":"relative",enableRtl:this.enableRtl,zIndex:this.zIndex,open:function(){Object(l.x)(e.inputElement,{"aria-expanded":"true"}),Object(l.v)([e.inputWrapper.buttons[0]],A),e.isMobile||(e.cancelButton&&(e.btnKeyboardModule=new l.o(e.cancelButton.element,{eventName:"keydown",keyAction:e.popupKeyActionHandle.bind(e),keyConfigs:{tab:"tab",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}}),e.btnKeyboardModule=new l.o(e.applyButton.element,{eventName:"keydown",keyAction:e.popupKeyActionHandle.bind(e),keyConfigs:{altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}})),Object(l.X)(e.leftCalendar)||e.isRangeIconClicked||e.calendarFocus(),Object(l.X)(e.presetElement)||(e.keyInputConfigs=Object(l.K)(e.keyInputConfigs,e.keyConfigs),e.presetKeyboardModule=new l.o(e.presetElement,{eventName:"keydown",keyAction:e.presetKeyActionHandler.bind(e),keyConfigs:e.keyInputConfigs}),e.presetKeyboardModule=new l.o(e.presetElement,{eventName:"keydown",keyAction:e.popupKeyActionHandle.bind(e),keyConfigs:{altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"}}),Object(l.X)(e.leftCalendar)?(e.preventBlur=!0,e.presetElement.focus()):e.presetElement.setAttribute("tabindex","-1")),e.popupKeyBoardHandler()),e.isMobile&&!l.d.isDevice&&l.l.add(document,"keydown",e.popupCloseHandler,e)},close:function(){Object(l.x)(e.inputElement,{"aria-expanded":"false"}),Object(l.ib)([e.inputWrapper.buttons[0]],A),e.isRangeIconClicked&&e.inputWrapper.container.children[1].focus(),Object(l.ab)(e.presets[0].start&&e.presets[0].end&&e.presets[0].label)||e.unWireListEvents(),Object(l.X)(e.popupObj)||(Object(l.X)(e.popupObj.element.parentElement)||Object(l.I)(e.popupObj.element),e.popupObj.destroy(),e.popupObj=null),e.isMobile&&!l.d.isDevice&&l.l.remove(document,"keydown",e.popupCloseHandler)},targetExitViewport:function(){l.d.isDevice||e.hide()}}),this.isMobile&&(this.popupObj.element.classList.add("e-device"),this.isMobile||this.popupObj.element.classList.add("e-bigger")),this.isMobile&&this.isCustomWindow&&(Object(l.v)([this.modal],["e-device",T,"e-range-modal"]),document.body.className+=" e-range-overflow",this.modal.style.display="block"),l.l.add(document,"mousedown touchstart",this.documentHandler,this)}},{key:"popupCloseHandler",value:function(e){switch(e.keyCode){case 27:this.hide(e)}}},{key:"calendarFocus",value:function(){var e=this.popupObj&&this.popupObj.element.querySelector("."+z);if(e){var t=Object(l.C)(e,"."+F);t=Object(l.X)(t)?this.leftCalendar:t,this.isRangeIconClicked?this.inputWrapper.container.focus():(this.preventBlur=!0,t.children[1].firstElementChild.focus()),Object(l.v)([e],V)}else this.isRangeIconClicked?this.inputWrapper.container.focus():(this.preventBlur=!0,this.leftCalendar.children[1].firstElementChild.focus())}},{key:"presetHeight",value:function(){var e=this.popupObj&&this.popupObj.element.querySelector(".e-presets"),t=this.popupObj&&this.popupObj.element.querySelector(".e-date-range-container");Object(l.X)(e)||Object(l.X)(t)||(e.style.height=t.getBoundingClientRect().height+"px")}},{key:"presetKeyActionHandler",value:function(e){switch(e.action){case"moveDown":this.listMoveDown(e),this.setScrollPosition(),e.preventDefault();break;case"moveUp":this.listMoveUp(e),this.setScrollPosition(),e.preventDefault();break;case"enter":var t=this.getHoverLI(),i=this.getActiveLI();if(!Object(l.X)(this.leftCalendar)&&!Object(l.X)(i)&&(Object(l.X)(t)||!Object(l.X)(i)&&i===t)&&(this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(i),"custom_range"===this.presetsItem[this.activeIndex].id))return this.calendarFocus(),i.classList.remove(K),void e.preventDefault();Object(l.X)(t)&&Object(l.X)(i)||this.onMouseClick(e,t||i),e.preventDefault();break;case"tab":if(this.leftCalendar){var n=this.getHoverLI();Object(l.X)(n)||n.classList.remove(K)}else this.hide(e),e.preventDefault()}}},{key:"listMoveDown",value:function(e){var t=this.getHoverLI(),i=this.getActiveLI();if(Object(l.X)(t))if(Object(l.X)(i))Object(l.v)([this.liCollections[0]],K);else{var n=i.nextElementSibling;!Object(l.X)(n)&&n.classList.contains(G)&&Object(l.v)([n],K)}else{var r=t.nextElementSibling;!Object(l.X)(r)&&r.classList.contains(G)&&(Object(l.ib)([t],K),Object(l.v)([r],K))}}},{key:"listMoveUp",value:function(e){var t=this.getHoverLI(),i=this.getActiveLI();if(Object(l.X)(t)){if(!Object(l.X)(i)){var n=i.previousElementSibling;!Object(l.X)(n)&&n.classList.contains(G)&&Object(l.v)([n],K)}}else{var r=t.previousElementSibling;!Object(l.X)(r)&&r.classList.contains(G)&&(Object(l.ib)([t],K),Object(l.v)([r],K))}}},{key:"getHoverLI",value:function(){return this.presetElement.querySelector("."+K)}},{key:"getActiveLI",value:function(){return this.presetElement.querySelector(".e-active")}},{key:"popupKeyBoardHandler",value:function(){this.popupKeyboardModule=new l.o(this.popupWrapper,{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:{escape:"escape"}}),this.keyInputConfigs=Object(l.K)(this.keyInputConfigs,this.keyConfigs),this.popupKeyboardModule=new l.o(this.inputWrapper.container.children[1],{eventName:"keydown",keyAction:this.popupKeyActionHandle.bind(this),keyConfigs:this.keyInputConfigs})}},{key:"setScrollPosition",value:function(){var e=this.presetElement.getBoundingClientRect().height,t=this.presetElement.querySelector("."+K),i=this.presetElement.querySelector(".e-active"),n=Object(l.X)(t)?i:t;if(!Object(l.X)(n)){var r=n.nextElementSibling,s=r?r.offsetTop:n.offsetTop,a=n.getBoundingClientRect().height;this.presetElement.scrollTop=s+n.offsetTop>e?r?s-(e/2+a/2):s:0}}},{key:"popupKeyActionHandle",value:function(e){var t=Object(l.C)(e.target,".e-presets");switch(e.action){case"escape":this.isPopupOpen()?(this.isKeyPopup&&(this.inputElement.focus(),this.isKeyPopup=!1),this.hide(e)):this.inputWrapper.container.children[1].blur();break;case"enter":this.isPopupOpen()?this.inputWrapper.container.children[1].focus():this.show(null,e);break;case"tab":this.hide(e);break;case"altRightArrow":Object(l.X)(t)?document.activeElement===this.cancelButton.element&&!0!==this.applyButton.element.disabled?this.applyButton.element.focus():this.leftCalendar.children[1].firstElementChild.focus():this.cancelButton.element.focus(),e.preventDefault();break;case"altLeftArrow":Object(l.X)(t)?document.activeElement===this.applyButton.element&&!0!==this.applyButton.element.disabled?this.cancelButton.element.focus():Object(l.X)(this.presetElement)||document.activeElement!==this.cancelButton.element?this.rightCalendar.children[1].firstElementChild.focus():this.presetElement.focus():this.rightCalendar.children[1].firstElementChild.focus(),e.preventDefault()}}},{key:"documentHandler",value:function(e){if(!Object(l.X)(this.popupObj)){var t=e.target;this.inputWrapper.container.contains(t)&&(Object(l.X)(this.popupObj)||Object(l.C)(t,'[id="'+this.popupWrapper.id+'"]'))||"touchstart"!==e.type&&("mousedown"===e.type||this.closeEventArgs&&!this.closeEventArgs.cancel)&&e.preventDefault(),!Object(l.X)(this.targetElement)&&(Object(l.X)(this.targetElement)||t===this.targetElement)||Object(l.C)(t,'[id="'+this.popupWrapper.id+'"]')||Object(l.C)(t,".e-input-group")===this.inputWrapper.container||Object(l.C)(t,".e-daterangepicker.e-popup")&&!t.classList.contains("e-day")||(this.preventBlur=!1,this.isPopupOpen()&&document.body.contains(this.popupObj.element)&&(this.applyFunction(e),this.isMobile||(this.isRangeIconClicked=!1)))}}},{key:"createInput",value:function(){var e=this.cssClass;Object(l.X)(this.cssClass)||""===this.cssClass||(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=u.c.createInput({floatLabelType:this.floatLabelType,element:this.inputElement,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:["e-input-group-icon e-range-icon e-icons"]},this.createElement),Object(l.x)(this.inputElement,{"aria-readonly":this.readonly?"true":"false",tabindex:"0","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_popup","aria-expanded":"false",role:"combobox",autocomplete:"off","aria-disabled":this.enabled?"false":"true",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),u.c.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),Object(l.X)(this.placeholder)||""===this.placeholder.trim()||u.c.addAttributes({"aria-placeholder":this.placeholder},this.inputElement),this.setEleWidth(this.width),Object(l.v)([this.inputWrapper.container],"e-date-range-wrapper"),Object(l.X)(this.inputElement.getAttribute("name"))&&Object(l.x)(this.inputElement,{name:this.element.id}),"hidden"===this.inputElement.type&&(this.inputWrapper.container.style.display="none"),this.refreshControl(),this.previousEleValue=this.inputElement.value,this.inputElement.setAttribute("value",this.inputElement.value),this.startCopy=this.startDate,this.endCopy=this.endDate}},{key:"setEleWidth",value:function(e){this.inputWrapper.container.style.width="string"==typeof e?this.width:"number"==typeof e?Object(l.L)(this.width):"100%"}},{key:"adjustLongHeaderWidth",value:function(){"Wide"===this.dayHeaderFormat&&Object(l.v)([this.popupWrapper],"e-daterange-day-header-lg")}},{key:"refreshControl",value:function(){this.validateMinMax(),this.strictMode&&this.validateRangeStrict();var e=this.disabledDates();this.strictMode&&e&&(this.startValue=this.previousStartValue,this.setProperties({startDate:this.startValue},!0),this.endValue=this.previousEndValue,this.setProperties({endDate:this.endValue},!0),this.setValue()),this.updateInput(),this.strictMode||this.validateRange(),!this.strictMode&&e&&this.clearRange(),Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||e||this.disabledDateRender(),this.errorClass(),this.previousStartValue=Object(l.X)(this.startValue)||isNaN(+this.startValue)?null:new Date(+this.startValue),this.previousEndValue=Object(l.X)(this.endValue)||isNaN(+this.endValue)?null:new Date(+this.endValue)}},{key:"updateInput",value:function(){if(!Object(l.X)(this.endValue)&&!Object(l.X)(this.startValue)){var e={format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"},t=this.globalize.formatDate(this.startValue,e),i=this.globalize.formatDate(this.endValue,e);u.c.setValue(t+" "+this.separator+" "+i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousStartValue=new Date(+this.startValue),this.previousEndValue=new Date(+this.endValue)}!this.strictMode&&Object(l.X)(this.value)&&this.invalidValueString&&u.c.setValue(this.invalidValueString,this.inputElement,this.floatLabelType,this.showClearButton)}},{key:"checkInvalidRange",value:function(e){if(!Object(l.X)(e)){var t,i,n=!1,r=null,s=null,a=null,o=!1,h=!1,c=!1;if("string"==typeof e){var u=e.split(" "+this.separator+" ");2===u.length?(r=u[0],s=u[1]):(n=!0,a=e)}else e.length>0?(t=e[0],i=e[1]):(t=e.start,i=e.end),t instanceof Date||"object"==typeof t?t instanceof Date?o=!0:Object(l.X)(t)||(c=!0):r=this.getstringvalue(t),i instanceof Date||"object"==typeof i?i instanceof Date?h=!0:Object(l.X)(i)||(c=!0):s=this.getstringvalue(i);(Object(l.X)(r)&&!o&&!Object(l.X)(s)||!Object(l.X)(r)&&!h&&Object(l.X)(s))&&(n=!0),c&&(r=s=a=null,n=!0),r&&(n=n||this.checkInvalidValue(r)),s&&(n=n||this.checkInvalidValue(s)),n&&(o&&!c&&(r=t.toLocaleDateString()),h&&!c&&(s=i.toLocaleDateString()),Object(l.X)(r)||Object(l.X)(s)?Object(l.X)(r)?Object(l.X)(s)||(a=s):a=r:a=r+" "+this.separator+" "+s,this.invalidValueString=a,this.setProperties({value:null},!0),this.setProperties({startValue:null},!0),this.setProperties({endValue:null},!0),this.startDate=null,this.endDate=null)}}},{key:"getstringvalue",value:function(e){var t=null;return Object(l.X)(e)||"number"!=typeof e?Object(l.X)(e)||"string"!=typeof e||(t=""+e):t=e.toString(),t}},{key:"checkInvalidValue",value:function(e){var t,i=e,n=!1;if(t={format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"},"string"!=typeof i)n=!0;else{var r=new l.n(this.locale);if(!this.checkDateValue(r.parseDate(i,t))){var s=null;s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,(!/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/.test(i)&&!s.test(i)||/^[a-zA-Z0-9- ]*$/.test(i)||isNaN(+new Date(this.checkValue(i))))&&(n=!0)}}return n}},{key:"isDateDisabled",value:function(e){if(Object(l.X)(e))return!1;var t=new Date(+e);if(+t<+this.min||+t>+this.max)return!0;this.virtualRenderCellArgs={date:t,isDisabled:!1};var i=this.virtualRenderCellArgs;return this.virtualRenderCellEvent(i),!!i.isDisabled}},{key:"disabledDateRender",value:function(){this.disabledDays=[],this.disabledDayCnt=null;for(var e=new Date(+this.startValue),t=0;+e<=+this.endValue;){this.virtualRenderCellArgs={date:e,isDisabled:!1};var i=this.virtualRenderCellArgs;this.virtualRenderCellEvent(i),i.isDisabled&&(this.disabledDays.push(new Date(+i.date)),+e>+this.startValue&&+e<+this.endValue&&t++),this.addDay(e,1,null,this.max,this.min)}this.disabledDayCnt=t}},{key:"virtualRenderCellEvent",value:function(e){Object(l.K)(this.virtualRenderCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)}},{key:"disabledDates",value:function(){var e=!1,t=!1;return Object(l.X)(this.endValue)||Object(l.X)(this.startValue)||(e=this.isDateDisabled(this.startValue),t=this.isDateDisabled(this.endValue),this.isPopupOpen()||(this.currentDate=null),this.setValue()),e||t}},{key:"setModelValue",value:function(){this.value||null!==this.startDate||null!==this.endDate?null===this.value||null===this.value.start?null===this.value?this.setProperties({value:[this.startDate,this.endDate]},!0):null===this.value.start&&this.setProperties({value:{start:this.startDate,end:this.endDate}},!0):this.value&&this.value.length>0||this.valueType&&this.valueType.length>0?(+this.startDate==+this.value[0]&&+this.endDate==+this.value[1]||this.setProperties({value:[this.startDate,this.endDate]},!0),this.value&&null==this.value[0]&&null==this.value[1]&&this.setProperties({value:null},!0)):this.value&&this.value.start&&this.setProperties({value:{start:this.startDate,end:this.endDate}},!0):this.setProperties({value:null},!0),this.createHiddenInput()}},{key:"dispatchEvent",value:function(e,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0),e.dispatchEvent(i),this.firstHiddenChild.dispatchEvent(i)}},{key:"changeTrigger",value:function(e){+this.initStartDate==+this.startValue&&+this.initEndDate==+this.endValue||(this.setProperties({endDate:this.checkDateValue(this.endValue)},!0),this.setProperties({startDate:this.checkDateValue(this.startValue)},!0),this.setModelValue(),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.rangeArgs(e))),this.previousEleValue=this.inputElement.value,this.initStartDate=this.checkDateValue(this.startValue),this.initEndDate=this.checkDateValue(this.endValue)}},{key:"navigateTo",value:function(e,t){if(this.isPopupOpen()){if("month"===e.toLowerCase())e="Month";else if("year"===e.toLowerCase())e="Year";else{if("decade"!==e.toLowerCase())return;e="Decade"}this.getViewNumber(e)<this.getViewNumber(this.depth)&&(e=this.depth),this.isMobile?i(o(r.prototype),"navigateTo",this).call(this,e,t):(t<this.min?t=new Date(+this.min):t>=this.max&&(t=new Date(+this.max)),"Month"===e&&this.isSameMonth(t,this.max)?t=new Date(this.max.getFullYear(),this.max.getMonth()-1,this.min.getDate()):"Year"===e&&this.isSameYear(t,this.max)?t=new Date(this.max.getFullYear()-1,this.max.getMonth(),this.max.getDate()):"Decade"===e&&this.isSameDecade(t,this.max)&&(t=new Date(this.max.getFullYear()-10,this.max.getMonth(),this.max.getDate())),this.leftCalCurrentDate=t,this.navigate(this.leftCalendar,this.leftCalCurrentDate,e),t="Month"===e?new Date(this.currentDate.setMonth(this.currentDate.getMonth()+1)):"Year"===e?new Date(this.currentDate.setFullYear(this.currentDate.getFullYear()+1)):new Date(this.currentDate.setFullYear(this.currentDate.getFullYear()+10)),this.rightCalCurrentDate=t,this.navigate(this.rightCalendar,this.rightCalCurrentDate,e),this.leftKeyboardModule=this.rightKeyboardModule=null,this.updateNavIcons()),this.currentView()===this.depth&&this.bindCalendarCellEvents(),this.removeFocusedDate(),this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar])}}},{key:"navigate",value:function(e,t,n){this.calendarElement=e,this.table=e.querySelector("table"),this.tableBodyElement=e.querySelector("tbody"),this.headerTitleElement=e.querySelector(".e-title"),this.tableHeadElement=e.querySelector("thead"),this.contentElement=e.querySelector(".e-content"),this.previousIcon=e.querySelector(".e-prev"),this.nextIcon=e.querySelector(".e-next"),this.effect="e-zoomin",i(o(r.prototype),"navigateTo",this).call(this,n,t)}},{key:"focusIn",value:function(){document.activeElement!==this.inputElement&&this.enabled&&(Object(l.v)([this.inputWrapper.container],["e-input-focus"]),this.inputElement.focus())}},{key:"focusOut",value:function(){var e=this.preventBlur;document.activeElement===this.inputElement&&(Object(l.ib)([this.inputWrapper.container],["e-input-focus"]),this.preventBlur=!1,this.inputElement.blur(),this.preventBlur=e)}},{key:"destroy",value:function(){this.unBindEvents(),this.hide(null);var e={"aria-readonly":this.readonly?"true":"false",tabindex:"0","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_popup","aria-expanded":"false",role:"combobox",autocomplete:"off","aria-disabled":this.enabled?"false":"true",autocorrect:"off",autocapitalize:"off","aria-invalid":"false",spellcheck:"false"};this.inputElement&&(Object(l.ib)([this.inputElement],[T]),l.l.remove(this.inputElement,"blur",this.inputBlurHandler),u.c.removeAttributes(e,this.inputElement),Object(l.X)(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.inputElement.classList.remove("e-input"),Object(l.X)(this.inputWrapper)||(l.l.remove(this.inputWrapper.buttons[0],"mousedown",this.rangeIconHandler),null===this.angularTag&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),Object(l.I)(this.inputWrapper.container))),Object(l.X)(this.inputKeyboardModule)||this.isMobile||this.inputKeyboardModule.destroy(),this.popupObj&&(this.isMobile||this.clearCalendarEvents()),i(o(r.prototype),"destroy",this).call(this),this.inputWrapper=this.popupWrapper=this.popupObj=this.cloneElement=this.presetElement=null,this.formElement&&l.l.remove(this.formElement,"reset",this.formResetHandler),Object(l.X)(this.firstHiddenChild)||Object(l.X)(this.secondHiddenChild)||(Object(l.I)(this.firstHiddenChild),Object(l.I)(this.secondHiddenChild),this.firstHiddenChild=this.secondHiddenChild=null,this.inputElement.setAttribute("name",this.element.getAttribute("data-name")),this.inputElement.removeAttribute("data-name"))}},{key:"ensureInputAttribute",value:function(){for(var e=[],t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(var i=0;i<e.length;i++)Object(l.X)(this.cloneElement.getAttribute(e[i]))?("value"===e[i].toLowerCase()&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[i])):("value"===e[i].toLowerCase()&&(this.inputElement.value=this.cloneElement.getAttribute(e[i])),this.inputElement.setAttribute(e[i],this.cloneElement.getAttribute(e[i])))}},{key:"getModuleName",value:function(){return"daterangepicker"}},{key:"getPersistData",value:function(){return this.addOnPersist(["startDate","endDate","value"])}},{key:"getSelectedRange",value:function(){var e;return Object(l.X)(this.startValue)||Object(l.X)(this.endValue)?e=0:(e=Math.round(Math.abs((this.removeTimeValueFromDate(this.startValue).getTime()-this.removeTimeValueFromDate(this.endValue).getTime())/864e5))+1,this.disabledDateRender(),Object(l.X)(this.disabledDayCnt)||(e-=this.disabledDayCnt,this.disabledDayCnt=null)),{startDate:this.startValue,endDate:this.endValue,daySpan:e}}},{key:"show",value:function(e,t){var n=this;this.isMobile&&this.popupObj&&this.popupObj.refreshPosition(),this.enabled&&this.readonly||!this.enabled||this.popupObj||this.isPopupOpen()||(e&&(this.targetElement=e),this.createPopup(),(this.isMobile||l.d.isDevice)&&(this.mobileRangePopupWrap=this.createElement("div",{className:"e-daterangepick-mob-popup-wrap"}),document.body.appendChild(this.mobileRangePopupWrap)),this.openEventArgs={popup:Object(l.W)()&&this.isServerRendered?null:this.popupObj||null,cancel:!1,date:this.inputElement.value,model:Object(l.W)()&&this.isServerRendered?null:this,event:t||null,appendTo:this.isMobile||l.d.isDevice?this.mobileRangePopupWrap:document.body},this.trigger("open",this.openEventArgs,(function(s){if(n.openEventArgs=s,!n.openEventArgs.cancel){n.openEventArgs.appendTo.appendChild(n.popupWrapper),n.showPopup(e,t);var a=!n.isCustomRange||n.isMobile&&n.isCustomRange;!Object(l.ab)(n.presets[0].start&&n.presets[0].end&&n.presets[0].label)&&a&&n.setScrollPosition(),n.checkMinMaxDays(),n.isMobile&&!Object(l.X)(n.startDate)&&Object(l.X)(n.endDate)&&(n.endButton.element.classList.add(A),n.startButton.element.classList.remove(A),n.endButton.element.removeAttribute("disabled"),n.selectableDates()),i(o(r.prototype),"setOverlayIndex",n).call(n,n.mobileRangePopupWrap,n.popupObj.element,n.modal,n.isMobile||l.d.isDevice)}})))}},{key:"hide",value:function(e){var t=this;this.popupObj?(Object(l.X)(this.previousEndValue)&&Object(l.X)(this.previousStartValue)?this.clearRange():(Object(l.X)(this.previousStartValue)?(this.startValue=null,this.setValue()):(this.startValue=new Date(this.checkValue(this.previousStartValue)),this.setValue(),this.currentDate=new Date(this.checkValue(this.startValue))),Object(l.X)(this.previousEndValue)?(this.endValue=null,this.setValue()):(this.endValue=new Date(this.checkValue(this.previousEndValue)),this.setValue())),this.isPopupOpen()&&(this.closeEventArgs={cancel:!1,popup:Object(l.W)()&&this.isServerRendered?null:this.popupObj,date:this.inputElement.value,model:Object(l.W)()&&this.isServerRendered?null:this,event:e||null},this.trigger("close",this.closeEventArgs,(function(e){t.closeEventArgs=e,t.closeEventArgs.cancel?Object(l.ib)([t.inputWrapper.buttons[0]],A):(t.isMobile&&(Object(l.X)(t.startButton)||Object(l.X)(t.endButton)||(l.l.remove(t.startButton.element,"click touchstart",t.deviceHeaderClick),l.l.remove(t.endButton.element,"click touchstart",t.deviceHeaderClick))),t.popupObj&&(t.popupObj.hide(),t.preventBlur&&(t.inputElement.focus(),Object(l.v)([t.inputWrapper.container],["e-input-focus"]))),t.isMobile||(Object(l.X)(t.leftKeyboardModule)||Object(l.X)(t.rightKeyboardModule)||(t.leftKeyboardModule.destroy(),t.rightKeyboardModule.destroy()),Object(l.X)(t.presetElement)||t.presetKeyboardModule.destroy(),Object(l.X)(t.cancelButton)||t.btnKeyboardModule.destroy()),t.targetElement=null,Object(l.ib)([document.body],"e-range-overflow"),l.l.remove(document,"mousedown touchstart",t.documentHandler),t.isMobile&&t.modal&&(t.modal.style.display="none",t.modal.outerHTML="",t.modal=null),(t.isMobile||l.d.isDevice)&&(Object(l.X)(t.mobileRangePopupWrap)||(t.mobileRangePopupWrap.remove(),t.mobileRangePopupWrap=null)),t.isKeyPopup=t.dateDisabled=!1),t.updateClearIconState(),t.updateHiddenInput(),t.isMobile&&t.allowEdit&&!t.readonly&&t.inputElement.removeAttribute("readonly")})))):(this.updateClearIconState(),this.updateHiddenInput(),this.isMobile&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"))}},{key:"setLocale",value:function(){this.globalize=new l.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),u.c.setPlaceholder(this.placeholder,this.inputElement),this.updateInput(),this.updateHiddenInput(),this.changeTrigger()}},{key:"refreshChange",value:function(){this.checkView(),this.refreshControl(),this.changeTrigger()}},{key:"setDate",value:function(){u.c.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.refreshChange()}},{key:"enableInput",value:function(){+this.min<=+this.max&&(this.setProperties({enabled:!0},!0),u.c.setEnabled(this.enabled,this.inputElement),this.element.hasAttribute("disabled")&&this.bindEvents())}},{key:"clearModelvalue",value:function(e,t){this.setProperties({startDate:null},!0),this.setProperties({endDate:null},!0),t.value&&t.value.length>0?this.setProperties({value:null},!0):(t.value&&t.value.start||t.value&&!t.value.start)&&this.setProperties({value:{start:null,end:null}},!0),this.updateValue(),this.setDate()}},{key:"createHiddenInput",value:function(){Object(l.X)(this.firstHiddenChild)&&Object(l.X)(this.secondHiddenChild)&&(this.firstHiddenChild=this.createElement("input"),this.secondHiddenChild=this.createElement("input")),Object(l.X)(this.inputElement.getAttribute("name"))||(this.inputElement.setAttribute("data-name",this.inputElement.getAttribute("name")),this.inputElement.removeAttribute("name")),Object(l.x)(this.firstHiddenChild,{type:"text",name:this.inputElement.getAttribute("data-name"),class:"e-daterange-hidden"}),Object(l.x)(this.secondHiddenChild,{type:"text",name:this.inputElement.getAttribute("data-name"),class:"e-daterange-hidden"});var e={type:"datetime",skeleton:Object(l.W)()?"d":"yMd"};this.firstHiddenChild.value=this.startDate&&this.globalize.formatDate(this.startDate,e),this.secondHiddenChild.value=this.endDate&&this.globalize.formatDate(this.endDate,e),this.inputElement.parentElement.appendChild(this.firstHiddenChild),this.inputElement.parentElement.appendChild(this.secondHiddenChild)}},{key:"setMinMaxDays",value:function(){this.isPopupOpen()&&(this.removeClassDisabled(),this.checkMinMaxDays(),this.isMobile&&this.selectableDates(),!this.strictMode&&Object(l.X)(this.startValue)&&Object(l.X)(this.endValue)?this.removeSelection():this.updateRange(this.isMobile?[this.calendarElement]:[this.leftCalendar,this.rightCalendar]),this.updateHeader())}},{key:"onPropertyChanged",value:function(e,t){for(var i={format:this.formatString,type:"date",skeleton:Object(l.W)()?"d":"yMd"},n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(["maxDays","minDays"].indexOf(s)<0&&this.hide(null),s){case"width":this.setEleWidth(this.width);break;case"separator":this.previousEleValue=this.inputElement.value,this.setProperties({separator:e.separator},!0),this.updateInput(),this.changeTrigger();break;case"placeholder":u.c.setPlaceholder(e.placeholder,this.inputElement),this.setProperties({placeholder:e.placeholder},!0);break;case"readonly":u.c.setReadonly(this.readonly,this.inputElement),this.inputElement.setAttribute("aria-readonly",""+this.readonly),this.setRangeAllowEdit();break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"enabled":this.setProperties({enabled:e.enabled},!0),u.c.setEnabled(this.enabled,this.inputElement),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1;break;case"allowEdit":this.setRangeAllowEdit();break;case"enableRtl":this.setProperties({enableRtl:e.enableRtl},!0),u.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.updateInput(),this.changeTrigger();break;case"locale":this.globalize=new l.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),u.c.setPlaceholder(this.placeholder,this.inputElement),this.setLocale();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.setDataAttribute(!0),this.checkHtmlAttributes(!0);break;case"showClearButton":u.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"startDate":"string"==typeof e.startDate&&(e.startDate=this.globalize.parseDate(e.startDate,i)),+this.initStartDate!=+e.startDate&&(this.startValue=this.checkDateValue(new Date(this.checkValue(e.startDate))),this.setDate(),this.setValue());break;case"endDate":"string"==typeof e.endDate&&(e.endDate=this.globalize.parseDate(e.endDate,i)),+this.initEndDate!=+e.endDate&&(this.endValue=this.checkDateValue(new Date(this.checkValue(e.endDate))),this.setDate(),this.setValue());break;case"value":if(this.invalidValueString=null,this.checkInvalidRange(e.value),"string"==typeof e.value)if(this.invalidValueString)this.clearModelvalue(e,t);else{var a=e.value.split(" "+this.separator+" ");this.value=[new Date(a[0]),new Date(a[1])],this.updateValue(),this.setDate()}else!Object(l.X)(e.value)&&e.value.length>0||!Object(l.X)(e.value)&&e.value.start?(this.valueType=e.value,null===e.value[0]||null===e.value.start?1===e.value.length||e.value.start?this.clearModelvalue(e,t):null!==e.value[1]&&null!==e.value.start||this.clearModelvalue(e,t):+this.initStartDate==+e.value[0]&&+this.initEndDate==+e.value[1]&&+this.initStartDate==+(e.value.start||+this.initEndDate!=+e.value.start)||((1===e.value.length||e.value.start)&&(this.modelValue=e.value),this.updateValue(),this.setDate())):(Object(l.X)(this.value)||null==e.value.start)&&(this.valueType=e.value,this.startValue=null,this.endValue=null,this.clearModelvalue(e,t));break;case"minDays":this.setProperties({minDays:e.minDays},!0),this.refreshChange(),this.setMinMaxDays();break;case"maxDays":this.setProperties({maxDays:e.maxDays},!0),this.refreshChange(),this.setMinMaxDays();break;case"min":this.setProperties({min:this.checkDateValue(new Date(this.checkValue(e.min)))},!0),this.previousEleValue=this.inputElement.value,this.enableInput(),this.refreshChange();break;case"max":this.setProperties({max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.enableInput(),this.refreshChange();break;case"strictMode":this.invalidValueString=null,this.setProperties({strictMode:e.strictMode},!0),this.refreshChange();break;case"presets":this.setProperties({presets:e.presets},!0),this.processPresets();break;case"floatLabelType":this.floatLabelType=e.floatLabelType,u.c.removeFloating(this.inputWrapper),u.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"start":this.setProperties({start:e.start},!0),this.refreshChange();break;case"depth":this.setProperties({depth:e.depth},!0),this.refreshChange()}}}}]),r}(S);return I([Object(l.s)(null)],e.prototype,"value",void 0),I([Object(l.s)(!1)],e.prototype,"enablePersistence",void 0),I([Object(l.s)(new Date(1900,0,1))],e.prototype,"min",void 0),I([Object(l.s)(new Date(2099,11,31))],e.prototype,"max",void 0),I([Object(l.s)(null)],e.prototype,"locale",void 0),I([Object(l.s)(null)],e.prototype,"firstDayOfWeek",void 0),I([Object(l.s)(!1)],e.prototype,"weekNumber",void 0),I([Object(l.s)("Gregorian")],e.prototype,"calendarMode",void 0),I([Object(l.s)(!1)],e.prototype,"openOnFocus",void 0),I([Object(l.k)()],e.prototype,"created",void 0),I([Object(l.k)()],e.prototype,"destroyed",void 0),I([Object(l.k)()],e.prototype,"change",void 0),I([Object(l.k)()],e.prototype,"cleared",void 0),I([Object(l.k)()],e.prototype,"navigated",void 0),I([Object(l.k)()],e.prototype,"renderDayCell",void 0),I([Object(l.s)(null)],e.prototype,"startDate",void 0),I([Object(l.s)(null)],e.prototype,"endDate",void 0),I([Object(l.f)([{}],Y)],e.prototype,"presets",void 0),I([Object(l.s)("")],e.prototype,"width",void 0),I([Object(l.s)(1e3)],e.prototype,"zIndex",void 0),I([Object(l.s)(!0)],e.prototype,"showClearButton",void 0),I([Object(l.s)(!0)],e.prototype,"showTodayButton",void 0),I([Object(l.s)("Month")],e.prototype,"start",void 0),I([Object(l.s)("Month")],e.prototype,"depth",void 0),I([Object(l.s)("")],e.prototype,"cssClass",void 0),I([Object(l.s)("-")],e.prototype,"separator",void 0),I([Object(l.s)(null)],e.prototype,"minDays",void 0),I([Object(l.s)(null)],e.prototype,"maxDays",void 0),I([Object(l.s)(!1)],e.prototype,"strictMode",void 0),I([Object(l.s)(null)],e.prototype,"keyConfigs",void 0),I([Object(l.s)(null)],e.prototype,"format",void 0),I([Object(l.s)(!0)],e.prototype,"enabled",void 0),I([Object(l.s)(!1)],e.prototype,"readonly",void 0),I([Object(l.s)(!0)],e.prototype,"allowEdit",void 0),I([Object(l.s)("Never")],e.prototype,"floatLabelType",void 0),I([Object(l.s)(null)],e.prototype,"placeholder",void 0),I([Object(l.s)({})],e.prototype,"htmlAttributes",void 0),I([Object(l.k)()],e.prototype,"open",void 0),I([Object(l.k)()],e.prototype,"close",void 0),I([Object(l.k)()],e.prototype,"select",void 0),I([Object(l.k)()],e.prototype,"focus",void 0),I([Object(l.k)()],e.prototype,"blur",void 0),e=I([l.q],e)}(),Q=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},J=(new Date).getDate(),Z=(new Date).getMonth(),$=(new Date).getFullYear(),ee="e-timepicker",te="e-input-focus",ie=["title","class","style"];!function(e){e.createListItems=function(e,t,i,n,r,s){var a,l,o=6e4*s,h=[],c=[];for(a=+t.setMilliseconds(0),l=+i.setMilliseconds(0);l>=a;)c.push(a),h.push(n.formatDate(new Date(a),{format:r,type:"time"})),a+=o;return{collection:c,list:g.a.createList(e,h,null,!0)}}}(a||(a={}));var ne=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).liCollections=[],n.timeCollections=[],n.blazorTimeCollections=[],n.disableItemCollection=[],n.invalidValueString=null,n.isBlazorServer=!1,n.isAngular=!1,n.preventChange=!1,n.timeOptions=e,n}return f(r,[{key:"preRender",value:function(){this.keyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.cloneElement=this.element.cloneNode(!0),Object(l.ib)([this.cloneElement],[ee,"e-control","e-lib"]),this.inputElement=this.element,this.angularTag=null,this.formElement=Object(l.C)(this.element,"form"),this.isBlazorServer=!(!Object(l.W)()||!this.isServerRendered||"timepicker"!==this.getModuleName()),this.isBlazorServer||("EJS-TIMEPICKER"===this.element.tagName&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.openPopupEventArgs={appendTo:document.body})}},{key:"render",value:function(){if(this.isBlazorServer){this.globalize=new l.n(this.locale),this.defaultCulture=new l.n("en"),this.checkTimeFormat();var e=this.element.parentElement;this.inputWrapper={container:e,clearButton:e.querySelector(".e-clear-icon"),buttons:[e.querySelector(".e-time-icon")]},u.c.bindInitialEvent({element:this.inputElement,floatLabelType:this.floatLabelType}),this.showClearButton&&this.inputWrapper.clearButton&&u.c.wireClearBtnEvents(this.inputElement,this.inputWrapper.clearButton,this.inputWrapper.container)}else this.initialize(),this.createInputElement(),this.updateHtmlAttributeToWrapper(),this.setTimeAllowEdit(),this.setEnable(),this.validateInterval();this.bindEvents(),this.isBlazorServer||(this.validateDisable(),this.setValue(this.getFormattedValue(this.value))),this.anchor=this.inputElement,this.inputElement.setAttribute("value",this.inputElement.value),this.isBlazorServer||(this.inputEleValue=this.getDateObject(this.inputElement.value)),this.renderComplete()}},{key:"setTimeAllowEdit",value:function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Object(l.x)(this.inputElement,{readonly:""}),this.clearIconState()}},{key:"clearIconState",value:function(){this.allowEdit||!this.inputWrapper||this.readonly?this.inputWrapper&&Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):""===this.inputElement.value?Object(l.ib)([this.inputWrapper.container],["e-non-edit"]):Object(l.v)([this.inputWrapper.container],["e-non-edit"])}},{key:"validateDisable",value:function(){this.setMinMax(this.initMin,this.initMax),this.popupCreation(),this.popupObj.destroy(),this.popupWrapper=this.popupObj=null,isNaN(+this.value)||null===this.value||this.valueIsDisable(this.value)||(this.strictMode&&this.resetState(),this.initValue=null,this.initMax=this.getDateObject(this.initMax),this.initMin=this.getDateObject(this.initMin),this.timeCollections=this.liCollections=[],this.setMinMax(this.initMin,this.initMax))}},{key:"validationAttribute",value:function(e,t){var i=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");t.setAttribute("name",i),e.removeAttribute("name");for(var n=["required","aria-required","form"],r=0;r<n.length;r++)if(!Object(l.X)(e.getAttribute(n[r]))){var s=e.getAttribute(n[r]);t.setAttribute(n[r],s),e.removeAttribute(n[r])}}},{key:"initialize",value:function(){this.globalize=new l.n(this.locale),this.defaultCulture=new l.n("en"),this.checkTimeFormat(),this.checkInvalidValue(this.value),this.setProperties({value:this.checkDateValue(new Date(this.checkInValue(this.value)))},!0),this.setProperties({min:this.checkDateValue(new Date(this.checkInValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkInValue(this.max)))},!0),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(this.scrollTo)))},!0),null!==this.angularTag&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.checkAttributes(!1),this.l10n=new l.p("timepicker",{placeholder:this.placeholder},this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.initValue=this.checkDateValue(this.value),this.initMin=this.checkDateValue(this.min),this.initMax=this.checkDateValue(this.max),this.isNavigate=this.isPreventBlur=this.isTextSelected=!1,this.activeIndex=this.valueWithMinutes=this.prevDate=null,Object(l.X)(this.element.getAttribute("id"))?(this.element.id=Object(l.U)("ej2_timepicker"),null!==this.angularTag&&Object(l.x)(this.inputElement,{id:this.element.id+"_input"})):null!==this.angularTag&&(this.inputElement.id=this.element.getAttribute("id")+"_input"),Object(l.X)(this.inputElement.getAttribute("name"))&&Object(l.x)(this.inputElement,{name:this.element.id})}},{key:"checkTimeFormat",value:function(){this.formatString=this.format?"string"==typeof this.format?this.format:Object(l.X)(this.format.skeleton)||""===this.format.skeleton?this.globalize.getDatePattern({type:"time",skeleton:"short"}):this.globalize.getDatePattern({type:"time",skeleton:this.format.skeleton}):null}},{key:"checkDateValue",value:function(e){return!Object(l.X)(e)&&e instanceof Date&&!isNaN(+e)?e:null}},{key:"createInputElement",value:function(){var e=this.cssClass;Object(l.X)(this.cssClass)||""===this.cssClass||(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=u.c.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[" e-input-group-icon e-time-icon e-icons"]},this.createElement),this.inputWrapper.container.style.width=this.setWidth(this.width),Object(l.x)(this.inputElement,{"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"false","aria-invalid":"false"}),this.isNullOrEmpty(this.inputStyle)||u.c.addAttributes({style:this.inputStyle},this.inputElement),Object(l.v)([this.inputWrapper.container],"e-time-wrapper")}},{key:"getCldrDateTimeFormat",value:function(){var e=new l.n(this.locale).getDatePattern({skeleton:Object(l.W)()?"d":"yMd"});return this.isNullOrEmpty(this.formatString)?e+" "+this.CldrFormat("time"):this.formatString}},{key:"checkInvalidValue",value:function(e){var t=!1;if("object"!=typeof e&&!Object(l.X)(e)){var i=e;"string"==typeof i&&(i=i.trim());var n,r=null;if("number"==typeof e?i=e.toString():"string"==typeof e&&(/^[a-zA-Z0-9- ]*$/.test(e)||(r=this.setCurrentDate(this.getDateObject(e)),Object(l.X)(r)&&(r=this.checkDateValue(this.globalize.parseDate(i,{format:this.getCldrDateTimeFormat(),type:"datetime"})),Object(l.X)(r)&&(r=this.checkDateValue(this.globalize.parseDate(i,{format:this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"})))))),n=this.globalize.parseDate(i,{format:this.getCldrDateTimeFormat(),type:"datetime"}),r=!Object(l.X)(n)&&n instanceof Date&&!isNaN(+n)?n:null,Object(l.X)(r)&&i.replace(/\s/g,"").length){var s=null;s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/.test(i)&&!s.test(i)||/^[a-zA-Z0-9- ]*$/.test(e)||isNaN(+new Date(""+i))?t=!0:r=new Date(""+i)}t?(this.strictMode||(this.invalidValueString=i),this.setProperties({value:null},!0),this.initValue=null):(this.setProperties({value:r},!0),this.initValue=this.value)}}},{key:"CldrFormat",value:function(e){return"en"===this.locale||"en-US"===this.locale?Object(l.W)()?this.getBlazorCultureFormat("t"):Object(l.V)("timeFormats.short",Object(l.N)()):this.getCultureTimeObject(l.B,""+this.locale)}},{key:"destroy",value:function(){if(this.isBlazorServer)this.unBindEvents();else{this.hide(),this.unBindEvents();var e={"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"true","aria-invalid":"false"};this.inputElement&&(u.c.removeAttributes(e,this.inputElement),null===this.angularTag&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),Object(l.X)(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.enableElement([this.inputElement]),this.inputElement.classList.remove("e-input"),Object(l.X)(this.cloneElement.getAttribute("disabled"))&&u.c.setEnabled(!0,this.inputElement,this.floatLabelType)),this.inputWrapper.container&&Object(l.I)(this.inputWrapper.container),this.inputWrapper=this.popupWrapper=this.cloneElement=void 0,this.liCollections=this.timeCollections=this.disableItemCollection=[],Object(l.X)(this.rippleFn)||this.rippleFn(),i(o(r.prototype),"destroy",this).call(this),this.formElement&&l.l.remove(this.formElement,"reset",this.formResetHandler)}}},{key:"ensureInputAttribute",value:function(){for(var e=[],t=0;t<this.inputElement.attributes.length;t++)e[t]=this.inputElement.attributes[t].name;for(var i=0;i<e.length;i++)Object(l.X)(this.cloneElement.getAttribute(e[i]))?(this.inputElement.removeAttribute(e[i]),"value"===e[i].toLowerCase()&&(this.inputElement.value="")):(this.inputElement.setAttribute(e[i],this.cloneElement.getAttribute(e[i])),"value"===e[i].toLowerCase()&&(this.inputElement.value=this.cloneElement.getAttribute(e[i])))}},{key:"popupCreation",value:function(){this.isBlazorServer?(this.popupWrapper=this.inputWrapper.container.nextElementSibling,this.generateList()):(this.popupWrapper=this.createElement("div",{className:ee+" e-popup",attrs:{id:this.element.id+"_popup",style:"visibility:hidden"}}),Object(l.X)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),!Object(l.X)(this.step)&&this.step>0&&(this.generateList(),Object(l.w)([this.listWrapper],this.popupWrapper)),this.openPopupEventArgs.appendTo.appendChild(this.popupWrapper)),this.addSelection(),this.renderPopup(),Object(l.I)(this.popupWrapper)}},{key:"getPopupHeight",value:function(){var e=parseInt("240px",10),t=this.popupWrapper.getBoundingClientRect().height;return t>e?e:t}},{key:"generateList",value:function(){if(this.isBlazorServer?this.listWrapper=this.popupWrapper.querySelector(".e-content"):this.createListItems(),this.wireListEvents(),this.rippleFn=Object(l.kb)(this.listWrapper,{duration:300,selector:".e-list-item"}),this.liCollections=this.listWrapper.querySelectorAll(".e-list-item"),this.isBlazorServer){this.blazorTimeCollections=[];for(var e=0;e<this.liCollections.length;e++)this.blazorTimeCollections.push(this.liCollections[e].getAttribute("data-value"))}}},{key:"renderPopup",value:function(){var e=this;this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),this.popupObj=new h.c(this.popupWrapper,{width:this.setPopupWidth(this.width),zIndex:this.zIndex,targetType:"relative",position:l.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},collision:l.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},enableRtl:this.enableRtl,relateTo:l.d.isDevice?document.body:this.inputWrapper.container,offsetY:4,open:function(){e.popupWrapper.style.visibility="visible",Object(l.v)([e.inputWrapper.buttons[0]],"e-active")},close:function(){Object(l.ib)([e.inputWrapper.buttons[0]],"e-active"),e.unWireListEvents(),e.inputElement.setAttribute("aria-activedescendant","null"),e.isBlazorServer||(Object(l.hb)(e.popupObj.element),e.popupObj.destroy(),e.popupWrapper.innerHTML=""),e.listWrapper=e.popupWrapper=e.listTag=void 0},targetExitViewport:function(){l.d.isDevice||e.hide()}}),l.d.isDevice||(this.popupObj.collision={X:"none",Y:"flip"}),this.popupObj.element.style.maxHeight="240px"}},{key:"getFormattedValue",value:function(e){return Object(l.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{skeleton:Object(l.W)()?"t":"medium",type:"time"})}},{key:"getDateObject",value:function(e){if(!this.isNullOrEmpty(e)){var t=this.createDateObj(e),i=!this.isNullOrEmpty(this.initValue);if(this.checkDateValue(t)){var n=i?this.initValue.getDate():J,r=i?this.initValue.getMonth():Z,s=i?this.initValue.getFullYear():$;return new Date(s,r,n,t.getHours(),t.getMinutes(),t.getSeconds())}}return null}},{key:"updateHtmlAttributeToWrapper",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];if(ie.indexOf(i)>-1)if("class"===i){var n=this.htmlAttributes[i].replace(/\s+/g," ").trim();""!==n&&Object(l.v)([this.inputWrapper.container],n.split(" "))}else if("style"===i){var r=this.inputWrapper.container.getAttribute(i);r=Object(l.X)(r)?this.htmlAttributes[i]:r+this.htmlAttributes[i],this.inputWrapper.container.setAttribute(i,r)}else this.inputWrapper.container.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateHtmlAttributeToElement",value:function(){if(!Object(l.X)(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];ie.indexOf(i)<0&&this.inputElement.setAttribute(i,this.htmlAttributes[i])}}},{key:"updateCssClass",value:function(e,t){Object(l.X)(t)||(t=t.replace(/\s+/g," ").trim()),Object(l.X)(e)||(e=e.replace(/\s+/g," ").trim()),u.c.setCssClass(e,[this.inputWrapper.container],t),this.popupWrapper&&u.c.setCssClass(e,[this.popupWrapper],t)}},{key:"removeErrorClass",value:function(){Object(l.ib)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"false"})}},{key:"checkErrorState",value:function(e){var t=this.getDateObject(e);this.validateState(t)&&!this.invalidValueString?this.removeErrorClass():(Object(l.v)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":"true"}))}},{key:"validateInterval",value:function(){!Object(l.X)(this.step)&&this.step>0?this.enableElement([this.inputWrapper.buttons[0]]):this.disableTimeIcon()}},{key:"disableTimeIcon",value:function(){this.disableElement([this.inputWrapper.buttons[0]]),this.hide()}},{key:"disableElement",value:function(e){Object(l.v)(e,"e-disabled")}},{key:"enableElement",value:function(e){Object(l.ib)(e,"e-disabled")}},{key:"selectInputText",value:function(){this.inputElement.setSelectionRange(0,this.inputElement.value.length)}},{key:"setCursorToEnd",value:function(){this.inputElement.setSelectionRange(this.inputElement.value.length,this.inputElement.value.length)}},{key:"getMeridianText",value:function(){var e;if("en"===this.locale||"en-US"===this.locale)e=Object(l.V)(Object(l.W)()?"dayPeriods.wide":"dayPeriods.format.wide",Object(l.N)());else{var t=Object(l.W)()?".dates.dayPeriods.abbreviated":".dates.calendars.gregorian.dayPeriods.format.abbreviated",i=Object(l.W)()?"":"main.";e=Object(l.V)(i+""+this.locale+t,l.B)}return e}},{key:"getCursorSelection",value:function(){var e=this.inputElement,t=0,i=0;return isNaN(e.selectionStart)||(t=e.selectionStart,i=e.selectionEnd),{start:Math.abs(t),end:Math.abs(i)}}},{key:"getActiveElement",value:function(){return Object(l.X)(this.popupWrapper)?null:this.popupWrapper.querySelectorAll(".e-active")}},{key:"isNullOrEmpty",value:function(e){return!!(Object(l.X)(e)||"string"==typeof e&&""===e.trim())}},{key:"setWidth",value:function(e){return"number"==typeof e?Object(l.L)(e):"string"==typeof e?e.match(/px|%|em/)?e:Object(l.L)(e):"100%"}},{key:"setPopupWidth",value:function(e){return(e=this.setWidth(e)).indexOf("%")>-1&&(e=(this.containerStyle.width*parseFloat(e)/100).toString()+"px"),e}},{key:"setScrollPosition",value:function(){var e;this.getPopupHeight(),e=this.selectedElement,Object(l.X)(e)?this.popupWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)}},{key:"findScrollTop",value:function(e){var t=this.getPopupHeight(),i=e.nextElementSibling,n=i?i.offsetTop:e.offsetTop,r=e.getBoundingClientRect().height;this.popupWrapper.scrollTop=n+e.offsetTop>t?i?n-(t/2+r/2):n:0}},{key:"setScrollTo",value:function(){var e;if(Object(l.X)(this.popupWrapper))this.popupWrapper.scrollTop=0;else{var t=this.popupWrapper.querySelectorAll(".e-list-item");if(t.length){var i=this.isBlazorServer?new Date((new Date).toDateString()+" "+this.blazorTimeCollections[0]).setMilliseconds(0):this.timeCollections[0],n=this.isBlazorServer?new Date((new Date).toDateString()+" "+this.scrollTo.toLocaleTimeString()).setMilliseconds(0):this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=t[Math.round((n-i)/(6e4*this.step))]}}Object(l.X)(e)?this.popupWrapper.scrollTop=0:this.findScrollTop(e)}},{key:"getText",value:function(){return Object(l.X)(this.checkDateValue(this.value))?"":this.getValue(this.value)}},{key:"getValue",value:function(e){return Object(l.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})}},{key:"cldrDateFormat",value:function(){return"en"===this.locale||"en-US"===this.locale?Object(l.W)()?Object(l.V)("d",Object(l.V)(this.locale,l.y)):Object(l.V)("dateFormats.short",Object(l.N)()):this.getCultureDateObject(l.B,""+this.locale)}},{key:"getBlazorCultureFormat",value:function(e){return Object(l.V)(e,Object(l.V)(this.locale,l.y)).replace(/tt/,"a")}},{key:"cldrTimeFormat",value:function(){return this.isNullOrEmpty(this.formatString)?"en"===this.locale||"en-US"===this.locale?Object(l.W)()?this.getBlazorCultureFormat("t"):Object(l.V)("timeFormats.short",Object(l.N)()):this.getCultureTimeObject(l.B,""+this.locale):this.formatString}},{key:"dateToNumeric",value:function(){return"en"===this.locale||"en-US"===this.locale?Object(l.W)()?this.getBlazorCultureFormat("T"):Object(l.V)("timeFormats.medium",Object(l.N)()):Object(l.W)()?this.getBlazorCultureFormat("T"):Object(l.V)("main."+this.locale+".dates.calendars.gregorian.timeFormats.medium",l.B)}},{key:"getExactDateTime",value:function(e){return Object(l.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.dateToNumeric(),type:"time"})}},{key:"setValue",value:function(e){var t=this.checkValue(e);this.strictMode||this.validateState(t)?this.isNullOrEmpty(t)?(this.initValue=null,this.validateMinMax(this.value,this.min,this.max)):this.initValue=this.compareFormatChange(t):(null===this.checkDateValue(this.valueWithMinutes)&&(this.initValue=this.valueWithMinutes=null),this.validateMinMax(this.value,this.min,this.max)),this.updateInput(!0,this.initValue)}},{key:"compareFormatChange",value:function(e){return Object(l.X)(e)?null:e!==this.getText()?this.getDateObject(e):this.getDateObject(this.value)}},{key:"updatePlaceHolder",value:function(){u.c.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)}},{key:"updateInputValue",value:function(e){u.c.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)}},{key:"preventEventBubbling",value:function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnTimeIconClick")}},{key:"updateBlazorTimeCollections",value:function(e){this.blazorTimeCollections=e}},{key:"popupHandler",value:function(e){this.enabled&&(l.d.isDevice&&this.inputElement.setAttribute("readonly",""),this.isBlazorServer||e.preventDefault(),this.isPopupOpen()&&!this.isBlazorServer?this.closePopup(0,e):(this.inputElement.focus(),this.show(e)))}},{key:"mouseDownHandler",value:function(){this.enabled&&!this.readonly&&(this.getCursorSelection(),this.inputElement.setSelectionRange(0,0),l.l.add(this.inputElement,"mouseup",this.mouseUpHandler,this))}},{key:"mouseUpHandler",value:function(e){if(!this.readonly){e.preventDefault(),l.l.remove(this.inputElement,"mouseup",this.mouseUpHandler);var t=this.getCursorSelection();0===t.start&&t.end===this.inputElement.value.length||(this.inputElement.value.length>0&&(this.cursorDetails=this.focusSelection()),this.inputElement.setSelectionRange(this.cursorDetails.start,this.cursorDetails.end))}}},{key:"focusSelection",value:function(){var e=new RegExp("^[a-zA-Z0-9]+$"),t=this.inputElement.value.split("");t.push(" ");var i=this.getCursorSelection(),n=0,r=0,s=!1;if(this.isTextSelected)n=i.start,r=i.end,this.isTextSelected=!1;else for(var a=0;a<t.length;a++)if(e.test(t[a])||(r=a,s=!0),s){if(i.start>=n&&i.end<=r){r=r,this.isTextSelected=!0;break}n=a+1,s=!1}return{start:n,end:r}}},{key:"inputHandler",value:function(e){if(!this.readonly&&this.enabled)switch("right"!==e.action&&"left"!==e.action&&"tab"!==e.action&&e.preventDefault(),e.action){case"home":case"end":case"up":case"down":this.keyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):(this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.updateValue(this.valueWithMinutes,e))):this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnStrictMode",this.inputElement.value):this.updateValue(this.inputElement.value,e),this.hide(),this.isNavigate=!1,this.isPopupOpen()&&e.stopPropagation();break;case"open":this.isBlazorServer?this.interopAdaptor.invokeMethodAsync("OnPopupHide",!0):this.show(e);break;case"escape":this.isBlazorServer||(this.updateInputValue(this.objToString(this.value)),this.previousState(this.value)),this.hide();break;case"close":this.hide();break;default:this.isNavigate=!1}}},{key:"onMouseClick",value:function(e){var t=e.target,i=this.selectedElement=Object(l.C)(t,".e-list-item");this.setSelection(i,e),i&&i.classList.contains("e-list-item")&&this.hide()}},{key:"closePopup",value:function(e,t){var i=this;if(this.isPopupOpen()&&this.popupWrapper){var n={popup:this.isBlazorServer?null:this.popupObj,event:t||null,cancel:!1,name:"open"};Object(l.ib)([document.body],"e-time-overflow"),this.trigger("close",n,(function(t){t.cancel||(i.popupObj.hide(new l.b({name:"FadeOut",duration:50,delay:e||0})),Object(l.ib)([i.inputWrapper.container],["e-icon-anim"]),Object(l.x)(i.inputElement,{"aria-expanded":"false"}),l.l.remove(document,"mousedown touchstart",i.documentClickHandler),i.isBlazorServer&&(i.disposeServerPopup(),i.inputWrapper.container.parentElement.insertBefore(i.popupWrapper,i.inputWrapper.container.nextElementSibling),i.interopAdaptor.invokeMethodAsync("OnPopupHide",!1),i.popupWrapper=i.popupObj=null)),l.d.isDevice&&i.modal&&(i.modal.style.display="none",i.modal.outerHTML="",i.modal=null),l.d.isDevice&&(Object(l.X)(i.mobileTimePopupWrap)||(i.mobileTimePopupWrap.remove(),i.mobileTimePopupWrap=null)),l.d.isDevice&&i.allowEdit&&!i.readonly&&i.inputElement.removeAttribute("readonly")}))}else l.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")}},{key:"disposeServerPopup",value:function(){this.popupWrapper&&(this.popupWrapper.style.visibility="hidden",this.popupWrapper.style.top="-9999px",this.popupWrapper.style.left="-9999px",this.popupWrapper.style.width="0px",this.popupWrapper.style.height="0px")}},{key:"checkValueChange",value:function(e,t){if(this.strictMode||this.validateState(this.valueWithMinutes))if(t){var i=this.getDateObject(new Date(this.timeCollections[this.activeIndex]));+this.prevDate!=+i&&this.valueProcess(e,i)}else(this.prevValue!==this.inputElement.value||Object(l.X)(this.checkDateValue(this.value)))&&this.valueProcess(e,this.compareFormatChange(this.inputElement.value));else null===this.checkDateValue(this.valueWithMinutes)&&(this.initValue=this.valueWithMinutes=null),this.setProperties({value:this.compareFormatChange(this.inputElement.value)},!0),this.initValue=this.valueWithMinutes=this.compareFormatChange(this.inputElement.value),this.prevValue=this.inputElement.value,+this.prevDate!=+this.value&&this.changeEvent(e)}},{key:"onMouseOver",value:function(e){var t=Object(l.C)(e.target,".e-list-item");this.setHover(t,"e-hover")}},{key:"setHover",value:function(e,t){this.enabled&&this.isValidLI(e)&&!e.classList.contains(t)&&(this.removeHover(t),Object(l.v)([e],t),"e-navigation"===t&&e.setAttribute("aria-selected","true"))}},{key:"setSelection",value:function(e,t){this.isValidLI(e)&&!e.classList.contains("e-active")&&(this.isBlazorServer?(this.selectedElement=e,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),Object(l.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.inputElement.setAttribute("value",e.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!1),this.addSelection()):(this.checkValue(e.getAttribute("data-value")),this.selectedElement=e,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Object(l.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.checkValueChange(t,!0)))}},{key:"onMouseLeave",value:function(){this.removeHover("e-hover")}},{key:"scrollHandler",value:function(){"timepicker"===this.getModuleName()&&l.d.isDevice||this.hide()}},{key:"setMinMax",value:function(e,t){Object(l.X)(this.checkDateValue(e))&&(this.initMin=this.getDateObject("12:00:00 AM")),Object(l.X)(this.checkDateValue(t))&&(this.initMax=this.getDateObject("11:59:59 PM"))}},{key:"validateMinMax",value:function(e,t,i){var n=e instanceof Date?e:this.getDateObject(e);return Object(l.X)(this.checkDateValue(n))?+this.createDateObj(this.getFormattedValue(this.initMin))>+this.createDateObj(this.getFormattedValue(this.initMax))&&this.disableTimeIcon():e=this.strictOperation(this.initMin,this.initMax,e,n),this.strictMode&&(e=this.valueIsDisable(e)?e:null),this.checkErrorState(e),e}},{key:"valueIsDisable",value:function(e){if(this.disableItemCollection.length>0){if(this.disableItemCollection.length===this.timeCollections.length)return!1;for(var t=e instanceof Date?this.objToString(e):e,i=0;i<this.disableItemCollection.length;i++)if(t===this.disableItemCollection[i])return!1}return!0}},{key:"validateState",value:function(e){if(!this.strictMode){if(!this.valueIsDisable(e))return!1;var t=this.setCurrentDate(this.getDateObject(e)),i=this.setCurrentDate(this.getDateObject(this.initMax)),n=this.setCurrentDate(this.getDateObject(this.initMin));if(Object(l.X)(this.checkDateValue(t))){if(+i<+n||""!==this.inputElement.value)return!1}else if(+t>+i||+t<+n)return!1}return!0}},{key:"strictOperation",value:function(e,t,i,n){var r=this.createDateObj(this.getFormattedValue(t)),s=this.createDateObj(this.getFormattedValue(e)),a=this.createDateObj(this.getFormattedValue(n));if(this.strictMode){if(+s>+r)return this.disableTimeIcon(),this.initValue=this.getDateObject(r),this.updateInputValue(this.getValue(this.initValue)),this.inputElement.value;if(+s>=+a)return this.getDateObject(s);if(+a>=+r||+s==+r)return this.getDateObject(r)}else if(+s>+r&&(this.disableTimeIcon(),!isNaN(+this.createDateObj(i))))return i;return i}},{key:"bindEvents",value:function(){l.l.add(this.inputWrapper.buttons[0],"mousedown",this.isBlazorServer?this.preventEventBubbling:this.popupHandler,this),l.l.add(this.inputElement,"blur",this.inputBlurHandler,this),l.l.add(this.inputElement,"focus",this.inputFocusHandler,this),l.l.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&l.l.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this),this.formElement&&l.l.add(this.formElement,"reset",this.formResetHandler,this),l.d.isDevice||(this.keyConfigure=Object(l.K)(this.keyConfigure,this.keyConfigs),this.inputEvent=new l.o(this.inputWrapper.container,{keyAction:this.inputHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.showClearButton&&this.inputElement&&l.l.add(this.inputElement,"mousedown",this.mouseDownHandler,this))}},{key:"formResetHandler",value:function(){if(this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value"),t=this.isBlazorServer?this.inputEleValue:this.checkDateValue(this.inputEleValue);"EJS-TIMEPICKER"===this.element.tagName&&(t=null,e="",this.inputElement.setAttribute("value","")),this.isBlazorServer||(this.setProperties({value:t},!0),this.prevDate=this.value,this.valueWithMinutes=this.value,this.initValue=this.value),this.inputElement&&(this.updateInputValue(e),this.isBlazorServer||this.checkErrorState(e),this.prevValue=this.inputElement.value)}}},{key:"inputChangeHandler",value:function(e){this.enabled&&e.stopPropagation()}},{key:"unBindEvents",value:function(){this.inputWrapper&&l.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.isBlazorServer?this.preventEventBubbling:this.popupHandler),l.l.remove(this.inputElement,"blur",this.inputBlurHandler),l.l.remove(this.inputElement,"focus",this.inputFocusHandler),l.l.remove(this.inputElement,"change",this.inputChangeHandler),this.inputEvent&&this.inputEvent.destroy(),l.l.remove(this.inputElement,"mousedown touchstart",this.mouseDownHandler),this.showClearButton&&!Object(l.X)(this.inputWrapper.clearButton)&&l.l.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.clearHandler),this.formElement&&l.l.remove(this.formElement,"reset",this.formResetHandler)}},{key:"bindClearEvent",value:function(){this.showClearButton&&this.inputWrapper.clearButton&&l.l.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this)}},{key:"raiseClearedEvent",value:function(e){this.trigger("cleared",{event:e})}},{key:"clearHandler",value:function(e){this.enabled&&(e.preventDefault(),Object(l.X)(this.value)?(this.resetState(),this.raiseClearedEvent(e)):this.clear(e),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnValueCleared"),this.popupWrapper&&(this.popupWrapper.scrollTop=0))}},{key:"clear",value:function(e){this.isBlazorServer||this.setProperties({value:null},!0),this.initValue=null,this.resetState(),this.raiseClearedEvent(e),this.isBlazorServer||this.changeEvent(e)}},{key:"setZIndex",value:function(){this.popupObj&&(this.popupObj.zIndex=this.zIndex,this.popupObj.dataBind())}},{key:"checkAttributes",value:function(e){var t,i,n=c(e?Object(l.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["step","disabled","readonly","style","name","value","min","max","placeholder"]);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!Object(l.X)(this.inputElement.getAttribute(r)))switch(r){case"disabled":if(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.enabled||e){var s="disabled"!==this.inputElement.getAttribute(r)&&""!==this.inputElement.getAttribute(r)&&"true"!==this.inputElement.getAttribute(r);this.setProperties({enabled:s},!e)}break;case"style":this.inputStyle=this.inputElement.getAttribute(r);break;case"readonly":if(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.readonly||e){var a="readonly"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({readonly:a},!e)}break;case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(r));break;case"step":this.step=parseInt(this.inputElement.getAttribute(r),10);break;case"placeholder":(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e);break;case"min":this.isBlazorServer||(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.min||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(l.X)(this.checkDateValue(t))||this.setProperties({min:t},!e));break;case"max":this.isBlazorServer||(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.max||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(l.X)(this.checkDateValue(t))||this.setProperties({max:t},!e));break;case"value":this.isBlazorServer||(Object(l.X)(this.timeOptions)||void 0===this.timeOptions.value||e)&&(t=new Date(this.inputElement.getAttribute(r)),Object(l.X)(this.checkDateValue(t))||(this.initValue=t,this.updateInput(!1,this.initValue),this.setProperties({value:t},!e)))}}}catch(o){n.e(o)}finally{n.f()}}},{key:"setCurrentDate",value:function(e){return Object(l.X)(this.checkDateValue(e))?null:new Date($,Z,J,e.getHours(),e.getMinutes(),e.getSeconds())}},{key:"getTextFormat",value:function(){var e=0;if("a"===this.cldrTimeFormat().split(" ")[0]||0===this.cldrTimeFormat().indexOf("a"))e=1;else if(this.cldrTimeFormat().indexOf("a")<0)for(var t=this.cldrTimeFormat().split(" "),i=0;i<t.length;i++)if(t[i].toLowerCase().indexOf("h")>=0){e=i;break}return e}},{key:"updateValue",value:function(e,t){var i;if(this.isNullOrEmpty(e))this.resetState();else if(i=this.checkValue(e),this.strictMode){var n=null===i&&e.trim().length>0?this.previousState(this.prevDate):this.inputElement.value;this.updateInputValue(n)}this.checkValueChange(t,"string"!=typeof e)}},{key:"previousState",value:function(e){for(var t=this.getDateObject(e),i=0;i<this.timeCollections.length;i++)if(+t===this.timeCollections[i]){this.activeIndex=i,this.selectedElement=this.liCollections[i],this.valueWithMinutes=new Date(this.timeCollections[i]);break}return this.prevValue}},{key:"resetState",value:function(){this.removeSelection(),u.c.setValue("",this.inputElement,this.floatLabelType,!1),this.valueWithMinutes=this.activeIndex=null,this.strictMode||this.isBlazorServer||this.checkErrorState(null)}},{key:"objToString",value:function(e){return Object(l.X)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})}},{key:"checkValue",value:function(e){if(!this.isNullOrEmpty(e)){var t=e instanceof Date?e:this.getDateObject(e);return this.validateValue(t,e)}return this.resetState(),this.valueWithMinutes=null}},{key:"validateValue",value:function(e,t){var i,n=this.validateMinMax(t,this.min,this.max),r=this.createDateObj(n);if(this.getFormattedValue(r)!==this.getFormattedValue(this.value)?(this.valueWithMinutes=Object(l.X)(r)?null:r,i=this.objToString(this.valueWithMinutes)):(this.strictMode&&(e=r),this.valueWithMinutes=this.checkDateValue(e),i=this.objToString(this.valueWithMinutes)),!this.strictMode&&Object(l.X)(i)){var s=n.trim().length>0?n:"";this.updateInputValue(s)}else this.updateInputValue(i);return i}},{key:"findNextElement",value:function(e){var t=this.inputElement.value,i=Object(l.X)(this.valueWithMinutes)||this.isBlazorServer?this.createDateObj(t):this.getDateObject(this.valueWithMinutes),n=null,r=this.liCollections.length,s=this.isBlazorServer?Object(l.X)(this.blazorTimeCollections)?[]:this.blazorTimeCollections:this.timeCollections;if(Object(l.X)(this.checkDateValue(i))&&Object(l.X)(this.activeIndex))this.selectNextItem(e);else{if("home"===e.action){var a=this.validLiElement(0);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[a]))),this.activeIndex=a}else if("end"===e.action){var o=this.validLiElement(s.length-1,!0);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[o]))),this.activeIndex=o}else if("down"===e.action)for(var h=0;h<r;h++){if(this.isBlazorServer?+i<+this.createDateObj(this.blazorTimeCollections[h]):+i<this.timeCollections[h]){var c=this.validLiElement(h);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[c]))),this.activeIndex=c;break}if(h===r-1){var u=this.validLiElement(0);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[u]))),this.activeIndex=u;break}}else for(var d=r-1;d>=0;d--){if(this.isBlazorServer?+i>+this.createDateObj(this.blazorTimeCollections[d]):+i>this.timeCollections[d]){var p=this.validLiElement(d,!0);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[p]))),this.activeIndex=p;break}if(0===d){var g=this.validLiElement(r-1);this.isBlazorServer||(n=+this.createDateObj(new Date(this.timeCollections[g]))),this.activeIndex=g;break}}this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):this.elementValue(Object(l.X)(n)?null:new Date(n))}}},{key:"selectNextItem",value:function(e){var t=this.validLiElement(0,"down"!==e.action);this.activeIndex=t,this.selectedElement=this.liCollections[t],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",t,!0)):this.elementValue(new Date(this.timeCollections[t]))}},{key:"findNextInBlazor",value:function(e){var t=Object(l.X)(this.blazorTimeCollections)?0:this.blazorTimeCollections.length,i=0,n=this.createDateObj(this.inputElement.value);switch(e.action){case"home":this.activeIndex=i;break;case"end":i=t-1,this.activeIndex=i;break;case"down":for(var r=0;r<t;r++){if(this.isBlazorServer?+n<+this.createDateObj(this.blazorTimeCollections[r]):+n<this.timeCollections[r]){var s=this.validLiElement(r);this.activeIndex=s;break}if(r===t-1){var a=this.validLiElement(0);this.activeIndex=a;break}}break;case"up":for(var o=t-1;o>=0;o--){if(this.isBlazorServer?+n>+this.createDateObj(this.blazorTimeCollections[o]):+n>this.timeCollections[o]){var h=this.validLiElement(o,!0);this.activeIndex=h;break}if(0===o){var c=this.validLiElement(t-1);this.activeIndex=c;break}}}this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)}},{key:"elementValue",value:function(e){Object(l.X)(this.checkDateValue(e))||this.checkValue(e)}},{key:"validLiElement",value:function(e,t){var i=null;if(this.isBlazorServer&&Object(l.X)(this.popupWrapper)){var n=this.blazorTimeCollections;if(n.length)if(t)for(var r=e;r>=0;r--){i=r;break}else for(var s=e;s<=n.length-1;s++){i=s;break}}else{var a=Object(l.X)(this.popupWrapper)?this.liCollections:this.popupWrapper.querySelectorAll(".e-list-item"),o=!0;if(a.length)if(t)for(var h=e;h>=0;h--){if(!a[h].classList.contains("e-disabled")){i=h;break}0===h&&o&&(e=h=a.length,o=!1)}else for(var c=e;c<=a.length-1;c++){if(!a[c].classList.contains("e-disabled")){i=c;break}c===a.length-1&&o&&(e=c=-1,o=!1)}}return i}},{key:"keyHandler",value:function(e){if(!(Object(l.X)(this.step)||this.step<=0||this.inputWrapper.buttons[0].classList.contains("e-disabled"))){var t=this.isBlazorServer?Object(l.X)(this.blazorTimeCollections)?0:this.blazorTimeCollections.length:this.timeCollections.length;if(Object(l.X)(this.getActiveElement())||0===this.getActiveElement().length)if(Object(l.X)(this.popupObj)&&this.isBlazorServer)if(Object(l.X)(this.activeIndex)){var i=this.validLiElement(0,"down"!==e.action);this.activeIndex=i,this.interopAdaptor.invokeMethodAsync("OnListItemClick",i,!0)}else this.findNextInBlazor(e);else this.liCollections.length>0&&(this.isBlazorServer||Object(l.X)(this.value))&&Object(l.X)(this.activeIndex)?this.selectNextItem(e):this.findNextElement(e);else{var n;if(e.keyCode>=37&&e.keyCode<=40){var r=40===e.keyCode||39===e.keyCode?++this.activeIndex:--this.activeIndex;this.activeIndex=this.activeIndex===t?0:this.activeIndex,this.activeIndex=this.activeIndex<0?t-1:this.activeIndex,this.activeIndex=r=this.validLiElement(this.activeIndex,40!==e.keyCode&&39!==e.keyCode),this.isBlazorServer||(n=Object(l.X)(this.timeCollections[r])?this.timeCollections[0]:this.timeCollections[r])}else if("home"===e.action){var s=this.validLiElement(0);this.activeIndex=s,this.isBlazorServer||(n=this.timeCollections[s])}else if("end"===e.action){var a=this.validLiElement(t-1,!0);this.activeIndex=a,this.isBlazorServer||(n=this.timeCollections[a])}this.selectedElement=this.liCollections[this.activeIndex],this.isBlazorServer?(this.inputElement.setAttribute("value",this.selectedElement.getAttribute("data-value")),this.interopAdaptor.invokeMethodAsync("OnListItemClick",this.activeIndex,!0)):this.elementValue(new Date(n))}this.isNavigate=!0,this.setHover(this.selectedElement,"e-navigation"),this.setActiveDescendant(),this.isBlazorServer||this.selectInputText(),!this.isPopupOpen()||null===this.selectedElement||e&&"click"===e.type||this.setScrollPosition()}}},{key:"getCultureTimeObject",value:function(e,t){return Object(l.W)()?Object(l.V)("t",Object(l.V)(t,l.y)).replace(/tt/,"a"):Object(l.V)("main."+t+".dates.calendars.gregorian.timeFormats.short",e)}},{key:"getCultureDateObject",value:function(e,t){return Object(l.W)()?Object(l.V)("d",Object(l.V)(t,l.y)):Object(l.V)("main."+t+".dates.calendars.gregorian.dateFormats.short",e)}},{key:"wireListEvents",value:function(){l.l.add(this.listWrapper,"click",this.onMouseClick,this),l.d.isDevice||(l.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),l.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this))}},{key:"unWireListEvents",value:function(){this.listWrapper&&(l.l.remove(this.listWrapper,"click",this.onMouseClick),l.d.isDevice||(l.l.remove(this.listWrapper,"mouseover",this.onMouseOver),l.l.remove(this.listWrapper,"mouseout",this.onMouseLeave)))}},{key:"valueProcess",value:function(e,t){var i=Object(l.X)(this.checkDateValue(t))?null:t;+this.prevDate!=+i&&(this.initValue=i,this.changeEvent(e))}},{key:"changeEvent",value:function(e){this.addSelection(),this.updateInput(!0,this.initValue);var t={event:e||null,value:this.value,text:this.inputElement.value,isInteracted:!Object(l.X)(e),element:this.element};t.value=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.prevDate=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",t),this.invalidValueString=null,this.checkErrorState(this.value)}},{key:"updateInput",value:function(e,t){e&&(this.prevValue=this.getValue(t)),this.prevDate=this.valueWithMinutes=t,"number"==typeof t&&(this.value&&+new Date(+this.value).setMilliseconds(0))===+t||this.setProperties({value:t},!0),!this.strictMode&&Object(l.X)(this.value)&&this.invalidValueString&&(this.checkErrorState(this.invalidValueString),this.updateInputValue(this.invalidValueString)),this.clearIconState()}},{key:"setActiveDescendant",value:function(){Object(l.X)(this.selectedElement)?Object(l.x)(this.inputElement,{"aria-activedescendant":"null"}):Object(l.x)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})}},{key:"removeSelection",value:function(){if(this.removeHover("e-hover"),!Object(l.X)(this.popupWrapper)){var e=this.popupWrapper.querySelectorAll(".e-active");e.length&&(Object(l.ib)(e,"e-active"),e[0].removeAttribute("aria-selected"))}}},{key:"removeHover",value:function(e){var t=this.getHoverItem(e);t&&t.length&&(Object(l.ib)(t,e),"e-navigation"===e&&t[0].removeAttribute("aria-selected"))}},{key:"getHoverItem",value:function(e){var t;return Object(l.X)(this.popupWrapper)||(t=this.popupWrapper.querySelectorAll("."+e)),t}},{key:"setActiveClass",value:function(){if(!Object(l.X)(this.popupWrapper)){var e=this.popupWrapper.querySelectorAll(".e-list-item");if(e.length)for(var t=0;t<e.length;t++)if(!this.isBlazorServer&&this.timeCollections[t]===+this.getDateObject(this.valueWithMinutes)||this.isBlazorServer&&this.blazorTimeCollections[t]===this.blazorTimeCollections[this.activeIndex]){e[t].setAttribute("aria-selected","true"),this.selectedElement=e[t],this.activeIndex=t;break}}}},{key:"addSelection",value:function(){this.selectedElement=null,this.removeSelection(),this.setActiveClass(),Object(l.X)(this.selectedElement)||(Object(l.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"))}},{key:"isValidLI",value:function(e){return e&&e.classList.contains("e-list-item")&&!e.classList.contains("e-disabled")}},{key:"createDateObj",value:function(e){var t=Object(l.W)()?"M"+Object(l.N)().dateSeperator+"d"+Object(l.N)().dateSeperator+"yy":null,i=this.globalize.formatDate(new Date,{format:t,skeleton:"short",type:"date"}),n=null;return"string"==typeof e?e.toUpperCase().indexOf("AM")>-1||e.toUpperCase().indexOf("PM")>-1?(i=this.defaultCulture.formatDate(new Date,{format:t,skeleton:"short",type:"date"}),n=isNaN(+new Date(i+" "+e))?null:new Date(new Date(i+" "+e).setMilliseconds(0)),Object(l.X)(n)&&(n=this.TimeParse(i,e))):n=this.TimeParse(i,e):e instanceof Date&&(n=e),n}},{key:"TimeParse",value:function(e,t){var i;return i=this.globalize.parseDate(e+" "+t,{format:this.cldrDateFormat()+" "+this.cldrTimeFormat(),type:"datetime"}),i=Object(l.X)(i)?this.globalize.parseDate(e+" "+t,{format:this.cldrDateFormat()+" "+this.dateToNumeric(),type:"datetime"}):i,i=Object(l.X)(i)?i:new Date(i.setMilliseconds(0))}},{key:"createListItems",value:function(){var e,t,i=this;this.listWrapper=this.createElement("div",{className:"e-content",attrs:{tabindex:"0"}});var n=6e4*this.step,r=[];for(this.timeCollections=[],this.disableItemCollection=[],e=+this.getDateObject(this.initMin).setMilliseconds(0),t=+this.getDateObject(this.initMax).setMilliseconds(0);t>=e;)this.timeCollections.push(e),r.push(this.globalize.formatDate(new Date(e),{format:this.cldrTimeFormat(),type:"time"})),e+=n;this.listTag=g.a.createList(this.createElement,r,{itemCreated:function(e){var t={element:e.item,text:e.text,value:i.getDateObject(e.text),isDisabled:!1};i.trigger("itemRender",t,(function(e){e.isDisabled&&e.element.classList.add("e-disabled"),e.element.classList.contains("e-disabled")&&i.disableItemCollection.push(e.element.getAttribute("data-value"))}))}},!0),Object(l.x)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),Object(l.w)([this.listTag],this.listWrapper)}},{key:"documentClickHandler",value:function(e){var t=e.target;!Object(l.X)(this.popupObj)&&(this.inputWrapper.container.contains(t)||this.popupObj.element&&this.popupObj.element.contains(t))&&"touchstart"!==e.type&&e.preventDefault(),Object(l.C)(t,'[id="'+this.popupObj.element.id+'"]')||t===this.inputElement||t===(this.inputWrapper&&this.inputWrapper.buttons[0])||t===(this.inputWrapper&&this.inputWrapper.clearButton)||t===(this.inputWrapper&&this.inputWrapper.container)?t!==this.inputElement&&(l.d.isDevice||(this.isPreventBlur=(l.d.isIE||"edge"===l.d.info.name)&&document.activeElement===this.inputElement&&t===this.popupWrapper)):this.isPopupOpen()&&(this.hide(),this.focusOut())}},{key:"setEnableRtl",value:function(){u.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())}},{key:"setEnable",value:function(){u.c.setEnabled(this.enabled,this.inputElement,this.floatLabelType),this.enabled?(Object(l.ib)([this.inputWrapper.container],"e-disabled"),Object(l.x)(this.inputElement,{"aria-disabled":"false"}),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.hide(),Object(l.v)([this.inputWrapper.container],"e-disabled"),Object(l.x)(this.inputElement,{"aria-disabled":"true"}),this.inputElement.tabIndex=-1)}},{key:"getProperty",value:function(e,t){"min"===t?(this.initMin=this.checkDateValue(new Date(this.checkInValue(e.min))),this.setProperties({min:this.initMin},!0)):(this.initMax=this.checkDateValue(new Date(this.checkInValue(e.max))),this.setProperties({max:this.initMax},!0)),""===this.inputElement.value?this.validateMinMax(this.value,this.min,this.max):this.checkValue(this.inputElement.value),this.checkValueChange(null,!1)}},{key:"inputBlurHandler",value:function(e){this.enabled&&(this.isPreventBlur&&this.isPopupOpen()?this.inputElement.focus():(this.closePopup(0,e),Object(l.ib)([this.inputWrapper.container],[te]),this.trigger("blur",{model:this.isBlazorServer?null:this}),this.isBlazorServer||this.getText()===this.inputElement.value?0===this.inputElement.value.trim().length&&this.resetState():this.updateValue(this.inputElement.value,e),this.isBlazorServer&&this.interopAdaptor.invokeMethodAsync("OnStrictMode",this.inputElement.value),this.cursorDetails=null,this.isNavigate=!1,""===this.inputElement.value&&(this.invalidValueString=null)))}},{key:"focusOut",value:function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),Object(l.ib)([this.inputWrapper.container],[te]),this.trigger("blur",{model:this.isBlazorServer?null:this}))}},{key:"isPopupOpen",value:function(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains(""+ee))}},{key:"inputFocusHandler",value:function(){if(this.enabled){var e={model:this.isBlazorServer?null:this};this.readonly||l.d.isDevice||this.selectInputText(),this.trigger("focus",e),this.clearIconState(),this.openOnFocus&&this.show()}}},{key:"focusIn",value:function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()}},{key:"hide",value:function(){this.closePopup(100,null),this.clearIconState()}},{key:"show",value:function(e){var t=this;this.enabled&&this.readonly||!this.enabled||this.popupWrapper||(this.popupCreation(),l.d.isDevice&&this.listWrapper&&(this.modal=this.createElement("div"),this.modal.className=ee+" e-time-modal",document.body.className+=" e-time-overflow",document.body.appendChild(this.modal)),l.d.isDevice&&(this.mobileTimePopupWrap=this.createElement("div",{className:"e-timepicker-mob-popup-wrap"}),document.body.appendChild(this.mobileTimePopupWrap)),this.openPopupEventArgs={popup:this.isBlazorServer?null:this.popupObj||null,cancel:!1,event:e||null,name:"open",appendTo:l.d.isDevice?this.mobileTimePopupWrap:document.body},this.trigger("open",this.openPopupEventArgs,(function(e){if(Object(l.W)()&&t.isServerRendered&&(e.popup=t.popupObj||null),t.openPopupEventArgs=e,t.openPopupEventArgs.cancel||t.inputWrapper.buttons[0].classList.contains("e-disabled"))t.popupObj.destroy(),t.isBlazorServer&&(t.disposeServerPopup(),t.inputWrapper.container.parentElement.insertBefore(t.popupWrapper,t.inputWrapper.container.nextElementSibling),t.interopAdaptor.invokeMethodAsync("OnPopupHide",!1)),t.popupWrapper=t.listTag=void 0,t.liCollections=t.timeCollections=t.disableItemCollection=[],t.popupObj=null;else{t.isBlazorServer&&(t.popupWrapper.style.visibility="",t.popupWrapper.style.width=t.inputWrapper.container.offsetWidth+"px",t.popupWrapper.style.height="auto"),t.isBlazorServer&&(t.openPopupEventArgs.popup=t.popupObj),t.openPopupEventArgs.appendTo.appendChild(t.popupWrapper),t.popupAlignment(t.openPopupEventArgs),t.setScrollPosition(),l.d.isDevice||t.inputElement.focus();t.popupObj.refreshPosition(t.anchor),t.popupObj.show(new l.b({name:"FadeIn",duration:50}),1e3===t.zIndex?t.element:null),t.setActiveDescendant(),Object(l.x)(t.inputElement,{"aria-expanded":"true"}),Object(l.v)([t.inputWrapper.container],te),l.l.add(document,"mousedown touchstart",t.documentClickHandler,t),t.setOverlayIndex(t.mobileTimePopupWrap,t.popupObj.element,t.modal,l.d.isDevice)}})))}},{key:"setOverlayIndex",value:function(e,t,i,n){if(n&&!Object(l.X)(t)&&!Object(l.X)(i)&&!Object(l.X)(e)){var r=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(r-1).toString(),e.style.zIndex=r.toString()}}},{key:"formatValues",value:function(e){var t;return"number"==typeof e?t=Object(l.L)(e):"string"==typeof e&&(t=e.match(/px|%|em/)||isNaN(parseInt(e,10))?e:Object(l.L)(e)),t}},{key:"popupAlignment",value:function(e){if(e.popup.position.X=this.formatValues(e.popup.position.X),e.popup.position.Y=this.formatValues(e.popup.position.Y),isNaN(parseFloat(e.popup.position.X))&&isNaN(parseFloat(e.popup.position.Y))||(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.targetType="container"),isNaN(parseFloat(e.popup.position.X))||(this.popupObj.offsetX=parseFloat(e.popup.position.X)),isNaN(parseFloat(e.popup.position.Y))||(this.popupObj.offsetY=parseFloat(e.popup.position.Y)),l.d.isDevice)"center"===e.popup.position.X&&"center"===e.popup.position.Y&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.offsetY=0,this.popupObj.targetType="container",this.popupObj.collision={X:"fit",Y:"fit"});else{switch(e.popup.position.X){case"left":break;case"right":e.popup.offsetX=this.containerStyle.width;break;case"center":e.popup.offsetX=-this.containerStyle.width/2}switch(e.popup.position.Y){case"top":case"bottom":break;case"center":e.popup.offsetY=-this.containerStyle.height/2}"center"===e.popup.position.X&&"center"===e.popup.position.Y&&(this.popupObj.relateTo=this.inputWrapper.container,this.anchor=this.inputElement,this.popupObj.targetType="relative")}}},{key:"getPersistData",value:function(){return this.addOnPersist(["value"])}},{key:"getModuleName",value:function(){return"timepicker"}},{key:"onPropertyChanged",value:function(e,t){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];switch(r){case"placeholder":u.c.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"readonly":u.c.setReadonly(this.readonly,this.inputElement,this.floatLabelType),this.readonly&&this.hide(),this.setTimeAllowEdit();break;case"enabled":this.setProperties({enabled:e.enabled},!0),this.setEnable();break;case"allowEdit":this.setTimeAllowEdit();break;case"enableRtl":this.isBlazorServer||(this.setProperties({enableRtl:e.enableRtl},!0),this.setEnableRtl());break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"min":case"max":this.isBlazorServer||this.getProperty(e,r);break;case"showClearButton":u.c.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"locale":this.setProperties({locale:e.locale},!0),this.globalize=new l.n(this.locale),this.l10n.setLocale(this.locale),this.updatePlaceHolder(),this.isBlazorServer||this.setValue(this.value);break;case"width":Object(l.ob)(this.inputWrapper.container,{width:this.setWidth(e.width)}),this.containerStyle=this.inputWrapper.container.getBoundingClientRect();break;case"format":this.setProperties({format:e.format},!0),this.checkTimeFormat(),this.isBlazorServer||this.setValue(this.value);break;case"value":this.isBlazorServer||(this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.invalidValueString?(this.updateInputValue(this.invalidValueString),this.checkErrorState(this.invalidValueString)):("string"==typeof e.value?(this.setProperties({value:this.checkDateValue(new Date(e.value))},!0),e.value=this.value):(e.value&&+new Date(+e.value).setMilliseconds(0))!==+this.value&&(e.value=this.checkDateValue(new Date(""+e.value))),this.initValue=e.value,e.value=this.compareFormatChange(this.checkValue(e.value))),this.checkValueChange(null,!1),this.isAngular&&this.preventChange&&(this.preventChange=!1));break;case"floatLabelType":this.floatLabelType=e.floatLabelType,u.c.removeFloating(this.inputWrapper),u.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"strictMode":this.isBlazorServer||(this.invalidValueString=null,e.strictMode&&this.checkErrorState(null),this.setProperties({strictMode:e.strictMode},!0),this.checkValue(this.inputElement.value),this.checkValueChange(null,!1));break;case"scrollTo":this.isBlazorServer?this.popupWrapper&&this.setScrollTo():this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))?(this.popupWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0)}}}},{key:"checkInValue",value:function(e){return e instanceof Date?e.toUTCString():""+e}}]),r}(l.h);return Q([Object(l.s)(null)],e.prototype,"width",void 0),Q([Object(l.s)(null)],e.prototype,"cssClass",void 0),Q([Object(l.s)(!1)],e.prototype,"strictMode",void 0),Q([Object(l.s)(null)],e.prototype,"keyConfigs",void 0),Q([Object(l.s)(null)],e.prototype,"format",void 0),Q([Object(l.s)(!0)],e.prototype,"enabled",void 0),Q([Object(l.s)(!1)],e.prototype,"readonly",void 0),Q([Object(l.s)({})],e.prototype,"htmlAttributes",void 0),Q([Object(l.s)("Never")],e.prototype,"floatLabelType",void 0),Q([Object(l.s)(null)],e.prototype,"placeholder",void 0),Q([Object(l.s)(1e3)],e.prototype,"zIndex",void 0),Q([Object(l.s)(!1)],e.prototype,"enablePersistence",void 0),Q([Object(l.s)(!0)],e.prototype,"showClearButton",void 0),Q([Object(l.s)(30)],e.prototype,"step",void 0),Q([Object(l.s)(null)],e.prototype,"scrollTo",void 0),Q([Object(l.s)(null)],e.prototype,"value",void 0),Q([Object(l.s)(null)],e.prototype,"min",void 0),Q([Object(l.s)(null)],e.prototype,"max",void 0),Q([Object(l.s)(!0)],e.prototype,"allowEdit",void 0),Q([Object(l.s)(!1)],e.prototype,"openOnFocus",void 0),Q([Object(l.k)()],e.prototype,"change",void 0),Q([Object(l.k)()],e.prototype,"created",void 0),Q([Object(l.k)()],e.prototype,"destroyed",void 0),Q([Object(l.k)()],e.prototype,"open",void 0),Q([Object(l.k)()],e.prototype,"itemRender",void 0),Q([Object(l.k)()],e.prototype,"close",void 0),Q([Object(l.k)()],e.prototype,"cleared",void 0),Q([Object(l.k)()],e.prototype,"blur",void 0),Q([Object(l.k)()],e.prototype,"focus",void 0),e=Q([l.q],e)}(),re=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},se=(new Date).getDate(),ae=(new Date).getMonth(),le=(new Date).getFullYear(),oe=(new Date).getHours(),he=(new Date).getMinutes(),ce=(new Date).getSeconds(),ue=(new Date).getMilliseconds(),de="e-datetimepicker",pe=function(){var e=function(e){n(r,e);var t=s(r);function r(e,i){var n;return p(this,r),(n=t.call(this,e,i)).valueWithMinutes=null,n.scrollInvoked=!1,n.dateTimeOptions=e,n}return f(r,[{key:"focusHandler",value:function(){this.enabled&&Object(l.v)([this.inputWrapper.container],"e-input-focus")}},{key:"focusIn",value:function(){i(o(r.prototype),"focusIn",this).call(this)}},{key:"focusOut",value:function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),Object(l.ib)([this.inputWrapper.container],["e-input-focus"]))}},{key:"blurHandler",value:function(e){if(this.enabled)if(this.isTimePopupOpen()&&this.isPreventBlur)this.inputElement.focus();else{Object(l.ib)([this.inputWrapper.container],"e-input-focus");var t={model:Object(l.W)()&&this.isServerRendered?null:this};this.isTimePopupOpen()&&this.hide(e),this.trigger("blur",t)}}},{key:"destroy",value:function(){this.popupObject&&this.popupObject.element.classList.contains("e-popup")&&(this.popupObject.destroy(),Object(l.I)(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],Object(l.X)(this.rippleFn)||this.rippleFn()),this.inputElement&&(u.c.removeAttributes({"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false","aria-haspopup":"true","aria-activedescendant":"null",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off"},this.inputElement),this.inputElement.removeAttribute("aria-placeholder")),this.isCalendar()&&(this.popupWrapper&&Object(l.I)(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),i(o(r.prototype),"destroy",this).call(this)}},{key:"render",value:function(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,i(o(r.prototype),"updateHtmlAttributeToElement",this).call(this),this.checkAttributes(!1),this.l10n=new l.p("datetimepicker",{placeholder:this.placeholder},this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),i(o(r.prototype),"render",this).call(this),this.createInputElement(),i(o(r.prototype),"updateHtmlAttributeToWrapper",this).call(this),this.bindInputEvents(),this.setValue(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),"EJS-DATETIMEPICKER"===this.element.tagName&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.renderComplete()}},{key:"setValue",value:function(){if(this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){var e=this.validateMinMaxRange(this.initValue);u.c.setValue(this.getFormattedValue(e),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:e},!0)}else Object(l.X)(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,i(o(r.prototype),"updateInput",this).call(this)}},{key:"validateMinMaxRange",value:function(e){var t=e;return this.isDateObject(e)?t=this.validateValue(e):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(t),t}},{key:"checkValidState",value:function(e){this.isValidState=!0,this.strictMode||(+e>+this.max||+e<+this.min)&&(this.isValidState=!1),this.checkErrorState()}},{key:"checkErrorState",value:function(){this.isValidState?Object(l.ib)([this.inputWrapper.container],"e-error"):Object(l.v)([this.inputWrapper.container],"e-error"),Object(l.x)(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})}},{key:"validateValue",value:function(e){var t=e;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),t=this.max):+e<+this.min?t=this.min:+e>+this.max&&(t=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),t=e),t}},{key:"disablePopupButton",value:function(e){e?(Object(l.v)([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled"),this.hide()):Object(l.ib)([this.inputWrapper.buttons[0],this.timeIcon],"e-disabled")}},{key:"getFormattedValue",value:function(e){var t;return Object(l.X)(e)?null:(t="Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(e,t))}},{key:"isDateObject",value:function(e){return!Object(l.X)(e)&&!isNaN(+e)}},{key:"createInputElement",value:function(){Object(l.ib)([this.inputElement],"e-datepicker"),Object(l.ib)([this.inputWrapper.container],"e-date-wrapper"),Object(l.v)([this.inputWrapper.container],"e-datetime-wrapper"),Object(l.v)([this.inputElement],de),this.renderTimeIcon()}},{key:"renderTimeIcon",value:function(){this.timeIcon=u.c.appendSpan("e-input-group-icon e-time-icon e-icons",this.inputWrapper.container)}},{key:"bindInputEvents",value:function(){l.l.add(this.timeIcon,"mousedown",this.timeHandler,this),l.l.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),l.l.add(this.inputElement,"blur",this.blurHandler,this),l.l.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=Object(l.K)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new l.o(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})}},{key:"unBindInputEvents",value:function(){l.l.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),l.l.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(l.l.remove(this.inputElement,"blur",this.blurHandler),l.l.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()}},{key:"cldrTimeFormat",value:function(){return this.isNullOrEmpty(this.timeFormat)?"en"===this.locale||"en-US"===this.locale?Object(l.W)()?Object(l.V)("t",Object(l.V)(this.locale,l.y)).replace(/tt/,"a"):Object(l.V)("timeFormats.short",Object(l.N)()):this.getCultureTimeObject(l.B,""+this.locale):this.timeFormat}},{key:"cldrDateTimeFormat",value:function(){var e=new l.n(this.locale).getDatePattern({skeleton:Object(l.W)()?"d":"yMd"});return this.isNullOrEmpty(this.formatString)?e+" "+this.getCldrFormat("time"):this.formatString}},{key:"getCldrFormat",value:function(e){return"en"===this.locale||"en-US"===this.locale?Object(l.W)()?Object(l.V)("t",Object(l.V)(this.locale,l.y)).replace(/tt/,"a"):Object(l.V)("timeFormats.short",Object(l.N)()):this.getCultureTimeObject(l.B,""+this.locale)}},{key:"isNullOrEmpty",value:function(e){return!!(Object(l.X)(e)||"string"==typeof e&&""===e.trim())}},{key:"getCultureTimeObject",value:function(e,t){return"Gregorian"===this.calendarMode?Object(l.W)()?Object(l.V)("t",Object(l.V)(this.locale,l.y)).replace(/tt/,"a"):Object(l.V)("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",e):Object(l.V)("main."+this.locale+".dates.calendars.islamic.timeFormats.short",e)}},{key:"timeHandler",value:function(e){this.enabled&&(this.isIconClicked=!0,l.d.isDevice&&this.inputElement.setAttribute("readonly",""),e.currentTarget===this.timeIcon&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&i(o(r.prototype),"hide",this).call(this,e),this.isTimePopupOpen()?this.closePopup(e):(this.inputElement.focus(),this.popupCreation("time",e),Object(l.v)([this.inputWrapper.container],["e-input-focus"]))),this.isIconClicked=!1)}},{key:"dateHandler",value:function(e){this.enabled&&(e.currentTarget===this.inputWrapper.buttons[0]&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(e),Object(l.X)(this.popupWrapper)||this.popupCreation("date",e)))}},{key:"show",value:function(e,t){this.enabled&&this.readonly||!this.enabled||("time"!==e||this.dateTimeWrapper?this.popupObj||(this.isTimePopupOpen()&&this.hide(t),i(o(r.prototype),"show",this).call(this),this.popupCreation("date",t)):(this.isDatePopupOpen()&&this.hide(t),this.popupCreation("time",t)))}},{key:"toggle",value:function(e){this.isDatePopupOpen()?(i(o(r.prototype),"hide",this).call(this,e),this.show("time",null)):this.isTimePopupOpen()?(this.hide(e),i(o(r.prototype),"show",this).call(this,null,e),this.popupCreation("date",null)):this.show(null,e)}},{key:"listCreation",value:function(){var e;e=this.globalize.parseDate(this.inputElement.value,"Gregorian"===this.calendarMode?{format:this.cldrDateTimeFormat(),type:"datetime"}:{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});var t=Object(l.X)(this.value)?""!==this.inputElement.value?e:new Date:this.value;this.valueWithMinutes=t,this.listWrapper=Object(l.F)("div",{className:"e-content",attrs:{tabindex:"0"}});var i=this.startTime(t),n=this.endTime(t),r=a.createListItems(this.createElement,i,n,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=r.collection,this.listTag=r.list,Object(l.x)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),Object(l.w)([r.list],this.listWrapper),this.wireTimeListEvents(),this.rippleFn=Object(l.kb)(this.listWrapper,{duration:300,selector:".e-list-item"}),this.liCollections=this.listWrapper.querySelectorAll(".e-list-item")}},{key:"popupCreation",value:function(e,t){l.d.isDevice&&this.element.setAttribute("readonly","readonly"),"date"===e?!this.readonly&&this.popupWrapper&&(Object(l.v)([this.popupWrapper],"e-datetimepopup-wrapper"),Object(l.x)(this.popupWrapper,{id:this.element.id+"_datepopup"})):this.readonly||(this.dateTimeWrapper=Object(l.F)("div",{className:de+" e-popup",attrs:{id:this.element.id+"_timepopup",style:"visibility:hidden ; display:block"}}),Object(l.X)(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!Object(l.X)(this.step)&&this.step>0&&(this.listCreation(),Object(l.w)([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(t),this.popupObject.refreshPosition(this.inputElement))}},{key:"openPopup",value:function(e){var t=this;this.preventArgs={cancel:!1,popup:Object(l.W)()&&this.isServerRendered?null:this.popupObject,event:e||null},this.trigger("open",this.preventArgs,(function(e){t.preventArgs=e,t.preventArgs.cancel||t.readonly||(t.popupObject.show(new l.b({name:"FadeIn",duration:100}),1e3===t.zIndex?t.element:null),Object(l.v)([t.inputWrapper.container],["e-icon-anim"]),Object(l.x)(t.inputElement,{"aria-expanded":"true"}),l.l.add(document,"mousedown touchstart",t.documentClickHandler,t))}))}},{key:"documentClickHandler",value:function(e){var t=e.target;!Object(l.X)(this.popupObject)&&(this.inputWrapper.container.contains(t)||this.popupObject.element&&this.popupObject.element.contains(t))&&"touchstart"!==e.type&&e.preventDefault(),Object(l.C)(t,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))||t===this.inputElement||t===this.timeIcon||t===this.inputWrapper.container?t!==this.inputElement&&(l.d.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(l.d.isIE||"edge"===l.d.info.name)&&t===this.popupObject.element)):this.isTimePopupOpen()&&(this.hide(e),this.focusOut())}},{key:"isTimePopupOpen",value:function(){return!(!this.dateTimeWrapper||!this.dateTimeWrapper.classList.contains(""+de))}},{key:"isDatePopupOpen",value:function(){return!(!this.popupWrapper||!this.popupWrapper.classList.contains("e-datetimepopup-wrapper"))}},{key:"renderPopup",value:function(){var e=this;this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),l.d.isDevice&&(this.timeModal=Object(l.F)("div"),this.timeModal.className=de+" e-time-modal",document.body.className+=" e-time-overflow",this.timeModal.style.display="block",document.body.appendChild(this.timeModal)),this.popupObject=new h.c(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:l.d.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:l.d.isDevice?document.body:this.inputWrapper.container,position:l.d.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:4,open:function(){e.dateTimeWrapper.style.visibility="visible",Object(l.v)([e.timeIcon],"e-active"),l.d.isDevice||(e.timekeyConfigure=Object(l.K)(e.timekeyConfigure,e.keyConfigs),e.inputEvent=new l.o(e.inputWrapper.container,{keyAction:e.TimeKeyActionHandle.bind(e),keyConfigs:e.timekeyConfigure,eventName:"keydown"}))},close:function(){Object(l.ib)([e.timeIcon],"e-active"),e.unWireTimeListEvents(),e.inputElement.setAttribute("aria-activedescendant","null"),Object(l.hb)(e.popupObject.element),e.popupObject.destroy(),e.dateTimeWrapper.innerHTML="",e.listWrapper=e.dateTimeWrapper=void 0,e.inputEvent&&e.inputEvent.destroy()},targetExitViewport:function(){l.d.isDevice||e.hide()}}),this.popupObject.element.style.maxHeight="250px"}},{key:"setDimension",value:function(e){return"number"==typeof e?Object(l.L)(e):"string"==typeof e?e:"100%"}},{key:"setPopupWidth",value:function(){var e=this.setDimension(this.width);return e.indexOf("%")>-1&&(e=(this.containerStyle.width*parseFloat(e)/100).toString()+"px"),e}},{key:"wireTimeListEvents",value:function(){l.l.add(this.listWrapper,"click",this.onMouseClick,this),l.d.isDevice||(l.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),l.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this))}},{key:"unWireTimeListEvents",value:function(){this.listWrapper&&(l.l.remove(this.listWrapper,"click",this.onMouseClick),l.l.remove(document,"mousedown touchstart",this.documentClickHandler),l.d.isDevice||(l.l.add(this.listWrapper,"mouseover",this.onMouseOver,this),l.l.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))}},{key:"onMouseOver",value:function(e){var t=Object(l.C)(e.target,".e-list-item");this.setTimeHover(t,"e-hover")}},{key:"onMouseLeave",value:function(){this.removeTimeHover("e-hover")}},{key:"setTimeHover",value:function(e,t){this.enabled&&this.isValidLI(e)&&!e.classList.contains(t)&&(this.removeTimeHover(t),Object(l.v)([e],t))}},{key:"getPopupHeight",value:function(){var e=parseInt("250px",10),t=this.dateTimeWrapper.getBoundingClientRect().height;return t>e?e:t}},{key:"changeEvent",value:function(e){(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(i(o(r.prototype),"changeEvent",this).call(this,e),this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))}},{key:"updateValue",value:function(e){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:e||null,isInteracted:!Object(l.X)(e),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.value)}},{key:"setTimeScrollPosition",value:function(){var e;e=this.selectedElement,Object(l.X)(e)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)}},{key:"findScrollTop",value:function(e){var t=this.getPopupHeight(),i=e.nextElementSibling,n=i?i.offsetTop:e.offsetTop,r=e.getBoundingClientRect().height;this.dateTimeWrapper.scrollTop=n+e.offsetTop>t?i?n-(t/2+r/2):n:0}},{key:"setScrollTo",value:function(){var e,t=this.dateTimeWrapper.querySelectorAll(".e-list-item");if(t.length>=0){this.scrollInvoked=!0;var i=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=t[Math.round((n-i)/(6e4*this.step))]}else this.dateTimeWrapper.scrollTop=0;Object(l.X)(e)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(e)}},{key:"setInputValue",value:function(e){if("date"===e)this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{var t=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));u.c.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0)}this.updateIconState()}},{key:"getFullDateTime",value:function(){var e;return e=this.isDateObject(this.valueWithMinutes)?this.combineDateTime(this.valueWithMinutes):this.previousDate,this.validateMinMaxRange(e)}},{key:"combineDateTime",value:function(e){if(this.isDateObject(e)){var t=this.previousDate.getDate(),i=this.previousDate.getMonth(),n=this.previousDate.getFullYear(),r=e.getHours(),s=e.getMinutes(),a=e.getSeconds();return new Date(n,i,t,r,s,a)}return this.previousDate}},{key:"onMouseClick",value:function(e){var t=e.target,i=this.selectedElement=Object(l.C)(t,".e-list-item");i&&i.classList.contains("e-list-item")&&(this.timeValue=i.getAttribute("data-value"),this.hide(e)),this.setSelection(i,e)}},{key:"setSelection",value:function(e,t){if(this.isValidLI(e)&&!e.classList.contains("e-active")){e.getAttribute("data-value"),this.selectedElement=e;var i=Array.prototype.slice.call(this.liCollections).indexOf(e);this.activeIndex=i,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Object(l.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(t)}}},{key:"setTimeActiveClass",value:function(){var e=Object(l.X)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!Object(l.X)(e)){var t=e.querySelectorAll(".e-list-item");if(t.length)for(var i=0;i<t.length;i++)if(this.timeCollections[i]===+this.valueWithMinutes){t[i].setAttribute("aria-selected","true"),this.selectedElement=t[i],this.activeIndex=i,this.setTimeActiveDescendant();break}}}},{key:"setTimeActiveDescendant",value:function(){Object(l.X)(this.selectedElement)?Object(l.x)(this.inputElement,{"aria-activedescendant":"null"}):Object(l.x)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})}},{key:"addTimeSelection",value:function(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),Object(l.X)(this.selectedElement)||(Object(l.v)([this.selectedElement],"e-active"),this.selectedElement.setAttribute("aria-selected","true"))}},{key:"removeTimeSelection",value:function(){if(this.removeTimeHover("e-hover"),!Object(l.X)(this.dateTimeWrapper)){var e=this.dateTimeWrapper.querySelectorAll(".e-active");e.length&&(Object(l.ib)(e,"e-active"),e[0].removeAttribute("aria-selected"))}}},{key:"removeTimeHover",value:function(e){var t=this.getTimeHoverItem(e);t&&t.length&&Object(l.ib)(t,e)}},{key:"getTimeHoverItem",value:function(e){var t,i=Object(l.X)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;return Object(l.X)(i)||(t=i.querySelectorAll("."+e)),t}},{key:"isValidLI",value:function(e){return e&&e.classList.contains("e-list-item")&&!e.classList.contains("e-disabled")}},{key:"calculateStartEnd",value:function(e,t,i){var n=e.getDate(),r=e.getMonth(),s=e.getFullYear(),a=e.getHours(),l=e.getMinutes(),o=e.getSeconds(),h=e.getMilliseconds();return t?"starttime"===i?new Date(s,r,n,0,0,0):new Date(s,r,n,23,59,59):new Date(s,r,n,a,l,o,h)}},{key:"startTime",value:function(e){var t,i,n,r=this.min;return+(n=null===e?new Date:e).getDate()==+r.getDate()&&+n.getMonth()==+r.getMonth()&&+n.getFullYear()==+r.getFullYear()||+new Date(n.getFullYear(),n.getMonth(),n.getDate())<=+new Date(r.getFullYear(),r.getMonth(),r.getDate())?(i=!1,t=this.min):+n<+this.max&&+n>+this.min?(i=!0,t=n):+n>=+this.max&&(i=!0,t=this.max),this.calculateStartEnd(t,i,"starttime")}},{key:"endTime",value:function(e){var t,i,n,r=this.max;return+(n=null===e?new Date:e).getDate()==+r.getDate()&&+n.getMonth()==+r.getMonth()&&+n.getFullYear()==+r.getFullYear()||+new Date(n.getUTCFullYear(),n.getMonth(),n.getDate())>=+new Date(r.getFullYear(),r.getMonth(),r.getDate())?(i=!1,t=this.max):+n<+this.max&&+n>+this.min?(i=!0,t=n):+n<=+this.min&&(i=!0,t=this.min),this.calculateStartEnd(t,i,"endtime")}},{key:"hide",value:function(e){var t=this;if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:Object(l.W)()&&this.isServerRendered?null:this.popupObj||this.popupObject,event:e||null};var i=this.preventArgs;Object(l.X)(this.popupObj)?this.trigger("close",i,(function(i){t.dateTimeCloseEventCallback(e,i)})):this.dateTimeCloseEventCallback(e,i)}else l.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}},{key:"dateTimeCloseEventCallback",value:function(e,t){this.preventArgs=t,this.preventArgs.cancel||(this.isDatePopupOpen()?i(o(r.prototype),"hide",this).call(this,e):this.isTimePopupOpen()&&(this.closePopup(e),Object(l.ib)([document.body],"e-time-overflow"),l.d.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),l.d.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()}},{key:"closePopup",value:function(e){this.isTimePopupOpen()&&this.popupObject&&(this.popupObject.hide(new l.b({name:"FadeOut",duration:100,delay:0})),this.inputWrapper.container.classList.remove("e-icon-anim"),Object(l.x)(this.inputElement,{"aria-expanded":"false"}),l.l.remove(document,"mousedown touchstart",this.documentClickHandler))}},{key:"preRender",value:function(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),i(o(r.prototype),"preRender",this).call(this),Object(l.ib)([this.inputElementCopy],[de])}},{key:"getProperty",value:function(e,t){this.setProperties("min"===t?{min:this.validateValue(e.min)}:{max:this.validateValue(e.max)},!0)}},{key:"checkAttributes",value:function(e){var t,i,n=c(e?Object(l.X)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"]);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!Object(l.X)(this.inputElement.getAttribute(r)))switch(r){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(r));break;case"step":this.step=parseInt(this.inputElement.getAttribute(r),10);break;case"readonly":if(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.readonly||e){var s="disabled"===this.inputElement.getAttribute(r)||""===this.inputElement.getAttribute(r)||"true"===this.inputElement.getAttribute(r);this.setProperties({readonly:s},!e)}break;case"placeholder":(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.placeholder||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(r)},!e);break;case"min":(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.min||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({min:t},!e));break;case"disabled":if(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.enabled||e){var a="disabled"!==this.inputElement.getAttribute(r)&&"true"!==this.inputElement.getAttribute(r)&&""!==this.inputElement.getAttribute(r);this.setProperties({enabled:a},!e)}break;case"value":(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.value||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({value:t},!e));break;case"max":(Object(l.X)(this.dateTimeOptions)||void 0===this.dateTimeOptions.max||e)&&(t=new Date(this.inputElement.getAttribute(r)),this.isNullOrEmpty(t)||isNaN(+t)||this.setProperties({max:t},!e))}}}catch(o){n.e(o)}finally{n.f()}}},{key:"requiredModules",value:function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),e}},{key:"getTimeActiveElement",value:function(){return Object(l.X)(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll(".e-active")}},{key:"createDateObj",value:function(e){return e instanceof Date?e:null}},{key:"getDateObject",value:function(e){if(!this.isNullOrEmpty(e)){var t=this.createDateObj(e),i=this.valueWithMinutes,n=!Object(l.X)(i);if(this.checkDateValue(t)){var r=n?i.getDate():se,s=n?i.getMonth():ae,a=n?i.getFullYear():le,o=n?i.getHours():oe,h=n?i.getMinutes():he,c=n?i.getSeconds():ce,u=n?i.getMilliseconds():ue;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(a,s,r,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())):new Date(a,s,r,o,h,c,u)}}return null}},{key:"findNextTimeElement",value:function(e){var t=this.inputElement.value,i=Object(l.X)(this.valueWithMinutes)?this.createDateObj(t):this.getDateObject(this.valueWithMinutes),n=null,r=this.liCollections.length;if(!Object(l.X)(this.activeIndex)||!Object(l.X)(this.checkDateValue(i))){if("home"===e.action)n=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if("end"===e.action)n=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if("down"===e.action){for(var s=0;s<r;s++)if(+i<this.timeCollections[s]){n=+this.createDateObj(new Date(this.timeCollections[s])),this.activeIndex=s;break}}else for(var a=r-1;a>=0;a--)if(+i>this.timeCollections[a]){n=+this.createDateObj(new Date(this.timeCollections[a])),this.activeIndex=a;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(Object(l.X)(n)?null:new Date(n))}}},{key:"setTimeValue",value:function(e,t){var i,n,r=this.validateMinMaxRange(t),s=this.createDateObj(r);return this.getFormattedValue(s)!==(Object(l.X)(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=Object(l.X)(s)?null:s,n=new Date(+this.valueWithMinutes)):(this.strictMode&&(e=s),this.valueWithMinutes=this.checkDateValue(e),n=new Date(+this.valueWithMinutes)),i=this.globalize.formatDate(n,"Gregorian"===this.calendarMode?{format:Object(l.X)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:Object(l.W)()?"d":"yMd"}:{format:Object(l.X)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&Object(l.X)(n),u.c.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),n}},{key:"timeElementValue",value:function(e){if(!Object(l.X)(this.checkDateValue(e))&&!this.isNullOrEmpty(e)){var t=e instanceof Date?e:this.getDateObject(e);return this.setTimeValue(t,e)}return null}},{key:"timeKeyHandler",value:function(e){if(!(Object(l.X)(this.step)||this.step<=0)){var t=this.timeCollections.length;if(Object(l.X)(this.getTimeActiveElement())||0===this.getTimeActiveElement().length)this.liCollections.length>0&&(Object(l.X)(this.value)&&Object(l.X)(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(e));else{var i;if(e.keyCode>=37&&e.keyCode<=40){var n=40===e.keyCode||39===e.keyCode?++this.activeIndex:--this.activeIndex;this.activeIndex=this.activeIndex===t?0:this.activeIndex,this.activeIndex=n=this.activeIndex<0?t-1:this.activeIndex,i=Object(l.X)(this.timeCollections[n])?this.timeCollections[0]:this.timeCollections[n]}else"home"===e.action?(this.activeIndex=0,i=this.timeCollections[0]):"end"===e.action&&(this.activeIndex=t-1,i=this.timeCollections[t-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(i))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,"e-navigation"),this.setTimeActiveDescendant(),!this.isTimePopupOpen()||null===this.selectedElement||e&&"click"===e.type||this.setTimeScrollPosition()}}},{key:"TimeKeyActionHandle",value:function(e){if(this.enabled)switch("right"!==e.action&&"left"!==e.action&&"tab"!==e.action&&e.preventDefault(),e.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(e),this.hide(e),Object(l.v)([this.inputWrapper.container],"e-input-focus"),this.isNavigate=!1,e.stopPropagation();break;case"escape":this.hide(e);break;default:this.isNavigate=!1}}},{key:"inputKeyAction",value:function(e){switch(e.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(e)}}},{key:"onPropertyChanged",value:function(e,t){for(var n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"value":this.cldrDateTimeFormat(),Object(l.W)(),this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,e.value=this.validateValue(e.value),u.c.setValue(this.getFormattedValue(e.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=e.value,this.setProperties({value:e.value},!0),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null);break;case"min":case"max":this.getProperty(e,a),this.updateInput();break;case"enableRtl":u.c.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":Object(l.X)(t.cssClass)||(t.cssClass=t.cssClass.replace(/\s+/g," ").trim()),Object(l.X)(e.cssClass)||(e.cssClass=e.cssClass.replace(/\s+/g," ").trim()),u.c.setCssClass(e.cssClass,[this.inputWrapper.container],t.cssClass),this.dateTimeWrapper&&u.c.setCssClass(e.cssClass,[this.dateTimeWrapper],t.cssClass);break;case"locale":this.globalize=new l.n(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),u.c.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement),this.dateTimeFormat=this.cldrDateTimeFormat(),i(o(r.prototype),"updateInput",this).call(this);break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue();break;case"placeholder":u.c.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"enabled":u.c.setEnabled(this.enabled,this.inputElement),this.enabled||(this.inputElement.tabIndex=-1);break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width);break;case"readonly":u.c.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,u.c.removeFloating(this.inputWrapper),u.c.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(e.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;default:i(o(r.prototype),"onPropertyChanged",this).call(this,e,t)}this.hide(null)}}},{key:"getModuleName",value:function(){return"datetimepicker"}},{key:"restoreValue",value:function(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=Object(l.X)(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)}}]),r}(E);return re([Object(l.s)(null)],e.prototype,"timeFormat",void 0),re([Object(l.s)(30)],e.prototype,"step",void 0),re([Object(l.s)(null)],e.prototype,"scrollTo",void 0),re([Object(l.s)(1e3)],e.prototype,"zIndex",void 0),re([Object(l.s)(null)],e.prototype,"value",void 0),re([Object(l.s)(null)],e.prototype,"keyConfigs",void 0),re([Object(l.s)({})],e.prototype,"htmlAttributes",void 0),re([Object(l.s)(!1)],e.prototype,"enablePersistence",void 0),re([Object(l.s)(!0)],e.prototype,"allowEdit",void 0),re([Object(l.s)(!1)],e.prototype,"isMultiSelection",void 0),re([Object(l.s)(null)],e.prototype,"values",void 0),re([Object(l.s)(!0)],e.prototype,"showClearButton",void 0),re([Object(l.s)(null)],e.prototype,"placeholder",void 0),re([Object(l.s)(!1)],e.prototype,"strictMode",void 0),re([Object(l.s)(null)],e.prototype,"serverTimezoneOffset",void 0),re([Object(l.s)(new Date(1900,0,1))],e.prototype,"min",void 0),re([Object(l.s)(new Date(2099,11,31))],e.prototype,"max",void 0),re([Object(l.s)(null)],e.prototype,"firstDayOfWeek",void 0),re([Object(l.s)("Gregorian")],e.prototype,"calendarMode",void 0),re([Object(l.s)("Month")],e.prototype,"start",void 0),re([Object(l.s)("Month")],e.prototype,"depth",void 0),re([Object(l.s)(!1)],e.prototype,"weekNumber",void 0),re([Object(l.s)(!0)],e.prototype,"showTodayButton",void 0),re([Object(l.s)("Short")],e.prototype,"dayHeaderFormat",void 0),re([Object(l.s)(!1)],e.prototype,"openOnFocus",void 0),re([Object(l.k)()],e.prototype,"open",void 0),re([Object(l.k)()],e.prototype,"close",void 0),re([Object(l.k)()],e.prototype,"cleared",void 0),re([Object(l.k)()],e.prototype,"blur",void 0),re([Object(l.k)()],e.prototype,"focus",void 0),re([Object(l.k)()],e.prototype,"created",void 0),re([Object(l.k)()],e.prototype,"destroyed",void 0),e=re([l.q],e)}()}}])}();