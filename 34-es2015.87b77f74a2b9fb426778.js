(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{ZzeQ:function(e,t,i){"use strict";i.r(t),i.d(t,"AutomationModule",(function(){return ft}));var n=i("ofXK"),r=i("ltyr"),o=i("hXFv"),s=i("tyNb"),a=i("mrjb"),l=i("fXoL"),u=i("1kef"),c=i("4SUy"),d=i("OyPL"),p=i("H552"),h=i("58Y9"),m=i("M9dC"),b=i("A4Lh"),g=i("1UK9"),y=i("dSv1"),f=i("ScLb"),v=i("ngVE"),A=i("W3rC"),T=i("gnsf"),O=i("jcQU"),S=i("5Lwd"),x=i("Vtjc"),j=i("IaKf"),C=i("X8pc"),q=i("3LJS"),E=i("JCZ/"),R=i("QYJQ"),B=i("N/Vq"),I=i("SRvG"),N=i("Pk9d"),D=i("JNPz"),w=i("AjNn"),F=i("EiDu");const G=["querybuilderProp"],P=["querybuilderAdditionalProp"],L=["querybuilderaction"],U=["ruleName"],M=["ruleDescription"],k=["queryBuilderContainer"],V=["ruleContainer"],H=["ruleContainerAction"],_=["actionNotesTemplate"],J=["actionEmailTemplate"],Q=["actionAssigneeTemplate"],$=["assigneeDropEmail"],W=["assigneeGroupDropEmail"],K=["assigneeGroupDrop"],X=["assigneeDrop"],z=["bussinessHours"],Y=["enableDisableSwitch"],Z=["activityTab"],ee=["saveRuleDialog"],te=["assignmentTypeDrpDwn"],ie=["actionUserEmailTemplate"],ne=["actionGroupEmailTemplate"],re=["subjectGroupField"],oe=["actionNotesRTE"],se=["autoAssignmentGroupDrop"],ae=["actionEmailUserRTE"],le=["actionEmailGroupRTE"];function ue(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",54),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Ob(4,"span",55),l.Sb()),2&e&&(l.xb(2),l.Mc(l.ic(3,1,"SETACTION")))}function ce(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",54),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Ob(4,"span",55),l.Sb()),2&e&&(l.xb(2),l.Mc(l.ic(3,1,"ASSOCIATEAGENT")))}function de(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",56),l.Tb(1,"div",57),l.Tb(2,"button",58),l.ec("click",(function(){return l.Bc(e),l.gc().summaryClick()})),l.Lc(3),l.hc(4,"translate"),l.Sb(),l.Sb(),l.Sb()}2&e&&(l.xb(3),l.Mc(l.ic(4,1,"SUMMARY")))}function pe(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",59),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.Mc(l.ic(3,1,"FIELDREQUIRED")))}function he(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",59),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.Mc(l.ic(3,1,"FIELDREQUIRED")))}function me(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div"),l.Tb(1,"ejs-dropdownlist",60,61),l.ec("dataBound",(function(){return l.Bc(e),l.gc().businessHrsDataBind()}))("created",(function(){return l.Bc(e),l.gc().dropDownCreated()}))("blur",(function(){return l.Bc(e),l.gc().OperationalHoursFocusOut()})),l.hc(3,"translate"),l.Sb(),l.Jc(4,he,4,3,"div",6),l.Sb()}if(2&e){const e=l.gc();l.xb(1),l.oc("placeholder",l.ic(3,10,"OPERATIONALHOURS")),l.nc("dataSource",e.businessHourList)("value",e.businessId)("query",e.operationalHoursQuery)("fields",e.businessHourListFields)("showClearButton",!0)("allowFiltering",!0)("filterBarPlaceholder",e.placeholderString)("htmlAttributes",e.autoCompleteAttribute),l.xb(3),l.nc("ngIf",e.operationalHoursRequired)}}function be(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",59),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.Nc(" ",l.ic(3,1,"PLEASECHOOSEONECONDITION")," "))}function ge(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",59),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.Nc(" ",l.ic(3,1,"PLEASECHOOSEONECONDITION")," "))}function ye(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",62),l.Tb(1,"button",28),l.ec("click",(function(){return l.Bc(e),l.gc().newAction()})),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()}if(2&e){const e=l.gc();l.nc("ngClass",e.showAction?"":"hide-action"),l.xb(2),l.Mc(l.ic(3,2,"ADDNEWACTION"))}}function fe(e,t){1&e&&(l.Tb(0,"div"),l.Tb(1,"span",59),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.Nc(" ",l.ic(3,1,"PLEASECHOOSEONEACTION"),""))}function ve(e,t){1&e&&(l.Tb(0,"div",72),l.Lc(1),l.hc(2,"translate"),l.Sb()),2&e&&(l.xb(1),l.Nc(" ",l.ic(2,1,"FIELDREQUIRED")," "))}function Ae(e,t){if(1&e){const e=l.Ub();l.Tb(0,"span"),l.Tb(1,"div",63),l.Tb(2,"ul",64),l.Tb(3,"li"),l.Lc(4),l.hc(5,"translate"),l.Sb(),l.Tb(6,"li"),l.Lc(7),l.hc(8,"translate"),l.Sb(),l.Tb(9,"li"),l.Lc(10),l.hc(11,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Tb(12,"div",65),l.Tb(13,"span",66),l.Lc(14),l.hc(15,"translate"),l.Sb(),l.Tb(16,"div",67),l.Tb(17,"div",68),l.Tb(18,"ejs-dropdownlist",69,70),l.ec("blur",(function(){return l.Bc(e),l.gc().autoAssignmentGroupDropBlur()}))("focus",(function(){return l.Bc(e),l.gc().autoAssignmentGroupDropFocus()})),l.hc(20,"translate"),l.hc(21,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Jc(22,ve,3,3,"div",71),l.Sb(),l.Sb()}if(2&e){const e=l.gc();l.xb(4),l.Mc(l.ic(5,13,"AUTOASSIGNMENTONE")),l.xb(3),l.Mc(l.ic(8,15,"AUTOASSIGNMENTTWO")),l.xb(3),l.Mc(l.ic(11,17,"AUTOASSIGNMENTSIX")),l.xb(4),l.Nc(" ",l.ic(15,19,"AUTOASSIGNMENTGROUPSELECT")," "),l.xb(4),l.oc("placeholder",l.ic(20,21,"GROUP")),l.oc("filterBarPlaceholder",l.ic(21,23,"SEARCH")),l.nc("query",e.groupActionAutoAssignmentQuery)("dataSource",e.assigneeGroupDataConfig)("fields",e.assigneeGroupFieldConfig)("allowFiltering",!0)("showClearButton",!0)("value",e.groupValueForAutoAssignment),l.xb(4),l.nc("ngIf",e.invalidGroup)}}function Te(e,t){if(1&e){const e=l.Ub();l.Tb(0,"span"),l.Tb(1,"button",73),l.ec("click",(function(t){return l.Bc(e),l.gc().btnClick(t)})),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()}2&e&&(l.xb(1),l.nc("isPrimary",!0),l.xb(1),l.Mc(l.ic(3,2,"SAVE")))}function Oe(e,t){if(1&e){const e=l.Ub();l.Tb(0,"span"),l.Tb(1,"button",74),l.ec("click",(function(t){return l.Bc(e),l.gc().btnClick(t)})),l.Lc(2),l.hc(3,"translate"),l.Sb(),l.Sb()}2&e&&(l.xb(1),l.nc("isPrimary",!0),l.xb(1),l.Mc(l.ic(3,2,"UPDATE")))}function Se(e,t){if(1&e){const e=l.Ub();l.Tb(0,"app-rte",75,76),l.ec("focusOut",(function(){l.Bc(e);const t=l.yc(1);return l.gc().rteBlur(t)}))("focusIn",(function(){l.Bc(e);const t=l.yc(1);return l.gc().rteFocus(t)})),l.hc(2,"translate"),l.Sb()}if(2&e){const e=t.$implicit,i=l.gc();l.pc("label","",l.ic(2,5,"DESCRIPTION")," :"),l.nc("id","automationAction_"+e.name)("isNeedImageUpload",!1)("value",i.notesContentValueForDetails)("enablePlaceholder",!0)}}function xe(e,t){if(1&e&&(l.Tb(0,"span",87),l.Tb(1,"div",88),l.Tb(2,"div",89),l.Tb(3,"div",90),l.Tb(4,"span",91),l.Lc(5),l.Sb(),l.Tb(6,"span",91),l.Tb(7,"span",92),l.Lc(8),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){const e=t.$implicit;l.xb(5),l.Nc(" ",e.displayName," "),l.xb(3),l.Mc(e.emailId)}}function je(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",78),l.Tb(1,"div",68),l.Tb(2,"ejs-multiselect",79,80),l.ec("dataBound",(function(t){return l.Bc(e),l.gc(2).assigneeUserEmailDataBind(t)}))("blur",(function(){l.Bc(e);const t=l.yc(3);return l.gc(2).assigneeGroupBlur(t)})),l.hc(4,"translate"),l.hc(5,"translate"),l.Jc(6,xe,9,2,"ng-template",null,81,l.Kc),l.Sb(),l.Sb(),l.Sb(),l.Tb(8,"div",82),l.Tb(9,"ejs-textbox",83,84),l.ec("blur",(function(){l.Bc(e);const t=l.yc(10);return l.gc(2).assigneeGroupBlur(t)})),l.hc(11,"translate"),l.Sb(),l.Sb(),l.Tb(12,"div",82),l.Tb(13,"app-rte",85,86),l.ec("focusOut",(function(){l.Bc(e);const t=l.yc(14);return l.gc(2).rteBlur(t)}))("focusIn",(function(){l.Bc(e);const t=l.yc(14);return l.gc(2).rteFocus(t)})),l.hc(15,"translate"),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.gc(2);l.xb(2),l.oc("placeholder",l.ic(4,15,"USER")),l.oc("filterBarPlaceholder",l.ic(5,17,"SEARCH")),l.nc("value",i.userValueForUserDetails)("dataSource",i.assigneeEmailDataConfig)("fields",i.assigneeFieldConfig)("allowFiltering",!0)("query",i.userActionNotifyQuery),l.xb(7),l.oc("placeholder",l.ic(11,19,"SUBJECT")),l.nc("htmlAttributes",i.inputAttribute)("value",i.subValueForUserDetails),l.xb(4),l.pc("label","",l.ic(15,21,"DESCRIPTION")," :"),l.nc("id","automationAction_"+e.name)("isNeedImageUpload",!1)("value",i.rteValueForUserDetails)("enablePlaceholder",!0)}}function Ce(e,t){1&e&&l.Jc(0,je,16,23,"ng-template",null,77,l.Kc)}function qe(e,t){1&e&&l.Lc(0),2&e&&l.Nc(" ",t.$implicit.groupName," ")}function Ee(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",78),l.Tb(1,"div",68),l.Tb(2,"ejs-multiselect",94,95),l.ec("dataBound",(function(t){return l.Bc(e),l.gc(2).emailGroupDatabind(t)}))("blur",(function(){l.Bc(e);const t=l.yc(3);return l.gc(2).assigneeGroupBlur(t)})),l.hc(4,"translate"),l.hc(5,"translate"),l.Jc(6,qe,1,1,"ng-template",null,81,l.Kc),l.Sb(),l.Sb(),l.Sb(),l.Tb(8,"div",82),l.Tb(9,"ejs-textbox",96,97),l.ec("blur",(function(){l.Bc(e);const t=l.yc(10);return l.gc(2).assigneeGroupBlur(t)})),l.hc(11,"translate"),l.Sb(),l.Sb(),l.Tb(12,"div",82),l.Tb(13,"app-rte",85,98),l.ec("focusOut",(function(){l.Bc(e);const t=l.yc(14);return l.gc(2).rteBlur(t)}))("focusIn",(function(){l.Bc(e);const t=l.yc(14);return l.gc(2).rteFocus(t)})),l.hc(15,"translate"),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.gc(2);l.xb(2),l.oc("placeholder",l.ic(4,16,"GROUP")),l.oc("filterBarPlaceholder",l.ic(5,18,"SEARCH")),l.nc("dataSource",i.assigneeGroupDataConfig)("fields",i.assigneeGroupFieldConfig)("allowFiltering",!0)("query",i.groupActionNotifyQuery)("value",i.userValueForGroupDetails)("text",i.userValueForGroupDetailsText),l.xb(7),l.oc("placeholder",l.ic(11,20,"SUBJECT")),l.nc("htmlAttributes",i.inputAttribute)("value",i.subValueForGroupDetails),l.xb(4),l.pc("label","",l.ic(15,22,"DESCRIPTION")," :"),l.nc("id","automationAction_"+e.name)("isNeedImageUpload",!1)("value",i.rteValueForGroupDetails)("enablePlaceholder",!0)}}function Re(e,t){1&e&&l.Jc(0,Ee,16,24,"ng-template",null,93,l.Kc)}function Be(e,t){1&e&&l.Lc(0),2&e&&l.Nc(" ",t.$implicit.groupName," ")}function Ie(e,t){if(1&e&&(l.Tb(0,"div",104),l.Tb(1,"div",89),l.Tb(2,"div",90),l.Tb(3,"span",91),l.Lc(4),l.Sb(),l.Tb(5,"span",91),l.Tb(6,"span",92),l.Lc(7),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb()),2&e){const e=t.$implicit;l.nc("ngClass",e.isAgent?"agent":""),l.yb("data-user-id",e.userId),l.xb(4),l.Nc(" ",e.displayName," "),l.xb(3),l.Mc(e.emailId)}}function Ne(e,t){1&e&&(l.Tb(0,"div",105),l.Lc(1),l.hc(2,"translate"),l.Sb()),2&e&&(l.xb(1),l.Mc(l.ic(2,1,"VALIDATIONMESSAGEFORSETASSIGNEE")))}function De(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",78),l.Tb(1,"div",68),l.Tb(2,"ejs-dropdownlist",99,100),l.ec("change",(function(t){return l.Bc(e),l.gc().assigneeGroupChange(t)}))("dataBound",(function(){return l.Bc(e),l.gc().assigneeGroupDataBind()}))("blur",(function(){return l.Bc(e),l.gc().setAssigneeBlur()}))("focus",(function(){return l.Bc(e),l.gc().setAssigneeFocus()})),l.hc(4,"translate"),l.hc(5,"translate"),l.Jc(6,Be,1,1,"ng-template",null,81,l.Kc),l.Sb(),l.Sb(),l.Tb(8,"div",68),l.Tb(9,"ejs-dropdownlist",101,102),l.ec("dataBound",(function(t){return l.Bc(e),l.gc().assigneeDataBind(t)}))("change",(function(){return l.Bc(e),l.gc().setAssigneeBlur()}))("focus",(function(){return l.Bc(e),l.gc().setAssigneeFocus()})),l.hc(11,"translate"),l.hc(12,"translate"),l.Jc(13,Ie,8,4,"ng-template",null,81,l.Kc),l.Sb(),l.Sb(),l.Sb(),l.Jc(15,Ne,3,3,"div",103)}if(2&e){const e=l.gc();l.xb(2),l.oc("placeholder",l.ic(4,19,"GROUP")),l.oc("filterBarPlaceholder",l.ic(5,21,"SEARCH")),l.nc("query",e.groupActionQuery)("dataSource",e.assigneeGroupDataConfig)("value",e.groupValueForDetails)("fields",e.assigneeGroupFieldConfig)("allowFiltering",!0)("showClearButton",!0)("text",e.groupTextForDetails),l.xb(7),l.oc("placeholder",l.ic(11,23,"AGENT")),l.oc("filterBarPlaceholder",l.ic(12,25,"SEARCH")),l.nc("query",e.assigneeActionQuery)("dataSource",e.assigneeDataConfig)("value",e.assigneeValueForDetails)("fields",e.assigneeFieldConfig)("allowFiltering",!0)("showClearButton",!0)("text",e.assigneeTextForDetails),l.xb(6),l.nc("ngIf",e.setAssigneeVaidationFail)}}function we(e,t){1&e&&(l.Tb(0,"span"),l.Lc(1),l.hc(2,"translate"),l.Sb()),2&e&&(l.xb(1),l.Nc(" ",l.ic(2,1,"SUMMARY")," "))}function Fe(e,t){if(1&e&&(l.Tb(0,"div"),l.Ob(1,"p",106),l.hc(2,"safe"),l.Sb()),2&e){const e=l.gc();l.xb(1),l.nc("innerHTML",l.jc(2,1,e.summaryString,"html"),l.Cc)}}let Ge=(()=>{class e{constructor(e,t,i,n,r,o,s,a){this.viewContainerRef=e,this.router=t,this.toastService=i,this.spinService=n,this.automationListService=r,this.appRootService=o,this.cd=s,this.seoService=a,this.showButtons={groupInsert:!1,groupDelete:!0,ruleDelete:!0},this.autoCompleteAttribute={autocomplete:"anyrandomstring"},this.operationalHoursRequired=!1,this.actionRuleDel=!0,this.queryOperators=[{key:S.o.Equal,value:S.p.Equal},{key:S.o.NotEqual,value:S.p.NotEqual},{key:S.o.Greater,value:S.p.Greater},{key:S.o.Less,value:S.p.Less},{key:S.o.GreaterOrEqual,value:S.p.GreaterOrEqual},{key:S.o.LessOrEqual,value:S.p.LessOrEqual},{key:S.o.IsNull,value:S.p.IsNull},{key:S.o.IsNotNull,value:S.p.IsNotNull},{key:S.o.IsEmpty,value:S.p.IsEmpty},{key:S.o.IsNotEmpty,value:S.p.IsNotEmpty},{key:S.o.In,value:S.p.In},{key:S.o.NotIn,value:S.p.NotIn},{key:S.o.Contains,value:S.p.Contains},{key:S.o.NotContains,value:S.p.NotContains},{key:S.o.BeginsWith,value:S.p.BeginsWith},{key:S.o.EndsWith,value:S.p.EndsWith},{key:S.o.NotBeginsWith,value:S.p.NotBeginsWith},{key:S.o.NotEndsWith,value:S.p.NotEndsWith},{key:S.o.Between,value:S.p.Between},{key:S.o.NotBetween,value:S.p.NotBetween},{key:S.o.IsChanged,value:S.p.IsChanged},{key:S.o.IsPublic,value:S.p.IsPublic},{key:S.o.IsPrivate,value:S.p.IsPrivate},{key:S.o.Businesshours,value:S.p.Businesshours},{key:S.o.NonBusinessHours,value:S.p.NonBusinessHours},{key:S.o.Holidays,value:S.p.Holidays},{key:S.o.After,value:S.p.After},{key:S.o.Before,value:S.p.Before}],this.inputAttribute={maxlength:b.s,autocomplete:"anyrandomstring"},this.assigneeGroupFieldConfig={value:"groupID",text:"groupName"},this.assigneeFieldConfig={value:"userId",text:"displayName"},this.validCondition=!0,this.validConditionForGroup=!0,this.validAction=!0,this.itemAddedAssignee=!1,this.itemAddedAssigneeEmail=!1,this.itemAddedGroupEmail=!1,this.itemAddedGroup=!1,this.toShowAddFilter=!1,this.additionalConditionRuleDel=!0,this.enable=!0,this.tabAnimationSettings={next:{effect:"None"},previous:{effect:"None"}},this.assignmentTypeSource=[{value:1,text:"Direct"},{value:2,text:"Round Robin"}],this.assignmentTypeFields={text:"text",value:"value"},this.businessHourListFields={text:"name",value:"id"},this.placeholderString=Object(y.a)("SEARCH"),this.addItemFrBusinessHrs=!0,this.conditionErrorAndRule=!1,this.conditionErrorOrRule=!1,this.actionError=!1,this.setAssigneeVaidationFail=!1,this.invalidGroup=!1,this.hideAddActionButton=!1,this.enablePrivateNoteAction=!1,this.enableUserNotificationAction=!1,this.enableGroupNotificationAction=!1,this.isRequestCompleted=!1,this.rootColumDropDown=[{text:"Tickets",value:"1"}],this.assigneeGroupDataConfig=new p.a({url:f.a.Group,adaptor:new m.b}),this.assigneeDataConfig=new p.a({url:f.a.Assignee,adaptor:new m.b}),this.assigneeEmailDataConfig=new p.a({url:f.a.Requester,adaptor:new m.b})}ngOnInit(){const e=this.automationId>0?Object(y.a)("EDIT")+" ":Object(y.a)("ADD")+" ";S.l.CreateTicketAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("CREATETICKETTRIGGERS"),e,"/admin/automation/create-ticket-triggers"):S.l.UpdateTicketAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("UPDATETICKETTRIGGERS"),e,"/admin/automation/update-ticket-triggers"):S.l.TimeTriggerAutomation===this.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("TIMETRIGGERS"),e,"/admin/automation/time-triggers"):S.l.AutoAssignmentAutomation===this.eventType&&this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("AUTOASSIGNMENTTRIGGERS"),e,"/admin/automation/auto-assignments"),this.customReqHandle=b.R.subscribe(()=>{this.isRequestCompleted=!0,Object(b.S)(!1),this.spinService.hideSpinner(),this.customReqHandle.unsubscribe()}),this.convertFields().then(()=>{this.eventType!==S.l.AutoAssignmentAutomation&&this.convertActionFields()}),this.showAction=this.eventType!==S.l.AutoAssignmentAutomation,this.groupValueForAutoAssignment&&(this.groupActionAutoAssignmentQuery=(new p.g).addParams("includeAdditionalIds",""+this.groupValueForAutoAssignment)),this.href=this.router.url,this.businessHourList=new p.a({url:x.a.BusinessHourList,adaptor:new m.b}),this.operationalHoursQuery=(new p.g).addParams(this.fieldQuery(S.r.BusinessHourQuery),""+this.businessId)}ngOnDestroy(){Object(b.S)(!1)}setTitleAndSeo(e,t,i,n){const r=i+" | "+t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t+" / "+i+","+n),this.seoService.setHeaderElements({title:r})}compileTemplate(e,t){const i=this.viewContainerRef.createEmbeddedView(e,{$implicit:t});i.markForCheck();const n=Object(c.F)("div"),r=i.rootNodes;return r.length>0&&r.forEach(e=>{n.appendChild(e)}),n}ngAfterViewInit(){Object(b.V)(!0)}queryBuildervalueUpdate(e,t,i){e.notifyChange(i,t)}queryActionCreated(){setTimeout(()=>{this.actionRules&&(this.actionRuleDel=!1),Object(c.X)(this.qryBldrObjAction.valueText)&&(this.qryBldrObjAction.valueText={});const e=this.qryBldrObjAction.element.querySelector(".e-addrulegroup");if(e){const t=Object(c.M)(e,"dropdown-btn");t&&(t.cssClass="e-round e-caret-hide hd-query-action-group e-addrulegroup")}}),this.styleChange(this.qryBldrObjAction)}querybuilderCreated(){this.qryBldrObjRule.operators=this.queryOperators,setTimeout(()=>{const e=this.qryBldrObjRule.element.querySelector(".e-addrulegroup");if(e){const t=Object(c.M)(e,"dropdown-btn");t&&(t.cssClass="e-round e-caret-hide hd-query-action-rule e-addrulegroup")}this.styleChange(this.qryBldrObjRule)})}querybuilderAdditionalCreated(){this.querybuilderAdditionalProp.operators=this.queryOperators,setTimeout(()=>{const e=this.querybuilderAdditionalProp.element.querySelector(".e-addrulegroup");if(e){const t=Object(c.M)(e,"dropdown-btn");t&&(t.cssClass="e-round e-caret-hide hd-query-action-rule e-addrulegroup")}this.styleChange(this.querybuilderAdditionalProp)})}querybuilderRuleChange(){(this.qryBldrObjRule.rule.rules.length>1||""!==this.qryBldrObjRule.rule.rules[0].field)&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&(this.validCondition=this.qryBldrObjRule.validateFields())}querybuilderAddRuleChange(){1!==this.querybuilderAdditionalProp.rule.rules.length&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields())}querybuilderChange(e){e&&("deleteRule"!==e.type&&"insertRule"!==e.type||(this.conditionRuleDel=1===this.qryBldrObjRule.rule.rules.length&&""===this.qryBldrObjRule.rule.rules[0].field),"field"===e.type&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.conditionRuleDel=!1),"deleteRule"===e.type&&0===this.qryBldrObjRule.rule.rules.length&&this.qryBldrObjRule.addRuleElement(this.qryBldrObjRule.element.querySelector(".e-group-container"),{})),this.qryBldrObjRule.rule.rules.length>0&&(this.qryBldrObjRule.rule.rules.length>1||""!==this.qryBldrObjRule.rule.rules[0].field)&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&(this.validCondition=this.qryBldrObjRule.validateFields()),this.ruleConditionRequired=!1,this.isSummaryView=!1,this.styleChange(this.qryBldrObjRule)}summaryFraming(){let e="";const t={condition:this.qryBldrObjRule.rule.condition,rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))},i=this.processRule(this.qryBldrObjRule.element.id,t);this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(e=this.queryBuilderSummaryFrame(i,"and"));let n="",r="";if(this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field){const t={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},i=this.processRule(this.querybuilderAdditionalProp.element.id,t);e?n='<div class="secondary">and</div> '+this.queryBuilderSummaryFrame(i,"or"):e||(n=""+this.queryBuilderSummaryFrame(i,"or"))}let o="";var s;this.eventType!==S.l.CreateTicketAutomation&&this.eventType!==S.l.UpdateTicketAutomation&&this.eventType!==S.l.AutoAssignmentAutomation||(o=`<div class='primary summary-field'>When <span class="summary-field summary-field">Ticket is </span> <span class='summary-field'> ${s=this.eventType,s===S.l.CreateTicketAutomation?S.s.Created:s===S.l.UpdateTicketAutomation?S.s.Updated:s===S.l.AutoAssignmentAutomation?S.s.Created+" or "+S.s.Updated:void 0} </span> </div>`),this.eventType===S.l.TimeTriggerAutomation&&(o=`<div class='primary summary-field'><span class='summary-field'> ${S.s.TimeTriggerContent} </span> </div>`),this.qryBldrObjAction&&this.qryBldrObjAction.rule&&this.qryBldrObjAction.rule.rules.length>0&&""!==this.qryBldrObjAction.rule.rules[0].field&&(r+=this.queryBuilderActionSummaryFrame(this.qryBldrObjAction)),this.eventType===S.l.AutoAssignmentAutomation&&this.autoAssignmentGroupDrop.text&&(r+=`<div class="Primary"> <span class="summary-field">Set assignee</span><span class="summary-operator lowercase"> to</span><span class='summary-value'> ${this.autoAssignmentGroupDrop.text}</span></div>`),this.summaryString=r?`<span>${o}<div class="summary-condition">${e} ${n}</div><div style="margin-bottom:15px" class="summary-field">Perform these actions</div><div class="summary-action">${r}</div></span>`:`<span> ${o} <div class="summary-condition"> ${e} ${n} </div> </span>`}queryBuilderActionSummaryFrame(e){const t=`<div class="secondary">${e.rule.condition}</div>`;let i="";return e.rule.rules.forEach((n,r)=>{var o,s;i+=`<div class="Primary"> <span class="summary-field">${n.label}</span> ${o=n.field,s=n.type,"string"==typeof e.valueText[o]&&o!==S.f.Duedate&&s!==S.g.Date&&s!==S.g.DateTime?e.valueText[o]?`<span class="summary-operator lowercase">as</span> <span class='summary-value'>${e.valueText[o]}</span>`:"":"object"==typeof e.valueText[o]&&o!==S.f.Duedate&&null!==e.valueText[o]?`<span class="summary-operator lowercase">to</span>\n                <span class='summary-value'>${e.valueText[o].groupText?e.valueText[o].groupText:""}</span>\n                <span class="secondary">${e.valueText[o].groupText&&e.valueText[o].assigneeText?"and":""}</span>\n                <span class='summary-value'>${e.valueText[o].assigneeText?e.valueText[o].assigneeText:""}</span>`:o===S.f.Duedate||s===S.g.Date?`<span class='summary-value'>${e.valueText[o]?Object(h.G)(e.valueText[o],b.e.dateFormat):""}<span>`:s===S.g.DateTime?`<span class='summary-value'>${e.valueText[o]?Object(h.G)(e.valueText[o],b.e.dateFormat,b.e.timeFormat):""}<span>`:""} </div> ${e.rule.rules.length-1!==r?t:""}`}),i}queryBuilderSummaryFrame(e,t){let i,n,r="";const o=`<div class="secondary">${t}</div>`,s=e=>{const t=Object.assign([],this.queryOperators).filter(t=>t.value===e)[0];return t?t.key:e};return e&&e.rules.length>0&&e.rules.forEach((t,a)=>{i=this.isValidArray(t.value,t)?'<span class="summary-value">'+t.value+"</span>":Object.prototype.hasOwnProperty.call(t,"from")?' from <span class="summary-value">'+t.from+'</span> to <span class="summary-value">'+t.to+"</span>":t.type===S.g.Date?'<span class="summary-value">'+Object(h.G)(t.value,b.e.dateFormat)+"</span>":t.type===S.g.DateTime||t.operator===S.p.Before||t.operator===S.p.After?'<span class="summary-value">'+Object(h.G)(t.value,b.e.dateFormat,b.e.timeFormat)+"</span>":"",n=""+s(t.operator)===(S.o.IsPublic||S.o.IsPrivate)?`<span class="summary-operator summary-value lowercase">${s(t.operator)}</span>`:`<span class="summary-operator lowercase">${s(t.operator)}</span>`,r+=`<div class='primary'>If <span class="summary-field">${t.label}</span> <span>${n}</span> <span>${i}</span> </div> ${e.rules.length-1!==a?o:""}`}),r}isValidArray(e,t){return!Object(c.X)(e)&&e.length&&e.length>0&&!Object.prototype.hasOwnProperty.call(t,"from")&&!(t.type===S.g.DateTime)&&!(t.type===S.g.Date)||""===t.from||(t.type===S.g.Integer||t.type===S.g.Long||t.type===S.g.Decimal)&&!e.length}querybuilderAdditionalChange(e){e&&("deleteRule"!==e.type&&"insertRule"!==e.type||(this.extraConditionRuleDel=1===this.querybuilderAdditionalProp.rule.rules.length&&""===this.querybuilderAdditionalProp.rule.rules[0].field),"field"===e.type&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&(this.extraConditionRuleDel=!1),"deleteRule"===e.type&&0===this.querybuilderAdditionalProp.rule.rules.length&&this.querybuilderAdditionalProp.addRuleElement(this.querybuilderAdditionalProp.element.querySelector(".e-group-container"),{})),this.querybuilderAdditionalProp.rule.rules.length>0&&(this.querybuilderAdditionalProp.rule.rules.length>1||""!==this.querybuilderAdditionalProp.rule.rules[0].field)&&""===this.qryBldrObjRule.rule.rules[0].field&&(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields()),this.ruleConditionRequired=!1,this.isSummaryView=!1,this.styleChange(this.querybuilderAdditionalProp)}getEj2Componenet(e){return e.ej2_instances[0]}newAction(){this.qryBldrObjAction.validateFields()&&this.qryBldrObjAction.addRuleElement(this.qryBldrObjAction.element.querySelector(".e-group-container"),{})}newCondition(e,t){t.validateFields()&&t.addRuleElement(t.element.querySelector(".e-group-container"),{})}processActionRule(e,t,i=0){let n,r;if(t.condition){const i=t.rules.length;for(let r=0;r<i;r++)t.rules[r]=this.processRule(e,t.rules[r],r);const n=Object.assign([],t.rules);t.rules=this.getUniqueRule(n)}else r=this.ruleContainerEle.nativeElement.querySelector(`#${e} #${e}_group0_rule${i}`).getElementsByClassName("e-"+t.field)[0],Object(h.D)(t.value)?Object.prototype.hasOwnProperty.call(t,"from")||Object.prototype.hasOwnProperty.call(t,"to")?(r=this.ruleContainerEle.nativeElement.querySelector(`#${e} #${e}_group0_rule${i}`).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-from .e-control"),n=this.getEj2Componenet(r),n&&(t.from=n.text),r=this.ruleContainerEle.nativeElement.querySelector(`#${e} #${e}_group0_rule${i}`).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-to .e-control"),n=this.getEj2Componenet(r),n&&(t.to=n.text)):t.value="":(n=this.getEj2Componenet(r),t.value=n?n.text?n.text:n.value:r.value),t.field=t.label;return t}processRule(e,t,i=0){let n,r;if(t.condition){const i=t.rules.length;for(let r=0;r<i;r++)t.rules[r]=this.processRule(e,t.rules[r],r);const n=Object.assign([],t.rules);t.rules=this.getUniqueRule(n)}else r=this.ruleContainerEle.nativeElement.querySelector(`#${e} .e-rule-list`).children[i].getElementsByClassName("e-"+t.field)[0],!Object(h.D)(t.value)&&t.value.length&&t.value.length>0&&t.operator!==S.p.IsChanged&&t.operator!==S.p.IsPublic&&t.operator!==S.p.IsPrivate?(n=this.getEj2Componenet(r),t.value=n?n.text?n.text:n.value:r.value):(Object.prototype.hasOwnProperty.call(t,"from")||Object.prototype.hasOwnProperty.call(t,"to"))&&t.field!==S.h.ResolutionDue?(r=this.ruleContainerEle.nativeElement.querySelector(`#${e} .e-rule-list`).children[i].getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-from .e-control"),n=this.getEj2Componenet(r),n&&(t.from=n.text),r=this.ruleContainerEle.nativeElement.querySelector(`#${e} #${e}_group0_rule${i}`).getElementsByClassName("e-"+t.field)[0].querySelector(".e-is-changed-to .e-control"),n=this.getEj2Componenet(r),n&&(t.to=n.text)):t.value="",t.field=t.label;return t}getUniqueRule(e){const t=[];for(let i=0;i<e.length;i++)if(t.length<1)t.push(e[i]);else for(let n=0;n<t.length;n++)if(JSON.stringify(t[n])!==JSON.stringify(e[i])){t.push(e[i]);break}return t}querybuilderActionRuleChange(){this.ruleActionRequired=!1}querybuilderActionChange(e){if(this.qryBldrObjAction.rule.rules.length>0&&"1"===this.activityTab.selectingID&&(this.qryBldrObjAction.rule.rules.length>1||""!==this.qryBldrObjAction.rule.rules[0].field)&&(this.validAction=this.qryBldrObjAction.validateFields()),"deleteRule"!==e.type&&"insertRule"!==e.type||(this.actionRuleDel=1===this.qryBldrObjAction.rule.rules.length&&""===this.qryBldrObjAction.rule.rules[0].field),"field"===e.type&&""!==this.qryBldrObjAction.rule.rules[0].field&&(this.actionRuleDel=!1),"deleteRule"===e.type&&0===this.qryBldrObjAction.rule.rules.length&&this.qryBldrObjAction.addRuleElement(this.qryBldrObjAction.element.querySelector(".e-group-container"),{}),"deleteRule"!==e.type&&"insertRule"!==e.type&&"field"!==e.type||this.framUniqFieldsInActionQB(),e&&"field"===e.type){const t=this.qryBldrObjAction.element.querySelector("#"+this.qryBldrObjAction.element.id+"_"+e.ruleID+" .e-rule-operator .e-control.e-dropdownlist");if(t){const e=t.ej2_instances[0];e.value="equal",this.qryBldrObjAction.changeField({element:e.element,itemData:{key:"equal",value:"equal"},isInteracted:!1})}}this.styleChange(this.qryBldrObjAction)}textBoxcreated(){setTimeout(()=>{this.ruleNameObj&&this.ruleNameObj.element&&Object(h.h)(this.ruleNameObj.element.parentElement)})}dropDownCreated(){setTimeout(()=>{this.bussinessHours&&this.bussinessHours.element&&Object(h.h)(this.bussinessHours.element.parentElement)})}textBoxRuleFocusOut(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.nameRule=this.ruleNameObj.value}textBoxRulefocus(){this.ruleNameRequired=!1}OperationalHoursFocusOut(){this.operationalHoursRequired=Object(h.D)(this.bussinessHours.value)}isValid(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields(),this.validAction=this.qryBldrObjAction.validateFields()}isConditionTabValid(){this.ruleNameRequired=Object(h.D)(this.ruleNameObj.value),this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field?this.validCondition=this.qryBldrObjRule.validateFields():this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field?(this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields()):this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field&&this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field?(this.validCondition=this.qryBldrObjRule.validateFields(),this.validConditionForGroup=!(this.querybuilderAdditionalProp.rule.rules.length>1)||this.querybuilderAdditionalProp.validateFields()):(this.validConditionForGroup=this.querybuilderAdditionalProp.validateFields(),this.validCondition=!(this.qryBldrObjRule.rule.rules.length>1)||this.qryBldrObjRule.validateFields())}isActionTabValid(){this.validAction=this.qryBldrObjAction.validateFields()}checkValidation(){if(this.textBoxRuleFocusOut(),0===this.qryBldrObjRule.getValidRules(this.qryBldrObjRule.rule).rules.length&&(this.ruleConditionRequired=!0),0===this.qryBldrObjAction.getValidRules(this.qryBldrObjAction.rule).rules.length&&(this.ruleActionRequired=!0),this.ruleNameRequired&&this.ruleNameObj.focusIn(),!this.ruleNameRequired&&!this.ruleActionRequired&&!this.ruleConditionRequired){const e=this.qryBldrObjRule.getValidRules(this.qryBldrObjRule.rule);console.dir(JSON.stringify(e,null,4)),console.dir(JSON.stringify(this.qryBldrObjAction.rule.rules,null,4))}}ruleSaveEvent(){let e,t;this.spinService.showSpinner(),this.summaryFraming(),this.eventType===S.l.AutoAssignmentAutomation&&(t=[{name:"AssignTicket",label:"Set assignee",field:S.f.UpdateAssignee,AssignmentType:S.e.RoundRobin,GroupId:this.autoAssignmentGroupDrop.value.toString()}]),this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.addRuleCondition={condition:"and",rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))}),this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.addRuleCondition&&(this.addRuleCondition={condition:"or",rules:this.querybuilderAdditionalProp.rule.rules},this.qryBldrObjRule.rule.rules.push(this.addRuleCondition)),this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field?(this.ruleSecondQryBldrCondition={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},e=JSON.stringify({condition:"or",rules:this.ruleSecondQryBldrCondition.rules})):e=JSON.stringify({condition:"and",rules:this.qryBldrObjRule.rule.rules});const i={name:this.ruleNameObj.value.trim(),description:this.ruleDescription.value,condition:e,summary:this.summaryString,action:this.eventType===S.l.AutoAssignmentAutomation?JSON.stringify(t):JSON.stringify(this.qryBldrObjAction.rule.rules),automationTypeId:this.eventType,isEnabled:!0,businessHourId:this.bussinessHours?0===this.bussinessHours.value?null:this.bussinessHours.value:null};this.automationListService.addAutomation(i).then(e=>{e&&(this.saveRuleDialog.hide(),Object(b.V)(!1),this.toastService.successToast(e.message),this.router.navigateByUrl(this.href.replace("/new","")))}).finally(()=>{this.spinService.hideSpinner()})}ruleUpdateEvent(){let e,t;this.spinService.showSpinner(),this.summaryFraming(),this.eventType===S.l.AutoAssignmentAutomation&&(t=[{name:"AssignTicket",label:"Set assignee",field:S.f.UpdateAssignee,AssignmentType:S.e.RoundRobin,GroupId:this.autoAssignmentGroupDrop.value.toString()}]),this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&(this.addRuleCondition={condition:"and",rules:JSON.parse(JSON.stringify(this.qryBldrObjRule.rule.rules))}),this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field&&this.addRuleCondition&&(this.addRuleCondition={condition:"or",rules:this.querybuilderAdditionalProp.rule.rules},this.qryBldrObjRule.rule.rules.push(this.addRuleCondition)),this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field?(this.ruleSecondQryBldrCondition={condition:"or",rules:JSON.parse(JSON.stringify(this.querybuilderAdditionalProp.rule.rules))},e=JSON.stringify({condition:"or",rules:this.ruleSecondQryBldrCondition.rules})):e=JSON.stringify({condition:"and",rules:this.qryBldrObjRule.rule.rules});const i={name:this.ruleNameObj.value.trim(),description:this.ruleDescription.value,condition:e,summary:this.summaryString,action:this.eventType===S.l.AutoAssignmentAutomation?JSON.stringify(t):JSON.stringify(this.qryBldrObjAction.rule.rules),businessHourId:this.bussinessHours?0===this.bussinessHours.value?null:this.bussinessHours.value:null};this.automationListService.updateAutomation(this.automationId,i).then(e=>{e&&(this.saveRuleDialog.hide(),Object(b.V)(!1),this.toastService.successToast(e.message),this.router.navigateByUrl(this.href.replace("/"+this.automationId,"")))}).finally(()=>{this.spinService.hideSpinner()})}beforeChange(){}framUniqFieldsInActionQB(){const e=this.getColumnData();this.qryBldrObjAction.element.querySelectorAll(".e-rule-list .e-rule-field .e-rule-filter .e-control.e-dropdownlist").forEach(t=>{this.skipIndexDataSource(t.ej2_instances[0],this.qryBldrObjAction.columns,JSON.parse(JSON.stringify(e)))})}skipIndexDataSource(e,t,i){-1!==i.indexOf(e.value)&&i.splice(i.indexOf(e.value),1);const n=[];t.forEach(e=>{-1===i.indexOf(e.field)&&n.push(e)}),e.dataSource=n,this.hideAddActionButton=1===n.length,e.dataBind()}getColumnData(){const e=[];return this.qryBldrObjAction.getRules().rules.forEach(t=>{t.field&&e.push(t.field)}),e}assigneeGroupChange(e){if(e&&e.skipUpdate)return;const t=this.assigneeGroupDrop.itemData,i=t?t.groupID:null,n=!isNaN(i);i&&n&&i!==S.w.None?(this.assigneeDrop.value=null,this.assigneeDrop.dataSource=new p.a({url:f.a.AssigneeByGroupId+i+"/members",adaptor:new m.b})):this.assigneeDrop.dataSource=new p.a({url:f.a.Assignee,adaptor:new m.b}),this.assigneeDrop.dataBind()}emailGroupDatabind(e){this.assigneeGroupDropEmail.requestCount?++this.assigneeGroupDropEmail.requestCount:this.assigneeGroupDropEmail.requestCount=1;const t=e.items.length;for(let i=0;i<t&&!this.itemAddedGroupEmail&&e.items[i].groupID!==S.w.AssignedGroup;i++);this.itemAddedGroupEmail||(this.assigneeGroupDropEmail.addItem({groupID:S.w.AssignedGroup,groupName:S.x.AssignedGroup},0),this.itemAddedGroupEmail=!0),1===this.assigneeGroupDropEmail.requestCount&&1===this.assigneeGroupDropEmail.requestCount&&this.userValuePersistForGroup&&this.userValuePersistForGroup.length>0&&(this.assigneeGroupDropEmail.value=this.userValuePersistForGroup,this.assigneeGroupDropEmail.dataBind()),this.assigneeGroupDropEmail.value&&this.assigneeGroupDropEmail.change.emit()}assigneeGroupDataBind(){this.assigneeGroupDrop.value&&(Object(c.X)(this.qryBldrObjAction.valueText[S.f.UpdateAssignee])&&(this.qryBldrObjAction.valueText[S.f.UpdateAssignee]={}),this.qryBldrObjAction.valueText[S.f.UpdateAssignee].groupText=this.assigneeGroupDrop.text)}businessHrsDataBind(){this.addItemFrBusinessHrs&&(this.bussinessHours&&this.bussinessHours.element&&(this.bussinessHours.addItem({id:S.w.CalendarHours,name:Object(y.a)("ALLDAYS24*7")},0),this.automationId?null===this.businessId&&(this.bussinessHours.value=0):this.bussinessHours.index=0),this.addItemFrBusinessHrs=!1)}assigneeUserEmailDataBind(e){this.assigneeDropEmail.requestCount?++this.assigneeDropEmail.requestCount:this.assigneeDropEmail.requestCount=1;const t=e.items.length;for(let i=0;i<t&&!this.itemAddedAssigneeEmail&&e.items[i].userId!==S.w.Requester;i++);this.itemAddedAssigneeEmail||(this.assigneeDropEmail.addItem({displayName:S.x.Requester,userId:S.w.Requester,shortCode:"RE",colorCode:"#0450cc"},0),this.assigneeDropEmail.addItem({displayName:S.x.AssignedAgent,userId:S.w.AssignedAgent,shortCode:"AA",colorCode:"#0450cc"},0),this.itemAddedAssigneeEmail=!0),1===this.assigneeDropEmail.requestCount&&this.userValuePersistForUser&&this.userValuePersistForUser.length>0&&(this.assigneeDropEmail.value=this.userValuePersistForUser,this.assigneeDropEmail.dataBind()),this.assigneeDropEmail.value&&this.assigneeDropEmail.change.emit()}assigneeDataBind(e){const t=e.items.length;for(let i=0;i<t;i++){if(e.items[i].userId===S.w.EventPerformer){this.itemAddedAssignee=!0;break}this.itemAddedAssignee=!1}this.itemAddedAssignee||this.eventType===S.l.TimeTriggerAutomation||(this.assigneeDrop.addItem({displayName:S.x.EventPerformer,userId:S.w.EventPerformer,shortCode:"EP",colorCode:"#0450cc"},0),this.itemAddedAssignee=!0),this.assigneeDrop.value&&this.assigneeDrop.change.emit()}styleChange(e){const t=e.element.querySelectorAll(".e-rule-field .e-rule-filter .e-control.e-dropdownlist, .e-rule-field .e-rule-operator .e-control"),i=e.element.querySelectorAll(".e-filter-input");if(e===this.qryBldrObjRule||e===this.querybuilderAdditionalProp)for(let n=0;n<i.length;n++){const e=Object(c.M)(i[n],"dropdownlist");e.fields.groupBy="fieldGroupName",e.filterType="Contains",e.refresh()}for(let n=0;n<t.length;n++){const e=Object(c.M)(t[n],"dropdownlist");e.cssClass=e.cssClass?e.cssClass:null,e.floatLabelType="Never",e.allowFiltering=!0,e.filterBarPlaceholder=Object(y.a)("SEARCH"),e.popupHeight=b.g,e.filterType="Contains",e.dataBind()}}convertFields(){const e=A.a.AutomationNewRuleFields+this.eventType+"/fields";return this.spinService.hideSpinner(),this.automationListService.fields(e).then(e=>{Object(b.S)(!0),this.items=e.result,this.itemClone=this.items.map(e=>Object.assign({},e)),this.selectQryBldr(this.qryBldrObjRule),this.columnTemplate=[this.itemsList],this.filter=this.columnTemplate[0],this.selectQryBldr(this.querybuilderAdditionalProp),this.columnAdditionalTemplate=[this.itemsList],this.additionalFilter=this.columnAdditionalTemplate[0],setTimeout(()=>{this.qryBldrObjRule.refresh(),this.styleChange(this.qryBldrObjRule),this.querybuilderAdditionalProp.refresh(),this.styleChange(this.querybuilderAdditionalProp)})}).finally(()=>{this.automationId||this.spinService.hideSpinner()})}convertActionFields(){this.automationListService.actionFields(A.a.AutomationNewRuleFieldsAction+this.eventType+"/actions").then(e=>{this.actionListArray=e.result,this.addTypesToAction(),setTimeout(()=>{this.qryBldrObjAction.refresh(),this.styleChange(this.qryBldrObjAction),setTimeout(()=>{Object(b.W)()},300)})}).finally(()=>{this.automationId||this.spinService.hideSpinner()})}addTypesToAction(){for(let e=0;e<this.actionListArray.length;e++){if(this.actionListArray[e].assignmentType)for(let t=0;t<this.actionListArray[e].assignmentType.length;t++)this.actionListArray[e].assignmentType[t]=1===this.actionListArray[e].assignmentType[t]?"Direct":"RoundRobin";if(this.actionListArray[e].assigneeType)for(let t=0;t<this.actionListArray[e].assigneeType.length;t++)this.actionListArray[e].assigneeType[t]=this.assigneeType(this.actionListArray[e].assigneeType[t]);if(this.actionListArray[e].receiverType)for(let t=0;t<this.actionListArray[e].receiverType.length;t++)this.actionListArray[e].receiverType[t]=this.receiverType(this.actionListArray[e].receiverType[t]);this.actionListArray[e].operators=[Object(g.n)(1)],this.actionListArray[e].template=this.automationActionTemplate(this.qryBldrObjAction,this.ruleContainerActionEle,this.queryBuildervalueUpdate,this.actionListArray[e])}this.filterAction=this.actionListArray}selectQryBldr(e){if(e===this.qryBldrObjRule){this.itemsList=this.items;for(let t=0;t<this.itemsList.length;t++){for(let e=0;e<this.itemsList[t].operators.length;e++){const i=this.itemsList[t].operators[e];Object(g.n)(i)&&(this.itemsList[t].operators[e]=Object(g.n)(i))}this.itemsList[t].template=Object(g.b)(e,this.ruleContainerEle,this.queryBuildervalueUpdate,this.itemsList[t],this.eventType,this.automationId)}}else{this.itemsList=this.itemClone;for(let t=0;t<this.itemsList.length;t++)this.itemsList[t].template=Object(g.b)(e,this.ruleContainerEle,this.queryBuildervalueUpdate,this.itemsList[t],this.eventType,this.automationId)}return this.itemsList}automationActionTemplate(e,t,i,n){return{create:e=>(event&&event,e.field===S.f.UpdateAssignee?this.compileTemplate(this.actionAssigneeTemplate,{name:"assignee"}):e.field===S.f.AddNote?(this.enablePrivateNoteAction=!0,this.compileTemplate(this.actionNotesTemplate,{name:"private_notes"})):e.field===S.f.SendUserNotification?(this.enableUserNotificationAction=!0,this.cd.detectChanges(),this.compileTemplate(this.actionUserEmailTemplate,{name:"user_email"})):e.field===S.f.SendGroupNotification?(this.enableGroupNotificationAction=!0,this.cd.detectChanges(),this.compileTemplate(this.actionGroupEmailTemplate,{name:"group_email"})):Object(c.F)("input",{attrs:{type:"text"}})),destroy:i=>{if(Object(c.X)(i.elements))return;this.setAssigneeVaidationFail=!1;const n=Object(c.C)(i.elements[0],".e-rule-container");let r={};const o=[].slice.call(n.parentElement.children).indexOf(n);if(r=e.rule.rules[o],Object(c.X)(e.valueText)&&(e.valueText={}),delete e.valueText[r.field],r.field===S.f.UpdateAssignee){this.groupValueForDetails=null,this.assigneeValueForDetails=null,i.elements[0].parentElement.classList.remove("action-assignee-style");const e=t.nativeElement.querySelector("#"+i.elementId+" #assigneeGroupDrop").ej2_instances[0],n=t.nativeElement.querySelector("#"+i.elementId+" #assigneeDrop").ej2_instances[0];e.destroy(),n.destroy()}else if(r.field===S.f.AddNote)this.notesContentValueForDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),this.enablePrivateNoteAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_private_notes_RTE").ej2_instances[0].destroy();else if(r.field===S.f.SendUserNotification){this.userValueForUserDetails=null,this.userValuePersistForUser=null,this.subValueForUserDetails=null,this.rteValueForUserDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),this.actionEmailUserRTE.closeCannedResponseDialog(),this.enableUserNotificationAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_user_email_RTE").ej2_instances[0].destroy(),t.nativeElement.querySelector("#"+i.elementId+" #subjectUserField").ej2_instances[0].destroy();const e=t.nativeElement.querySelector("#"+i.elementId+" #assigneeDropEmail").ej2_instances[0];e.requestCount=null,e.destroy(),this.cd.detectChanges()}else if(r.field===S.f.SendGroupNotification){this.userValueForGroupDetails=null,this.userValueForGroupDetailsText=null,this.userValuePersistForGroup=null,this.subValueForGroupDetails=null,this.rteValueForGroupDetails=null,i.elements[0].parentElement.classList.remove("e-add-private-note"),this.actionEmailGroupRTE.closeCannedResponseDialog(),this.enableGroupNotificationAction=!1,t.nativeElement.querySelector("#"+i.elementId+" #automationAction_group_email_RTE").ej2_instances[0].destroy(),t.nativeElement.querySelector("#"+i.elementId+" #subjectGroupField").ej2_instances[0].destroy();const e=t.nativeElement.querySelector("#"+i.elementId+" #assigneeGroupDropEmail").ej2_instances[0];e.requestCount=null,e.destroy(),this.cd.detectChanges()}else{const e=t.nativeElement.querySelector("#"+i.elementId);e.classList.contains("e-control")?e.ej2_instances[0].destroy():e.querySelectorAll(".e-control").forEach(e=>{e.ej2_instances[0].destroy()})}delete e.rule.rules[o].custom,delete e.rule.rules[o][S.c.SendNotificationBodyContent],delete e.rule.rules[o][S.c.SendNotificationSubjectContent],delete e.rule.rules[o][S.c.AssigneeTypeInUpdateAssignee],delete e.rule.rules[o][S.c.AgentInUpdateAssignee],delete e.rule.rules[o][S.c.GroupInSetAssignee];const s=i.elements[0].parentElement.parentElement.querySelector(".mandatory-false");s&&s.parentElement.remove()},write:r=>{const o=Object(c.C)(r.elements,".e-rule-container"),s=Object(c.M)(o.querySelector(".e-rule-filter .e-filter-input"),"dropdownlist").itemData,a=[].slice.call(o.parentElement.children).indexOf(o);Object(c.X)(e.valueText)&&(e.valueText={});let l=this.automationId?e.rule.rules[a].custom:[];Object(c.X)(l)&&(l=[]),delete e.valueText[s.field];const u=r.elements.parentElement.parentElement.querySelector(".mandatory-false");u&&u.parentElement.remove();const A=i;if(s.field===S.f.Subject||n.isCustomField&&n.controlName===S.m.Textarea||n.isCustomField&&n.controlName===S.m.Textbox||n.isCustomField&&n.controlName===S.m.MultiselectUrlPrefix||n.isCustomField&&n.controlName===S.m.UrlPrefix||n.isCustomField&&n.controlName===S.m.Regex||n.isCustomField&&n.controlName===S.m.Url){let t;e.rule.rules[a][S.c.Name]=n.name,n.isMandatory||e.rule.rules[a].value||(e.rule.rules[a].value=null);const i=new v.g({autocomplete:"off",placeholder:Object(y.a)("TEXTBOXPLACEHOLDER"),value:r.values,multiline:n.controlName===S.m.Textarea,floatLabelType:"Never",showClearButton:n.controlName!==S.m.Textarea&&!n.isMandatory,change:()=>{e.valueText[s.field]=i.value,A(e,i.element,i.value.trim())},blur:()=>{const e=r.elements.parentElement.parentElement.querySelector(".hd-toast-success"),o=r.elements.parentElement.parentElement.querySelector(".hd-warning-icon");if(n.controlName===S.m.Regex&&i.value)if(t=Object(g.o)(i.value,n.validationRegex),t&&!e){i.element.parentElement.classList.remove("e-error");const e=document.createElement("span");e.innerHTML='<span class="hd-icon hd-toast-success hd-success success-icon action-icons" data-non-elliptical="true" data-title="Valid"></span>',r.elements.parentElement.parentElement.append(e)}else if(!t&&!o){i.element.parentElement.classList.add("e-error");const e=document.createElement("span");e.innerHTML='<span class="hd-icon hd-warning-icon required success-icon action-icons" data-non-elliptical="true" data-title="Invalid"></span>',r.elements.parentElement.parentElement.append(e)}n.isMandatory&&Object(g.c)(i)},focus:()=>{if(n.controlName===S.m.Regex){const e=r.elements.parentElement.parentElement.querySelector(".hd-toast-success"),t=r.elements.parentElement.parentElement.querySelector(".hd-warning-icon");e&&e.parentElement.remove(),t&&t.parentElement.remove()}Object(g.l)(i)}});i.value&&(e.valueText[s.field]=i.value),n.isMandatory||this.appendInfoTextForValueField(r),i.appendTo("#"+r.elements.id)}else if(s.field===S.f.Duedate||n.controlName===S.m.DateTime&&n.isCustomField){const t=this.getRuleIndex(r);e.rule.rules[t][S.c.Name]=n.name,n.isMandatory||e.rule.rules[t].value||(e.rule.rules[t].value=null);const i=new T.d({placeholder:Object(y.a)("DATETIMEPICKERPLACEHOLDER"),value:r.values?Array.isArray(r.values)?Object(h.u)(r.values[0]):Object(h.u)(r.values):null,floatLabelType:"Never",showClearButton:!n.isMandatory,allowEdit:!0,change:()=>{e.valueText[s.field]=i.value?Object(h.n)(i.value.toString()):null,A(e,i.element,i.value?Object(h.n)(i.value.toString()):null)},blur:()=>{n.isMandatory&&Object(g.c)(i)},focus:()=>{Object(g.l)(i)}});if(i.value&&"Invalid Date"!==i.value.toString()&&(e.valueText[s.field]=Object(h.n)(i.value.toString())),i.appendTo("#"+r.elements.id),!n.isMandatory){const e=document.createElement("span");e.innerHTML=`<span class='secondary mandatory-false' style='float:right'>${Object(y.a)("EMPTYVALUESINAUTOMATION")}</span>`,r.elements.parentElement.parentElement.append(e)}}else if(n.controlName===S.m.Date&&n.isCustomField){e.rule.rules[a][S.c.Name]=n.name,n.isMandatory||e.rule.rules[a].value||(e.rule.rules[a].value=null);const t=new T.b({placeholder:Object(y.a)("DATETIMEPICKERPLACEHOLDER"),value:r.values?Array.isArray(r.values)?Object(h.u)(r.values[0]):Object(h.u)(r.values):null,floatLabelType:"Never",showClearButton:!n.isMandatory,allowEdit:!0,change:()=>{e.valueText[s.field]=t.value?Object(h.F)(t.value.toString()):null,A(e,t.element,t.value?Object(h.F)(t.value.toString()):null)},blur:()=>{n.isMandatory&&Object(g.c)(t)},focus:()=>{Object(g.l)(t)}});if(t.value&&"Invalid Date"!==t.value.toString()&&(e.valueText[s.field]=Object(h.n)(t.value.toString())),t.appendTo("#"+r.elements.id),!n.isMandatory){const e=document.createElement("span");e.innerHTML=`<span class='secondary mandatory-false' style='float:right'>${Object(y.a)("EMPTYVALUESINAUTOMATION")}</span>`,r.elements.parentElement.parentElement.append(e)}}else if(s.field===S.f.UpdateAssignee){let i,o,u;this.itemAddedGroup=!1,this.itemAddedAssignee=!1;const d=e.rule.rules[a].custom;if(d&&(d.filter(e=>e.key===S.n.Group)[0]&&(u=d.filter(e=>e.key===S.n.Group)[0].value,u&&(this.groupActionQuery=u>0?(new p.g).addParams("includeAdditionalIds",u):"",setTimeout(()=>{this.assigneeDataConfig=new p.a({url:f.a.AssigneeByGroupId+u+"/members",adaptor:new m.b}),this.cd.detectChanges(),this.groupValueForDetails=u||""}))),d.filter(e=>e.key===S.n.Assignee)[0])){const e=d.filter(e=>e.key===S.n.Assignee)[0].value;e&&(this.assigneeActionQuery=e>0?(new p.g).addParams(S.r.User,e):"",setTimeout(()=>{e===S.w.EventPerformer?(this.assigneeTextForDetails=S.x.EventPerformer,this.assigneeValueForDetails=e):this.assigneeValueForDetails=e||""},1e3))}r.elements.parentElement.classList.add("action-assignee-style"),setTimeout(()=>{const u=t.nativeElement.querySelector("#"+r.elements.id+" #assigneeGroupDrop");if(i=u.ej2_instances[0],e.rule.rules[a][S.c.Name]=n.name,i.value&&d){const e=d.filter(e=>e.key===S.n.Group)[0].value;this.qryBldrObjAction.rule.rules[a][S.c.GroupInSetAssignee]=Object(g.g)(e,S.f.UpdateAssignee).toString(),d.filter(e=>e.key===S.n.AssigneeType)[0]&&(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=d.filter(e=>e.key===S.n.AssigneeType)[0].value)}i.change.subscribe(()=>{const t=i.itemData,n=t?t.groupID:null;Object(g.d)(e,a,l,n,S.n.Group),Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].groupText=i.text,this.qryBldrObjAction.rule.rules[a][S.c.GroupInSetAssignee]=n?Object(g.g)(n,S.f.UpdateAssignee).toString():"",this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]="",null===o.value&&null==i.value&&(Object(g.d)(e,a,l,"",S.n.Assignee),this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]=""),null===o.value&&null!==i.value?(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.Group.toString(),Object(g.d)(e,a,l,S.d.Group.toString(),S.n.AssigneeType)):null===i.value&&null!==o.value?(this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]=o.value?Object(g.g)(o.value,S.f.UpdateAssignee).toString():"",this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.Agent.toString(),Object(g.d)(e,a,l,S.d.Agent.toString(),S.n.AssigneeType)):null!==o.value&&null!==i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]=o.value?Object(g.g)(o.value,S.f.UpdateAssignee).toString():"",this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.AgentAndGroup.toString(),Object(g.d)(e,a,l,S.d.AgentAndGroup.toString(),S.n.AssigneeType))}),i.blur.subscribe(()=>{n.isMandatory&&(this.setAssigneeVaidationFail=!this.assigneeGroupDrop.value&&!this.assigneeDrop.value)});const p=t.nativeElement.querySelector("#"+r.elements.id+" #assigneeDrop");if(o=p.ej2_instances[0],d){const e=d.filter(e=>e.key===S.n.Assignee).length>0?d.filter(e=>e.key===S.n.Assignee)[0].value:"";this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]=e?Object(g.g)(e,S.f.UpdateAssignee).toString():"",d.filter(e=>e.key===S.n.AssigneeType)[0]&&(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=d.filter(e=>e.key===S.n.AssigneeType)[0].value)}o.change.subscribe(()=>{const t=o.itemData,n=t?t.userId:null,u=this.getRuleIndex(r);e.rule.rules[u].custom?Object(g.e)(e,a,n,S.n.Assignee):Object(g.d)(e,a,l,n,S.n.Assignee),this.qryBldrObjAction.rule.rules[a][S.c.AgentInUpdateAssignee]=n?Object(g.g)(n,S.f.UpdateAssignee).toString():"",Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].assigneeText=o.text,null===i.value&&null!==o.value?(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.Agent.toString(),Object(g.d)(e,a,l,S.d.Agent.toString(),S.n.AssigneeType)):null===o.value&&null!==i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.Group.toString(),Object(g.d)(e,a,l,S.d.Group.toString(),S.n.AssigneeType)),null!==o.value&&null!==i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]=S.d.AgentAndGroup.toString(),Object(g.d)(e,a,l,S.d.AgentAndGroup.toString(),S.n.AssigneeType)),null===o.value&&null===i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.AssigneeTypeInUpdateAssignee]="",Object(g.d)(e,a,l,"",S.n.AssigneeType))}),o.blur.subscribe(()=>{n.isMandatory&&(this.setAssigneeVaidationFail=!this.assigneeGroupDrop.value&&!this.assigneeDrop.value)})}),n.isMandatory||this.appendInfoTextForValueField(r)}else if(s.field===S.f.AddNote){const i=e.rule.rules[a].custom;i&&(this.notesContentValueForDetails=i.filter(e=>e.key===S.n.RTENotes)[0]?i.filter(e=>e.key===S.n.RTENotes)[0].value:null),r.elements.parentElement.classList.add("e-add-private-note"),setTimeout(()=>{const i=t.nativeElement.querySelector("#"+r.elements.id+" #automationAction_private_notes_RTE").ej2_instances[0];e.rule.rules[a][S.c.Name]=n.name,i.change.subscribe(()=>{i.element.classList.add("e-template"),Object(g.d)(e,a,l,i.value,S.n.RTENotes),this.queryBuildervalueUpdate(this.qryBldrObjAction,i.element,i.value)})})}else if(s.field===S.f.SendUserNotification){this.itemAddedAssigneeEmail=!1;const i=e.rule.rules[a].custom;i&&(this.rteValueForUserDetails=Object(g.h)(i,S.n.RTEUserNotificationContent),this.subValueForUserDetails=Object(g.h)(i,S.n.SubjUserNotificationContent),this.userValueForUserDetails=Object(g.h)(i,S.n.AssigneeUserNotificationValue),this.userValuePersistForUser=JSON.parse(JSON.stringify(this.userValueForUserDetails)),this.userValueForUserDetails&&(this.userActionNotifyQuery=(new p.g).addParams(S.r.User,this.userValueForUserDetails)),this.cd.detectChanges()),r.elements.parentElement.classList.add("e-add-private-note"),setTimeout(()=>{e.rule.rules[a][S.c.Name]=n.name;const i=t.nativeElement.querySelector("#"+r.elements.id+" #automationAction_user_email_RTE").ej2_instances[0];i.element.classList.add("e-template"),i.focusIn(),i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationBodyContent]=i.value,Object(g.d)(e,a,l,i.value,S.n.RTEUserNotificationContent)),i.change.subscribe(()=>{Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].body=i.value,this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationBodyContent]=i.value,Object(g.d)(e,a,l,i.value,S.n.RTEUserNotificationContent)});const o=t.nativeElement.querySelector("#"+r.elements.id+" #subjectUserField").ej2_instances[0];o.value&&(this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationSubjectContent]=o.value,Object(g.d)(e,a,l,o.value,S.n.SubjUserNotificationContent)),o.change.subscribe(()=>{Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].subject=o.value,this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationSubjectContent]=o.value,Object(g.d)(e,a,l,o.value,S.n.SubjUserNotificationContent)});const u=t.nativeElement.querySelector("#"+r.elements.id+" #assigneeDropEmail").ej2_instances[0];if(u.value){const t=this.getRuleIndex(r);e.rule.rules[t].value=u.value?Object(g.g)(u.value).toString():null,Object(g.d)(e,a,l,u.value,S.n.AssigneeUserNotificationValue)}u.change.subscribe(()=>{const t=u.value.map(String);for(let i=0;i<t.length;i++){t[i]===S.w.AssignedAgent.toString()?t[i]=S.v.AssignedAgent:t[i]===S.w.Requester.toString()&&(t[i]=S.v.Requester);const n=this.getRuleIndex(r);e.rule.rules[n].value=t?t.toString():""}Object(g.d)(e,a,l,u.value,S.n.AssigneeUserNotificationValue),e.valueText[s.field]||(e.valueText[s.field]={}),e.valueText[s.field].assigneeText=u.text})})}else if(s.field===S.f.SendGroupNotification){this.itemAddedGroupEmail=!1;const i=e.rule.rules[a].custom;i&&(this.rteValueForGroupDetails=Object(g.h)(i,S.n.RteGroupContent),this.subValueForGroupDetails=Object(g.h)(i,S.n.SubjectGroupContent),this.userValueForGroupDetails=Object(g.h)(i,S.n.AssigneeGroupNotificationValue),this.userValuePersistForGroup=JSON.parse(JSON.stringify(this.userValueForGroupDetails)),this.userValueForGroupDetails===S.w.AssignedGroup&&(this.userValueForGroupDetailsText=S.x.AssignedGroup),this.userValueForGroupDetails&&(this.groupActionNotifyQuery=(new p.g).addParams("includeAdditionalIds",this.userValueForGroupDetails))),r.elements.parentElement.classList.add("e-add-private-note"),setTimeout(()=>{const i=t.nativeElement.querySelector("#"+r.elements.id+" #automationAction_group_email_RTE").ej2_instances[0];i.element.classList.add("e-template"),i.focusIn(),e.rule.rules[a][S.c.Name]=n.name,i.value&&(this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationBodyContent]=i.value,Object(g.d)(e,a,l,i.value,S.n.RteGroupContent)),i.change.subscribe(()=>{Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].body=i.value,this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationBodyContent]=i.value,Object(g.d)(e,a,l,i.value,S.n.RteGroupContent)});const o=t.nativeElement.querySelector("#"+r.elements.id+" #subjectGroupField").ej2_instances[0];o.value&&(this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationSubjectContent]=o.value,Object(g.d)(e,a,l,o.value,S.n.SubjectGroupContent)),o.change.subscribe(()=>{Object(c.X)(e.valueText[s.field])&&(e.valueText[s.field]={}),e.valueText[s.field].subject=o.value,this.qryBldrObjAction.rule.rules[a][S.c.SendNotificationSubjectContent]=o.value,Object(g.d)(e,a,l,o.value,S.n.SubjectGroupContent)});const u=t.nativeElement.querySelector("#"+r.elements.id+" #assigneeGroupDropEmail").ej2_instances[0];if(u.value){const t=this.getRuleIndex(r);e.rule.rules[t].value=u.value?u.value.toString()===S.w.AssignedGroup.toString()?S.v.AssignedGroup:u.value.toString():null,Object(g.d)(e,a,l,u.value,S.n.AssigneeGroupNotificationValue)}u.change.subscribe(()=>{const t=u.value.map(String);for(let e=0;e<t.length;e++)t[e]===S.w.AssignedGroup.toString()&&(t[e]=S.v.AssignedGroup);const i=this.getRuleIndex(r);e.rule.rules[i].value=t?t.toString():"",Object(g.d)(e,a,l,u.value,S.n.AssigneeGroupNotificationValue),e.valueText[s.field]||(e.valueText[s.field]={}),e.valueText[s.field].groupText=u.text})})}else if(s.field===S.f.AddTags||s.field===S.f.RemoveTags||s.field===S.f.AddCcs||s.field===S.f.RemoveCcs||s.field===S.f.AddWatchers){setTimeout(()=>{e.rule.rules[a][S.c.Name]=n.name}),n.isMandatory||e.rule.rules[a].value||(e.rule.rules[a].value=null);const t=e.rule.rules[a].custom,i=new d.g({showClearButton:!n.isMandatory,dataSource:Object(g.j)(n.field,n.isCustomField),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),allowFiltering:!0,allowCustomValue:!0,locale:n.field===S.f.AddTags||n.field===S.f.RemoveTags?"customRecordsTemplate":"en-US",popupHeight:b.g,popupWidth:s.field===S.f.AddCcs||s.field===S.f.RemoveCcs||s.field===S.f.AddWatchers?"250px":"200px",filterBarPlaceholder:Object(y.a)("SEARCH"),fields:Object(g.k)(s.field),itemTemplate:Object(g.m)(s.field,r.operator),mode:n.field===S.f.AddTags||n.field===S.f.RemoveTags?"Box":"CheckBox",floatLabelType:"Never",showDropDownIcon:!0,value:n.field===S.f.AddTags?t?Object(g.h)(t,S.n.AddTags):"":n.field===S.f.RemoveTags?t?Object(g.h)(t,S.n.RemoveTags):"":Object(g.f)(r.values,n.field,r.operator),change:()=>{s.field===S.f.AddTags||s.field===S.f.RemoveTags?(e.valueText[s.field]=i.text,A(e,i.element,i.text),s.field===S.f.AddTags?Object(g.d)(e,a,l,i.value,S.n.AddTags):s.field===S.f.RemoveTags&&Object(g.d)(e,a,l,i.value,S.n.RemoveTags)):(e.valueText[s.field]=i.text,A(e,i.element,i.value?i.value.toString():null))},blur:()=>{n.isMandatory&&Object(g.c)(i)},focus:()=>{Object(g.l)(i)},dataBound:()=>{i.value&&i.change()}});i.value&&(i.query=(new p.g).addParams(this.fieldQuery(n.field),i.value.join())),i.text&&(e.valueText[s.field]=i.text),n.isMandatory||this.appendInfoTextForValueField(r),i.appendTo("#"+r.elements.id)}else if(n.isCustomField&&n.controlName===S.m.Multiselect){e.rule.rules[a][S.c.Name]=n.name,n.isMandatory||e.rule.rules[a].value||(e.rule.rules[a].value=null);let t=!1;const i=new d.g({dataSource:Object(g.j)(n.field,n.isCustomField),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),allowFiltering:!0,showClearButton:!n.isMandatory,floatLabelType:"Never",popupHeight:b.g,filterBarPlaceholder:Object(y.a)("SEARCH"),fields:Object(g.k)(n.field),itemTemplate:Object(g.m)(n.field,r.operator),mode:"CheckBox",showDropDownIcon:!0,value:Object(g.f)(r.values,n.field,r.operator,n.controlName,n.isCustomField),change:()=>{const t=i.value.map(String),o=this.getRuleIndex(r);e.rule.rules[o][S.c.Name]=n.name,A(e,i.element,t?t.toString():null),e.valueText[s.field]=i.text},blur:()=>{!i.value&&n.isMandatory&&Object(g.c)(i)},focus:()=>{Object(g.l)(i)},dataBound:()=>{t=Object(g.i)(n.field,t,i,this.eventType,n.isCustomField,n.isMandatory,n.controlName,this.automationId),i.value&&i.change()}});i.value&&(e.valueText[s.field]=i.text),this.isFieldNeedFullReqData(n.field)?i.query=n.isCustomField?(new p.g).addParams("page","1").addParams("perPage",""+b.E).addParams(S.r.IncludeReadOnlyAlso,"false"):(new p.g).addParams("page","1").addParams("perPage",""+b.E):i.value&&(i.query=(new p.g).addParams(this.fieldQuery(n.field),i.value.join())),n.isMandatory||this.appendInfoTextForValueField(r),i.appendTo("#"+r.elements.id)}else if(n.isCustomField&&n.controlName===S.m.Numeric||n.isCustomField&&n.controlName===S.m.Decimal){e.rule.rules[a][S.c.Name]=n.name;const t=new v.e({placeholder:Object(y.a)("NUMERICBOXPLACEHOLDER"),value:null===r.values?null:+r.values,floatLabelType:"Never",showClearButton:!n.isMandatory,width:"188px",min:0,format:n.controlName===S.m.Decimal?"###.##":"###",decimals:n.controlName===S.m.Decimal?2:0,validateDecimalOnType:!0,change:()=>{const i=this.getRuleIndex(r);e.rule.rules[i][S.c.Name]=n.name;const o=t.value?t.value.toString():null;A(e,t.element,o),e.valueText[s.field]=t.value?t.value.toString():null},blur:()=>{!t.value&&n.isMandatory&&Object(g.c)(t)},focus:()=>{Object(g.l)(t)}});n.isMandatory||this.appendInfoTextForValueField(r),t.appendTo("#"+r.elements.id),t.value&&t.change()}else if(!n.controlName||""===n.controlName||n.isCustomField&&n.controlName===S.m.Dropdown||n.isCustomField&&n.controlName===S.m.CheckBox||n.isCustomField&&n.controlName===S.m.RadioButton){let t=!1;e.rule.rules[a][S.c.Name]=n.name;const i=new d.d({dataSource:Object(g.j)(n.field,n.isCustomField,n.controlName),showClearButton:!n.isMandatory,allowFiltering:!0,filterBarPlaceholder:Object(y.a)("SEARCH"),popupHeight:b.g,fields:Object(g.k)(s.field),placeholder:Object(y.a)("DROPDOWNPLACEHOLDER"),itemTemplate:Object(g.m)(s.field,r.operator),value:Object(h.D)(r.values)?null:+r.values,text:r.values===S.v.None?"None":"",floatLabelType:"Never",created:()=>{},dataBound:()=>{t=Object(g.i)(n.field,t,i,this.eventType,n.isCustomField,n.isMandatory,n.controlName,this.automationId),(i.value||0===i.value)&&setTimeout(()=>{i.change()})},change:()=>{if(!i.itemData&&n.isMandatory)return;const t=this.getRuleIndex(r);e.rule.rules[t][S.c.Name]=n.name,e.valueText[s.field]=i.text,A(e,i.element,n.isCustomField&&n.controlName===S.m.CheckBox||n.isCustomField&&n.controlName===S.m.RadioButton?1===i.value:i.value?i.value.toString():null)},blur:()=>{(n.isMandatory&&n.controlName!==S.m.CheckBox||n.isMandatory&&n.controlName===S.m.CheckBox&&Object(h.D)(i.value))&&Object(g.c)(i)},focus:()=>{Object(g.l)(i)}});if(this.isFieldNeedFullReqData(n.field)?i.query=n.isCustomField?(new p.g).addParams("page","1").addParams("perPage",""+b.E).addParams(S.r.IncludeReadOnlyAlso,"false"):(new p.g).addParams("page","1").addParams("perPage",""+b.E):i.value&&(i.query=(new p.g).addParams(this.fieldQuery(n.field,n.isCustomField),""+i.value)),(i.value||0===i.value)&&(e.valueText[s.field]=i.text),!i.value){const e=Object(g.a)(n.field,this.eventType,n.isCustomField,n.isMandatory,n.controlName);e&&(e.filter(e=>"None"===e.name).length||e.filter(e=>"None"===e.groupName).length||e.filter(e=>"None"===e.displayName))}n.isMandatory||this.appendInfoTextForValueField(r),i.appendTo("#"+r.elements.id),n.field===S.f.Priority&&i.value&&setTimeout(()=>{i.change()})}}}}assigneeType(e){switch(e){case 1:return"Agent";case 2:return"Group";case 3:return"AgentAndGroup"}}receiverType(e){switch(e){case 1:return"Group";case 2:return"User";case 3:return"ExternalUser"}}summaryClick(){this.saveDialog=!1,this.saveRuleDialog.show()}renderRuleSummary(e){this.textBoxRuleFocusOut(),this.validateConditionValueField(),this.isConditionTabValid(),Object(g.p)(this.qryBldrObjRule,this.querybuilderAdditionalProp),this.validateConditionValueField(),!this.validCondition||!this.validConditionForGroup||this.ruleNameRequired||this.conditionErrorAndRule||this.conditionErrorOrRule||this.operationalHoursRequired?(e.cancel=!0,this.validationFailCheckForSummaryAndNextBtn()):this.summaryFraming()}overlayDialogClick(){this.saveRuleDialog.hide()}isFieldNeedFullReqData(e){return-1!==["statusId","status","TypeId","type","BrandId","SourceId","RequesterRole"].indexOf(e)}fieldQuery(e,t){let i;return i=e===S.f.AddCcs||e===S.f.RemoveCcs||e===S.h.RequestedBy||e===S.f.AddWatchers?S.r.User:e===S.h.GroupId?S.r.Group:e===S.f.Category?S.r.Category:e===S.h.RequesterCountry?S.r.RequesterCountry:e===S.h.RequesterTimeZone?S.r.RequesterTimeZone:e===S.h.RequesterLanguage?S.r.RequesterLanguage:e===S.h.SupportTierId?S.r.SupportTier:e===S.f.AddTags||e===S.f.RemoveTags?S.r.Tags:t?S.r.InclusionIds:S.r.IncludeAdditionalIds,i}validationFailCheckForSummaryAndNextBtn(){if(this.ruleNameObj.value){if(this.operationalHoursRequired)this.bussinessHours.focusIn();else if(this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""===this.querybuilderAdditionalProp.rule.rules[0].field){const e=this.qryBldrObjRule.element.querySelectorAll(".e-error");if(0===e.length)return;const t=e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");t&&t.ej2_instances[0].focusIn()}else if(this.qryBldrObjRule.rule.rules.length>0&&""===this.qryBldrObjRule.rule.rules[0].field){const e=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error"),t=e[0]?e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker"):"";t&&t.ej2_instances[0].focusIn()}else if(this.qryBldrObjRule.rule.rules.length>0&&""!==this.qryBldrObjRule.rule.rules[0].field&&this.querybuilderAdditionalProp.rule.rules.length>0&&""!==this.querybuilderAdditionalProp.rule.rules[0].field){const e=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error"),t=this.qryBldrObjRule.element.querySelectorAll(".e-error");if(t.length>0){const e=t[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");e&&e.ej2_instances[0].focusIn()}else if(e.length>0){const t=e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");t&&t.ej2_instances[0].focusIn()}}}else this.queryBuilderContainerEle.nativeElement.scrollIntoView(!0),this.ruleNameObj.focusOut(),this.ruleNameObj.focusIn()}btnClick(e){switch(e.target.id){case"nextCondition":this.nameRule=this.ruleNameObj.value,this.isConditionTabValid(),Object(g.p)(this.qryBldrObjRule,this.querybuilderAdditionalProp),this.validateConditionValueField(),setTimeout(()=>{!this.validCondition||!this.validConditionForGroup||this.ruleNameRequired||this.conditionErrorAndRule||this.conditionErrorOrRule||this.operationalHoursRequired?this.validationFailCheckForSummaryAndNextBtn():(this.activityTab.enableTab(1,!0),this.activityTab.enableTab(0,!1),this.actionNotesRTE&&this.actionNotesRTE.rteObj.refreshUI(),this.actionEmailUserRTE&&this.actionEmailUserRTE.rteObj.refreshUI(),this.actionEmailGroupRTE&&this.actionEmailGroupRTE.rteObj.refreshUI(),(this.automationId&&this.qryBldrObjAction.rule.rules.length>1||""!==this.qryBldrObjAction.rule.rules[0].field)&&(this.validAction=this.qryBldrObjAction.validateFields()))},500);break;case"previousPage":this.closeErrorTooltipForQueryBuilder(),this.activityTab.enableTab(0,!0),this.activityTab.enableTab(1,!1),this.activityTab.select(0);break;case"saveCondition":this.isActionTabValid(),this.validateAction(),setTimeout(()=>{if(this.validateActionValueField(),this.eventType===S.l.AutoAssignmentAutomation&&(this.autoAssignmentGroupDrop.value||(this.invalidGroup=!0)),!this.qryBldrObjAction.validateFields()||this.actionError||this.setAssigneeVaidationFail||this.invalidGroup){const e=this.qryBldrObjAction.element.querySelectorAll(".e-error:not(.added-class)"),t=this.qryBldrObjAction.element.querySelectorAll(".e-error.added-class");if(e.length>0){const t=e[0].querySelector(".e-rule-value:not(.e-hide) .e-dropdownlist, .e-rule-value:not(.e-hide) .e-textbox, .e-rule-value:not(.e-hide) .e-numerictextbox, .e-rule-value:not(.e-hide) .e-multiselect .e-control, .e-rule-value:not(.e-hide) .e-datepicker");t&&t.ej2_instances[0].focusIn()}else t.length>0&&(t[0].classList.contains("e-richtexteditor")?(t[0].ej2_instances[0].element.classList.remove("e-error","added-class"),t[0].ej2_instances[0].element.ej2_instances[0].focusIn()):t[0].parentElement.ej2_instances[0].focusIn())}else this.ruleSaveEvent()});break;case"updateCondition":this.isActionTabValid(),this.validateAction(),setTimeout(()=>{if(this.validateActionValueField(),this.eventType===S.l.AutoAssignmentAutomation&&(this.autoAssignmentGroupDrop.value||(this.invalidGroup=!0)),!this.qryBldrObjAction.validateFields()||this.actionError||this.setAssigneeVaidationFail||this.invalidGroup){const e=this.qryBldrObjAction.element.querySelectorAll(".e-error:not(.added-class)"),t=this.qryBldrObjAction.element.querySelectorAll(".e-error.added-class");if(e.length>0){const t=e[0].querySelector(".e-dropdownlist, .e-textbox, .e-multiselect .e-control, .e-datepicker");t&&t.ej2_instances[0].focusIn()}else t.length>0&&(t[0].classList.contains("e-richtexteditor")?(t[0].ej2_instances[0].element.classList.remove("e-error","added-class"),t[0].ej2_instances[0].element.ej2_instances[0].focusIn()):t[0].parentElement.ej2_instances[0].focusIn())}else this.ruleUpdateEvent()});break;case"saveAndEnableCondition":this.enable=!0,this.ruleSaveEvent()}}tabCreate(){this.activityTab.enableTab(1,!1)}toggleChange(e){this.enable=!!e.checked}tabSelecting(e){e.isSwiped&&(e.cancel=!0)}assignmentTypeChange(e){e.value===S.e.RoundRobin?(this.assigneeDrop.enabled=!1,this.assigneeDrop.value=null):this.assigneeDrop.enabled=!0}assigneeGroupBlur(e){e.value||(e.cssClass="e-error added-class")}assigneeGroupFocus(){}validateAction(){const e=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-multiselect .e-control:not(.action-added-template), .e-rule-value .e-dropdownlist:not(.action-added-template):not(.action-added-template-assignee), .e-rule-value .e-textbox:not(.action-added-template), .e-rule-value .e-datepicker:not(.action-added-template)"),t=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-dropdownlist.action-added-template:not(.action-assignee)"),i=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-dropdownlist.action-added-template.action-assignee"),n=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-textbox.action-added-template"),r=this.qryBldrObjAction.element.querySelectorAll(".e-rule-value .e-richtexteditor");for(let o=0;o<e.length;o++)e[o].ej2_instances[0].blur();for(let o=0;o<t.length;o++)this.assigneeGroupBlur(t[o].ej2_instances[0]);for(let o=0;o<n.length;o++)this.assigneeGroupBlur(n[o].ej2_instances[0]);for(let o=0;o<r.length;o++){const e=r[o].ej2_instances[0];e.value||e.element.classList.add("e-error","added-class")}for(let o=0;o<i.length;o++)this.setAssigneeBlur()}validateConditionValueField(){const e=this.qryBldrObjRule.element.querySelectorAll(".e-error"),t=this.querybuilderAdditionalProp.element.querySelectorAll(".e-error");this.conditionErrorAndRule=e.length>0,this.conditionErrorOrRule=t.length>0}validateActionValueField(){const e=this.qryBldrObjAction.element.querySelectorAll(".e-error");this.actionError=e.length>0}rteBlur(e){e.rteObj.value||e.rteObj.element.classList.add("e-error","added-class")}rteFocus(e){this.focusedEleValue="Description",e.rteObj.element&&e.rteObj.element.classList.remove("e-error","added-class")}setAssigneeBlur(){this.assigneeGroupDrop.change.emit({skipUpdate:!0})}setAssigneeFocus(){this.setAssigneeVaidationFail=!1}autoAssignmentGroupDropBlur(){this.invalidGroup=!this.autoAssignmentGroupDrop.value}autoAssignmentGroupDropFocus(){this.invalidGroup=!1}closeErrorTooltipForQueryBuilder(){const e=this.queryBuilderContainerEle.nativeElement.querySelectorAll(".e-rule-filter");for(let i=0;i<e.length;i++)e[i].firstElementChild.ej2_instances[1]&&"tooltip"===e[i].firstElementChild.ej2_instances[1].getModuleName()&&(e[i].firstElementChild.ej2_instances[1].isHidden||e[i].firstElementChild.ej2_instances[1].close());const t=this.queryBuilderContainerEle.nativeElement.querySelectorAll(".e-control .e-dropdownlist");for(let i=0;i<t.length;i++){const e=Object(c.M)(t[i],"dropdownlist");e.isPopupOpen&&e.hidePopup()}}appendInfoTextForValueField(e){const t=document.createElement("span");t.innerHTML=`<span class='secondary mandatory-false' style='float:right'>${Object(y.a)("EMPTYVALUESINAUTOMATION")}</span>`,e.elements.parentElement.append(t)}getRuleIndex(e){const t=Object(c.C)(e.elements,".e-rule-container");return[].slice.call(t.parentElement.children).indexOf(t)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.O),l.Nb(s.g),l.Nb(j.a),l.Nb(C.a),l.Nb(q.a),l.Nb(u.a),l.Nb(l.h),l.Nb(E.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["app-automation-ticket"]],viewQuery:function(e,t){var i;1&e&&(l.Gc(G,!0),l.Gc(P,!0),l.Gc(L,!0),l.Gc(U,!0),l.Gc(M,!0),l.Gc(k,!0),l.Gc(V,!0),l.Gc(H,!0),l.Qc(_,!0),l.Qc(J,!0),l.Qc(Q,!0),l.Qc($,!0),l.Qc(W,!0),l.Qc(K,!0),l.Qc(X,!0),l.Qc(z,!0),l.Qc(Y,!0),l.Gc(Z,!0),l.Qc(ee,!0),l.Qc(te,!0),l.Qc(ie,!0),l.Qc(ne,!0),l.Gc(re,!0),l.Qc(oe,!0),l.Qc(se,!0),l.Qc(ae,!0),l.Qc(le,!0)),2&e&&(l.xc(i=l.fc())&&(t.qryBldrObjRule=i.first),l.xc(i=l.fc())&&(t.querybuilderAdditionalProp=i.first),l.xc(i=l.fc())&&(t.qryBldrObjAction=i.first),l.xc(i=l.fc())&&(t.ruleNameObj=i.first),l.xc(i=l.fc())&&(t.ruleDescription=i.first),l.xc(i=l.fc())&&(t.queryBuilderContainerEle=i.first),l.xc(i=l.fc())&&(t.ruleContainerEle=i.first),l.xc(i=l.fc())&&(t.ruleContainerActionEle=i.first),l.xc(i=l.fc())&&(t.actionNotesTemplate=i.first),l.xc(i=l.fc())&&(t.actionEmailTemplate=i.first),l.xc(i=l.fc())&&(t.actionAssigneeTemplate=i.first),l.xc(i=l.fc())&&(t.assigneeDropEmail=i.first),l.xc(i=l.fc())&&(t.assigneeGroupDropEmail=i.first),l.xc(i=l.fc())&&(t.assigneeGroupDrop=i.first),l.xc(i=l.fc())&&(t.assigneeDrop=i.first),l.xc(i=l.fc())&&(t.bussinessHours=i.first),l.xc(i=l.fc())&&(t.enableDisableSwitch=i.first),l.xc(i=l.fc())&&(t.activityTab=i.first),l.xc(i=l.fc())&&(t.saveRuleDialog=i.first),l.xc(i=l.fc())&&(t.assignmentTypeDrpDwn=i.first),l.xc(i=l.fc())&&(t.actionUserEmailTemplate=i.first),l.xc(i=l.fc())&&(t.actionGroupEmailTemplate=i.first),l.xc(i=l.fc())&&(t.subjectGroupField=i.first),l.xc(i=l.fc())&&(t.actionNotesRTE=i.first),l.xc(i=l.fc())&&(t.autoAssignmentGroupDrop=i.first),l.xc(i=l.fc())&&(t.actionEmailUserRTE=i.first),l.xc(i=l.fc())&&(t.actionEmailGroupRTE=i.first))},inputs:{orConditionRules:"orConditionRules",andConditionRules:"andConditionRules",actionRules:"actionRules",name:"name",description:"description",onOff:"onOff",eventType:"eventType",typeId:"typeId",automationId:"automationId",businessId:"businessId",groupValueForAutoAssignment:"groupValueForAutoAssignment",summary:"summary"},features:[l.wb([O.a])],decls:119,vars:83,consts:[[1,"custom-rule-tab"],["id","element",3,"animation","created","selecting"],["activityTab",""],[1,"e-tab-header"],[1,"flex","align-center"],["id","update_count_id",1,"hide","ticket-indication-count"],[4,"ngIf"],["class","custom-summary flex",4,"ngIf"],[1,"e-content"],["queryBuilderContainer",""],[1,"control-section","pt-3"],[1,"control-section","p-0"],["id","ruleContainer",1,"rule-condition-container"],["ruleContainer",""],[1,"mt-15"],[1,"cutom-field-label"],[1,"error"],["id","ruleName","autocomplete","off",3,"placeholder","value","htmlAttributes","created","blur","focus"],["ruleName",""],["id","ruleDescription","autocomplete","off",3,"placeholder","htmlAttributes","value"],["ruleDescription",""],[1,"mb-0"],[1,"query-rule-prop-container",3,"ngClass"],[1,"radio-style"],[1,"fw-600"],["id","querybuilder","width","100%","maxGroupCount","1","allowValidation","true","cssClass","hd-query-condition",3,"columns","showButtons","ngClass","rule","created","change","ruleChange"],["querybuilderProp",""],[1,"p-1","pl-2","query-action-button","add-condition-border"],["ejs-button","","iconCss","hd-icon hd-plus",1,"e-btn","e-flat","no-border",3,"click"],[1,"rule-sepeartion"],[1,"and-seperation"],[1,"text-style","uppercase"],[1,"and-seperation-position"],[1,"mt-25"],["id","querybuilderAdditional","width","100%","maxGroupCount","1","allowValidation","true","cssClass","hd-query-condition",3,"columns","showButtons","ngClass","rule","created","change","ruleChange"],["querybuilderAdditionalProp",""],[1,"p-1","pl-2","query-action-button"],[1,"mb-15","fl-r"],["ejs-button","","id","nextCondition","cssClass","e-btn",1,"mr-15","e-control","e-lib","e-btn","e-primary",3,"mousedown"],["id","ruleContainerAction",1,"rule-condition-container"],["ruleContainerAction",""],[3,"ngClass"],[1,"query-rule-action-container",3,"ngClass"],["id","querybuilder-action","width","100%","cssClass","hd-query-action","allowValidation","true",3,"columns","rule","ngClass","change","ruleChange","created","beforeChange"],["querybuilderaction",""],["class","p-1 pl-2 query-action-button",3,"ngClass",4,"ngIf"],["ejs-button","","cssClass","e-outline","id","previousPage",1,"e-btn","mr-15",3,"click"],["actionNotesTemplate",""],["actionAssigneeTemplate",""],[1,"save-dialog"],["id","saveRuleDialog","width","500px","isModal","true","showCloseIcon","true","height","Auto","closeOnEscape","true","cssClass","bd-automation-summary",3,"visible","overlayClick","beforeOpen"],["saveRuleDialog",""],["header",""],["content",""],["disabled","true",1,"flex","align-center"],["id","notes_count_id",1,"hide","ticket-indication-count"],[1,"custom-summary","flex"],[1,"align-right"],["ejs-button","","cssClass","e-flat e-btn",3,"click"],[1,"required"],["id","bussinessHours","popupHeight","200px","index","0",3,"placeholder","dataSource","value","query","fields","showClearButton","allowFiltering","filterBarPlaceholder","htmlAttributes","dataBound","created","blur"],["bussinessHours",""],[1,"p-1","pl-2","query-action-button",3,"ngClass"],[1,"mb-20","font-13"],[1,"auto-assignment-details"],[1,"mt-20"],[1,"font-13","font-500"],[1,"form-group","row","dropdown-margin"],[1,"col-6"],["id","autoAssignmentGroupDrop","popupWidth","200px","popupHeight","200px",1,"action-auto-assignee",3,"placeholder","query","dataSource","fields","allowFiltering","showClearButton","value","filterBarPlaceholder","blur","focus"],["autoAssignmentGroupDrop",""],["class","e-error  ml-30 mb-6",4,"ngIf"],[1,"e-error","ml-30","mb-6"],["ejs-button","","id","saveCondition",1,"e-btn",3,"isPrimary","click"],["ejs-button","","id","updateCondition",1,"e-btn",3,"isPrimary","click"],["cssClass","action-added-template",3,"id","isNeedImageUpload","value","label","enablePlaceholder","focusOut","focusIn"],["actionNotesRTE",""],["actionUserEmailTemplate",""],[1,"form-group","row"],["id","assigneeDropEmail","popupWidth","250px","popupHeight","250px","mode","CheckBox",1,"action-added-template",3,"placeholder","value","dataSource","fields","allowFiltering","query","filterBarPlaceholder","dataBound","blur"],["assigneeDropEmail",""],["itemTemplate",""],[1,"form-group"],["id","subjectUserField","data-id","subjectUserField","autocomplete","off",1,"action-added-template","placeholder-subject",3,"placeholder","htmlAttributes","value","blur"],["subjectUserField",""],["cssClass","action-added-template",3,"id","isNeedImageUpload","value","enablePlaceholder","label","focusOut","focusIn"],["actionEmailUserRTE",""],[2,"display","inline-flex","width","calc(100% - 36px)"],[1,"flex-horizontal","ellipsis","no-wrap",2,"padding","5px"],[1,"wrapper","flex-horizontal","full-width"],[1,"flex-vertical","no-wrap","ellipsis",2,"text-indent","initial"],[1,"e-text"],[1,"font-12"],["actionGroupEmailTemplate",""],["id","assigneeGroupDropEmail","popupHeight","200px","popupWidth","200px","mode","CheckBox",1,"action-added-template",3,"placeholder","dataSource","fields","allowFiltering","query","value","filterBarPlaceholder","text","dataBound","blur"],["assigneeGroupDropEmail",""],["id","subjectGroupField","data-id","subjectGroupField","autocomplete","off",1,"action-added-template","placeholder-subject",3,"placeholder","htmlAttributes","value","blur"],["subjectGroupField",""],["actionEmailGroupRTE",""],["id","assigneeGroupDrop","popupWidth","200px","popupHeight","200px",1,"action-added-template","action-assignee",3,"placeholder","query","dataSource","value","fields","allowFiltering","showClearButton","filterBarPlaceholder","text","change","dataBound","blur","focus"],["assigneeGroupDrop",""],["id","assigneeDrop","popupHeight","200px","popupWidth","250px",1,"action-added-template-assignee",3,"placeholder","query","dataSource","value","fields","allowFiltering","showClearButton","filterBarPlaceholder","text","dataBound","change","focus"],["assigneeDrop",""],["class","e-error",4,"ngIf"],[1,"flex-horizontal","p-2",3,"ngClass"],[1,"e-error"],[1,"summary-content",3,"innerHTML"]],template:function(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",0),l.Tb(1,"ejs-tab",1,2),l.ec("created",(function(){return t.tabCreate()}))("selecting",(function(e){return t.tabSelecting(e)})),l.Tb(3,"div",3),l.Tb(4,"div"),l.Tb(5,"span",4),l.Lc(6),l.hc(7,"translate"),l.Sb(),l.Ob(8,"span",5),l.Sb(),l.Jc(9,ue,5,3,"div",6),l.Jc(10,ce,5,3,"div",6),l.Sb(),l.Jc(11,de,5,3,"div",7),l.Tb(12,"div",8,9),l.Tb(14,"div"),l.Tb(15,"div",10),l.Tb(16,"div",11),l.Tb(17,"div",12,13),l.Tb(19,"div",14),l.Tb(20,"label",15),l.Lc(21),l.hc(22,"translate"),l.Tb(23,"span",16),l.Lc(24,"*"),l.Sb(),l.Sb(),l.Tb(25,"ejs-textbox",17,18),l.ec("created",(function(){return t.textBoxcreated()}))("blur",(function(){return t.textBoxRuleFocusOut()}))("focus",(function(){return t.textBoxRulefocus()})),l.hc(27,"translate"),l.Sb(),l.Jc(28,pe,4,3,"div",6),l.Sb(),l.Tb(29,"div"),l.Tb(30,"label",15),l.Lc(31),l.hc(32,"translate"),l.Sb(),l.Ob(33,"ejs-textbox",19,20),l.hc(35,"translate"),l.Sb(),l.Jc(36,me,5,12,"div",6),l.Tb(37,"div",21),l.Tb(38,"div"),l.Tb(39,"div",22),l.Tb(40,"div",23),l.Tb(41,"span"),l.Lc(42),l.hc(43,"translate"),l.Sb(),l.Tb(44,"span",24),l.Lc(45),l.hc(46,"translate"),l.Sb(),l.Tb(47,"span"),l.Lc(48),l.hc(49,"translate"),l.Sb(),l.Sb(),l.Tb(50,"ejs-querybuilder",25,26),l.ec("created",(function(){return t.querybuilderCreated()}))("change",(function(e){return t.querybuilderChange(e)}))("ruleChange",(function(){return t.querybuilderRuleChange()})),l.Sb(),l.Sb(),l.Tb(52,"div",27),l.Tb(53,"button",28),l.ec("click",(function(e){return t.newCondition(e,t.qryBldrObjRule)})),l.Lc(54),l.hc(55,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Jc(56,be,4,3,"div",6),l.Sb(),l.Tb(57,"div",29),l.Tb(58,"div",30),l.Tb(59,"div",31),l.Lc(60),l.hc(61,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Tb(62,"div",32),l.Ob(63,"div",30),l.Sb(),l.Tb(64,"div",33),l.Tb(65,"div"),l.Tb(66,"div",22),l.Tb(67,"div",23),l.Tb(68,"span"),l.Lc(69),l.hc(70,"translate"),l.Sb(),l.Tb(71,"span",24),l.Lc(72),l.hc(73,"translate"),l.Sb(),l.Tb(74,"span"),l.Lc(75),l.hc(76,"translate"),l.Sb(),l.Sb(),l.Tb(77,"ejs-querybuilder",34,35),l.ec("created",(function(){return t.querybuilderAdditionalCreated()}))("change",(function(e){return t.querybuilderAdditionalChange(e)}))("ruleChange",(function(){return t.querybuilderAddRuleChange()})),l.Sb(),l.Sb(),l.Tb(79,"div",36),l.Tb(80,"button",28),l.ec("click",(function(i){l.Bc(e);const n=l.yc(78);return t.newCondition(i,n)})),l.Lc(81),l.hc(82,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Jc(83,ge,4,3,"div",6),l.Sb(),l.Sb(),l.Tb(84,"div",37),l.Tb(85,"button",38),l.ec("mousedown",(function(e){return t.btnClick(e)})),l.Lc(86),l.hc(87,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(88,"div"),l.Tb(89,"div",10),l.Tb(90,"div",11),l.Tb(91,"div",39,40),l.Tb(93,"div",41),l.Tb(94,"div",42),l.Tb(95,"ejs-querybuilder",43,44),l.ec("change",(function(e){return t.querybuilderActionChange(e)}))("ruleChange",(function(){return t.querybuilderActionRuleChange()}))("created",(function(){return t.queryActionCreated()}))("beforeChange",(function(){return t.beforeChange()})),l.Sb(),l.Sb(),l.Jc(97,ye,4,4,"div",45),l.Sb(),l.Jc(98,fe,4,3,"div",6),l.Jc(99,Ae,23,25,"span",6),l.Sb(),l.Tb(100,"div",37),l.Tb(101,"button",46),l.ec("click",(function(e){return t.btnClick(e)})),l.Lc(102),l.hc(103,"translate"),l.Sb(),l.Jc(104,Te,4,4,"span",6),l.Jc(105,Oe,4,4,"span",6),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Jc(106,Se,3,7,"ng-template",null,47,l.Kc),l.Jc(108,Ce,2,0,void 0,6),l.Jc(109,Re,2,0,void 0,6),l.Jc(110,De,16,27,"ng-template",null,48,l.Kc),l.Tb(112,"div",49),l.Tb(113,"ejs-dialog",50,51),l.ec("overlayClick",(function(){return t.overlayDialogClick()}))("beforeOpen",(function(e){return t.renderRuleSummary(e)})),l.Jc(115,we,3,3,"ng-template",null,52,l.Kc),l.Jc(117,Fe,3,4,"ng-template",null,53,l.Kc),l.Sb(),l.Sb()}2&e&&(l.xb(1),l.nc("animation",t.tabAnimationSettings),l.xb(5),l.Nc(" ",l.ic(7,51,"CHOOSECONDITION")," "),l.xb(3),l.nc("ngIf",t.showAction),l.xb(1),l.nc("ngIf",!t.showAction),l.xb(1),l.nc("ngIf",t.automationId),l.xb(10),l.Nc(" ",l.ic(22,53,"RULENAME")," "),l.xb(4),l.oc("placeholder",l.ic(27,55,"TEXTBOXPLACEHOLDER")),l.nc("value",t.name)("htmlAttributes",t.inputAttribute),l.xb(3),l.nc("ngIf",t.ruleNameRequired),l.xb(3),l.Nc(" ",l.ic(32,57,"DESCRIPTION")," "),l.xb(2),l.oc("placeholder",l.ic(35,59,"TEXTBOXPLACEHOLDER")),l.nc("htmlAttributes",t.inputAttribute)("value",t.description),l.xb(3),l.nc("ngIf",4===t.eventType),l.xb(3),l.nc("ngClass",t.validCondition?"":"border-color-condition"),l.xb(3),l.Mc(l.ic(43,61,"MATCHAUTOMATIONCONDITION")),l.xb(3),l.Nc(" ",l.ic(46,63,"ALL"),""),l.xb(3),l.Nc(" ",l.ic(49,65,"OFTHECONDITION"),""),l.xb(2),l.nc("columns",t.filter)("showButtons",t.showButtons)("ngClass",t.conditionRuleDel?"hd-del-icon":"")("rule",t.orConditionRules),l.xb(4),l.Mc(l.ic(55,67,"ADDNEWCONDITION")),l.xb(2),l.nc("ngIf",t.ruleConditionRequired),l.xb(4),l.Mc(l.ic(61,69,"AND")),l.xb(6),l.nc("ngClass",t.validConditionForGroup?"":"border-color-condition"),l.xb(3),l.Mc(l.ic(70,71,"MATCHAUTOMATIONCONDITION")),l.xb(3),l.Nc(" ",l.ic(73,73,"ANY"),""),l.xb(3),l.Nc(" ",l.ic(76,75,"OFTHECONDITION"),""),l.xb(2),l.nc("columns",t.additionalFilter)("showButtons",t.showButtons)("ngClass",t.extraConditionRuleDel?"hd-del-icon":"")("rule",t.andConditionRules),l.xb(4),l.Mc(l.ic(82,77,"ADDNEWCONDITION")),l.xb(2),l.nc("ngIf",t.ruleConditionRequired),l.xb(3),l.Mc(l.ic(87,79,"NEXT")),l.xb(7),l.nc("ngClass",t.showAction?"":"hide-action"),l.xb(1),l.nc("ngClass",t.validAction?"":"border-color-action"),l.xb(1),l.nc("columns",t.filterAction)("rule",t.actionRules)("ngClass",t.actionRuleDel?"hd-del-icon":""),l.xb(2),l.nc("ngIf",!t.hideAddActionButton),l.xb(1),l.nc("ngIf",t.ruleActionRequired),l.xb(1),l.nc("ngIf",!t.showAction),l.xb(3),l.Mc(l.ic(103,81,"BACK")),l.xb(2),l.nc("ngIf",!t.automationId),l.xb(1),l.nc("ngIf",t.automationId),l.xb(3),l.nc("ngIf",t.enableUserNotificationAction),l.xb(1),l.nc("ngIf",t.enableGroupNotificationAction),l.xb(4),l.nc("visible",!1))},directives:[o.m,n.n,R.i,n.l,B.d,I.c,N.b,O.e,D.a,O.h],pipes:[w.a,F.a],styles:["body{--theme-color:#ff4800;--header-background-color:#ff4800;--header-font-color:#183247;--header-font-style:Roboto,segoe ui;--body-background-color:#f3f5f7;--primary-color:rgba(0,0,0,0.87);--secondary-color:#718096;--font-style:Roboto,segoe ui;--footer-background-color:#f1f1f1}.border-bottom{border-bottom:1px solid #e2e8f0!important}.border-top{border-top:1px solid #e2e8f0!important}.border-right{border-right:1px solid #e2e8f0!important}.border-left{border-left:1px solid #e2e8f0!important}.border{border:1px solid #e2e8f0!important}.border-radius{border-radius:5px}.rule-condition-container>*{margin-bottom:20px}.rule-condition-container .query-rule-action-container,.rule-condition-container .query-rule-prop-container{border:1px solid #e2e8f0;border-bottom-left-radius:0!important;border-bottom-right-radius:0!important;border-radius:4px;box-shadow:0 2px 4px 0 rgba(18,52,77,.06)}.rule-condition-container .query-rule-action-container .e-query-builder,.rule-condition-container .query-rule-prop-container .e-query-builder{border:0!important}.rule-condition-container .border-color-action,.rule-condition-container .border-color-condition{border:1px solid red!important}.rule-condition-container .hd-query-action .e-group-header,.rule-condition-container .hd-query-action .e-group-header .e-btn-group,.rule-condition-container .hd-query-action.hd-del-icon .e-rule-value-delete{display:none}.rule-condition-container .hd-query-action .e-group-body{padding-left:0!important}.rule-condition-container .hd-query-action .e-group-body .e-rule-container:after,.rule-condition-container .hd-query-action .e-group-body .e-rule-container:before{display:none}.rule-condition-container .hd-query-action .e-group-body .e-rule-container.e-error{border-color:red}.rule-condition-container .hd-query-action .e-group-body .e-rule-container .e-add-private-note.e-template-value{width:100%!important}.rule-condition-container .hd-query-action .e-group-body .e-rule-container .e-add-private-note.e-template-value .e-dropdown-btn{box-shadow:none}.rule-condition-container .hd-query-action .e-rule-operator{display:none!important}.rule-condition-container .hd-query-condition .e-group-header,.rule-condition-container .hd-query-condition .e-group-header .e-btn-group,.rule-condition-container .hd-query-condition.hd-del-icon .e-rule-value-delete{display:none}.rule-condition-container .hd-query-condition .e-group-body{padding-left:0!important}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container:after,.rule-condition-container .hd-query-condition .e-group-body .e-rule-container:before{display:none}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container.e-error{border-color:red}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container .e-add-private-note.e-template-value{width:100%!important}.rule-condition-container .hd-query-condition .e-group-body .e-rule-container .e-add-private-note.e-template-value .e-dropdown-btn{box-shadow:none}.rule-condition-container .e-rule-field .e-rule-value-delete .e-rule-delete{float:right!important;position:absolute!important;right:10px!important;top:10px!important}.rule-condition-container .query-action-button{background-color:#fff;border:1px solid #e2e8f0;border-bottom-left-radius:4px;border-bottom-right-radius:5px;border-top:0!important}.hd-query-action-group ul li:first-child{display:none!important}.action-assignee-style.e-rule-value{width:auto!important}.action-assignee-style .e-template .e-input-group:first-child{margin-right:60px!important}.action-assignee-style .e-template .e-input-group:nth-child(2){margin-top:0!important}.condition-update-style .e-rule-value{width:auto!important}.condition-update-style .e-template .e-input-group{display:inline-flex;width:auto!important}.condition-update-style .e-template .e-input-group:nth-child(2){height:36px!important;margin-left:12px!important;margin-right:12px!important;margin-top:0!important}.condition-update-style .e-template .e-input-group:nth-child(3){margin-top:0!important;width:auto}.hd-query-condition.hd-del-icon .e-rule-value-delete{display:none!important}.hd-query-condition .e-group-container{padding-top:0!important}#querybuilder .e-rule-value{width:auto!important}#querybuilder .e-rule-value.e-domain{width:250px!important}#querybuilder .e-rule-value .e-contact-group-domain{max-width:250px!important}#querybuilderAdditional .e-rule-value{width:auto!important}#querybuilderAdditional .e-rule-value.e-domain{width:250px!important}#querybuilderAdditional .e-rule-value .e-contact-group-domain{max-width:250px!important}.button-style{float:right;position:relative}.add-rule{height:57px;margin-bottom:0;position:relative}.new-condition{display:none}.add-rule-filter{position:relative}.radio-style{padding:12px 12px 0}.ml-20{margin-left:20px}.fl-r{float:right}.mb-15{margin-bottom:15px}.mr-15{margin-right:15px}.pl-20{padding-left:20px}.mb-0{margin-bottom:0}.fw-600{font-weight:600}.mt-25{margin-top:25px}.mt-15{margin-top:15px}.custom-rule-tab .e-tab-header{width:calc(100% - 70px)!important}.custom-rule-tab .custom-summary{position:absolute;right:0;top:3px}.custom-rule-tab .hd-success{color:#28a745}.custom-rule-tab .action-icons{margin-top:7px;position:absolute}.bd-automation-summary .summary-value{color:#0450cc}.bd-automation-summary .summary-field{font-weight:500}.bd-automation-summary .summary-content{font-size:14px}.bd-automation-summary .summary-content>span>*{margin-bottom:15px}.bd-automation-summary .summary-content .summary-condition{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}.bd-automation-summary .summary-content .summary-condition>*{padding-bottom:15px}.bd-automation-summary .summary-content .summary-action{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}.bd-automation-summary .summary-content .summary-action>*{padding-bottom:15px}.e-error.e-richtexteditor.e-rte-tb-expand{border:1px solid red!important}.e-error.e-richtexteditor.e-rte-tb-expand .e-rte-content{border-bottom:1px solid red!important}.hide-action{display:none}.mt-20{margin-top:20px}.dropdown-margin{margin-bottom:10px!important;margin-top:20px!important}.mb-6{margin-bottom:6px}.info-icon-style{margin-top:5px}.font-color{color:#fff}.auto-assignment-details{line-height:25px;padding-left:20px;padding-right:10px}.and-seperation{border-left:1px solid #e2e8f0;display:block;height:25px;left:50%;position:absolute;top:0;z-index:1}.rule-sepeartion{height:55px;margin-bottom:0;position:relative}.text-style{border:1px solid #e2e8f0!important;font-weight:500;left:50%;padding:5px 15px;position:absolute;top:25px;transform:translateX(-50%)}.and-seperation-position{position:relative}"],encapsulation:2}),e})();const Pe=["newRule"],Le=["errorMessageRemoval"];let Ue=(()=>{class e{constructor(e,t,i){this.router=e,this.activatedRoute=t,this.appRootService=i,this.appRootService.getNavigateUrl(this.router.url.replace("/new",""))}ngOnInit(){this.activatedRoute.data.subscribe(e=>{this.typeId=e.automationTriggerType,this.eventType=e.eventType}),this.href=this.router.url}ngAfterViewInit(){this.errorMessageRemoval.nativeElement.addEventListener("scroll",()=>{this.rule.closeErrorTooltipForQueryBuilder()})}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(s.g),l.Nb(s.a),l.Nb(u.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(l.Gc(Pe,!0),l.Qc(Le,!0)),2&e&&(l.xc(i=l.fc())&&(t.rule=i.first),l.xc(i=l.fc())&&(t.errorMessageRemoval=i.first))},decls:7,vars:2,consts:[[1,"control-section","p-3",2,"overflow","auto"],["errorMessageRemoval",""],[1,"col-lg-8","control-section"],[1,"rule-condition-container"],["ruleContainer",""],[3,"eventType","typeId"],["newRule",""]],template:function(e,t){1&e&&(l.Tb(0,"div",0,1),l.Tb(2,"div",2),l.Tb(3,"div",3,4),l.Ob(5,"app-automation-ticket",5,6),l.Sb(),l.Sb(),l.Sb()),2&e&&(l.xb(5),l.nc("eventType",t.eventType)("typeId",t.typeId))},directives:[Ge],encapsulation:2}),e})();var Me=i("KDci"),ke=i("GJ+o"),Ve=i("64zv");const He=["grid"],_e=["automationListViewTab"],Je=["automationListEle"],Qe=["saveRuleDialog"],$e=["contextmenu"],We=["automationListPage"],Ke=["searchRule"];function Xe(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",36),l.Tb(1,"span",37),l.ec("click",(function(i){l.Bc(e);const n=t.$implicit;return l.gc().nameClick(i,n.automationJobId)})),l.Lc(2),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit;l.xb(2),l.Nc(" ",e.name,"")}}function ze(e,t){if(1&e&&l.Ob(0,"app-date-time",38),2&e){const e=t.$implicit,i=l.gc();l.nc("date",e.lastModifiedOn)("format",i.formatWithTime)("timezone",i.timeZone)}}function Ye(e,t){if(1&e&&(l.Tb(0,"span",40),l.Lc(1),l.Sb()),2&e){const e=t.$implicit;l.xb(1),l.Mc(e.impactedTicketCount?e.impactedTicketCount:"--")}}function Ze(e,t){1&e&&(l.Tb(0,"e-column",39),l.hc(1,"translate"),l.Jc(2,Ye,2,1,"ng-template",null,24,l.Kc),l.Sb()),2&e&&l.oc("headerText",l.ic(1,1,"IMPACT"))}function et(e,t){if(1&e){const e=l.Ub();l.Tb(0,"span",41),l.ec("click",(function(){l.Bc(e);const i=t.$implicit,n=l.gc();return n.moreOptionsSelect(n.editItem,i)})),l.hc(1,"translate"),l.Ob(2,"i",42),l.Sb(),l.Tb(3,"span",43),l.ec("click",(function(i){l.Bc(e);const n=t.$implicit;return l.gc().bindBtnTemplate(i,n)})),l.Sb()}2&e&&l.yb("data-title",l.ic(1,1,"EDIT"))}function tt(e,t){1&e&&(l.Tb(0,"span"),l.Lc(1),l.hc(2,"translate"),l.Sb()),2&e&&(l.xb(1),l.Nc(" ",l.ic(2,1,"SUMMARY")," "))}function it(e,t){if(1&e&&(l.Tb(0,"div"),l.Ob(1,"p",44),l.hc(2,"safe"),l.Sb()),2&e){const e=l.gc();l.xb(1),l.nc("innerHTML",l.jc(2,1,e.summaryString,"html"),l.Cc)}}let nt=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.spinService=t,this.automationListService=i,this.toastService=n,this.cd=r,this.moreActionsWithSpam=[{id:"0",text:"View Summary"},{id:"2",text:"Activate"},{id:"3",text:"Deactivate"},{id:"4",text:"Delete"}],this.moreActionWithActivate=["Activate","Delete"],this.moreActionWithDeactivate=["Deactivate","Delete"],this.stillFetching=!0,this.pagerSize=b.E,this.switchOnOff=!0,this.dragAndDrop=!0,this.animation={effect:"none"},this.tabContent=[{text:S.t.Active},{text:S.t.Inactive}],this.tabAnimationSettings={next:{effect:"None"},previous:{effect:"None"}},this.editItem={item:{id:S.y.Edit}},this.appSettings=b.e,this.format=b.e.dateFormat,this.formatWithTime=b.e.dateFormat+" "+b.e.timeFormat,this.timeZone=b.P.timeZoneOffset}ngOnInit(){S.l.CreateTicketAutomation===this.automationType?this.titleInfo=Object(y.a)("CREATETICKETAUTOMATIONINFO"):S.l.UpdateTicketAutomation===this.automationType?this.titleInfo=Object(y.a)("UPDATETICKETAUTOMATIONINFO"):S.l.TimeTriggerAutomation===this.automationType?this.titleInfo=Object(y.a)("TIMETRIGGERMODULEINFO"):S.l.AutoAssignmentAutomation===this.automationType&&(this.titleInfo=Object(y.a)("AUTOASSIGNMENTAUTOMATIONINFO")),this.href=this.router.url,this.tabSelected=S.t.Active.toLowerCase()}ngAfterViewInit(){this.gridObj.query=(new p.g).addParams("isenabled","true"),this.automationListEle.nativeElement.addEventListener("keydown",e=>{Object(h.l)(e,this.automationListEle.nativeElement)}),this.automationListPageEle.nativeElement.addEventListener("scroll",()=>{this.contextmenu.close()})}tabSelecting(){this.stillFetching=!0,"1"===this.automationListViewTab.selectingID?(this.tabSelected=S.t.Inactive.toLowerCase(),this.gridObj.setProperties({query:(new p.g).addParams("isenabled","false")},!0),this.dragAndDrop=!1,this.stillFetching=!0):(this.tabSelected=S.t.Active.toLowerCase(),this.gridObj.setProperties({query:(new p.g).addParams("isenabled","true")},!0),this.dragAndDrop=!0,this.stillFetching=!0)}automationDragDrop(e){const t=e.data[0].automationJobId;if(e.cancel=!0,e.fromIndex===e.dropIndex)return;const i={toPosition:++e.dropIndex,positionChangeMode:S.q.ToPosition};this.spinService.showSpinner(),this.automationListService.changePosition(t,i).then(e=>{e&&(this.gridObj.refresh(),this.toastService.successToast(e.message))}).catch(e=>{const t=Object(h.q)(e.error);400===e.status&&this.toastService.failureToast(t)}).finally(()=>{this.spinService.hideSpinner()})}automationListDataBound(){const e=this.gridObj.element.querySelector(".e-gridcontent .e-content .e-emptyrow td");e&&e.setAttribute("colspan","2"),this.stillFetching=!1,this.cd.detectChanges(),this.gridObj.widthService.setWidthToColumns()}automationListActionBegin(){}nameClick(e,t){e.stopPropagation(),this.router.navigateByUrl(this.href+"/"+t)}activateAndDeactivateAction(e){this.spinService.showSpinner(),this.automationListService.toggleChange(this.selectedItemData.automationJobId,{isToggleOn:e}).then(e=>{e&&(this.spinService.hideSpinner(),this.gridObj.refresh(),this.toastService.successToast(e.message))}).catch(e=>{const t=Object(h.q)(e.error);400===e.status&&this.toastService.failureToast(t)}).finally(()=>{this.spinService.hideSpinner()})}updateDeleteType(){this.spinService.showSpinner(),this.automationListService.deleteItem(this.id).then(e=>{e&&(this.spinService.hideSpinner(),this.deleteDialog.hide(),this.gridObj.refresh(),this.toastService.successToast(e.message))}).finally(()=>{this.spinService.hideSpinner()})}cancelDialog(){this.deleteDialog.hide()}addRuleClick(){this.router.navigateByUrl(this.href+"/new")}getSwitchObj(e,t){return this.enableDisableSwitch._results.filter(i=>i.element.getAttribute("name")===e&&i.element.dataset.id===t+"")[0]}overlayDialogClick(){this.saveRuleDialog.hide()}summaryViewClick(e){this.summaryString=e,this.saveRuleDialog.show()}moreOptionsSelect(e,t){e.item.id===S.y.Edit?(this.id=+t.automationJobId,this.router.navigateByUrl(this.href+"/"+this.id)):e.item.id===S.y.Delete?(this.id=+this.selectedItemData.automationJobId,Object(h.b)(this.updateDeleteType,this.cancelDialog,this,Object(y.a)("DELETE")+" "+Object(y.a)("RULE"),Object(y.a)("DELETERULEALERT"))):e.item.id===S.y.Activate?this.activateAndDeactivateAction(!0):e.item.id===S.y.Deactivate?this.activateAndDeactivateAction(!1):e.item.id===S.y.ViewSummary&&this.summaryViewClick(this.selectedItemData.summary)}bindBtnTemplate(e,t){this.selectedItemData=t;const i=Object(N.f)(e.target);this.contextmenu.open(i.top+16,i.left-5,e.target)}itemBeforeEvent(){this.selectedItemData.isEnabled?(this.contextmenu.hideItems(this.moreActionWithActivate),this.contextmenu.showItems(this.moreActionWithDeactivate)):(this.contextmenu.hideItems(this.moreActionWithDeactivate),this.contextmenu.showItems(this.moreActionWithActivate))}searchNodes(){const e=this.searchRule.value.trim();this.gridObj.search(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(s.g),l.Nb(C.a),l.Nb(q.a),l.Nb(j.a),l.Nb(l.h))},e.\u0275cmp=l.Hb({type:e,selectors:[["ticket-automation-list"]],viewQuery:function(e,t){var i;1&e&&(l.Qc(He,!0),l.Qc(_e,!0),l.Qc(Je,!0),l.Qc(Qe,!0),l.Qc($e,!0),l.Qc(We,!0),l.Qc(Ke,!0),l.Qc(I.k,!0)),2&e&&(l.xc(i=l.fc())&&(t.gridObj=i.first),l.xc(i=l.fc())&&(t.automationListViewTab=i.first),l.xc(i=l.fc())&&(t.automationListEle=i.first),l.xc(i=l.fc())&&(t.saveRuleDialog=i.first),l.xc(i=l.fc())&&(t.contextmenu=i.first),l.xc(i=l.fc())&&(t.automationListPageEle=i.first),l.xc(i=l.fc())&&(t.searchRule=i.first),l.xc(i=l.fc())&&(t.enableDisableSwitch=i))},inputs:{dataSource:"dataSource",allowDragDrop:"allowDragDrop",automationType:"automationType"},decls:54,vars:28,consts:[[1,"hd-grid-full-height","automation-grid"],["automationListPage",""],[1,"secondary","padding-10","information-content"],[1,"bd-icon","bd-icon-info","information-icon","information-icon-position"],[1,"list-container"],[1,"row","no-margin","float-right",2,"border-bottom","1px solid #e2e8f0","padding-bottom","7px"],[1,"grid-menu"],[1,"search-box",2,"padding","0 12px"],["id","search","showClearButton","true","autocomplete","off","maxlength","150",3,"placeholder","change"],["searchRule",""],[1,"float-right"],["type","button","ejs-button","",1,"e-btn","add-button","e-outline","e-primary",3,"click"],["width","70%",3,"animation","selecting"],["automationListViewTab",""],[3,"header"],[1,"height-100","list-container"],[1,"align-center",2,"height","100%",3,"hidden"],[1,"ticket-fetch-loader"],[3,"stepCount"],[1,"automation-list","pt-3"],["automationListEle",""],["id","rule-grid","allowResizing","true","height","100%","allowSorting","true",3,"dataSource","hidden","allowRowDragAndDrop","dataBound","actionBegin","rowDrop"],["grid",""],["field","name","minWidth","180","width","180","clipMode","EllipsisWithTooltip",3,"headerText"],["template",""],["field","lastModifiedBy","minWidth","150","width","180","clipMode","EllipsisWithTooltip",3,"headerText"],["field","lastModifiedOn","minWidth","150","width","150",3,"headerText"],["field","impactedTicketCount","minWidth","100","width","120","clipMode","EllipsisWithTooltip","textAlign","Center",3,"headerText",4,"ngIf"],["minWidth","100","width","100","textAlign","Center"],[3,"items","animationSettings","beforeOpen","select"],["contextmenu",""],[1,"save-dialog"],["id","saveRuleDialog","width","500px","isModal","true","showCloseIcon","true","height","Auto","closeOnEscape","true","cssClass","bd-automation-summary",3,"visible","overlayClick"],["saveRuleDialog",""],["header",""],["content",""],[1,"no-wrap","ellipsis"],[1,"primary-link-color","cursor-pointer",3,"click"],[3,"date","format","timezone"],["field","impactedTicketCount","minWidth","100","width","120","clipMode","EllipsisWithTooltip","textAlign","Center",3,"headerText"],[1,"grid-text-font-color"],[1,"bd-icon","bd-icon-edit","more-option-button",3,"click"],[1,""],[1,"hd-icon","hd-vertical-menu","more-option-button",3,"click"],[1,"summary-content",3,"innerHTML"]],template:function(e,t){1&e&&(l.Tb(0,"div",0,1),l.Tb(2,"div"),l.Tb(3,"div",2),l.Ob(4,"div",3),l.Lc(5),l.Sb(),l.Tb(6,"div",4),l.Tb(7,"div",5),l.Tb(8,"div",6),l.Tb(9,"div",7),l.Tb(10,"ejs-textbox",8,9),l.ec("change",(function(){return t.searchNodes()})),l.hc(12,"translate"),l.Sb(),l.Sb(),l.Tb(13,"div",10),l.Tb(14,"button",11),l.ec("click",(function(){return t.addRuleClick()})),l.Lc(15),l.hc(16,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"ejs-tab",12,13),l.ec("selecting",(function(){return t.tabSelecting()})),l.Tb(19,"e-tabitems"),l.Ob(20,"e-tabitem",14),l.Ob(21,"e-tabitem",14),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(22,"div",15),l.Tb(23,"div",16),l.Tb(24,"div",17),l.Ob(25,"lib-shimmer",18),l.Sb(),l.Sb(),l.Tb(26,"div",19,20),l.Tb(28,"ejs-grid",21,22),l.ec("dataBound",(function(){return t.automationListDataBound()}))("actionBegin",(function(){return t.automationListActionBegin()}))("rowDrop",(function(e){return t.automationDragDrop(e)})),l.Tb(30,"e-columns"),l.Tb(31,"e-column",23),l.hc(32,"translate"),l.Jc(33,Xe,3,1,"ng-template",null,24,l.Kc),l.Sb(),l.Ob(35,"e-column",25),l.hc(36,"translate"),l.Tb(37,"e-column",26),l.hc(38,"translate"),l.Jc(39,ze,1,3,"ng-template",null,24,l.Kc),l.Sb(),l.Jc(41,Ze,4,3,"e-column",27),l.Tb(42,"e-column",28),l.Jc(43,et,4,3,"ng-template",null,24,l.Kc),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(45,"ejs-contextmenu",29,30),l.ec("beforeOpen",(function(){return t.itemBeforeEvent()}))("select",(function(e){return t.moreOptionsSelect(e)})),l.Sb(),l.Tb(47,"div",31),l.Tb(48,"ejs-dialog",32,33),l.ec("overlayClick",(function(){return t.overlayDialogClick()})),l.Jc(50,tt,3,3,"ng-template",null,34,l.Kc),l.Jc(52,it,3,4,"ng-template",null,35,l.Kc),l.Sb(),l.Sb()),2&e&&(l.xb(5),l.Nc(" ",t.titleInfo," "),l.xb(5),l.oc("placeholder",l.ic(12,18,"SEARCH")),l.xb(5),l.Nc(" ",l.ic(16,20,"ADDRULE")," "),l.xb(2),l.nc("animation",t.tabAnimationSettings),l.xb(3),l.nc("header",t.tabContent[0]),l.xb(1),l.nc("header",t.tabContent[1]),l.xb(2),l.nc("hidden",!t.stillFetching),l.xb(2),l.nc("stepCount",5),l.xb(3),l.nc("dataSource",t.dataSource)("hidden",t.stillFetching)("allowRowDragAndDrop",t.dragAndDrop),l.xb(3),l.oc("headerText",l.ic(32,22,"RULENAME")),l.xb(4),l.oc("headerText",l.ic(36,24,"LASTMODIFIEDBY")),l.xb(2),l.oc("headerText",l.ic(38,26,"LASTMODIFIED")),l.xb(4),l.nc("ngIf",5!==t.automationType),l.xb(4),l.nc("items",t.moreActionsWithSpam)("animationSettings",t.animation),l.xb(3),l.nc("visible",!1))},directives:[R.i,I.c,o.m,o.o,o.n,Me.a,ke.k,B.b,ke.e,ke.b,B.a,ke.d,ke.a,n.n,o.f,N.b,Ve.a],pipes:[w.a,F.a],styles:["body[_ngcontent-%COMP%]{--theme-color:#ff4800;--header-background-color:#ff4800;--header-font-color:#183247;--header-font-style:Roboto,segoe ui;--body-background-color:#f3f5f7;--primary-color:rgba(0,0,0,0.87);--secondary-color:#718096;--font-style:Roboto,segoe ui;--footer-background-color:#f1f1f1}.border-bottom[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0!important}.border-top[_ngcontent-%COMP%]{border-top:1px solid #e2e8f0!important}.border-right[_ngcontent-%COMP%]{border-right:1px solid #e2e8f0!important}.border-left[_ngcontent-%COMP%]{border-left:1px solid #e2e8f0!important}.border[_ngcontent-%COMP%]{border:1px solid #e2e8f0!important}.border-radius[_ngcontent-%COMP%]{border-radius:5px}.seperator-style[_ngcontent-%COMP%]{padding:0 5px}.switch-class[_ngcontent-%COMP%]{margin-top:10px}.title-style[_ngcontent-%COMP%]{font-weight:500}.cursor-style[_ngcontent-%COMP%]:hover{cursor:pointer}.e-dropdown-btn[_ngcontent-%COMP%]:active{box-shadow:none!important}.automation-grid[_ngcontent-%COMP%]{overflow:hidden}.automation-grid[_ngcontent-%COMP%]   .automation-list[_ngcontent-%COMP%]{height:calc(100% - 140px)}.automation-grid[_ngcontent-%COMP%]   .list-container[_ngcontent-%COMP%]{padding:0 16px}.automation-grid[_ngcontent-%COMP%]   .e-gridcontent[_ngcontent-%COMP%]{height:calc(100% - 13px)!important}.automation-grid[_ngcontent-%COMP%]   .e-gridcontent[_ngcontent-%COMP%]   .e-content[_ngcontent-%COMP%]{height:inherit!important;overflow-y:auto!important}  .bd-automation-summary .summary-value{color:#0450cc!important}  .bd-automation-summary .summary-field{font-weight:500!important}  .bd-automation-summary .summary-content{font-size:14px}  .bd-automation-summary .summary-content>span>*{margin-bottom:15px}  .bd-automation-summary .summary-content .summary-condition{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}  .bd-automation-summary .summary-content .summary-condition>*{padding-bottom:15px}  .bd-automation-summary .summary-content .summary-action{border:1px solid #f4f5f7;padding-left:15px;padding-top:5px}  .bd-automation-summary .summary-content .summary-action>*{padding-bottom:15px}.padding-10[_ngcontent-%COMP%]{padding:10px}"]}),e})(),rt=(()=>{class e{constructor(e,t,i,n){this.appRootService=e,this.router=t,this.activatedRoute=i,this.seoService=n,this.automationType=S.i.AutomationType}ngOnInit(){const e=b.E.toString();this.activatedRoute.data.subscribe(e=>{this.typeId=e}),S.l.CreateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("CREATETICKETTRIGGERS")):S.l.UpdateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("UPDATETICKETTRIGGERS")):S.l.TimeTriggerAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("TIMETRIGGERS")):S.l.AutoAssignmentAutomation===this.typeId.eventType&&this.setTitleAndSeo(Object(y.a)("ADMIN"),Object(y.a)("AUTOASSIGNMENTTRIGGERS"));let t=A.a.AutomationList;t=Object(h.i)(t,"Page","1"),t=Object(h.i)(t,"PerPage",e),t=Object(h.i)(t,this.automationType,this.typeId.eventType),this.data=new p.a({url:t,adaptor:new m.a})}setTitleAndSeo(e,t){const i=t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t),this.seoService.setHeaderElements({title:i})}navigateAutomationListPage(){this.router.navigateByUrl("admin/automation/create-ticket-triggers")}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(u.a),l.Nb(s.g),l.Nb(s.a),l.Nb(E.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["ng-component"]],decls:3,vars:2,consts:[[2,"height","100%"],[3,"dataSource","automationType"]],template:function(e,t){1&e&&(l.Tb(0,"div",0),l.Tb(1,"div",0),l.Ob(2,"ticket-automation-list",1),l.Sb(),l.Sb()),2&e&&(l.xb(2),l.nc("dataSource",t.data)("automationType",t.typeId.eventType))},directives:[nt],styles:[".seperator-style[_ngcontent-%COMP%]{padding:0 5px}.switch-class[_ngcontent-%COMP%]{margin-top:10px}"]}),e})();const ot=["newRule"],st=["errorMessageRemoval"];let at=(()=>{class e{constructor(e,t,i,n,r){if(this.router=e,this.appRootService=t,this.spinService=i,this.activatedRoute=n,this.seoService=r,this.resolveData=this.activatedRoute.data.subscribe(e=>{this.data=e.data,this.spinService.showSpinner()}),this.activatedRoute.data.subscribe(e=>{this.typeId=e,this.eventType=e.eventType}),S.l.CreateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("CREATETICKETTRIGGER")):S.l.UpdateTicketAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("UPDATETICKETTRIGGER")):S.l.TimeTriggerAutomation===this.typeId.eventType?this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("TIMETRIGGER")):S.l.AutoAssignmentAutomation===this.typeId.eventType&&this.setTitleAndSeo(Object(y.a)("AUTOMATION"),Object(y.a)("EDIT")+" "+Object(y.a)("AUTOASSIGNMENTTRIGGER")),this.data){this.actionDataManipulation(JSON.parse(this.data.action)),this.ruleName=this.data.name,this.description=this.data.description,this.businessId=this.data.businessHourId,this.onOff=this.data.isEnabled,this.summary=this.data.summary,this.conditionRulesWithoutSplit=JSON.parse(this.data.condition),"or"===this.conditionRulesWithoutSplit.condition?this.conditionRulesSecondQryBldr=this.conditionRulesWithoutSplit:this.conditionRules=this.conditionRulesWithoutSplit;for(let e=0;e<this.conditionRulesWithoutSplit.rules.length;e++)if("or"===this.conditionRulesWithoutSplit.rules[e].condition){this.conditionRulesSecondQryBldr=this.conditionRulesWithoutSplit.rules[e],this.conditionRulesWithoutSplit.rules.splice([e]);break}}this.id=parseInt(this.activatedRoute.snapshot.paramMap.get("id"),10),this.appRootService.getNavigateUrl(this.router.url.replace("/"+this.id,""))}setTitleAndSeo(e,t){const i=t+" | "+e;this.appRootService.setAppTitleText(e+" / "+t),this.seoService.setHeaderElements({title:i})}actionDataManipulation(e){e.forEach(e=>{e.operator="equal"}),Object.prototype.hasOwnProperty.call(e[0],"AssignmentType")?this.groupValueForAutoAssignment=+e[0].GroupId:this.actionRules={condition:"and",rules:e}}ngAfterViewInit(){this.errorMessageRemoval.nativeElement.addEventListener("scroll",()=>{this.rule.closeErrorTooltipForQueryBuilder()})}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(s.g),l.Nb(u.a),l.Nb(C.a),l.Nb(s.a),l.Nb(E.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(l.Gc(ot,!0),l.Qc(st,!0)),2&e&&(l.xc(i=l.fc())&&(t.rule=i.first),l.xc(i=l.fc())&&(t.errorMessageRemoval=i.first))},decls:7,vars:11,consts:[[1,"control-section","p-3"],["errorMessageRemoval",""],[1,"col-lg-8","control-section"],[1,"rule-condition-container"],["ruleContainer",""],[3,"orConditionRules","andConditionRules","actionRules","name","description","onOff","eventType","businessId","automationId","groupValueForAutoAssignment","summary"],["newRule",""]],template:function(e,t){1&e&&(l.Tb(0,"div",0,1),l.Tb(2,"div",2),l.Tb(3,"div",3,4),l.Ob(5,"app-automation-ticket",5,6),l.Sb(),l.Sb(),l.Sb()),2&e&&(l.xb(5),l.nc("orConditionRules",t.conditionRules)("andConditionRules",t.conditionRulesSecondQryBldr)("actionRules",t.actionRules)("name",t.ruleName)("description",t.description)("onOff",t.onOff)("eventType",t.eventType)("businessId",t.businessId)("automationId",t.id)("groupValueForAutoAssignment",t.groupValueForAutoAssignment)("summary",t.summary))},directives:[Ge],styles:[""]}),e})();var lt=i("tk/3");let ut=(()=>{class e{constructor(e,t,i){this.http=e,this.spinService=t,this.router=i}resolve(e){return this.spinService.showSpinner(),this.http.get(A.a.AutomationList+"/"+e.data.eventType+"/"+e.params.id).toPromise().catch(e=>this.router.navigateByUrl("error",{state:e.error.errors[0].errorMessage,skipLocationChange:!0}))}}return e.\u0275fac=function(t){return new(t||e)(l.bc(lt.b),l.bc(C.a),l.bc(s.g))},e.\u0275prov=l.Jb({token:e,factory:e.\u0275fac}),e})();var ct=i("TSZ8"),dt=i("hR61"),pt=i("mdOG"),ht=i("G2Tp"),mt=i("znO6");const bt=[{path:"create-ticket-triggers",canActivate:[pt.a],data:{permission:{enum:[mt.a.ManageCreateAndUpdateTriggers]},guards:[ht.a,dt.a]},children:[{path:"",component:rt,data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.CreateTicketAutomation}},{path:"new",component:Ue,data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.CreateTicketAutomation},canDeactivate:[ct.a]},{path:":id",component:at,resolve:{data:ut},data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.CreateTicketAutomation},canDeactivate:[ct.a]}]},{path:"update-ticket-triggers",canActivate:[pt.a],data:{permission:{enum:[mt.a.ManageCreateAndUpdateTriggers]},guards:[ht.a,dt.a]},children:[{path:"",component:rt,data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.UpdateTicketAutomation}},{path:"new",component:Ue,data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.UpdateTicketAutomation},canDeactivate:[ct.a]},{path:":id",component:at,resolve:{data:ut},data:{automationTriggerType:S.u.EventTrigger,eventType:S.l.UpdateTicketAutomation},canDeactivate:[ct.a]}]},{path:"time-triggers",canActivate:[pt.a],data:{permission:{enum:[mt.a.ManageTimeTriggers]},guards:[ht.a,dt.a]},children:[{path:"",component:rt,data:{automationTriggerType:S.u.TimeTrigger,eventType:S.l.TimeTriggerAutomation}},{path:"new",component:Ue,data:{automationTriggerType:S.u.TimeTrigger,eventType:S.l.TimeTriggerAutomation},canDeactivate:[ct.a]},{path:":id",component:at,resolve:{data:ut},data:{automationTriggerType:S.u.TimeTrigger,eventType:S.l.TimeTriggerAutomation},canDeactivate:[ct.a]}]},{path:"auto-assignments",canActivate:[pt.a],data:{permission:{enum:[mt.a.ManageAutoAssignments]},guards:[ht.a,dt.a]},children:[{path:"",component:rt,data:{automationTriggerType:S.u.AutoAssignment,eventType:S.l.AutoAssignmentAutomation}},{path:"new",component:Ue,data:{automationTriggerType:S.u.AutoAssignment,eventType:S.l.AutoAssignmentAutomation},canDeactivate:[ct.a]},{path:":id",component:at,resolve:{data:ut},data:{automationTriggerType:S.u.AutoAssignment,eventType:S.l.AutoAssignmentAutomation},canDeactivate:[ct.a]}]},{path:"**",component:a.a}];let gt=(()=>{class e{}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},imports:[[s.k.forChild(bt)],s.k]}),e})();var yt=i("5OZa");let ft=(()=>{class e{}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},providers:[ut],imports:[[n.b,r.a,gt,o.j,R.h,I.b,B.c,ke.m,ke.j,I.l,yt.a,yt.d,O.d,O.g,I.h,o.l,N.a,o.e]]}),e})()}}]);